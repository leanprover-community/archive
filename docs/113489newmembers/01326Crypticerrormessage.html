---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113489newmembers/01326Crypticerrormessage.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html">Cryptic error message</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="183313017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313017" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313017">Bhavik Mehta (Dec 12 2019 at 23:12)</a>:</h4>
<p>Can anyone give suggestions about this error message?</p>
<div class="codehilite"><pre><span></span><span class="n">invalid</span> <span class="n">apply</span> <span class="n">tactic</span><span class="o">,</span> <span class="n">failed</span> <span class="n">to</span> <span class="n">unify</span>
  <span class="n">geom_series</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">kU</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="err">^</span> <span class="o">(</span><span class="n">kU</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span>
<span class="k">with</span>
  <span class="n">geom_series</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">kU</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="err">^</span> <span class="o">(</span><span class="n">kU</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span>
</pre></div>


<p>Here's the code:</p>
<div class="codehilite"><pre><span></span>  <span class="kn">example</span> <span class="o">(</span><span class="n">U</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">))</span> <span class="o">(</span><span class="n">hU</span> <span class="o">:</span> <span class="n">U</span> <span class="bp">≠</span> <span class="err">∅</span><span class="o">)</span> <span class="o">:</span> <span class="n">sum</span> <span class="n">U</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n</span><span class="o">),</span> <span class="mi">2</span> <span class="err">^</span> <span class="n">x</span><span class="bp">.</span><span class="n">val</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="mi">2</span><span class="err">^</span><span class="o">((</span><span class="n">max&#39;</span> <span class="n">U</span> <span class="n">hU</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span>
  <span class="k">begin</span>
    <span class="n">set</span> <span class="n">kU</span> <span class="o">:=</span> <span class="o">(</span><span class="n">max&#39;</span> <span class="n">U</span> <span class="n">hU</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">r</span><span class="o">:</span> <span class="n">geom_series</span> <span class="o">(</span><span class="mi">1</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">kU</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">1</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span><span class="err">^</span><span class="o">(</span><span class="n">kU</span><span class="bp">+</span><span class="mi">1</span><span class="o">),</span>
      <span class="n">apply</span> <span class="n">geom_sum_mul_add</span> <span class="mi">1</span> <span class="o">(</span><span class="n">kU</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">),</span>

  <span class="kn">end</span>
</pre></div>

<a name="183313143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313143" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313143">Simon Hudon (Dec 12 2019 at 23:14)</a>:</h4>
<p>Some of the implicit arguments are probably different. Try adding <code>set_option pp.implicit true</code> before your lemma. It will show you the implicit arguments</p>

<a name="183313265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313265" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313265">Bhavik Mehta (Dec 12 2019 at 23:16)</a>:</h4>
<p>The error message says</p>
<div class="codehilite"><pre><span></span><span class="n">invalid</span> <span class="n">apply</span> <span class="n">tactic</span><span class="o">,</span> <span class="n">failed</span> <span class="n">to</span> <span class="n">unify</span>
  <span class="bp">@</span><span class="n">geom_series</span> <span class="bp">ℕ</span> <span class="n">nat</span><span class="bp">.</span><span class="n">semiring</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">kU</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="err">^</span> <span class="o">(</span><span class="n">kU</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span>
<span class="k">with</span>
  <span class="bp">@</span><span class="n">geom_series</span> <span class="bp">ℕ</span> <span class="n">nat</span><span class="bp">.</span><span class="n">semiring</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">kU</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="err">^</span> <span class="o">(</span><span class="n">kU</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span>
</pre></div>


<p>now...</p>

<a name="183313288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313288" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313288">Kevin Buzzard (Dec 12 2019 at 23:16)</a>:</h4>
<p>Then try setting <code>pp.all true</code></p>

<a name="183313317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313317" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313317">Reid Barton (Dec 12 2019 at 23:17)</a>:</h4>
<p>or try <code>convert</code> instead of <code>apply</code></p>

<a name="183313406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313406" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313406">Bhavik Mehta (Dec 12 2019 at 23:18)</a>:</h4>
<blockquote>
<p>or try <code>convert</code> instead of <code>apply</code></p>
</blockquote>
<p>Hmmm... Now my goal is <code>nat.has_pow = monoid.has_pow</code></p>

<a name="183313425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313425" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313425">Kevin Buzzard (Dec 12 2019 at 23:18)</a>:</h4>
<p>Nice!</p>

<a name="183313442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313442" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313442">Kevin Buzzard (Dec 12 2019 at 23:19)</a>:</h4>
<p>So the issue is that the powers you're using are different</p>

<a name="183313451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313451" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313451">Kevin Buzzard (Dec 12 2019 at 23:19)</a>:</h4>
<p>You can rewrite a lemma saying they're equal first</p>

<a name="183313467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313467" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313467">Bhavik Mehta (Dec 12 2019 at 23:19)</a>:</h4>
<p>I was intending everything to be for nats though - that's why there's <code>.1</code>s around</p>

<a name="183313533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313533" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313533">Kevin Buzzard (Dec 12 2019 at 23:20)</a>:</h4>
<p>The various <code>^</code>s are being treated differently</p>

<a name="183313541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313541" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313541">Kevin Buzzard (Dec 12 2019 at 23:20)</a>:</h4>
<p>It's notation for more than one thing</p>

<a name="183313550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313550" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313550">Kevin Buzzard (Dec 12 2019 at 23:21)</a>:</h4>
<p>We can't fix it because the bad one is in core</p>

<a name="183313564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313564" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313564">Kevin Buzzard (Dec 12 2019 at 23:21)</a>:</h4>
<p>So we lemmad our way around it</p>

<a name="183313581"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313581" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313581">Bhavik Mehta (Dec 12 2019 at 23:22)</a>:</h4>
<p>If I understand correctly though, <code>^</code> is overloaded using typeclasses, but changing the type to <code>example (U : finset (fin n)) (hU : U ≠ ∅) : sum U (λ (x : fin n), (2 : ℕ) ^ (x.val : ℕ)) &lt; (2 : ℕ)^((max' U hU).1+1 : ℕ) := </code> still doesn't fix it</p>

<a name="183313625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313625" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313625">Kevin Buzzard (Dec 12 2019 at 23:22)</a>:</h4>
<p>Nat is a monoid and maybe the geom series lemma uses monoid.pow</p>

<a name="183313639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313639" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313639">Kevin Buzzard (Dec 12 2019 at 23:22)</a>:</h4>
<p>It's overloaded in a worse sense than eg +</p>

<a name="183313651"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313651" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313651">Kevin Buzzard (Dec 12 2019 at 23:22)</a>:</h4>
<p>It's two typeclasses</p>

<a name="183313666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313666" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313666">Kevin Buzzard (Dec 12 2019 at 23:23)</a>:</h4>
<p>You're using nats so one is a nat.pow</p>

<a name="183313669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313669" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313669">Bhavik Mehta (Dec 12 2019 at 23:23)</a>:</h4>
<p>Ah I see</p>

<a name="183313673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313673" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313673">Kevin Buzzard (Dec 12 2019 at 23:23)</a>:</h4>
<p>And you're using monoids so one is a monoid.pow</p>

<a name="183313692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313692" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313692">Kevin Buzzard (Dec 12 2019 at 23:23)</a>:</h4>
<p>And there's a lemma which says they're the same which you can rewrite before you do your apply</p>

<a name="183313755"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313755" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313755">Kevin Buzzard (Dec 12 2019 at 23:24)</a>:</h4>
<p>The fix is to delete nat.pow but it's in core so we can't</p>

<a name="183313777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313777" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313777">Kevin Buzzard (Dec 12 2019 at 23:24)</a>:</h4>
<p>I mean the fix is to delete that notation</p>

<a name="183313864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313864" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313864">Bhavik Mehta (Dec 12 2019 at 23:26)</a>:</h4>
<p>Do you have an idea where this lemma is? <code>library_search</code> can't find it</p>

<a name="183313876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313876" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313876">Kevin Buzzard (Dec 12 2019 at 23:26)</a>:</h4>
<p>In Algebra.group_power maybe?</p>

<a name="183313881"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183313881" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183313881">Reid Barton (Dec 12 2019 at 23:26)</a>:</h4>
<p>it's probably eta expanded like <code>x^n = x^n</code></p>

<a name="183314244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183314244" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183314244">Bhavik Mehta (Dec 12 2019 at 23:32)</a>:</h4>
<blockquote>
<p>It's two typeclasses</p>
</blockquote>
<p>Where are the two typeclasses? I can only see <code>has_pow</code>...</p>

<a name="183314265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183314265" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183314265">Bhavik Mehta (Dec 12 2019 at 23:33)</a>:</h4>
<blockquote>
<p>In Algebra.group_power maybe?</p>
</blockquote>
<p>I found <code>nat.pow_eq_pow</code>, but still not much luck</p>

<a name="183314290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Cryptic%20error%20message/near/183314290" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01326Crypticerrormessage.html#183314290">Bhavik Mehta (Dec 12 2019 at 23:33)</a>:</h4>
<p>Finally managed, thanks both</p>


{% endraw %}

{% include archive_update.html %}