[
    {
        "content": "<p>Has anyone seen this problem?</p>\n<p>I'm using Emacs' <a href=\"https://github.com/leanprover/lean4-mode\">lean4-mode</a> package and with Lean version <code>leanprover/lean4:4.2.0</code> (4.1.0 also doesn't work). When I turn on the info buffer, lsp prints:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">The</span> <span class=\"n\">connected</span> <span class=\"n\">server</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span> <span class=\"n\">does</span> <span class=\"n\">not</span> <span class=\"n\">support</span> <span class=\"n\">method</span> <span class=\"bp\">$/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">plainGoal.</span>\n<span class=\"n\">To</span> <span class=\"n\">find</span> <span class=\"n\">out</span> <span class=\"n\">what</span> <span class=\"n\">capabilities</span> <span class=\"n\">support</span> <span class=\"n\">your</span> <span class=\"n\">server</span> <span class=\"n\">use</span> <span class=\"bp\">‘</span><span class=\"n\">M</span><span class=\"bp\">-</span><span class=\"n\">x</span> <span class=\"n\">lsp</span><span class=\"bp\">-</span><span class=\"n\">describe</span><span class=\"bp\">-</span><span class=\"n\">session</span><span class=\"bp\">’</span>\n<span class=\"n\">and</span> <span class=\"n\">expand</span> <span class=\"n\">the</span> <span class=\"n\">capabilities</span> <span class=\"kn\">section</span>\n</code></pre></div>\n<p>and the Lean bufffer is empty.</p>",
        "id": 402940033,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1700358498
    },
    {
        "content": "<p>It seems to work as well as ever (with v4.3.0-rc2, with Emacs built fairly recently from git, with the latest <code>lsp-mode</code> from MELPA). I don't think anything on the Lean side was broken (or changed in a way that could be relevant) in 4.1 or 4.2.</p>",
        "id": 402942102,
        "sender_full_name": "Richard Copley",
        "timestamp": 1700359714
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"400544\">Richard Copley</span> <a href=\"#narrow/stream/270676-lean4/topic/The.20connected.20server.28s.29.20does.20not.20support.20method.20.24.2Flean.2Fplain/near/402942102\">said</a>:</p>\n<blockquote>\n<p>It seems to work as well as ever (with v4.3.0-rc2, with Emacs built fairly recently from git, with the latest <code>lsp-mode</code> from MELPA). I don't think anything on the Lean side was broken (or changed in a way that could be relevant) in 4.1 or 4.2.</p>\n</blockquote>\n<p>I think it may be a doomeamcs problem</p>",
        "id": 402945825,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1700361943
    },
    {
        "content": "<p>I know very little about Doom. Not much to go on since I can't reproduce the problem. I'm not even sure what questions to ask. The message from lsp-mode does not seem right at all. Is it somehow sending <code>$/lean/plainGoal</code> (which is very much a Lean-specific method) to a server which is not Lean?</p>",
        "id": 402950487,
        "sender_full_name": "Richard Copley",
        "timestamp": 1700364218
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"400544\">Richard Copley</span> <a href=\"#narrow/stream/270676-lean4/topic/The.20connected.20server.28s.29.20does.20not.20support.20method.20.24.2Flean.2Fplain/near/402950487\">said</a>:</p>\n<blockquote>\n<p>I know very little about Doom. Not much to go on since I can't reproduce the problem. I'm not even sure what questions to ask. The message from lsp-mode does not seem right at all. Is it somehow sending <code>$/lean/plainGoal</code> (which is very much a Lean-specific method) to a server which is not Lean?</p>\n</blockquote>\n<p>I'm also not sure what's going on since deleting <code>.emacs</code> and reinstalling doom fixed this problem.</p>",
        "id": 402965504,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1700373182
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> has marked this topic as resolved.</p>",
        "id": 402965510,
        "sender_full_name": "Notification Bot",
        "timestamp": 1700373185
    },
    {
        "content": "<p>I'm also experiencing this issue. See<br>\n<a href=\"https://github.com/leanprover-community/lean4-mode/issues/54\">https://github.com/leanprover-community/lean4-mode/issues/54</a></p>",
        "id": 456881884,
        "sender_full_name": "Atticus Kuhn",
        "timestamp": 1722957124
    },
    {
        "content": "<p>Did you find out anything more about what is causing this issue?</p>",
        "id": 456882072,
        "sender_full_name": "Atticus Kuhn",
        "timestamp": 1722957175
    },
    {
        "content": "<p>I also encountered this same error.<br>\nHere's what I did: </p>\n<ol>\n<li>Ran <code>lake new lean_test math</code></li>\n<li>Opened the file <code>Basic.lean</code> in Emacs</li>\n<li>Tried the command <code>lean4-toggle-info</code></li>\n<li>Got this error.</li>\n</ol>\n<p>Here is the error I got</p>\n<div class=\"codehilite\" data-code-language=\"Common Lisp\"><pre><span></span><code><span class=\"nv\">Debugger</span><span class=\"w\"> </span><span class=\"nv\">entered--Lisp</span><span class=\"w\"> </span><span class=\"nv\">error:</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nb\">error</span><span class=\"w\"> </span><span class=\"s\">\"The connected server(s) does not support method $/...\"</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"nb\">error</span><span class=\"p\">(</span><span class=\"s\">\"The connected server(s) does not support method %s...\"</span><span class=\"w\"> </span><span class=\"s\">\"$/lean/plainGoal\"</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"nv\">lsp--send-request-async</span><span class=\"p\">((</span><span class=\"ss\">:jsonrpc</span><span class=\"w\"> </span><span class=\"s\">\"2.0\"</span><span class=\"w\"> </span><span class=\"ss\">:method</span><span class=\"w\"> </span><span class=\"s\">\"$/lean/plainGoal\"</span><span class=\"w\"> </span><span class=\"ss\">:params</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"ss\">:textDocument</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"ss\">:uri</span><span class=\"w\"> </span><span class=\"s\">\"file:///home/atticusk/coding/lean_test/LeanTest/Ba...\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"ss\">:position</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"ss\">:line</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"ss\">:character</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">)))</span><span class=\"w\"> </span><span class=\"err\">#</span><span class=\"nv\">&lt;subr</span><span class=\"w\"> </span><span class=\"nv\">F616e6f6e796d6f75732d6c616d626461_anonymous_lambda_72&gt;</span><span class=\"w\"> </span><span class=\"nv\">tick</span><span class=\"w\"> </span><span class=\"k\">ignore</span><span class=\"w\"> </span><span class=\"no\">nil</span><span class=\"w\"> </span><span class=\"no\">nil</span><span class=\"w\"> </span><span class=\"ss\">:plain-goal</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"nv\">lsp-request-async</span><span class=\"p\">(</span><span class=\"s\">\"$/lean/plainGoal\"</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"ss\">:textDocument</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"ss\">:uri</span><span class=\"w\"> </span><span class=\"s\">\"file:///home/atticusk/coding/lean_test/LeanTest/Ba...\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"ss\">:position</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"ss\">:line</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"ss\">:character</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"err\">#</span><span class=\"nv\">&lt;subr</span><span class=\"w\"> </span><span class=\"nv\">F616e6f6e796d6f75732d6c616d626461_anonymous_lambda_72&gt;</span><span class=\"w\"> </span><span class=\"ss\">:error-handler</span><span class=\"w\"> </span><span class=\"k\">ignore</span><span class=\"w\"> </span><span class=\"ss\">:mode</span><span class=\"w\"> </span><span class=\"nv\">tick</span><span class=\"w\"> </span><span class=\"ss\">:cancel-token</span><span class=\"w\"> </span><span class=\"ss\">:plain-goal</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"nv\">lean4-info-buffer-refresh</span><span class=\"p\">()</span>\n<span class=\"w\">  </span><span class=\"nv\">lean4-toggle-info</span><span class=\"p\">()</span>\n<span class=\"w\">  </span><span class=\"nv\">funcall-interactively</span><span class=\"p\">(</span><span class=\"nv\">lean4-toggle-info</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"nv\">command-execute</span><span class=\"p\">(</span><span class=\"nv\">lean4-toggle-info</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>Emacs version: GNU Emacs 29.4 (build 1, x86_64-pc-linux-gnu, X toolkit, cairo version 1.18.0, Xaw3d scroll bars)<br>\nElan version: elan 3.1.1</p>\n<p>By the way, if it helps, here is the lsp-log</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Command</span><span class=\"w\"> </span><span class=\"s2\">\"/etc/profiles/per-user/atticusk/bin/lake serve\"</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">present</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">path</span><span class=\"bp\">.</span>\n<span class=\"n\">Command</span><span class=\"w\"> </span><span class=\"s2\">\"/etc/profiles/per-user/atticusk/bin/lake serve\"</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">present</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">path</span><span class=\"bp\">.</span>\n<span class=\"n\">Found</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">following</span><span class=\"w\"> </span><span class=\"n\">clients</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">atticusk</span><span class=\"bp\">/</span><span class=\"n\">coding</span><span class=\"bp\">/</span><span class=\"n\">lean_test</span><span class=\"bp\">/</span><span class=\"n\">LeanTest</span><span class=\"bp\">/</span><span class=\"n\">Basic</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">server</span><span class=\"bp\">-</span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">lsp</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">priority</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n<span class=\"n\">The</span><span class=\"w\"> </span><span class=\"n\">following</span><span class=\"w\"> </span><span class=\"n\">clients</span><span class=\"w\"> </span><span class=\"n\">were</span><span class=\"w\"> </span><span class=\"n\">selected</span><span class=\"w\"> </span><span class=\"n\">based</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">priority</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">server</span><span class=\"bp\">-</span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">lsp</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">priority</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 456883234,
        "sender_full_name": "Atticus Kuhn",
        "timestamp": 1722957461
    },
    {
        "content": "<p>cc: <span class=\"user-mention\" data-user-id=\"599027\">@Leni Aniva</span> <span class=\"user-mention\" data-user-id=\"400544\">@Richard Copley</span></p>",
        "id": 456883483,
        "sender_full_name": "Atticus Kuhn",
        "timestamp": 1722957513
    },
    {
        "content": "<p>Nevermind, I somehow got it to work, but I'm not sure how it happened. I think it began working after I did <code>lsp-workspace-blocklist-remove</code>, although I'm not sure why that would cause it to begin working.</p>",
        "id": 456887792,
        "sender_full_name": "Atticus Kuhn",
        "timestamp": 1722958591
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"739328\">Atticus Kuhn</span> <a href=\"#narrow/stream/270676-lean4/topic/.E2.9C.94.20The.20connected.20server.28s.29.20does.20not.20support.20method.20.24.2Flean.2F.2E.2E.2E/near/456887792\">said</a>:</p>\n<blockquote>\n<p>Nevermind, I somehow got it to work, but I'm not sure how it happened. I think it began working after I did <code>lsp-workspace-blocklist-remove</code>, although I'm not sure why that would cause it to begin working.</p>\n</blockquote>\n<p>Same. I don't know how i fixed it but it works now</p>",
        "id": 459920877,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1723398929
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/270676-lean4/topic/.E2.9C.94.20The.20connected.20server.28s.29.20does.20not.20support.20method.20.24.2Flean.2F.2E.2E.2E/near/402940033\">said</a>:</p>\n<blockquote>\n<p>Has anyone seen this problem?</p>\n<p>I'm using Emacs' <a href=\"https://github.com/leanprover/lean4-mode\">lean4-mode</a> package and with Lean version <code>leanprover/lean4:4.2.0</code> (4.1.0 also doesn't work). When I turn on the info buffer, lsp prints:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">The</span><span class=\"w\"> </span><span class=\"n\">connected</span><span class=\"w\"> </span><span class=\"n\">server</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">support</span><span class=\"w\"> </span><span class=\"n\">method</span><span class=\"w\"> </span><span class=\"bp\">$/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">plainGoal</span><span class=\"bp\">.</span>\n<span class=\"n\">To</span><span class=\"w\"> </span><span class=\"n\">find</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">what</span><span class=\"w\"> </span><span class=\"n\">capabilities</span><span class=\"w\"> </span><span class=\"n\">support</span><span class=\"w\"> </span><span class=\"n\">your</span><span class=\"w\"> </span><span class=\"n\">server</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"bp\">‘</span><span class=\"n\">M</span><span class=\"bp\">-</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">lsp</span><span class=\"bp\">-</span><span class=\"n\">describe</span><span class=\"bp\">-</span><span class=\"n\">session</span><span class=\"bp\">’</span>\n<span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">expand</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">capabilities</span><span class=\"w\"> </span><span class=\"kn\">section</span>\n</code></pre></div>\n<p>and the Lean bufffer is empty.</p>\n</blockquote>\n<p>I have this issue on my laptop but not on my desktop computer. The Doom Emacs configuration files in my computers are the same. I'm currently reinstalling Doom Emacs on my laptop.</p>\n<p>Update: Doom Emacs is now working fine on my laptop. I'm not sure why.</p>",
        "id": 481859160,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1731383494
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 484506070,
        "sender_full_name": "Mekeor Melire",
        "timestamp": 1732625458
    },
    {
        "content": "<p>This topic was moved here from <a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/.E2.9C.94.20The.20connected.20server.28s.29.20does.20not.20support.20method.20.24.2Flean.2F.2E.2E.2E\">#lean4 &gt; ✔ The connected server(s) does not support method $/lean/...</a> by <span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span>.</p>",
        "id": 484506981,
        "sender_full_name": "Notification Bot",
        "timestamp": 1732625735
    }
]