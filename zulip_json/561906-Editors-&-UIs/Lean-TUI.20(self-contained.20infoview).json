[
    {
        "content": "<p>I am creating a TUI with Ratatui for Lean. It is accompanied by a proxy LSP that intercepts Lake LSP. It can be used for anyone who doesnt want to use VS Code's info  view, but still wants to be able to see proof state changing while developing (Helix, or any other editor with LSP client). </p>\n<p>Try it out here: <a href=\"https://codeberg.org/wvhulle/lean-tui/src/branch/main\">https://codeberg.org/wvhulle/lean-tui/src/branch/main</a></p>\n<p>Here is a screenshot of the before / after feature with the proof of infinite primes focused</p>\n<p><a href=\"/user_uploads/3121/WFeu06SuNe6KFPLh1YbLXYJG/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/WFeu06SuNe6KFPLh1YbLXYJG/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1781x424\" src=\"/user_uploads/thumbnail/3121/WFeu06SuNe6KFPLh1YbLXYJG/image.png/840x560.webp\"></a></div>",
        "id": 569976231,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769368887
    },
    {
        "content": "<p>This topic was moved here from <a class=\"stream-topic\" data-stream-id=\"341532\" href=\"/#narrow/channel/341532-lean4-dev/topic/Lean-TUI.20.28self-contained.20infoview.29\">#lean4 dev &gt; Lean-TUI (self-contained infoview)</a> by <span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span>.</p>",
        "id": 569977578,
        "sender_full_name": "Notification Bot",
        "timestamp": 1769370063
    },
    {
        "content": "<p>Wow! This is great to hear. I was getting ready to build something like this myself, but what you've done sounds way better than what I was going to make! <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>\n<p>Here is a topic I started recently trying to find out whether something like Lean-TUI exists: <a class=\"stream-topic\" data-stream-id=\"113488\" href=\"/#narrow/channel/113488-general/topic/Editor-decoupled.20file-watching.20proof-state-outputing.20tool/with/569992762\">#general &gt; Editor-decoupled file-watching proof-state-outputing tool</a></p>",
        "id": 569992953,
        "sender_full_name": "Castedo Ellerman",
        "timestamp": 1769387113
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"992537\">Castedo Ellerman</span> <a href=\"#narrow/channel/113488-general/topic/Lean-TUI.20.28self-contained.20infoview.29/near/569992953\">said</a>:</p>\n<blockquote>\n<p>Wow! This is great to hear. I was getting ready to build something like this myself, but what you've done sounds way better than what I was going to make! <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>\n<p>Here is a topic I started recently trying to find out whether something like Lean-TUI exists: <a class=\"stream-topic\" data-stream-id=\"113488\" href=\"/#narrow/channel/113488-general/topic/Editor-decoupled.20file-watching.20proof-state-outputing.20tool/with/569992762\">#general &gt; Editor-decoupled file-watching proof-state-outputing tool</a></p>\n</blockquote>\n<p>I should maybe have waited a bit for posting it since itâ€™s mostly a prototype written in one day. Please give me a few days to improve it a bit.</p>",
        "id": 570030404,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769415375
    },
    {
        "content": "<p>Published an easier to install package on <a href=\"https://crates.io/crates/lean-tui\">https://crates.io/crates/lean-tui</a></p>",
        "id": 570050399,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769421599
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"928352\">Willem vanhulle</span> <a href=\"#narrow/channel/113488-general/topic/Lean-TUI.20.28self-contained.20infoview.29/near/570030404\">said</a>:</p>\n<blockquote>\n<p>I should maybe have waited a bit for posting it since itâ€™s mostly a prototype written in one day.</p>\n</blockquote>\n<p>No! I'm glad you posted about your prototype because:</p>\n<ol>\n<li>we all can make smarter plans being aware of the smart work you're doing</li>\n<li>prototypes are great for testing, learning, seeing what works, what does not work, etc...</li>\n<li>this week I am learning Lean via textbook/tutorials etc... and I can use both Lean-TUI and VSCodium and <a href=\"https://castedo.gitlab.io/vim9-lean/\">https://castedo.gitlab.io/vim9-lean/</a> and start documenting what is missing pros/cons, between VSCodium vs not.</li>\n</ol>\n<blockquote>\n<p>Please give me a few days to improve it a bit.</p>\n</blockquote>\n<p>Great to hear you want to improve the prototype, thank you!</p>",
        "id": 570053410,
        "sender_full_name": "Castedo Ellerman",
        "timestamp": 1769422530
    },
    {
        "content": "<p>Here is a better diagram of the architecture of this editor plugin</p>\n<p><a href=\"/user_uploads/3121/dYlgjkEaXaGPZXH8xTWpBUSe/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/dYlgjkEaXaGPZXH8xTWpBUSe/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"2351x466\" src=\"/user_uploads/thumbnail/3121/dYlgjkEaXaGPZXH8xTWpBUSe/image.png/840x560.webp\"></a></div>",
        "id": 570098527,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769435827
    },
    {
        "content": "<p>As can be found on <a href=\"https://codeberg.org/wvhulle/lean-tui\">https://codeberg.org/wvhulle/lean-tui</a></p>",
        "id": 570098589,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769435843
    },
    {
        "content": "<p>Regarding the protocol over the Unix socket between <code>lean-tui proxy</code> and <code>lean-tui view</code>, what is the possibility of that being a stable protocol and compatible with other applications in other programming languages?</p>",
        "id": 570100255,
        "sender_full_name": "Castedo Ellerman",
        "timestamp": 1769436230
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"992537\">Castedo Ellerman</span> <a href=\"#narrow/channel/113488-general/topic/Lean-TUI.20.28self-contained.20infoview.29/near/570100255\">zei</a>:</p>\n<blockquote>\n<p>?</p>\n</blockquote>\n<p>I haven't researched previous work on this, but I needed things that are explicitly not in the LSP protocol for displaying proof state and navigating in it.</p>",
        "id": 570100875,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769436389
    },
    {
        "content": "<p>My question is a bit ambiguous. I didn't mean \"stable protocol\" as in a protocol that already exists. I just mean something the you and/or Lean community establish that can transmit over local unix domain socket. My experience here is a little weak. I'm somewhat familiar with Google Protocol Buffers (Protobuf) which sounds nice, but I haven't used it much.</p>",
        "id": 570102259,
        "sender_full_name": "Castedo Ellerman",
        "timestamp": 1769436756
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"992537\">Castedo Ellerman</span> <a href=\"#narrow/channel/113488-general/topic/Lean-TUI.20.28self-contained.20infoview.29/near/570102259\">zei</a>:</p>\n<blockquote>\n<p>My question is a bit ambiguous. I didn't mean \"stable protocol\" as in a protocol that already exists. I just mean something the you and/or Lean community establish that can transmit over local unix domain socket. My experience here is a little weak. I'm somewhat familiar with Google Protocol Buffers (Protobuf) which sounds nice, but I haven't used it much.</p>\n</blockquote>\n<p>If you like pain, go for Google Protocol Buffers ;). In this case, the latency over the Unix socket is microseconds at most and the data size is very small, so I wouldn't bother trying to do better than JSON</p>",
        "id": 570102624,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769436856
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"928352\">Willem vanhulle</span> <a href=\"#narrow/channel/113488-general/topic/Lean-TUI.20.28self-contained.20infoview.29/near/570102624\">said</a>:</p>\n<blockquote>\n<p>In this case, the latency over the Unix socket is microseconds at most and the data size is very small, so I wouldn't bother trying to do better than JSON</p>\n</blockquote>\n<p>OK, that makes sense. The overhead of profobuf for low-level performance is not worth it. There is one thing that seems better than \"just JSON\" which is something like <code>.proto</code> files which allow language independent definition of the messages/records/fields. And then libraries for specific languages that will correctly serialize/deserialize based on those definitions. Do you have a recommendation on how to define the JSON messages so that applications in Python or TypeScript or Rust or Lean can easily and correctly read/write those JSON messages?</p>",
        "id": 570121650,
        "sender_full_name": "Castedo Ellerman",
        "timestamp": 1769441156
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"992537\">Castedo Ellerman</span> <a href=\"#narrow/channel/113488-general/topic/Lean-TUI.20.28self-contained.20infoview.29/near/570121650\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"928352\">Willem vanhulle</span> <a href=\"#narrow/channel/113488-general/topic/Lean-TUI.20.28self-contained.20infoview.29/near/570102624\">said</a>:</p>\n<blockquote>\n<p>In this case, the latency over the Unix socket is microseconds at most and the data size is very small, so I wouldn't bother trying to do better than JSON</p>\n</blockquote>\n<p>OK, that makes sense. The overhead of profobuf for low-level performance is not worth it. There is one thing that seems better than \"just JSON\" which is something like <code>.proto</code> files which allow language independent definition of the messages/records/fields. And then libraries for specific languages that will correctly serialize/deserialize based on those definitions. Do you have a recommendation on how to define the JSON messages so that applications in Python or TypeScript or Rust or Lean can easily and correctly read/write those JSON messages?</p>\n</blockquote>\n<p>There is something called JSON schema for specifying formats of JSON.</p>",
        "id": 570128938,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769442854
    },
    {
        "content": "<p>But you would only use that when there are actual consumers down the road using completely different types front ends</p>",
        "id": 570129073,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769442896
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"928352\">Willem vanhulle</span> <a href=\"#narrow/channel/113488-general/topic/Lean-TUI.20.28self-contained.20infoview.29/near/570129073\">said</a>:</p>\n<blockquote>\n<p>when there are actual consumers down the road using completely different types front ends</p>\n</blockquote>\n<p>I think what I am starting to imagine is that long-term <code>lean --serve</code> eventually provides a socket connection like <code>lean-tui proxy</code> in some multi-language friendly JSON protocol. Then multiple different tools, including <code>lean-tui view</code> and \"Lean-LocalWebApp\" (<a class=\"message-link\" href=\"/#narrow/channel/113488-general/topic/Editor-decoupled.20file-watching.20proof-state-outputing.20tool/near/570098864\">#general &gt; Editor-decoupled file-watching proof-state-outputing tool @ ðŸ’¬</a>) and potentially more can read that JSON protocol full of Lean specific stuff without needing to be an LSP protocol. Ideally this socket connection handles mutliple connections (I think).</p>\n<p>If <code>lean-tui</code> supports this JSON protocol then the timing of <code>lean --serve</code> obsoleting <code>lean-tui proxy</code> and the timing of  <code>lean-tui view</code> and <code>Lean-LocalWebApp</code> and clients working with either server/proxy can be decoupled.</p>",
        "id": 570133189,
        "sender_full_name": "Castedo Ellerman",
        "timestamp": 1769443841
    },
    {
        "content": "<blockquote>\n<p>I think what I am starting to imagine is that long-term <code>lean --serve</code> eventually provides a socket connection like <code>lean-tui proxy</code> in some multi-language friendly JSON protocol.</p>\n</blockquote>\n<p>This sentence is a pretty good description of what LSP itself is. It's a multi-language friendly protocol, specified to serialize to JSON (though in theory that choice could have been whatever your favorite serialization format is, say protobuf), and then it has mechanisms for adding extension requests which are specific to a single language or language server. Lean uses those, it schematizes what their parameters and responses are, and it defines when you're supposed to call them. I see you saying \"without needing to be an LSP protocol\" -- but in general being LSP is a plus, not a minus, it means you can pull any LSP client in any language you'd like and start talking to the thing. If you're asking for machine-readable LSP, this is discussed quite a bit on the LSP specification repo, e.g. <a href=\"https://github.com/microsoft/language-server-protocol/issues/67\">https://github.com/microsoft/language-server-protocol/issues/67</a> and there's a bunch of JSON Schemas for LSP itself lying around, but also typescript people love typescript and typescript interfaces (just like Lean people love Lean, and JSON Schema people love JSON Schema), so in practice I think people generating different machine-readable formats is always a reality for schema languages.</p>",
        "id": 570137508,
        "sender_full_name": "Julian Berman",
        "timestamp": 1769444971
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321696\">Julian Berman</span> <a href=\"#narrow/channel/113488-general/topic/Lean-TUI.20.28self-contained.20infoview.29/near/570137508\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>I think what I am starting to imagine is that long-term <code>lean --serve</code> eventually provides a socket connection like <code>lean-tui proxy</code> in some multi-language friendly JSON protocol.</p>\n</blockquote>\n<p>This sentence is a pretty good description of what LSP itself is. It's a multi-language friendly protocol, specified to serialize to JSON (though in theory that choice could have been whatever your favorite serialization format is, say protobuf), and then it has mechanisms for adding extension requests which are specific to a single language or language server. Lean uses those, it schematizes what their parameters and responses are, and it defines when you're supposed to call them. I see you saying \"without needing to be an LSP protocol\" -- but in general being LSP is a plus, not a minus, it means you can pull any LSP client in any language you'd like and start talking to the thing. If you're asking for machine-readable LSP, this is discussed quite a bit on the LSP specification repo, e.g. <a href=\"https://github.com/microsoft/language-server-protocol/issues/67\">https://github.com/microsoft/language-server-protocol/issues/67</a> and there's a bunch of JSON Schemas for LSP itself lying around, but also typescript people love typescript and typescript interfaces (just like Lean people love Lean, and JSON Schema people love JSON Schema), so in practice I think people generating different machine-readable formats is always a reality for schema languages.</p>\n</blockquote>\n<p>It also depends on the editor and indirectly the LSP client of the editor. Most editors implement a portion of the LSP protocol. Lean LSP server only emits a portion of the LSP protocol. Editors like Helix are very opinionated and refuse certain extensions like custom views or custom cursor tracking. You need to work around that somehow.</p>",
        "id": 570138556,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769445260
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"992537\">Castedo Ellerman</span> <a href=\"#narrow/channel/113488-general/topic/Lean-TUI.20.28self-contained.20infoview.29/near/570133189\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"928352\">Willem vanhulle</span> <a href=\"#narrow/channel/113488-general/topic/Lean-TUI.20.28self-contained.20infoview.29/near/570129073\">said</a>:</p>\n<blockquote>\n<p>when there are actual consumers down the road using completely different types front ends</p>\n</blockquote>\n<p>I think what I am starting to imagine is that long-term <code>lean --serve</code> eventually provides a socket connection like <code>lean-tui proxy</code> in some multi-language friendly JSON protocol. Then multiple different tools, including <code>lean-tui view</code> and \"Lean-LocalWebApp\" (<a class=\"message-link\" href=\"/#narrow/channel/113488-general/topic/Editor-decoupled.20file-watching.20proof-state-outputing.20tool/near/570098864\">#general &gt; Editor-decoupled file-watching proof-state-outputing tool @ ðŸ’¬</a>) and potentially more can read that JSON protocol full of Lean specific stuff without needing to be an LSP protocol. Ideally this socket connection handles mutliple connections (I think).</p>\n<p>If <code>lean-tui</code> supports this JSON protocol then the timing of <code>lean --serve</code> obsoleting <code>lean-tui proxy</code> and the timing of  <code>lean-tui view</code> and <code>Lean-LocalWebApp</code> and clients working with either server/proxy can be decoupled.</p>\n</blockquote>\n<p>What do you mean with timing and obsoleting?</p>",
        "id": 570138863,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769445342
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321696\">Julian Berman</span> <a href=\"#narrow/channel/113488-general/topic/Lean-TUI.20.28self-contained.20infoview.29/near/570137508\">said</a>:</p>\n<blockquote>\n<p>but in general being LSP is a plus, not a minus, it means you can pull any LSP client</p>\n</blockquote>\n<p>To make sure we are on the same page: my understanding is only one LSP client process can connect to an LSP server process? and as <code>lean --serve</code> is currently implemented only one LSP client process can connect to the LSP server endpoint of <code>lean -serve</code>. Are both these statements true?</p>",
        "id": 570139251,
        "sender_full_name": "Castedo Ellerman",
        "timestamp": 1769445452
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"928352\">Willem vanhulle</span> <a href=\"#narrow/channel/113488-general/topic/Lean-TUI.20.28self-contained.20infoview.29/near/570138863\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>If <code>lean-tui</code> supports this JSON protocol then the timing of <code>lean --serve</code> obsoleting <code>lean-tui proxy</code> and the timing of <code>lean-tui view</code> and <code>Lean-LocalWebApp</code> and clients working with either server/proxy can be decoupled.</p>\n</blockquote>\n<p>What do you mean with timing and obsoleting?</p>\n</blockquote>\n<p>I mean in the hypothetical future possibility that <code>lean --serve</code> serves a socket connection like <code>lean-tui proxy</code> and there are other clients like <code>lean-tui view</code>, like perhaps Lean-LocalWebApp, then people can mix-and-match those possibilties as they happen in the future. Whether anything is obsoleting I don' t know, but it would allow that possibilty. By timing I just mean the timing of future projects and possiblities of this mixing.</p>",
        "id": 570141123,
        "sender_full_name": "Castedo Ellerman",
        "timestamp": 1769445858
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"992537\">Castedo Ellerman</span> <a href=\"#narrow/channel/113488-general/topic/Lean-TUI.20.28self-contained.20infoview.29/near/570139251\">said</a>:</p>\n<blockquote>\n<p>To make sure we are on the same page: my understanding is only one LSP client process can connect to an LSP server process? and as <code>lean --serve</code> is currently implemented only one LSP client process can connect to the LSP server endpoint of <code>lean -serve</code>. Are both these statements true?</p>\n</blockquote>\n<p>LSP is currently single-client. Searching found me <a href=\"https://github.com/microsoft/language-server-protocol/issues/67\">https://github.com/microsoft/language-server-protocol/issues/67</a> which explicitly says there's no interest in changing that anytime soon, but also links to a somewhat \"obvious\" kind of tool which muxes incoming requests from multiple clients. I guess if I imagine where you're going with this, you want an editor and some non-editor second thing to connect to the same Lean server simultaneously? If so, lspmux or something like it would sound like maybe it's indeed relevant, but whether all the details work out needs checking.</p>",
        "id": 570145617,
        "sender_full_name": "Julian Berman",
        "timestamp": 1769447006
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321696\">Julian Berman</span> <a href=\"#narrow/channel/113488-general/topic/Lean-TUI.20.28self-contained.20infoview.29/near/570145617\">said</a>:</p>\n<blockquote>\n<p>you want an editor and some non-editor second thing to connect to the same Lean server simultaneously?</p>\n</blockquote>\n<p>Exactly! <span aria-label=\"this\" class=\"emoji emoji-1f446\" role=\"img\" title=\"this\">:this:</span></p>\n<p>Willem and I have a prototype of this working now where we have our favorite editor (Helix and vim 9 respectively) connecting via stdio to a subprocess of (<code>lean-tui proxy</code> + <code>lake server</code>) and then also connecting to that very same process, but via a socket insted of stdio, is a non-editor second thing, which is <code>lean-tui view</code> (running in a terminal window as a separate process).</p>\n<p>In the future, it might make sense for the subprocess of (<code>lean-tui proxy</code> + <code>lake server</code>) to be replaced with just (<code>lake server</code>).</p>\n<p>And in the future another non-editor thing that can connect via socket might be \"Lean-LocalWebApp\" with Lean widget support.</p>",
        "id": 570151420,
        "sender_full_name": "Castedo Ellerman",
        "timestamp": 1769448730
    },
    {
        "content": "<p>Add two more alternative display modes when PaperProof is installed:</p>\n<ul>\n<li>Deduction style tree (similar to the TypeScript implemented tree in VS Code)</li>\n<li>Proof steps and all goals and hypothesis in two separate panes</li>\n</ul>\n<p>Deduction style screenshot:<br>\n<a href=\"/user_uploads/3121/25LP5WhuM80tCyb5TZCMyBSt/deduction_style.png\">deduction_style.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/25LP5WhuM80tCyb5TZCMyBSt/deduction_style.png\" title=\"deduction_style.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1891x937\" src=\"/user_uploads/thumbnail/3121/25LP5WhuM80tCyb5TZCMyBSt/deduction_style.png/840x560.webp\"></a></div><p>Check out docs on how to switch display mode: <a href=\"https://codeberg.org/wvhulle/lean-tui\">https://codeberg.org/wvhulle/lean-tui</a></p>",
        "id": 570369848,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769532070
    },
    {
        "content": "<p>For those interested in technical disucssions relating to Lean-TUI, I have been submitting issues and discussions topics to <a href=\"https://codeberg.org/wvhulle/lean-tui/issues\">https://codeberg.org/wvhulle/lean-tui/issues</a>. <span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span> You might be interested in the LSP and lspmux related topic I'm wondering about: <a href=\"https://codeberg.org/wvhulle/lean-tui/issues/5\">https://codeberg.org/wvhulle/lean-tui/issues/5</a></p>\n<p>I'm communicating on <a href=\"http://codeberg.org\">codeberg.org</a> because I think that's what <span class=\"user-mention\" data-user-id=\"928352\">@Willem vanhulle</span> prefers, it seems a good forum for topics focused directly on what he is developing, and I like the idea of exploring forums that are not GitHub. Hopefully <a href=\"http://codeberg.org\">codeberg.org</a> has enough of the positive features of GitHub.</p>",
        "id": 570604765,
        "sender_full_name": "Castedo Ellerman",
        "timestamp": 1769617583
    },
    {
        "content": "<p>Added navigation with keyboard arrows and clicking for large proofs<br>\n<a href=\"/user_uploads/3121/65H2aIRNuPMp8zstNZVtFOiu/semantic_tableau.png\">semantic_tableau.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/65H2aIRNuPMp8zstNZVtFOiu/semantic_tableau.png\" title=\"semantic_tableau.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1886x915\" src=\"/user_uploads/thumbnail/3121/65H2aIRNuPMp8zstNZVtFOiu/semantic_tableau.png/840x560.webp\"></a></div><p>And better tactic tree view<br>\n<a href=\"/user_uploads/3121/ebvSd_Ply63jnvFQ3c4_JaWv/tactic_tree.png\">tactic_tree.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/ebvSd_Ply63jnvFQ3c4_JaWv/tactic_tree.png\" title=\"tactic_tree.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1886x915\" src=\"/user_uploads/thumbnail/3121/ebvSd_Ply63jnvFQ3c4_JaWv/tactic_tree.png/840x560.webp\"></a></div><p>For documentation and more see <a href=\"https://codeberg.org/wvhulle/lean-tui\">https://codeberg.org/wvhulle/lean-tui</a></p>",
        "id": 570630248,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769624192
    },
    {
        "content": "<p>Better architecture diagram</p>",
        "id": 571194766,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769864489
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/N1gMj4AvQihGi0RhqBYpoXf2/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/N1gMj4AvQihGi0RhqBYpoXf2/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1949x1445\" src=\"/user_uploads/thumbnail/3121/N1gMj4AvQihGi0RhqBYpoXf2/image.png/840x560.webp\"></a></div>",
        "id": 571194773,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769864495
    },
    {
        "content": "<p>Try it out at <a href=\"https://codeberg.org/wvhulle/lean-tui\">https://codeberg.org/wvhulle/lean-tui</a></p>",
        "id": 571194782,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769864513
    },
    {
        "content": "<p>Based on some feedback from <span class=\"user-mention\" data-user-id=\"992537\">@Castedo Ellerman</span>  and seeing many people have interest in integration with web-frontends, I moved from Unix socket to a universal TCP port. This means people only have to know the <a href=\"https://github.com/wvhulle/lean-dag/blob/main/protocol-schema.json\">JSON schema</a> (which should be reasonably stable from now on) to communicate with the Lean back-end <a href=\"https://github.com/wvhulle/lean-dag\">lean-dag</a>. All business logic was moved into this Lean back-end, so <a href=\"https://codeberg.org/wvhulle/lean-tui\">Lean-TUI</a> is now just a Rust front-end.</p>",
        "id": 571302998,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769967510
    },
    {
        "content": "<p>My understanding from the web is that Windows 10+ now support Unix domain sockets. So unix sockets is a good choice for a raw JSON stream. It's pretty safe that the unix socket path will not be reused whereas the TCP port space is more crowded. Idealy which socket is used if configurable which makes testing easier.</p>",
        "id": 571304492,
        "sender_full_name": "Castedo Ellerman",
        "timestamp": 1769968727
    },
    {
        "content": "<p>My main observation regarding listening on a local network TCP port is that it enables a <em>WebSockets</em> option for browser based web apps. This has security implications that require some thought about the protocol and user experience.</p>",
        "id": 571304744,
        "sender_full_name": "Castedo Ellerman",
        "timestamp": 1769968918
    },
    {
        "content": "<p>My recommendation is to decouple web based web apps connecting to local WebSockets TCP/IP ports and leave that for a separate local application. The separate location application can connect to the default unix domain socket.</p>",
        "id": 571304880,
        "sender_full_name": "Castedo Ellerman",
        "timestamp": 1769968999
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"992537\">Castedo Ellerman</span> <a href=\"#narrow/channel/561906-Editors-.26-UIs/topic/Lean-TUI.20.28self-contained.20infoview.29/near/571304880\">said</a>:</p>\n<blockquote>\n<p>My recommendation is to decouple web based web apps connecting to local WebSockets TCP/IP ports and leave that for a separate local application. The separate location application can connect to the default unix domain socket.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"992537\">@Castedo Ellerman</span> I love your enthusiasm, but I donâ€™t really understand what this has to do with Lean. Maybe this is the right moment to get your hands dirty and open some PRs on lean-dag? It is a great moment to practice your Lean skills.</p>",
        "id": 571305474,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769969473
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"928352\">Willem vanhulle</span> <a href=\"#narrow/channel/561906-Editors-.26-UIs/topic/Lean-TUI.20.28self-contained.20infoview.29/near/571305474\">said</a>:</p>\n<blockquote>\n<p>I donâ€™t really understand what this has to do with Lean.</p>\n</blockquote>\n<p>I assume by \"this\" you mean my recommendation. My recommendation has to do with your move from UNIX socket to TCP port. You said it was based on feedback from me. But this was my feedback: <a href=\"https://codeberg.org/wvhulle/lean-tui/issues/3\">https://codeberg.org/wvhulle/lean-tui/issues/3</a> and I closed it as feedback to keep the WebSockets applications separate.</p>\n<p>And you said the move is also due to people having an interest in integration with web-frontends. Web-front-ends need a WebSockets connection. Last time I checked your JSON protocol on the UNIX socket is not a WebSockets connection. So it can't be used by a web frontend. So i'm surprised you have moved to TCP because that just introduces risk of port collision.</p>\n<blockquote>\n<p>Maybe this is the right moment to get your hands dirty and open some PRs on lean-dag? It is a great moment to practice your Lean skills.</p>\n</blockquote>\n<p>Maybe. At this moment I have near-zero Lean skills for I have no Lean skills to practice with. <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span> But hopefully that changes in the not too distant future.</p>",
        "id": 571306378,
        "sender_full_name": "Castedo Ellerman",
        "timestamp": 1769970332
    },
    {
        "content": "<p>I think it would be more efficient for you to work with Lean a bit before investing too much time working on UI for Lean. Using Lean is <em>very</em> different from using other programming languages, and you may realize that a lot of common wisdom does not apply here.</p>",
        "id": 571319479,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1769983739
    },
    {
        "content": "<p>Note this doesnâ€™t mean there is nothing interesting and relevant to do about Lean UI (and I still have nightmares haunting me from the time I was forced to use VSCode because lean.nvim was not yet ready). Iâ€™m talking about effort optimization here.</p>",
        "id": 571319598,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1769983854
    },
    {
        "content": "<p>Does anyone here have any need to visualise monadic lean programs? I know there is separation logic and Hoare triples, but I donâ€™t know if there is an actual demand for such a feature in a Lean Infoview UI?</p>",
        "id": 571321020,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1769985409
    },
    {
        "content": "<p>Can you sketch an example in mspaint or similar to what you have in mind? Do you mean a tree of Hoare triples derivations?</p>",
        "id": 571322028,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1769986505
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"933054\">Snir Broshi</span> <a href=\"#narrow/channel/561906-Editors-.26-UIs/topic/Lean-TUI.20.28self-contained.20infoview.29/near/571322028\">zei</a>:</p>\n<blockquote>\n<p>Can you sketch an example in mspaint or similar to what you have in mind? Do you mean a tree of Hoare triples derivations?</p>\n</blockquote>\n<p>I made a version inspired by Aeneas that shows backward and forward aspects of effects. It's just an idea, but I am new to Aeneas so it is not entirely clear what the most efficient display would be.</p>\n<p><a href=\"/user_uploads/3121/plcMKYTiVaZl6Q34PrkGEOlk/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/plcMKYTiVaZl6Q34PrkGEOlk/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1401x774\" src=\"/user_uploads/thumbnail/3121/plcMKYTiVaZl6Q34PrkGEOlk/image.png/840x560.webp\"></a></div><p>I am also experimenting with visualizations of pure functional programs</p>\n<p><a href=\"/user_uploads/3121/MxW1LLk7-vsC6_g4iPxfYZaf/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/MxW1LLk7-vsC6_g4iPxfYZaf/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1401x774\" src=\"/user_uploads/thumbnail/3121/MxW1LLk7-vsC6_g4iPxfYZaf/image.png/840x560.webp\"></a></div><p>The idea is that users can use built-in rules for data / effect flow visualization or provide their own by importing the Lean backend <a href=\"https://codeberg.org/wvhulle/lean-dag\">https://codeberg.org/wvhulle/lean-dag</a></p>\n<p>All logic was moved to the Lean back-end to make it easier for Lean users to contribute and maintain.</p>",
        "id": 571973961,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1770227238
    },
    {
        "content": "<p>Changes: make coloring consistent and show diagnostics next to nodes in diagram.</p>\n<p>Get latest version 0.6.2 at <a href=\"https://crates.io/crates/lean-tui\">https://crates.io/crates/lean-tui</a></p>\n<h3>Plain Goals View</h3>\n<p>Just shows the proof as a list of hypotheses and goals. When an error is active around the cursor position, it also shown. Select a hypotheses or goal and press <code>g</code> to move your cursor in your editor to the location where it was introduced. Press <code>y</code> to copy it to you clipboard for pasting elsewhere.</p>\n<p>Hypotheses are blue. Goals are orange. Errors are red.</p>\n<p>![(Screenshot at Codeberg)](<a href=\"https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/plain_view.png\">https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/plain_view.png</a>)</p>\n<div class=\"message_inline_image\"><a href=\"https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/plain_view.png\"><img src=\"https://uploads.zulipusercontent.net/c6cee523449f90e4c15f3300239159e37c6aba38/68747470733a2f2f636f6465626572672e6f72672f777668756c6c652f6c65616e2d7475692f6d656469612f6272616e63682f6d61696e2f73637265656e73686f74732f706c61696e5f766965772e706e67\"></a></div><p>For the <strong>VS Code users</strong>: Yes, the official info view endorsed by the Lean organization is written for VS Code, However, I don't like VS Code and vendor lock-in. We should all try to move away from any Microsoft-owned product as soon as possible. Why? Take a look at for example <a href=\"https://en.wikipedia.org/wiki/Embrace,_extend,_and_extinguish\">\"Embrace, extend, and extinguish\"</a> but also the recent news.</p>\n<p>For the <strong>Neovim users</strong>, yes there existed an info view <a href=\"https://github.com/Julian/lean.nvim\">Lean plugin for Neovim</a> already, but not yet for the other terminal editors (Zed, Kakoune, Helix, ...) since the Lean plugin relies on Neovim specific features. It is not a generic one.</p>\n<h3>Semantic Tableau View</h3>\n<p>Visualizes your active proof as a semantic tableau. This is based on how logicians traditionally render their deductions. Errors are often too long and would not fit in a node alone, so you can click on it to expand it in a popup at the top of the screen. Press <code>escape</code> to close the popup or select another node.</p>\n<p>Again, press <code>g</code> to jump to the selected hypothesis or goal. Use the arrow keys or <code>hjkl</code> to jump with keyboard only.</p>\n<p>![(Screenshot in repo)](<a href=\"https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/semantic_tableau.png\">https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/semantic_tableau.png</a>) |</p>\n<div class=\"message_inline_image\"><a href=\"https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/semantic_tableau.png\"><img src=\"https://uploads.zulipusercontent.net/038bbc21f1bc2f357a023cdd7e00a0b2877cb407/68747470733a2f2f636f6465626572672e6f72672f777668756c6c652f6c65616e2d7475692f6d656469612f6272616e63682f6d61696e2f73637265656e73686f74732f73656d616e7469635f7461626c6561752e706e67\"></a></div><p>For <strong><a href=\"https://github.com/Paper-Proof/paperproof\">Paperproof</a> users</strong>: Paperproof was a big inspiration for this view. However, it is Web-based. I used their approach to move most of the logic into Lean and add an RPC method there.</p>\n<h3>Before/After View</h3>\n<p>Shows active goal state and on the left also the previous state. You can hide the previous state pane with <code>p</code> and also show the next pane with <code>n</code> (disabled by default).</p>\n<p>In addition to the default colors, assumptions, or hypotheses that are added are highlighted in green. Removed ones are highlighted in red. Errors from cursor position are also shown if present.</p>\n<p>![(Screenshot in repo)](<a href=\"https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/before_after.png\">https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/before_after.png</a>)</p>\n<div class=\"message_inline_image\"><a href=\"https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/before_after.png\"><img src=\"https://uploads.zulipusercontent.net/4391e590b1751c8beb7b93f7c16ad272125c8b1c/68747470733a2f2f636f6465626572672e6f72672f777668756c6c652f6c65616e2d7475692f6d656469612f6272616e63682f6d61696e2f73637265656e73686f74732f6265666f72655f61667465722e706e67\"></a></div><h3>Tactic Tree View</h3>\n<p>Shows a rendering of the proof displayed as compact Unicode tree on the left. On the right, you can see, active hypotheses and goals. The tree will update its location by focusing the active proof state at the cursor position.</p>\n<p>The same key bindings and colors apply as other views.</p>\n<p>![(Screenshot in repo)](<a href=\"https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/tactic_tree.png\">https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/tactic_tree.png</a>)</p>\n<div class=\"message_inline_image\"><a href=\"https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/tactic_tree.png\"><img src=\"https://uploads.zulipusercontent.net/5c8094f10e187a716febeaf7ca1dc8f7f3756ff7/68747470733a2f2f636f6465626572672e6f72672f777668756c6c652f6c65616e2d7475692f6d656469612f6272616e63682f6d61696e2f73637265656e73686f74732f7461637469635f747265652e706e67\"></a></div><h2>Graphs of Functional Programs</h2>\n<p>There are display modes focused on everything that is not a tactic proof. These modes should be useful for functional or monadic programming. You can test them out with some test files in <a href=\"http://./Samples\"><code>./Samples</code></a></p>\n<h3>Data Flow (Experimental)</h3>\n<p>Use this for term-style proofs (without <code>by</code> or tactics). You can also use it for normal pure functional programs. It shows a graph of the local bindings and expected types throughout the program</p>\n<p>The decomposition is based on a few built-in rules. However, not all Lean control flow has an accompanying rule. Please be patient as I add more rules or contribute yourself them to <a href=\"https://codeberg.org/wvhulle/lean-prism\"><code>lean-prism</code></a>. Rules can also be provided in user code and are picked up by <code>LeanPrism</code> (not tested yet).</p>\n<p>Open the legend with <code>L</code> to see what all symbols and colors mean.</p>\n<p>![(Screenshot in repo)](<a href=\"https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/data_flow.png\">https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/data_flow.png</a>)</p>\n<div class=\"message_inline_image\"><a href=\"https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/data_flow.png\"><img src=\"https://uploads.zulipusercontent.net/9f3925c74d7795202a24e32ba67afbbf84159b40/68747470733a2f2f636f6465626572672e6f72672f777668756c6c652f6c65616e2d7475692f6d656469612f6272616e63682f6d61696e2f73637265656e73686f74732f646174615f666c6f772e706e67\"></a></div><h3>Effect Flow (Experimental)</h3>\n<p>When working doing programming in a monad, you are doing some kind of effectful computations. Every monadic assignment in <code>Lean</code> written as <code>let &lt;- COMPUTATION</code> can be composed in two parts:</p>\n<ul>\n<li>What the computation produces, shown with a forward arrow</li>\n<li>What state changes are given back components (the effect), shown with a backward arrow</li>\n</ul>\n<p>This decomposition is not implemented yet for all monads. Please contribute if you have time. You just need to specify how to compute the forward and backward expressions and have to label edges. You can also provide rules in user code (not tested yet).</p>\n<p>The purple edges in the diagram are definition expansions (will be hide-able in future) and the blue ones are the monadic binds. Displaying errors is not implemented yet.</p>\n<p>Open the legend with <code>L</code> to see what all symbols mean.</p>\n<p>![(Screenshot in repo)](<a href=\"https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/effect_flow.png\">https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/effect_flow.png</a>)</p>\n<div class=\"message_inline_image\"><a href=\"https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/effect_flow.png\"><img src=\"https://uploads.zulipusercontent.net/bd9b1b8563aa6bb9dfe0418d8be3f5186139e748/68747470733a2f2f636f6465626572672e6f72672f777668756c6c652f6c65616e2d7475692f6d656469612f6272616e63682f6d61696e2f73637265656e73686f74732f6566666563745f666c6f772e706e67\"></a></div>",
        "id": 572558573,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1770489920
    },
    {
        "content": "<p>Has anyone got the time to try out v0.6? <span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span>  <span class=\"user-mention\" data-user-id=\"110031\">@Patrick Massot</span></p>",
        "id": 573090068,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1770741125
    },
    {
        "content": "<p>I haven't yet but I certainly mean to try it, I just have too much on my plate at this moment but certainly will try to give you some feedback (and again props for making something new and cool!)</p>",
        "id": 573094201,
        "sender_full_name": "Julian Berman",
        "timestamp": 1770742045
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321696\">Julian Berman</span> <a href=\"#narrow/channel/561906-Editors-.26-UIs/topic/Lean-TUI.20.28self-contained.20infoview.29/near/573094201\">zei</a>:</p>\n<blockquote>\n<p>I haven't yet but I certainly mean to try it, I just have too much on my plate at this moment but certainly will try to give you some feedback (and again props for making something new and cool!)</p>\n</blockquote>\n<p>Take your time. The front-end / UI features are relatively stable now. The Lean back-end is still being worked on. </p>\n<p>Things you may want to look out for while testing: the tactic-style proof views, layout, information displayed, confusing things, whether it is actually helpful... </p>\n<p>It has been a while that I actually did some real theorem proving, so it would nice to have some input from active Lean users.</p>",
        "id": 573099482,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1770743108
    },
    {
        "content": "<p>Same as Julian. Iâ€™m definitely interested but time is very scarce.</p>",
        "id": 573140757,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1770754410
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span> <a href=\"#narrow/channel/561906-Editors-.26-UIs/topic/Lean-TUI.20.28self-contained.20infoview.29/near/573140757\">zei</a>:</p>\n<blockquote>\n<p>time is very scarce</p>\n</blockquote>\n<p>This is a small video/GIF to show basic usage scenario:<br>\n![](<a href=\"https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/workflow.gif\">https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/workflow.gif</a>)</p>\n<div class=\"message_inline_image\"><a href=\"https://codeberg.org/wvhulle/lean-tui/media/branch/main/screenshots/workflow.gif\"><img src=\"https://uploads.zulipusercontent.net/c9ec06d7f2c8b78f85ea5ccc66a1792b740b1ca8/68747470733a2f2f636f6465626572672e6f72672f777668756c6c652f6c65616e2d7475692f6d656469612f6272616e63682f6d61696e2f73637265656e73686f74732f776f726b666c6f772e676966\"></a></div>",
        "id": 573536739,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1770906630
    },
    {
        "content": "<p>What's not clear to me from that gif is does lean-tui not update what it shows when the cursor moves in the editor?</p>",
        "id": 573554604,
        "sender_full_name": "Julian Berman",
        "timestamp": 1770910824
    },
    {
        "content": "<p>That's pretty key functionality I think for an infoview is that what you see should relate to the cursor position in some tight way</p>",
        "id": 573554758,
        "sender_full_name": "Julian Berman",
        "timestamp": 1770910862
    },
    {
        "content": "<p>It updates while typing or when hovering.</p>",
        "id": 573564794,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1770912961
    },
    {
        "content": "<p>Itâ€™s just that helix is quite picky and does not sent hover unless you actually type or open the docs with a keybinding </p>\n<p><span class=\"user-mention silent\" data-user-id=\"321696\">Julian Berman</span> <a href=\"#narrow/channel/561906-Editors-.26-UIs/topic/Lean-TUI.20.28self-contained.20infoview.29/near/573554604\">said</a>:</p>\n<blockquote>\n<p>What's not clear to me from that gif is does lean-tui not update what it shows when the cursor moves in the editor?</p>\n</blockquote>",
        "id": 573565144,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1770913039
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/YY8fgYo4Dh8uLvQLN6z-RGtj/lean-tui-demo.webm\">lean-tui-demo.webm</a><br>\n<span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span> <br>\nLonger video with keybindings as well and monad view</p>\n<div class=\"message_inline_image message_inline_video\"><a href=\"/user_uploads/3121/YY8fgYo4Dh8uLvQLN6z-RGtj/lean-tui-demo.webm\" title=\"lean-tui-demo.webm\"><video preload=\"metadata\" src=\"/user_uploads/3121/YY8fgYo4Dh8uLvQLN6z-RGtj/lean-tui-demo.webm\"></video></a></div>",
        "id": 573886347,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1771066397
    }
]