[
    {
        "content": "<p>Thread for the work that mostly <span class=\"user-mention\" data-user-id=\"754848\">@Rodolfo R. Soldati</span> , <span class=\"user-mention\" data-user-id=\"782442\">@L√©o Lessa</span> and I have been working on. I'm in the middle of some cleanup at the moment but I want to write a better update soon</p>",
        "id": 523341251,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1749577261
    },
    {
        "content": "<p>I bumped the mathlib version. Also moved a bunch of floating lemmas to the right places. :) And we can use the lemmas from <a href=\"https://github.com/leanprover-community/mathlib4/pull/27115\">#27115</a> that were upstreamed, yay</p>",
        "id": 537534784,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1756924832
    },
    {
        "content": "<p>Hi everyone, I am trying to formalize the Schmidt decomposition Theorem 3.8.1 in Mark Wilde's book, but I am not sure how to say that a set of <code>(Ket d)</code> is Orthonormal. I tried <code>Orthonormal ‚ÑÇ (fun i ‚Ü¶ (œÜ i).vec)</code> but it returns an error. Any ideas? Thanks!</p>\n<p>The theorem statement I have so far is</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">SchmidtDecomposition</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">œà</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Ket</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">d‚ÇÅ</span><span class=\"w\"> </span><span class=\"bp\">√ó</span><span class=\"w\"> </span><span class=\"n\">d‚ÇÇ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">œÜ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Ket</span><span class=\"w\"> </span><span class=\"n\">d‚ÇÅ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œ∑</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Ket</span><span class=\"w\"> </span><span class=\"n\">d‚ÇÇ</span><span class=\"o\">),</span>\n<span class=\"n\">œà</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Ä¢</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ket</span><span class=\"bp\">.</span><span class=\"n\">prod</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">œÜ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œ∑</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">vec</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 542719660,
        "sender_full_name": "Jenkin",
        "timestamp": 1759405371
    },
    {
        "content": "<p>The issue is that <code>Orthonormal</code> requires a notion of inner product, but a \"raw\" function like <code>(œÜ i).vec</code> doesn't have an inner product associated to it. (What if <code>i</code> was infinite? Then a naive sum might not converge.)</p>\n<p>The type <code>EuclideanSpace ‚ÑÇ d</code> is equal, under the hood, to a raw function, but it instructs Lean to use the <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/InnerProductSpace/PiL2.html#PiLp.innerProductSpace\">PiLp.innerProductSpace</a> instance to give it an inner product structure.</p>",
        "id": 542756529,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1759415303
    },
    {
        "content": "<p>So if you try something like <code>Orthonormal ‚ÑÇ (fun i ‚Ü¶ (œÜ i).vec)</code>, you'll get the error message</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">synthesize</span>\n<span class=\"w\">  </span><span class=\"n\">InnerProductSpace</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">d‚ÇÅ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>or similar, which can help point you in this direction.</p>\n<p>So how do you fix this?</p>",
        "id": 542757198,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1759415449
    },
    {
        "content": "<p>Well, actually in <code>Braket.lean</code> there is a note saying</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">--TODO: change to `vec : EuclideanSpace ‚ÑÇ d`</span>\n</code></pre></div>\n<p>so it's already been on my mind. :) And I think <span class=\"user-mention\" data-user-id=\"754848\">@Rodolfo R. Soldati</span> has played a bit with doing this change, I'm not sure if the code is anywhere online though</p>",
        "id": 542757501,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1759415514
    },
    {
        "content": "<p>But for the moment, you can get around this by just casting. The easiest way to write this is to use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=WithLp.toLp#doc\">docs#WithLp.toLp</a> to turn the raw function into a vector in EuclideanSpace. So this should work:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Orthonormal</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">WithLp</span><span class=\"bp\">.</span><span class=\"n\">toLp</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">œÜ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">vec</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 542758475,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1759415733
    },
    {
        "content": "<p>Note that it will technically give it the type <code>WithLp 2 (d ‚Üí ‚ÑÇ)</code>, not <code>EuclideanSpace ‚ÑÇ d</code>, but these are _really_ the same thing, and any place you use one the other should work too.</p>",
        "id": 542758752,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1759415793
    },
    {
        "content": "<p>I will try to give maybe a pull request before the end of the day so we can discuss around it</p>",
        "id": 542764583,
        "sender_full_name": "Rodolfo Soldati",
        "timestamp": 1759417202
    },
    {
        "content": "<p>I should reach the SVD soon, but I'm using Watrous's book</p>",
        "id": 542765002,
        "sender_full_name": "Rodolfo Soldati",
        "timestamp": 1759417270
    },
    {
        "content": "<p>FYI, <span class=\"user-mention silent\" data-user-id=\"521331\">Niels Voss</span> is already working on SVD and the Schmidt decomposition. See <a class=\"message-link\" href=\"/#narrow/channel/217875-Is-there-code-for-X.3F/topic/Singular.20Value.20Decomposition/near/539611282\">#Is there code for X? &gt; Singular Value Decomposition @ üí¨</a></p>",
        "id": 542788391,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1759423529
    }
]