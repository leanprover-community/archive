[
    {
        "content": "<p>A PR from a fork <a href=\"https://github.com/ImperialCollegeLondon/FLT/pull/312\">FLT#312</a> which is working locally for me, is failing in CI, with errors which seem to be related to docgen. </p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>* Run MATHLIB_NO_CACHE_ON_UPDATE=1 ~/.elan/bin/lake update FLT || true\ninfo: docbuild: no previous manifest, creating one from scratch\ninfo: leanprover/doc-gen4: cloning https://github.com/leanprover/doc-gen4\ninfo: leanprover/doc-gen4: checking out revision 'f4d724054cac3c910ff00390b21dbe0f7105edac'\ninfo: updating toolchain to 'leanprover/lean4:v4.17.0-rc1'\ninfo: restarting Lake via Elan\ninfo: downloading https://github.com/leanprover/lean4/releases/download/v4.17.0-rc1/lean-4.17.0-rc1-linux.tar.zst\ninfo: installing /home/runner/.elan/toolchains/leanprover--lean4---v4.17.0-rc1\ninfo: docbuild: no previous manifest, creating one from scratch\ninfo: toolchain not updated; already up-to-date\ninfo: Cli: URL has changed; deleting '././../.lake/packages/Cli' and cloning again\ninfo: Cli: cloning https://github.com/mhuisi/lean4-cli\ninfo: Cli: checking out revision 'a2eb24a3dbf681f2b655f82ba5ee5b139d4a5abc'\ninfo: UnicodeBasic: cloning https://github.com/fgdorais/lean4-unicode-basic\ninfo: UnicodeBasic: checking out revision 'd890360c960358a42965bdc15defa3fd09feba38'\ninfo: BibtexQuery: cloning https://github.com/kim-em/BibtexQuery\ninfo: BibtexQuery: checking out revision '2411c47ee06f2fc986d929e22731c77e61eaadb6'\ninfo: MD4Lean: cloning https://github.com/acmepjz/md4lean\ninfo: MD4Lean: checking out revision '7cf25ec0edf7a72830379ee227eefdaa96c48cfb'\ninfo: mathlib: running post-update hooks\nerror: ././../.lake/packages/doc-gen4/lakefile.lean:159:16: error: invalid field 'await', the environment does not contain 'Array.await'\n  __do_lift‚úù\nhas type\n  Array Module\n\nerror: ././../.lake/packages/doc-gen4/lakefile.lean:160:38: error: invalid field notation, type is not of the form (C ...) where C is a constant\n  imports\nhas type\n  ?m.11550 mod exeJob bibPrepassJob modJob __do_lift‚úù\n\nerror: ././../.lake/packages/doc-gen4/lakefile.lean:198:13: error: invalid field 'await', the environment does not contain 'Array.await'\n  __do_lift‚úù\nhas type\n  Array Module\n...\n</code></pre></div>\n<p>Any ideas?</p>",
        "id": 497722756,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738690972
    },
    {
        "content": "<p>What's the toolchain in FLT and is it 4.17.0-rc1?</p>",
        "id": 497723349,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1738691156
    },
    {
        "content": "<p>What worries me is that I'm seeing <code>updating toolchain to 'leanprover/lean4:v4.17.0-rc1'</code> in those messages, but the PR has <code>lean-toolchain</code> on <code>leanprover/lean4:v4.16.0-rc2</code> and indeed I haven't bumped to v4.17.0-rc1 yet -- it's on my TODO list but I wanted to get some PRs merged first because I felt that I'd be better equipped to fix up errors than the people making the PRs.</p>",
        "id": 497723417,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738691168
    },
    {
        "content": "<p>The toolchain on the branch is 4.16-rc2 and I am not sure that it's reasonable to tell people making PRs \"oh and by the way you must bump mathlib yourself in your PR every time mathlib is bumped to a new Lean version\", that's certainly not how mathlib PRs work whenever Lean changes.</p>",
        "id": 497723675,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738691266
    },
    {
        "content": "<p>You can temporarily pin the doc-gen version you're using by replacing the last paragraph in <code>docbuild/lakefile.toml</code> with </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">[[</span><span class=\"n\">require</span><span class=\"o\">]]</span>\n<span class=\"n\">scope</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"leanprover\"</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"doc-gen4\"</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"v4.16.0-rc2\"</span>\n</code></pre></div>",
        "id": 497723783,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1738691291
    },
    {
        "content": "<p>Yes but are you saying \"the new doc-gen setup which Kim has encouraged us to switch to has a bunch of unforseen consequences which are going to make all FLT contributors' lives more complicated going forward\" or is there some kind of robust fix for this?</p>",
        "id": 497723967,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738691367
    },
    {
        "content": "<p>Longer term, we could do what I offered you just before I left London: Always pin the toolchain version in <code>lakefile.toml</code> and have <code>scripts/bump.sh</code> update it whenever <code>lean-toolchain</code> changes.</p>",
        "id": 497724061,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1738691398
    },
    {
        "content": "<p>Alternatively, don't have <code>docbuild/lakefile.toml</code> and instead generate the file on the fly from <code>lean-toolchain</code></p>",
        "id": 497724238,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1738691448
    },
    {
        "content": "<p>All of this is gobble-de-gook to me, I just want it to work for everyone easily.</p>",
        "id": 497724404,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738691513
    },
    {
        "content": "<p>I am in no position to choose between these alternatives.</p>",
        "id": 497724474,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738691527
    },
    {
        "content": "<p>All I know is that it used to work and now it doesn't work</p>",
        "id": 497724495,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738691535
    },
    {
        "content": "<p>I will fix it</p>",
        "id": 497724528,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1738691550
    },
    {
        "content": "<p>But will Kim be happy with your fix? My understanding was that our position was that we wanted to make the FRO happy with our set-up.</p>",
        "id": 497724587,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738691580
    },
    {
        "content": "<p>(got to go, giving a talk)</p>",
        "id": 497724622,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738691592
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/416277-FLT/topic/Error.20in.20CI.20poss.20related.20to.20new.20doc-gen.20setup/near/497724587\">said</a>:</p>\n<blockquote>\n<p>But will Kim be happy with your fix?</p>\n</blockquote>\n<p>Yes, Kim wanted <del>Kevin</del> Kenv dead, and Kenv is dead indeed</p>",
        "id": 497724835,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1738691652
    },
    {
        "content": "<p>Got a decent fix working. Will PR soon</p>",
        "id": 497786241,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1738716923
    },
    {
        "content": "<p>Basically every PR for FLT now has a red X so development is currently stalled on this issue :-( What is your vision for how this will work? Which option did you choose?</p>",
        "id": 497886798,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738760281
    },
    {
        "content": "<p>I chose the option to make <code>docbuild</code> be created by CI. This way, no one can accidentally introduce a toolchain mismatch error in the repo by modifying/forgetting to modify the pinned toolchain in <code>docbuild/lakefile.toml</code></p>",
        "id": 497887613,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1738760512
    },
    {
        "content": "<p>Bonus point is we get rid of the custom script to bump FLT. Malus point is we now have a custom script to build the docs. Bonus point is that the script-less way to build the docs was not very ergonomic anyway, and we bump the repo more often than we build offline docs for it</p>",
        "id": 497888313,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1738760722
    },
    {
        "content": "<p>OK this sounds fabulous!</p>\n<p>I'm minded to start merging some PRs and not caring about the red x because I can see that the only failure in CI is this issue. So master will maybe have a red x soon.</p>",
        "id": 497890544,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738761457
    },
    {
        "content": "<p>If you're willing to wait one or two hours, you'll soon get a PR from me</p>",
        "id": 497890822,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1738761542
    },
    {
        "content": "<p>I'll be in a seminar by then, but I'm confident that I'll be able to pick up the pieces later on!</p>",
        "id": 497892870,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738762198
    },
    {
        "content": "<p><a href=\"https://github.com/ImperialCollegeLondon/FLT/pull/334\">FLT#334</a></p>",
        "id": 497897091,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1738763332
    },
    {
        "content": "<p>CI has failed. It this expected, because it's running old CI on a project which has changed the CI set-up?</p>",
        "id": 497899141,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738763879
    },
    {
        "content": "<p>No, it's failing because it's looking for <code>docbuild/scripts/build_docs.sh</code> instead of <code>/scripts/build_docs.sh</code> in the repo root, and the fix will probably be that running <code>../scripts/build_docs.sh</code> was intended if the working directory really needs to be <code>docbuild</code> (and probably Yael will know all this and fix it when they see the error)</p>",
        "id": 497906437,
        "sender_full_name": "Julian Berman",
        "timestamp": 1738765738
    },
    {
        "content": "<p>If this discussion converges, it would be nice to know whether the ci setup created by <code>leanblueprint</code> needs to be updated.</p>",
        "id": 497936267,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1738773505
    },
    {
        "content": "<p>Which CI setup do you mean precisely, Patrick? Is it the template one that Pietro maintains, or something else?</p>",
        "id": 497936908,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1738773708
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/416277-FLT/topic/Error.20in.20CI.20poss.20related.20to.20new.20doc-gen.20setup/near/497899141\">said</a>:</p>\n<blockquote>\n<p>CI has failed. It this expected, because it's running old CI on a project which has changed the CI set-up?</p>\n</blockquote>\n<p>It's expected because I am stupid</p>",
        "id": 497937031,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1738773736
    },
    {
        "content": "<p>(I forgot to remove <code>working-directory: docbuild</code> from an invokation that is now supposed to run from the root directory)</p>",
        "id": 497937179,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1738773789
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span> <a href=\"#narrow/channel/416277-FLT/topic/Error.20in.20CI.20poss.20related.20to.20new.20doc-gen.20setup/near/497936267\">said</a>:</p>\n<blockquote>\n<p>If this discussion converges, it would be nice to know whether the ci setup created by <code>leanblueprint</code> needs to be updated.</p>\n</blockquote>\n<p>I think so. I opened a <a href=\"https://github.com/PatrickMassot/leanblueprint/pull/65\">LeanBlueprint PR</a> for that 2 weeks ago, but maybe we find a better solution.</p>",
        "id": 497944003,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1738775740
    },
    {
        "content": "<p>Looks like docs are down - <a href=\"https://imperialcollegelondon.github.io/FLT/docs/\">https://imperialcollegelondon.github.io/FLT/docs/</a></p>",
        "id": 500444690,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1739896733
    },
    {
        "content": "<p>Uhoh, that's probably my fault. Investigating</p>",
        "id": 500445092,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1739896853
    },
    {
        "content": "<p>Ah! At the very end of Build project API documentation in <a href=\"https://github.com/ImperialCollegeLondon/FLT/actions/runs/13370724261/job/37338415705\">https://github.com/ImperialCollegeLondon/FLT/actions/runs/13370724261/job/37338415705</a>:</p>\n<blockquote>\n<p>mv: cannot overwrite 'docs/docs/doc': Directory not empty</p>\n</blockquote>",
        "id": 500447591,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1739897584
    },
    {
        "content": "<p>This comes from <code>scripts/build_docs.sh</code>. Don't really understand why this happens though</p>",
        "id": 500447709,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1739897626
    },
    {
        "content": "<p>Ran out of time for now. Feel free to take the investigation over</p>",
        "id": 500447862,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1739897670
    },
    {
        "content": "<p>(Deleted: didn‚Äôt read the whole thing, sorry. I‚Äôll be able to take a look at it tomorrow)</p>",
        "id": 500471376,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1739899057
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/channel/416277-FLT/topic/Error.20in.20CI.20poss.20related.20to.20new.20doc-gen.20setup/near/500444690\">said</a>:</p>\n<blockquote>\n<p>Looks like docs are down - <a href=\"https://imperialcollegelondon.github.io/FLT/docs/\">https://imperialcollegelondon.github.io/FLT/docs/</a></p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"699016\">@Edison Xie</span> and I peeled our eyes trying to find where the error is, and we couldn't spot it. Can anyone give it another look?</p>",
        "id": 501893219,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1740511651
    },
    {
        "content": "<p>Oh! The docs are accessible under <code>docs/doc</code>!</p>",
        "id": 501893907,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1740511843
    },
    {
        "content": "<p>Somehow <code>mv docbuild/.lake/build/doc docs/build</code> actually moves the content of <code>docbuild/.lake/build/doc</code> to <code>docs/build/doc</code> (instead of <code>docs/build</code>)!</p>",
        "id": 501895601,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1740512334
    },
    {
        "content": "<p>Am I being dense here? Should I be adding more slashes somewhere?</p>",
        "id": 501895650,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1740512350
    },
    {
        "content": "<p>Don't you want something like <code>mv docbuild/.lake/build/doc/* docs/build</code>?</p>",
        "id": 501895868,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1740512408
    },
    {
        "content": "<p>I thought <code>mv</code> moved folders to folders <span aria-label=\"flushed\" class=\"emoji emoji-1f633\" role=\"img\" title=\"flushed\">:flushed:</span></p>",
        "id": 501895957,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1740512450
    },
    {
        "content": "<p>Ah, right, given how it works on files, you might think that, yeah.</p>",
        "id": 501896129,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1740512508
    },
    {
        "content": "<p>A folder is just a file :)</p>",
        "id": 501924921,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1740523943
    },
    {
        "content": "<p>You might prefer rsync in such situations</p>",
        "id": 501924965,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1740523966
    },
    {
        "content": "<p>How do I test this? At least my rudimentary bash knowledge is enough to understand properly how <code>mv</code> works. My problem is that I don't have a clue what's going on. If I edit <code>scripts/build_docs.sh</code> like this:</p>\n<div class=\"codehilite\" data-code-language=\"Diff\"><pre><span></span><code><span class=\"gu\">@@ -44,7 +44,7 @@ MATHLIB_NO_CACHE_ON_UPDATE=1 # Disable an error message due to a non-blocking bu</span>\n\n<span class=\"w\"> </span># Move them out of docbuild\n<span class=\"w\"> </span>cd ../\n<span class=\"gd\">-mv docbuild/.lake/build/doc docs/docs</span>\n<span class=\"gi\">+mv docbuild/.lake/build/doc/* docs/build</span>\n</code></pre></div>\n<p>then run <code>scripts/build_docs.sh</code> from the root of the project I get</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>mv: cannot move 'docs/docs' to 'docbuild/.lake/build/doc': No such file or directory\ninfo: docbuild: no previous manifest, creating one from scratch\ninfo: leanprover/doc-gen4: checking out revision '1213642a40facc6fa368b55e93ded3c97e3f4486'\ninfo: updating toolchain to 'leanprover/lean4:v4.17.0-rc1'\ninfo: restarting Lake via Elan\ninfo: docbuild: no previous manifest, creating one from scratch\ninfo: toolchain not updated; already up-to-date\ninfo: UnicodeBasic: checking out revision 'd890360c960358a42965bdc15defa3fd09feba38'\ninfo: BibtexQuery: URL has changed; deleting '././../.lake/packages/BibtexQuery' and cloning again\ninfo: BibtexQuery: cloning https://github.com/kim-em/BibtexQuery\ninfo: BibtexQuery: checking out revision '2411c47ee06f2fc986d929e22731c77e61eaadb6'\ninfo: MD4Lean: checking out revision '7cf25ec0edf7a72830379ee227eefdaa96c48cfb'\ninfo: mathlib: running post-update hooks\nuncaught exception: Failed to prune ProofWidgets cloud release: no such file or directory (error code: 2)\n  file: .lake/packages/proofwidgets/.lake/build/lib\nerror: mathlib: failed to fetch cache\nuncaught exception: Failed to prune ProofWidgets cloud release: no such file or directory (error code: 2)\n  file: .lake/packages/proofwidgets/.lake/build/lib\n‚£ø [?/?] Computing build jobs\n</code></pre></div>\n<p>which doesn't look good to me but then again I'm not at all sure what I'm supposed to be seeing.</p>",
        "id": 502162023,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740611378
    },
    {
        "content": "<p>Who was arguing against the previous working setup again? Was that <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> ?</p>",
        "id": 502162235,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740611490
    },
    {
        "content": "<p>The bash script seems to create a <code>docbuild</code> dir, but then you move to <code>docbuild/.lake/build/doc</code>.</p>",
        "id": 502162471,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740611616
    },
    {
        "content": "<p>Should you be creating a chain <code>docbuild/.lake/build/doc</code> of dirs instead?</p>",
        "id": 502162511,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740611634
    },
    {
        "content": "<p>It also says</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"c1\"># Fetch the docs cache if it exists</span>\nmkdir<span class=\"w\"> </span>-p<span class=\"w\"> </span>docs/docs\nmv<span class=\"w\"> </span>docs/docs<span class=\"w\"> </span>docbuild/.lake/build/doc\n</code></pre></div>",
        "id": 502162634,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740611687
    },
    {
        "content": "<p>The comment suggests \"fetching\", but I do not see that reflected in the script.</p>",
        "id": 502162700,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740611714
    },
    {
        "content": "<blockquote>\n<p>Was that¬†@Kim Morrison¬†?</p>\n</blockquote>\n<p>Yes, and the argument (which Yael was also in favour of) was that it's best to \"stick to the script\" as much as possible. For example I argued that a file FLT.lean just containing a list of all other files in the repo was just plain stupid given that a script could generate those files and if the system really needed such a file then it should just generate it on the fly and delete it; my FLT.lean was a statement of FLT and I really liked it that way. But Yael argued that all other projects have this moronic convention and it's good to be consistent, not least because I could not use <code>lake exe mk_all</code> for example. Yael and Kim also both argued that this <code>-Kenv=dev</code> or whatever we had to continually type when we had non-standard doc-gen was bad not because we had to type it but because it was non-standard, and I've just come around to the idea over time that if everyone else is doing something in some way then we should also be doing it in the same way.</p>",
        "id": 502162956,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740611815
    },
    {
        "content": "<p>I do not really know what the script should be doing, but I would guess from just looking at it very na√Øvely that replacing</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"c1\"># Create a temporary docbuild folder</span>\nmkdir<span class=\"w\"> </span>-p<span class=\"w\"> </span>docbuild\n</code></pre></div>\n<p>with</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"c1\"># Create a temporary docbuild folder</span>\nmkdir<span class=\"w\"> </span>-p<span class=\"w\"> </span>docbuild/.lake/build/doc\n</code></pre></div>\n<p>has a higher chance of working.</p>",
        "id": 502163503,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740612077
    },
    {
        "content": "<p>Yeah, I don't disagree with that in general - it just seems like the new setup is much more complex and brittle, and I'd hoped the proponents would be able to quickly diagnose the issue</p>",
        "id": 502163544,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740612106
    },
    {
        "content": "<p>At the very least, it will throw an error later than where it is choking now.</p>",
        "id": 502163559,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740612115
    },
    {
        "content": "<p>That doesn't seem to make sense to me,  Damiano - the doc build is supposed to drop its output somewhere around there, and putting an empty folder there only masks the fact that there's nothing where there should be something</p>",
        "id": 502163756,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740612216
    },
    {
        "content": "<p>I think that <code>docs/docs</code> could be <em>already</em> populated with something.</p>",
        "id": 502163859,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740612253
    },
    {
        "content": "<p>As in, a previous run might have filled it with stuff and you are \"fetching\" whatever it contains, if indeed it contains something.</p>",
        "id": 502163910,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740612291
    },
    {
        "content": "<p>But I also do not want to give the impression that I know what the script is supposed to do!</p>",
        "id": 502164005,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740612347
    },
    {
        "content": "<p>Oh hmm, now that I look at the script, it seems you're correct. Worth trying, then</p>",
        "id": 502164393,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740612548
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> <a href=\"#narrow/channel/416277-FLT/topic/Error.20in.20CI.20poss.20related.20to.20new.20doc-gen.20setup/near/502163503\">said</a>:</p>\n<blockquote>\n<p>I do not really know what the script should be doing, but I would guess from just looking at it very na√Øvely that replacing</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"c1\"># Create a temporary docbuild folder</span>\nmkdir<span class=\"w\"> </span>-p<span class=\"w\"> </span>docbuild\n</code></pre></div>\n<p>with</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"c1\"># Create a temporary docbuild folder</span>\nmkdir<span class=\"w\"> </span>-p<span class=\"w\"> </span>docbuild/.lake/build/doc\n</code></pre></div>\n<p>has a higher chance of working.</p>\n</blockquote>\n<p>Does the next line</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"c1\"># Equip docbuild with the template lakefile.toml</span>\ntemplate<span class=\"w\"> </span>&gt;<span class=\"w\"> </span>docbuild/lakefile.toml\n</code></pre></div>\n<p>also need changing then?</p>",
        "id": 502164794,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740612731
    },
    {
        "content": "<p>I only have a vague impression of how this GitHub caching business works, but does the way that the script moves docs/docs into docbuild/.lake/build/doc and only moves it back once the build succeeded, mean that a broken build effectively clears the cache?</p>",
        "id": 502164822,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740612743
    },
    {
        "content": "<p>No, leave the next line</p>",
        "id": 502164859,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740612764
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/channel/416277-FLT/topic/Error.20in.20CI.20poss.20related.20to.20new.20doc-gen.20setup/near/502164822\">said</a>:</p>\n<blockquote>\n<p>I only have a vague impression of how this GitHub caching business works, but does the way that the script moves docs/docs into docbuild/.lake/build/doc and only moves it back once the build succeeded, mean that a broken build effectively clears the cache?</p>\n</blockquote>\n<p>With CI, <em>anything</em> can happen.</p>",
        "id": 502164953,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740612815
    },
    {
        "content": "<p>Should I be testing this script by just running it on my computer in the root directory of the project, or is that bound to fail for some reason?</p>",
        "id": 502165036,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740612844
    },
    {
        "content": "<p>Do you have a <code>docs/docs</code> dir with something inside it?</p>",
        "id": 502165126,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740612891
    },
    {
        "content": "<p>In any case, I think that running the script from the root dir of the project \"should\" work.</p>",
        "id": 502165361,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613004
    },
    {
        "content": "<p>I seem to have an empty docs/docs dir right now</p>",
        "id": 502165395,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740613027
    },
    {
        "content": "<p>I also feel that if the script does not work in an environment where you control everything, the chances of it working blindly on a computer who knows where are pretty slim.</p>",
        "id": 502165423,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613048
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/416277-FLT/topic/Error.20in.20CI.20poss.20related.20to.20new.20doc-gen.20setup/near/502165395\">said</a>:</p>\n<blockquote>\n<p>I seem to have an empty docs/docs dir right now</p>\n</blockquote>\n<p>Ok, I think that Ruben and I are not convinced of whether that would <em>always</em> be the case in CI, or whether there is a chance that that dir may contain something sometimes.</p>",
        "id": 502165542,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613101
    },
    {
        "content": "<p>In any case, the script should work even if that dir is empty, it just may take longer to run.</p>",
        "id": 502165573,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613122
    },
    {
        "content": "<p>I get fewer errors now:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>buzzard@brutus:~/FLT$ ./scripts/build_docs.sh\ninfo: docbuild: no previous manifest, creating one from scratch\ninfo: updating toolchain to 'leanprover/lean4:v4.17.0-rc1'\ninfo: restarting Lake via Elan\ninfo: docbuild: no previous manifest, creating one from scratch\ninfo: toolchain not updated; already up-to-date\ninfo: mathlib: running post-update hooks\nuncaught exception: Failed to prune ProofWidgets cloud release: no such file or directory (error code: 2)\n  file: .lake/packages/proofwidgets/.lake/build/lib\nerror: mathlib: failed to fetch cache\nuncaught exception: Failed to prune ProofWidgets cloud release: no such file or directory (error code: 2)\n  file: .lake/packages/proofwidgets/.lake/build/lib\n‚£ø [?/?] Computing build jobs\n</code></pre></div>",
        "id": 502165577,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740613126
    },
    {
        "content": "<p>Ah, ProofWidgets is someone else's problem!!!  <span aria-label=\"octopus\" class=\"emoji emoji-1f419\" role=\"img\" title=\"octopus\">:octopus:</span></p>",
        "id": 502165625,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613152
    },
    {
        "content": "<p>So, as far as my understanding goes, the <code>docs/docs</code> dir may contains a previous build of the docs when you start the script.</p>",
        "id": 502165746,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613206
    },
    {
        "content": "<p>Oh, is <code>lake exe cache get</code> failing but not terminating the script because that needs a <code>set</code> line at the top of the script?</p>",
        "id": 502165794,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740613233
    },
    {
        "content": "<p>If there is something, you cunningly move it to where the CI step that will create it later would create (the <code>.../.lake/...</code> dir).</p>",
        "id": 502165809,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613242
    },
    {
        "content": "<p>And is it rebuilding all of mathlib?</p>",
        "id": 502165841,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740613256
    },
    {
        "content": "<p>Then, you tell lean to create the docs: if they already exist, fine, otherwise they will be build.</p>",
        "id": 502165860,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613266
    },
    {
        "content": "<p>Eventually, you move the newly-built-or-previously-built docs back to where they came from.</p>",
        "id": 502165908,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613295
    },
    {
        "content": "<p>The solution for the ProofWidget was the one found by Mauricio?  Removing a trace file somewhere?</p>",
        "id": 502165996,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613334
    },
    {
        "content": "<p>I'm somewhat suspicious of the TOOLCHAIN mangling, but maybe that's a red herring</p>",
        "id": 502166077,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740613394
    },
    {
        "content": "<p>CI always takes forever to run because it always builds all of mathlib docs even though 9 times out of 10 mathlib didn't change when I merge a PR (we bump mathlib every week or two).</p>",
        "id": 502166155,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740613443
    },
    {
        "content": "<p>Maybe <a href=\"#narrow/channel/287929-mathlib4/topic/.60lake.20build.60.20work.20after.20a.20successful.20.60lake.20exe.20cache.20get.60/near/497932824\">#mathlib4 &gt; &#96;lake build&#96; work after a successful &#96;lake exe cache get&#96; @ üí¨</a>?</p>",
        "id": 502166191,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613456
    },
    {
        "content": "<p>I don't recall if the cache is supposed to help with that, probably not</p>",
        "id": 502166480,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740613624
    },
    {
        "content": "<p>I am not sure that what I linked is relevant.</p>",
        "id": 502166489,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613629
    },
    {
        "content": "<p>Anyway, sleep for me</p>",
        "id": 502166503,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740613638
    },
    {
        "content": "<p>Same here.</p>",
        "id": 502166513,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613645
    },
    {
        "content": "<p>Honestly, I think that this might be progress, since ProofWidgets has always caused some headaches...</p>",
        "id": 502166541,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613666
    },
    {
        "content": "<p>OK so I just merge Damiano's suggested change and see what happens?!</p>",
        "id": 502166713,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740613774
    },
    {
        "content": "<p>I suspect that CI will behave similarly to what it does locally for you, but you never know.</p>",
        "id": 502166795,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613805
    },
    {
        "content": "<p>oh wait the build finished and it ends with</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>info: Documentation indexing\nBuild completed successfully.\nmv: target 'docs/build': No such file or directory\nbuzzard@brutus:~/FLT$\n</code></pre></div>\n<p>Is that bad?</p>",
        "id": 502166859,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740613846
    },
    {
        "content": "<p>Hmm, I cannot see a step that moves to <code>docs/build</code> in the script...</p>",
        "id": 502167051,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613947
    },
    {
        "content": "<p>Was that the error that you got when you ran the script?</p>",
        "id": 502167113,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740613985
    },
    {
        "content": "<p>I am guessing that the <code>Build completed successfully.</code> is the output of</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"c1\"># Build the docs</span>\n~/.elan/bin/lake<span class=\"w\"> </span>build<span class=\"w\"> </span>FLT:docs\n</code></pre></div>",
        "id": 502167227,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740614052
    },
    {
        "content": "<p>The remaining steps are</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"c1\"># Move them out of docbuild</span>\n<span class=\"nb\">cd</span><span class=\"w\"> </span>../\nmv<span class=\"w\"> </span>docbuild/.lake/build/doc<span class=\"w\"> </span>docs/docs\n\n<span class=\"c1\"># Clean up after ourselves</span>\nrm<span class=\"w\"> </span>-rf<span class=\"w\"> </span>docbuild\n</code></pre></div>",
        "id": 502167249,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740614069
    },
    {
        "content": "<p>But the target of the unique <code>mv</code> is <code>docs/docs</code>, not <code>docs/build</code>...</p>",
        "id": 502167282,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740614094
    },
    {
        "content": "<p>Here is the <code>scripts/build_docs.sh</code> file in full, after Damiano's suggested change.</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"c1\"># Build HTML documentation for FLT</span>\n<span class=\"c1\"># The output will be located in docs/docs</span>\n\n<span class=\"c1\"># Template lakefile.toml</span>\ntemplate<span class=\"o\">()</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">  </span>cat<span class=\"w\"> </span><span class=\"s\">&lt;&lt;EOF</span>\n<span class=\"s\">name = \"docbuild\"</span>\n<span class=\"s\">reservoir = false</span>\n<span class=\"s\">version = \"0.1.0\"</span>\n<span class=\"s\">packagesDir = \"../.lake/packages\"</span>\n\n<span class=\"s\">[[require]]</span>\n<span class=\"s\">name = \"FLT\"</span>\n<span class=\"s\">path = \"../\"</span>\n\n<span class=\"s\">[[require]]</span>\n<span class=\"s\">scope = \"leanprover\"</span>\n<span class=\"s\">name = \"doc-gen4\"</span>\n<span class=\"s\">rev = \"TOOLCHAIN\"</span>\n<span class=\"s\">EOF</span>\n<span class=\"o\">}</span>\n\n<span class=\"c1\"># Create a temporary docbuild folder</span>\nmkdir<span class=\"w\"> </span>-p<span class=\"w\"> </span>docbuild/.lake/build/doc\n\n<span class=\"c1\"># Equip docbuild with the template lakefile.toml</span>\ntemplate<span class=\"w\"> </span>&gt;<span class=\"w\"> </span>docbuild/lakefile.toml\n\n<span class=\"c1\"># Substitute the toolchain from lean-toolchain into docbuild/lakefile.toml</span>\nsed<span class=\"w\"> </span>-i<span class=\"w\"> </span>s/TOOLCHAIN/<span class=\"sb\">`</span>grep<span class=\"w\"> </span>-oP<span class=\"w\"> </span><span class=\"s1\">'v4\\..*'</span><span class=\"w\"> </span>lean-toolchain<span class=\"sb\">`</span>/<span class=\"w\"> </span>docbuild/lakefile.toml\n\n<span class=\"c1\"># Fetch the docs cache if it exists</span>\nmkdir<span class=\"w\"> </span>-p<span class=\"w\"> </span>docs/docs\nmv<span class=\"w\"> </span>docs/docs<span class=\"w\"> </span>docbuild/.lake/build/doc\n\n<span class=\"c1\"># Initialise docbuild as a Lean project</span>\n<span class=\"nb\">cd</span><span class=\"w\"> </span>docbuild\n<span class=\"nv\">MATHLIB_NO_CACHE_ON_UPDATE</span><span class=\"o\">=</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"c1\"># Disable an error message due to a non-blocking bug. See Zulip</span>\n~/.elan/bin/lake<span class=\"w\"> </span>update<span class=\"w\"> </span>FLT\n~/.elan/bin/lake<span class=\"w\"> </span>exe<span class=\"w\"> </span>cache<span class=\"w\"> </span>get\n\n<span class=\"c1\"># Build the docs</span>\n~/.elan/bin/lake<span class=\"w\"> </span>build<span class=\"w\"> </span>FLT:docs\n\n<span class=\"c1\"># Move them out of docbuild</span>\n<span class=\"nb\">cd</span><span class=\"w\"> </span>../\nmv<span class=\"w\"> </span>docbuild/.lake/build/doc/*<span class=\"w\"> </span>docs/build\n\n<span class=\"c1\"># Clean up after ourselves</span>\nrm<span class=\"w\"> </span>-rf<span class=\"w\"> </span>docbuild\n</code></pre></div>\n<p>So it <br>\n1) creates a directory <code>docbuild/.lake/build/doc</code> if one isn't already there;<br>\n2) dumps a docbuild <code>lakefile.toml</code> into <code>docbuild/</code> but with <code>rev = \"TOOLCHAIN\"</code><br>\n3) does a cute sed trick to turn that into <code>rev = \"v4.17.0-rc1\"</code> or whatever<br>\n4) makes <code>docs/docs</code> if it doesn't already exist, and moves it to <code>docbuild/.lake/build/doc/docs</code><br>\n5) changes directory to <code>docbuild</code> and then runs two <code>lake</code> commands both of which fail with errors about <code>Proofwidgets</code><br>\n6) runs <code>~/.elan/bin/lake build FLT:docs</code> which sits on <code>‚£ø [?/?] Computing build jobs</code> for an absolute age </p>\n<p>and apparently I also have to go to bed so I'll leave it there (it's been sitting for 5 minutes)</p>\n<p><span class=\"user-mention\" data-user-id=\"387244\">@Ya√´l Dillies</span> <span class=\"user-mention\" data-user-id=\"556875\">@Pietro Monticone</span> does any of this look right/wrong so far?</p>",
        "id": 502168723,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740614783
    },
    {
        "content": "<p>My final guess before really going to bed is that the toolchain modification introduces an incompatibility between the ProofWidget version and causes one of the steps to fail.</p>",
        "id": 502169086,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740615001
    },
    {
        "content": "<p>Good luck and Godspeed.  And good night!</p>",
        "id": 502169277,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740615096
    },
    {
        "content": "<p>I should have fixed the script. I'm testing the caching mechanism and the website generation now.</p>",
        "id": 502209572,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1740639837
    },
    {
        "content": "<p>Caching mechanism tested <span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span> (<a href=\"https://github.com/ImperialCollegeLondon/FLT/actions/runs/13559890193/job/37902964091?pr=359\">link</a>)</p>",
        "id": 502209899,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1740639978
    },
    {
        "content": "<p>Website generation tested <span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span> (<a href=\"https://imperialcollegelondon.github.io/FLT/\">link</a>)</p>",
        "id": 502211324,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1740640699
    },
    {
        "content": "<p>Ok, everything is fine now.</p>",
        "id": 502211342,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1740640711
    },
    {
        "content": "<p>Ready for review <a href=\"https://github.com/ImperialCollegeLondon/FLT/pull/359\">FLT#359</a></p>",
        "id": 502211669,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1740640888
    },
    {
        "content": "<p>Thanks! Is there a reason you're not running <code>lake exe cache get</code> anymore?</p>",
        "id": 502221362,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740644355
    },
    {
        "content": "<p>Yes, because it‚Äôs unnnecessary since <code>lake update</code> already does that.</p>",
        "id": 502258140,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1740655083
    },
    {
        "content": "<p><code>MATHLIB_NO_CACHE_ON_UPDATE</code> is really confusingly named then</p>",
        "id": 502268409,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1740658536
    },
    {
        "content": "<p>Ops, sorry, I replied too quickly without thinking. </p>\n<p>I removed it because I believed it was unnecessary given that we run it before and then we have <code>packagesDir = \"../.lake/packages\"</code> in the docbuild .toml file:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"docbuild\"</span>\n<span class=\"n\">reservoir</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">false</span>\n<span class=\"n\">version</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"0.1.0\"</span>\n<span class=\"n\">packagesDir</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"../.lake/packages\"</span>\n<span class=\"bp\">‚Ä¶</span>\n</code></pre></div>\n<p>but I‚Äôm not at all sure I‚Äôm right about this. </p>\n<p>CC: <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> <span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span></p>",
        "id": 502285334,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1740663278
    },
    {
        "content": "<p>Maybe if you add it back, we can look at the logs and see what, if anything, it does</p>",
        "id": 502287876,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740663965
    },
    {
        "content": "<p>Unfortunately I‚Äôm from mobile at the moment</p>",
        "id": 502288387,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1740664106
    },
    {
        "content": "<p>But I can push it directly to <code>main</code>.</p>",
        "id": 502288663,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1740664179
    },
    {
        "content": "<p>Done <span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span></p>",
        "id": 502289094,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1740664287
    },
    {
        "content": "<p>Nope, it returns an error precisely for the same reason we need the <code>MATHLIB_NO_CACHE_ON_UPDATE</code> of course‚Ä¶ Sorry, I‚Äôm a bit tired‚Ä¶</p>\n<p>I‚Äôm going to remove it once again.</p>",
        "id": 502291128,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1740664815
    },
    {
        "content": "<p>Sorry, I thought I had made it clear I had a fix in the work <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span></p>",
        "id": 502309609,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1740669379
    },
    {
        "content": "<p>Yesterday, I had time to fix it on LeanAPAP and PFR, then I ran out of time to copy the fix to FLT</p>",
        "id": 502309772,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1740669421
    },
    {
        "content": "<p>Is your fix similar to mine?</p>",
        "id": 502311472,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1740669831
    },
    {
        "content": "<p>Not really, no</p>",
        "id": 502312432,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1740670054
    },
    {
        "content": "<p>Do we have a semi-reliable way to evaluate which one could be better to keep?</p>",
        "id": 502313007,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1740670176
    },
    {
        "content": "<p>The fix I have is already successfully tested on two separate repos. And I am trying to keep the CI of the various repos somewhat in sync</p>",
        "id": 502313353,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1740670245
    },
    {
        "content": "<p>LeanAPAP is still red, and FLT is green :)</p>",
        "id": 502313375,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740670253
    },
    {
        "content": "<p>Or red again after the change in <a href=\"https://github.com/YaelDillies/LeanAPAP/commit/16f61b7761caa9784f17b1b22bfe989f4499afb4\">https://github.com/YaelDillies/LeanAPAP/commit/16f61b7761caa9784f17b1b22bfe989f4499afb4</a></p>",
        "id": 502313505,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740670288
    },
    {
        "content": "<p>Yeah I jumbled something unrelated</p>",
        "id": 502313559,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1740670300
    },
    {
        "content": "<p>I just reached a computer for the first time of the day, so I'll fix all of this swiftly now</p>",
        "id": 502313766,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1740670338
    },
    {
        "content": "<p>I don't know that there's anything to fix at this point</p>",
        "id": 502313899,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740670371
    },
    {
        "content": "<p>When I‚Äôll be back home I could take a look at your solution and I‚Äôll be more than happy to adopt it in FLT if it‚Äôs simpler, easier to maintain, etc.</p>",
        "id": 502314417,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1740670501
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/416277-FLT/topic/Error.20in.20CI.20poss.20related.20to.20new.20doc-gen.20setup/near/502165577\">said</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>uncaught exception: Failed to prune ProofWidgets cloud release: no such file or directory (error code: 2)\n  file: .lake/packages/proofwidgets/.lake/build/lib\nerror: mathlib: failed to fetch cache\nuncaught exception: Failed to prune ProofWidgets cloud release: no such file or directory (error code: 2)\n  file: .lake/packages/proofwidgets/.lake/build/lib\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>My experience is that you need to run <code>lake exe cache get</code> in the script twice... as the first run seems always return an error.</p>",
        "id": 502734424,
        "sender_full_name": "Jz Pan",
        "timestamp": 1740826041
    }
]