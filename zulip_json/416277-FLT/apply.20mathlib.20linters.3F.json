[
    {
        "content": "<p>This is a hopefully easy CI question. I get PRs which pass CI but which have e.g. over 100 character lines, or definitions without docstrings etc. Is it easy just to get mathlib linters running on FLT with some easy addition to the <code>toml</code>? Now we've switched to a toml I can't just apply the old algorithm of \"cut and paste from <code>lakefile.lean</code>\".</p>",
        "id": 502137084,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740601300
    },
    {
        "content": "<p>now you can \"cut and paste from Carleson's <code>lakefile.toml</code>\" (found <a href=\"https://github.com/fpvandoorn/carleson/blob/master/lakefile.toml\">here</a>)</p>",
        "id": 502137412,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1740601421
    },
    {
        "content": "<p>of course this will be up for customisation, as i don't think that has all of mathlibs linters enabled either, but it should help get started with the syntax</p>",
        "id": 502137706,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1740601518
    },
    {
        "content": "<p>let me try and find all linters mathlib has enabled by default...</p>",
        "id": 502138126,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1740601669
    },
    {
        "content": "<p>Here is (as far as i can tell) the <code>toml</code> equivalent of mathlibs options</p>\n<div class=\"codehilite\" data-code-language=\"TOML\"><pre><span></span><code><span class=\"k\">[leanoptions]</span>\n<span class=\"n\">weak</span><span class=\"p\">.</span><span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">docPrime</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">false</span>\n<span class=\"n\">weak</span><span class=\"p\">.</span><span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">hashCommand</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">weak</span><span class=\"p\">.</span><span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">oldObtain</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">weak</span><span class=\"p\">.</span><span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">weak</span><span class=\"p\">.</span><span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">cdot</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">weak</span><span class=\"p\">.</span><span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">dollarSyntax</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">weak</span><span class=\"p\">.</span><span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">header</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">weak</span><span class=\"p\">.</span><span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">lambdaSyntax</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">weak</span><span class=\"p\">.</span><span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">longLine</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">weak</span><span class=\"p\">.</span><span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">longFile</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">1500</span>\n<span class=\"n\">weak</span><span class=\"p\">.</span><span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">missingEnd</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">weak</span><span class=\"p\">.</span><span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">multiGoal</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">weak</span><span class=\"p\">.</span><span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">setOption</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">pp</span><span class=\"p\">.</span><span class=\"n\">unicode</span><span class=\"p\">.</span><span class=\"n\">fun</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">autoImplicit</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">false</span>\n\n<span class=\"k\">[moreserveroptions]</span>\n<span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">docPrime</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">false</span>\n<span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">hashCommand</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">oldObtain</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">cdot</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">dollarSyntax</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">header</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">lambdaSyntax</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">longLine</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">longFile</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">1500</span>\n<span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">missingEnd</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">multiGoal</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">style</span><span class=\"p\">.</span><span class=\"n\">setOption</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n</code></pre></div>",
        "id": 502139233,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1740602054
    },
    {
        "content": "<p>(hope this helps)</p>",
        "id": 502140069,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1740602343
    },
    {
        "content": "<p>This definitely helps! I have this vague idea that there are two kinds of linters -- syntax linters and some other kind -- does this explain why there are two lists?</p>",
        "id": 502142014,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740603066
    },
    {
        "content": "<p>Oh no that can't be it because the lists are extremely similar!</p>",
        "id": 502142160,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740603128
    },
    {
        "content": "<p>No, these are all syntax linters.  The two lists should be the default in <code>lake build</code> (with <code>weak</code>) and the default value for when you open a file (without <code>weak</code>).</p>",
        "id": 502142897,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740603395
    },
    {
        "content": "<p>I think that mathlib makes no distinction: all linters that are active in CI are also active on VSCode and vice versa.</p>",
        "id": 502143094,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740603472
    },
    {
        "content": "<p>The \"other\" linters, namely the environment linters, are run by writing <code>#lint</code> in your file and they check everything in the environment so far (that is, from where you write it and up).  For making them active in CI, Mathlib uses a step which runs <code>env LEAN_ABORT_ON_PANIC=1 lake exe runLinter Mathlib</code>.</p>",
        "id": 502143859,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740603742
    },
    {
        "content": "<p>For instance, the simpNF linter is activated in that step.</p>",
        "id": 502143908,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740603765
    },
    {
        "content": "<p>Yeah Iinted a PR today and the simpNF linter failed and that was what actually pushed me to ask the question</p>",
        "id": 502146757,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740604948
    }
]