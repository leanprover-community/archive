[
    {
        "content": "<p>Here's a start: <a href=\"https://github.com/ImperialCollegeLondon/FLT/pull/798\">FLT#798</a>. One annoying thing that I'm running into is that I need a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=BorelSpace#doc\">docs#BorelSpace</a> instance on the quotient, but the only one I can seem to find is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=QuotientAddGroup.borelSpace#doc\">docs#QuotientAddGroup.borelSpace</a> which requires a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PolishSpace#doc\">docs#PolishSpace</a> assumption. Will this cause problems?</p>",
        "id": 563115325,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765436690
    },
    {
        "content": "<p>Huh! So again we're in the situation where I want to put the borel measure on everything but those helpful measure theorists have decided to put another measure space structure on a quotient so if we don't want to cause diamonds I need to hope that my objects satisfy their properties. Hopefully they do but I don't know this time. Everything is a finite product of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">A</mi><mi mathvariant=\"double-struck\">Q</mi></msub><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{A}_\\mathbb{Q}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9556em;vertical-align:-0.2667em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3322em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathbb mtight\">Q</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2667em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span> Are the adeles of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8556em;vertical-align:-0.1667em;\"></span><span class=\"mord mathbb\">Q</span></span></span></span> a Polish space? I don't know of any natural metric on them (there's a natural norm on the ideles but the product doesn't converge on the adeles) but maybe there's some general nonsense argument? Is the restricted product of polish spaces over compact open subspaces a polish space?</p>",
        "id": 563135339,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765444486
    },
    {
        "content": "<p>To be honest I find this sort of thing fascinating. I don't ever remember seeing a discussion of this sort of thing in the literature but formalisation makes you honest.</p>",
        "id": 563135543,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765444553
    },
    {
        "content": "<p>Does your theorem need the measure space structure on the quotient or can you just use Haar measure on everything? For sure everything is locally compact and second countable.</p>",
        "id": 563135896,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765444675
    },
    {
        "content": "<p>A countable product of Polish spaces is Polish. A subspace of Polish is Polish iff it is the countable intersection of a sequence of opens. This feels close?</p>",
        "id": 563136213,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1765444774
    },
    {
        "content": "<p>Unfortunately the adeles don't get the subspace topology. However if a countable product of polish spaces is polish then maybe a countable restricted product will be too. </p>\n<p>This is not a problem for Fermat because the version of blichfeldt in mathlib will apply; the fundamental domain approach will work and this doesn't need the polish assumption. It would not surprise me if it's very easy to check that adeles are polish though, it's just not a question I've ever seen before and I don't know the first thing about polish spaces.</p>",
        "id": 563136677,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765444909
    },
    {
        "content": "<p>Is a countable direct limit of polish spaces polish? That would also do it</p>",
        "id": 563136902,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765444978
    },
    {
        "content": "<p>Are the adeles completely metrisable?</p>",
        "id": 563136925,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1765444986
    },
    {
        "content": "<p>They (adeles of Q) feel like they should be a separable space</p>",
        "id": 563137045,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1765445027
    },
    {
        "content": "<p>I don't know. I don't know of any natural real-valued function on them which sends nonzero things to nonzero things.</p>",
        "id": 563137084,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765445039
    },
    {
        "content": "<p>All the components are metric spaces and indeed normed fields but the product of the local norms of the components of an element can diverge to zero</p>",
        "id": 563137330,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765445113
    },
    {
        "content": "<p>I'm thinking more like how the Fr√©chet metric is defined on smooth functions as the weighted infinite sum of the C^k metrics. The C^k metrics come from norms, but the Fr√©chet metric doesn't. So you have the norms on each Q_p (and R), but you sum them, and the result is only a metric, not anything like norm.</p>",
        "id": 563138098,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1765445347
    },
    {
        "content": "<p>This is a complete metric on C^\\infty, even though C^\\infty is not complete in any of the C^k norms</p>",
        "id": 563138274,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1765445396
    },
    {
        "content": "<p>However I have no idea if the adele topology can be described this way</p>",
        "id": 563138371,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1765445419
    },
    {
        "content": "<p>I admit it does seem unlikely, and in which case apologies for the distraction!</p>",
        "id": 563138939,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1765445569
    },
    {
        "content": "<p>Zp and R are Polish, so the countable product Zhat x R is Polish. To get adeles, we just need to take a union of dilations by 1/n, so is Polishness preserved by taking this union?</p>",
        "id": 563139752,
        "sender_full_name": "Scott Carnahan",
        "timestamp": 1765445815
    },
    {
        "content": "<p>Right -- is a countable direct limit of polish spaces polish?</p>",
        "id": 563144132,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765447001
    },
    {
        "content": "<p>17 messages were moved here from <a class=\"stream-topic\" data-stream-id=\"416277\" href=\"/#narrow/channel/416277-FLT/topic/Fundamental.20domains/with/563057814\">#FLT &gt; Fundamental domains</a> by <span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span>.</p>",
        "id": 563144253,
        "sender_full_name": "Notification Bot",
        "timestamp": 1765447035
    },
    {
        "content": "<p>Is every second-countable locally compact Hausdorff space automatically Polish? Again just showing my ignorance here.</p>",
        "id": 563159968,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765451796
    },
    {
        "content": "<p>yes!<br>\n<a href=\"https://topology.pi-base.org/spaces?q=Second+countable+%2B+Locally+compact+%2B+%24T_2%24+%2B+%7EPolish\">https://topology.pi-base.org/spaces?q=Second+countable+%2B+Locally+compact+%2B+%24T_2%24+%2B+%7EPolish</a></p>",
        "id": 563160395,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1765451892
    },
    {
        "content": "<p>Well we seem to be missing an instance:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">SecondCountableTopology</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">T2Space</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LocallyCompactSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"bp\">#</span><span class=\"n\">synth</span><span class=\"w\"> </span><span class=\"n\">PolishSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"c1\">-- fails</span>\n</code></pre></div>\n<p>but I think this will do it.</p>",
        "id": 563160871,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765451974
    },
    {
        "content": "<p>seems to be</p>\n<ul>\n<li>urysohn metrization</li>\n<li>locally compact metrizable spaces are completely metrizable</li>\n</ul>",
        "id": 563163107,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1765452366
    },
    {
        "content": "<p>I wonder if we can take a short cut in this case. The measurable space on a quotient is just</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">Quotient</span><span class=\"bp\">.</span><span class=\"n\">instMeasurableSpace</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œ±</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Setoid</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quotient</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">Quotient</span><span class=\"bp\">.</span><span class=\"n\">mk''</span>\n</code></pre></div>\n<p>and one can ask whether it's true that for the quotient of an abelian topological group by a closed subgroup, the pushforward of the Borel measure is the Borel measure under mild assumptions. Pushforwards of topologies along quotient maps in group theory are really nicely behaved -- for example IIRC they are open quotient maps. Is this enough?</p>",
        "id": 563163754,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765452484
    },
    {
        "content": "<p>Here's me worrying whether the adeles are locally compact , because of the weird restricted product topology and my complete unfamiliarity with p-adic topologies. Because I had found that the nLab has </p>\n<p>\"A locally compact Hausdorff space is Polish iff it is second-countable.\"<br>\n<a href=\"https://ncatlab.org/nlab/show/Polish+space#further_examples\">https://ncatlab.org/nlab/show/Polish+space#further_examples</a></p>",
        "id": 563164198,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1765452617
    },
    {
        "content": "<p><del>is the borel space on the pushforward (quotient) topology the same as the pushforward of the borel space?</del> found a counterexample</p>",
        "id": 563165707,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1765453198
    },
    {
        "content": "<p>Yeah the adeles had better be locally compact because this is what makes Tate's thesis work. An infinite product of compact spaces is compact, but an infinite product of locally compact spaces is not in general locally compact: for example the \"big\" space <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi><mo>√ó</mo><msub><mo>‚àè</mo><mi>p</mi></msub><msub><mi mathvariant=\"double-struck\">Q</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}\\times\\prod_p\\mathbb{Q}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7722em;vertical-align:-0.0833em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">√ó</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1858em;vertical-align:-0.4358em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">‚àè</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0017em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> which the adeles sit in algebraically is \\emph{not} locally compact because neither the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>-adics <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">Q</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.975em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> nor the reals are compact, and the definition of open sets in the product topology forces lots of these things in, so you can't find a compact neighbourhood of 0. But even though this \"big\" space is a great place to put the adeles algebraically, topologically it is the wrong model. The adeles are topologised to make <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi><mo>√ó</mo><msub><mo>‚àè</mo><mi>p</mi></msub><msub><mi mathvariant=\"double-struck\">Z</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\R\\times\\prod_p\\Z_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7722em;vertical-align:-0.0833em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">√ó</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1858em;vertical-align:-0.4358em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">‚àè</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0017em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> an open subgroup, and this is locally compact so we're fine.</p>",
        "id": 563166689,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765453496
    },
    {
        "content": "<p>Tate's thesis shows that a bunch of classical results about analytic and meromorphic continuation of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>-functions of Hecke characters (simplest example: the Riemann zeta function) can be deduced very elegantly using abstract Fourier analysis and Pontrjagin duality on the adeles, which applies because the adeles are locally compact.</p>",
        "id": 563167026,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765453607
    },
    {
        "content": "<p>I've got sorry-free instances for adeles of a number field being locally compact and Hausdorff, so it's only the hardest bit (second countable) left.<br>\nModulo <a class=\"message-link\" href=\"/#narrow/channel/217875-Is-there-code-for-X.3F/topic/second.20countable.20topology.20question/near/563179150\">#Is there code for X? &gt; second countable topology question @ üí¨</a>  I have the infinite places; the hardest question<br>\n<code>instance : SecondCountableTopology (FiniteAdeleRing (ùìû K) K) := sorry</code> remains.</p>",
        "id": 563180090,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765457837
    },
    {
        "content": "<p>OK I think I have a plan for SecondCountableTopology (FiniteAdeleRing) so the only thing left is why it's Polish. I might try Aristotle on this...</p>",
        "id": 563236490,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765471439
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/416277-FLT/topic/Are.20the.20adeles.20Polish.3F/near/563236490\">said</a>:</p>\n<blockquote>\n<p>so the only thing left is why it's Polish.</p>\n</blockquote>\n<p>By urysohn metrization theorem (<a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=TopologicalSpace.metrizableSpace_of_t3_secondCountable#doc\">docs#TopologicalSpace.metrizableSpace_of_t3_secondCountable</a>), the space is metrizable. It is second countable by assumption. And it's completely metrizable because it's locally compact and metrizable (I saw a draft PR with an intermediate result for this, <a href=\"https://github.com/leanprover-community/mathlib4/pull/32706\">#32706</a>).</p>",
        "id": 563268262,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1765481548
    },
    {
        "content": "<p>Here's what I got:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">Metrizable</span><span class=\"bp\">.</span><span class=\"n\">Urysohn</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">MetricSpace</span><span class=\"bp\">.</span><span class=\"n\">Polish</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">UniformSpace</span><span class=\"bp\">.</span><span class=\"n\">Completion</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">MetricSpace</span><span class=\"bp\">.</span><span class=\"n\">Completion</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">UniformSpace</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Topology</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">open_of_locally_compact_dense_metrizable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">MetrizableSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MetrizableSpace</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LocallyCompactSpace</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Continuous</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">indf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsInducing</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">dn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">DenseRange</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">IsOpen</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">isOpen_iff_mem_nhds</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">hx</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">_</span><span class=\"n\">root_</span><span class=\"bp\">.</span><span class=\"n\">mem_nhds_iff</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mem_range</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hx</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hx</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">s_op</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y_in_s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">s_cc</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">exists_isOpen_mem_isCompact_closure</span><span class=\"w\"> </span><span class=\"n\">y</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsInducing</span><span class=\"bp\">.</span><span class=\"n\">isOpen_iff</span><span class=\"w\"> </span><span class=\"n\">indf</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">s_op</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">t_op</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">s_preim_t</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">s_op</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">clt_im_cls</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Subset</span><span class=\"bp\">.</span><span class=\"n\">antisymm_iff</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">constructor</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">closure_minimal</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"w\"> </span><span class=\"n\">isClosed_closure</span>\n<span class=\"w\">      </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">hz</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mem_closure_iff</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">o_op</span><span class=\"w\"> </span><span class=\"n\">z_in_o</span>\n<span class=\"w\">      </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">DenseRange</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">dn</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">dense_iff_inter_open</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">dn</span>\n<span class=\"w\">      </span><span class=\"n\">specialize</span><span class=\"w\"> </span><span class=\"n\">dn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"bp\">‚à©</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">o_op</span><span class=\"bp\">.</span><span class=\"n\">inter</span><span class=\"w\"> </span><span class=\"n\">t_op</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">z</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">z_in_o</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hz</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">‚à©</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">s_preim_t</span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Eq</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">image_preimage_eq_inter_range</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inter_assoc</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">dn</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">dn</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">closure_mono</span>\n<span class=\"w\">      </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">hz</span>\n<span class=\"w\">      </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">w</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hw</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hz</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">s_preim_t</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hw</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hw</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">t</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">‚ü®?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">t_op</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_‚ü©</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"k\">calc</span>\n<span class=\"w\">      </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">‚äÜ</span><span class=\"w\"> </span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">subset_closure</span>\n<span class=\"w\">      </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">clt_im_cls</span>\n<span class=\"w\">      </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">‚äÜ</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">closure_image_closure</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsClosed</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">          </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">IsCompact</span><span class=\"bp\">.</span><span class=\"n\">isClosed</span>\n<span class=\"w\">          </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">IsCompact</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">s_cc</span><span class=\"w\"> </span><span class=\"n\">hf</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsClosed</span><span class=\"bp\">.</span><span class=\"n\">closure_eq</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">image_subset_range</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">s_preim_t</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">y_in_s</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">y_in_s</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">polish_of_locally_compact_second_countable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SecondCountableTopology</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">T2Space</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">LocallyCompactSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PolishSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">letI</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MetrizableSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">metrizableSpace_of_t3_secondCountable</span><span class=\"w\"> </span><span class=\"n\">X</span>\n<span class=\"w\">  </span><span class=\"n\">letI</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MetricSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">metrizableSpaceMetric</span><span class=\"w\"> </span><span class=\"n\">X</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">dn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsOpen</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Completion</span><span class=\"bp\">.</span><span class=\"n\">coe'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Completion</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">open_of_locally_compact_dense_metrizable</span><span class=\"w\"> </span><span class=\"n\">Completion</span><span class=\"bp\">.</span><span class=\"n\">coe'</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Completion</span><span class=\"bp\">.</span><span class=\"n\">continuous_coe</span><span class=\"w\"> </span><span class=\"n\">X</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">IsDenseInducing</span><span class=\"bp\">.</span><span class=\"n\">isInducing</span><span class=\"w\"> </span><span class=\"n\">Completion</span><span class=\"bp\">.</span><span class=\"n\">isDenseInducing_coe</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Completion</span><span class=\"bp\">.</span><span class=\"n\">denseRange_coe</span>\n<span class=\"w\">  </span><span class=\"n\">letI</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PolishSpace</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Completion</span><span class=\"bp\">.</span><span class=\"n\">coe'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Completion</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"n\">IsOpen</span><span class=\"bp\">.</span><span class=\"n\">polishSpace</span><span class=\"w\"> </span><span class=\"n\">dn</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hHomeo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">‚âÉ‚Çú</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Completion</span><span class=\"bp\">.</span><span class=\"n\">coe'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Completion</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Completion</span><span class=\"bp\">.</span><span class=\"n\">coe_isometry</span><span class=\"bp\">.</span><span class=\"n\">isEmbedding</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toHomeomorph</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hHomeo</span><span class=\"bp\">.</span><span class=\"n\">isClosedEmbedding</span><span class=\"bp\">.</span><span class=\"n\">polishSpace</span>\n</code></pre></div>",
        "id": 563290956,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1765490814
    },
    {
        "content": "<p>Actually you can replace MetrizableSpace X Y with T2Space X Y</p>",
        "id": 563291712,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1765491138
    },
    {
        "content": "<p>Aristotle did it too but its proof was longer</p>",
        "id": 563292099,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765491303
    },
    {
        "content": "<p>FWIW here's an explicit metric for the adeles, and moreover the adeles inside the unrestricted product are carved out by the expression being &lt; \\infty</p>\n<p><a href=\"https://mathoverflow.net/a/504887/4177\">https://mathoverflow.net/a/504887/4177</a></p>",
        "id": 563298993,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1765495156
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/oliHQLoYjKA7X3Jql9hapJTM/Screenshot-2025-12-12-at-10.18.52AM.png\">Screenshot 2025-12-12 at 10.18.52‚ÄØAM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/oliHQLoYjKA7X3Jql9hapJTM/Screenshot-2025-12-12-at-10.18.52AM.png\" title=\"Screenshot 2025-12-12 at 10.18.52‚ÄØAM.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"606x131\" src=\"/user_uploads/thumbnail/3121/oliHQLoYjKA7X3Jql9hapJTM/Screenshot-2025-12-12-at-10.18.52AM.png/840x560.webp\"></a></div>",
        "id": 563301320,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1765496939
    },
    {
        "content": "<p>I don't know if this helps with thinking about the Haar measure, but just in case...</p>",
        "id": 563301401,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1765496993
    },
    {
        "content": "<p>Looks like one other thing we'll need is that <code>D_ùî∏</code> has infinite measure, so that we can construct a set of large measure (see <a href=\"https://github.com/ImperialCollegeLondon/FLT/pull/798\">FLT#798</a>). Do we know this?</p>",
        "id": 563314705,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765506337
    },
    {
        "content": "<p>My proposal here was to write down an arbitrary compact open subgroup at the finite places and take the product with a large closed ball at the infinite place.</p>",
        "id": 563329989,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765519874
    },
    {
        "content": "<p>Let me just note that since the adeles already come with a uniform structure, it would be cleaner to show that the <em>uniform structure</em> is complete and countably generated (not just that there exists such a uniform structure)</p>",
        "id": 563528195,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1765560567
    },
    {
        "content": "<p>More precisely, the fact that the uniformity is countably generated should come pretty easily from <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsUniformAddGroup.uniformity_countably_generated#doc\">docs#IsUniformAddGroup.uniformity_countably_generated</a>, and then there is a general statement that locally compact groups are complete (I don‚Äôt remember seeing this in Mathlib, but I haven‚Äôt searched for it)</p>",
        "id": 563615241,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1765627439
    },
    {
        "content": "<p>I think both approaches are valuable: in the specific case of the adeles, this tells you more than \"they are Polish\". But there is also the statement that a reasonable restricted product is Polish, which is less strong but more general.</p>",
        "id": 563615361,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1765627573
    },
    {
        "content": "<p><a href=\"https://github.com/ImperialCollegeLondon/FLT/pull/797\">FLT#797</a> (just merged) contains proofs that the adeles of a number field are locally compact, T2 and second countable (and also the construction of a fundamental domain for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8556em;vertical-align:-0.1667em;\"></span><span class=\"mord mathbb\">Q</span></span></span></span> in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">A</span></span></span></span> in case the measure theory approach doesn't work out ;-) ). Sounds like second countable was not quite the right thing to prove and I should have instead proved that the uniformity <code>IsCountablyGenerated</code> but maybe this follows? I don't know if it's just abstract nonsense now.</p>",
        "id": 563836593,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765808571
    },
    {
        "content": "<p>The fact that the uniformity is countably generated definitely follows, thanks to <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/Algebra/IsUniformGroup/Defs.html#IsUniformAddGroup.uniformity_countably_generated\">IsUniformAddGroup.uniformity_countably_generated</a> (and indeed you need way less than second-countable).</p>",
        "id": 563842971,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1765810040
    },
    {
        "content": "<p>The problem is completeness. I checked this weekend to be sure I wasn't saying nonsense, but it seems that there are indeed Polish groups which are <em>not</em> complete for their (left or right, it doesn't matter) uniform structure. This is because the uniformity induced by some complete distance and the uniformity induced by the group structure have no reason to coincide.<br>\nIt also seems, however, that this pathology disappears in the abelian case, but I haven't thought about the proof.</p>",
        "id": 563843991,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1765810257
    },
    {
        "content": "<p>In any case, I think Mathlib deserves to know that a locally compact uniform group is complete (maybe it does already ?), and this is the \"correct\" proof in your setting.</p>",
        "id": 563844269,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1765810324
    },
    {
        "content": "<p>On the completeness of locally compact groups, I couldn't find it in mathlib, but here's what I have:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Filter</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">Pointwise</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">UniformSpace</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsUniformGroup</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LocallyCompactSpace</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CompleteSpace</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">hfn</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">K</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hK</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hKf</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IsCompact</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">K'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hK'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hK'‚ÇÅ</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">WeaklyLocallyCompactSpace</span><span class=\"bp\">.</span><span class=\"n\">exists_compact_mem_nhds</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">√ó</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">√ó</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">‚Åª¬π</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">K'</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hU</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">uniformity</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">uniformity_eq_comap_inv_mul_nhds_one</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">preimage_mem_comap</span><span class=\"w\"> </span><span class=\"n\">hK'‚ÇÅ</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hSf</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hSU</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">√óÀ¢</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">‚äÜ</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">rcases</span><span class=\"w\"> </span><span class=\"n\">mem_prod_iff</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"n\">hU</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">A</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hA</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hB</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hAB</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">‚à©</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">inter_mem_iff</span><span class=\"bp\">.</span><span class=\"n\">mpr</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">hA</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hB</span><span class=\"bp\">‚ü©</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">prod_mono</span><span class=\"w\"> </span><span class=\"n\">inter_subset_left</span><span class=\"w\"> </span><span class=\"n\">inter_subset_right</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">hAB</span><span class=\"bp\">‚ü©‚ü©</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">nonempty_of_mem</span><span class=\"w\"> </span><span class=\"n\">hSf</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ä¢</span><span class=\"w\"> </span><span class=\"n\">K'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hK'</span><span class=\"bp\">.</span><span class=\"n\">smul</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mem_of_superset</span><span class=\"w\"> </span><span class=\"n\">hSf</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">x</span><span class=\"bp\">‚Åª¬π</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hSU</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">mk_mem_prod</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"bp\">‚ü©</span><span class=\"o\">)</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hK</span><span class=\"bp\">.</span><span class=\"n\">isComplete</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">hfn</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">le_principal_iff</span><span class=\"bp\">.</span><span class=\"n\">mpr</span><span class=\"w\"> </span><span class=\"n\">hKf</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">‚ü©</span>\n</code></pre></div>",
        "id": 563969332,
        "sender_full_name": "Bryan Wang",
        "timestamp": 1765864347
    },
    {
        "content": "<p>Please PR to mathlib!</p>",
        "id": 563969427,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765864447
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/32944\">#32944</a></p>",
        "id": 563975373,
        "sender_full_name": "Bryan Wang",
        "timestamp": 1765868520
    }
]