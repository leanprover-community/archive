[
    {
        "content": "<p>So we're close to a sorry-free <code>TotallyDefiniteQuaternionAlgebra.WeightTwoAutomorphicForm.finiteDimensional</code> and I hope to get this over the line before Christmas (I have plenty of time to work on this myself).</p>\n<p>Annoyingly, my vision for how one proof would go has been punctured slightly. We need this basic fact that if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> is a locally compact additive abelian group (think <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>) and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Î“</mi></mrow><annotation encoding=\"application/x-tex\">\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Î“</span></span></span></span> is a countable discrete group of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> (think <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">Z</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Z}^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">Z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>) such that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">Î“</mi></mrow><annotation encoding=\"application/x-tex\">X/\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">/Î“</span></span></span></span> is compact, then for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi><mo>âŠ†</mo><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">U\\subseteq X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âŠ†</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> of sufficiently large (Haar) measure, the composite <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi><mo>â†’</mo><mi>X</mi><mo>â†’</mo><mi>X</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">Î“</mi></mrow><annotation encoding=\"application/x-tex\">U\\to X\\to X/\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">/Î“</span></span></span></span> can't be injective. I had assumed that this would be somewhere in mathlib (and I don't even know a precise statement; maybe what I'm claiming is too general), but the best I can find is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.exists_pair_mem_lattice_not_disjoint_vadd#doc\">docs#MeasureTheory.exists_pair_mem_lattice_not_disjoint_vadd</a> which, instead of using quotients, is using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsAddFundamentalDomain#doc\">docs#IsAddFundamentalDomain</a> and I can't find any magic way of constructing fundamental domains for discrete actions so I'm wondering if the easiest thing is simply to construct the fundamental domain in our situation. This will involve doing measure theory, which is definitely not my strong point. We actually need an adelic version, but only over <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8556em;vertical-align:-0.1667em;\"></span><span class=\"mord mathbb\">Q</span></span></span></span>. Here is an example of what would be helpful to us (if we do everything for the adeles of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8556em;vertical-align:-0.1667em;\"></span><span class=\"mord mathbb\">Q</span></span></span></span> then we can deduce everything in general, because <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">A</mi><mi>K</mi></msub><mo>=</mo><msub><mi mathvariant=\"double-struck\">A</mi><mi mathvariant=\"double-struck\">Q</mi></msub><msub><mo>âŠ—</mo><mi mathvariant=\"double-struck\">Q</mi></msub><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{A}_K=\\mathbb{A}_{\\mathbb{Q}}\\otimes_{\\mathbb{Q}}K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9556em;vertical-align:-0.2667em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3322em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbb mtight\">Q</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2667em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"><span class=\"mbin\">âŠ—</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3322em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbb mtight\">Q</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2667em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>).</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">NumberField</span><span class=\"w\"> </span><span class=\"n\">Metric</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span><span class=\"w\"> </span><span class=\"n\">IsDedekindDomain</span>\n\n<span class=\"kn\">notation</span><span class=\"o\">:</span><span class=\"mi\">101</span><span class=\"w\"> </span><span class=\"s2\">\"ğ”¸\"</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">AdeleRing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ğ“</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">K</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ğ”¸</span><span class=\"w\"> </span><span class=\"n\">â„š</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">borel</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BorelSpace</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ğ”¸</span><span class=\"w\"> </span><span class=\"n\">â„š</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">âŸ¨</span><span class=\"n\">rfl</span><span class=\"bp\">âŸ©</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LocallyCompactSpace</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ğ”¸</span><span class=\"w\"> </span><span class=\"n\">â„š</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"c1\">-- is this how you make a VAdd from an Algebra?</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">VAdd</span><span class=\"w\"> </span><span class=\"n\">â„š</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">AdeleRing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ğ“</span><span class=\"w\"> </span><span class=\"n\">â„š</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">â„š</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">vadd</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">â„š</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ğ”¸</span><span class=\"w\"> </span><span class=\"n\">â„š</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">a</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ğ”¸</span><span class=\"w\"> </span><span class=\"n\">â„š</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">univ</span><span class=\"bp\">.</span><span class=\"n\">pi</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">closedBall</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mf\">0.5</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">prod</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">RestrictedProduct</span><span class=\"bp\">.</span><span class=\"n\">structureMap</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsAddFundamentalDomain</span><span class=\"w\"> </span><span class=\"n\">â„š</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"bp\">.</span><span class=\"n\">addHaar</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>I can't find any magic constructors for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsAddFundamentalDomain#doc\">docs#IsAddFundamentalDomain</a> so I think we might simply have to check the axioms. <code>nullMeasurableSet</code> and <code>ae_covers</code> shouldn't be too bad but I am a bit nervous about <code>aedisjoint : Pairwise &lt;| (AEDisjoint Î¼ on fun g : G =&gt; g +áµ¥ s)</code>. Another approach would be to use <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[0,1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> at infinity rather than <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>âˆ’</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>0.5</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-0.5,0.5]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">âˆ’</span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.5</span><span class=\"mclose\">]</span></span></span></span> and then one can really prove disjointness; the measure-theory issues go away because this really would be a fundamental domain in the strict sense (it meets every orbit once, rather than up to a measure zero error); maybe this is a better idea (but then we'd have to figure out how to say <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[0,1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> in <code>Set v.Completion</code> where <code>v :Â InfinitePlace â„š</code>, which is probably something we should be able to do anyway...</p>\n<p>We need this for <code>NumberField.AdeleRing.DivisionAlgebra.Aux.existsE</code> in <code>FLT/DivisionAlgebra/Finiteness.lean</code>.</p>",
        "id": 562656110,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765278603
    },
    {
        "content": "<p>Actually, typing this message has made me realise that the most sensible approach is simply to use <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[0,1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> which makes all measure-theoretic issues go away. I'm now working on a variant of the above <code>sorry</code> which will suffice.</p>",
        "id": 562663657,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765281108
    },
    {
        "content": "<p>A couple of random things I've skipped:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"bp\">.</span><span class=\"n\">eq_floor</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„¤</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">â‰¤</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">âŒŠ</span><span class=\"n\">a</span><span class=\"bp\">âŒ‹</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ht</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">âˆˆ</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Ico</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">â€–</span><span class=\"n\">t</span><span class=\"bp\">â€–</span><span class=\"w\"> </span><span class=\"bp\">â‰¤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>but things are going well. I have a set and have reduced the proof that it's a fundamental domain to statements which are not measure-theoretic but are completely algebraic, which means that I should be able to use Salvatore's work on the way K sits in A_K.</p>",
        "id": 562733366,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765297513
    },
    {
        "content": "<p>Didn't we already have this kind of discussion some time ago, e.g. in <a class=\"message-link\" href=\"/#narrow/channel/217875-Is-there-code-for-X.3F/topic/descending.20measures.20to.20compact.20quotients/near/517746950\">#Is there code for X? &gt; descending measures to compact quotients @ ğŸ’¬</a> ?</p>",
        "id": 562737099,
        "sender_full_name": "SÃ©bastien GouÃ«zel",
        "timestamp": 1765298299
    },
    {
        "content": "<p>Yes! And you told me that I had to make a fundamental domain and that's what I've been doing all afternoon.</p>",
        "id": 562739863,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765298918
    },
    {
        "content": "<p>In particular you pointed out <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.exists_pair_mem_lattice_not_disjoint_vadd#doc\">docs#MeasureTheory.exists_pair_mem_lattice_not_disjoint_vadd</a> but this needs a fundamental domain. What I want is: \"U in X with measure &gt; Bound =&gt; map U -&gt; X -&gt; X/Gamma not injective\" and I had assumed that compactness of X/Gamma would be enough but my understanding of the discussion you linked to was that we didn't have a way of magically constructing a fundamental domain by abstract nonsense (and the key lemma needs a fundamental domain) so I am just writing one down explicitly.</p>",
        "id": 562740462,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765299057
    },
    {
        "content": "<p>Oh sorry, let me be more precise: you <em>did</em> give me a method for constructing a fundamental domain by mostly pure thought but then Antoine said this <a class=\"message-link\" href=\"/#narrow/channel/217875-Is-there-code-for-X.3F/topic/descending.20measures.20to.20compact.20quotients/near/517987190\">#Is there code for X? &gt; descending measures to compact quotients @ ğŸ’¬</a> so I figured I would follow his idea instead.</p>",
        "id": 562741230,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765299220
    },
    {
        "content": "<p>(The point is that we did all the algebraic work already when proving compactness)</p>",
        "id": 562741575,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765299299
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/416277-FLT/topic/Fundamental.20domains/near/562733366\">said</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ht</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">âˆˆ</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Ico</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">â€–</span><span class=\"n\">t</span><span class=\"bp\">â€–</span><span class=\"w\"> </span><span class=\"bp\">â‰¤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ht</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">âˆˆ</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Ico</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">â€–</span><span class=\"n\">t</span><span class=\"bp\">â€–</span><span class=\"w\"> </span><span class=\"bp\">â‰¤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">grind</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">norm_eq_abs</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 562746139,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1765300266
    },
    {
        "content": "<p>The abstract way of doing this is to take the Haar measures on <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Î“</mi></mrow><annotation encoding=\"application/x-tex\">\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Î“</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">Î“</mi></mrow><annotation encoding=\"application/x-tex\">X/\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">/Î“</span></span></span></span>, show that they define a Haar measure on <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> satisfying <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>âˆ«</mo><mi>X</mi></msub><mo>=</mo><msub><mo>âˆ«</mo><mrow><mi>X</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">Î“</mi></mrow></msub><msub><mo>âˆ«</mo><mi mathvariant=\"normal\">Î“</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\int_X=\\int_{X/\\Gamma}\\int_\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1608em;vertical-align:-0.3558em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">âˆ«</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1225em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3358em;vertical-align:-0.5308em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">âˆ«</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1692em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord mtight\">/Î“</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5308em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">âˆ«</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1225em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">Î“</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span></span></span></span> (or rather, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>âˆ«</mo><mi>X</mi></msub><mo>=</mo><msub><mo>âˆ«</mo><mrow><mi>X</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">Î“</mi></mrow></msub><msub><mo>âˆ‘</mo><mi mathvariant=\"normal\">Î“</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\int_X=\\int_{X/\\Gamma}\\sum_\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1608em;vertical-align:-0.3558em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">âˆ«</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1225em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3358em;vertical-align:-0.5308em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">âˆ«</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1692em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord mtight\">/Î“</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5308em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1786em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">Î“</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span></span></span></span> since <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Î“</mi></mrow><annotation encoding=\"application/x-tex\">\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Î“</span></span></span></span> is discrete). Then <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi><mo>â†’</mo><mi>X</mi><mo>â†’</mo><mi>X</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">Î“</mi></mrow><annotation encoding=\"application/x-tex\">U\\to X\\to X/\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">/Î“</span></span></span></span> being injective implies that the inner sum is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>â‰¤</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\leq1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>, so <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î¼</mi><mo stretchy=\"false\">(</mo><mi>U</mi><mo stretchy=\"false\">)</mo><mo>â‰¤</mo><mi>Î¼</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">Î“</mi></mrow><annotation encoding=\"application/x-tex\">\\mu(U)\\leq\\mu(X/\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Î¼</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Î¼</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">/Î“</span></span></span></span>.</p>",
        "id": 562767113,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765305274
    },
    {
        "content": "<p>I can play around with this today and see if it's workable if you want (I'm not sure how easy this Haar measures on short exact sequences thing is).</p>",
        "id": 562767640,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765305365
    },
    {
        "content": "<p>Right -- this was the proof which I had expected to be formalising, but my impression was that the other thread was guiding me towards using fundamental domains instead.</p>",
        "id": 562774267,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765307046
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"bp\">.</span><span class=\"n\">eq_floor</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„¤</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">â‰¤</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">âŒŠ</span><span class=\"n\">a</span><span class=\"bp\">âŒ‹</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">eq_comm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"bp\">.</span><span class=\"n\">floor_eq_iff</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">grind</span>\n</code></pre></div>\n<p>just in case...</p>",
        "id": 562787292,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1765310742
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"253861\">Thomas Browning</span> <a href=\"#narrow/channel/416277-FLT/topic/Fundamental.20domains/near/562767113\">said</a>:</p>\n<blockquote>\n<p>The abstract way of doing this is to take the Haar measures on <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Î“</mi></mrow><annotation encoding=\"application/x-tex\">\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Î“</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">Î“</mi></mrow><annotation encoding=\"application/x-tex\">X/\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">/Î“</span></span></span></span>, show that they define a Haar measure on <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> satisfying <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>âˆ«</mo><mi>X</mi></msub><mo>=</mo><msub><mo>âˆ«</mo><mrow><mi>X</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">Î“</mi></mrow></msub><msub><mo>âˆ«</mo><mi mathvariant=\"normal\">Î“</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\int_X=\\int_{X/\\Gamma}\\int_\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1608em;vertical-align:-0.3558em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">âˆ«</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1225em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3358em;vertical-align:-0.5308em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">âˆ«</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1692em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord mtight\">/Î“</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5308em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">âˆ«</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1225em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">Î“</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span></span></span></span> (or rather, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>âˆ«</mo><mi>X</mi></msub><mo>=</mo><msub><mo>âˆ«</mo><mrow><mi>X</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">Î“</mi></mrow></msub><msub><mo>âˆ‘</mo><mi mathvariant=\"normal\">Î“</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\int_X=\\int_{X/\\Gamma}\\sum_\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1608em;vertical-align:-0.3558em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">âˆ«</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1225em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3358em;vertical-align:-0.5308em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">âˆ«</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1692em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord mtight\">/Î“</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5308em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1786em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">Î“</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span></span></span></span> since <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Î“</mi></mrow><annotation encoding=\"application/x-tex\">\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Î“</span></span></span></span> is discrete). Then <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi><mo>â†’</mo><mi>X</mi><mo>â†’</mo><mi>X</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">Î“</mi></mrow><annotation encoding=\"application/x-tex\">U\\to X\\to X/\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">/Î“</span></span></span></span> being injective implies that the inner sum is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>â‰¤</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\leq1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>, so <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î¼</mi><mo stretchy=\"false\">(</mo><mi>U</mi><mo stretchy=\"false\">)</mo><mo>â‰¤</mo><mi>Î¼</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">Î“</mi></mrow><annotation encoding=\"application/x-tex\">\\mu(U)\\leq\\mu(X/\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Î¼</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Î¼</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">/Î“</span></span></span></span>.</p>\n</blockquote>\n<p>I've got a proof here: <a href=\"https://github.com/leanprover-community/mathlib4/pull/32672\">#32672</a>. It's not super pretty yet, but I'll work on cleaning it up over the next few days. Is there a specific sorry in the FLT repo that we're looking to close?</p>",
        "id": 562887698,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765353093
    },
    {
        "content": "<p>There's something called existsE but that's several things rolled into one. I have a draft PR which contains something closer but it contains a bunch of other stuff too. Today quite busy though</p>",
        "id": 562888558,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765353372
    },
    {
        "content": "<p>OK on branch <code>kbuzzard-existsE-workingtowards</code> there's <code>not_injective_of_large_measure</code> in <code>FLT/DivisionAlgebra/Finiteness.lean</code> which should be enough for the application. You can assume that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mo>âŠ‚</mo><msub><mi>D</mi><mi mathvariant=\"double-struck\">A</mi></msub></mrow><annotation encoding=\"application/x-tex\">D\\subset D_{\\mathbb{A}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7224em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âŠ‚</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3322em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbb mtight\">A</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> is countable, discrete and cocompact, and that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>D</mi><mi mathvariant=\"double-struck\">A</mi></msub></mrow><annotation encoding=\"application/x-tex\">D_{\\mathbb{A}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3322em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbb mtight\">A</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> is locally compact; we either have these already or they're easy from what we have.</p>",
        "id": 562904071,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765357840
    },
    {
        "content": "<p>Looks like I don't even need cocompactness, just discreteness (although they are equivalent, I think).</p>",
        "id": 563050626,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765400029
    },
    {
        "content": "<p>You mean for your integral formula? I can believe it. I just need compactness to guarantee finite measure in the application. I checked today that the statement on the FLT branch is enough for me.</p>",
        "id": 563054782,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765400752
    },
    {
        "content": "<p>Ok, I'll clean up the PR a bit more and then look into hooking it up to <code>not_injective_of_large_measure</code>.</p>",
        "id": 563057814,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765401279
    },
    {
        "content": "<p>So looks like I will need compactness of the quotient after all. Is this known, or will I need to use an explicit compact set (e.g., a fundamental domain or something larger)?</p>",
        "id": 563937446,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765837797
    },
    {
        "content": "<p>Or maybe it follows from cocompactness of the adeles?</p>",
        "id": 563941957,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765840474
    },
    {
        "content": "<p>We already have compactness of the quotient. What we didn't have was the fundamental domain.</p>",
        "id": 563969256,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765864249
    },
    {
        "content": "<p>Yes, it's looking like this will go through just fine, I think.</p>",
        "id": 563972196,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765866475
    },
    {
        "content": "<p>A bit hacky, but <a href=\"https://github.com/ImperialCollegeLondon/FLT/pull/798\">FLT#798</a> now closes the sorry in <code>not_injective_of_large_measure</code></p>",
        "id": 563975842,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765868765
    },
    {
        "content": "<p>It's ready for merge as far as I'm concerned, but it's failing CI because the mathlib PR part of it doesn't lint:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>  /- The `defLemma` linter reports:\n  INCORRECT DEF/LEMMA: -/\n  -- FLT.Mathlib.MeasureTheory.Haar.Extension\n  /home/runner/work/FLT/FLT/FLT/Mathlib/MeasureTheory/Haar/Extension.lean:56:1: error: @TopologicalGroup.IsSES.ofClosedSubgroup is a def, should be lemma/theorem\n  /home/runner/work/FLT/FLT/FLT/Mathlib/MeasureTheory/Haar/Extension.lean:57:3: error: @TopologicalAddGroup.IsSES.ofClosedAddSubgroup is a def, should be lemma/theorem\n\n  /- The `docBlame` linter reports:\n  DEFINITIONS ARE MISSING DOCUMENTATION STRINGS: -/\n  -- FLT.Mathlib.MeasureTheory.Haar.Extension\n  /home/runner/work/FLT/FLT/FLT/Mathlib/MeasureTheory/Haar/Extension.lean:79:3: error: @TopologicalAddGroup.IsSES.pullback definition missing documentation string\n  /home/runner/work/FLT/FLT/FLT/Mathlib/MeasureTheory/Haar/Extension.lean:113:3: error: @TopologicalAddGroup.IsSES.pushforward definition missing documentation string\n  /home/runner/work/FLT/FLT/FLT/Mathlib/MeasureTheory/Haar/Extension.lean:224:3: error: @TopologicalAddGroup.IsSES.integrate definition missing documentation string\n  /home/runner/work/FLT/FLT/FLT/Mathlib/MeasureTheory/Haar/Extension.lean:248:3: error: @TopologicalAddGroup.IsSES.inducedMeasure definition missing documentation string\n</code></pre></div>\n<p>and I didn't want to start fixing it because I didn't want it to diverge too much from the mathlib PR, however the mathlib PR seems shorter than the version in FLT so I didn't quite know what to do.</p>",
        "id": 564090109,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765903955
    },
    {
        "content": "<p>Ah, these were linting errors in the mathlib PR as well. I'll copy it over.</p>",
        "id": 564121086,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765914422
    },
    {
        "content": "<p>It's only longer because it has one extra theorem at the end, I think.</p>",
        "id": 564121122,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765914435
    },
    {
        "content": "<p>It should lint now, I think</p>",
        "id": 564121679,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765914649
    },
    {
        "content": "<p>Thanks! It's merged.</p>",
        "id": 564154323,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765931050
    },
    {
        "content": "<p>Just seeing this thread. Long ago, Heather and I constructed the classical fundamental domain for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>L</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo separator=\"true\">,</mo><mi mathvariant=\"double-struck\">Z</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">\\</mi><mi>S</mi><mi>L</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo separator=\"true\">,</mo><mi mathvariant=\"double-struck\">R</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">SL(2,\\Z)\\backslash SL(2,\\R)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbb\">Z</span><span class=\"mclose\">)</span><span class=\"mord\">\\</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mclose\">)</span></span></span></span>, in case that API may be useful here...</p>",
        "id": 564294447,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1765989111
    },
    {
        "content": "<p>That sounds much harder than what I did! It's a nonabelian setting. I was lucky enough to be in a situation where I could write down a set-theoretic fundamental domain so all the measure theory could be avoided.</p>",
        "id": 564330528,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1766000836
    },
    {
        "content": "<p>Won't you eventually need <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mi>L</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo separator=\"true\">,</mo><mi mathvariant=\"double-struck\">Q</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">\\</mi><mi>G</mi><mi>L</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo separator=\"true\">,</mo><mi mathvariant=\"double-struck\">A</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">GL(2,{\\mathbb Q})\\backslash GL(2,{\\mathbb A})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">Q</span></span><span class=\"mclose\">)</span><span class=\"mord\">\\</span><span class=\"mord mathnormal\">G</span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">A</span></span><span class=\"mclose\">)</span></span></span></span>...?</p>",
        "id": 564343389,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1766005942
    },
    {
        "content": "<p>One day I will, but this is certainly not a priority; we've just got compactness of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>D</mi><mo>Ã—</mo></msup><mi mathvariant=\"normal\">\\</mi><mo stretchy=\"false\">(</mo><mi>D</mi><msub><mo>âŠ—</mo><mi>F</mi></msub><msub><mi mathvariant=\"double-struck\">A</mi><mi>F</mi></msub><msup><mo stretchy=\"false\">)</mo><mo>Ã—</mo></msup></mrow><annotation encoding=\"application/x-tex\">D^\\times\\backslash (D\\otimes_F\\mathbb{A}_F)^\\times</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0213em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7713em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">Ã—</span></span></span></span></span></span></span></span><span class=\"mord\">\\</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"><span class=\"mbin\">âŠ—</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">F</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0213em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">F</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7713em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">Ã—</span></span></span></span></span></span></span></span></span></span></span> for a totally definite quaternion algebra over a totally real field (I literally hit merge under an hour ago) and this will do for now; Jacquet--Langlands is going to be assumed...</p>",
        "id": 564348039,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1766007969
    },
    {
        "content": "<p>Sorry to hijack this thread yet further, but: </p>\n<p><span class=\"user-mention\" data-user-id=\"252920\">@Alex Kontorovich</span> : did you ever prove that the fundamental domain is a fundamental domain? </p>\n<p>Despite appearances, this is a genuine question: I'm asking whether it's a theorem that the set <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/NumberTheory/Modular.html#ModularGroup.fd\">ModularGroup.fd</a> satisfies the predicate <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/MeasureTheory/Group/FundamentalDomain.html#MeasureTheory.IsFundamentalDomain\">MeasureTheory.IsFundamentalDomain</a>. I'm hoping to use this to set up a MeasureSpace structure on <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>L</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo separator=\"true\">,</mo><mi mathvariant=\"double-struck\">Z</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">\\</mi><mi mathvariant=\"script\">H</mi></mrow><annotation encoding=\"application/x-tex\">SL(2, \\mathbb{Z}) \\backslash \\mathcal{H}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbb\">Z</span><span class=\"mclose\">)</span><span class=\"mord\">\\</span><span class=\"mord mathcal\" style=\"margin-right:0.00965em;\">H</span></span></span></span>.</p>",
        "id": 565051869,
        "sender_full_name": "David Loeffler",
        "timestamp": 1766427800
    },
    {
        "content": "<p>We proved two theorems:</p>\n<ul>\n<li>1) <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/NumberTheory/Modular.html#ModularGroup.exists_smul_mem_fd\">ModularGroup.exists_smul_mem_fd</a>: any point can be moved into the (closed) domain by an element of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>L</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo separator=\"true\">,</mo><mi mathvariant=\"double-struck\">Z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">SL(2,\\Z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbb\">Z</span><span class=\"mclose\">)</span></span></span></span>, and </li>\n<li>2) <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/NumberTheory/Modular.html#ModularGroup.eq_smul_self_of_mem_fdo_mem_fdo\">ModularGroup.eq_smul_self_of_mem_fdo_mem_fdo</a>: if both <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î³</mi><mo>â‹…</mo><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">\\gamma\\cdot z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">Î³</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span> are in the open domain, then they're equal.<br>\nSo I think the answer to your question is Yes, but maybe not in the form you want for your application?...</li>\n</ul>",
        "id": 565083083,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1766447419
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span> and I also had a bunch of work in progress about fundamental domains, but it never made it to Mathlib, I think?</p>",
        "id": 565083156,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1766447502
    },
    {
        "content": "<p>So I was going to do this for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi><mi mathvariant=\"normal\">\\</mi><msub><mi mathvariant=\"double-struck\">A</mi><mi mathvariant=\"double-struck\">Q</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}\\backslash\\mathbb{A}_{\\mathbb{Q}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0167em;vertical-align:-0.2667em;\"></span><span class=\"mord mathbb\">Q</span><span class=\"mord\">\\</span><span class=\"mord\"><span class=\"mord mathbb\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3322em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbb mtight\">Q</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2667em;\"><span></span></span></span></span></span></span></span></span></span> and then I realised that to actually prove that the thing was a fundamental domain I had to check that all the overlaps/missing pieces had measure zero, and I didn't fancy that, so I changed my fundamental domain to be <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>âˆ</mo><mi>p</mi></msub><msub><mi mathvariant=\"double-struck\">Z</mi><mi>p</mi></msub><mo>Ã—</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\prod_p\\Z_p\\times[0,1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1858em;vertical-align:-0.4358em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0017em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> so that the overlaps/missing pieces were literally empty (this really is a set-theoretic fundamental domain) which was why I could prove that this thing really was an <code>IsFundamentalDomain</code>. I would imagine that basically what is left in the upper half plane case is to show that the closure minus the interior has measure zero but I wouldn't know how to start doing that myself (although I'm sure the experts won't have much trouble).</p>",
        "id": 565086557,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1766451232
    },
    {
        "content": "<p>Of course we could do the same thing, choose boundary representatives. Though we have elliptic fixed points, so there's <em>always</em> a problem there... Maybe we already have that that the measure of finitely (countably) many points of a measure absolutely continuous wrt Lebesgue is zero?...</p>",
        "id": 565098087,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1766464894
    },
    {
        "content": "<blockquote>\n<p>I would imagine that basically what is left in the upper half plane case is to show that the closure minus the interior has measure zero</p>\n</blockquote>\n<p>Indeed! I didn't realize Alex and Heather had proved the uniqueness result for <code>mem_fdo</code>,  and with that in hand, to show that the (closed) fundamental domain <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">D</span></span></span></span> is a fundamental domain in the measure-theoretic sense, it would suffice to show that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">D</mi><mo>âˆ–</mo><msup><mi mathvariant=\"script\">D</mi><mo>âˆ˜</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathcal{D} \\setminus \\mathcal{D}^\\circ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ–</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6741em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">âˆ˜</span></span></span></span></span></span></span></span></span></span></span> has measure zero. I guess it's true more generally that for any open set <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> in the plane, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>X</mi><mo stretchy=\"true\">â€¾</mo></mover><mo>âˆ–</mo><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">\\overline{X} \\setminus X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1333em;vertical-align:-0.25em;\"></span><span class=\"mord overline\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8833em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span><span style=\"top:-3.8033em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"overline-line\" style=\"border-bottom-width:0.04em;\"></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ–</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> has measure zero, but I don't know if this is in mathlib.</p>",
        "id": 565124552,
        "sender_full_name": "David Loeffler",
        "timestamp": 1766482313
    },
    {
        "content": "<p>Isn't this false? Taking the union of balls around the rationals (with radius 1/2^r around the r-th rational) gives a dense open set, so the closure minus itself has infinite measure.</p>",
        "id": 565127392,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1766483703
    },
    {
        "content": "<p>Well, that'll be why it isn't in mathlib then <span aria-label=\"man facepalming\" class=\"emoji emoji-1f926-200d-2642\" role=\"img\" title=\"man facepalming\">:man_facepalming:</span></p>",
        "id": 565128134,
        "sender_full_name": "David Loeffler",
        "timestamp": 1766484018
    },
    {
        "content": "<p>It is true for a convex set, however. Is your fundamental domain convex?</p>",
        "id": 565133599,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1766486361
    },
    {
        "content": "<p>No, at least not with the restriction of the Euclidean metric. (It's convex wrt the intrinsic metric of the upper half-plane, the one for which segments of circles centred on the real line are geodesics â€“ in this metric it's a triangle â€“ but that probably isn't useful here.)</p>",
        "id": 565135037,
        "sender_full_name": "David Loeffler",
        "timestamp": 1766487110
    },
    {
        "content": "<p>(this is the metric defined in <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Complex/UpperHalfPlane/Metric.html#top\">Mathlib.Analysis.Complex.UpperHalfPlane.Metric</a>)</p>",
        "id": 565135163,
        "sender_full_name": "David Loeffler",
        "timestamp": 1766487169
    },
    {
        "content": "<p>In the Euclidean metric it's star-convex for some choices of centre point (but not for all)</p>",
        "id": 565135235,
        "sender_full_name": "David Loeffler",
        "timestamp": 1766487204
    },
    {
        "content": "<p>Star-convex from two base points might already be enough?</p>",
        "id": 565135925,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1766487495
    },
    {
        "content": "<p>Any point that's high up enough on the imaginary axis works as a base point (trying to do a trigonometry exercise in my head I think higher than sqrt(3) is probably enough)</p>",
        "id": 565136305,
        "sender_full_name": "David Loeffler",
        "timestamp": 1766487661
    },
    {
        "content": "<p>Alternatively, can you make it convex by inverting around some circle? Inversion preserves zero measure sets</p>",
        "id": 565136447,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1766487741
    },
    {
        "content": "<p>Not as far as I am aware. Going back to your earlier claim \"star-convex from two base points might already be enough\", can you say more about why you expect that?</p>",
        "id": 565138208,
        "sender_full_name": "David Loeffler",
        "timestamp": 1766488490
    },
    {
        "content": "<p>Star convex from a single base point isn't enough since you could have very thin rays emanating from that single base point. Star convex from two base points however means that you get a whole triangle for every third point in your set (and it's crucial you're in 2D for that to be useful, in 3D you'd instead need three non-collinear base points)</p>",
        "id": 565142959,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1766490691
    },
    {
        "content": "<p>Very interesting, thanks! Can you please point me to the API on \"star convex from two base points\"?</p>",
        "id": 565701772,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1767029021
    },
    {
        "content": "<p>There's none so far. The past few days I've been trying to come up with an (informal) formalisation of my intuition above.</p>",
        "id": 565714234,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1767037277
    },
    {
        "content": "<p>Isnâ€™t this a massive overkill for showing that a half-line and a portion of a circle have measure zero?<br>\nUnless Iâ€™m misunderstanding the current goal</p>",
        "id": 565728297,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1767049235
    },
    {
        "content": "<p>Oh are we talking about (half of) this shape? <a href=\"https://ahilado.wordpress.com/wp-content/uploads/2017/02/modulargroup-fundamentaldomain-01.png\">https://ahilado.wordpress.com/wp-content/uploads/2017/02/modulargroup-fundamentaldomain-01.png</a></p>\n<div class=\"message_inline_image\"><a href=\"https://ahilado.wordpress.com/wp-content/uploads/2017/02/modulargroup-fundamentaldomain-01.png\"><img src=\"https://uploads.zulipusercontent.net/5bd7d1a7417dad8fd2135e7e1e9dd5879fb157b5/68747470733a2f2f6168696c61646f2e776f726470726573732e636f6d2f77702d636f6e74656e742f75706c6f6164732f323031372f30322f6d6f64756c617267726f75702d66756e64616d656e74616c646f6d61696e2d30312e706e67\"></a></div>",
        "id": 565760351,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1767083366
    },
    {
        "content": "<p>Having negligible frontier is preserved under intersection, union, complement, etc... Therefore it should be easy to do what Stepan said if this really is the shape you are interested in</p>",
        "id": 565761166,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1767083980
    },
    {
        "content": "<p>Alternatively, you could use the <a href=\"https://en.wikipedia.org/wiki/Lebesgue%27s_density_theorem\">Lebesgue density theorem</a></p>",
        "id": 565761190,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1767084001
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">YaÃ«l Dillies</span> <a href=\"#narrow/channel/416277-FLT/topic/Fundamental.20domains/near/565760351\">said</a>:</p>\n<blockquote>\n<p>Oh are we talking about (half of) this shape? <a href=\"https://ahilado.wordpress.com/wp-content/uploads/2017/02/modulargroup-fundamentaldomain-01.png\">https://ahilado.wordpress.com/wp-content/uploads/2017/02/modulargroup-fundamentaldomain-01.png</a></p>\n</blockquote>\n<p>Even if you take a congruence subgroup of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>L</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo separator=\"true\">,</mo><mi mathvariant=\"double-struck\">Z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">SL(2, \\mathbb{Z})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbb\">Z</span><span class=\"mclose\">)</span></span></span></span> then its fundamental domain could be taken to be a finite union of translates of this shape, hence its boundary will be a finite union of half-lines and circular segments</p>",
        "id": 565821075,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1767120378
    },
    {
        "content": "<p>I would hope that we don't need anything more general than that for FLT</p>",
        "id": 565821153,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1767120422
    }
]