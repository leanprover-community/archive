[
    {
        "content": "<p>This is not actually a question. I am beginning to learn Lean 4, and I used <a href=\"https://math.stackexchange.com/a/5015161\">this Math Stack Exchange lemma</a> as a test case. I know that my code might appear extremely ill-written to those well-versed in Lean, but still, it felt good to learn the language by actually trying to apply it in a non-trivial case.</p>\n<p>Code on <a href=\"https://tinyurl.com/yp69a5hc\">Lean 4 Web</a></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- # Formalizing https://math.stackexchange.com/a/5015161</span>\n\n<span class=\"c1\">-- # Author: Soham Saha (https://math.stackexchange.com/users/1203597/soham-saha)</span>\n\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">oneIsNItself</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"o\">:</span><span class=\"n\">ℕ</span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"bp\">+</span><span class=\"o\">)(</span><span class=\"n\">k</span><span class=\"o\">:</span><span class=\"n\">ℕ</span><span class=\"bp\">+</span><span class=\"o\">):</span><span class=\"kt\">Prop</span><span class=\"o\">:=(</span><span class=\"n\">k</span><span class=\"bp\">&gt;</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"n\">d</span><span class=\"o\">,</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"bp\">+</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"bp\">=</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"bp\">∣</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"bp\">≠</span><span class=\"n\">k</span><span class=\"o\">)</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">MSEQuestionProof</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"o\">:</span><span class=\"n\">ℕ</span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"bp\">+</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h_1</span><span class=\"o\">:</span><span class=\"bp\">∀</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"n\">n</span><span class=\"bp\">&gt;</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∃</span><span class=\"n\">d1</span><span class=\"w\"> </span><span class=\"n\">d2</span><span class=\"o\">,</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">d1</span><span class=\"bp\">+</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">d2</span><span class=\"bp\">=</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">d1</span><span class=\"bp\">∣</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">d2</span><span class=\"bp\">∣</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">d1</span><span class=\"bp\">≠</span><span class=\"n\">d2</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h_2</span><span class=\"o\">:</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"bp\">=</span><span class=\"mi\">1</span><span class=\"o\">):</span><span class=\"bp\">∀</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"n\">oneIsNItself</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">interim</span><span class=\"o\">:(</span><span class=\"bp\">∀</span><span class=\"n\">m</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"n\">m1</span><span class=\"bp\">&lt;</span><span class=\"n\">m</span><span class=\"o\">,</span><span class=\"n\">oneIsNItself</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">m1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">oneIsNItself</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">):=</span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">m2</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h2</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h3</span>\n<span class=\"w\">    </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h4</span><span class=\"o\">:</span><span class=\"n\">PNat</span><span class=\"bp\">.</span><span class=\"n\">Prime</span><span class=\"w\"> </span><span class=\"n\">m2</span>\n<span class=\"w\">    </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h_1</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h3</span>\n<span class=\"w\">      </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h3</span>\n<span class=\"w\">      </span><span class=\"n\">rename_i</span><span class=\"w\"> </span><span class=\"n\">d1</span><span class=\"w\"> </span><span class=\"n\">h5</span>\n<span class=\"w\">      </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h5</span>\n<span class=\"w\">      </span><span class=\"n\">rename_i</span><span class=\"w\"> </span><span class=\"n\">d2</span><span class=\"w\"> </span><span class=\"n\">h6</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h7</span><span class=\"o\">:=</span><span class=\"n\">h6</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"bp\">.</span><span class=\"n\">right</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h8</span><span class=\"o\">:</span><span class=\"n\">d1</span><span class=\"bp\">=</span><span class=\"mi\">1</span><span class=\"bp\">∨</span><span class=\"n\">d1</span><span class=\"bp\">=</span><span class=\"n\">m2</span><span class=\"o\">:=</span><span class=\"k\">by</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"n\">PNat</span><span class=\"bp\">.</span><span class=\"n\">dvd_prime</span><span class=\"w\"> </span><span class=\"n\">h4</span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h6</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"bp\">.</span><span class=\"n\">left</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h9</span><span class=\"o\">:</span><span class=\"n\">d2</span><span class=\"bp\">=</span><span class=\"mi\">1</span><span class=\"bp\">∨</span><span class=\"n\">d2</span><span class=\"bp\">=</span><span class=\"n\">m2</span><span class=\"o\">:=</span><span class=\"k\">by</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"n\">PNat</span><span class=\"bp\">.</span><span class=\"n\">dvd_prime</span><span class=\"w\"> </span><span class=\"n\">h4</span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h6</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"bp\">.</span><span class=\"n\">left</span>\n<span class=\"w\">      </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h8</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rename_i</span><span class=\"w\"> </span><span class=\"n\">h10</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h10</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">        </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">eq_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h11</span><span class=\"o\">:=</span><span class=\"n\">Or</span><span class=\"bp\">.</span><span class=\"n\">resolve_left</span><span class=\"w\"> </span><span class=\"n\">h9</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h12</span><span class=\"o\">:=</span><span class=\"n\">h6</span><span class=\"bp\">.</span><span class=\"n\">left</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h10</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h11</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">add_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h12</span>\n<span class=\"w\">        </span><span class=\"n\">exists</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">        </span><span class=\"n\">simp</span>\n<span class=\"w\">        </span><span class=\"n\">nth_rw</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">eq_comm</span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">And</span><span class=\"bp\">.</span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h12</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PNat</span><span class=\"bp\">.</span><span class=\"n\">Prime</span><span class=\"bp\">.</span><span class=\"n\">ne_one</span><span class=\"w\"> </span><span class=\"n\">h4</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rename_i</span><span class=\"w\"> </span><span class=\"n\">h10</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h10</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">        </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">eq_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h11</span><span class=\"o\">:=</span><span class=\"n\">Or</span><span class=\"bp\">.</span><span class=\"n\">resolve_right</span><span class=\"w\"> </span><span class=\"n\">h9</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h12</span><span class=\"o\">:=</span><span class=\"n\">h6</span><span class=\"bp\">.</span><span class=\"n\">left</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h10</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h11</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h12</span>\n<span class=\"w\">        </span><span class=\"n\">exists</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">        </span><span class=\"n\">simp</span>\n<span class=\"w\">        </span><span class=\"n\">nth_rw</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">eq_comm</span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">And</span><span class=\"bp\">.</span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h12</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PNat</span><span class=\"bp\">.</span><span class=\"n\">Prime</span><span class=\"bp\">.</span><span class=\"n\">ne_one</span><span class=\"w\"> </span><span class=\"n\">h4</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h5</span><span class=\"o\">:=</span><span class=\"n\">h3</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h_1</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h5</span>\n<span class=\"w\">      </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h5</span>\n<span class=\"w\">      </span><span class=\"n\">rename_i</span><span class=\"w\"> </span><span class=\"n\">d1</span><span class=\"w\"> </span><span class=\"n\">h6</span>\n<span class=\"w\">      </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h6</span>\n<span class=\"w\">      </span><span class=\"n\">rename_i</span><span class=\"w\"> </span><span class=\"n\">d2</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">      </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h8</span><span class=\"o\">:(</span><span class=\"n\">d1</span><span class=\"bp\">=</span><span class=\"n\">m2</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">d2</span><span class=\"bp\">=</span><span class=\"n\">m2</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h8</span>\n<span class=\"w\">        </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rename_i</span><span class=\"w\"> </span><span class=\"n\">H</span>\n<span class=\"w\">          </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">H</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">          </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">          </span><span class=\"n\">nth_rw</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">eq_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">          </span><span class=\"n\">exists</span><span class=\"w\"> </span><span class=\"n\">d2</span>\n<span class=\"w\">        </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rename_i</span><span class=\"w\"> </span><span class=\"n\">H</span>\n<span class=\"w\">          </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">H</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">          </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">          </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">add_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">          </span><span class=\"n\">exists</span><span class=\"w\"> </span><span class=\"n\">d1</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">not_or</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h8</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h9</span><span class=\"o\">:=</span><span class=\"n\">lt_of_le_of_ne</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PNat</span><span class=\"bp\">.</span><span class=\"n\">le_of_dvd</span><span class=\"w\">  </span><span class=\"n\">h7</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">h8</span><span class=\"bp\">.</span><span class=\"n\">right</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h10</span><span class=\"o\">:=</span><span class=\"n\">lt_of_le_of_ne</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PNat</span><span class=\"bp\">.</span><span class=\"n\">le_of_dvd</span><span class=\"w\">  </span><span class=\"n\">h7</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">h8</span><span class=\"bp\">.</span><span class=\"n\">left</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h11</span><span class=\"o\">:=</span><span class=\"n\">h9</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h12</span><span class=\"o\">:=</span><span class=\"n\">h10</span>\n<span class=\"w\">        </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h11</span>\n<span class=\"w\">        </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h12</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h13</span><span class=\"o\">:</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">d1</span><span class=\"bp\">≤</span><span class=\"n\">d1</span><span class=\"o\">:=</span><span class=\"k\">by</span>\n<span class=\"w\">          </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h14</span><span class=\"o\">:</span><span class=\"n\">d1</span><span class=\"bp\">=</span><span class=\"mi\">1</span>\n<span class=\"w\">          </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"n\">h14</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_2</span>\n<span class=\"w\">            </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">le_of_eq</span><span class=\"w\"> </span><span class=\"n\">h_2</span>\n<span class=\"w\">          </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">eq_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h14</span>\n<span class=\"w\">            </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h15</span><span class=\"o\">:=</span><span class=\"n\">h12</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">lt_of_le_of_ne</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PNat</span><span class=\"bp\">.</span><span class=\"n\">one_le</span><span class=\"w\"> </span><span class=\"n\">d1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">h14</span><span class=\"o\">)</span>\n<span class=\"w\">            </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h15</span>\n<span class=\"w\">            </span><span class=\"n\">rename_i</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">h16</span>\n<span class=\"w\">            </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h17</span><span class=\"o\">:=</span><span class=\"n\">h16</span><span class=\"bp\">.</span><span class=\"n\">left</span>\n<span class=\"w\">            </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h18</span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">add_le_add_right</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PNat</span><span class=\"bp\">.</span><span class=\"n\">one_le</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">d1</span><span class=\"o\">)</span>\n<span class=\"w\">            </span><span class=\"n\">nth_rw</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">add_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h18</span>\n<span class=\"w\">            </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h17</span><span class=\"o\">,</span><span class=\"n\">add_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h18</span>\n<span class=\"w\">            </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">le_of_lt</span><span class=\"w\"> </span><span class=\"n\">h18</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h14</span><span class=\"o\">:</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">d2</span><span class=\"bp\">≤</span><span class=\"n\">d2</span><span class=\"o\">:=</span><span class=\"k\">by</span>\n<span class=\"w\">          </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h14</span><span class=\"o\">:</span><span class=\"n\">d2</span><span class=\"bp\">=</span><span class=\"mi\">1</span>\n<span class=\"w\">          </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"n\">h14</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_2</span>\n<span class=\"w\">            </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">le_of_eq</span><span class=\"w\"> </span><span class=\"n\">h_2</span>\n<span class=\"w\">          </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">eq_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h14</span>\n<span class=\"w\">            </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h15</span><span class=\"o\">:=</span><span class=\"n\">h11</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">lt_of_le_of_ne</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PNat</span><span class=\"bp\">.</span><span class=\"n\">one_le</span><span class=\"w\"> </span><span class=\"n\">d2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">h14</span><span class=\"o\">)</span>\n<span class=\"w\">            </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h15</span>\n<span class=\"w\">            </span><span class=\"n\">rename_i</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">h16</span>\n<span class=\"w\">            </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h17</span><span class=\"o\">:=</span><span class=\"n\">h16</span><span class=\"bp\">.</span><span class=\"n\">left</span>\n<span class=\"w\">            </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h18</span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">add_le_add_right</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PNat</span><span class=\"bp\">.</span><span class=\"n\">one_le</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">d2</span><span class=\"o\">)</span>\n<span class=\"w\">            </span><span class=\"n\">nth_rw</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">add_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h18</span>\n<span class=\"w\">            </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h17</span><span class=\"o\">,</span><span class=\"n\">add_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h18</span>\n<span class=\"w\">            </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">le_of_lt</span><span class=\"w\"> </span><span class=\"n\">h18</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h15</span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">add_le_add</span><span class=\"w\"> </span><span class=\"n\">h13</span><span class=\"w\"> </span><span class=\"n\">h14</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h7</span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h15</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h16</span><span class=\"o\">:=</span><span class=\"n\">exists_eq_mul_left_of_dvd</span><span class=\"w\"> </span><span class=\"n\">h7</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"bp\">.</span><span class=\"n\">left</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h17</span><span class=\"o\">:=</span><span class=\"n\">exists_eq_mul_left_of_dvd</span><span class=\"w\"> </span><span class=\"n\">h7</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"bp\">.</span><span class=\"n\">left</span>\n<span class=\"w\">        </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h16</span>\n<span class=\"w\">        </span><span class=\"n\">rename_i</span><span class=\"w\"> </span><span class=\"n\">c1</span><span class=\"w\"> </span><span class=\"n\">h18</span>\n<span class=\"w\">        </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h17</span>\n<span class=\"w\">        </span><span class=\"n\">rename_i</span><span class=\"w\"> </span><span class=\"n\">c2</span><span class=\"w\"> </span><span class=\"n\">h19</span>\n<span class=\"w\">        </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h20</span><span class=\"o\">:</span><span class=\"n\">c1</span><span class=\"bp\">≤</span><span class=\"mi\">1</span>\n<span class=\"w\">        </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">PNat</span><span class=\"bp\">.</span><span class=\"n\">le_one_iff</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h20</span>\n<span class=\"w\">          </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h20</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h18</span>\n<span class=\"w\">          </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h18</span>\n<span class=\"w\">          </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h21</span><span class=\"o\">:=</span><span class=\"n\">h8</span><span class=\"bp\">.</span><span class=\"n\">left</span>\n<span class=\"w\">          </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">eq_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h18</span>\n<span class=\"w\">          </span><span class=\"n\">contradiction</span>\n<span class=\"w\">        </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h21</span><span class=\"o\">:</span><span class=\"n\">c2</span><span class=\"bp\">≤</span><span class=\"mi\">1</span>\n<span class=\"w\">          </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">PNat</span><span class=\"bp\">.</span><span class=\"n\">le_one_iff</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h21</span>\n<span class=\"w\">            </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h21</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h19</span>\n<span class=\"w\">            </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h19</span>\n<span class=\"w\">            </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h22</span><span class=\"o\">:=</span><span class=\"n\">h8</span><span class=\"bp\">.</span><span class=\"n\">right</span>\n<span class=\"w\">            </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">eq_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h19</span>\n<span class=\"w\">            </span><span class=\"n\">contradiction</span>\n<span class=\"w\">          </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">lt_of_not_ge</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h20</span>\n<span class=\"w\">            </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">lt_of_not_ge</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h21</span>\n<span class=\"w\">            </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h22</span><span class=\"o\">:</span><span class=\"n\">c1</span><span class=\"bp\">≤</span><span class=\"mi\">2</span>\n<span class=\"w\">            </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h23</span><span class=\"o\">:=</span><span class=\"n\">le_antisymm</span><span class=\"w\"> </span><span class=\"n\">h22</span><span class=\"w\"> </span><span class=\"n\">h20</span>\n<span class=\"w\">              </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h24</span><span class=\"o\">:</span><span class=\"n\">c2</span><span class=\"bp\">≤</span><span class=\"mi\">2</span>\n<span class=\"w\">              </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h25</span><span class=\"o\">:=</span><span class=\"n\">le_antisymm</span><span class=\"w\"> </span><span class=\"n\">h24</span><span class=\"w\"> </span><span class=\"n\">h21</span>\n<span class=\"w\">                </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h23</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h18</span>\n<span class=\"w\">                </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h25</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h19</span>\n<span class=\"w\">                </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h18</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h19</span>\n<span class=\"w\">                </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mul_left_cancel_iff</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h19</span>\n<span class=\"w\">                </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h26</span><span class=\"o\">:=</span><span class=\"n\">h7</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"bp\">.</span><span class=\"n\">right</span>\n<span class=\"w\">                </span><span class=\"n\">contradiction</span>\n<span class=\"w\">              </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"n\">mul_le_mul_iff_right</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h15</span>\n<span class=\"w\">                </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h25</span><span class=\"o\">:</span><span class=\"n\">m2</span><span class=\"bp\">*</span><span class=\"mi\">2</span><span class=\"bp\">=</span><span class=\"n\">m2</span><span class=\"bp\">+</span><span class=\"n\">m2</span><span class=\"o\">:=</span><span class=\"k\">by</span>\n<span class=\"w\">                  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">:</span><span class=\"n\">m2</span><span class=\"bp\">*</span><span class=\"mi\">2</span><span class=\"bp\">=</span><span class=\"n\">m2</span><span class=\"bp\">*</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">):=</span><span class=\"n\">rfl</span>\n<span class=\"w\">                  </span><span class=\"n\">rw</span><span class=\"o\">[</span><span class=\"n\">H</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_add</span><span class=\"o\">]</span>\n<span class=\"w\">                  </span><span class=\"n\">simp</span>\n<span class=\"w\">                </span><span class=\"n\">nth_rw</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h25</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h18</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h19</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h23</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_comm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">add_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">add_le_add_iff_left</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_comm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_le_mul_iff_left</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h15</span>\n<span class=\"w\">                </span><span class=\"n\">contradiction</span>\n<span class=\"w\">            </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"n\">mul_le_mul_iff_left</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"n\">mul_add</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h15</span>\n<span class=\"w\">              </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h23</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">≤</span><span class=\"n\">c1</span><span class=\"o\">:=</span><span class=\"n\">lt_of_not_ge</span><span class=\"w\"> </span><span class=\"n\">h22</span>\n<span class=\"w\">              </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mul_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h18</span>\n<span class=\"w\">              </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"n\">mul_le_mul_iff_left</span><span class=\"w\"> </span><span class=\"n\">d1</span><span class=\"o\">,</span><span class=\"n\">mul_comm</span><span class=\"o\">,</span><span class=\"bp\">←</span><span class=\"n\">add_le_add_iff_right</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">3</span><span class=\"bp\">*</span><span class=\"n\">d2</span><span class=\"o\">),</span><span class=\"bp\">←</span><span class=\"n\">h18</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h23</span>\n<span class=\"w\">              </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Preorder</span><span class=\"bp\">.</span><span class=\"n\">le_trans</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">3</span><span class=\"bp\">*</span><span class=\"n\">m2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">3</span><span class=\"bp\">*</span><span class=\"n\">d1</span><span class=\"bp\">+</span><span class=\"mi\">3</span><span class=\"bp\">*</span><span class=\"n\">d2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m2</span><span class=\"bp\">+</span><span class=\"mi\">3</span><span class=\"bp\">*</span><span class=\"n\">d2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">h15</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h23</span>\n<span class=\"w\">              </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h24</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">*</span><span class=\"n\">m2</span><span class=\"bp\">=</span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">*</span><span class=\"n\">m2</span><span class=\"o\">:=</span><span class=\"n\">rfl</span>\n<span class=\"w\">              </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h25</span><span class=\"o\">:</span><span class=\"mi\">2</span><span class=\"bp\">≤</span><span class=\"n\">c2</span><span class=\"o\">:=</span><span class=\"n\">h21</span>\n<span class=\"w\">              </span><span class=\"n\">rw</span><span class=\"o\">[</span><span class=\"n\">h24</span><span class=\"o\">,</span><span class=\"n\">add_mul</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h23</span>\n<span class=\"w\">              </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h23</span>\n<span class=\"w\">              </span><span class=\"n\">nth_rewrite</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">add_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h23</span>\n<span class=\"w\">              </span><span class=\"n\">rw</span><span class=\"o\">[</span><span class=\"n\">add_le_add_iff_left</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"o\">,</span><span class=\"n\">h19</span><span class=\"o\">,</span><span class=\"bp\">←</span><span class=\"n\">mul_assoc</span><span class=\"o\">,</span><span class=\"n\">mul_le_mul_iff_right</span><span class=\"w\"> </span><span class=\"n\">d2</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h23</span>\n<span class=\"w\">              </span><span class=\"n\">rw</span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"n\">mul_le_mul_iff_right</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h25</span>\n<span class=\"w\">              </span><span class=\"n\">rw</span><span class=\"o\">[</span><span class=\"n\">mul_comm</span><span class=\"w\"> </span><span class=\"n\">c2</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h25</span>\n<span class=\"w\">              </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Preorder</span><span class=\"bp\">.</span><span class=\"n\">le_trans</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"bp\">*</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"bp\">*</span><span class=\"n\">c2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"n\">h25</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h23</span>\n<span class=\"w\">              </span><span class=\"n\">contradiction</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">n2</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">PNat</span><span class=\"bp\">.</span><span class=\"n\">strongInductionOn</span><span class=\"w\"> </span><span class=\"n\">n2</span><span class=\"w\"> </span><span class=\"n\">interim</span>\n\n<span class=\"c\">/-</span>\n<span class=\"cm\">Note to future-self:</span>\n\n<span class=\"cm\">  First think the most basic thing you need at the next step. Then think which basic hypotheses (that you have now) are needed to prove it.</span>\n<span class=\"cm\">  Then set up:</span>\n<span class=\"cm\">    have H:&lt;what I need&gt;:=by</span>\n<span class=\"cm\">      apply? using &lt;what things I think are basic and enough to get what I need, seperated by comma&gt;</span>\n\n<span class=\"cm\">  Also rw? can be used. See https://leanprover.zulipchat.com/#narrow/channel/113489-new-members/topic/Proving.20a*b.3Dc*b.20.3D.3E.20a.3Dc.20for.20a.2Cb.2Cc.20in.20PNat.3F$0</span>\n<span class=\"cm\">-/</span>\n</code></pre></div>",
        "id": 494655601,
        "sender_full_name": "Soham Saha",
        "timestamp": 1737303932
    },
    {
        "content": "<p>Nice! I'm far from an expert, but I've learned a lot golfing my proofs my down so some small comments along those lines:</p>\n<ul>\n<li>You can do multiple intros on one line, e.g. <code>intro m2 h2 h3</code> at the beginning</li>\n<li><code>obtain ⟨d1, h5⟩ := h3</code> instead of  <code>cases h3; rename_i d1 h5</code></li>\n<li>It's a lot more readable when your eyes are just scanning the proof if you add some more spaces , e.g. <code>have h8 : d1=1 ∨ d1=m2 := by</code> instead of <code>have h8:d1=1∨d1=m2:=by</code></li>\n<li><code>rcases h8 with H | H</code> instead of <code>cases h8</code> and then <code>rename_i H</code> inside of the individual focusing dots</li>\n<li>It's a matter of taste, but you have lots of small statements, and it may be easier to combine some for brevity, e.g. <code>rw [PNat.le_one_iff.mp h20] at h18</code> instead of <code>apply PNat.le_one_iff.mp at h20; rw [h20] at h18</code> or combining multiple <code>rw</code>s  onto one line. I generally also write them individually while writing though, makes it easier to debug.</li>\n</ul>\n<p>I haven't looked at the logic of the proof at all so no comments there.</p>",
        "id": 494656987,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1737304982
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"761203\">@Vlad Tsyrklevich</span> Thanks for the suggestions! I will edit my code according to them. :)</p>",
        "id": 494657890,
        "sender_full_name": "Soham Saha",
        "timestamp": 1737305683
    },
    {
        "content": "<p>Two comments from me about shortening your code:</p>\n<ul>\n<li>you can \"inline\" short <code>have</code>s: this makes your code shorter any in my opinion easier to read. For example, remove <code>have h25:=le_antisymm h24 h21</code> and replace <code>h25</code> by its definition (this is fine as you only rewrite by h25). This occurs several times.</li>\n<li><code>apply foo.mp</code> should be the same as <code>rw [foo]</code> (or perhaps backwards; I didn't check). Sometimes, that means you can shorten your code even more.</li>\n</ul>",
        "id": 494669136,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1737314151
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"634338\">@Michael Rothgang</span> Thanks for the suggestions. :)</p>",
        "id": 494709790,
        "sender_full_name": "Soham Saha",
        "timestamp": 1737343048
    }
]