[
    {
        "content": "<ol>\n<li>I'm running into type issues with inductively defined types that Lean already has defined. For example, when I try running the code from the book below, I get an error in add_zero that n is of type N but type nat is expected. </li>\n</ol>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">inductive</span> <span class=\"n\">nat</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span>\n<span class=\"bp\">|</span> <span class=\"n\">zero</span> <span class=\"o\">:</span> <span class=\"n\">nat</span>\n<span class=\"bp\">|</span> <span class=\"n\">succ</span> <span class=\"o\">:</span> <span class=\"n\">nat</span> <span class=\"bp\">→</span> <span class=\"n\">nat</span>\n\n<span class=\"kn\">namespace</span> <span class=\"n\">nat</span>\n<span class=\"n\">def</span> <span class=\"n\">add</span> <span class=\"o\">(</span><span class=\"n\">m</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">nat</span> <span class=\"o\">:=</span>\n<span class=\"n\">nat</span><span class=\"bp\">.</span><span class=\"n\">rec_on</span> <span class=\"n\">n</span> <span class=\"n\">m</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">n</span> <span class=\"n\">add_m_n</span><span class=\"o\">,</span> <span class=\"n\">succ</span> <span class=\"n\">add_m_n</span><span class=\"o\">)</span>\n\n<span class=\"bp\">#</span><span class=\"n\">reduce</span> <span class=\"n\">add</span> <span class=\"o\">(</span><span class=\"n\">succ</span> <span class=\"n\">zero</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">succ</span> <span class=\"o\">(</span><span class=\"n\">succ</span> <span class=\"n\">zero</span><span class=\"o\">))</span>\n\n\n<span class=\"kn\">instance</span> <span class=\"o\">:</span> <span class=\"n\">has_zero</span> <span class=\"n\">nat</span> <span class=\"o\">:=</span> <span class=\"n\">has_zero</span><span class=\"bp\">.</span><span class=\"n\">mk</span> <span class=\"n\">zero</span> <span class=\"c1\">--instance is explained in ch 10</span>\n<span class=\"kn\">instance</span> <span class=\"o\">:</span> <span class=\"n\">has_add</span> <span class=\"n\">nat</span> <span class=\"o\">:=</span> <span class=\"n\">has_add</span><span class=\"bp\">.</span><span class=\"n\">mk</span> <span class=\"n\">add</span>\n\n<span class=\"kn\">theorem</span> <span class=\"n\">add_zero</span> <span class=\"o\">(</span><span class=\"n\">m</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">m</span> <span class=\"bp\">+</span> <span class=\"mi\">0</span> <span class=\"bp\">=</span> <span class=\"n\">m</span> <span class=\"o\">:=</span> <span class=\"n\">rfl</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">add_succ</span> <span class=\"o\">(</span><span class=\"n\">m</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">m</span> <span class=\"bp\">+</span> <span class=\"n\">succ</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">succ</span> <span class=\"o\">(</span><span class=\"n\">m</span> <span class=\"bp\">+</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">rfl</span> <span class=\"c1\">--this is how we defined addition</span>\n\n\n<span class=\"kn\">theorem</span> <span class=\"n\">zero_add</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"mi\">0</span> <span class=\"bp\">+</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">n</span> <span class=\"o\">:=</span>\n<span class=\"n\">nat</span><span class=\"bp\">.</span><span class=\"n\">rec_on</span> <span class=\"n\">n</span>\n  <span class=\"o\">(</span><span class=\"k\">show</span> <span class=\"mi\">0</span> <span class=\"bp\">+</span> <span class=\"mi\">0</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"k\">from</span> <span class=\"n\">rfl</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"k\">assume</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n    <span class=\"k\">assume</span> <span class=\"n\">ih</span> <span class=\"o\">:</span> <span class=\"mi\">0</span> <span class=\"bp\">+</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n    <span class=\"k\">show</span> <span class=\"mi\">0</span> <span class=\"bp\">+</span> <span class=\"n\">succ</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">succ</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"k\">from</span>\n      <span class=\"k\">calc</span>\n        <span class=\"mi\">0</span> <span class=\"bp\">+</span> <span class=\"n\">succ</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">succ</span> <span class=\"o\">(</span><span class=\"mi\">0</span> <span class=\"bp\">+</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">rfl</span>\n          <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"n\">succ</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"n\">ih</span><span class=\"o\">)</span>\n\n\n<span class=\"kn\">end</span> <span class=\"n\">nat</span>\n</pre></div>\n\n\n<p>Similarly, when I define <code>bool</code>I get the same error when I do <code>bool.cases_on</code></p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">inductive</span> <span class=\"n\">empty</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span>\n<span class=\"kn\">inductive</span> <span class=\"n\">unit</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span>\n<span class=\"bp\">|</span> <span class=\"n\">star</span> <span class=\"o\">:</span> <span class=\"n\">unit</span>\n<span class=\"kn\">inductive</span> <span class=\"n\">bool</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span>\n<span class=\"bp\">|</span> <span class=\"n\">ff</span> <span class=\"o\">:</span> <span class=\"n\">bool</span>\n<span class=\"bp\">|</span> <span class=\"n\">tt</span> <span class=\"o\">:</span> <span class=\"n\">bool</span>\n\n<span class=\"c1\">--EXERCISE: Define band bor bnot on this new bool type</span>\n\n<span class=\"n\">def</span> <span class=\"n\">band</span> <span class=\"o\">(</span><span class=\"n\">b1</span> <span class=\"n\">b2</span> <span class=\"o\">:</span> <span class=\"n\">hidden</span><span class=\"bp\">.</span><span class=\"n\">bool</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">hidden</span><span class=\"bp\">.</span><span class=\"n\">bool</span> <span class=\"o\">:=</span>\n<span class=\"n\">bool</span><span class=\"bp\">.</span><span class=\"n\">cases_on</span> <span class=\"n\">b1</span> <span class=\"n\">ff</span> <span class=\"n\">b2</span>\n\n<span class=\"n\">def</span> <span class=\"n\">bor</span> <span class=\"o\">(</span><span class=\"n\">b1</span> <span class=\"n\">b2</span> <span class=\"o\">:</span> <span class=\"n\">bool</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">bool</span> <span class=\"o\">:=</span>\n<span class=\"n\">bool</span><span class=\"bp\">.</span><span class=\"n\">cases_on</span> <span class=\"n\">b1</span> <span class=\"n\">b2</span> <span class=\"n\">tt</span>\n\n<span class=\"n\">def</span> <span class=\"n\">bnot</span> <span class=\"o\">(</span><span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"n\">bool</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">bool</span> <span class=\"o\">:=</span>\n<span class=\"n\">bool</span><span class=\"bp\">.</span><span class=\"n\">cases_on</span> <span class=\"n\">b</span> <span class=\"n\">tt</span> <span class=\"n\">ff</span>\n</pre></div>\n\n\n<p>The same issue comes up when I do <code>sum</code> and <code>prod</code> from the book. I've been copying over the text from the book, and have imported <code>data.nat.basic</code> and <code>tactic</code></p>",
        "id": 190544119,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584127201
    },
    {
        "content": "<p>Try adding <code>namespace mydefs</code> before your code and <code>end mydefs</code> after your code. That should help Lean disambiguate the names.</p>",
        "id": 190544304,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1584127294
    },
    {
        "content": "<p>Choosing different names is also a very efficient way to disambiguate.</p>",
        "id": 190544418,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1584127334
    },
    {
        "content": "<p>Note that in <code>zero_add</code>, <code>ℕ</code> is notation for the built-in <code>nat</code> (<code>_root_.nat</code>), so it fails.</p>",
        "id": 190544936,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1584127654
    },
    {
        "content": "<p>Not sure why the <code>show</code> fails, but this works:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">theorem</span> <span class=\"n\">zero_add</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"mi\">0</span> <span class=\"bp\">+</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">n</span> <span class=\"o\">:=</span>\n<span class=\"n\">nat</span><span class=\"bp\">.</span><span class=\"n\">rec_on</span> <span class=\"n\">n</span>\n  <span class=\"o\">(</span><span class=\"n\">rfl</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"k\">assume</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n    <span class=\"k\">assume</span> <span class=\"n\">ih</span> <span class=\"o\">:</span> <span class=\"mi\">0</span> <span class=\"bp\">+</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n    <span class=\"k\">show</span> <span class=\"mi\">0</span> <span class=\"bp\">+</span> <span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span> <span class=\"bp\">=</span> <span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"o\">,</span> <span class=\"k\">from</span>\n      <span class=\"k\">calc</span>\n        <span class=\"mi\">0</span> <span class=\"bp\">+</span> <span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"mi\">0</span> <span class=\"bp\">+</span> <span class=\"n\">n</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">succ</span> <span class=\"o\">:</span> <span class=\"n\">rfl</span>\n          <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"n\">ih</span><span class=\"o\">)</span>\n</pre></div>",
        "id": 190545113,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1584127745
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"123965\">Bryan Gin-ge Chen</span> <a href=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/190544936\" title=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/190544936\">said</a>:</p>\n<blockquote>\n<p>Note that in <code>zero_add</code>, <code>ℕ</code> is notation for the built-in <code>nat</code> (<code>_root_.nat</code>), so it fails.</p>\n</blockquote>\n<p>Interesting, yeah I'm also getting that it fails when I use show but not when I just use <code>(rfl)</code> like you are.</p>",
        "id": 190545956,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584128199
    },
    {
        "content": "<p>I'm also getting an error on the <code>#check</code> term at the end when I try to do </p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">inductive</span> <span class=\"n\">list</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span>\n<span class=\"bp\">|</span> <span class=\"n\">nil</span> <span class=\"o\">{}</span> <span class=\"o\">:</span> <span class=\"n\">list</span>\n<span class=\"bp\">|</span> <span class=\"n\">cons</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">list</span> <span class=\"bp\">→</span> <span class=\"n\">list</span>\n\n<span class=\"kn\">namespace</span> <span class=\"n\">list</span>\n<span class=\"kn\">variable</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"o\">}</span>\n<span class=\"kn\">notation</span> <span class=\"n\">h</span> <span class=\"bp\">::</span> <span class=\"n\">t</span>  <span class=\"o\">:=</span> <span class=\"n\">cons</span> <span class=\"n\">h</span> <span class=\"n\">t</span>\n<span class=\"n\">def</span> <span class=\"n\">append</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"n\">α</span> <span class=\"o\">:=</span>\n<span class=\"n\">list</span><span class=\"bp\">.</span><span class=\"n\">rec</span> <span class=\"n\">t</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">x</span> <span class=\"n\">l</span> <span class=\"n\">u</span><span class=\"o\">,</span> <span class=\"n\">x</span><span class=\"bp\">::</span><span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"n\">s</span>\n<span class=\"kn\">notation</span> <span class=\"n\">s</span> <span class=\"bp\">++</span> <span class=\"n\">t</span> <span class=\"o\">:=</span> <span class=\"n\">append</span> <span class=\"n\">s</span> <span class=\"n\">t</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">nil_append</span> <span class=\"o\">(</span><span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">nil</span> <span class=\"bp\">++</span> <span class=\"n\">t</span> <span class=\"bp\">=</span> <span class=\"n\">t</span> <span class=\"o\">:=</span> <span class=\"n\">rfl</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">cons_append</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">x</span><span class=\"bp\">::</span><span class=\"n\">s</span> <span class=\"bp\">++</span> <span class=\"n\">t</span> <span class=\"bp\">=</span> <span class=\"n\">x</span><span class=\"bp\">::</span><span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"bp\">++</span> <span class=\"n\">t</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">rfl</span>\n<span class=\"kn\">notation</span> <span class=\"err\">&#39;</span><span class=\"o\">[</span><span class=\"err\">&#39;</span> <span class=\"n\">l</span><span class=\"o\">:(</span><span class=\"n\">foldr</span> <span class=\"err\">&#39;</span><span class=\"o\">,</span><span class=\"err\">&#39;</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"n\">t</span><span class=\"o\">,</span> <span class=\"n\">cons</span> <span class=\"n\">h</span> <span class=\"n\">t</span><span class=\"o\">)</span> <span class=\"n\">nil</span><span class=\"o\">)</span> <span class=\"err\">&#39;</span><span class=\"o\">]</span><span class=\"err\">&#39;</span> <span class=\"o\">:=</span> <span class=\"n\">l</span>\n\n<span class=\"bp\">#</span><span class=\"kn\">check</span> <span class=\"o\">([</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"bp\">ℕ</span><span class=\"o\">)</span>\n\n<span class=\"c1\">--EDIT: It only happens when I open a new section like this</span>\n<span class=\"kn\">section</span>\n    <span class=\"kn\">open</span> <span class=\"n\">nat</span>\n    <span class=\"bp\">#</span><span class=\"kn\">check</span> <span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"mi\">4</span><span class=\"o\">,</span><span class=\"mi\">5</span><span class=\"o\">]</span>\n    <span class=\"bp\">#</span><span class=\"kn\">check</span> <span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"bp\">ℤ</span>\n<span class=\"kn\">end</span>\n</pre></div>",
        "id": 190546755,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584128670
    },
    {
        "content": "<p>I'm very confused by the exercises suggested at the end of section 7.2. They read</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">As</span> <span class=\"n\">exercises</span><span class=\"o\">,</span> <span class=\"n\">we</span> <span class=\"n\">encourage</span> <span class=\"n\">you</span> <span class=\"n\">to</span> <span class=\"n\">develop</span> <span class=\"n\">a</span> <span class=\"n\">notion</span> <span class=\"n\">of</span> <span class=\"n\">composition</span> <span class=\"n\">for</span> <span class=\"n\">partial</span> <span class=\"n\">functions</span> <span class=\"k\">from</span> <span class=\"n\">α</span> <span class=\"n\">to</span> <span class=\"n\">β</span> <span class=\"n\">and</span> <span class=\"n\">β</span> <span class=\"n\">to</span> <span class=\"n\">γ</span><span class=\"o\">,</span> <span class=\"n\">and</span> <span class=\"k\">show</span> <span class=\"n\">that</span> <span class=\"n\">it</span> <span class=\"n\">behaves</span> <span class=\"n\">as</span> <span class=\"n\">expected</span><span class=\"bp\">.</span> <span class=\"n\">We</span> <span class=\"n\">also</span> <span class=\"n\">encourage</span> <span class=\"n\">you</span> <span class=\"n\">to</span> <span class=\"k\">show</span> <span class=\"n\">that</span> <span class=\"n\">bool</span> <span class=\"n\">and</span> <span class=\"n\">nat</span> <span class=\"n\">are</span> <span class=\"n\">inhabited</span><span class=\"o\">,</span> <span class=\"n\">that</span> <span class=\"n\">the</span> <span class=\"n\">product</span> <span class=\"n\">of</span> <span class=\"n\">two</span> <span class=\"n\">inhabited</span> <span class=\"n\">types</span> <span class=\"n\">is</span> <span class=\"n\">inhabited</span><span class=\"o\">,</span> <span class=\"n\">and</span> <span class=\"n\">that</span> <span class=\"n\">the</span> <span class=\"n\">type</span> <span class=\"n\">of</span> <span class=\"n\">functions</span> <span class=\"n\">to</span> <span class=\"n\">an</span> <span class=\"n\">inhabited</span> <span class=\"n\">type</span> <span class=\"n\">is</span> <span class=\"n\">inhabited</span><span class=\"bp\">.</span>\n\n<span class=\"kn\">inductive</span> <span class=\"n\">option</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span>\n<span class=\"bp\">|</span> <span class=\"n\">none</span> <span class=\"o\">{}</span> <span class=\"o\">:</span> <span class=\"n\">option</span>\n<span class=\"bp\">|</span> <span class=\"n\">some</span>    <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">option</span>\n\n<span class=\"kn\">inductive</span> <span class=\"n\">inhabited</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span>\n<span class=\"bp\">|</span> <span class=\"n\">mk</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">inhabited</span>\n</pre></div>\n\n\n<p>For the inhabited type, I understand conceptually that given an example of an instance of a type, we could generate an object that says this type is inhabited. I'm at a loss for how to actually do something like <code>define inhabited_example ...</code> the we the book does for sum and prod. </p>\n<p>For option, I'm substantially more confused. It seems like option would go from a given element of the domain to either none or to a defined function, not the other way around. I feel like I'm misunderstanding something about what it means to have a recursively defined type.</p>",
        "id": 190799779,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584408208
    },
    {
        "content": "<p><code>option A</code> is a type which has one more element than <code>A</code>. The extra element is called <code>none : option A</code>, and the function that maps <code>A</code> into <code>option A</code> is called <code>some : A -&gt; option A</code>.</p>",
        "id": 190801100,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1584409853
    },
    {
        "content": "<p>Can you prove</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">example</span> <span class=\"o\">{</span><span class=\"n\">A</span> <span class=\"n\">B</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">h1</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h2</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"bp\">×</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">sorry</span>\n</pre></div>",
        "id": 190801192,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1584410008
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/190801192\" title=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/190801192\">said</a>:</p>\n<blockquote>\n<p>Can you prove</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">example</span> <span class=\"o\">{</span><span class=\"n\">A</span> <span class=\"n\">B</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">h1</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h2</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"bp\">×</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">sorry</span>\n</pre></div>\n\n\n</blockquote>\n<p>I'm not sure... If we have proofs that A and B and inhabited, it makes sense me that <code>A x B</code> would be inhabited. My intuition is to apply <code>inhabited.mk</code> to the product of the two instances we have, but that gives me a type error (understandably). Is there a way to extract the actual instance from an <code>inhabited</code> object so we can use it to make a new one?</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">example</span> <span class=\"o\">{</span><span class=\"n\">A</span> <span class=\"n\">B</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">h1</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h2</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"bp\">×</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"n\">inhabited</span><span class=\"bp\">.</span><span class=\"n\">mk</span> <span class=\"o\">(</span><span class=\"n\">h1</span> <span class=\"bp\">×</span> <span class=\"n\">h2</span><span class=\"o\">)</span>\n</pre></div>",
        "id": 190802208,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584411567
    },
    {
        "content": "<p>(deleted, I was using Lean's definition of inhabited, not the one given by TPiL...)</p>",
        "id": 190802713,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1584412442
    },
    {
        "content": "<p>One way is to use the <code>match ... with ... end</code> syntax:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">example</span> <span class=\"o\">{</span><span class=\"n\">A</span> <span class=\"n\">B</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">h1</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h2</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"bp\">×</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"k\">match</span> <span class=\"n\">h1</span><span class=\"o\">,</span> <span class=\"n\">h2</span> <span class=\"k\">with</span>\n<span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">inhabited</span><span class=\"bp\">.</span><span class=\"n\">mk</span> <span class=\"n\">a</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">inhabited</span><span class=\"bp\">.</span><span class=\"n\">mk</span> <span class=\"n\">b</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">inhabited</span><span class=\"bp\">.</span><span class=\"n\">mk</span> <span class=\"bp\">⟨</span><span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"n\">b</span><span class=\"bp\">⟩</span>\n<span class=\"kn\">end</span>\n</pre></div>\n\n\n<p>This syntax \"pattern matches\" on <code>h1</code> and <code>h2</code> to pull out <code>a : A</code> and <code>b : B</code>.</p>\n<p>You can also use angle brackets in place of the constructors like this:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">example</span> <span class=\"o\">{</span><span class=\"n\">A</span> <span class=\"n\">B</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">h1</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h2</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"bp\">×</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"k\">match</span> <span class=\"n\">h1</span><span class=\"o\">,</span> <span class=\"n\">h2</span> <span class=\"k\">with</span>\n<span class=\"bp\">|</span> <span class=\"bp\">⟨</span><span class=\"n\">a</span><span class=\"bp\">⟩</span><span class=\"o\">,</span> <span class=\"bp\">⟨</span><span class=\"n\">b</span><span class=\"bp\">⟩</span> <span class=\"o\">:=</span> <span class=\"bp\">⟨⟨</span><span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"n\">b</span><span class=\"bp\">⟩⟩</span>\n<span class=\"kn\">end</span>\n</pre></div>",
        "id": 190803827,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1584414199
    },
    {
        "content": "<p>Compare also:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">example</span> <span class=\"o\">{</span><span class=\"n\">A</span> <span class=\"n\">B</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">h1</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h2</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"bp\">×</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"k\">let</span> <span class=\"bp\">⟨</span><span class=\"n\">a</span><span class=\"bp\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">h1</span> <span class=\"k\">in</span>\n<span class=\"k\">let</span> <span class=\"bp\">⟨</span><span class=\"n\">b</span><span class=\"bp\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">h2</span> <span class=\"k\">in</span>\n<span class=\"bp\">⟨⟨</span><span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"n\">b</span><span class=\"bp\">⟩⟩</span>\n\n<span class=\"kn\">example</span> <span class=\"o\">{</span><span class=\"n\">A</span> <span class=\"n\">B</span><span class=\"o\">}</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">A</span> <span class=\"bp\">→</span> <span class=\"n\">inhabited</span> <span class=\"n\">B</span> <span class=\"bp\">→</span> <span class=\"n\">inhabited</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"bp\">×</span> <span class=\"n\">B</span><span class=\"o\">)</span>\n<span class=\"bp\">|</span> <span class=\"bp\">⟨</span><span class=\"n\">a</span><span class=\"bp\">⟩</span> <span class=\"bp\">⟨</span><span class=\"n\">b</span><span class=\"bp\">⟩</span> <span class=\"o\">:=</span> <span class=\"bp\">⟨⟨</span><span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"n\">b</span><span class=\"bp\">⟩⟩</span>\n</pre></div>",
        "id": 190803999,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1584414445
    },
    {
        "content": "<p>Oh, pattern-matching is introduced in chapter 8, so I guess you're meant  to use <code>inhabited.cases_on</code> instead. Here's a hint:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">example</span> <span class=\"o\">{</span><span class=\"n\">A</span> <span class=\"n\">B</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">h1</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h2</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"bp\">×</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"n\">inhabited</span><span class=\"bp\">.</span><span class=\"n\">cases_on</span> <span class=\"n\">h1</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"n\">inhabited</span><span class=\"bp\">.</span><span class=\"n\">cases_on</span> <span class=\"n\">h2</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">b</span><span class=\"o\">,</span> <span class=\"bp\">_</span><span class=\"o\">))</span>\n</pre></div>\n\n\n<p>[I was hoping this would work with dot notation (so I could write <code>h1.cases_on</code> and <code>h2.cases_on</code> instead of <code>inhabited.cases_on h1</code>, etc.) but it looks like that's too much for the elaborator...]</p>",
        "id": 190805054,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1584415755
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"123965\">Bryan Gin-ge Chen</span> <a href=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/190805054\" title=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/190805054\">said</a>:</p>\n<blockquote>\n<p>Oh, pattern-matching is introduced in chapter 8, so I guess you're meant  to use <code>inhabited.cases_on</code> instead. Here's a hint:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">example</span> <span class=\"o\">{</span><span class=\"n\">A</span> <span class=\"n\">B</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">h1</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h2</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">inhabited</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"bp\">×</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"n\">inhabited</span><span class=\"bp\">.</span><span class=\"n\">cases_on</span> <span class=\"n\">h1</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"n\">inhabited</span><span class=\"bp\">.</span><span class=\"n\">cases_on</span> <span class=\"n\">h2</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">b</span><span class=\"o\">,</span> <span class=\"bp\">_</span><span class=\"o\">))</span>\n</pre></div>\n\n\n<p>[I was hoping this would work with dot notation (so I could write <code>h1.cases_on</code> and <code>h2.cases_on</code> instead of <code>inhabited.cases_on h1</code>, etc.) but it looks like that's too much for the elaborator...]</p>\n</blockquote>\n<p>Thanks for your detailed answer! I'm getting a \"don't know how to synthesize placeholder<br>\ncontext:\" error on the wildecard. Is there something I need to import somewhere? I'm also still a little confused conceptually by how this works but maybe that'll be cleared up after reading chapter 8.</p>",
        "id": 190939609,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584507835
    },
    {
        "content": "<p>I think part of my confusion comes from the fact that all the solutions you gave rely on implicit notation using either brackets or wildcards. Is there an explicit way to show a type is inhabited, or is that not the way I should be thinking about this problem?</p>",
        "id": 190939723,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584508053
    },
    {
        "content": "<blockquote>\n<p>I'm getting a \"don't know how to synthesize placeholder context:\" error on the wildecard.</p>\n</blockquote>\n<p>That's right, the underscore was left for you to fill in. <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span> </p>\n<blockquote>\n<p>Is there something I need to import somewhere?</p>\n</blockquote>\n<p>No imports necessary!</p>\n<blockquote>\n<p>Is there an explicit way to show a type is inhabited</p>\n</blockquote>\n<p>Yep, in this context, <code>⟨⟨a, b⟩⟩</code> is just shorthand for to <code>inhabited.mk (prod.mk a b)</code>.</p>",
        "id": 190939865,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1584508329
    },
    {
        "content": "<p>Oh, that makes sense haha. I thought you were intentionally leaving it as a wildcard. This is very helpful, thank you!</p>",
        "id": 190939929,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584508447
    },
    {
        "content": "<p>Ok I'm still a little confused about how <code>option</code> works. I'm trying to define a simple function that is the identity on 0 and 1, and undefined everywhere else. I'm getting a type mismatch error on all three <code>:=</code> signs when I do the following. Any thoughts?</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">def</span> <span class=\"n\">partial</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"bp\">ℕ</span>\n<span class=\"bp\">|</span> <span class=\"mi\">0</span> <span class=\"o\">:=</span> <span class=\"n\">some</span> <span class=\"mi\">0</span>\n<span class=\"bp\">|</span> <span class=\"mi\">1</span> <span class=\"o\">:=</span> <span class=\"n\">some</span> <span class=\"mi\">1</span>\n<span class=\"bp\">|</span> <span class=\"bp\">_</span> <span class=\"o\">:=</span> <span class=\"n\">none</span>\n</pre></div>",
        "id": 190941372,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584511012
    },
    {
        "content": "<p>it does not give any error for me.</p>",
        "id": 190941519,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1584511304
    },
    {
        "content": "<p>Rocky's using the <code>option</code> defined in TPiL, so the full code is something like this:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">namespace</span> <span class=\"n\">blah</span>\n<span class=\"kn\">universe</span> <span class=\"n\">u</span>\n<span class=\"kn\">inductive</span> <span class=\"n\">option</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span>\n<span class=\"bp\">|</span> <span class=\"n\">none</span> <span class=\"o\">{}</span> <span class=\"o\">:</span> <span class=\"n\">option</span>\n<span class=\"bp\">|</span> <span class=\"n\">some</span>    <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">option</span>\n\n\n<span class=\"n\">def</span> <span class=\"n\">partial</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"bp\">ℕ</span>\n<span class=\"bp\">|</span> <span class=\"mi\">0</span> <span class=\"o\">:=</span> <span class=\"n\">some</span> <span class=\"mi\">0</span>\n<span class=\"bp\">|</span> <span class=\"mi\">1</span> <span class=\"o\">:=</span> <span class=\"n\">some</span> <span class=\"mi\">1</span>\n<span class=\"bp\">|</span> <span class=\"bp\">_</span> <span class=\"o\">:=</span> <span class=\"n\">none</span>\n\n<span class=\"kn\">end</span> <span class=\"n\">blah</span>\n</pre></div>",
        "id": 190941706,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1584511576
    },
    {
        "content": "<p><del>The solution is to add <code>open option</code> before <code>def partial</code>.</del></p>\n<p>This works:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">namespace</span> <span class=\"n\">blah</span>\n<span class=\"kn\">universe</span> <span class=\"n\">u</span>\n<span class=\"kn\">inductive</span> <span class=\"n\">option</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span>\n<span class=\"bp\">|</span> <span class=\"n\">none</span> <span class=\"o\">{}</span> <span class=\"o\">:</span> <span class=\"n\">option</span>\n<span class=\"bp\">|</span> <span class=\"n\">some</span>    <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">option</span>\n\n<span class=\"n\">def</span> <span class=\"n\">partial</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"bp\">ℕ</span>\n<span class=\"bp\">|</span> <span class=\"mi\">0</span> <span class=\"o\">:=</span> <span class=\"n\">option</span><span class=\"bp\">.</span><span class=\"n\">some</span> <span class=\"mi\">0</span>\n<span class=\"bp\">|</span> <span class=\"mi\">1</span> <span class=\"o\">:=</span> <span class=\"n\">option</span><span class=\"bp\">.</span><span class=\"n\">some</span> <span class=\"mi\">1</span>\n<span class=\"bp\">|</span> <span class=\"bp\">_</span> <span class=\"o\">:=</span> <span class=\"n\">option</span><span class=\"bp\">.</span><span class=\"n\">none</span>\n\n<span class=\"kn\">end</span> <span class=\"n\">blah</span>\n</pre></div>",
        "id": 190941716,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1584511614
    },
    {
        "content": "<p>Thank you <span class=\"user-mention\" data-user-id=\"123965\">@Bryan Gin-ge Chen</span>  for catching that! Adding <code>open option</code> doesn't seem to resolve this issue. Leaving the namespace and using lean's default <code>option</code> does work though. I thought the two definitions were the same here... is that not the case?</p>",
        "id": 190941794,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584511719
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"123965\">Bryan Gin-ge Chen</span> <a href=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/190941716\" title=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/190941716\">said</a>:</p>\n<blockquote>\n<p><del>The solution is to add <code>open option</code> before <code>def partial</code>.</del></p>\n<p>This works:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">namespace</span> <span class=\"n\">blah</span>\n<span class=\"kn\">universe</span> <span class=\"n\">u</span>\n<span class=\"kn\">inductive</span> <span class=\"n\">option</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span>\n<span class=\"bp\">|</span> <span class=\"n\">none</span> <span class=\"o\">{}</span> <span class=\"o\">:</span> <span class=\"n\">option</span>\n<span class=\"bp\">|</span> <span class=\"n\">some</span>    <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">option</span>\n\n<span class=\"n\">def</span> <span class=\"n\">partial</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"bp\">ℕ</span>\n<span class=\"bp\">|</span> <span class=\"mi\">0</span> <span class=\"o\">:=</span> <span class=\"n\">option</span><span class=\"bp\">.</span><span class=\"n\">some</span> <span class=\"mi\">0</span>\n<span class=\"bp\">|</span> <span class=\"mi\">1</span> <span class=\"o\">:=</span> <span class=\"n\">option</span><span class=\"bp\">.</span><span class=\"n\">some</span> <span class=\"mi\">1</span>\n<span class=\"bp\">|</span> <span class=\"bp\">_</span> <span class=\"o\">:=</span> <span class=\"n\">option</span><span class=\"bp\">.</span><span class=\"n\">none</span>\n\n<span class=\"kn\">end</span> <span class=\"n\">blah</span>\n</pre></div>\n\n\n</blockquote>\n<p>That did the trick. Thank you!</p>",
        "id": 190941805,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584511771
    },
    {
        "content": "<p>Yeah, it wasn't <code>open option</code> that worked but rather surrounding <code>def partial</code> with <code>namespace option</code> and <code>end option</code> (or writing the names out fully as I did above).</p>",
        "id": 190941884,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1584511910
    },
    {
        "content": "<p>The <code>option</code> provided by Lean's core library is equivalent, but you can't use it when Lean is expecting your <code>option</code>.</p>",
        "id": 190941932,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1584511959
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"123965\">Bryan Gin-ge Chen</span> <a href=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/190941932\" title=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/190941932\">said</a>:</p>\n<blockquote>\n<p>The <code>option</code> provided by Lean's core library is equivalent, but you can't use it when Lean is expecting your <code>option</code>.</p>\n</blockquote>\n<p>Makes sense. This has come up before when TPIL makes you define types that are built in and I've forgotten that the interactions are a little different. Thanks!</p>",
        "id": 190941986,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584512060
    },
    {
        "content": "<p>Another question: I'm trying to define the composite of partial functions also discussed in this section. I have this so far, and am (understandably) running into an error when I try to apply <code>g</code> to <code>(f a)</code> because it is an element of <code>option β</code> rather than <code>β</code>. Is there an easy way to convert back from an option type to the element of the regular type?</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">def</span> <span class=\"n\">compose_partials</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"n\">β</span> <span class=\"n\">γ</span><span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">g</span> <span class=\"o\">:</span> <span class=\"n\">β</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"n\">γ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"n\">γ</span>  <span class=\"o\">:=</span>\n<span class=\"bp\">λ</span> <span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">,</span> <span class=\"n\">option</span><span class=\"bp\">.</span><span class=\"n\">cases_on</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">a</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">some</span> <span class=\"o\">(</span><span class=\"n\">g</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">a</span><span class=\"o\">)))</span> <span class=\"o\">(</span><span class=\"n\">none</span><span class=\"o\">)</span>\n</pre></div>",
        "id": 190941987,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584512076
    },
    {
        "content": "<p><del>I think you might need a helper function like this:</del></p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">def</span> <span class=\"n\">helper</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"o\">}</span> <span class=\"o\">:</span> <span class=\"n\">option</span> <span class=\"o\">(</span><span class=\"n\">option</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">option</span> <span class=\"n\">α</span>\n<span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">some</span> <span class=\"o\">(</span><span class=\"n\">some</span> <span class=\"n\">x</span><span class=\"o\">))</span> <span class=\"o\">:=</span> <span class=\"n\">some</span> <span class=\"n\">x</span>\n<span class=\"bp\">|</span> <span class=\"bp\">_</span>               <span class=\"o\">:=</span> <span class=\"n\">none</span>\n</pre></div>\n\n\n<p><del>I don't think there is a way to have a function where<code>f : option a -&gt; a</code> in Lean, since <code>f none</code> would require you to be able to make a value of type <code>a</code> for all <code>a</code>.</del></p>\n<p><del>In other languages (Haskell, etc.) there is what you're looking for, but they crash on the case <code>f none</code>.</del></p>\n<p>Nevermind.</p>",
        "id": 190942392,
        "sender_full_name": "Shing Tak Lam",
        "timestamp": 1584512825
    },
    {
        "content": "<p>This works:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">def</span> <span class=\"n\">compose_partials</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"n\">β</span> <span class=\"n\">γ</span><span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">g</span> <span class=\"o\">:</span> <span class=\"n\">β</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"n\">γ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"n\">γ</span> <span class=\"o\">:=</span>\n<span class=\"bp\">λ</span> <span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">,</span> <span class=\"n\">option</span><span class=\"bp\">.</span><span class=\"n\">cases_on</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">a</span><span class=\"o\">)</span> <span class=\"n\">none</span> <span class=\"n\">g</span>\n</pre></div>\n\n\n<p>I think maybe you were thrown off by having <code>none</code> in the wrong slot.</p>",
        "id": 190942608,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1584513088
    },
    {
        "content": "<p>I think this is called <code>bind</code> and it's basically the proof that <code>option</code> is a monad</p>",
        "id": 190946023,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1584517092
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"123965\">Bryan Gin-ge Chen</span> <a href=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/190942608\" title=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/190942608\">said</a>:</p>\n<blockquote>\n<p>This works:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">def</span> <span class=\"n\">compose_partials</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"n\">β</span> <span class=\"n\">γ</span><span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">g</span> <span class=\"o\">:</span> <span class=\"n\">β</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"n\">γ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"n\">γ</span> <span class=\"o\">:=</span>\n<span class=\"bp\">λ</span> <span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">,</span> <span class=\"n\">option</span><span class=\"bp\">.</span><span class=\"n\">cases_on</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">a</span><span class=\"o\">)</span> <span class=\"n\">none</span> <span class=\"n\">g</span>\n</pre></div>\n\n\n<p>I think maybe you were thrown off by having <code>none</code> in the wrong slot.</p>\n</blockquote>\n<p>Wouldn't this just give us the function g in the case that a is in the domain of f, and not the element that g maps (f a) to? Or am I missing something?</p>",
        "id": 191068324,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584587844
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"266440\">Shing Tak Lam</span> <a href=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/190942392\" title=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/190942392\">said</a>:</p>\n<blockquote>\n<p><del>I think you might need a helper function like this:</del></p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">def</span> <span class=\"n\">helper</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"o\">}</span> <span class=\"o\">:</span> <span class=\"n\">option</span> <span class=\"o\">(</span><span class=\"n\">option</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">option</span> <span class=\"n\">α</span>\n<span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">some</span> <span class=\"o\">(</span><span class=\"n\">some</span> <span class=\"n\">x</span><span class=\"o\">))</span> <span class=\"o\">:=</span> <span class=\"n\">some</span> <span class=\"n\">x</span>\n<span class=\"bp\">|</span> <span class=\"bp\">_</span>               <span class=\"o\">:=</span> <span class=\"n\">none</span>\n</pre></div>\n\n\n<p><del>I don't think there is a way to have a function where<code>f : option a -&gt; a</code> in Lean, since <code>f none</code> would require you to be able to make a value of type <code>a</code> for all <code>a</code>.</del></p>\n<p><del>In other languages (Haskell, etc.) there is what you're looking for, but they crash on the case <code>f none</code>.</del></p>\n<p>Nevermind.</p>\n</blockquote>\n<p>That makes sense. The notation for more abstract recursive types like this still makes my head hurt a little, but I feel like that will probably get better with time.</p>",
        "id": 191068428,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584587982
    },
    {
        "content": "<p>It might help to see the definition expanded as <code>λ a : α, option.cases_on (f a) none (λ b, g b)</code></p>",
        "id": 191068759,
        "sender_full_name": "Reid Barton",
        "timestamp": 1584588411
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110032\">Reid Barton</span> <a href=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/191068759\" title=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/191068759\">said</a>:</p>\n<blockquote>\n<p>It might help to see the definition expanded as <code>λ a : α, option.cases_on (f a) none (λ b, g b)</code></p>\n</blockquote>\n<p>Using a helper function and reversing the order of the arguments to <code>option (f a) _ _</code> I still get two errors. </p>\n<p>That makes sense to me. Does <code>cases_on</code> do that automatically with the notation <span class=\"user-mention\" data-user-id=\"123965\">@Bryan Gin-ge Chen</span>  gave?</p>",
        "id": 191068857,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584588565
    },
    {
        "content": "<p>I don't understand your question. But <code>g</code> equals <code>λ b, g b</code>.</p>",
        "id": 191068929,
        "sender_full_name": "Reid Barton",
        "timestamp": 1584588609
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110032\">Reid Barton</span> <a href=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/191068929\" title=\"#narrow/stream/113489-new-members/topic/TPIL.20Chapter.207/near/191068929\">said</a>:</p>\n<blockquote>\n<p>I don't understand your question. But <code>g</code> equals <code>λ b, g b</code>.</p>\n</blockquote>\n<p>Oh duh, yeah I was just getting a little lost in what was taking in what and going where with <code>cases_on</code>. Yeah that makes sense now. </p>\n<p><span class=\"user-mention\" data-user-id=\"266440\">@Shing Tak Lam</span>  I tried doing something like this and got rid of the return type error but I'm getting type mismatches in my helper function and at <code>option.cases_on</code></p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">def</span> <span class=\"n\">helper</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">input</span> <span class=\"o\">:</span> <span class=\"n\">option</span> <span class=\"n\">α</span><span class=\"o\">):</span> <span class=\"n\">α</span>\n<span class=\"bp\">|</span> <span class=\"n\">some</span> <span class=\"o\">(</span><span class=\"n\">some</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">some</span> <span class=\"n\">x</span>\n<span class=\"bp\">|</span> <span class=\"n\">some</span> <span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">x</span>\n<span class=\"bp\">|</span> <span class=\"bp\">_</span> <span class=\"o\">:</span> <span class=\"n\">none</span>\n\n<span class=\"n\">def</span> <span class=\"n\">compose_partials</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"n\">β</span> <span class=\"n\">γ</span><span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">g</span> <span class=\"o\">:</span> <span class=\"n\">β</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"n\">γ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"n\">γ</span>  <span class=\"o\">:=</span>\n<span class=\"bp\">λ</span> <span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">,</span> <span class=\"n\">option</span><span class=\"bp\">.</span><span class=\"n\">cases_on</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">a</span><span class=\"o\">)</span> <span class=\"n\">none</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"n\">β</span><span class=\"o\">,</span> <span class=\"n\">helper</span> <span class=\"o\">(</span><span class=\"n\">g</span> <span class=\"n\">b</span><span class=\"o\">))</span>\n</pre></div>",
        "id": 191069073,
        "sender_full_name": "Rocky Kamen-Rubio",
        "timestamp": 1584588827
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"260106\">@Rocky Kamen-Rubio</span> </p>\n<p>Nevermind what I said previously. I didn't look at it properly. (I never did TPIL). So I did it with <code>option.map</code> instead of <code>option.cases_on</code>.</p>\n<p>Sorry for any confusion</p>",
        "id": 191070850,
        "sender_full_name": "Shing Tak Lam",
        "timestamp": 1584591946
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"261068\">@ROCKY KAMEN-RUBIO</span> your helper definition does not look good to me. What is the type of x supposed to be in some (some x)? You say you're getting type mismatches but if you just read them carefully they will tell you by themselves the errors you made</p>",
        "id": 191079092,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1584604135
    },
    {
        "content": "<p>You do understand that alpha and option alpha are completely different types, right?</p>",
        "id": 191079147,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1584604197
    },
    {
        "content": "<p>There is no natural helper map of the kind you're trying to define because where is none going to go? Alpha could be empty</p>",
        "id": 191079217,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1584604250
    },
    {
        "content": "<p>Maybe you should take a look at learnyouahaskell? This taught me a lot about functional programming</p>",
        "id": 191079327,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1584604335
    },
    {
        "content": "<p>Given the type of <code>compose_partials</code>, it looks like the right thing to put in the location of <code>helper</code> is the identity function</p>",
        "id": 191079798,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1584604690
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"260106\">@Rocky Kamen-Rubio</span> </p>\n<p>The <code>helper</code> function I posted is</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">def</span> <span class=\"n\">helper</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"o\">}</span> <span class=\"o\">:</span> <span class=\"n\">option</span> <span class=\"o\">(</span><span class=\"n\">option</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">option</span> <span class=\"n\">α</span>\n<span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">some</span> <span class=\"o\">(</span><span class=\"n\">some</span> <span class=\"n\">x</span><span class=\"o\">))</span> <span class=\"o\">:=</span> <span class=\"n\">some</span> <span class=\"n\">x</span>\n<span class=\"bp\">|</span> <span class=\"bp\">_</span>               <span class=\"o\">:=</span> <span class=\"n\">none</span>\n</pre></div>\n\n\n<p>The one you posted is below</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">def</span> <span class=\"n\">helper</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">input</span> <span class=\"o\">:</span> <span class=\"n\">option</span> <span class=\"n\">α</span><span class=\"o\">):</span> <span class=\"n\">α</span>\n<span class=\"bp\">|</span> <span class=\"n\">some</span> <span class=\"o\">(</span><span class=\"n\">some</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">some</span> <span class=\"n\">x</span>\n<span class=\"bp\">|</span> <span class=\"n\">some</span> <span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">x</span>\n<span class=\"bp\">|</span> <span class=\"bp\">_</span> <span class=\"o\">:</span> <span class=\"n\">none</span>\n</pre></div>\n\n\n<p>Notice how mine is <code>option (option α) -&gt; option α</code>, while yours is <code>option α -&gt; α</code>. That is why the first case from mine <code>(some (some x)) := some x</code> doesn't apply for you, as the left hand side <code>(some (some x))</code> has the type <code>option (option α)</code>, not <code>option α</code>. Also, the parenthesis matter here, as when used to pattern match, <code>(some (some x))</code> and <code>some (some x)</code> are different.</p>\n<p>Additionally, there is a syntax error there, it should be <code>:=</code> in the cases.</p>\n<p>Also notice the types of your cases do not match, as the first one is <code>option (option α) -&gt; option α</code>, the second one is <code>option α -&gt; α</code>, the last one is <code>option α -&gt; option ???</code>. So lean complains that all of them have different types.</p>\n<p>The helper function was when I solved it with <code>option.map</code>, and <code>option.cases_on</code> expects a different function, so that's why you're getting an error there. <code>option.map</code> would produce a <code>option (option α)</code>, which is why I needed the <code>helper</code> function, as for this example, <code>some (none)</code> is pragmatically the same as <code>none</code>, so I use <code>_</code> to catch both cases.</p>\n<p>Sorry for any confusion caused</p>",
        "id": 191082205,
        "sender_full_name": "Shing Tak Lam",
        "timestamp": 1584606715
    }
]