[
    {
        "content": "<p>i think this might be easy so  i was wondering if someone can have an example, i had been trying different approaches without luck for now. my goal is something as:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">list_to_bitvec</span> <span class=\"o\">(</span><span class=\"n\">L</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"n\">bool</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">bitvec</span> <span class=\"n\">h</span> <span class=\"o\">:=</span>\n</code></pre></div>\n<p>the other way around is easy:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">bitvec_to_list</span> <span class=\"o\">(</span><span class=\"n\">B</span> <span class=\"o\">:</span> <span class=\"n\">bitvec</span> <span class=\"n\">h</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"n\">bool</span> <span class=\"o\">:=</span>  <span class=\"n\">vector.to_list</span> <span class=\"n\">B</span>\n</code></pre></div>\n<p>i had been trying to do an inductive type for it but no luck yet, unsure if it will be the right way to go, any help is appreciated.</p>",
        "id": 287955485,
        "sender_full_name": "Alfredo Garcia",
        "timestamp": 1656545681
    },
    {
        "content": "<p>Someone more knowledgeable should jump in here, but it seems like the key hurdle is that you need to provide a proof that <code>L.length = h</code>.</p>",
        "id": 287959118,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1656548519
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">data.bitvec.core</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">list_to_bitvec</span> <span class=\"o\">(</span><span class=\"n\">L</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"n\">bool</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"n\">L.length</span> <span class=\"bp\">=</span> <span class=\"n\">h</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">bitvec</span> <span class=\"n\">h</span> <span class=\"o\">:=</span> <span class=\"o\">⟨</span><span class=\"n\">L</span><span class=\"o\">,</span> <span class=\"n\">H</span><span class=\"o\">⟩</span>\n</code></pre></div>",
        "id": 287959477,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1656548765
    },
    {
        "content": "<p><code>vector</code> is a subtype of <code>list</code>, which means to construct a term of type <code>vector</code> you have to provide a term of the base type (a <code>list</code>) along with a proof that the term satisfies the subtype predicate (that <code>list.length</code> equals the vector length)</p>",
        "id": 287959663,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1656548932
    },
    {
        "content": "<p>you could also do something like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">list_to_bitvec'</span> <span class=\"o\">(</span><span class=\"n\">L</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"n\">bool</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">option</span> <span class=\"o\">(</span><span class=\"n\">bitvec</span> <span class=\"n\">h</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"n\">dite</span> <span class=\"o\">(</span><span class=\"n\">L.length</span> <span class=\"bp\">=</span> <span class=\"n\">h</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">H</span><span class=\"o\">,</span> <span class=\"n\">some</span> <span class=\"o\">⟨</span><span class=\"n\">L</span><span class=\"o\">,</span> <span class=\"n\">H</span><span class=\"o\">⟩)</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">_</span><span class=\"o\">,</span> <span class=\"n\">none</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>where you return a bitvec if the length matches, but <code>none</code> otherwise</p>",
        "id": 287960479,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1656549761
    },
    {
        "content": "<p>This option will just cut the list off at <code>n</code> elements (or append additional <code>false</code>s if the list is too short):</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">list_to_bitvec</span> <span class=\"o\">(</span><span class=\"n\">L</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"n\">bool</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">bitvec</span> <span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"o\">⟨</span><span class=\"n\">list.take'</span> <span class=\"n\">n</span> <span class=\"n\">L</span><span class=\"o\">,</span> <span class=\"n\">list.take'_length</span> <span class=\"n\">n</span> <span class=\"n\">L</span><span class=\"o\">⟩</span>\n</code></pre></div>\n<p>and if you don't want to specify the length at all, you can do this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">list_to_bitvec</span> <span class=\"o\">(</span><span class=\"n\">L</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"n\">bool</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">bitvec</span> <span class=\"n\">L.length</span> <span class=\"o\">:=</span> <span class=\"o\">⟨</span><span class=\"n\">L</span><span class=\"o\">,</span> <span class=\"n\">rfl</span><span class=\"o\">⟩</span>\n</code></pre></div>",
        "id": 287968653,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1656558787
    },
    {
        "content": "<p>that is great Matt, thank you very much for the options</p>",
        "id": 288022166,
        "sender_full_name": "Alfredo Garcia",
        "timestamp": 1656593439
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"476482\">Alfredo Garcia</span> has marked this topic as resolved.</p>",
        "id": 288022182,
        "sender_full_name": "Notification Bot",
        "timestamp": 1656593443
    },
    {
        "content": "<p>let me know if you think it will worth to push one of this into mathlib as <code>list.to_bitvec</code> or/and <code>list.to_vector</code></p>",
        "id": 288026519,
        "sender_full_name": "Alfredo Garcia",
        "timestamp": 1656595401
    },
    {
        "content": "<p>I think probably there's little point; it seems the's not an obvious definition to pick for it, and none of the choices are all that long to spell out</p>",
        "id": 288027373,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1656595785
    },
    {
        "content": "<p>Changing <a href=\"https://leanprover-community.github.io/mathlib_docs/find/list.take'\">docs#list.take'</a> to return a <code>vector</code>, or adding <code>list.take_vector</code> <em>might</em> be reasonable</p>",
        "id": 288027492,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1656595833
    },
    {
        "content": "<p>Ok thanks Eric, i might give that a try</p>",
        "id": 288059786,
        "sender_full_name": "Alfredo Garcia",
        "timestamp": 1656609290
    }
]