[
    {
        "content": "<p>Hi all! I'm a newbie with a question! =P</p>\n<p>I learned a bit of Agda one year ago, and in Agda I can tell the system where to find the stdlib and other libraries - for example, agda-categories - by adjusting the files ~/.agda/defaults and ~/.agda/libraries... how can I do something similar for Lean? Earlier today I downloaded, i.e., \"git clone\"d, mathlib4, and then compiled it with \"lake build\", and this took almost 12 hours, so I would like to avoid having several copies of mathlib4 in my machine...</p>\n<p>Thanks in advance!<br>\nEduardo Ochs<br>\n<a href=\"http://anggtwu.net/math-b.html\">http://anggtwu.net/math-b.html</a><br>\n(etc etc)</p>",
        "id": 369537972,
        "sender_full_name": "Eduardo Ochs",
        "timestamp": 1687745143
    },
    {
        "content": "<p>Welcome <span class=\"user-mention\" data-user-id=\"381195\">@Eduardo Ochs</span>!</p>\n<p><span class=\"user-mention silent\" data-user-id=\"381195\">Eduardo Ochs</span> <a href=\"#narrow/stream/113489-new-members/topic/~.2F.2Eagda.2Fdefaults.20and.20~.2F.2Eagda.2Flibraries.2C.20but.20in.20Lean.3F/near/369537972\">said</a>:</p>\n<blockquote>\n<p>i.e., \"git clone\"d, mathlib4, and then compiled it with \"lake build\", and this took almost 12 hours</p>\n</blockquote>\n<p>The trick here is that every version of mathlib/mathlib4 has the result of its compilation stored in the cloud, so you don't need to compile it on your own computer.  Instead, whenever you switch to a new version of mathlib4, type <code>lake exe cache get</code> at the command line to download the compilation artifacts -- this should take &lt; 2 minutes.</p>",
        "id": 369544982,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1687749339
    },
    {
        "content": "<p>(You might have noticed that mathlib is in the middle of switching from Lean 3 to Lean 4.  What instructions did you follow?  Maybe they are still in rough shape and need updating or clarification.)</p>",
        "id": 369545270,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1687749486
    },
    {
        "content": "<p>I followed the instructions in this section of the README.md of mathlib4:<br>\n<a href=\"https://github.com/leanprover-community/mathlib4#build-instructions\">https://github.com/leanprover-community/mathlib4#build-instructions</a><br>\nthat section is followed by this one, that mentions \"lake exe cache get\",<br>\n<a href=\"https://github.com/leanprover-community/mathlib4#downloading-cached-build-files\">https://github.com/leanprover-community/mathlib4#downloading-cached-build-files</a><br>\nbut yes, the \"Build instructions\" don't say that usually people should download the cached build files instead of building everything themselves...</p>",
        "id": 369578481,
        "sender_full_name": "Eduardo Ochs",
        "timestamp": 1687762004
    },
    {
        "content": "<p>Another basic question... now I have a full copy of mathlib4 in ~/bigsrc/mathlib4/, and I tried to run this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">rm</span> <span class=\"bp\">-</span><span class=\"n\">Rfv</span> <span class=\"bp\">~/</span><span class=\"n\">bigsrc</span><span class=\"bp\">/</span><span class=\"n\">mathematics_in_lean</span><span class=\"bp\">/</span>\n<span class=\"n\">cd</span>      <span class=\"bp\">~/</span><span class=\"n\">bigsrc</span><span class=\"bp\">/</span>\n<span class=\"n\">git</span> <span class=\"n\">clone</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathematics_in_lean</span>\n<span class=\"n\">cd</span>      <span class=\"bp\">~/</span><span class=\"n\">bigsrc</span><span class=\"bp\">/</span><span class=\"n\">mathematics_in_lean</span><span class=\"bp\">/</span>\n<span class=\"n\">lake</span> <span class=\"n\">exe</span> <span class=\"n\">cache</span> <span class=\"n\">get</span>\n</code></pre></div>\n<p>Apparently 1) this downloaded another full copy of mathlib4 in ~/bigsrc/mathematics_in_lean/lake-packages/mathlib/, and 2) if I create a project and I put a like like this</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">require</span> <span class=\"n\">mathlib</span> <span class=\"k\">from</span> <span class=\"n\">git</span> <span class=\"s2\">\"https://github.com/leanprover-community/mathlib4\"</span><span class=\"bp\">@</span><span class=\"s2\">\"master\"</span>\n</code></pre></div>\n<p>in its lakefile.lean it will also download another full copy of mathlib4... is there a way to make these copies be shared?</p>",
        "id": 369592751,
        "sender_full_name": "Eduardo Ochs",
        "timestamp": 1687765277
    },
    {
        "content": "<p>At present we do not have any tooling for sharing the same mathlib files between different projects (but the cache is stored separately so doesn't need re-downloading). (If you're comfortable hacking around and are 100% sure your projects use the same mathlib version you could probably do something of this sort with soft or hard links but I've never tried)</p>",
        "id": 369599041,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1687766608
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"127136\">@Alex J. Best</span>, thanks, I'll try! But what do you mean by \"the cache is stored separately so doesn't need re-downloading\"? Where?</p>",
        "id": 369604583,
        "sender_full_name": "Eduardo Ochs",
        "timestamp": 1687767838
    },
    {
        "content": "<p>I think in <code>~/.cache/mathlib</code></p>",
        "id": 369607378,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1687768415
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"127136\">@Alex J. Best</span>, thanks!</p>",
        "id": 369724201,
        "sender_full_name": "Eduardo Ochs",
        "timestamp": 1687789649
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/5503\">#5503</a> hopefully resolves the documentation problem discovered above!</p>",
        "id": 369845867,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1687817997
    }
]