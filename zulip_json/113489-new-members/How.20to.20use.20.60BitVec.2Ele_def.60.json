[
    {
        "content": "<p>Hello :) I have a very newbie question: <br>\nI am trying to use <code>BitVec.le_def</code> to prove that <code>x &gt;= x - y</code>, where <code>x</code> and <code>y</code> are logical expressions (e.g.  <code>a &amp;&amp;&amp; b</code>) and <code>x</code> and <code>y</code> are bitvectors, but the tactic rewrite fails and I can not understand why. I guess it might be because I am missing some guarantees on <code>y</code>,  but have no idea how to add that either for <code>BitVecs</code>.<br>\nthanks :)</p>",
        "id": 468219394,
        "sender_full_name": "Luisa Cicolini",
        "timestamp": 1725636635
    },
    {
        "content": "<p>Please provide a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> (follow the link for instructions)</p>",
        "id": 468222509,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1725637458
    },
    {
        "content": "<p>thank you for the link!<br>\nthis is the theorem (no imports needed): </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">ex1</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">BitVec</span><span class=\"bp\">.</span><span class=\"n\">ule</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">|||</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">|||</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">BitVec</span><span class=\"bp\">.</span><span class=\"n\">le_def</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>and the specific error I am getting is: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">rewrite'</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">did</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">find</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">pattern</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">expression</span>\n<span class=\"w\">  </span><span class=\"bp\">?</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">y</span>\n<span class=\"n\">w</span><span class=\"bp\">✝</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BitVec</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"bp\">✝</span>\n<span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">|||</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">ule</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">|||</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">true</span>\n</code></pre></div>",
        "id": 468224989,
        "sender_full_name": "Luisa Cicolini",
        "timestamp": 1725638095
    },
    {
        "content": "<p>That makes sense, because your goal is about <code>BitVec.ule</code>, not <code>≤</code></p>",
        "id": 468227488,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1725638752
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> BitVec.ule, LE.le</p>",
        "id": 468227812,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1725638844
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Init/Data/BitVec/Bitblast.html#BitVec.ule.eq_1\">BitVec.ule.eq_1</a></p>",
        "id": 468227816,
        "sender_full_name": "loogle",
        "timestamp": 1725638845
    },
    {
        "content": "<p>That should work</p>",
        "id": 468227831,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1725638849
    },
    {
        "content": "<p>it did!! Thank you very much :)</p>",
        "id": 468228186,
        "sender_full_name": "Luisa Cicolini",
        "timestamp": 1725638923
    }
]