[
    {
        "content": "<p>So I'm looking at this again, not to learn to write term mode proofs, but just to get a glimpse at what they looks like and comparing them to a simple term mode proof:</p>\n<p>The following is a very simple lemma:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">my_lemma2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">norm_num</span>\n\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">my_lemma2</span>\n</code></pre></div>\n<p>I was hoping the output was comprehensible, or if not that, at least recognisable:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>theorem my_lemma2 : 2 + 1 = 3 :=\nof_eq_true\n  (eq_true\n    (Mathlib.Meta.NormNum.isNat_eq_true\n      (Mathlib.Meta.NormNum.isNat_add (Eq.refl HAdd.hAdd) (Mathlib.Meta.NormNum.isNat_ofNat ℕ (Eq.refl 2))\n        (Mathlib.Meta.NormNum.isNat_ofNat ℕ (Eq.refl 1)) (Eq.refl 3))\n      (Mathlib.Meta.NormNum.isNat_ofNat ℕ (Eq.refl 3))))\n</code></pre></div>\n<p>I can vaguely see references to equality and the numbers 1 and 3.</p>\n<p><strong>My question</strong>: Is there a better simple tactic proof that produces a term mode proof that is more readable for beginners. I hope to use it as an educational example.</p>\n<p>Also - a quick question of terminology. Is the tactic mode proof <strong>compiled</strong> or <strong>evaluated</strong> to a term mode proof? By evaluated I mean the stuff I'm reading about regarding lambda calculus - beta-reduction, using introduction and elimination rules, etc .. and is it Lean or Mathlib that does this conversion?</p>",
        "id": 496860460,
        "sender_full_name": "rzeta0",
        "timestamp": 1738268014
    },
    {
        "content": "<p>it is Lean that evaluates tactics. This happens at a point of turning syntax into terms, known as \"elaboration\".</p>",
        "id": 496861369,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1738268400
    },
    {
        "content": "<p><code>by? exact</code> finds that your example can be proven just using <code>:= rfl</code></p>",
        "id": 496861446,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1738268415
    },
    {
        "content": "<p>That's probably not what you were looking for, but generally I wouldn't look to tactics outside of ones like <code>exact?</code> / <code>apply</code> / <code>rw</code> and maybe <code>simp</code> for term-mode readability</p>",
        "id": 496861797,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1738268569
    },
    {
        "content": "<p>as a matter of fact, generally the precise term produced by \"powerful\" tactics like <code>linarith</code>, <code>group</code>, <code>ring</code>, <code>abel</code>, <code>omega</code> and <code>aesop</code> are not intended to be human readable.</p>",
        "id": 496862169,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1738268739
    },
    {
        "content": "<p>understanding the produced term will likely involve understanding the precise algorithm used by the relevant tactic, along with any and all nuances and edge cases that might be relevant.</p>",
        "id": 496862571,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1738268912
    },
    {
        "content": "<p>it's precisely because these general processes for providing a certain kind of proof can get very involved, that they are abstracted behind a tactic. Additionally, since lean does not care about the exact proof term provided, these tactics don't optimise the produced term for readability.</p>",
        "id": 496862861,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1738269038
    },
    {
        "content": "<p>Thanks for the replies so far.</p>\n<p>I understand and agree that the terms that Lean produces are not intended to be human readable.</p>\n<p>I was just curious as to whether there was a very trivial tactic mode proof that did translate into terms that looked vaguely understandable. I did try an even simpler lemma <code>1=1</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">my_lemma2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">norm_num</span>\n\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">my_lemma2</span>\n</code></pre></div>\n<p>which produces:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>theorem my_lemma2 : 1 = 1 :=\nof_eq_true\n  (eq_true\n    (Mathlib.Meta.NormNum.isNat_eq_true (Mathlib.Meta.NormNum.isNat_ofNat ℕ (Eq.refl 1))\n      (Mathlib.Meta.NormNum.isNat_ofNat ℕ (Eq.refl 1))))\n</code></pre></div>",
        "id": 496863384,
        "sender_full_name": "rzeta0",
        "timestamp": 1738269243
    },
    {
        "content": "<p>i believe the terms produced by <code>apply</code>, <code>exact</code> and <code>refine</code> tend to be on the more readable side of things... i'm not too sure about <code>rw</code> and <code>simp</code> tho.</p>",
        "id": 496863792,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1738269400
    },
    {
        "content": "<p>Also thanks for explaining that the translation is called <strong>elaboration</strong> - not <strong>evaluation</strong>.</p>\n<p>Is <strong>evaluation</strong> terminology strictly for pure lambda calculus programs?</p>",
        "id": 496863837,
        "sender_full_name": "rzeta0",
        "timestamp": 1738269418
    },
    {
        "content": "<p>the subtlety here lies in what precisely is being evaluated, i guess</p>",
        "id": 496864033,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1738269496
    },
    {
        "content": "<p>because the elaboration process does involve executing code and evaluating functions</p>",
        "id": 496864142,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1738269547
    },
    {
        "content": "<p>Elementary set theory is easier in Lean than algebra.  Here are a couple of simple set theory theorems that give fairly simple proof terms:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">my_lemma3</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"bp\">∩</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h3</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"n\">h3</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h5</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"n\">h3</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">And</span><span class=\"bp\">.</span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h4</span><span class=\"w\"> </span><span class=\"n\">h5</span>\n\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">my_lemma3</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">my_lemma4</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h3</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"n\">hA</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">hB</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h3</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"n\">hA</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"n\">hB</span>\n\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">my_lemma4</span>\n</code></pre></div>",
        "id": 496892691,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1738282328
    },
    {
        "content": "<p>Thanks Dan - that is helpful.</p>\n<p>Those term proofs are remarkable simple compared to the algebra examples.</p>",
        "id": 496974346,
        "sender_full_name": "rzeta0",
        "timestamp": 1738319168
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> has marked this topic as resolved.</p>",
        "id": 496974368,
        "sender_full_name": "Notification Bot",
        "timestamp": 1738319174
    },
    {
        "content": "<p>If you want to emphasize readability, I suggest looking into <code>calc</code> – which doesn't help with the underlying terms, but does make explicit the intermediate types.</p>",
        "id": 497150443,
        "sender_full_name": "Chris Wong",
        "timestamp": 1738403951
    }
]