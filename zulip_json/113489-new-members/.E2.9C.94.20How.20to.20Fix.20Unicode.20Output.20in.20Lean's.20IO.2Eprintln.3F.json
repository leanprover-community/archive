[
    {
        "content": "<p>I am trying to use <code>IO.println</code> to output Chinese characters, but when I run <code>lean --run main.lean</code>, the output is garbled. For some other languages, the result is also garbled when executed in the command line. However, when I use <code>#eval main</code>, the output in the Info View is fine.</p>\n<p>Here is my Lean code:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"你好，世界！\"</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"Hello, World!\"</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"Bonjour, le monde!\"</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"Hola, Mundo!\"</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"Ciao, Mondo!\"</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"Hallo, Welt!\"</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"&Pcy;&rcy;&icy;&vcy;&iecy;&tcy;, &mcy;&icy;&rcy;!\"</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"こんにちは、世界！\"</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"안녕하세요, 세계!\"</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"Merhaba, D&uuml;nya!\"</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"Saluton, Mondo!\"</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"Hej, v&auml;rlden!\"</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"Zdravo, svete!\"</span>\n</code></pre></div>\n<p>Here is the output from the <code>cmd</code>:</p>\n<div class=\"codehilite\" data-code-language=\"cmd\"><pre><span></span><code>C:\\Projects\\Lean-Meta-Programming&gt;lean --run Src/main.lean\n浣犲ソ锛屼笘鐣岋紒\nHello, World!\nBonjour, le monde!\nHola, Mundo!\nCiao, Mondo!\nHallo, Welt!\n袩褉懈胁械褌, 屑懈褉!\n銇撱倱銇仭銇&euro;佷笘鐣岋紒\n鞎堧厱頃橃劯鞖? 靹戈硠!\nMerhaba, D眉nya!\nSaluton, Mondo!\nHej, v盲rlden!\nZdravo, svete!\n\nC:\\Projects\\Lean-Meta-Programming&gt;\n</code></pre></div>\n<p>The same thing happens with PowerShell and Git Bash.</p>\n<p>Here are the versions of Lean and other tools I am using:</p>\n<div class=\"codehilite\" data-code-language=\"psh\"><pre><span></span><code>PS C:\\Projects\\Lean-Meta-Programming&gt; lean --version\nLean (version 4.11.0-rc2, x86_64-w64-windows-gnu, commit 0edf1bac392f, Release)\nPS C:\\Projects\\Lean-Meta-Programming&gt; lake --version\nLake version 5.0.0-0edf1ba (Lean version 4.11.0-rc2)\nPS C:\\Projects\\Lean-Meta-Programming&gt; elan --version\nelan 3.1.1 (71ddc6633 2024-02-22)\n</code></pre></div>\n<p>My operating system is <code>Windows 11, version 23H2 (KB5042099)</code>. By the way, everything works fine when I use <code>IO.FS.writeFile</code> to write Chinese characters to a file.</p>\n<p><a href=\"/user_uploads/3121/U5bpzhHI8VMFT-1x2RNgFCTo/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/U5bpzhHI8VMFT-1x2RNgFCTo/image.png\" title=\"image.png\"><img data-original-dimensions=\"1871x1140\" src=\"/user_uploads/thumbnail/3121/U5bpzhHI8VMFT-1x2RNgFCTo/image.png/840x560.webp\"></a></div>",
        "id": 464358527,
        "sender_full_name": "White Chen",
        "timestamp": 1724329625
    },
    {
        "content": "<p>Could it be that the font in your shell is simply not capable of showing these character sets properly?</p>",
        "id": 464359832,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1724329981
    },
    {
        "content": "<p>It works here, which I think suggests lean is confused about your terminal encoding</p>",
        "id": 464359895,
        "sender_full_name": "Julian Berman",
        "timestamp": 1724330003
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span> What terminal is \"here\"?</p>",
        "id": 464360053,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1724330052
    },
    {
        "content": "<p>When you write the content to a file and print the content with say <code>type file.txt</code> do you get the right output or the same as lean? <span class=\"user-mention\" data-user-id=\"670422\">@sdzz gndrc</span></p>",
        "id": 464360118,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1724330073
    },
    {
        "content": "<p>Can you try outputting the same bytes via Python, the code to do it is:</p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"nb\">print</span><span class=\"p\">(</span>\n<span class=\"sd\">\"\"\"</span>\n<span class=\"sd\">你好，世界！</span>\n<span class=\"sd\">Hello, World!</span>\n<span class=\"sd\">Bonjour, le monde!</span>\n<span class=\"sd\">Hola, Mundo!</span>\n<span class=\"sd\">Ciao, Mondo!</span>\n<span class=\"sd\">Hallo, Welt!</span>\n<span class=\"sd\">Привет, мир!</span>\n<span class=\"sd\">こんにちは、世界！</span>\n<span class=\"sd\">안녕하세요, 세계!</span>\n<span class=\"sd\">Merhaba, Dünya!</span>\n<span class=\"sd\">Saluton, Mondo!</span>\n<span class=\"sd\">Hej, världen!</span>\n<span class=\"sd\">Zdravo, svete!</span>\n<span class=\"sd\">\"\"\"</span>\n<span class=\"p\">)</span>\n</code></pre></div>",
        "id": 464360125,
        "sender_full_name": "Julian Berman",
        "timestamp": 1724330075
    },
    {
        "content": "<p>That also works mhm</p>",
        "id": 464360151,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1724330088
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110024\">Sebastian Ullrich</span> <a href=\"#narrow/stream/113489-new-members/topic/How.20to.20Fix.20Unicode.20Output.20in.20Lean's.20IO.2Eprintln.3F/near/464360053\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"321696\">Julian Berman</span> What terminal is \"here\"?</p>\n</blockquote>\n<p>Not windows (kitty on macOS)</p>",
        "id": 464360152,
        "sender_full_name": "Julian Berman",
        "timestamp": 1724330088
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"670422\">@sdzz gndrc</span> In general I assume the new Windows Terminal has the most robust Unicode support</p>",
        "id": 464360213,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1724330110
    },
    {
        "content": "<p>Running <code>chcp 65001</code> first in cmd may also fix it but that's a bit of a band-aid</p>",
        "id": 464360469,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1724330176
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/UqcZBIG8T78Crch2gWj6vOe-/image.png\">image.png</a><br>\nAlright, it really has nothing to do with Lean.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/UqcZBIG8T78Crch2gWj6vOe-/image.png\" title=\"image.png\"><img data-original-dimensions=\"590x1021\" src=\"/user_uploads/thumbnail/3121/UqcZBIG8T78Crch2gWj6vOe-/image.png/840x560.webp\"></a></div>",
        "id": 464360478,
        "sender_full_name": "White Chen",
        "timestamp": 1724330180
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"670422\">sdzz gndrc</span> has marked this topic as resolved.</p>",
        "id": 464360581,
        "sender_full_name": "Notification Bot",
        "timestamp": 1724330226
    }
]