[
    {
        "content": "<p>The recent 4.9.0 update causes me enough problem to need wiping and restoring from backups.</p>\n<p>Both <code>lean-toolchain</code> and <code>lakefile.lean</code> specific which version of lean I want. This seems wrong, especially if they conflict (as happened with the update).</p>\n<p><code>lean-toolchain</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>leanprover/lean4:v4.9.0\n</code></pre></div>\n<p><code>lakefile.lean</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>require mathlib from git\n  \"https://github.com/leanprover-community/mathlib4.git\" @ \"v4.9.0\"\n</code></pre></div>\n<p>This latter entry didn't have the specific version specified and it all worked fine for weeks, until the update was announced and I was recommended to. update the lean-toolchain.</p>\n<p><strong>Question:</strong> Is there a good reason for two versions of the truth, which as we have seen can conflict?</p>",
        "id": 448792235,
        "sender_full_name": "rzeta0",
        "timestamp": 1719996840
    },
    {
        "content": "<p>The latter entry is just a reference to which branch of the target project (here mathlib) to use. Compiling a branch with the wrong version of lean is unlikely to work. It just so happens that mathlib (and several other projects) create tags/branches named after the lean versions they are targeting, and someday lake might get special support for this naming convention so you don't need to repeat yourself</p>",
        "id": 448803590,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1719999958
    },
    {
        "content": "<p>if lean-toolchain says 4.9.0 then not specifying version/branch in wakeful.lean gets the latest RC - which I feel is wrong, but I know others disagree.</p>\n<p>developers should have the inconvenience of adding \"-rc\", normal users should have the easy path</p>\n<p>(imho)</p>",
        "id": 448823581,
        "sender_full_name": "rzeta0",
        "timestamp": 1720005915
    },
    {
        "content": "<p>sure, I don't disagree, I'm just relaying the situation</p>",
        "id": 448828387,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1720007701
    },
    {
        "content": "<p>the fact that <code>lake update</code> fails to work to update on pretty much every stable is a major issue which I think the devs are aware of</p>",
        "id": 448828595,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1720007767
    },
    {
        "content": "<p>this is caused by the fact that lean-toolchain is only second-class supported by lake, even though it is critical to lake's functionality because it determines which <code>lake</code> will run</p>",
        "id": 448828686,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1720007809
    },
    {
        "content": "<p>thanks - and i guess it is voices like ours that push it up the priority list</p>",
        "id": 448829002,
        "sender_full_name": "rzeta0",
        "timestamp": 1720007919
    },
    {
        "content": "<p>My <code>lakefile.lean</code> is:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">...</span>\n<span class=\"n\">require</span><span class=\"w\"> </span><span class=\"n\">batteries</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"s2\">\"git@github.com:leanprover-community/batteries.git\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"v{Lean.versionString}\"</span>\n<span class=\"bp\">...</span>\n</code></pre></div>\n<p>Maybe it would be helpful for the issue?</p>",
        "id": 448831215,
        "sender_full_name": "fonqL",
        "timestamp": 1720008430
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"658953\">@fonqL</span>  I think your suggestion will help many others. For me, having read that even stable updates may break code, I think I will pin it to 4.9.0 and only manually upgrade of I have the time to recheck all my future content.</p>",
        "id": 448837505,
        "sender_full_name": "rzeta0",
        "timestamp": 1720010245
    }
]