[
    {
        "content": "<p>I'm continuing my experiments by picking a lemma and trying to apply it.</p>\n<p>The following is incomplete code, using <code> IsSquare.not_prime</code> documented here: <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Associated/Basic.html#IsSquare.not_prime\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Associated/Basic.html#IsSquare.not_prime</a></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n\n<span class=\"c1\">-- IsSquare.not_prime</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">9</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">Prime</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsSquare</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">dsimp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsSquare</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"mi\">3</span>\n<span class=\"w\">  </span><span class=\"c1\">-- to fil in</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">IsSquare</span><span class=\"bp\">.</span><span class=\"n\">not_prime</span><span class=\"w\"> </span><span class=\"n\">h1</span>\n</code></pre></div>\n<p>Looking at the signature for <code>IsSquare.not_prime</code> :</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">CancelCommMonoidWithZero</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">}</span><span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsSquare</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"n\">Prime</span><span class=\"w\"> </span><span class=\"n\">a</span>\n</code></pre></div>\n<p>I can see I need to provide <code>(ha: IsSquare a)</code> to <code>IsSquare.not_prime</code>. That is what my <code>h1</code> is attempting to prepare.</p>\n<p>The <code>dsimp [IsSquare]</code> shows, as expected, the goal state:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n<span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">9</span>\n<span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">r</span>\n</code></pre></div>\n<p>So I would naturally use <code>use 3</code>.  Instead of resolving the goal, or needed a <code>norm_num</code> to complete <code>9=3*3</code>, the goal state is:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n<span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">9</span>\n<span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n</code></pre></div>\n<p>This is something new to me. Why is the goal <code>⊢ ℕ</code> and how to I resolve it?</p>",
        "id": 475849321,
        "sender_full_name": "rzeta0",
        "timestamp": 1728477533
    },
    {
        "content": "<p>That means you need to provide some natural number rather than a proof. Do you see this when you put the cursor after <code>3</code>?</p>",
        "id": 475849905,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728477681
    },
    {
        "content": "<hr>\n<p>actually the following appears complete because Lean is showing no errors or warnings:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">9</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">Prime</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsSquare</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">dsimp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsSquare</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"mi\">3</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">IsSquare</span><span class=\"bp\">.</span><span class=\"n\">not_prime</span><span class=\"w\"> </span><span class=\"n\">h1</span>\n</code></pre></div>\n<p>I'm still puzzled about:</p>\n<ul>\n<li>why <code>⊢ ℕ</code> appears in the info view after <code>use 3</code></li>\n<li>why <code>⊢ IsSquare</code> appears in the info view after <code>apply IsSquare.not_prime h1</code></li>\n</ul>",
        "id": 475849992,
        "sender_full_name": "rzeta0",
        "timestamp": 1728477701
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"307953\">@Ruben Van de Velde</span> the cursor after <code>3</code> shows</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n<span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">9</span>\n<span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n</code></pre></div>",
        "id": 475850373,
        "sender_full_name": "rzeta0",
        "timestamp": 1728477769
    },
    {
        "content": "<p>Indeed. It's showing that your <code>3</code> solves a \"goal\" of type <code>ℕ</code>. I'm not sure if this will help, but this puts you in a place where you do actually have such a goal:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n\n<span class=\"c1\">-- IsSquare.not_prime</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">9</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">Prime</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsSquare</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">dsimp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsSquare</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">x</span>\n<span class=\"w\">    </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"mi\">3</span>\n<span class=\"w\">    </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">norm_num</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">done</span>\n<span class=\"w\">  </span><span class=\"c1\">-- to fil in</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">IsSquare</span><span class=\"bp\">.</span><span class=\"n\">not_prime</span><span class=\"w\"> </span><span class=\"n\">h1</span>\n</code></pre></div>",
        "id": 475850940,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728477894
    },
    {
        "content": "<p>In this case, you say \"I'll use some natural number, and leave me a goal (called \"x\") to tell  you what it is\", and then you can solve the goal with <code>exact 3</code></p>",
        "id": 475851450,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728477984
    },
    {
        "content": "<p>Thanks for trying to help Ruben. </p>\n<p>I don't know about <code>?x</code> or <code>case</code> yet so let me try to step through my thinking, focusing only on <code>h1</code>, to see where my misunderstanding is:</p>\n<ul>\n<li>\n<p><code>have h1: IsSquare a := by</code> means I want to create an intermediate result called <code>h1</code> which states that <code>IsSquare a</code>. Of course I need to justify this, so we do this next.</p>\n</li>\n<li>\n<p><code>dsimp [IsSquare]</code> simply explains what the <code>IsSquare a</code> means by replacing the name with its definition. The info view says the following, which makes sense to me.</p>\n</li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n<span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">9</span>\n<span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">r</span>\n</code></pre></div>\n<ul>\n<li>I have learned in the course i am following that to resolve <code>⊢ ∃ r, a = r * r</code> I simply need to prove an example. Here <code>3</code> is the correct example. So I use <code>use 3</code>. This should replace the goal with one that has <code>r</code> instantiated with <code>3</code>.</li>\n</ul>\n<p>I would expect:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n<span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">9</span>\n<span class=\"bp\">⊢</span><span class=\"w\">  </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"mi\">3</span>\n</code></pre></div>\n<p>but instead I get </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n<span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">9</span>\n<span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n</code></pre></div>\n<p>So I think mhe misunderstanding has been narrowed down to why <code>⊢ ℕ</code> and not <code>⊢ a = 3 * 3</code>.</p>",
        "id": 475854648,
        "sender_full_name": "rzeta0",
        "timestamp": 1728478563
    },
    {
        "content": "<p>The <code>use</code> tactic automatically closes the goal <code>a = 3 * 3</code>. The <code>⊢ ℕ</code> part is not in the \"tactic state\" window which prints \"No goals\" when putting the cursor after <code>use 3</code>, but in the \"expected type\" window. I'm not sure what this window displays actually because I always hide it, I don't think it's very useful.</p>",
        "id": 475855758,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1728478749
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"703970\">@Etienne Marion</span>  - yes, you're correct! It is \"Expected type\", I didn't spot that.</p>\n<p>So the following seems correct and complete:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">9</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">Prime</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsSquare</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">dsimp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsSquare</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"mi\">3</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">IsSquare</span><span class=\"bp\">.</span><span class=\"n\">not_prime</span><span class=\"w\"> </span><span class=\"n\">h1</span>\n</code></pre></div>",
        "id": 475856538,
        "sender_full_name": "rzeta0",
        "timestamp": 1728478899
    },
    {
        "content": "<p>This is one of the reasons why I hide \"Expected type\", because sometimes it gives me the feeling that the proof is not over while it is.</p>",
        "id": 475856841,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1728478951
    },
    {
        "content": "<p>Actually as a follow up <span class=\"user-mention\" data-user-id=\"703970\">@Etienne Marion</span> do you know why I didn't need to go further after <code>use 3</code> and show <code>9 = a = 3 *3</code>. </p>\n<p>I would have expected to <code>rw [h]</code>, or use <code>h: a = 9</code> somehow, at some point in the proof.</p>\n<p>In fact it now worries me that I didn't need to.</p>",
        "id": 475857035,
        "sender_full_name": "rzeta0",
        "timestamp": 1728479003
    },
    {
        "content": "<p>Personally, \"Expected type\" is the single most useful view for my workflow of constructing proof terms, and I would rather have all other views disappear!</p>",
        "id": 475857287,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1728479047
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> <a href=\"#narrow/stream/113489-new-members/topic/how.20to.20.20resolve.20.E2.8A.A2.20.E2.84.95.20.3F/near/475857035\">said</a>:</p>\n<blockquote>\n<p>Actually as a follow up <span class=\"user-mention silent\" data-user-id=\"703970\">Etienne Marion</span> do you know why I didn't need to go further after <code>use 3</code> and show <code>9 = a = 3 *3</code>. </p>\n<p>I would have expected to <code>rw [h]</code>, or use <code>h: a = 9</code> somehow, at some point in the proof.</p>\n<p>In fact it now worries me that I didn't need to.</p>\n</blockquote>\n<p>This is because the tactic <code>use</code> does more than just providing the candidate, it also tries to close the goal with some simple methods (I don't know exactly which, but for example I think it automatically closes if the new goal is part of the hypotheses)</p>",
        "id": 475857944,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1728479190
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> has marked this topic as resolved.</p>",
        "id": 475858614,
        "sender_full_name": "Notification Bot",
        "timestamp": 1728479319
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 475859461,
        "sender_full_name": "rzeta0",
        "timestamp": 1728479469
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/stream/113489-new-members/topic/.E2.9C.94.20how.20to.20.20resolve.20.E2.8A.A2.20.E2.84.95.20.3F/near/475857287\">said</a>:</p>\n<blockquote>\n<p>Personally, \"Expected type\" is the single most useful view for my workflow of constructing proof terms, and I would rather have all other views disappear!</p>\n</blockquote>\n<p>Can you tell me how you use it please? As I said I'm not sure what it does</p>",
        "id": 475860433,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1728479686
    },
    {
        "content": "<p>my understanding is that it usually shows the type of the term your text cursor is next to.</p>",
        "id": 475907790,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1728489966
    }
]