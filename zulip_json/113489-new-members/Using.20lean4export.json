[
    {
        "content": "<p>I am having trouble running lean4export; I believe I have it installed properly and I can't understand the code well enough to diagnose it myself. </p>\n<p>I have a build of mathlib with this dependency installed: <a href=\"https://github.com/leanprover/lean4export\">https://github.com/leanprover/lean4export</a></p>\n<p>I have imported  the mathlib libraries that I want to export by calling them in the header of the Export.lean file. Although, whenever I run \"lake exe lean4export\" I get the error citing lean4export/Main.lean at lines 7 and 8:</p>\n<p>\"application type mismatch<br>\n  importModules imports<br>\nargument<br>\n  imports<br>\nhas type<br>\n  List ?m.237 : Type<br>\nbut is expected to have type<br>\n  Array Import : TypeLean 4\"</p>\n<p>I want am not sure whether I am using the package properly or if there is a bug. Please let me know if you know how to run lean4export.</p>",
        "id": 405003816,
        "sender_full_name": "Philip Stetson",
        "timestamp": 1701314195
    },
    {
        "content": "<p>You could try running the branch in <a href=\"https://github.com/leanprover/lean4export/pull/2/\">https://github.com/leanprover/lean4export/pull/2/</a>, I also cant work out how to use that version of export with a newer library. <span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span> do you plan to merge such updates into lean4export or do you have advice how to set the paths correctly to make this work as is</p>",
        "id": 405178301,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1701369872
    },
    {
        "content": "<p>I bumped lean4export to <code>4.3.0</code></p>",
        "id": 405263517,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1701401308
    },
    {
        "content": "<p>Hi,</p>\n<p>I'm trying to get lean4export working on a new Lean 4 repo. There aren't really instructions there for how to install / use it (maybe this is just obvious to people who use lake a lot?) so I added the following and rebuilt, but I get an error.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">[[</span><span class=\"n\">lean_exe</span><span class=\"o\">]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"lean4export\"</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/leanprover/lean4export\"</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"master\"</span>\n</code></pre></div>\n<p>I assume I need to copy / build the code inside my repo somehow?</p>",
        "id": 493200851,
        "sender_full_name": "Twm Stone",
        "timestamp": 1736697973
    },
    {
        "content": "<p>When you ask for help with an error, it's helpful to say what the error is</p>",
        "id": 493201167,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1736698283
    },
    {
        "content": "<p>gah sorry I pressed &lt;enter&gt; before pasting</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">base</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">tops</span><span class=\"bp\">@</span><span class=\"n\">TOPS</span><span class=\"o\">:</span><span class=\"bp\">~/</span><span class=\"n\">test4export</span><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">lean4export</span>\n<span class=\"bp\">✖</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"mi\">4</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">lean4export</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">file</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././././</span><span class=\"n\">lean4export</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"bp\">✖</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">3</span><span class=\"bp\">/</span><span class=\"mi\">4</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">lean4export</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">file</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././././</span><span class=\"n\">lean4export</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">lean4export</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">lean4export</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n</code></pre></div>",
        "id": 493201412,
        "sender_full_name": "Twm Stone",
        "timestamp": 1736698502
    },
    {
        "content": "<p>I also tried checking out the lean4export repository and running <code>lake build</code> in there; this means <code>lake exe lean4export ../path/to/my/repo</code> does \"work\" but has this error instead, and conceptually this seems a bit wrong (running it from outside the project I want to affect) so I didn't pursue that further:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">base</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">tops</span><span class=\"bp\">@</span><span class=\"n\">TOPS</span><span class=\"o\">:</span><span class=\"bp\">~/</span><span class=\"n\">lean4export</span><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">lean4export</span><span class=\"w\"> </span><span class=\"bp\">../</span><span class=\"n\">test4export</span><span class=\"bp\">/</span>\n<span class=\"n\">PANIC</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"bp\">.</span><span class=\"n\">get!</span><span class=\"w\"> </span><span class=\"n\">Init</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Option</span><span class=\"bp\">.</span><span class=\"n\">BasicAux</span><span class=\"o\">:</span><span class=\"mi\">16</span><span class=\"o\">:</span><span class=\"mi\">14</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">none</span>\n<span class=\"n\">backtrace</span><span class=\"o\">:</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">lean4export</span><span class=\"o\">(</span><span class=\"n\">lean_panic_fn</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x6d</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x5597b5d4f03d</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">lean4export</span><span class=\"o\">(</span><span class=\"n\">l_Array_mapMUnsafe_map___at_main___spec__2</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x129</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x5597b1dfdb49</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">lean4export</span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"n\">lean_main</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x1d4</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x5597b1dff444</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">lean4export</span><span class=\"o\">(</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">xedcde3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x5597b1dffde3</span><span class=\"o\">]</span>\n<span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">x86_64</span><span class=\"bp\">-</span><span class=\"n\">linux</span><span class=\"bp\">-</span><span class=\"n\">gnu</span><span class=\"bp\">/</span><span class=\"n\">libc</span><span class=\"bp\">.</span><span class=\"n\">so</span><span class=\"bp\">.</span><span class=\"m\">6</span><span class=\"o\">(</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x2a1ca</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x7f92bfc5d1ca</span><span class=\"o\">]</span>\n<span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">x86_64</span><span class=\"bp\">-</span><span class=\"n\">linux</span><span class=\"bp\">-</span><span class=\"n\">gnu</span><span class=\"bp\">/</span><span class=\"n\">libc</span><span class=\"bp\">.</span><span class=\"n\">so</span><span class=\"bp\">.</span><span class=\"m\">6</span><span class=\"o\">(</span><span class=\"bp\">__</span><span class=\"n\">libc_start_main</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x8b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x7f92bfc5d28b</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">lean4export</span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"n\">start</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x25</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x5597b1dfd7a5</span><span class=\"o\">]</span>\n<span class=\"n\">uncaught</span><span class=\"w\"> </span><span class=\"n\">exception</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">trying</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">anonymous</span><span class=\"w\"> </span><span class=\"n\">name</span>\n</code></pre></div>",
        "id": 493201563,
        "sender_full_name": "Twm Stone",
        "timestamp": 1736698633
    },
    {
        "content": "<p>The readme says the executable takes a sequence of modules (i.e. <code>.olean</code> files), not a directory</p>",
        "id": 493204283,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1736701061
    },
    {
        "content": "<p>When I try that I get the same error around anonymous names:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">base</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">tops</span><span class=\"bp\">@</span><span class=\"n\">TOPS</span><span class=\"o\">:</span><span class=\"bp\">~/</span><span class=\"n\">lean4export</span><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">lean4export</span><span class=\"w\"> </span><span class=\"bp\">../</span><span class=\"n\">test4export</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Main</span><span class=\"bp\">.</span><span class=\"n\">olean</span>\n<span class=\"n\">PANIC</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"bp\">.</span><span class=\"n\">get!</span><span class=\"w\"> </span><span class=\"n\">Init</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Option</span><span class=\"bp\">.</span><span class=\"n\">BasicAux</span><span class=\"o\">:</span><span class=\"mi\">16</span><span class=\"o\">:</span><span class=\"mi\">14</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">none</span>\n<span class=\"n\">backtrace</span><span class=\"o\">:</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">lean4export</span><span class=\"o\">(</span><span class=\"n\">lean_panic_fn</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x6d</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x5572f212a43d</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">lean4export</span><span class=\"o\">(</span><span class=\"n\">l_Array_mapMUnsafe_map___at_main___spec__2</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x129</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x5572ee1d8cc9</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">lean4export</span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"n\">lean_main</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x1d4</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x5572ee1da5c4</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">lean4export</span><span class=\"o\">(</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">xedcfa3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x5572ee1dafa3</span><span class=\"o\">]</span>\n<span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">x86_64</span><span class=\"bp\">-</span><span class=\"n\">linux</span><span class=\"bp\">-</span><span class=\"n\">gnu</span><span class=\"bp\">/</span><span class=\"n\">libc</span><span class=\"bp\">.</span><span class=\"n\">so</span><span class=\"bp\">.</span><span class=\"m\">6</span><span class=\"o\">(</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x2a1ca</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x7f81bc7631ca</span><span class=\"o\">]</span>\n<span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">x86_64</span><span class=\"bp\">-</span><span class=\"n\">linux</span><span class=\"bp\">-</span><span class=\"n\">gnu</span><span class=\"bp\">/</span><span class=\"n\">libc</span><span class=\"bp\">.</span><span class=\"n\">so</span><span class=\"bp\">.</span><span class=\"m\">6</span><span class=\"o\">(</span><span class=\"bp\">__</span><span class=\"n\">libc_start_main</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x8b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x7f81bc76328b</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">lean4export</span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"n\">start</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x25</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x5572ee1d8925</span><span class=\"o\">]</span>\n<span class=\"n\">uncaught</span><span class=\"w\"> </span><span class=\"n\">exception</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">trying</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">anonymous</span><span class=\"w\"> </span><span class=\"n\">name</span>\n</code></pre></div>",
        "id": 493204756,
        "sender_full_name": "Twm Stone",
        "timestamp": 1736701418
    },
    {
        "content": "<p>actually I get the same thing when I try export an olean file in the project itself, e.g. <code>lake exe lean4export .lake/build/lib/Thing.olean</code> is complaining about trying to import module with anonymous name</p>",
        "id": 493207225,
        "sender_full_name": "Twm Stone",
        "timestamp": 1736703461
    }
]