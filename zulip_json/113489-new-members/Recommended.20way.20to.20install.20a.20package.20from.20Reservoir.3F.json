[
    {
        "content": "<p>What is the recommended method to install a package from Reservoir (<a href=\"https://reservoir.lean-lang.org/\">https://reservoir.lean-lang.org</a>) using the command line?</p>\n<p>And how should it be done within VS Code (with the Lean extension installed)?</p>\n<p>For example, if you have a Reservoir package named <code>foo</code>, is there a command equivalent to <code>pip install foo</code> in the Python world?</p>\n<p>Currently, I'm using the following approach:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">echo</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"o\">[[</span><span class=\"n\">require</span><span class=\"o\">]]</span><span class=\"bp\">'</span><span class=\"w\"> </span><span class=\"bp\">&gt;&gt;</span><span class=\"w\"> </span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">toml</span>\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">echo</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"&lt;foo&gt;\"</span><span class=\"bp\">'</span><span class=\"w\"> </span><span class=\"bp\">&gt;&gt;</span><span class=\"w\"> </span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">toml</span>\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">echo</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"&lt;some git repo for foo&gt;\"</span><span class=\"bp\">'</span><span class=\"w\"> </span><span class=\"bp\">&gt;&gt;</span><span class=\"w\"> </span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">toml</span>\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">foo</span>\n</code></pre></div>",
        "id": 502326241,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1740673491
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/blob/3e942f26546ce9e0fadb5b24dcf51fa2b00cb77d/src/lake/README.md\">The current readme</a> doesn't mention a CLI command for this. I don't think it's possible as of today</p>",
        "id": 502327463,
        "sender_full_name": "Arthur Paulino",
        "timestamp": 1740673815
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/issues/5453\">https://github.com/leanprover/lean4/issues/5453</a> is I think the relevant issue to follow. I'll just note though that in the interim there's no reason to run multiple shell commands, you can just do it all at once.</p>",
        "id": 502327743,
        "sender_full_name": "Julian Berman",
        "timestamp": 1740673889
    },
    {
        "content": "<p>I read the Lake <code>README.md</code> and if I understand it correct the way to install a Reservoir package <code>@bar/foo</code> the recommended way would be:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">echo</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"o\">[[</span><span class=\"n\">require</span><span class=\"o\">]]</span><span class=\"bp\">';</span><span class=\"w\"> </span><span class=\"n\">echo</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"foo\"</span><span class=\"bp\">';</span><span class=\"w\"> </span><span class=\"n\">echo</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">scope</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"bar\"</span><span class=\"bp\">'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">&gt;&gt;</span><span class=\"w\"> </span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">toml</span>\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">foo</span>\n</code></pre></div>\n<p>Sounds about right?</p>",
        "id": 502344263,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1740678678
    },
    {
        "content": "<p>Sorry I was just pointing out a silly shell thing, there's nothing wrong with what you have -- what I meant was you can just do:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>%<span class=\"w\"> </span>&gt;&gt;lakefile.toml<span class=\"w\"> </span><span class=\"nb\">printf</span><span class=\"w\"> </span><span class=\"s1\">'</span>\n\n<span class=\"s1\">[[require]]</span>\n<span class=\"s1\">name = \"bar\"</span>\n<span class=\"s1\">scope = \"baz\"</span>\n<span class=\"s1\">'</span>\n</code></pre></div>\n<p>(or <code>echo</code> if you prefer.) and that looks a bit more \"normal\".</p>\n<p>Or even if you're really annoyed by this:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>lake-add<span class=\"o\">()</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span>&gt;&gt;lakefile.toml<span class=\"w\"> </span><span class=\"nb\">printf</span><span class=\"w\"> </span><span class=\"s1\">'\\n[[require]]\\nscope = \"'</span><span class=\"nv\">$1</span><span class=\"s1\">'\"\\nname = \"'</span><span class=\"nv\">$2</span><span class=\"s1\">'\"\\n'</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>\n<p>and then you can run <code>lake-add leanprover-community mathlib4</code>.</p>",
        "id": 502352515,
        "sender_full_name": "Julian Berman",
        "timestamp": 1740681462
    },
    {
        "content": "<p>I’m picturing something similar to <code>cargo install foo</code>, <code>pip install foo</code>, or <code>npm install foo</code>.</p>\n<p>Would it be useful to have a command like <code>lake install baz/bar</code> to install the Reservoir package <code>baz/bar</code> (it seems like Reservoir packages are always scoped)?</p>\n<p>And if so, does it make sense for the <code>install</code> subcommand to fall under the <code>lake</code> command, or is there a better place?</p>\n<p>In the simplest scenario, that command would do the equivalent of <code>(echo '[[require]]'; echo 'name = \"bar\"'; echo 'scope = \"baz\"') &gt;&gt; lakefile.toml &amp;&amp; lake update bar</code> (modulo idempotence).</p>",
        "id": 502462332,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1740699835
    },
    {
        "content": "<p>I'm not sure I see the relation between \"add a dependency\" and \"globally install a piece of software which happens to be written in Lean out of Reservoir\", but yes I'd bet both of those are on the roadmap. The former is the issue I linked. And the latter I think is somewhere on the issue tracker as well but I'm not finding it at the minute.</p>",
        "id": 502463934,
        "sender_full_name": "Julian Berman",
        "timestamp": 1740700763
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span> Oh, I'm specifically talking about \"add a dependency\" from Reservoir\" (which is the only case I've ever had a need for). </p>\n<p>I'm not entirely sure I understand: are you suggesting that <code>lake install baz/bar</code> would be \"globally install a piece of software which happens to be written in Lean out of Reservoir\"?</p>\n<p>If so, would <code>lake add baz/bar</code> be a more suitable command for \"add a dependency\"?</p>\n<p>(<strong>Update:</strong> I now realize that I wrote \"install the Reservoir package <code>baz/bar</code>\" in the previous message when I meant to say \"install locally in the repository as a dependency\" — or, more precisely, \"add as a dependency\". Sorry about that.)</p>",
        "id": 502511068,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1740727646
    },
    {
        "content": "<p>Got it, sorry, the confusing thing to me was that those 3 package manager commands do 3 slightly different things from \"add a dependency to the packaging manifest\" -- that'd be <code>cargo add</code>, <code>uv add</code> (pip doesn't have such a thing) and <code>pnpm add</code> (or fine <code>npm install --save</code> if you're using last month's package manager :)</p>",
        "id": 502672141,
        "sender_full_name": "Julian Berman",
        "timestamp": 1740779129
    },
    {
        "content": "<p>Anyways yeah I linked to the issue on <code>lake add</code>, you should thumbs up it, and I'm sure at some point it's on the agenda.</p>",
        "id": 502672156,
        "sender_full_name": "Julian Berman",
        "timestamp": 1740779143
    }
]