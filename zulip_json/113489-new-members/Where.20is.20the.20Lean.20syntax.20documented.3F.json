[
    {
        "content": "<p>I know it might sound like I'm trolling but I swear I'm not. I wanted to look up the <code>def ... where</code> syntax. In particular, I want to understand what you're supposed to put into <code>where</code> and what this style desugars to (if anything).</p>\n<p>I googled \"lean def where syntax\". One of the first hits is <a href=\"https://proofassistants.stackexchange.com/questions/2305/where-is-the-syntax-of-lean-4-documented\">someone asking</a> where Lean syntax is supposed to be documented â€” I'm glad I'm not alone. A recent answer suggests the place to look for is the <a href=\"https://lean-lang.org/doc/reference/latest/\">\"reference manual\"</a>.</p>\n<p>I go to the reference manual and type <code>where</code> in search. <a href=\"https://lean-lang.org/doc/reference/latest/Definitions/Definitions/#Lean___Parser___Command___declaration-next-next-next-next-next\">There is a hit!</a></p>\n<p><a href=\"/user_uploads/3121/z5QCjnWUidKmH4yj7hyIcRhm/Screenshot-2025-09-08-at-19.32.18.png\">Screenshot 2025-09-08 at 19.32.18.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/z5QCjnWUidKmH4yj7hyIcRhm/Screenshot-2025-09-08-at-19.32.18.png\" title=\"Screenshot 2025-09-08 at 19.32.18.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"906x802\" src=\"/user_uploads/thumbnail/3121/z5QCjnWUidKmH4yj7hyIcRhm/Screenshot-2025-09-08-at-19.32.18.png/840x560.webp\"></a></div><p>I press that, and land on this section:</p>\n<p><a href=\"/user_uploads/3121/E23QplRlfN6VuHC-lxM3SqRr/Screenshot-2025-09-08-at-19.32.40.png\">Screenshot 2025-09-08 at 19.32.40.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/E23QplRlfN6VuHC-lxM3SqRr/Screenshot-2025-09-08-at-19.32.40.png\" title=\"Screenshot 2025-09-08 at 19.32.40.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1762x1312\" src=\"/user_uploads/thumbnail/3121/E23QplRlfN6VuHC-lxM3SqRr/Screenshot-2025-09-08-at-19.32.40.png/840x560.webp\"></a></div><p>However, all I can find about <code>where</code> is this one sentence with grammar:</p>\n<p><a href=\"/user_uploads/3121/y6b-VcNxm74VVudh50ijVcLX/Screenshot-2025-09-08-at-19.34.53.png\">Screenshot 2025-09-08 at 19.34.53.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/y6b-VcNxm74VVudh50ijVcLX/Screenshot-2025-09-08-at-19.34.53.png\" title=\"Screenshot 2025-09-08 at 19.34.53.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1644x406\" src=\"/user_uploads/thumbnail/3121/y6b-VcNxm74VVudh50ijVcLX/Screenshot-2025-09-08-at-19.34.53.png/840x560.webp\"></a></div><p>Is this implied to be sufficient documentation on <code>where</code> for a language reference? Or is this page generally considered unfinished, and more work is planned to flesh it out? In the meantime, is there a location where I can learn what the syntax of <code>where</code> is, and what it desugars to (if anything)?</p>",
        "id": 538292752,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1757356683
    },
    {
        "content": "<p>I'm guessing that</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">field1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">value1</span>\n<span class=\"w\">  </span><span class=\"n\">field2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">value2</span>\n</code></pre></div>\n<p>is syntax sugar for</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">  </span><span class=\"n\">field1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">value1</span>\n<span class=\"w\">  </span><span class=\"n\">field2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">value2</span>\n<span class=\"o\">}</span>\n</code></pre></div>\n<p>Is that correct? If yes, would it be reasonable to add that to the docs?</p>",
        "id": 538294351,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1757357281
    },
    {
        "content": "<p>The concrete reason for how I ran into this is that I tried to use this <code>where</code> syntax inline (inside a <code>let</code>) and it didn't work, and I didn't know what it does so I got stuck.</p>",
        "id": 538294557,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1757357354
    },
    {
        "content": "<p>It seems your main question here is asking for confirmation about the syntax sugar: yes, correct, <code>where ...</code> is <code>:= { ... }</code>. Not to be confused for the <code>where</code> in <code>def f a b c := v where ...</code>, which instead is <code>def f a b c := let rec ...; v</code>.</p>\n<blockquote>\n<p>Is this implied to be sufficient documentation onÂ <code>where</code>Â for a language reference? Or is this page generally considered unfinished, and more work is planned to flesh it out?</p>\n</blockquote>\n<p>I don't believe you'll find answers to these questions here in <a class=\"stream\" data-stream-id=\"113489\" href=\"/#narrow/channel/113489-new-members\">#new members</a>. David Christiansen has been writing the language reference, and I think he doesn't frequent this channel. (Feel free to ping him.)</p>\n<p>If you need to know exactly what features are available, probably the most accurate way to find the available syntaxes is to search for <code>\"where</code> and <code>\" where</code> in the Lean source code; that will bring you to <code>Lean.Parser.Command.whereStructInst</code>, and then you can click around to work out the grammar. Anticipating your followup to that: yeah, that's not the intended way to learn Lean, but if you need the exact answers it's nice to know that it's available.</p>\n<p>There's also the Zulip search box. This is a significant part of the current Lean documentation. I relied on it heavily when learning Lean 3.</p>\n<p>I understand where come from with your questions, thinking about it from high-level product design and the experience of newcomers, but at least for me it'd be helpful if you'd separate focused technical questions from broader \"here's my user experience, is this how it's intended to go?\" discussion; unblocking you right now vs the meta question of how to not be blocked. The latter is broad and open-ended â€” and valuable â€”Â but it might be more effective in a separate topic, in GitHub issues, in write-ups of your experiences, etc. Or if writing out your experience helps you learn and you're ok with getting whatever engagement you get, that's fine too.</p>",
        "id": 538304739,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1757361284
    },
    {
        "content": "<p>Thanks! I'm sorry for mixing up rants and questions. I don't have the energy to channel rants into something more productive yet (like PRs) and I'm not sure where to direct them \"appropriately\". I think partially I'm just trying to get a temperature check on whether it's \"yes, this kinda sucks\" or more like \"no, we think this is how it should be\".</p>",
        "id": 538323620,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1757370424
    },
    {
        "content": "<blockquote>\n<p>If you need to know exactly what features are available, probably the most accurate way to find the available syntaxes is to search for <code>\"where</code> and <code>\" where</code> in the Lean source code</p>\n</blockquote>\n<p>To add to this, if you <code>import Lean</code> at the top of the file, 'Go to <em>declaration</em>' (not 'Go to definition') in VsCode will usually take you to the relevant syntax definition.</p>",
        "id": 538339612,
        "sender_full_name": "ğš ğš˜ğš“ğšŒğš’ğšğšŒğš‘ ğš—ğšŠğš ğš›ğš˜ğšŒğš”ğš’",
        "timestamp": 1757383978
    },
    {
        "content": "<p>Somehow <code>where</code> goes to structInst term syntax, not <code>where</code> <span class=\"user-mention\" data-user-id=\"128280\">@ğš ğš˜ğš“ğšŒğš’ğšğšŒğš‘ ğš—ğšŠğš ğš›ğš˜ğšŒğš”ğš’</span>. Maybe some macro expansion information is missing from the info trees?</p>",
        "id": 538447881,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1757427088
    }
]