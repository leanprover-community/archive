[
    {
        "content": "<p>Consider the following very simple, perhaps trivial, proof:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- Prove a &lt; c if we know a &lt; b and b ≤ c, where a,b,c ∈ ℕ.</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">calc</span>\n<span class=\"w\">    </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rel</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h1</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rel</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h2</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>We use the <code>rel</code> tactic to reason about hypotheses that are inequalities.</p>\n<p><strong>Question:</strong> What is the real reason we can't use the <code>rw</code> tactic and must use <code>rel</code> ?</p>\n<p>Is it because <code>rw</code> is a very simple tactic that only does <strong>syntactic replacement</strong> - that is, only performs a substitution if an exact pattern is matched - and does not perform additional checks such as ensuring monotonicity of the functions involved in a potential substitution?</p>",
        "id": 450593934,
        "sender_full_name": "rzeta0",
        "timestamp": 1720655570
    },
    {
        "content": "<p>No, as a general rule faulty tactics cannot break Lean's proof system/cannot be used to prove false; the kernel runs its own checks and a buggy tactic will fail if it can't prove the result sound. (There are of course much weaker guarantees on whether or not a tactic has in fact proven the thing you thought it was proving, of course, but that's a separate problem)</p>",
        "id": 450596346,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1720656781
    },
    {
        "content": "<p><code>rw</code> only handles <em>rewriting</em> using equalities and iffs. There's a notion of generalized rewriting for more general relations, but it's not as well-defined of a problem. It's not just about checking monotonicity, it would have to synthesize proofs of monotonicity and create \"congruence arguments\". This is what the <code>gcongr</code> tactic does (what mathlib calls the book's <code>rel</code>) given a particular goal to prove — having a LHS and RHS is useful for being able to solve for what the correct congruences should be.</p>\n<p>By the way, you definitely don't need tactics here. This is just transitivity of the hyptheses:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">calc</span>\n<span class=\"w\">    </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h1</span>\n<span class=\"w\">    </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h2</span>\n</code></pre></div>",
        "id": 450596719,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1720656898
    },
    {
        "content": "<p><code>rw</code> is simple, but it's able to do things that <code>rel</code> cannot, and vice versa.</p>",
        "id": 450597243,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1720657069
    }
]