[
    {
        "content": "<p>I am within a branch of a <code>by_cases</code> statement. I have as a hypothesis <code>A</code>, as a goal <code>B</code>, and have a theorem <code>A ∧ B → False</code>. Ideally, I would like to tell Lean to assume <code>B</code> and change my goal to <code>False</code>, then apply my theorem to show a contradiction. Is there a tactic for the first part of this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">exists_div_mod</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">q</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hq</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">IsPos</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"c1\">-- exercise</span>\n<span class=\"w\">  </span><span class=\"n\">revert</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">induction</span>\n<span class=\"w\">  </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\">                      </span><span class=\"c1\">-- base case: (n = 0), (m = 0), (r = 0) ⊢ 0 ≤ r &lt; q ∧ n = m * q + r</span>\n<span class=\"w\">    </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">    </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">le_refl</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\">               </span><span class=\"c1\">-- ⊢ 0 ≤ 0</span>\n<span class=\"w\">    </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span><span class=\"w\">               </span><span class=\"c1\">-- ⊢ 0 &lt; q</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">zero_add</span><span class=\"o\">]</span><span class=\"w\">          </span><span class=\"c1\">--         ⊢ 0 ≤ q</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">symm</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hq</span><span class=\"w\">                </span><span class=\"c1\">-- q.isPos ⊢ q ≠ 0</span>\n<span class=\"w\">    </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">zero_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">add_zero</span><span class=\"o\">]</span><span class=\"w\">       </span><span class=\"c1\">-- ⊢ 0 = 0 * q + 0</span>\n<span class=\"w\">  </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\">                    </span><span class=\"c1\">-- ind. case: ∃mr st. 0 ≤ r &lt; q ∧ n = m * q + r</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">m</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hrq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hnm</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\">   </span><span class=\"c1\">-- prove: ⊢ ∃ab, 0 ≤ b &lt; q ∧ n++ = a * q + b</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">succ_eq_succ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">add_succ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hnm</span>\n<span class=\"w\">    </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"bp\">++</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">++</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hnm</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">add_zero</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">zero_le</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">        </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">zero_le</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"bp\">++</span><span class=\"o\">)</span>\n<span class=\"w\">        </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">symm</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">succ_ne</span><span class=\"w\"> </span><span class=\"n\">r</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">succ_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hnm</span>\n<span class=\"w\">    </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"bp\">++</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">zero_le</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"bp\">++</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">tri</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">trichotomous</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"bp\">++</span><span class=\"o\">)</span>\n<span class=\"w\">        </span><span class=\"n\">rcases</span><span class=\"w\"> </span><span class=\"n\">tri</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">lt</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">gt</span>\n<span class=\"w\">        </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">gt_iff_lt</span><span class=\"o\">]</span>\n<span class=\"w\">          </span><span class=\"c1\">-- lt : q &lt; r++</span>\n<span class=\"w\">          </span><span class=\"c1\">-- goal : q &gt; r++</span>\n<span class=\"w\">          </span><span class=\"c1\">-- i have a theorem not_lt_of_gt : a &lt; b ∧ a &gt; b → False</span>\n<span class=\"w\">          </span><span class=\"gr\">sorry</span>\n<span class=\"w\">        </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">contradiction</span>\n<span class=\"w\">        </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">gt_iff_lt</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">gt</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hnm</span>\n</code></pre></div>\n<p>This is within a proof of Euclid's division lemma. The place I'd like to be able to do this is marked by the <code>sorry</code> above. I may have done something wrong to get to this state, but I think the reasoning as described above is sound? Thanks for any advice.</p>",
        "id": 532642113,
        "sender_full_name": "JJ",
        "timestamp": 1754281094
    },
    {
        "content": "<p>I can't run your example in the playground, but if you have a hypothesis <code>q &lt; r++</code> then proving <code>q &gt; r++</code> is impossible, since if it were true that would be a contradiction</p>",
        "id": 532649396,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1754285928
    },
    {
        "content": "<p>Yeah. That it is a contradiction is exactly what I want to show. I am in a branch of <code>by_cases</code> and one of my other cases is true, this one and another should lead to contradictions.</p>",
        "id": 532649448,
        "sender_full_name": "JJ",
        "timestamp": 1754285967
    },
    {
        "content": "<p>I mean, that's not how proof by contradiction works... if I have an assumption <code>A</code>, and I want to prove <code>¬A</code>, I can't say \"well if <code>¬A</code> were true then it would be a contradiction, therefore I can close the goal\"</p>",
        "id": 532649599,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1754286085
    },
    {
        "content": "<p>Why not?</p>",
        "id": 532649651,
        "sender_full_name": "JJ",
        "timestamp": 1754286112
    },
    {
        "content": "<p>well, let's say the assumption is <code>1 &lt; 2</code>... I think we can both agree that that's true</p>",
        "id": 532649695,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1754286149
    },
    {
        "content": "<p>now let's say my goal is <code>¬(1 &lt; 2)</code>... I don't think I can prove that using contradiction</p>",
        "id": 532649726,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1754286170
    },
    {
        "content": "<p>otherwise we would have just proved that 1 was not less than 2</p>",
        "id": 532649769,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1754286201
    },
    {
        "content": "<p>contradiction lets you prove a goal when you have an impossible set of assumptions, not when (or rather, not just because) the goal itself is impossible</p>",
        "id": 532649842,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1754286250
    },
    {
        "content": "<p>it would be kind of silly to say \"the conclusion I want to prove is contradicted by what I know is true, therefore it's a contradiction and I can now close the goal and prove the conclusion is true\"</p>",
        "id": 532649944,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1754286318
    },
    {
        "content": "<p>To answer your question directly, you are probably looking for the <code>by_contra h</code> tactic (defined in Batteries, so if you have no imports you'll probably need to import something) but like Matt Diamond said, it won't work in this case</p>",
        "id": 532650239,
        "sender_full_name": "Niels Voss",
        "timestamp": 1754286572
    },
    {
        "content": "<p>Hm. I'm struggling thinking through exactly why it doesn't work.</p>",
        "id": 532650264,
        "sender_full_name": "JJ",
        "timestamp": 1754286598
    },
    {
        "content": "<p>So in a normal use of <code>contradiction</code> you're saying, I can prove <code>False</code> from these hypotheses.</p>",
        "id": 532650427,
        "sender_full_name": "JJ",
        "timestamp": 1754286710
    },
    {
        "content": "<p>yes, if <em>both of them</em> are hypotheses... not when one of them is a goal</p>",
        "id": 532650481,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1754286737
    },
    {
        "content": "<p>I see how that is different from having <code>False</code> as a goal. You haven't proven it yet.</p>",
        "id": 532650482,
        "sender_full_name": "JJ",
        "timestamp": 1754286737
    },
    {
        "content": "<p>What do you do when you have <code>False</code> as a goal?</p>",
        "id": 532650518,
        "sender_full_name": "JJ",
        "timestamp": 1754286762
    },
    {
        "content": "<p>at that point you would need to find a contradiction using your hypotheses and relevant theorems</p>",
        "id": 532650591,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1754286817
    },
    {
        "content": "<p>Right, okay, I see now.</p>",
        "id": 532650613,
        "sender_full_name": "JJ",
        "timestamp": 1754286841
    },
    {
        "content": "<p>Finished the proof :-)</p>",
        "id": 532654382,
        "sender_full_name": "JJ",
        "timestamp": 1754288697
    },
    {
        "content": "<p>Guess I should take <code>False</code> in the goal and no obviously contradictory assumptions as a hint to backtrack. <span aria-label=\"thumbs up\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"thumbs up\">:thumbs_up:</span></p>",
        "id": 532654465,
        "sender_full_name": "JJ",
        "timestamp": 1754288742
    }
]