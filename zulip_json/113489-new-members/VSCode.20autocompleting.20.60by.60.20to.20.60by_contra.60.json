[
    {
        "content": "<p>Does anyone else run into the problem where VSCode is too eager to autocomplete <code>by</code> to <code>by_contra</code>? Is there a way to fix this?</p>",
        "id": 568349542,
        "sender_full_name": "Bbbbbbbbba",
        "timestamp": 1768533202
    },
    {
        "content": "<p>I also ran into this problem. I usually just use neovim which doesn't have this problem. Maybe it's possible to configure VSCode to disable autocompletion on clicking \"Enter\" and only autocomplete on \"Tab\" (or \"Ctrl+Y\" like in neovim :P).</p>",
        "id": 568350138,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1768533718
    },
    {
        "content": "<blockquote>\n<p>Maybe it's possible to configure VSCode to disable autocompletion on clicking \"Enter\" and only autocomplete on \"Tab\" (or \"Ctrl+Y\" like in neovim :P).</p>\n</blockquote>\n<p>Yes, I found this in vscode settings after complaining the same thing somewhere</p>",
        "id": 568350344,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1768533896
    },
    {
        "content": "<p>It is possible. But that is different from the underlying issue that vscode's first suggestion isn't <code>by</code> itself which would fix the issue. This is a recent problem</p>",
        "id": 568350360,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1768533914
    },
    {
        "content": "<p>Hm, is completion in VSCode smart enough to know that when I write e.g. <code>let abc&lt;cursor here&gt;</code> it knows that it shouldn't try to autocomplete <code>abc</code> (because it's a new identifier)?</p>",
        "id": 568350655,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1768534166
    },
    {
        "content": "<p>The completion collects suggestions from multiple sources, one of which is the LSP, and I think Lean is smart enough to know it isn't defined yet. But then there's also suggestions of existing words in the document, which will suggest <code>abc</code>, but it should be low in the list.</p>",
        "id": 568518223,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1768595339
    },
    {
        "content": "<p>This is what I usually get:</p>\n<p><a href=\"/user_uploads/3121/Tpjx9IFw5xuw9luISi9dQgZW/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/Tpjx9IFw5xuw9luISi9dQgZW/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"690x242\" src=\"/user_uploads/thumbnail/3121/Tpjx9IFw5xuw9luISi9dQgZW/image.png/840x560.webp\"></a></div><p>The \"abc\" logo next to them means they're just words collected from open documents and not from the LSP</p>",
        "id": 568518348,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1768595392
    },
    {
        "content": "<p>The solution is to have the LSP always suggest all of Lean's keywords, then they should beat these suggestions</p>",
        "id": 568518496,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1768595453
    },
    {
        "content": "<p>There is also the VS code option \"Editor:Â Word Based Suggestions\" that you can disable if you just don't want the \"abc\" suggestions</p>",
        "id": 568523942,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1768597688
    },
    {
        "content": "<p>We could make it smarter than just suggesting all possible keywords. It could only suggest keywords that make sense at where the cursor is. So in definition, after <code>:=</code>, that would be only keywords that are the beginning of some `term syntax.</p>",
        "id": 568530848,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1768600674
    },
    {
        "content": "<p>idk how to check which keywords make sense at a point, so adding all of them seems like a good start</p>",
        "id": 568537062,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1768604265
    },
    {
        "content": "<p>I think <a href=\"https://github.com/leanprover/lean4/blob/86da5ae26ea69856d701e7238b904e18d2dffde0/src/Lean/Server/Completion.lean#L31-L73\">this</a> is the function that suggests completion items</p>",
        "id": 568537081,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1768604278
    },
    {
        "content": "<p>Regardless, disabling autocompletion on Enter seems like a good idea. But maybe I'm biased because of what I'm used to.</p>",
        "id": 568537891,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1768604944
    },
    {
        "content": "<p>This was actually discussed on the mathlib channel where for a while mathlib forced this setting on you. The conclusion was that everybody has their own muscle memory and one person's preferences can't be forced onto another</p>",
        "id": 568543403,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1768609446
    },
    {
        "content": "<p>I have used autocomplete on enter for a long time and until the last 3-4 months it was perfectly fine. The issue is definitely some change in the way autocomplete lists suggestions (including not listing <code>by</code> itself when it is a perfectly valid token.</p>",
        "id": 568543476,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1768609509
    },
    {
        "content": "<p>I believe no one would be opposed to autocompleting keywords</p>",
        "id": 568543517,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1768609552
    },
    {
        "content": "<p>But I'm not sure how to get a list of all the keywords using meta code (without hardcoding them)</p>",
        "id": 568543546,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1768609591
    },
    {
        "content": "<p>I am a bit opposed, fearing it might clutter autocompletion window.</p>",
        "id": 568543550,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1768609606
    },
    {
        "content": "<p>It would always be below everything else other than the word suggestions, what do you fear it cluttering specifically?</p>",
        "id": 568543619,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1768609663
    },
    {
        "content": "<p>But I would need to see an implementation to have an opinion. If we can have keywords listed below other suggestions, but above text suggestions (what vscode calls \"abc\"), then I think I'm fine.</p>",
        "id": 568543632,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1768609675
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/qozjsk7ONw670zQUU_dNKw02/image.png\">image.png</a><br>\nI do get keyword suggestions in neovim though.<br>\nAlthough, <code>by_contra</code> is listed first anyway. xd</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/qozjsk7ONw670zQUU_dNKw02/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1920x1080\" src=\"/user_uploads/thumbnail/3121/qozjsk7ONw670zQUU_dNKw02/image.png/840x560.webp\"></a></div>",
        "id": 568544081,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1768610040
    },
    {
        "content": "<p>Completing <code>b</code> in VS Code will also yield keyword completions in VS Code. The problem with triggering auto-completion on <code>by</code> is that we don't have a <code>CompletionInfo</code> for keywords (and in fact we may actually want to complete it as an identifier instead). Could you open a bug report in core?</p>",
        "id": 568758053,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1768815687
    }
]