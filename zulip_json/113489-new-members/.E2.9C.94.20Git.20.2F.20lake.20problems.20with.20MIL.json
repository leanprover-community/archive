[
    {
        "content": "<p>Hi. Some combination of git and lake seems to be causing problems when I try to get started with mathematics in lean:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$<span class=\"w\"> </span>git<span class=\"w\"> </span>clone<span class=\"w\"> </span>https://github.com/leanprover-community/mathematics_in_lean.git\nCloning<span class=\"w\"> </span>into<span class=\"w\"> </span><span class=\"s1\">'mathematics_in_lean'</span>...\nremote:<span class=\"w\"> </span>Enumerating<span class=\"w\"> </span>objects:<span class=\"w\"> </span><span class=\"m\">2599</span>,<span class=\"w\"> </span><span class=\"k\">done</span>.\nremote:<span class=\"w\"> </span>Counting<span class=\"w\"> </span>objects:<span class=\"w\"> </span><span class=\"m\">100</span>%<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">237</span>/237<span class=\"o\">)</span>,<span class=\"w\"> </span><span class=\"k\">done</span>.\nremote:<span class=\"w\"> </span>Compressing<span class=\"w\"> </span>objects:<span class=\"w\"> </span><span class=\"m\">100</span>%<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">147</span>/147<span class=\"o\">)</span>,<span class=\"w\"> </span><span class=\"k\">done</span>.\nremote:<span class=\"w\"> </span>Total<span class=\"w\"> </span><span class=\"m\">2599</span><span class=\"w\"> </span><span class=\"o\">(</span>delta<span class=\"w\"> </span><span class=\"m\">161</span><span class=\"o\">)</span>,<span class=\"w\"> </span>reused<span class=\"w\"> </span><span class=\"m\">123</span><span class=\"w\"> </span><span class=\"o\">(</span>delta<span class=\"w\"> </span><span class=\"m\">89</span><span class=\"o\">)</span>,<span class=\"w\"> </span>pack-reused<span class=\"w\"> </span><span class=\"m\">2362</span><span class=\"w\"> </span><span class=\"o\">(</span>from<span class=\"w\"> </span><span class=\"m\">3</span><span class=\"o\">)</span>\nReceiving<span class=\"w\"> </span>objects:<span class=\"w\"> </span><span class=\"m\">100</span>%<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">2599</span>/2599<span class=\"o\">)</span>,<span class=\"w\"> </span><span class=\"m\">48</span>.98<span class=\"w\"> </span>MiB<span class=\"w\"> </span><span class=\"p\">|</span><span class=\"w\"> </span><span class=\"m\">4</span>.09<span class=\"w\"> </span>MiB/s,<span class=\"w\"> </span><span class=\"k\">done</span>.\nResolving<span class=\"w\"> </span>deltas:<span class=\"w\"> </span><span class=\"m\">100</span>%<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1716</span>/1716<span class=\"o\">)</span>,<span class=\"w\"> </span><span class=\"k\">done</span>.\n\n$<span class=\"w\"> </span><span class=\"nb\">cd</span><span class=\"w\"> </span>mathematics_in_lean/\n\n$<span class=\"w\"> </span>lake<span class=\"w\"> </span>exe<span class=\"w\"> </span>cache<span class=\"w\"> </span>get\ninfo:<span class=\"w\"> </span>mathlib:<span class=\"w\"> </span>URL<span class=\"w\"> </span>has<span class=\"w\"> </span>changed<span class=\"p\">;</span><span class=\"w\"> </span>deleting<span class=\"w\"> </span><span class=\"s1\">'././.lake/packages/mathlib'</span><span class=\"w\"> </span>and<span class=\"w\"> </span>cloning<span class=\"w\"> </span>again\ninfo:<span class=\"w\"> </span>mathlib:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover-community/mathlib4\ninfo:<span class=\"w\"> </span>mathlib:<span class=\"w\"> </span>checking<span class=\"w\"> </span>out<span class=\"w\"> </span>revision<span class=\"w\"> </span><span class=\"s1\">'a6276f4c6097675b1cf5ebd49b1146b735f38c02'</span>\nerror:<span class=\"w\"> </span>external<span class=\"w\"> </span><span class=\"nb\">command</span><span class=\"w\"> </span><span class=\"s1\">'git'</span><span class=\"w\"> </span>exited<span class=\"w\"> </span>with<span class=\"w\"> </span>code<span class=\"w\"> </span><span class=\"m\">128</span>\n</code></pre></div>\n<p>Is this a known problem with a known solution?</p>",
        "id": 500287070,
        "sender_full_name": "Arnoud van der Leer",
        "timestamp": 1739833284
    },
    {
        "content": "<p>That's strange output -- are you eliding some other stuff you ran or did that really happen in sequence? Specifically, after <code>git clone</code> you shouldn't have a <code>.lake</code> in there, so <code>lake</code> shouldn't complain about it. (So it'd be extra fun if that indeed were the case).</p>",
        "id": 500289721,
        "sender_full_name": "Julian Berman",
        "timestamp": 1739835119
    },
    {
        "content": "<p>Anyways I think first port of call if you just care about getting a working setup perhaps is does <code>rm -rf .lake</code> and then <code>lake exe cache get</code> fix it?</p>",
        "id": 500289792,
        "sender_full_name": "Julian Berman",
        "timestamp": 1739835143
    },
    {
        "content": "<p>It seems that I got it working just now.</p>",
        "id": 500289802,
        "sender_full_name": "Arnoud van der Leer",
        "timestamp": 1739835152
    },
    {
        "content": "<p>What did it?</p>",
        "id": 500289815,
        "sender_full_name": "Julian Berman",
        "timestamp": 1739835168
    },
    {
        "content": "<p>The problem was that git thinks all the package repositories are maybe unsafe, so I had to execute</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">config</span><span class=\"w\"> </span><span class=\"c1\">--global --add safe.directory /.lake/packages/mathlib</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">config</span><span class=\"w\"> </span><span class=\"c1\">--global --add safe.directory /.lake/packages/plausible</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">config</span><span class=\"w\"> </span><span class=\"c1\">--global --add safe.directory /.lake/packages/aesop</span>\n<span class=\"bp\">...</span>\n</code></pre></div>",
        "id": 500289853,
        "sender_full_name": "Arnoud van der Leer",
        "timestamp": 1739835200
    },
    {
        "content": "<p>Oh. Are you on Android?</p>",
        "id": 500289873,
        "sender_full_name": "Julian Berman",
        "timestamp": 1739835220
    },
    {
        "content": "<p>Ubuntu</p>",
        "id": 500289883,
        "sender_full_name": "Arnoud van der Leer",
        "timestamp": 1739835229
    },
    {
        "content": "<p>Interesting. OK. Well, glad you got it working.</p>",
        "id": 500289893,
        "sender_full_name": "Julian Berman",
        "timestamp": 1739835240
    },
    {
        "content": "<p>Yeah. Am I the first ubuntu user, or do other people not have this problem? <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 500289965,
        "sender_full_name": "Arnoud van der Leer",
        "timestamp": 1739835270
    },
    {
        "content": "<p>You are definitely not the first. The reason I mentioned Android is that I know this funny directory ownership issue can happen there -- but it can happen elsewhere too.</p>",
        "id": 500290034,
        "sender_full_name": "Julian Berman",
        "timestamp": 1739835325
    },
    {
        "content": "<p>Who owns <code>.lake</code> and its contents and who are you?</p>",
        "id": 500290052,
        "sender_full_name": "Julian Berman",
        "timestamp": 1739835334
    },
    {
        "content": "<p>Fair enough</p>",
        "id": 500290062,
        "sender_full_name": "Arnoud van der Leer",
        "timestamp": 1739835338
    },
    {
        "content": "<p>I.e., what's the output of <code>ls -l .lake/*</code> and <code>whoami</code> :)?</p>",
        "id": 500290081,
        "sender_full_name": "Julian Berman",
        "timestamp": 1739835355
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">ls</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/*</span>\n<span class=\"n\">total</span><span class=\"w\"> </span><span class=\"mi\">36</span>\n<span class=\"n\">drwxrwxrwx</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"mi\">4096</span><span class=\"w\"> </span><span class=\"n\">feb</span><span class=\"w\"> </span><span class=\"mi\">18</span><span class=\"w\"> </span><span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">34</span><span class=\"w\"> </span><span class=\"n\">aesop</span>\n<span class=\"n\">drwxrwxrwx</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"mi\">4096</span><span class=\"w\"> </span><span class=\"n\">feb</span><span class=\"w\"> </span><span class=\"mi\">18</span><span class=\"w\"> </span><span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">34</span><span class=\"w\"> </span><span class=\"n\">batteries</span>\n<span class=\"n\">drwxrwxrwx</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"mi\">4096</span><span class=\"w\"> </span><span class=\"n\">feb</span><span class=\"w\"> </span><span class=\"mi\">18</span><span class=\"w\"> </span><span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">30</span><span class=\"w\"> </span><span class=\"n\">Cli</span>\n<span class=\"n\">drwxrwxrwx</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"mi\">4096</span><span class=\"w\"> </span><span class=\"n\">feb</span><span class=\"w\"> </span><span class=\"mi\">18</span><span class=\"w\"> </span><span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">34</span><span class=\"w\"> </span><span class=\"n\">importGraph</span>\n<span class=\"n\">drwxrwxrwx</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"mi\">4096</span><span class=\"w\"> </span><span class=\"n\">feb</span><span class=\"w\"> </span><span class=\"mi\">18</span><span class=\"w\"> </span><span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">34</span><span class=\"w\"> </span><span class=\"n\">LeanSearchClient</span>\n<span class=\"n\">drwxrwxrwx</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"mi\">4096</span><span class=\"w\"> </span><span class=\"n\">feb</span><span class=\"w\"> </span><span class=\"mi\">18</span><span class=\"w\"> </span><span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">26</span><span class=\"w\"> </span><span class=\"n\">mathlib</span>\n<span class=\"n\">drwxrwxrwx</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"mi\">4096</span><span class=\"w\"> </span><span class=\"n\">feb</span><span class=\"w\"> </span><span class=\"mi\">18</span><span class=\"w\"> </span><span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">34</span><span class=\"w\"> </span><span class=\"n\">plausible</span>\n<span class=\"n\">drwxrwxrwx</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"mi\">4096</span><span class=\"w\"> </span><span class=\"n\">feb</span><span class=\"w\"> </span><span class=\"mi\">18</span><span class=\"w\"> </span><span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">29</span><span class=\"w\"> </span><span class=\"n\">proofwidgets</span>\n<span class=\"n\">drwxrwxrwx</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"mi\">4096</span><span class=\"w\"> </span><span class=\"n\">feb</span><span class=\"w\"> </span><span class=\"mi\">18</span><span class=\"w\"> </span><span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">34</span><span class=\"w\"> </span><span class=\"n\">Qq</span>\n\n<span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">whoami</span>\n<span class=\"n\">arnoud</span>\n</code></pre></div>",
        "id": 500290190,
        "sender_full_name": "Arnoud van der Leer",
        "timestamp": 1739835413
    },
    {
        "content": "<p>Oh boy, so when you said <code>/.lake</code> you really meant <code>/.lake</code>??</p>",
        "id": 500290208,
        "sender_full_name": "Julian Berman",
        "timestamp": 1739835427
    },
    {
        "content": "<p>The \"real\" issue is why/how did you end up with directories owned by root</p>",
        "id": 500290232,
        "sender_full_name": "Julian Berman",
        "timestamp": 1739835450
    },
    {
        "content": "<p>Did you run something via <code>sudo</code>?</p>",
        "id": 500290239,
        "sender_full_name": "Julian Berman",
        "timestamp": 1739835456
    },
    {
        "content": "<p>That is a very good question. I only noticed now</p>",
        "id": 500290246,
        "sender_full_name": "Arnoud van der Leer",
        "timestamp": 1739835461
    },
    {
        "content": "<p>It seems that the entire partition is owned by <code>root</code>. That probably has something to do with it</p>",
        "id": 500290327,
        "sender_full_name": "Arnoud van der Leer",
        "timestamp": 1739835509
    },
    {
        "content": "<p>That explains so much XD</p>",
        "id": 500290339,
        "sender_full_name": "Arnoud van der Leer",
        "timestamp": 1739835518
    },
    {
        "content": "<p>And that has nothing to do with lean then</p>",
        "id": 500290351,
        "sender_full_name": "Arnoud van der Leer",
        "timestamp": 1739835527
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"406521\">Arnoud van der Leer</span> has marked this topic as resolved.</p>",
        "id": 500290996,
        "sender_full_name": "Notification Bot",
        "timestamp": 1739835959
    }
]