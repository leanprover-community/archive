[
    {
        "content": "<p>I have two versions of a short proof.</p>\n<p>In the second version I want to create an intermediate hypothesis <code>h2</code> by applying the lemma <code>mul_eq_zero</code> to <code>h</code>.</p>\n<p>I am failing, probably because of syntax. </p>\n<p>So my question is (1) how do I apply it, and more importantly (2) <strong>how do I read the signatur</strong>e of the lemma to tell me how to apply it?</p>\n<p>I've tried variations such as</p>\n<ul>\n<li><code>:= by mul_eq_zero h</code></li>\n<li><code>:= by rw [mul_eq_zero] h</code></li>\n<li><code>:= mul_eq_zero h</code></li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mul_eq_zero</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">hq</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">left</span>\n<span class=\"w\">    </span><span class=\"n\">linarith</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">right</span>\n<span class=\"w\">    </span><span class=\"n\">linarith</span>\n\n<span class=\"c1\">---</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\">  </span><span class=\"n\">mul_eq_zero</span><span class=\"w\">  </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"c1\">-- &lt; ---------------- fails -------------</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">hq</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h2</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">left</span>\n<span class=\"w\">    </span><span class=\"n\">linarith</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">right</span>\n<span class=\"w\">    </span><span class=\"n\">linarith</span>\n</code></pre></div>",
        "id": 478505011,
        "sender_full_name": "rzeta0",
        "timestamp": 1729692318
    },
    {
        "content": "<p>Hover over the lemma in your editor and it will tell you what its type is -- what do you see?</p>",
        "id": 478507035,
        "sender_full_name": "Julian Berman",
        "timestamp": 1729692858
    },
    {
        "content": "<p><code>mul_eq_zero</code> is a biconditional statement: <code>a * b = 0 ↔ a = 0 ∨ b = 0</code>.  That's why you were able to use it in <code>rw</code>, which can be used with equations and biconditional statements.  In your second proof, you're trying to use the logical rule modus ponens, which applies to conditional statement, not biconditional statements.  Modus ponens is the rule that says that from <code>P → Q</code> and <code>P</code> you can infer <code>Q</code>.  So what you need to use is the left-to-right direction of the theorem.  You can do that by using <code>mul_eq_zero.mp</code> instead of <code>mul_eq_zero</code>.  (The right-to-left direction would be <code>mul_eq_zero.mpr</code>.)</p>",
        "id": 478509461,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1729693545
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321696\">Julian Berman</span> <a href=\"#narrow/channel/113489-new-members/topic/how.20to.20apply.20a.20lemma.20to.20a.20hypothesis/near/478507035\">said</a>:</p>\n<blockquote>\n<p>Hover over the lemma in your editor and it will tell you what its type is -- what do you see?</p>\n</blockquote>\n<p>I see</p>\n<p><code>mul_eq_zero.{u_1} {M₀ : Type u_1} [MulZeroClass M₀] [NoZeroDivisors M₀] {a b : M₀} : a * b = 0 ↔ a = 0 ∨ b = 0</code></p>\n<p>I can work out what the correct syntax form I should use just by looking at the signature, the point about <code>mp</code> and <code>mpr</code> aside.</p>",
        "id": 478510411,
        "sender_full_name": "rzeta0",
        "timestamp": 1729693787
    },
    {
        "content": "<p>Cool. To be sure, \"can\" is not a typo (for \"can't\") there right? Meaning the piece you were missing is the <code>mp</code> bit? Because it's an important skill to be able to look at that line and know what it means in terms of how you use <code>mul_eq_zero</code> (specifically it says <code>mul_eq_zero</code> takes 0 arguments, so you should immediately see from it that you can never do <code>mul_eq_zero h</code> for any <code>h</code>).</p>",
        "id": 478516550,
        "sender_full_name": "Julian Berman",
        "timestamp": 1729695464
    },
    {
        "content": "<p>Thanks Julian - so no arguments means I don't supply parameters in the usual sense.</p>\n<p>In the code above that works it is applied <code>at h</code> .. so what's going on here? Is it the case that <code>rw</code> is pointed at <code>h</code> and the rewriting is done by the lemma.</p>\n<p>Regarding the <code>mp</code>, the following all fail:</p>\n<ul>\n<li><code>  := mul_eq_zero.mp  </code></li>\n<li><code>  := by mul_eq_zero.mp  </code></li>\n<li><code>  := by apply mul_eq_zero.mp</code></li>\n</ul>\n<p>So I'm back to the syntax question. Or maybe my misunderstanding is more fundamental?</p>",
        "id": 478527162,
        "sender_full_name": "rzeta0",
        "timestamp": 1729697949
    },
    {
        "content": "<p>Please show your full code again - <code>by mul_eq_zero.mp</code> can't work because <code>mul_eq_zero.mp</code> is not a tactic but a term</p>",
        "id": 478527439,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1729698027
    },
    {
        "content": "<p>In your second example, this works:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\">  </span><span class=\"n\">mul_eq_zero</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\">  </span><span class=\"n\">h</span>\n</code></pre></div>",
        "id": 478527820,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1729698153
    },
    {
        "content": "<p>I can answer your question, and you should answer Ruben's, but in the interest of repeating the point I made about this being an important skill to read the term and see what arguments it takes  -- you should now mouse over <code>mul_eq_zero.mp</code> -- this is a <em>new term</em>, separate from <code>mul_eq_zero</code> -- what does it say its type is? That skill above now is needed to know whether it's something you can use as-is or whether you need to give it an argument!</p>",
        "id": 478528184,
        "sender_full_name": "Julian Berman",
        "timestamp": 1729698261
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"307953\">@Ruben Van de Velde</span>  here is the full code for the second (previously non-working) example:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">mul_eq_zero</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"c1\">-- &lt; -------- discussion is about this line</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">hq</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h2</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">left</span>\n<span class=\"w\">    </span><span class=\"n\">linarith</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">right</span>\n<span class=\"w\">    </span><span class=\"n\">linarith</span>\n</code></pre></div>",
        "id": 478535487,
        "sender_full_name": "rzeta0",
        "timestamp": 1729700478
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span> </p>\n<p>If I hover over <code>mul_eq_zero.mp</code> my editor (VSC) still shows the signature for <code>mul_eq_zero</code></p>\n<p><code>mul_eq_zero.{u_1} {M₀ : Type u_1} [MulZeroClass M₀] [NoZeroDivisors M₀] {a b : M₀} : a * b = 0 ↔ a = 0 ∨ b = 0</code></p>\n<p>If I hover over just the <code>mp</code> I get</p>\n<p><code>Iff.mp {a b : Prop} (self : a ↔ b) : a → b</code></p>\n<hr>\n<p>Update - I just checked in <a href=\"http://live.lean-lang.org\">live.lean-lang.org</a> and it also gives the same signatures.</p>",
        "id": 478535845,
        "sender_full_name": "rzeta0",
        "timestamp": 1729700592
    },
    {
        "content": "<p>This is a bit subtle, but you need to hover over the <code>.</code></p>",
        "id": 478537382,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729701050
    },
    {
        "content": "<p>When you hover over things in VS Code, there should be an almost-imperceptible highlight. Many people don't notice it. It highlights everything that is part of that term.</p>",
        "id": 478537531,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729701089
    },
    {
        "content": "<p>Hovering over <code>mul_eq_zero</code> highlights just that, hovering over <code>mp</code> highlights just that, but hovering over <code>.</code> highlights the whole composite.</p>",
        "id": 478537620,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729701117
    },
    {
        "content": "<p>aha!</p>\n<p>hovering over the dot shows me </p>\n<p><code>p - 1 = 0 ∨ q - 2 = 0</code></p>\n<p>but if I didn't include the <code>h</code>, that is, only had <code>:= mul_eq_zero.mp</code> then it shows</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span>\n<span class=\"w\">  </span><span class=\"n\">mul_eq_zero</span><span class=\"bp\">.</span><span class=\"n\">mp</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"bp\">?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">2307</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">2308</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">2307</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">2308</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n</code></pre></div>\n<p>How can I read this and know that I need to provide a parameter <code>h</code>?</p>\n<p>Here is my guess:</p>\n<ul>\n<li><code>?m.2307 * ?m.2308 = 0 </code> suggests these elements are missing / uninstantiated.</li>\n<li>therefore I need to find something that fills them in by matching the pattern</li>\n<li>which is <code>h</code></li>\n<li>but this is not as obvious as the message telling me it needs a parameter.</li>\n</ul>",
        "id": 478542356,
        "sender_full_name": "rzeta0",
        "timestamp": 1729702760
    },
    {
        "content": "<p>The <code>→</code> is a hint that <code>mul_eq_zero.mp</code> expects one more parameter</p>",
        "id": 478542654,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729702877
    },
    {
        "content": "<p>(This error message could be smarter and figure out you are missing a parameter automatically, but it is not (yet?) smart in that way.)</p>",
        "id": 478542991,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729703006
    },
    {
        "content": "<p>What you can see is that in the \"has type\" line the return type is <code>?m.2307 = 0 ∨ ?m.2308 = 0</code>, and the expected type is  <code>p - 1 = 0 ∨ q - 2 = 0</code>. These line up with <code>?m.2307 = p - 1</code> and <code>?m.2308 = q - 2</code>.</p>",
        "id": 478543209,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729703070
    },
    {
        "content": "<p>I agree the UX here has room for improvement - hovering over the dot is bothersome, and synthetic hole names are, to use a flowery term, sinfully unreadable :( If that said <code>(?a.1 * ?b.1) = 0 -&gt; ?a.1 = 0 \\/ ?b.1 = 0</code> or somesuch, perhaps eyes wouldn't gloss right over the term structure.</p>",
        "id": 479175424,
        "sender_full_name": "Alex Mobius",
        "timestamp": 1730073285
    },
    {
        "content": "<p>I have advocated a few times for using \"alphanumbering\" <code>?a†</code>, <code>?b†</code>, ... <code>?z†</code>, <code>?aa†</code>, ... instead of showing unique IDs, because I find them significantly easier to differentiate as a human. (The daggers are needed to differentiate them from named metavariables, since you should not be able to refer to them by these names.) The other important improvement, which could be done at the same time, is to renumber them sequentially based on appearance in the goal state (but with a numbering that is globally coherent across the display of all goals), instead of using globally unique numbers, which is the main reason they have such eye-crossingly large but similar numbers like <code>?m.2307</code>, <code>?m.2308</code>. This is actually what lean 3 did (it used names like <code>?m_1</code>, <code>?m_2</code>...) but this got lost in the upgrade for whatever reason.</p>",
        "id": 479177321,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1730074911
    }
]