[
    {
        "content": "<p>I'm learning about <code>by_cases</code> to create a disjunction on the truth of a statement.</p>\n<p>Below is an example from the Mechanics of Proof course.</p>\n<p>In my mind this seems to commit the sin of using the conclusion as part of your proof - in effect creating a circular argument.</p>\n<p>Let me explain my concern a little more.</p>\n<ol>\n<li>If the conclusion is used as a hypothesis to show it leads to a contradiction, then we have shown it can't have been true.</li>\n<li>If the conclusion is used as a hypothesis to show it leads to the conclusion - this seems like a circular argument.</li>\n</ol>\n<p>I'd welcome guidance.</p>\n<hr>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hP</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬¬</span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">hP</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">hP</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">contradiction</span>\n</code></pre></div>",
        "id": 489126307,
        "sender_full_name": "rzeta0",
        "timestamp": 1734307325
    },
    {
        "content": "<p>If you don't like using by_cases here, you can <code>apply hP</code> as your first step</p>",
        "id": 489127769,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1734308734
    },
    {
        "content": "<p>Additionally, you mask your original hP with the naming in your by_cases</p>",
        "id": 489127837,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1734308771
    },
    {
        "content": "<p>What's your concern precisely? That <code>by_cases</code> might be doing a circular argument? Or that you'd like help seeing that it's not a circular argument?</p>",
        "id": 489127926,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734308876
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span>  I'd like help to see that is isn't a circular argument.</p>",
        "id": 489133095,
        "sender_full_name": "rzeta0",
        "timestamp": 1734313267
    },
    {
        "content": "<p>Maybe you'll like this. For simple enough proofs, <code>#explode</code> gives something readable. It takes the proof that was accepted by the Lean kernel and outputs it in a line-by-line format rather than the proof term format.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">Explode</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">mythm</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hP</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬¬</span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">hP</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">hP</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">contradiction</span>\n\n<span class=\"bp\">#</span><span class=\"n\">explode</span><span class=\"w\"> </span><span class=\"n\">mythm</span>\n<span class=\"c\">/-</span>\n<span class=\"cm\">mythm : ∀ {P : Prop}, ¬¬P → P</span>\n\n<span class=\"cm\">0│     │ P          ├ Prop</span>\n<span class=\"cm\">1│     │ hP         ├ ¬¬P</span>\n<span class=\"cm\">2│     │ hP         │ ┌ P</span>\n<span class=\"cm\">3│2,2  │ ∀I         │ P → P</span>\n<span class=\"cm\">4│     │ hP         │ ┌ ¬P</span>\n<span class=\"cm\">5│1,4  │ ∀E         │ │ False</span>\n<span class=\"cm\">6│5    │ False.elim │ │ P</span>\n<span class=\"cm\">7│4,6  │ ∀I         │ ¬P → P</span>\n<span class=\"cm\">8│3,7  │ dite       │ P</span>\n<span class=\"cm\">9│0,1,8│ ∀I         │ ∀ {P : Prop}, ¬¬P → P</span>\n<span class=\"cm\">-/</span>\n</code></pre></div>\n<p>Here's how to read it:</p>\n<ul>\n<li>Each line has a line number, a list of supporting line numbers, the reason for the conclusion, and the conclusion</li>\n<li>Lines with <code>├</code> are givens.</li>\n<li>Sometimes proofs are indented with <code>┌</code> and <code>│</code> symbols to represent a universal quantification argument. (\"assuming such-and-such we prove such-and-such\" means we prove an implication)</li>\n</ul>\n<ol>\n<li>We are given <code>¬¬P</code></li>\n<li>Assume <code>P</code> is true.</li>\n<li>Since <code>P</code> is true given that <code>P</code> is true, <code>P → P</code>.</li>\n<li>Assume <code>¬P</code> is true.</li>\n<li>Applying 4 to 1, by definition of negation we have a contradiction (<code>False</code>)</li>\n<li>By the principal of explosion (<code>False.elim</code>) from this contradiction we can prove <code>P</code>.</li>\n<li>Since we have proved <code>P</code> given that <code>¬P</code> is true, <code>¬P → P</code> is true.</li>\n<li>Using 3 (that <code>P → P</code>) and 7 (that <code>¬P → P</code>), then by <code>dite</code> we prove <code>P</code> is true. This is where LEM comes in. (It could have also been <code>Or.elim</code>, but <code>by_cases</code> uses <code>dite</code> instead of <code>Or.elim</code>.)</li>\n<li>You can ignore line 9. It assembles the implication version of the theorem.</li>\n</ol>",
        "id": 489137609,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734317025
    },
    {
        "content": "<p>Additional notes:</p>\n<ul>\n<li><code>∀I</code> means \"forall introduction\"</li>\n<li><code>∀E</code> means \"forall elimination\"</li>\n</ul>\n<p>There's also an extensive docstring for <code>#explode</code>. <a href=\"https://github.com/leanprover-community/mathlib4/blob/00a4da3dfe01780cafe9613f222d77d7caff4056/Mathlib/Tactic/Explode.lean#L148-L273\">https://github.com/leanprover-community/mathlib4/blob/00a4da3dfe01780cafe9613f222d77d7caff4056/Mathlib/Tactic/Explode.lean#L148-L273</a></p>",
        "id": 489137821,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734317191
    },
    {
        "content": "<p>Yakov's observation that you are using the name <code>hP</code> for two things (shadowing the original meaning of <code>hP</code>) is a good one. This could be why it seems like you're making a circular argument. Name <code>hP</code> something else inside your <code>by_cases</code>.</p>",
        "id": 489137892,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734317278
    },
    {
        "content": "<p>thanks I'll take a look at <code>#explode</code> - it looks like a very impressive capability !</p>\n<p>the naming of <code>hP</code> sadly is as the MoP course provides it - I agree I would have used different names</p>",
        "id": 489204400,
        "sender_full_name": "rzeta0",
        "timestamp": 1734346520
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> <a href=\"#narrow/channel/113489-new-members/topic/circular.20argument.20using.20.60by_cases.60.3F/near/489126307\">said</a>:</p>\n<blockquote>\n<ol start=\"2\">\n<li>If the conclusion is used as a hypothesis to show it leads to the conclusion - this seems like a circular argument.</li>\n</ol>\n</blockquote>\n<p>The <code>by_cases</code> step creates two cases.  In case 1, you assume <code>P</code>, and in case 2 you assume <code>¬P</code>.  I think what's bothering you is that in case 1, what you assume is the same as the desired conclusion, and that looks like circular reasoning.</p>\n<p>If you assume what you're supposed to prove and there is <em>no justification</em> for the assumption, that would indeed be circular reasoning.  But in this case, the assumption is justified by the law of excluded middle.  And it wouldn't make sense to have a rule saying that you're allowed to make assumptions that are justified, except that if you end up assuming the goal then, even though the assumption is justified, you're not allowed to do it because it looks too much like circular reasoning.</p>\n<p>To see how the law of excluded middle justifies the assumption, consider rewriting the proof like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hP</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬¬</span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hPnP</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">em</span><span class=\"w\"> </span><span class=\"n\">P</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"n\">hP</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">hP</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hPnP</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">hP</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">contradiction</span>\n</code></pre></div>\n<p>You could think of the <code>by_cases</code> step of your proof as just a shortcut for the <code>have</code> and <code>obtain</code> steps of the proof above.  The law of excluded middle justifies asserting <code>hPnP : P ∨ ¬P</code>.  And once you have that, you are justified in reasoning by cases, assuming <code>P</code> in case 1 and <code>¬P</code> in case 2.  The fact that the assumption in case 1 happens to match the goal doesn't change the fact that the assumption is justified by <code>hPnP</code>.</p>",
        "id": 489265497,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1734362605
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"453098\">@Dan Velleman</span> - you are right it is case 1 that is bothering me. I will print out your explanation and read it slowly to make sure I understand it.</p>",
        "id": 489275568,
        "sender_full_name": "rzeta0",
        "timestamp": 1734365002
    },
    {
        "content": "<p>I have now read your answer and am much happier.</p>\n<p>The difference that clarified it for me is this:</p>\n<ul>\n<li>incorrect: assume goal P and proceed</li>\n<li>correct: assume P ∨¬P and proceed</li>\n</ul>",
        "id": 489285544,
        "sender_full_name": "rzeta0",
        "timestamp": 1734367391
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> has marked this topic as resolved.</p>",
        "id": 489285575,
        "sender_full_name": "Notification Bot",
        "timestamp": 1734367402
    }
]