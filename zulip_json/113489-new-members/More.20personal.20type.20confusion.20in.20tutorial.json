[
    {
        "content": "<p>In section 6.2 in Functional Programming in Lean the following statement is made:</p>\n<p>monadLift (x &gt;&gt;= f : m α) is the same as (monadLift x : m α) &gt;&gt;= fun y =&gt; monadLift (f y)</p>\n<p>should this not be:</p>\n<p>monadLift (x &gt;&gt;= f : m α) is the same as (monadLift x : n β) &gt;&gt;= fun y =&gt; monadLift (f y)?</p>\n<p>My underlying thought would be that:</p>\n<p>x : m β<br>\nf : β → m α<br>\nmonadLift : m β → n β</p>\n<p>I ask these questions because if this is just a typo that is fine. However since I'm still struggling to learn Lean, I can't tell when I see these kind of expressions if I am misunderstanding the type concepts. So I start asking an LLM, getting it to agree after a while, and end up still not knowing--since getting it to agree means nothing. <span aria-label=\"rolling on the floor laughing\" class=\"emoji emoji-1f923\" role=\"img\" title=\"rolling on the floor laughing\">:rolling_on_the_floor_laughing:</span></p>",
        "id": 560605433,
        "sender_full_name": "Garrison Venn",
        "timestamp": 1764252216
    },
    {
        "content": "<p>Honestly, I do not understand much of this, but I know that this typechecks:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Monad</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Monad</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MonadLift</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">monadLift</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&gt;&gt;=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">monadLift</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">&gt;&gt;=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">monadLift</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>I don't even know if this is one of the two alternatives that you ask about, though...</p>",
        "id": 560611157,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1764253802
    },
    {
        "content": "<p>Ok cool you verified at least that my interpretation is correct, and that the text may be incorrect <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span> . More importantly you gave me a way to use Lean to type check, though I don't know what variable is yet. So thanks <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span> <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span> </p>\n<p>I seem to be finding typos in the tutorial (I think), and wonder if there is some link where I can submit them where incorrect noise will be ignored. Just writing this here in case someone else sees this.</p>",
        "id": 560613007,
        "sender_full_name": "Garrison Venn",
        "timestamp": 1764254268
    },
    {
        "content": "<p>Ah, <code>variable ...</code> means that what appears in <code>...</code> will be added as an assumption, as needed in the following declarations.</p>",
        "id": 560613348,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1764254352
    },
    {
        "content": "<p>There are some subtleties for what counts as \"as needed\", but essentially you can simply copy paste those variables as assumptions of the two examples and remove <code>variable</code>, if you prefer.</p>",
        "id": 560613514,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1764254395
    },
    {
        "content": "<p>I'll ping <span class=\"user-mention\" data-user-id=\"354934\">@David Thrane Christiansen</span>, in case he is interested in this thread.</p>",
        "id": 560614759,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1764254711
    },
    {
        "content": "<p>Actually I was thinking more about:</p>\n<p>monadLift (x &gt;&gt;= f : m α) is the same as (monadLift x : m α) &gt;&gt;= fun y =&gt; monadLift (f y)</p>\n<p>One way to interpret this--ignoring possible transitive logical errors which I don't currently see, is that the statement could be correct if α = β, and m = n (using the previous notations). In this case the above contract is quite constrained in addition to the lift not really being a lift. I don't have enough Lean proof understanding to refute this given that the contract adherence seems voluntary. Regardless my point is that in a pedagogical setting the above statement could be misleading; is it a typo or is the monadLift distributive law highly constrained.</p>",
        "id": 560643514,
        "sender_full_name": "Garrison Venn",
        "timestamp": 1764263518
    },
    {
        "content": "<p>90% sure this is a typo</p>",
        "id": 560644390,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1764263889
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib/wiki/Code-in-backticks\">#backticks</a> btw <span class=\"user-mention\" data-user-id=\"975081\">@Garrison Venn</span></p>",
        "id": 560740769,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1764322182
    },
    {
        "content": "<p>Thanks for the ping! I was away from the computer due to holidays.</p>\n<p>Here's a bit more context:</p>\n<blockquote>\n<p><code>monadLift</code> should distribute over <code>bind</code> so that <code>monadLift (x &gt;&gt;= f : m α)</code> is the same as <code>(monadLift x : m α) &gt;&gt;= fun y =&gt; monadLift (f y)</code>.</p>\n</blockquote>\n<p>I think there is an issue of parenthesization, and it should be:</p>\n<blockquote>\n<p><code>monadLift</code> should distribute over <code>bind</code> so that <code>monadLift (x &gt;&gt;= f : m α)</code> is the same as <code>monadLift (x : m α) &gt;&gt;= fun y =&gt; monadLift (f y)</code>.</p>\n</blockquote>\n<p>With more type annotations, this could be:</p>\n<blockquote>\n<p><code>monadLift</code> should distribute over <code>bind</code> so that <code>(monadLift (x &gt;&gt;= f : m α) : n α)</code> is the same as <code>(monadLift (x : m α) : n α) &gt;&gt;= fun (y : α) =&gt; (monadLift (f y : m β) : n β)</code>.</p>\n</blockquote>\n<p>but in the context of the text that's describing monad transformers it should really be</p>\n<blockquote>\n<p><code>monadLift</code> should distribute over <code>bind</code> so that <code>(monadLift (x &gt;&gt;= f : m α) : T m α)</code> is the same as <code>(monadLift (x : m α) : T m α) &gt;&gt;= fun (y : α) =&gt; (monadLift (f y : m β) : T m β)</code>.</p>\n</blockquote>\n<p>I think it's otherwise correct as written. Does this make sense? Would the more-annotated version have been more helpful for you?</p>",
        "id": 561088498,
        "sender_full_name": "David Thrane Christiansen",
        "timestamp": 1764576503
    },
    {
        "content": "<p>it's not correct without the additional parentheses</p>",
        "id": 561131591,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1764588087
    },
    {
        "content": "<p>Thanks for the clarifications <span class=\"user-mention\" data-user-id=\"354934\">@David Thrane Christiansen</span> . The added parentheses definitely helps on the rhs, but on the lhs I'm still seeing some confusion on my part.</p>\n<p>Take: <code>monadLift (x &gt;&gt;= f  : m α)</code></p>\n<p>Adding parentheses for more clarity this would be:</p>\n<p><code>monadLift ((x &gt;&gt;= f)  : m α)</code></p>\n<p>This means the bind returns <code>m α</code>. In turn this means that we must add another type, call it β and f must be typed as:</p>\n<p><code>f : β → m α</code></p>\n<p>Therefore the typed version of x is forced by the bind requirements to be:</p>\n<p><code>x : m β</code></p>\n<p>The rhs has:</p>\n<p><code>monadLift (x : m α) &gt;&gt;= fun y =&gt; monadLift (f y)</code></p>\n<p>Therefore I would get:</p>\n<p><code>m α = m β</code></p>\n<p>Sorry for any misinterpretation, the automatic Lean coercions still throw me off. Still learning. <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 561162867,
        "sender_full_name": "Garrison Venn",
        "timestamp": 1764596610
    },
    {
        "content": "<p>oh yeah that's also a thing</p>",
        "id": 561163288,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1764596696
    },
    {
        "content": "<p>You're totally right, I made a mistake there. Coercions aren't intended to be used there, and I totally get why you'd jump to them. The only one who says sorry when intro docs are wrong is the author of them, not the reader - thank you!</p>\n<p>It should be:</p>\n<blockquote>\n<p><code>monadLift</code> should distribute over <code>bind</code> so that <code>(monadLift (x &gt;&gt;= f : m β) : T m β)</code> is the same as <code>(monadLift (x : m α) : T m α) &gt;&gt;= fun (y : α) =&gt; (monadLift (f y : m β) : T m β)</code>.</p>\n</blockquote>\n<p>I'll fix it soon!</p>",
        "id": 561164782,
        "sender_full_name": "David Thrane Christiansen",
        "timestamp": 1764597057
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/fp-lean/issues/251\">https://github.com/leanprover/fp-lean/issues/251</a></p>",
        "id": 561165026,
        "sender_full_name": "David Thrane Christiansen",
        "timestamp": 1764597107
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"354934\">@David Thrane Christiansen</span> Well at least it seems you taught me correctly. <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 561165100,
        "sender_full_name": "Garrison Venn",
        "timestamp": 1764597123
    },
    {
        "content": "<p>I'd sure rather it be without that stress, though. Thanks for the good question and feedback!</p>",
        "id": 561166701,
        "sender_full_name": "David Thrane Christiansen",
        "timestamp": 1764597463
    }
]