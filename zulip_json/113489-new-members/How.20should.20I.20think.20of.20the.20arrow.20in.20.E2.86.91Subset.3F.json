[
    {
        "content": "<p>I am toying around with subsets:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>In the Lean Info window I see <code>s: ↑S</code>. Should I think of <code>↑S</code> as a placeholder for <code>ℤ</code> or more like it's <code>S</code> but the arrow is a reminder that <code>S</code> is a sub type (so I can expect to be able to do <a href=\"http://s.property\">s.property</a> and Coe to the larger type)? Or it has some other meaning different from <code>S</code> proper.</p>\n<p>Also, how does one define a subset of a subset? I got both of those to compile, but not sure which is better (if there is even any notion of better).</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">SS</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"c1\">-- the cast for 1 is needed</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">SS'</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"w\"> </span><span class=\"bp\">```</span>\n</code></pre></div>",
        "id": 504484014,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1741588531
    },
    {
        "content": "<p>If you hover over the arrow you can see what it represents</p>",
        "id": 504490249,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1741591068
    },
    {
        "content": "<p>For subset of a subset, probably the second is best if you don't have a reason to use the first. The first remembers it's a subset of <code>S</code> so to speak, but the second you'd need to do an (easy) proof that it's a subset of <code>S</code>.</p>",
        "id": 504490539,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1741591181
    },
    {
        "content": "<blockquote>\n<p>If you hover over the arrow you can see what it represents</p>\n</blockquote>\n<p>I see, <code>S: Set α</code> means that <code>S</code> is a <code>α → Prop</code>, while <code>↑S</code> is <code>Subtype S</code> (which is called Elem). So one is just a structure boxed (not sure if that is even the right terminology), but basically a structure wrapper around the same stuff. So the ↑ denotes that transition.</p>\n<p>I guess the magic was I was even allowed to write (x : S) to begin with, because S is just a specific function, what does it mean to have a specific function as a type. It is true that <code>instance : CoeSort (Set α) (Type u) := ⟨Elem⟩</code> does the magic coersion right at the <code>(x: S)</code> declaration?</p>",
        "id": 504734378,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1741665428
    },
    {
        "content": "<p>There is also ↥ which is subtly different? Clicking through it goes straight to <code>Subtype</code> without <code>Elem</code>?</p>",
        "id": 504734658,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1741665578
    },
    {
        "content": "<p>I see ↑ is for subsets as a specific instance of subtypes which get ↥.</p>",
        "id": 504735800,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1741666114
    },
    {
        "content": "<p>There are three coercion arrows:</p>\n<ul>\n<li><code>↥</code> represents <code>CoeSort</code>, a coersion that allows you to take a type <code>α</code> that is not explicitly <code>Sort u</code> and use it as if it were a <code>Sort u</code> anyway. Only explicit types (things of type <code>Sort u</code>) can have values, so any time you have a 'type-like' type that has 'elements' of some kind you want a <code>CoeSort</code> instance to work with it.</li>\n<li><code>⇑</code> represents <code>CoeFun</code>. Similarly to <code>CoeSort</code>, <code>CoeFun</code> allows you to take a type <code>β</code> that isn't an explicit function type (of type <code>α → γ</code>) and use it as if it were a function anyway. Things like <code>Equiv</code> get <code>CoeFun</code> instances.</li>\n<li><code>↑</code> represents a 'general' coersion that doesn't fall into one of the above two categories.</li>\n</ul>",
        "id": 504755696,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1741676170
    },
    {
        "content": "<p>Got it, one final q if you will indulge me (somehow I keep being draw in to internals of how lean works, instead of actually using it to prove stuff haha). This goofy example helped me grok <code>CoeSort</code> <br>\n making a specific natural number automatically cast to a <code>Prop</code> so it can be used as a sort:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">NonZero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">!=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">3</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CoeSort</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">NonZero</span><span class=\"w\"> </span><span class=\"n\">x</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>but how come I don't see any arrow (no ↥ or ↑)  in the info view? I see the explicit coersion <code>hx : NonZero x</code>.</p>",
        "id": 504886672,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1741708955
    },
    {
        "content": "<p>You have to mark <code>NonZero</code> as <code>@[coe]</code> for the arrow to show up.</p>",
        "id": 504886978,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741709016
    },
    {
        "content": "<p>Nice! Wait why ↑ not ↥ if I used <code>CoeSort</code>? What's a similarly small goofy example to show <code>↥</code>?</p>",
        "id": 504887541,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1741709115
    },
    {
        "content": "<p>The way coercions work is that the system looks for a coercion and then substitutes the definition of the coercion, so in your example rather than seeing <code>CoeSort.coe x</code> you see <code>NonZero x</code> as the result.</p>\n<p>The <code>@[coe]</code> attribute is used for pretty printing (and for tactics that need to identify what is a \"coercion function\"). Adding <code>@[coe]</code> to <code>NonZero</code> marks it as being a coercion function, and pretty printing prints it with an up arrow. There's currently no <code>@[coe_sort]</code> attribute, just <code>@[coe]</code>. Pretty printing has no (efficient) way to tell which instances there are for which coercion class.</p>",
        "id": 504892580,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1741710108
    }
]