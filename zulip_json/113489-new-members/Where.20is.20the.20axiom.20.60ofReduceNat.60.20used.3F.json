[
    {
        "content": "<p>I'm looking for a concrete instance where the <code>ofReduceNat</code> axiom is actually used in Lean code—whether that's in the Lean 4 source code, Mathlib, or a an existing third-party library.</p>\n<p>I'm trying to falsify the claim that this axiom is currently unused, but so far, I've been unable to find any references to it. Perhaps I'm missing something basic.</p>\n<p>Can anyone point me to an example of <code>ofReduceNat</code> being used?</p>",
        "id": 509626570,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1743580728
    },
    {
        "content": "<p>What happens if you make a version of Lean core with that axiom removed? Can you still build all of mathlib?</p>",
        "id": 509627420,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1743580948
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> Yes, both Lean core and Mathlib builds successfully.</p>",
        "id": 509628080,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1743581129
    },
    {
        "content": "<p>Ah well, that's most of your answer then <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 509628167,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1743581149
    },
    {
        "content": "<p>Yes, that's what I suspected. I just wanted to make sure there wasn't anything fundamental I was overlooking. It's certainly surprising to find an axiom that doesn't seem to be used at all!</p>",
        "id": 509628484,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1743581223
    },
    {
        "content": "<p>I've searched extensively for third-party libraries that use it, but I haven't found a single example anywhere.</p>",
        "id": 509629010,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1743581397
    },
    {
        "content": "<p>You could look at the code for checking \"classical\" axioms and modify it to check for <code>ofReduceNat</code> and then run it on all the declarations in the environment under <code>import Mathlib</code>.</p>",
        "id": 509635339,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1743583237
    },
    {
        "content": "<p>(Sorry for the lack of references: I'm on mobile, since my computer is refusing to start up this morning.)</p>",
        "id": 509635437,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1743583273
    },
    {
        "content": "<p>One question I have is the following: given …</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">mathlib4</span><span class=\"bp\">/</span>\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">checkout</span><span class=\"w\"> </span><span class=\"n\">master</span>\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">grep</span><span class=\"w\"> </span><span class=\"n\">ofReduceNat</span>\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"bp\">..</span>\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">lean4</span><span class=\"bp\">/</span>\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">checkout</span><span class=\"w\"> </span><span class=\"n\">master</span>\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">grep</span><span class=\"w\"> </span><span class=\"n\">ofReduceNat</span>\n<span class=\"n\">src</span><span class=\"bp\">/</span><span class=\"n\">Init</span><span class=\"bp\">/</span><span class=\"n\">Core</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"n\">The</span><span class=\"w\"> </span><span class=\"kn\">axiom</span><span class=\"w\"> </span><span class=\"ss\">`ofReduceNat</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">used</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">perform</span><span class=\"w\"> </span><span class=\"n\">proofs</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">reflection</span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">See</span><span class=\"w\"> </span><span class=\"ss\">`reduceBool</span><span class=\"bp\">`.</span>\n<span class=\"n\">src</span><span class=\"bp\">/</span><span class=\"n\">Init</span><span class=\"bp\">/</span><span class=\"n\">Core</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"kn\">axiom</span><span class=\"w\"> </span><span class=\"n\">ofReduceNat</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">reduceNat</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span>\n<span class=\"bp\">%</span>\n</code></pre></div>\n<p>… could there still be any uses of <code>ofReduceNat</code> in Lean or Mathlib? If so, where?</p>",
        "id": 509643434,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1743585554
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"683979\">Isak Colboubrani</span> <a href=\"#narrow/stream/113489-new-members/topic/Where.20is.20the.20axiom.20.60ofReduceNat.60.20used.3F/near/509626570\">said</a>:</p>\n<blockquote>\n<p>I'm looking for a concrete instance where the <code>ofReduceNat</code> axiom is actually used in Lean code—whether that's in the Lean 4 source code, Mathlib, or a an existing third-party library.</p>\n<p>I'm trying to falsify the claim that this axiom is currently unused, but so far, I've been unable to find any references to it. Perhaps I'm missing something basic.</p>\n<p>Can anyone point me to an example of <code>ofReduceNat</code> being used?</p>\n</blockquote>\n<p>Just because the axiom is currently unused doesnt mean we should remove it. It took years for ofReduceBool to have more than one user and as ofReduceNat allows us to extract a lot more information from a single call to a native function than ofReduceBool there is no reason to remove it just because we can.</p>",
        "id": 509644194,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1743585789
    },
    {
        "content": "<p>I see, thanks!</p>\n<p>Is the following claim correct? The <code>ofReduceNat</code> axiom is not <em>currently</em> unused in Lean 4 and Mathlib, but it may be used in the future.</p>",
        "id": 509651271,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1743587700
    },
    {
        "content": "<p><code>ofReduceNat</code> is currently unused in Lean 4 and Mathlib but may be used in the future. Also note that if you were to delete the axiom the entire mechanism around <code>ofReduceNat</code> should be deleted as well which requires touching some kernel code etc.</p>",
        "id": 509653198,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1743588353
    },
    {
        "content": "<p>Thanks! That answers my question.</p>",
        "id": 509655535,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1743589129
    }
]