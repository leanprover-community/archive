[
    {
        "content": "<p>If I have an expression like <code>exact h1 _</code>, hovering over the <code>_</code> in vscode-lean4 will show the inferred type (e.g. <code>N</code>). Is there a way to also show the actual term that was inferred (something like <code>p + 1</code>)? So far, I've been able to figure it out by looking at how the goal changes in the infoview as I move my cursor around, but it would be nice to have a more explicit way of seeing that</p>",
        "id": 470644209,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1726499944
    },
    {
        "content": "<p>You can always use <code>show_term</code>, but that is rather brutish</p>",
        "id": 470648304,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1726500834
    },
    {
        "content": "<p>Hopefully there is a better way I don't know</p>",
        "id": 470648441,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1726500848
    },
    {
        "content": "<p>Thanks - that worked. Separately, it looks like hovering has the expected behavior (showing <code>term: type</code>) in most cases, but not for the particular placeholder I was looking at. I'll see if I can come up with a minimized example</p>",
        "id": 470659637,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1726503045
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/TirBOAsZ2AamUCrnc-Mnyo1K/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/TirBOAsZ2AamUCrnc-Mnyo1K/image.png\" title=\"image.png\"><img data-original-dimensions=\"1006x189\" src=\"/user_uploads/thumbnail/3121/TirBOAsZ2AamUCrnc-Mnyo1K/image.png/840x560.webp\"></a></div>",
        "id": 470659747,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1726503063
    },
    {
        "content": "<p>I see the name of the term, which version of the lean4 extension are you using?</p>",
        "id": 470659826,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1726503078
    },
    {
        "content": "<p>Same behaviour <a href=\"https://live.lean-lang.org/#codez=C4Cwpg9gTmC2AEAzCF4C56AAieA7d8A5AQ2ABp4AGeQEyJd50BeeAIwE8AoegSx2ClSKd4YAB5EAxsEIkAdAC8w/APoAbMPCVA\">online</a></p>",
        "id": 470660205,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1726503151
    },
    {
        "content": "<p>I've managed to minimize the issue to this snippet:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">theorem</span><span class=\"w\"> </span><span class=\"n\">bad_lsp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat.zero</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat.zero</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat.zero</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">Nat.zero</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">show_term</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">_</span>\n</code></pre></div>\n<p>The <code>show_term</code> output is <code>Try this: exact h (Nat.zero + Nat.zero)</code>. However, hovering over the <code>_</code> just shows <code>Nat</code>.<br>\nIf you replace <code>(Nat.zero + Nat.zero)</code> with <code>(Nat.zero)</code> in the theorem header, then hovering over the <code>_</code> shows <code>Nat.zero: Nat</code> as expected</p>",
        "id": 470669936,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1726505065
    },
    {
        "content": "<p>I'll see if I can simplify this any further, then open a bug</p>",
        "id": 470670243,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1726505106
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/issues/5367\">https://github.com/leanprover/lean4/issues/5367</a></p>",
        "id": 470681309,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1726507029
    },
    {
        "content": "<p>Wow, and crazily enough if you invert the order as in</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">bad_lsp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">show_term</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n</code></pre></div>\n<p>you see the term.</p>",
        "id": 470909005,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1726561933
    }
]