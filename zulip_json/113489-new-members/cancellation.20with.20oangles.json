[
    {
        "content": "<p>Hi! I have an MWE of </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Geometry</span><span class=\"bp\">.</span><span class=\"n\">Euclidean</span><span class=\"bp\">.</span><span class=\"n\">Angle</span><span class=\"bp\">.</span><span class=\"n\">Sphere</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Geometry</span><span class=\"bp\">.</span><span class=\"n\">Euclidean</span><span class=\"bp\">.</span><span class=\"n\">Sphere</span><span class=\"bp\">.</span><span class=\"n\">SecondInter</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Geometry</span><span class=\"bp\">.</span><span class=\"n\">Euclidean</span><span class=\"bp\">.</span><span class=\"n\">Circumcenter</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Affine</span><span class=\"w\"> </span><span class=\"n\">Affine</span><span class=\"bp\">.</span><span class=\"n\">Simplex</span><span class=\"w\"> </span><span class=\"n\">EuclideanGeometry</span><span class=\"w\"> </span><span class=\"n\">FiniteDimensional</span><span class=\"w\"> </span><span class=\"n\">Module</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">Affine</span><span class=\"w\"> </span><span class=\"n\">EuclideanGeometry</span><span class=\"w\"> </span><span class=\"n\">Real</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Pt</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">InnerProductSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MetricSpace</span><span class=\"w\"> </span><span class=\"n\">Pt</span><span class=\"o\">]</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedAddTorsor</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"n\">Pt</span><span class=\"o\">]</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hd2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">finrank</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">Oriented</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)]</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Pt</span><span class=\"o\">)</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"n\">π</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"bp\">∡</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"bp\">∡</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"n\">π</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∡</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\">  </span><span class=\"bp\">∡</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">  </span><span class=\"n\">intros</span><span class=\"w\"> </span><span class=\"n\">calceq</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">calc1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"bp\">∡</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"n\">π</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"w\"> </span><span class=\"n\">π</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"bp\">∡</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Eq</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">AddCommMagma</span><span class=\"bp\">.</span><span class=\"n\">add_comm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">↑</span><span class=\"n\">π</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"bp\">∡</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"n\">rewrite</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">calc1</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">calceq</span>\n<span class=\"o\">}</span>\n</code></pre></div>\n<p>and I am trying to arrive at ∡ C S K = ∡ C S B. I cannot, however, figure out how to cancel the pi angles at the sides, and I'm not sure if I even can cancel the multiplication by two. Is there a place I can look to see what I can do to manipulate oangles? The site <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/SpecialFunctions/Trigonometric/Angle.html#Real.Angle.toReal\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/SpecialFunctions/Trigonometric/Angle.html#Real.Angle.toReal</a> does not appear to have any lemmas related to addition or multiplication.</p>",
        "id": 505887394,
        "sender_full_name": "Riley Riles",
        "timestamp": 1742074272
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=add_right_inj#doc\">docs#add_right_inj</a></p>",
        "id": 505887772,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1742074599
    },
    {
        "content": "<p>The multiplication by two is not cancellable, because <code>2 • π = 2 • 0</code>.</p>",
        "id": 505887819,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1742074656
    },
    {
        "content": "<p>I'm not entirely sure how to apply add_right_inj; how do I tell the function what the values of b and c are if the values of b and c are implicit?</p>\n<p>Also, if I have that both angles are between 0 and pi, would that allow me to cancel them?</p>",
        "id": 505888178,
        "sender_full_name": "Riley Riles",
        "timestamp": 1742074928
    },
    {
        "content": "<p>You can do <code>rw [add_right_inj] at calceq</code>.</p>",
        "id": 505888372,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1742075115
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"879248\">Riley Riles</span> <a href=\"#narrow/channel/113489-new-members/topic/cancellation.20with.20oangles/near/505888178\">said</a>:</p>\n<blockquote>\n<p>Also, if I have that both angles are between 0 and pi, would that allow me to cancel them?</p>\n</blockquote>\n<p>What do you mean by this?</p>",
        "id": 505888395,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1742075138
    },
    {
        "content": "<p>In the wider context of the problem, I know that both the angles in question are between 0 and pi (they're angles in a triangle). Is there a way to add in an assumption to represent that (which would allow me to cancel the multiplication by two)?</p>",
        "id": 505888515,
        "sender_full_name": "Riley Riles",
        "timestamp": 1742075237
    },
    {
        "content": "<p>Which angles do you know are between 0 and pi?</p>",
        "id": 505888609,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1742075301
    },
    {
        "content": "<p>∡ C S K and ∡ C S B.</p>",
        "id": 505888632,
        "sender_full_name": "Riley Riles",
        "timestamp": 1742075320
    },
    {
        "content": "<p>I'm a bit confused by the original question... you're one line away from solving the theorem with <code>exact calceq</code></p>",
        "id": 505888642,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1742075343
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"380294\">Matt Diamond</span> <a href=\"#narrow/channel/113489-new-members/topic/cancellation.20with.20oangles/near/505888642\">said</a>:</p>\n<blockquote>\n<p>I'm a bit confused by the original question... you're one line away from solving the theorem with <code>exact calceq</code></p>\n</blockquote>\n<p>My bad, the correct desired end result was <code> ∡ C S K =  ∡ C S B</code>. (I was a little hasty when making the MWE.)</p>",
        "id": 505888765,
        "sender_full_name": "Riley Riles",
        "timestamp": 1742075440
    },
    {
        "content": "<p>oh okay, gotcha</p>",
        "id": 505888774,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1742075457
    },
    {
        "content": "<p>I found <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Real.Angle.two_nsmul_eq_iff#doc\">docs#Real.Angle.two_nsmul_eq_iff</a></p>",
        "id": 505888800,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1742075490
    },
    {
        "content": "<p>You should be able to combine this with a bound on the angles to get that they're equal.</p>",
        "id": 505888873,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1742075530
    },
    {
        "content": "<p>Thanks, that works great! Quick question, how do you find theorems like this  which do not have a natural language description? Moogle does not seem to bring this up, and directly searching the documentation does not help either.</p>",
        "id": 505888902,
        "sender_full_name": "Riley Riles",
        "timestamp": 1742075563
    },
    {
        "content": "<p>I used <span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> Real.Angle, 2 • _</p>",
        "id": 505888932,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1742075594
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/SpecialFunctions/Trigonometric/Angle.html#Real.Angle.two_zsmul_coe_pi\">Real.Angle.two_zsmul_coe_pi</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/SpecialFunctions/Trigonometric/Angle.html#Real.Angle.two_zsmul_coe_div_two\">Real.Angle.two_zsmul_coe_div_two</a>, and <a href=\"https://loogle.lean-lang.org/?q=Real.Angle%2C%202%20%E2%80%A2%20_\">65 more</a></p>",
        "id": 505888933,
        "sender_full_name": "loogle",
        "timestamp": 1742075595
    },
    {
        "content": "<p>It was very far down in the results</p>",
        "id": 505888946,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1742075604
    },
    {
        "content": "<p>yeah, <a href=\"https://loogle.lean-lang.org\">Loogle</a> can be pretty useful</p>",
        "id": 505889021,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1742075656
    },
    {
        "content": "<p>Oh, thanks! This looks a lot like Search from Coq; I can't believe I didn't know about this!</p>",
        "id": 505889022,
        "sender_full_name": "Riley Riles",
        "timestamp": 1742075657
    },
    {
        "content": "<p>Depending on the orientation of the triangle, all the angles could be negative. What you do know is that they have the same sign (<code>oangle_rotate_sign</code>). You should be able to combine that with <code>two_nsmul_eq_iff</code> or <code>two_zsmul_eq_iff</code>, and <code>sign_add_pi</code> (together with the signs not being 0) to get what you want. (Probably we should have lemmas saying that angles with nonzero sign are equal if twice those angles are equal and their signs are equal.)</p>",
        "id": 505892117,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1742078373
    },
    {
        "content": "<p>(If you want equality where the angles aren't all in the same triangle, you may need to find another lemma to show signs are equal.)</p>",
        "id": 505892219,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1742078451
    }
]