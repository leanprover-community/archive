[
    {
        "content": "<p>I'm trying to set up <code>doc-gen4</code> for my library following <a href=\"https://github.com/leanprover/doc-gen4\">this guide</a>, but it seems to be having trouble downloading mathlib? I always get this error:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">docbuild</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">previous</span><span class=\"w\"> </span><span class=\"n\">manifest</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">creating</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">scratch</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">updated</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">already</span><span class=\"w\"> </span><span class=\"n\">up</span><span class=\"bp\">-</span><span class=\"n\">to</span><span class=\"bp\">-</span><span class=\"n\">date</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">mathlib</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">running</span><span class=\"w\"> </span><span class=\"n\">post</span><span class=\"bp\">-</span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">hooks</span>\n<span class=\"n\">uncaught</span><span class=\"w\"> </span><span class=\"n\">exception</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">file</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">mathlib</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">fetch</span><span class=\"w\"> </span><span class=\"n\">cache</span>\n</code></pre></div>\n<p>Here are the exact commands I am running:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">new</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">tests</span><span class=\"w\"> </span><span class=\"n\">math</span>\n<span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">tests</span><span class=\"bp\">/</span>\n<span class=\"n\">mkdir</span><span class=\"w\"> </span><span class=\"n\">docbuild</span>\n<span class=\"n\">touch</span><span class=\"w\"> </span><span class=\"n\">docbuild</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">toml</span>\n</code></pre></div>\n<p>Then I change <code>docbuild/lakefile.toml</code> to </p>\n<div class=\"codehilite\" data-code-language=\"TOML\"><pre><span></span><code><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"docbuild\"</span>\n<span class=\"n\">reservoir</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">false</span>\n<span class=\"n\">version</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"0.1.0\"</span>\n<span class=\"n\">packagesDir</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"../.lake/packages\"</span>\n\n<span class=\"k\">[[require]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"doc-tests\"</span>\n<span class=\"n\">path</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"../\"</span>\n\n<span class=\"k\">[[require]]</span>\n<span class=\"n\">scope</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"leanprover\"</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"doc-gen4\"</span>\n<span class=\"c1\"># Use revision v4.x if you are developing against a stable Lean version.</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"v4.15.0-rc1\"</span>\n</code></pre></div>\n<p>Initilize git:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">init</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"bp\">.</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">commit</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"s2\">\"initial commit\"</span>\n</code></pre></div>\n<p>Then I try to follow the next step:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">docbuild</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span>\n</code></pre></div>\n<p>And I get the error I pasted above.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Lake</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"mf\">5.0</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">ffac974</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"mf\">4.15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span><span class=\"o\">)</span>\n<span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"mf\">4.15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x86_64</span><span class=\"bp\">-</span><span class=\"n\">unknown</span><span class=\"bp\">-</span><span class=\"n\">linux</span><span class=\"bp\">-</span><span class=\"n\">gnu</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">commit</span><span class=\"w\"> </span><span class=\"n\">ffac974dba79</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Release</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 490609682,
        "sender_full_name": "Daniel James",
        "timestamp": 1735001826
    },
    {
        "content": "<p>Why do you want to make the <code>docbuild</code> directory? You already have a Lean project depending on Mathlib: <code>doc-tests</code>.</p>",
        "id": 490627828,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1735013153
    },
    {
        "content": "<p>That's what the README says to do.</p>",
        "id": 490627921,
        "sender_full_name": "Daniel James",
        "timestamp": 1735013207
    },
    {
        "content": "<p>I don't want docs for mathlib. I want them for my own library.</p>",
        "id": 490627966,
        "sender_full_name": "Daniel James",
        "timestamp": 1735013240
    },
    {
        "content": "<p>Hmm, <span class=\"user-mention\" data-user-id=\"395550\">@Henrik BÃ¶ving</span> might want to elaborate on this decision.</p>",
        "id": 490628041,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1735013305
    },
    {
        "content": "<ol>\n<li>Run the following commands on a terminal emulator.</li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>lake<span class=\"w\"> </span>new<span class=\"w\"> </span>doc-tests<span class=\"w\"> </span>math\n<span class=\"nb\">cd</span><span class=\"w\"> </span>doc-tests/\n</code></pre></div>\n<ol start=\"2\">\n<li>Make sure the content of the <code>lakefile.toml</code> file is the same as follows:</li>\n</ol>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>lakefile.toml</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\" data-code-language=\"TOML\"><pre><span></span><code><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"doc-tests\"</span>\n<span class=\"n\">version</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"0.1.0\"</span>\n<span class=\"n\">keywords</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s2\">\"math\"</span><span class=\"p\">]</span>\n<span class=\"n\">defaultTargets</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s2\">\"DocTests\"</span><span class=\"p\">]</span>\n\n<span class=\"k\">[leanOptions]</span>\n<span class=\"n\">pp</span><span class=\"p\">.</span><span class=\"n\">unicode</span><span class=\"p\">.</span><span class=\"n\">fun</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span><span class=\"w\"> </span><span class=\"c1\"># pretty-prints `fun a â†¦ b`</span>\n<span class=\"n\">autoImplicit</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">false</span>\n\n<span class=\"k\">[[require]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"mathlib\"</span>\n<span class=\"n\">scope</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"leanprover-community\"</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"v4.15.0-rc1\"</span>\n\n<span class=\"k\">[[require]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"doc-gen4\"</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/leanprover/doc-gen4\"</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"v4.15.0-rc1\"</span>\n\n<span class=\"k\">[[lean_lib]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"DocTests\"</span>\n</code></pre></div>\n</div></div>\n<ol start=\"3\">\n<li>Run <code>lake update doc-gen4</code> on the terminal emulator.</li>\n<li>\n<p>Choose the value of the <code>DOCGEN_SRC</code> environmental variable after reading the instruction on <a href=\"https://github.com/leanprover/doc-gen4?tab=readme-ov-file#source-locations\">https://github.com/leanprover/doc-gen4?tab=readme-ov-file#source-locations</a>. Then build the documentation.</p>\n<p>For example, if you want to create references to local files, you should run <code>DOCGEN_SRC=\"file\" lake -R build DocTests:docs</code>.</p>\n</li>\n<li>\n<p>Run <code>cd .lake/build/doc; python3 -m http.server</code> on the terminal emulator.</p>\n</li>\n<li>Open the <code>http://0.0.0.0:8000/</code> link using your web browser.</li>\n</ol>",
        "id": 490628312,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1735013619
    },
    {
        "content": "<p>I fixed the version of Mathlib and <code>doc-gen4</code> that your project should use.</p>",
        "id": 490628439,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1735013756
    },
    {
        "content": "<p>Ok that doesn't error. But I don't seem to be able to build the docs.</p>",
        "id": 490628682,
        "sender_full_name": "Daniel James",
        "timestamp": 1735013981
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">tests</span><span class=\"o\">:</span><span class=\"n\">docs</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">unknown</span><span class=\"w\"> </span><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">facet</span><span class=\"w\"> </span><span class=\"ss\">`docs</span><span class=\"bp\">`</span>\n</code></pre></div>",
        "id": 490628749,
        "sender_full_name": "Daniel James",
        "timestamp": 1735014026
    },
    {
        "content": "<p>Choose the value of the <code>DOCGEN_SRC</code> environmental variable after reading the instruction on <a href=\"https://github.com/leanprover/doc-gen4?tab=readme-ov-file#source-locations\">https://github.com/leanprover/doc-gen4?tab=readme-ov-file#source-locations</a>. Then build the documentation.</p>",
        "id": 490628789,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1735014095
    },
    {
        "content": "<p>For example, if you want to create references to local files, you should run <code>DOCGEN_SRC=\"file\" lake -R build DocTests:docs</code>.</p>",
        "id": 490628817,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1735014122
    },
    {
        "content": "<p>Ok, that works. But the critical point is to use <code>DocTests</code> instead of <code>doc-tests</code>.</p>",
        "id": 490629665,
        "sender_full_name": "Daniel James",
        "timestamp": 1735014765
    },
    {
        "content": "<p>So is using the sub-project out of date advice?</p>",
        "id": 490629682,
        "sender_full_name": "Daniel James",
        "timestamp": 1735014784
    },
    {
        "content": "<p>I'm not sure. The maintainers of <code>doc-gen4</code> may comment on this matter.</p>",
        "id": 490629889,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1735014968
    },
    {
        "content": "<p>From <a href=\"https://github.com/leanprover/doc-gen4?tab=readme-ov-file#usage\">https://github.com/leanprover/doc-gen4?tab=readme-ov-file#usage</a>:</p>\n<blockquote>\n<p>If your parent project has dependencies you want to run <code>lake update YourLibraryName</code> within <code>docbuild</code> whenever you update the dependencies of your parent project.</p>\n</blockquote>\n<p>This doesn't work either.</p>",
        "id": 490630177,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1735015248
    },
    {
        "content": "<p>Hmm okay the build was running for a while but just failed with a bunch of complicated error messages.</p>",
        "id": 490630791,
        "sender_full_name": "Daniel James",
        "timestamp": 1735015825
    },
    {
        "content": "<p>A sampling:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">lean_apply_5</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x40e</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557da2deb3ce</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l_Lean_withTraceNodeBefore___at___private_Lean_Meta_ExprDefEq_0__Lean_Meta_checkTypesAndAssign___spec__1</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x291</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f439d21</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">lean_is_expr_def_eq</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x5a5</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f41c575</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l_Lean_Meta_isExprDefEqAuxImpl___lambda__3</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x13c6</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f512e66</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">lean_apply_5</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x40e</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557da2deb3ce</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l_Lean_withTraceNodeBefore___at___private_Lean_Meta_ExprDefEq_0__Lean_Meta_checkTypesAndAssign___spec__1</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x291</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f439d21</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">lean_is_expr_def_eq</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x5a5</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f41c575</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l___private_Lean_Meta_ExprDefEq_0__Lean_Meta_isDefEqLeft___lambda__1</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x28</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f4bd308</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l___private_Lean_Meta_ExprDefEq_0__Lean_Meta_isDefEqLeftRight</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x1d9</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f4bdd09</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l___private_Lean_Meta_ExprDefEq_0__Lean_Meta_unfoldBothDefEq</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x19d7</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f4c64e7</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l___private_Lean_Meta_ExprDefEq_0__Lean_Meta_isDefEqDelta</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x562</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f4cdde2</span><span class=\"o\">]</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">external</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4'</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">137</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"bp\">Â«</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">Â»/</span><span class=\"n\">coreDocs</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n</code></pre></div>",
        "id": 490630838,
        "sender_full_name": "Daniel James",
        "timestamp": 1735015902
    },
    {
        "content": "<p>I succeeded in building the documentation. I'll try it one more time.</p>",
        "id": 490631431,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1735016442
    },
    {
        "content": "<p>I don't know why it's taking this much time.</p>",
        "id": 490632096,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1735016958
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Bash Session\"><pre><span></span><code><span class=\"go\">â„¹ [128/128] Built Â«doc-testsÂ»/DocTests:docs</span>\n<span class=\"go\">info: Documentation indexing</span>\n<span class=\"go\">Build completed successfully.</span>\n</code></pre></div>",
        "id": 490632134,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1735016999
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"417769\">Bulhwi Cha</span> <a href=\"#narrow/channel/113489-new-members/topic/Trouble.20setting.20up.20.60doc-gen4.60.2E/near/490628312\">said</a>:</p>\n<blockquote>\n<ol>\n<li>Run the following commands on a terminal emulator.</li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>lake<span class=\"w\"> </span>new<span class=\"w\"> </span>doc-tests<span class=\"w\"> </span>math\n<span class=\"nb\">cd</span><span class=\"w\"> </span>doc-tests/\n</code></pre></div>\n<ol start=\"2\">\n<li>Make sure the content of the <code>lakefile.toml</code> file is the same as follows:</li>\n</ol>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>lakefile.toml</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\" data-code-language=\"TOML\"><pre><span></span><code><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"doc-tests\"</span>\n<span class=\"n\">version</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"0.1.0\"</span>\n<span class=\"n\">keywords</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s2\">\"math\"</span><span class=\"p\">]</span>\n<span class=\"n\">defaultTargets</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s2\">\"DocTests\"</span><span class=\"p\">]</span>\n\n<span class=\"k\">[leanOptions]</span>\n<span class=\"n\">pp</span><span class=\"p\">.</span><span class=\"n\">unicode</span><span class=\"p\">.</span><span class=\"n\">fun</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span><span class=\"w\"> </span><span class=\"c1\"># pretty-prints `fun a â†¦ b`</span>\n<span class=\"n\">autoImplicit</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">false</span>\n\n<span class=\"k\">[[require]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"mathlib\"</span>\n<span class=\"n\">scope</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"leanprover-community\"</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"v4.15.0-rc1\"</span>\n\n<span class=\"k\">[[require]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"doc-gen4\"</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/leanprover/doc-gen4\"</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"v4.15.0-rc1\"</span>\n\n<span class=\"k\">[[lean_lib]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"DocTests\"</span>\n</code></pre></div>\n</div></div>\n<ol start=\"3\">\n<li>Run <code>lake update doc-gen4</code> on the terminal emulator.</li>\n<li>\n<p>Choose the value of the <code>DOCGEN_SRC</code> environmental variable after reading the instruction on <a href=\"https://github.com/leanprover/doc-gen4?tab=readme-ov-file#source-locations\">https://github.com/leanprover/doc-gen4?tab=readme-ov-file#source-locations</a>. Then build the documentation.</p>\n<p>For example, if you want to create references to local files, you should run <code>DOCGEN_SRC=\"file\" lake -R build DocTests:docs</code>.</p>\n</li>\n<li>\n<p>Run <code>cd .lake/build/doc; python3 -m http.server</code> on the terminal emulator.</p>\n</li>\n<li>Open the <code>http://0.0.0.0:8000/</code> link using your web browser.</li>\n</ol>\n</blockquote>\n<p>Don't do that, this setup will make every user download doc-gen and its transitive dependency closure, this is not what we want.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"607797\">Daniel James</span> <a href=\"#narrow/channel/113489-new-members/topic/Trouble.20setting.20up.20.60doc-gen4.60.2E/near/490609682\">said</a>:</p>\n<blockquote>\n<p>I'm trying to set up <code>doc-gen4</code> for my library following <a href=\"https://github.com/leanprover/doc-gen4\">this guide</a>, but it seems to be having trouble downloading mathlib? I always get this error:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">docbuild</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">previous</span><span class=\"w\"> </span><span class=\"n\">manifest</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">creating</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">scratch</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">updated</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">already</span><span class=\"w\"> </span><span class=\"n\">up</span><span class=\"bp\">-</span><span class=\"n\">to</span><span class=\"bp\">-</span><span class=\"n\">date</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">mathlib</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">running</span><span class=\"w\"> </span><span class=\"n\">post</span><span class=\"bp\">-</span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">hooks</span>\n<span class=\"n\">uncaught</span><span class=\"w\"> </span><span class=\"n\">exception</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">file</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">mathlib</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">fetch</span><span class=\"w\"> </span><span class=\"n\">cache</span>\n</code></pre></div>\n<p>Here are the exact commands I am running:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">new</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">tests</span><span class=\"w\"> </span><span class=\"n\">math</span>\n<span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">tests</span><span class=\"bp\">/</span>\n<span class=\"n\">mkdir</span><span class=\"w\"> </span><span class=\"n\">docbuild</span>\n<span class=\"n\">touch</span><span class=\"w\"> </span><span class=\"n\">docbuild</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">toml</span>\n</code></pre></div>\n<p>Then I change <code>docbuild/lakefile.toml</code> to </p>\n<div class=\"codehilite\" data-code-language=\"TOML\"><pre><span></span><code><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"docbuild\"</span>\n<span class=\"n\">reservoir</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">false</span>\n<span class=\"n\">version</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"0.1.0\"</span>\n<span class=\"n\">packagesDir</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"../.lake/packages\"</span>\n\n<span class=\"k\">[[require]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"doc-tests\"</span>\n<span class=\"n\">path</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"../\"</span>\n\n<span class=\"k\">[[require]]</span>\n<span class=\"n\">scope</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"leanprover\"</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"doc-gen4\"</span>\n<span class=\"c1\"># Use revision v4.x if you are developing against a stable Lean version.</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"v4.15.0-rc1\"</span>\n</code></pre></div>\n<p>Initilize git:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">init</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"bp\">.</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">commit</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"s2\">\"initial commit\"</span>\n</code></pre></div>\n<p>Then I try to follow the next step:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">docbuild</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span>\n</code></pre></div>\n<p>And I get the error I pasted above.</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Lake</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"mf\">5.0</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">ffac974</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"mf\">4.15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span><span class=\"o\">)</span>\n<span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"mf\">4.15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x86_64</span><span class=\"bp\">-</span><span class=\"n\">unknown</span><span class=\"bp\">-</span><span class=\"n\">linux</span><span class=\"bp\">-</span><span class=\"n\">gnu</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">commit</span><span class=\"w\"> </span><span class=\"n\">ffac974dba79</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Release</span><span class=\"o\">)</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>This eror specifically affects mathlib because of a bug that is apparently still not fixed yet, the workaround can be found here <a class=\"message-link\" href=\"/#narrow/channel/270676-lean4/topic/New.20recommended.20default.20setup.20for.20doc-gen4/near/485138000\">#lean4 &gt; New recommended default setup for doc-gen4 @ ðŸ’¬</a> </p>\n<p><span class=\"user-mention silent\" data-user-id=\"607797\">Daniel James</span> <a href=\"#narrow/channel/113489-new-members/topic/Trouble.20setting.20up.20.60doc-gen4.60.2E/near/490630838\">said</a>:</p>\n<blockquote>\n<p>A sampling:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">lean_apply_5</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x40e</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557da2deb3ce</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l_Lean_withTraceNodeBefore___at___private_Lean_Meta_ExprDefEq_0__Lean_Meta_checkTypesAndAssign___spec__1</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x291</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f439d21</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">lean_is_expr_def_eq</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x5a5</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f41c575</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l_Lean_Meta_isExprDefEqAuxImpl___lambda__3</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x13c6</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f512e66</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">lean_apply_5</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x40e</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557da2deb3ce</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l_Lean_withTraceNodeBefore___at___private_Lean_Meta_ExprDefEq_0__Lean_Meta_checkTypesAndAssign___spec__1</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x291</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f439d21</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">lean_is_expr_def_eq</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x5a5</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f41c575</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l___private_Lean_Meta_ExprDefEq_0__Lean_Meta_isDefEqLeft___lambda__1</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x28</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f4bd308</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l___private_Lean_Meta_ExprDefEq_0__Lean_Meta_isDefEqLeftRight</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x1d9</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f4bdd09</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l___private_Lean_Meta_ExprDefEq_0__Lean_Meta_unfoldBothDefEq</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x19d7</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f4c64e7</span><span class=\"o\">]</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l___private_Lean_Meta_ExprDefEq_0__Lean_Meta_isDefEqDelta</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x562</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x557d9f4cdde2</span><span class=\"o\">]</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">external</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4'</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">137</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"bp\">Â«</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">Â»/</span><span class=\"n\">coreDocs</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>This message, as you can tell by the error code, says that building the documentation went out of memory on your machine and thus subsequently got killed. Unfortunately building documentation is currently a rather expensive job because of several factors.</p>",
        "id": 490647304,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1735028724
    },
    {
        "content": "<p>Note that if you just want to look at the documentation for mathlib and core on the latest release you can find it over here: <a href=\"https://leanprover-community.github.io/mathlib4_docs/\">https://leanprover-community.github.io/mathlib4_docs/</a></p>",
        "id": 490647623,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1735028955
    },
    {
        "content": "<p>Thanks for your help Henrik! I really appreciate it. I'll try that fix.</p>",
        "id": 490648712,
        "sender_full_name": "Daniel James",
        "timestamp": 1735029646
    },
    {
        "content": "<p>In a perfect world I suppose building docs for your own library wouldn't require also building mathlib docs. But I suppose docgen isn't really used much outside of mathlib so that probably isn't a pressing concern.</p>",
        "id": 490648779,
        "sender_full_name": "Daniel James",
        "timestamp": 1735029700
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"395550\">Henrik BÃ¶ving</span> <a href=\"#narrow/channel/113489-new-members/topic/Trouble.20setting.20up.20.60doc-gen4.60.2E/near/490647304\">said</a>:</p>\n<blockquote>\n<p>Don't do that, this setup will make every user download doc-gen and its transitive dependency closure, this is not what we want.</p>\n</blockquote>\n<p>I guess there's no option in <code>lakefile.toml</code> corresponding to the following line in <code>lakefile.lean</code>. Am I correct?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">meta</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">get_config</span><span class=\"bp\">?</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"s2\">\"dev\"</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"c1\">-- dev is so not everyone has to build it</span>\n</code></pre></div>",
        "id": 490674862,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1735045647
    },
    {
        "content": "<p>You are not supposed to use this anymore, this was a bandaid from the beginning and should neither be used in lakefile.toml nor lakefile.lean</p>",
        "id": 490674915,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1735045675
    },
    {
        "content": "<p>Experience has shown that end users easily mess up updating their dependeencies etc. like this so we switched to the new suggestions, it's rather unfortunate that <code>Cache</code> has not yet fixed the issues that this triggers but these are not a fundamental issue with the setup but rather with <code>Cache</code> making assumptions about <code>lake</code> that are not always true</p>",
        "id": 490675076,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1735045760
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"607797\">Daniel James</span> <a href=\"#narrow/channel/113489-new-members/topic/Trouble.20setting.20up.20.60doc-gen4.60.2E/near/490648779\">said</a>:</p>\n<blockquote>\n<p>In a perfect world I suppose building docs for your own library wouldn't require also building mathlib docs. But I suppose docgen isn't really used much outside of mathlib so that probably isn't a pressing concern.</p>\n</blockquote>\n<p>Also if you are building documentation for your work locally I would very much expect it to build all the documentation locally so you can also work isolated from the internet, that's e.g. the choice that projects like <code>rustdoc</code> also made, when you run <code>cargo doc</code> all the docs get compiled locally. In the future there is hopefully going to exist a <a href=\"http://docs.rs\">docs.rs</a> style platform though, that can enable sharing of documentation between published versions of projects</p>",
        "id": 490675277,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1735045882
    },
    {
        "content": "<p>I see. So, we'll just have to avoid the Mathlib error using the following workaround until the bug gets fixed.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"395550\">Henrik BÃ¶ving</span> <a href=\"#narrow/channel/113489-new-members/topic/Trouble.20setting.20up.20.60doc-gen4.60.2E/near/490647304\">said</a>:</p>\n<blockquote>\n<p>This eror specifically affects mathlib because of a bug that is apparently still not fixed yet, the workaround can be found here <a href=\"#narrow/channel/270676-lean4/topic/New.20recommended.20default.20setup.20for.20doc-gen4/near/485138000\">#lean4 &gt; New recommended default setup for doc-gen4 @ ðŸ’¬</a></p>\n</blockquote>",
        "id": 490675307,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1735045904
    },
    {
        "content": "<p>Alternatively until <code>Cache</code> gets deprecated by <code>lake</code>'s generic caching infrastructure that's going to come eventually or we switch to yet another approach <span aria-label=\"tm\" class=\"emoji emoji-2122\" role=\"img\" title=\"tm\">:tm:</span> that avoids both this and the old issues, we'll see</p>",
        "id": 490675405,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1735045949
    },
    {
        "content": "<p>Do we have good documentation for the \"new recommended approach\" to using docgen that doesn't require multiple repositories yet?</p>",
        "id": 490676559,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1735046661
    },
    {
        "content": "<p>It's laid out in the README of doc-gen</p>",
        "id": 490676818,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1735046875
    },
    {
        "content": "<p>Ok, I gave that a go and now I get a new error!</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stderr</span><span class=\"o\">:</span>\n<span class=\"n\">PANIC</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">whnfEasyCases</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">WHNF</span><span class=\"o\">:</span><span class=\"mi\">338</span><span class=\"o\">:</span><span class=\"mi\">22</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">loose</span><span class=\"w\"> </span><span class=\"n\">bvar</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">expression</span>\n<span class=\"n\">backtrace</span><span class=\"o\">:</span>\n<span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">lean_panic_fn</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x6d</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x55f7d99839bd</span><span class=\"o\">]</span>\n<span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l_Lean_Meta_whnfEasyCases___at_Lean_Meta_whnfImp___spec__3</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x41c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x55f7d555857c</span><span class=\"o\">]</span>\n<span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l___private_Lean_Meta_WHNF_0__Lean_Meta_reduceRec___rarg</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x4a5</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x55f7d54e8845</span><span class=\"o\">]</span>\n<span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l_Lean_Meta_whnfEasyCases___at_Lean_Meta_whnfCore_go___spec__3___lambda__4</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">xd30</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x55f7d5519de0</span><span class=\"o\">]</span>\n<span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l_Lean_Meta_whnfEasyCases___at_Lean_Meta_whnfCore_go___spec__3___lambda__5</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x61a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x55f7d551b03a</span><span class=\"o\">]</span>\n<span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"o\">(</span><span class=\"n\">l_Lean_Meta_whnfEasyCases___at_Lean_Meta_whnfCore_go___spec__3___lambda__6</span><span class=\"bp\">+</span><span class=\"mi\">0</span><span class=\"n\">x3b4</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"n\">x55f7d551bb04</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>and the backtrace continues for quite a while.</p>",
        "id": 490696124,
        "sender_full_name": "Daniel James",
        "timestamp": 1735059809
    },
    {
        "content": "<p>That's a known one, it's already fixed on Lean 4 master, note that even though this panic happens your build doesn't fail though, it's just debug information</p>",
        "id": 490696219,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1735059866
    },
    {
        "content": "<p><del>Hmm are you sure? I get:</del></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">DocTests</span><span class=\"bp\">.</span><span class=\"n\">Basic</span><span class=\"o\">:</span><span class=\"n\">docs</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">DocTests</span><span class=\"o\">:</span><span class=\"n\">docs</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n</code></pre></div>\n<p><del>and there is no <code>docs</code> folder in <code>.lake/build</code></del></p>\n<p>Ignore me. I was looking at the wrong folder.</p>",
        "id": 490696621,
        "sender_full_name": "Daniel James",
        "timestamp": 1735060161
    },
    {
        "content": "<p>I know that I have seen this error on mathlib and it didn't affect the build, you'll have to provide your actual build log not just fragments if you want me to be sure :P</p>",
        "id": 490696731,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1735060211
    },
    {
        "content": "<p>The build should certainly say that it did succeed though, it does that for the mathlib error that I have in mind</p>",
        "id": 490696850,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1735060287
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"395550\">Henrik BÃ¶ving</span> <a href=\"#narrow/channel/113489-new-members/topic/Trouble.20setting.20up.20.60doc-gen4.60.2E/near/490696731\">said</a>:</p>\n<blockquote>\n<p>I know that I have seen this error on mathlib and it didn't affect the build, you'll have to provide your actual build log not just fragments if you want me to be sure :P</p>\n</blockquote>\n<p><a href=\"https://pastebin.com/bX1EjgJj\">https://pastebin.com/bX1EjgJj</a></p>",
        "id": 490696973,
        "sender_full_name": "Daniel James",
        "timestamp": 1735060380
    },
    {
        "content": "<p>Hmm yeah maybe it actually didn't work. I see this <br>\n<a href=\"/user_uploads/3121/ute1rFTKoFEug-XL2YhPBpLl/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/ute1rFTKoFEug-XL2YhPBpLl/image.png\" title=\"image.png\"><img data-original-dimensions=\"384x461\" src=\"/user_uploads/thumbnail/3121/ute1rFTKoFEug-XL2YhPBpLl/image.png/840x560.webp\"></a></div>",
        "id": 490696995,
        "sender_full_name": "Daniel James",
        "timestamp": 1735060400
    },
    {
        "content": "<p>It's failing because of the first lines in your log not the panics below</p>",
        "id": 490697005,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1735060417
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">âœ–</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">7</span><span class=\"bp\">/</span><span class=\"mi\">131</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">DocTests</span><span class=\"bp\">.</span><span class=\"n\">Basic</span><span class=\"o\">:</span><span class=\"n\">docs</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">find</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">remote</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">your</span><span class=\"w\"> </span><span class=\"n\">project</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">consider</span><span class=\"w\"> </span><span class=\"n\">reading</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">#</span><span class=\"n\">source</span><span class=\"bp\">-</span><span class=\"n\">locations</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">while</span><span class=\"w\"> </span><span class=\"n\">looking</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">remote</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"bp\">./././../</span>\n<span class=\"bp\">âœ–</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">9</span><span class=\"bp\">/</span><span class=\"mi\">131</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">DocTests</span><span class=\"o\">:</span><span class=\"n\">docs</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">find</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">remote</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">your</span><span class=\"w\"> </span><span class=\"n\">project</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">consider</span><span class=\"w\"> </span><span class=\"n\">reading</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">#</span><span class=\"n\">source</span><span class=\"bp\">-</span><span class=\"n\">locations</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">while</span><span class=\"w\"> </span><span class=\"n\">looking</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">remote</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"bp\">./././../</span>\n</code></pre></div>\n<p>We always assume that there is some git remote available that we can linkify to</p>",
        "id": 490697021,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1735060438
    },
    {
        "content": "<p>Ah ok! One more time with <code>DOCGEN_SRC=\"file\"</code>.</p>",
        "id": 490697068,
        "sender_full_name": "Daniel James",
        "timestamp": 1735060460
    },
    {
        "content": "<p>Success! Tysm Henrik.</p>",
        "id": 490697075,
        "sender_full_name": "Daniel James",
        "timestamp": 1735060474
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"607797\">Daniel James</span> has marked this topic as resolved.</p>",
        "id": 490697077,
        "sender_full_name": "Notification Bot",
        "timestamp": 1735060482
    },
    {
        "content": "<p>I do really wish the UX for non trivial projects was easier with doc-gen, it's prime use is currently in pre configured CI setups so people don't usually build documentation on their own and this doesn't matter. I do think this is going to improve as we make further changes to lake and friends though</p>",
        "id": 490697126,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1735060538
    },
    {
        "content": "<p>Yeah I think the platonic ideal is Rustâ€™s system where it is literally just cargo doc and it works</p>",
        "id": 490697745,
        "sender_full_name": "Daniel James",
        "timestamp": 1735061036
    },
    {
        "content": "<p>Indeed</p>",
        "id": 490700931,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1735063448
    }
]