[
    {
        "content": "<p>Hi, everyone. I am currently learning Lean and exploring how to use it for theorem proving, as well as how to manage Lean packages. As a starting point, I have cloned the repositories for <a href=\"https://github.com/hhu-adam/NNG4\">NNG4</a> and <a href=\"https://github.com/PatrickMassot/GlimpseOfLean.git\">GlimpseOfLean</a>.</p>\n<p>However, I'm encountering difficulties when it comes to building and managing these Lean packages.</p>\n<p>File structure of the <code>NNG4</code> repository is as follows:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>❯<span class=\"w\"> </span>tree<span class=\"w\"> </span>NNG4<span class=\"w\"> </span>-L<span class=\"w\"> </span><span class=\"m\">1</span>\nNNG4\n├──<span class=\"w\"> </span>build\n├──<span class=\"w\"> </span>Dockerfile\n├──<span class=\"w\"> </span>Game\n├──<span class=\"w\"> </span>Game.lean\n├──<span class=\"w\"> </span>lakefile.lean\n├──<span class=\"w\"> </span>lake-manifest.json\n├──<span class=\"w\"> </span>lake-packages\n├──<span class=\"w\"> </span>lean-toolchain\n└──<span class=\"w\"> </span>README.md\n</code></pre></div>\n<p>It appears that the package environment is managed through three files: <code>lean-toolchain</code>, <code>lake-manifest.json</code>, and <code>lakefile.lean</code>. When the <code>lean-toolchain</code> file does not match the version of Lean installed on my machine, it will automatically download a new version of Lean, which can be inconvenient.</p>\n<blockquote>\n<p><strong>Q: Any recommendations for further reading material?</strong></p>\n</blockquote>\n<p>During my attempts to run the following scripts, I encountered various errors:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>lake<span class=\"w\"> </span>update\nlake<span class=\"w\"> </span>exe<span class=\"w\"> </span>cache<span class=\"w\"> </span>get\nlake<span class=\"w\"> </span>build\n</code></pre></div>\n<p>Like </p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>❯<span class=\"w\"> </span>lake<span class=\"w\"> </span>update\nerror:<span class=\"w\"> </span>./lake-packages/mathlib/lakefile.lean:30:2:<span class=\"w\"> </span>error:<span class=\"w\"> </span><span class=\"s1\">'weakLeanArgs'</span><span class=\"w\"> </span>is<span class=\"w\"> </span>not<span class=\"w\"> </span>a<span class=\"w\"> </span>field<span class=\"w\"> </span>of<span class=\"w\"> </span>the<span class=\"w\"> </span><span class=\"s1\">'Lake.LeanLibConfig'</span><span class=\"w\"> </span>structure\nerror:<span class=\"w\"> </span>./lake-packages/mathlib/lakefile.lean:53:2:<span class=\"w\"> </span>error:<span class=\"w\"> </span><span class=\"s1\">'weakLeanArgs'</span><span class=\"w\"> </span>is<span class=\"w\"> </span>not<span class=\"w\"> </span>a<span class=\"w\"> </span>field<span class=\"w\"> </span>of<span class=\"w\"> </span>the<span class=\"w\"> </span><span class=\"s1\">'Lake.LeanLibConfig'</span><span class=\"w\"> </span>structure\nerror:<span class=\"w\"> </span>./lake-packages/mathlib/lakefile.lean:<span class=\"w\"> </span>package<span class=\"w\"> </span>configuration<span class=\"w\"> </span>has<span class=\"w\"> </span>errors\n\n❯<span class=\"w\"> </span>lake<span class=\"w\"> </span>build\n...\n./lake-packages/mathlib/././Mathlib/Data/Set/Pairwise/Basic.lean:413:65:<span class=\"w\"> </span>error:<span class=\"w\"> </span>unsolved<span class=\"w\"> </span>goals\n</code></pre></div>\n<p>I have also been experiencing some network issues while running <code>lake update</code> and <code>lake exe cache get</code>. </p>\n<blockquote>\n<p><strong>Q2: Is it possible to build these packages locally? Can I manually clone the repositories listed in <code>lake-manifest.json</code>?</strong></p>\n</blockquote>\n<p>Furthermore, I have a few other questions. Thank you for your reading!</p>",
        "id": 388233030,
        "sender_full_name": "RexWang",
        "timestamp": 1693449791
    },
    {
        "content": "<p>The old documentation on project management, which can be found at <a href=\"https://leanprover-community.github.io/lean_projects.html\">https://leanprover-community.github.io/lean_projects.html</a>, is specifically for Lean 3, and it is now outdated.</p>",
        "id": 388233553,
        "sender_full_name": "RexWang",
        "timestamp": 1693450078
    },
    {
        "content": "<p>I am currently using Ubuntu and have plans to build an online server. This will make it accessible and user-friendly for individuals who may not have extensive computer experience.<br>\nI aim to create a website, like <a href=\"https://lean.lookeng.cn/glimpse/#/\">https://lean.lookeng.cn/glimpse/#/</a> for the GlimpseOfLean project, with the addition of an interactive online execution feature. The <code>lean4game</code> tool might be a useful tool.</p>",
        "id": 388237648,
        "sender_full_name": "RexWang",
        "timestamp": 1693452156
    },
    {
        "content": "<p>It's essential that you use the version of lean specified in the <code>lean-toolchain</code> for each project.</p>",
        "id": 388248772,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1693457530
    },
    {
        "content": "<p>Unfortunately the NNG4 repository is outdated, and no longer compatible with Mathlib. I'm making a PR now.</p>",
        "id": 388248961,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1693457640
    },
    {
        "content": "<p><a href=\"https://github.com/hhu-adam/NNG4/pull/17\">https://github.com/hhu-adam/NNG4/pull/17</a></p>",
        "id": 388249124,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1693457743
    },
    {
        "content": "<p>Pinging <span class=\"user-mention\" data-user-id=\"385895\">@Jon Eugster</span> as they seem have made most of the recent commits to that repo.</p>",
        "id": 388249220,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1693457787
    },
    {
        "content": "<p>To explain the update situation of the NNG4 repo quickly, the <code>main</code> branch is outdated because it is waiting mostly on <span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> and his two students, who are all working on a complete overhaul which is expected to be done within the next month or so. They are working on a non-main branch, so all progress of the last two months is there.</p>\n<p>To explain your second Question, there is a difference between <code>lake update</code> and <code>lake clean</code>. If the lake-manifest is committed to the repo, it might be better to try and build it with</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">lake</span> <span class=\"n\">clean</span>\n<span class=\"n\">lake</span> <span class=\"n\">exe</span> <span class=\"n\">cache</span> <span class=\"n\">get</span>   <span class=\"bp\">#</span> <span class=\"k\">if</span> <span class=\"n\">dep.</span> <span class=\"n\">on</span> <span class=\"n\">mathlib</span>\n<span class=\"n\">lake</span> <span class=\"n\">build</span>\n</code></pre></div>\n<p>That way you get the compatible versions of lean + packages that a project used. <code>lake update</code> changes the <code>lake-manifest.json</code> but unfortunately expects that you update the <code>lean-toolchain</code> by hand, leaving you in the errorstate you experience above with incompatible versions.</p>\n<p>as upshot, when building packages locally it's best to build them first with unmodified <code>lake-manifest.json</code> and <code>lean-toolchain</code> before trying to update the packages it depends on<span aria-label=\"blush\" class=\"emoji emoji-1f60a\" role=\"img\" title=\"blush\">:blush:</span></p>\n<p>(regardless, Ill see that the NNG4<code>main</code> branch gets updated soon)</p>",
        "id": 388258245,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1693463139
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"385895\">@Jon Eugster</span>, I've merged the <code>SetTheory.Game</code> PR.</p>",
        "id": 388267605,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1693467596
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"385895\">Jon Eugster</span> <a href=\"#narrow/stream/113489-new-members/topic/installation.20and.20package.20management/near/388258245\">发言道</a>：</p>\n<blockquote>\n<p>To explain the update situation of the NNG4 repo quickly, the <code>main</code> branch is outdated because it is waiting mostly on <span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> and his two students, who are all working on a complete overhaul which is expected to be done within the next month or so. They are working on a non-main branch, so all progress of the last two months is there.</p>\n<p>To explain your second Question, there is a difference between <code>lake update</code> and <code>lake clean</code>. If the lake-manifest is committed to the repo, it might be better to try and build it with</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">lake</span> <span class=\"n\">clean</span>\n<span class=\"n\">lake</span> <span class=\"n\">exe</span> <span class=\"n\">cache</span> <span class=\"n\">get</span>   <span class=\"bp\">#</span> <span class=\"k\">if</span> <span class=\"n\">dep.</span> <span class=\"n\">on</span> <span class=\"n\">mathlib</span>\n<span class=\"n\">lake</span> <span class=\"n\">build</span>\n</code></pre></div>\n<p>That way you get the compatible versions of lean + packages that a project used. <code>lake update</code> changes the <code>lake-manifest.json</code> but unfortunately expects that you update the <code>lean-toolchain</code> by hand, leaving you in the errorstate you experience above with incompatible versions.</p>\n<p>as upshot, when building packages locally it's best to build them first with unmodified <code>lake-manifest.json</code> and <code>lean-toolchain</code> before trying to update the packages it depends on<span aria-label=\"blush\" class=\"emoji emoji-1f60a\" role=\"img\" title=\"blush\">:blush:</span></p>\n<p>(regardless, Ill see that the NNG4<code>main</code> branch gets updated soon)</p>\n</blockquote>\n<p>Thank you so much for the suggestion. It works well for me now!<br>\nThe errors were indeed caused by the command <code>lake update</code> and the manually edited version of LEAN4.</p>",
        "id": 388269018,
        "sender_full_name": "RexWang",
        "timestamp": 1693468191
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"572535\">RexWang</span> has marked this topic as resolved.</p>",
        "id": 388271410,
        "sender_full_name": "Notification Bot",
        "timestamp": 1693469148
    }
]