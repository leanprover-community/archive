[
    {
        "content": "<p>Hello! When using a Fin (Nat) in a structure or inductive, I have to provide an <code>n</code> each time the structure's type is used. Is it possible to avoid having to specify an <code>n</code> each time?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">FinNat</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">fn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">FinNat</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FinNat</span>\n\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">UseFinNat</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">haveFn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FinNat</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"c1\">-- Is there a way to say just use a specified `n`, so I don't need to provide an `n` each time?</span>\n\n<span class=\"c1\">-- Same as above, can I specify a specific `n`, and avoid having to pass an `n` each time?</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">UseFinNatDef</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FinNat</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">FinNat</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">FinNat</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">n₁</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">n₂</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 524146310,
        "sender_full_name": "An Qi Zhang",
        "timestamp": 1750009627
    },
    {
        "content": "<p>Can you give an example?</p>",
        "id": 524146573,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750010017
    },
    {
        "content": "<p>Just as in the code snippet above, if I define an inductive (for example, <code>FinNat</code>), every time I use <code>FinNat</code> in a <code>def : FinNat n -&gt; FinNat n</code>, I have to specify <code>FinNat n</code>. But instead, if I could just say the inductive <code>FinNat</code> uses a specified <code>n</code>, and then I could avoid having to pass an <code>n</code> in a def like <code>def : FinNat -&gt; FinNat</code></p>\n<p>So if I could write something like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">FinNat</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">fn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">FinNat</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FinNat</span>\n\n<span class=\"c1\">-- Instead of this:</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FinNat</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">FinNat</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">n1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"c1\">-- something like this:</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FinNat</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">FinNat</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">n1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 524146727,
        "sender_full_name": "An Qi Zhang",
        "timestamp": 1750010256
    },
    {
        "content": "<p>What do you mean by \"specified <code>n</code>\"?</p>",
        "id": 524146852,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750010436
    },
    {
        "content": "<p>If I have an <code>n</code>, for example, one defined by <code>variable (n : Nat)</code>, can I just use that <code>n</code> with the definition of <code>inductive FinNat</code>?</p>",
        "id": 524146992,
        "sender_full_name": "An Qi Zhang",
        "timestamp": 1750010536
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">FinNat'</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">fn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">FinNat'</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FinNat'</span>\n\n<span class=\"c1\">-- this will capture whatever in the context is called `n`</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">quotPrecheck</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"s2\">\"FinNat\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">FinNat'</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FinNat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FinNat</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 524147157,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750010735
    },
    {
        "content": "<p>I see, so I assume with this approach, every new type def that uses FinNat (FinNat' n) will need a new <code>notation</code> added for it?</p>\n<p>for example:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">FinNat'</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">fn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">FinNat'</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FinNat'</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">quotPrecheck</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"s2\">\"FinNat\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">FinNat'</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">NewFinNat'</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">fnfn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FinNat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">NewFinNat'</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">quotPrecheck</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"s2\">\"NewFinNat\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">NewFinNat'</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"c1\">-- Every type that uses FinNat needs a new notation added.</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">FinSetFN'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">NewFinNat</span><span class=\"w\"> </span><span class=\"c1\">-- lean accepts this</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">FinSetFN''</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">NewFinNat'</span><span class=\"w\"> </span><span class=\"c1\">-- lean requires a Nat</span>\n</code></pre></div>",
        "id": 524147792,
        "sender_full_name": "An Qi Zhang",
        "timestamp": 1750011565
    },
    {
        "content": "<p>I guess? I heard there was a better way in Lean 3, but it didn't make it into Lean 4.</p>",
        "id": 524147901,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750011682
    },
    {
        "content": "<p>So, when I take the above as a file, and import it like so:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">FinNatMWE</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">UseFinNat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">FinNat</span><span class=\"w\"> </span><span class=\"c1\">-- error: unknown constant 'n✝'</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">UseFinNat'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">FinNat</span><span class=\"w\"> </span><span class=\"c1\">-- error: unknown constant 'n✝'</span>\n</code></pre></div>\n<p>Any other def that uses the <code>FinNat defined by </code>notation<code>throws an error, saying </code>n✝` is an unknown constant. Is there a fix for this?</p>",
        "id": 524159771,
        "sender_full_name": "An Qi Zhang",
        "timestamp": 1750027126
    },
    {
        "content": "<p><code>variable (n : Nat)</code> does <em>not</em> mean \"let n be a natural\", it means \"if the user ever mentions n later on in the file then write \"for all naturals n,\" just in front of it\". So your errors are expected.</p>",
        "id": 524185998,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1750055173
    }
]