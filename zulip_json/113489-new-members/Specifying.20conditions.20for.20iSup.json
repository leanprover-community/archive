[
    {
        "content": "<p>Hello, </p>\n<p>I am trying to right a somewhat complex condition to take a supremum over. I have the following: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">ExampleStruct</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">ExampleField</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Substructure</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ExampleStruct</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CompleteLattice</span><span class=\"w\"> </span><span class=\"n\">ExampleStruct</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ExampleStruct</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">ExLemma</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Substructure</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Substructure</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"bp\">.</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ExampleStruct</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"bp\">.</span><span class=\"n\">S</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"bp\">.</span><span class=\"n\">S</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Instead of <code>Z = _</code> (placeholder), I would like to express <code>Z = ⨆ (A : J.S, ∃ B : I.S, A ∈ d B), A</code>, so Z is the supremum of all the elements of J.S that are also in the image of some B in I.S. This wording does not please Lean, and Mathlib.Order.CompleteLattice does not give documentation for writing more complex supremums like this. </p>\n<p>What is the proper way to write this expression? I am thinking I could maybe just define a large set X to be the union of d B for all B, and then simply take the supremum for A in X, but that sounds like it would lead me away from API.</p>",
        "id": 471043806,
        "sender_full_name": "VayusElytra",
        "timestamp": 1726593561
    },
    {
        "content": "<p>one way is to take a nested supremum, where the inner supremum is over the proofs that the condition holds, i.e. something like this: <code>⨆ (A : J.S), ⨆ (_:∃ B : I.S, A ∈ d B), A</code> (which i think may even simplify to <code>⨆ (A : J.S), ⨆ (B : I.S),⨆ (_: A ∈ d B), A</code> in this case). if you don't like the nestedness, you could opt for taking the supremum of <code>⨆ ( A' : {A : J.S // ∃ B : I.S, A ∈ d B}), A'.val</code></p>",
        "id": 471237465,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1726659637
    },
    {
        "content": "<p>Thank you! I think that should work really well. </p>\n<p>I'll add one more question that feels very stupid and doesn't deserve to make an entirely new discussion on: in the same context, I have: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DivisionRing</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ModuleCat</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Submodule</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Inhabited</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">]</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">LT_of_submod</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">⊔</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>I was looking through the documentation of Submonoid to find if there was some theorem that would give me this result instantly, but I could not find one. Is there a trivial way of doing this?</p>",
        "id": 471319801,
        "sender_full_name": "VayusElytra",
        "timestamp": 1726683031
    },
    {
        "content": "<p>Is it true? What if A=B?</p>",
        "id": 471327367,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1726685858
    },
    {
        "content": "<p>You're right of course; I need to specify that the setting I am in, these submodules are embedded into Z differently, so they cannot be equal to or included in each other. I think I need to review my implementation in a bit more detail before I work on this, thank you.</p>",
        "id": 471338055,
        "sender_full_name": "VayusElytra",
        "timestamp": 1726689483
    },
    {
        "content": "<p>Maybe you want to prove it under the assumption that there's an element of Z which is in B but not A.</p>",
        "id": 471340884,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1726690549
    }
]