[
    {
        "content": "<p>Hi,<br>\nI would like to implement an notation for Turing machine that mimics this notation: <a href=\"https://wiki.bbchallenge.org/wiki/Turing_machine#Standard_text_format\">https://wiki.bbchallenge.org/wiki/Turing_machine#Standard_text_format</a></p>\n<p>I don't know if this is possible or if anyone had experience implementing similar notations. I am fine learning how to handle elaboration and stuff like that by the way, but would greatly appreciate any guidance.</p>\n<p>My formalisation of Turing machines is there by the way: <a href=\"https://git.sr.ht/~vigoux/busybeaver/tree/master/item/Busybeaver/Basic.lean#L69\">https://git.sr.ht/~vigoux/busybeaver/tree/master/item/Busybeaver/Basic.lean#L69</a></p>",
        "id": 465365863,
        "sender_full_name": "Thomas Vigouroux",
        "timestamp": 1724746936
    },
    {
        "content": "<p>Are you interested in parsing <br>\n<a href=\"/user_uploads/3121/I7YFhJh0DCvRmr3A1_xErWRs/image.png\">image.png</a><br>\nto a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=TuringMachine#doc\">docs#TuringMachine</a> term?</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/I7YFhJh0DCvRmr3A1_xErWRs/image.png\" title=\"image.png\"><img data-original-dimensions=\"110x141\" src=\"/user_uploads/thumbnail/3121/I7YFhJh0DCvRmr3A1_xErWRs/image.png/840x560.webp\"></a></div><p>Or do you also want to use the notation <br>\n<a href=\"/user_uploads/3121/MggsIPMWVdm2_sNHGAz6kG6F/image.png\">image.png</a><br>\nfor describing the computation?</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/MggsIPMWVdm2_sNHGAz6kG6F/image.png\" title=\"image.png\"><img data-original-dimensions=\"138x135\" src=\"/user_uploads/thumbnail/3121/MggsIPMWVdm2_sNHGAz6kG6F/image.png/840x560.webp\"></a></div>",
        "id": 465399873,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1724754154
    },
    {
        "content": "<p>I'd say both</p>",
        "id": 465401642,
        "sender_full_name": "Thomas Vigouroux",
        "timestamp": 1724754455
    },
    {
        "content": "<p>Regarding the latter notation, would writing something like <code>⟨[0, 0, 0], A, 0, [0, 0, 0]⟩</code> be good enough?<br>\nOr do you actually want to require single-character identifiers, no delimiters, and so on?</p>",
        "id": 465430501,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1724761097
    },
    {
        "content": "<p>For this I already have a notation actually, which resembles this</p>",
        "id": 465430701,
        "sender_full_name": "Thomas Vigouroux",
        "timestamp": 1724761138
    },
    {
        "content": "<p>And I think it is fine writing them like this</p>",
        "id": 465430755,
        "sender_full_name": "Thomas Vigouroux",
        "timestamp": 1724761149
    },
    {
        "content": "<p>Or at least, we can postpone such considerations to later</p>",
        "id": 465430805,
        "sender_full_name": "Thomas Vigouroux",
        "timestamp": 1724761169
    },
    {
        "content": "<p>Thanks for your time by the way !</p>",
        "id": 465430817,
        "sender_full_name": "Thomas Vigouroux",
        "timestamp": 1724761177
    },
    {
        "content": "<p>I am trying to have this working but I am stuck, here is my current implementation:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c\">/-</span>\n<span class=\"cm\">Parsing machines in standard format for convenience.</span>\n<span class=\"cm\">-/</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Busybeaver</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">Elab</span>\n\n<span class=\"n\">declare_syntax_cat</span><span class=\"w\"> </span><span class=\"n\">dir</span>\n\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"L\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">dir</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"R\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">dir</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">elabDir</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Syntax</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">MetaM</span><span class=\"w\"> </span><span class=\"n\">Expr</span>\n<span class=\"w\">  </span><span class=\"c1\">-- `mkAppM` creates an `Expr.app`, given the function `Name` and the args</span>\n<span class=\"w\">  </span><span class=\"c1\">-- `mkNatLit` creates an `Expr` from a `Nat`</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">mkAppM</span><span class=\"w\"> </span><span class=\"ss\">``Turing.Dir.left</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[]</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">mkAppM</span><span class=\"w\"> </span><span class=\"ss\">``Turing.Dir.right</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[]</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">throwUnsupportedSyntax</span>\n\n<span class=\"n\">declare_syntax_cat</span><span class=\"w\"> </span><span class=\"n\">symbol</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"n\">num</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">symbol</span>\n\n<span class=\"n\">declare_syntax_cat</span><span class=\"w\"> </span><span class=\"n\">label</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"A\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">label</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"B\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">label</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"C\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">label</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"D\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">label</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"E\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">label</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"F\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">label</span>\n\n<span class=\"n\">declare_syntax_cat</span><span class=\"w\"> </span><span class=\"n\">stmt</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"n\">symbol</span><span class=\"w\"> </span><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"n\">label</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stmt</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"...\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stmt</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">elabStmt</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Syntax</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">MetaM</span><span class=\"w\"> </span><span class=\"n\">Expr</span>\n<span class=\"w\">  </span><span class=\"c1\">-- `mkAppM` creates an `Expr.app`, given the function `Name` and the args</span>\n<span class=\"w\">  </span><span class=\"c1\">-- `mkNatLit` creates an `Expr` from a `Nat`</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">stmt</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">mkAppM</span><span class=\"w\"> </span><span class=\"ss\">``TM.Stmt.halt</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[]</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">stmt</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">S</span><span class=\"o\">:</span><span class=\"n\">symbol</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">D</span><span class=\"o\">:</span><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">L</span><span class=\"o\">:</span><span class=\"n\">label</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span><span class=\"w\"> </span><span class=\"n\">dbg_trace</span><span class=\"w\"> </span><span class=\"s2\">\"stmt\"</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">throwUnsupportedSyntax</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">throwUnsupportedSyntax</span>\n\n<span class=\"kn\">elab</span><span class=\"w\"> </span><span class=\"s2\">\"test_elab \"</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">:</span><span class=\"n\">stmt</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">elabStmt</span><span class=\"w\"> </span><span class=\"n\">l</span>\n\n<span class=\"bp\">#</span><span class=\"n\">reduce</span><span class=\"w\"> </span><span class=\"n\">test_elab</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n</code></pre></div>",
        "id": 466216120,
        "sender_full_name": "Thomas Vigouroux",
        "timestamp": 1725011138
    }
]