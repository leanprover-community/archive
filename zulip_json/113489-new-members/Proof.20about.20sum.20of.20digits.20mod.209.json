[
    {
        "content": "<p>I proved a theorem that n mod 9 is equal to the sum of the digits of n mod 9. However, I feel like the last step is probably provable in a more simple way. Is there a way to make it simpler? I am also wondering about the difference between <code>Nat.digits 10 n</code> and <code>n.digits 10</code>. It seems like they should be the same, but I couldn't figure out the tactic to show their equivalence. Thanks!</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">divisible_by_nine_iff_sum_digits_divisible_by_nine</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"mi\">9</span><span class=\"w\"> </span><span class=\"bp\">∣</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"mi\">9</span><span class=\"w\"> </span><span class=\"bp\">∣</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">digits</span><span class=\"w\"> </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">sum</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">≡</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">digits</span><span class=\"w\"> </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">sum</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MOD</span><span class=\"w\"> </span><span class=\"mi\">9</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h_aux</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"mi\">9</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">modEq_digits_sum</span><span class=\"w\"> </span><span class=\"mi\">9</span><span class=\"w\"> </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">h_aux</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">modEq_zero_iff_dvd</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">modEq_zero_iff_dvd</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">ModEq</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">ModEq</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">ModEq</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">ModEq</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">ModEq</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">ModEq</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">)))</span>\n</code></pre></div>",
        "id": 510778671,
        "sender_full_name": "Alex Gu",
        "timestamp": 1744065456
    },
    {
        "content": "<blockquote>\n<p>I am also wondering about the difference between <code>Nat.digits 10 n</code> and <code>n.digits 10</code>. It seems like they should be the same, but I couldn't figure out the tactic to show their equivalence.</p>\n</blockquote>\n<p>They are literally the same thing after parsing, the tactic to show their equivalence is <code>rfl</code></p>",
        "id": 510779021,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1744065653
    },
    {
        "content": "<p><code>n.digits 10</code> is just syntax sugar for <code>Nat.digits 10 n</code></p>",
        "id": 510779040,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1744065665
    },
    {
        "content": "<p>it's not syntax sugar for <code>Nat.digits n 10</code>?</p>",
        "id": 510779118,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1744065720
    },
    {
        "content": "<p>ah, indeed the arguments are flipped, <code>n.digits 10</code> is the digits of 10 in base n</p>",
        "id": 510779274,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1744065799
    },
    {
        "content": "<p>so probably not what you want</p>",
        "id": 510779289,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1744065808
    },
    {
        "content": "<p><code>10.digits n</code> doesn't parse, but <code>(10).digits n</code> does and is equivalent to <code>Nat.digits 10 n</code></p>",
        "id": 510779441,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1744065889
    },
    {
        "content": "<p>is this explicitly defined somewhere in the source code (and how can I find it)?</p>",
        "id": 510779668,
        "sender_full_name": "Alex Gu",
        "timestamp": 1744066032
    },
    {
        "content": "<p>and why in the world does <code>10.digits n</code> not parse <span aria-label=\"laughter tears\" class=\"emoji emoji-1f602\" role=\"img\" title=\"laughter tears\">:laughter_tears:</span></p>",
        "id": 510779762,
        "sender_full_name": "Alex Gu",
        "timestamp": 1744066085
    },
    {
        "content": "<p>It's described in <a href=\"https://lean-lang.org/doc/reference/latest////Terms/Function-Application/#generalized-field-notation\">https://lean-lang.org/doc/reference/latest////Terms/Function-Application/#generalized-field-notation</a></p>",
        "id": 510779856,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1744066166
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"437569\">Alex Gu</span> <a href=\"#narrow/channel/113489-new-members/topic/Proof.20about.20sum.20of.20digits.20mod.209/near/510779762\">said</a>:</p>\n<blockquote>\n<p>and why in the world does <code>10.digits n</code> not parse <span aria-label=\"laughter tears\" class=\"emoji emoji-1f602\" role=\"img\" title=\"laughter tears\">:laughter_tears:</span></p>\n</blockquote>\n<p>gotta love float parser shenanigans</p>",
        "id": 510779870,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1744066181
    },
    {
        "content": "<p><span aria-label=\"this\" class=\"emoji emoji-1f446\" role=\"img\" title=\"this\">:this:</span> <span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> are you in the mood for another random parser issue to fix?</p>",
        "id": 510780030,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1744066265
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"437569\">@Alex Gu</span> re: cleaning up the proof, one small thing would be to remove the <code>id</code> function calls, as they don't accomplish anything</p>",
        "id": 510780282,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1744066398
    },
    {
        "content": "<p>you can significantly shorten the last two lines using \"generalized field notation\":</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n</code></pre></div>",
        "id": 510780649,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1744066605
    },
    {
        "content": "<p>also the double <code>symm</code> on the last line is redundant</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">a</span>\n</code></pre></div>",
        "id": 510780746,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1744066658
    },
    {
        "content": "<p>and if you're feeling <span aria-label=\"chili pepper\" class=\"emoji emoji-1f336\" role=\"img\" title=\"chili pepper\">:chili_pepper:</span> <code>(h.trans ·)</code></p>",
        "id": 510782338,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1744067478
    },
    {
        "content": "<p>or just <code>h.trans</code></p>",
        "id": 510782385,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1744067515
    }
]