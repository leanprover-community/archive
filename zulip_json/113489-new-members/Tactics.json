[
    {
        "content": "<p>I'm not fully grasping  what the tactics are doing in this proof. I've written a comment that is how I'm thinking of it on paper but not sure if that's correct.</p>\n<div class=\"codehilite\"><pre><span></span>        <span class=\"kn\">theorem</span> <span class=\"n\">even_plus_even2</span> <span class=\"o\">{</span><span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">}</span>\n            <span class=\"o\">(</span><span class=\"n\">h1</span> <span class=\"o\">:</span> <span class=\"n\">is_even</span> <span class=\"n\">a</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h2</span> <span class=\"o\">:</span> <span class=\"n\">is_even</span> <span class=\"n\">b</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">is_even</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"bp\">+</span> <span class=\"n\">b</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n                <span class=\"k\">match</span> <span class=\"n\">h1</span><span class=\"o\">,</span> <span class=\"n\">h2</span> <span class=\"k\">with</span>\n                    <span class=\"bp\">⟨</span><span class=\"n\">w1</span><span class=\"o\">,</span> <span class=\"n\">hw1</span><span class=\"bp\">⟩</span><span class=\"o\">,</span> <span class=\"bp\">⟨</span><span class=\"n\">w2</span><span class=\"o\">,</span> <span class=\"n\">hw2</span><span class=\"bp\">⟩</span> <span class=\"o\">:=</span> <span class=\"bp\">⟨</span><span class=\"n\">w1</span> <span class=\"bp\">+</span> <span class=\"n\">w2</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">hw1</span><span class=\"o\">,</span> <span class=\"n\">hw2</span><span class=\"o\">,</span> <span class=\"n\">mul_add</span><span class=\"o\">]</span><span class=\"bp\">⟩</span>\n                <span class=\"kn\">end</span>\n        <span class=\"c\">/-</span><span class=\"cm\"></span>\n<span class=\"cm\">        ∃ w1, a = 2 * w1</span>\n<span class=\"cm\">        w1 : ℕ</span>\n<span class=\"cm\">        hw1 : a = 2 * w1</span>\n<span class=\"cm\">        ∃ w2, b = 2 * w2</span>\n<span class=\"cm\">        w2 : ℕ</span>\n<span class=\"cm\">        hw2 : b = 2 * w2</span>\n<span class=\"cm\">        w1 = a/2, w2 = b/2</span>\n<span class=\"cm\">        w1 + w2 = a/2 + b/2</span>\n<span class=\"cm\">        a + b = 2 * (w1 + w2)</span>\n<span class=\"cm\">        -/</span>\n</pre></div>",
        "id": 195318228,
        "sender_full_name": "Brandon B",
        "timestamp": 1587878399
    },
    {
        "content": "<p>This proof looks okay (but you didn't provide a MWE). What error do you get?</p>",
        "id": 195318664,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1587879334
    },
    {
        "content": "<p>Or is the proof correct and you don't understand how it works?</p>",
        "id": 195318727,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1587879439
    },
    {
        "content": "<p>The proof is correct I'm just trying to understand what's going on under the hood</p>",
        "id": 195318769,
        "sender_full_name": "Brandon B",
        "timestamp": 1587879497
    },
    {
        "content": "<p>Actually there aren't really any tactics in this proof except <code>rw</code>. The <code>match</code> is pattern matching on <code>h1</code> and <code>h2</code>, which are existential statements once you unfold the definition of <code>is_even</code>, to produce <code>w1</code> and <code>hw1 : a = 2 * w1</code> and similarly for <code>w2</code></p>",
        "id": 195318771,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1587879510
    },
    {
        "content": "<p>yeah I understand match I just dont fully understand the <code>,by rw [hw1, hw2, mul_add]</code></p>",
        "id": 195318779,
        "sender_full_name": "Brandon B",
        "timestamp": 1587879542
    },
    {
        "content": "<p>The right hand side is similarly building an existential proof saying <code>w1 + w2</code> suffices, and so the <code>by rw</code> proof needs to prove <code>a + b = 2 * (w1 + w2)</code></p>",
        "id": 195318783,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1587879554
    },
    {
        "content": "<p>Then the rewrites respectively change the goal to <code>2 * w1 + b = 2 * (w1 + w2)</code> and <code>2 * w1 + 2 * w2 = 2 * (w1 + w2)</code>, and the final <code>mul_add</code> rewrites the right hand side to <code>2 * w1 + 2 * w2 = 2 * w1 + 2 * w2</code>. Since this is true by reflexivity it closes the goal</p>",
        "id": 195318828,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1587879626
    },
    {
        "content": "<p>At least, that's what the lean in my head would do, since that's not an MWE I can't test it</p>",
        "id": 195318835,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1587879651
    },
    {
        "content": "<p>Ohhh that makes sense, thanks!</p>",
        "id": 195318882,
        "sender_full_name": "Brandon B",
        "timestamp": 1587879739
    },
    {
        "content": "<p>So rewrite is a substitution rule</p>",
        "id": 195318887,
        "sender_full_name": "Brandon B",
        "timestamp": 1587879761
    },
    {
        "content": "<p>you can also expand <code>by rw [a, b, c]</code> into <code>begin rw a, rw b, rw c, end</code> and step through it</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">theorem</span> <span class=\"n\">even_plus_even2</span> <span class=\"o\">{</span><span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">}</span>\n    <span class=\"o\">(</span><span class=\"n\">h1</span> <span class=\"o\">:</span> <span class=\"n\">is_even</span> <span class=\"n\">a</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h2</span> <span class=\"o\">:</span> <span class=\"n\">is_even</span> <span class=\"n\">b</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">is_even</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"bp\">+</span> <span class=\"n\">b</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n        <span class=\"k\">match</span> <span class=\"n\">h1</span><span class=\"o\">,</span> <span class=\"n\">h2</span> <span class=\"k\">with</span>\n            <span class=\"bp\">⟨</span><span class=\"n\">w1</span><span class=\"o\">,</span> <span class=\"n\">hw1</span><span class=\"bp\">⟩</span><span class=\"o\">,</span> <span class=\"bp\">⟨</span><span class=\"n\">w2</span><span class=\"o\">,</span> <span class=\"n\">hw2</span><span class=\"bp\">⟩</span> <span class=\"o\">:=</span> <span class=\"bp\">⟨</span><span class=\"n\">w1</span> <span class=\"bp\">+</span> <span class=\"n\">w2</span><span class=\"o\">,</span> <span class=\"k\">begin</span>\n              <span class=\"n\">rw</span> <span class=\"n\">hw1</span><span class=\"o\">,</span>\n              <span class=\"n\">rw</span> <span class=\"n\">hw2</span><span class=\"o\">,</span>\n              <span class=\"n\">rw</span> <span class=\"n\">mul_add</span><span class=\"o\">,</span>\n              <span class=\"kn\">end</span><span class=\"bp\">⟩</span>\n        <span class=\"kn\">end</span>\n <span class=\"bp\">```</span>\n</pre></div>",
        "id": 195318888,
        "sender_full_name": "Frank Dai",
        "timestamp": 1587879764
    },
    {
        "content": "<p>You should be able to step through it even if it is in <code>rw [a,b,c]</code> form</p>",
        "id": 195318891,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1587879790
    },
    {
        "content": "<p>this is one of the special privileges of the <code>rw</code> tactic</p>",
        "id": 195318892,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1587879812
    },
    {
        "content": "<p>How does mul_add know to apply to the right hand side of the equation?</p>",
        "id": 195318992,
        "sender_full_name": "Brandon B",
        "timestamp": 1587879999
    },
    {
        "content": "<p>rw is rewriting terms on the LHS but mul_add works on the RHS.</p>",
        "id": 195319004,
        "sender_full_name": "Brandon B",
        "timestamp": 1587880024
    },
    {
        "content": "<p><code>⊢ 2 * w1 + 2 * w2 = 2 * (w1 + w2)</code></p>",
        "id": 195319013,
        "sender_full_name": "Brandon B",
        "timestamp": 1587880045
    },
    {
        "content": "<p><code>rw</code> will try to find the LHS of the input theorem anywhere in the goal, including on the RHS of the equality if the goal happens to be an equality</p>",
        "id": 195319108,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1587880225
    },
    {
        "content": "<p>If you used mul_add the other way around, that is <code>rw &lt;- mul_add</code>, then it would try to find <code>a * b + a * c</code> somewhere in the goal instead. In this case it would still succeed, rewriting the LHS and resulting in <code>2 * (w1 + w2) = 2 * (w1 + w2)</code> which is also reflexivity</p>",
        "id": 195319119,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1587880297
    },
    {
        "content": "<p>When we use tactics, what exactly is happening? Is it replacing the tactic command with lambda expressions under-the-hood? Doesn't everything ultimately need to be reduced to lambda expressions for type checking?</p>",
        "id": 195319239,
        "sender_full_name": "Brandon B",
        "timestamp": 1587880555
    }
]