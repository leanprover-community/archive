[
    {
        "content": "<p>Hi, so I was playing around with exercise 3 in <a href=\"https://leanprover.github.io/theorem_proving_in_lean4/induction_and_recursion.html\">Induction and Recursion</a> to define <code>WellFounded.fix</code> and got another weird error with universe levels. I realized that using <code>Acc</code> seemingly wouldn't work because it's of type <code>Prop</code> and thus can only eliminate to <code>Prop</code>. So I decided to define my own version like so:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">AccAttack</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">AccAttack</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AccAttack</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>\n<p>and then</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">myBelow</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">AccAttack</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AccAttack</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">AccAttack</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hrya</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">myBelow</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hrya</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hrya</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\">  </span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hrya</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AccAttack</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">myBelow</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"n\">t</span>\n</code></pre></div>\n<p>I tried to define my own <code>brecOn</code> like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">accAttackBrecOn</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">AccAttack</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AccAttack</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">myBelow</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AccAttack</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">rec</span><span class=\"w\"> </span><span class=\"n\">buildBelow</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AccAttack</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">myBelow</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">AccAttack</span><span class=\"bp\">.</span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">hy_ryx_accry</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">myBelow</span><span class=\"bp\">.</span><span class=\"n\">intro</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hrya</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">buildBelow</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hy_ryx_accry</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hrya</span><span class=\"o\">))</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hrya</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hy_ryx_accry</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hrya</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">buildBelow</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hy_ryx_accry</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hrya</span><span class=\"o\">)))</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"n\">AccAttack</span><span class=\"bp\">.</span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">hy_ryx_accry</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>It gives a failure to prove termination error for <code>buildBelow</code>, saying</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Cannot</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">parameter</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">invalid</span><span class=\"w\"> </span><span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">level</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">greater</span><span class=\"w\"> </span><span class=\"n\">than</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n</code></pre></div>\n<p>Except, isn't <code>max (u+1) v</code> always guaranteed to be greater than 0? It's not <code>imax</code>.</p>\n<p>If I change it to <code>Type (max u v)</code> it works fine.</p>",
        "id": 498933273,
        "sender_full_name": "Perrin Alaine-Sedano",
        "timestamp": 1739252870
    },
    {
        "content": "<p>That \"is not greater than <code>0</code>\" comes from an error generated by trying to decrement 1 from a universe level. I'm guessing some step is trying to turn <code>Sort foo</code> to <code>Type foo'</code> by solving for a <code>foo'</code> such that <code>foo = foo' + 1</code> (with <code>foo</code> being <code>max (u + 1) v</code>).</p>",
        "id": 498934339,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739253497
    },
    {
        "content": "<p>So, yes, <code>max (u + 1) v</code> is greater than <code>0</code>, but it can't see that by decrementing.</p>\n<p>I'm not sure which part exactly is doing this, though the \"cannot use parameter\" error seems to be <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Elab.Structural.tryAllArgs#doc\">docs#Lean.Elab.Structural.tryAllArgs</a>, part of the structural recursion system.</p>",
        "id": 498934439,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739253588
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span></p>\n<p>Thanks for explaining! Do you think my whole approach to solving this exercise is on the right track?</p>",
        "id": 498936098,
        "sender_full_name": "Perrin Alaine-Sedano",
        "timestamp": 1739254511
    },
    {
        "content": "<p>It might be cheating to use recursion to define your own brecOn, since that lets you take advantage of however Lean de-recursifies it. Maybe it would be better to use recursors directly?</p>",
        "id": 498937034,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739255043
    },
    {
        "content": "<p>(Regarding <code>Sort (max 1 u)</code>, there was a recent discussion about \"why doesn't use Lean use this instead of <code>Sort (u + 1)</code>?\" This decrement failure is an interesting reason why not.)</p>",
        "id": 498937112,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739255099
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> Thanks. Is there a way I could do this using the built-in <code>Acc</code> instead? I thought of trying to use <code>termination_by</code> and <code>decreasing_by</code> but I'm not really sure how. For instance if <code>sizeOf</code> is a function from the type to <code>Nat</code> but it's not possible to eliminate <code>Acc</code> to anything but <code>Prop</code> then can it not be defined for <code>Acc</code>?</p>",
        "id": 499064131,
        "sender_full_name": "Perrin Alaine-Sedano",
        "timestamp": 1739295601
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"876078\">Perrin Alaine-Sedano</span> <a href=\"#narrow/channel/113489-new-members/topic/More.20weirdness.20with.20universe.20levels.3A.20max.20.28u.20.2B.201.29.20v.20not.20.3E.200.3F/near/498933273\">said</a>:</p>\n<blockquote>\n<p>I realized that using <code>Acc</code> seemingly wouldn't work because it's of type <code>Prop</code> and thus can only eliminate to <code>Prop</code>.</p>\n</blockquote>\n<p>Did you check that <code>Acc.rec</code> doesn't allow large elimination?</p>",
        "id": 499070567,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739297564
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> I think it does but it says it’s not supported by the code generator and I’d have to make the function non computable. I wanted to see if I could avoid this. Btw, is the reason <code>Acc.rec</code> and <code>WellFounded.fix</code> are non computable exactly this issue I’ve been running into, that inductive types of type <code>Prop</code> only eliminate to other types of type <code>Prop</code>?</p>",
        "id": 499079602,
        "sender_full_name": "Perrin Alaine-Sedano",
        "timestamp": 1739300684
    },
    {
        "content": "<p>No, noncomputability is an independent issue. That's simply that the current code generator doesn't support the recursors. Not even <code>Nat.rec</code> is supported (except by virtue of there being a <code>@[csimp]</code> lemma that replaces it with a compiled function that implements it).</p>\n<p>You can check that <code>Acc.rec</code> has large elimination: the <code>motive</code> argument takes values in <code>Sort u</code> rather than just <code>Prop</code>.</p>",
        "id": 499089062,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739304207
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> Oh, okay. Is there any way to use large elimination with <code>Acc</code> then without making it noncomputable? If I can't use <code>Acc.rec</code> directly I've tried pattern matching and it gives errors about the resulting type not being <code>Prop</code>, it seems like it's using <code>brecOn</code> by default</p>",
        "id": 499094333,
        "sender_full_name": "Perrin Alaine-Sedano",
        "timestamp": 1739306350
    },
    {
        "content": "<p>Can you say why you want the function to be noncomputable? That's just an extra hoop to jump through that doesn't have theoretical significance, and it's something you can probably solve afterwards with <code>@[csimp]</code> lemmas.</p>\n<p>I'd think a good first step is to use recursors directly (and avoid using <code>match</code> or recursive definitions, since these invoke high-powered machinery that can make use of Acc on your behalf) as an exercise to define <code>WellFounded.fix</code>.</p>",
        "id": 499096732,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739307381
    },
    {
        "content": "<p>Of course, it all depends on what your learning goals are. I just wouldn't worry about computability if you don't have a noncomputable version yet.</p>",
        "id": 499097035,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739307490
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> I want it to be computable, not noncomputable, which is why I was trying to avoid <code>Acc.rec</code> since it isn't supported by the code generator. Maybe I am overthinking all this though and should focus on the basics</p>",
        "id": 499105421,
        "sender_full_name": "Perrin Alaine-Sedano",
        "timestamp": 1739311038
    },
    {
        "content": "<p>I hear that, but I'm curious <em>why</em> you want computability. That's not a theoretical property. It's just a property of whether the code generator as it is implemented can compile it to C.</p>",
        "id": 499105513,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739311082
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> Partly just perfectionism I guess lol. Although also thought noncomputable might mean it can't be verified as correct by the kernel? Am I wrong about that?</p>",
        "id": 499105691,
        "sender_full_name": "Perrin Alaine-Sedano",
        "timestamp": 1739311147
    },
    {
        "content": "<p>Yes, that's wrong, and why I've been mentioning the code generator so much :-)</p>",
        "id": 499105746,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739311175
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> Ah okay. Thanks for clearing that up. So a noncomputable function can still type check correctly, can it not be run?</p>",
        "id": 499105957,
        "sender_full_name": "Perrin Alaine-Sedano",
        "timestamp": 1739311252
    },
    {
        "content": "<p>It can't be compiled into executables, that's all.</p>\n<p>It still can be \"run\" inside the kernel.</p>",
        "id": 499106007,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739311272
    },
    {
        "content": "<p>Sometimes <code>noncomputable</code> is indicative of truly unrunnable definitions, because of the axiom of choice for example, but not here.</p>",
        "id": 499106185,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739311338
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> Oh okay. There's still a ton I have to learn about this. Is the only disadvantage then that it would be much slower than an executable?</p>",
        "id": 499106259,
        "sender_full_name": "Perrin Alaine-Sedano",
        "timestamp": 1739311379
    },
    {
        "content": "<p>Sure, if you're wanting to evaluate functions.</p>\n<p>This has no bearing on kernel reasoning though (unless you accept using tactics like <code>native_decide</code>, which let the kernel call out to the compiler for answers)</p>",
        "id": 499108394,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739312389
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> Thanks! Sorry to be asking a ton of questions. There's one more thing I was wondering, is the fact that it's possible to do large elimination with <code>Acc</code> an instance of subsingleton elimination like I found <a href=\"https://lean-forward.github.io/logical-verification/2018/41_notes.html\">here</a>?</p>",
        "id": 499109281,
        "sender_full_name": "Perrin Alaine-Sedano",
        "timestamp": 1739312831
    },
    {
        "content": "<p>What I know about type theory I've picked up from using Lean, but that's my understanding!</p>",
        "id": 499109617,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739312990
    }
]