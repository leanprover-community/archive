[
    {
        "content": "<p>The Natural Numbers Game taught me that if you have <code>a b: ℕ</code> and <code>h:  a  ≤ b</code> you can use <code>cases</code> to introduce a variable <code>k</code> and convert the hypothesis to <code>h': a + k = b</code>.  A very observant person (which I wasn't until just now) can discover from the tooltips that NNG's <code>cases</code> behaves like mathlib's <code>cases'</code>.  However, use of <code>cases'</code> seems to be discouraged by <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Tactic/Cases.html#Mathlib.Tactic.cases'\">its own documentation</a>, and also I cannot persuade it to work when <code>a</code> and <code>b</code> are Int instead of Nat, for example</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">cases'</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">hm</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span><span class=\"cm\"> error here:</span>\n<span class=\"cm\">dependent elimination failed, failed to solve equation</span>\n<span class=\"cm\">  (match b, -a with</span>\n<span class=\"cm\">    | Int.ofNat m, Int.ofNat n =&gt; Int.ofNat (m + n)</span>\n<span class=\"cm\">    | Int.ofNat m, Int.negSucc n =&gt; Int.subNatNat m n.succ</span>\n<span class=\"cm\">    | Int.negSucc m, Int.ofNat n =&gt; Int.subNatNat n m.succ</span>\n<span class=\"cm\">    | Int.negSucc m, Int.negSucc n =&gt; Int.negSucc (m + n).succ) =</span>\n<span class=\"cm\">    Int.ofNat m</span>\n<span class=\"cm\">  -/</span>\n</code></pre></div>\n<p>What is the <em>preferred</em> way to rewrite <code>h:  a  ≤ b</code>and <code>h: a &lt; b</code> into <code>h': a + k = b</code> and <code>h': a + k + 1 = b</code> respectively, and what is the way that works for both Nat and Int?</p>",
        "id": 517861189,
        "sender_full_name": "Zack Weinberg",
        "timestamp": 1747149975
    },
    {
        "content": "<p>I would usually do something like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">k</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"bp\">.</span><span class=\"n\">exists_add_of_le</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>\n<p>Doing cases on <code>h</code> directly doesn't work — the definition of LE for Int is not this Exists-based one.</p>",
        "id": 517862789,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1747150384
    },
    {
        "content": "<p>The <code>obtain</code> tactic also has a feature where you can substitute <code>b</code> immediately, so long as <code>b</code> is a free variable (which it is in this particular application), using a <code>rfl</code> pattern.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">k</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"bp\">.</span><span class=\"n\">exists_add_of_le</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span>\n<span class=\"cm\">  k : ℕ</span>\n<span class=\"cm\">  h : a ≤ a + ↑k</span>\n<span class=\"cm\">  ⊢ ∃ k_1, a + ↑k_1 = a + ↑k</span>\n<span class=\"cm\">  -/</span>\n</code></pre></div>",
        "id": 517863101,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1747150466
    },
    {
        "content": "<p><code>obtain</code> is exactly what I was looking for, thank you.</p>",
        "id": 517867886,
        "sender_full_name": "Zack Weinberg",
        "timestamp": 1747151736
    },
    {
        "content": "<p>There's also <code>rcases</code> but I prefer <code>obtain</code> because it's a word.</p>",
        "id": 517870134,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1747152294
    },
    {
        "content": "<p>There's also a more general <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=exists_add_of_le#doc\">docs#exists_add_of_le</a></p>",
        "id": 517910453,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1747165610
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"902878\">Zack Weinberg</span> has marked this topic as resolved.</p>",
        "id": 517913347,
        "sender_full_name": "Notification Bot",
        "timestamp": 1747166625
    }
]