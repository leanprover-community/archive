[
    {
        "content": "<p>I have just started (hence the channel!) and I had assumed that if I have<br>\n<code>require \"leanprover-community\" / \"mathlib\"</code> then I have mathlib4 but I'm struggling to import parts of mathlib4.  Tried:<br>\n<code>require \"leanprover-community\" / \"mathlib4\"</code> but on <code>lake update mathlib4</code> I get error: package 'mathlib' was required as 'mathlib4'<br>\ncan someone point me to a tutorial about using mathlib4 in a new project?  git finds mathlib4 ok but then :-(</p>",
        "id": 473363807,
        "sender_full_name": "Matthew Fairtlough",
        "timestamp": 1727541343
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"759359\">Matthew Fairtlough</span> <a href=\"#narrow/stream/113489-new-members/topic/mathlib.20vs.20mathlib4/near/473363807\">said</a>:</p>\n<blockquote>\n<p>but I'm struggling to import parts of mathlib4</p>\n</blockquote>\n<p>Can you expand?</p>",
        "id": 473364037,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1727541520
    },
    {
        "content": "<p>import Mathlib.Algebra.Ring or Mathlib.Algebra<br>\nactually in trying to fix this I've broken the whole project:<br>\nstderr:<br>\nerror: dependency 'mathlib4' not in manifest; use <code>lake update mathlib4</code> to add it<br>\nInvalid Lake configuration.  Please restart the server after fixing the Lake configuration file.<br>\nI did the update; the correct info seems to be in the manifest; lake still borked</p>",
        "id": 473364545,
        "sender_full_name": "Matthew Fairtlough",
        "timestamp": 1727541906
    },
    {
        "content": "<p>It would help if I knew what the original mathlib referred to as that's what  my lakefile required.  Is mathlib4 the bleeding edge (probably not what I need right now!) ?</p>",
        "id": 473364701,
        "sender_full_name": "Matthew Fairtlough",
        "timestamp": 1727542026
    },
    {
        "content": "<p>In the require line you should just use <code>\"mathlib\"</code></p>",
        "id": 473364793,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727542118
    },
    {
        "content": "<p>And in files you should import it as <code>import Mathlib.Foo</code></p>",
        "id": 473364805,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727542131
    },
    {
        "content": "<p>What determines the name that appears after <code>require</code>? Is it <code>$github_user / $lakefile_name</code> as opposed to <code>$github_user / $github_name</code>? Or is there some notion of a reservoir user that goes in the first position?</p>",
        "id": 473364899,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1727542204
    },
    {
        "content": "<p>the \"4\" exists only in the name of the github repository, <a href=\"https://github.com/leanprover-community/mathlib4\">https://github.com/leanprover-community/mathlib4</a> . So if you are using the old style require syntax it would be <code>require mathlib from \"https://github.com/leanprover-community/mathlib4\" @ \"master\"</code></p>",
        "id": 473364908,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727542209
    },
    {
        "content": "<p>The name that appears in the new require syntax is, confusingly, the github organization followed by the package name</p>",
        "id": 473364933,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727542241
    },
    {
        "content": "<p>What does reservoir do if two repos within the same github user declare the same package?</p>",
        "id": 473365025,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1727542324
    },
    {
        "content": "<p>it dies, probably</p>",
        "id": 473365041,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727542334
    },
    {
        "content": "<p>I've brought this issue up with <span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span> before</p>",
        "id": 473365061,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727542358
    },
    {
        "content": "<p>I guess the flipside is that this design lets you store multiple lake packages in the same github repo, and refer to them separately</p>",
        "id": 473365068,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1727542364
    },
    {
        "content": "<p>no, that doesn't really work either, we've had long discussions about that</p>",
        "id": 473365084,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727542384
    },
    {
        "content": "<p>ok thanks; going back now to reconstruct where I was at</p>",
        "id": 473365119,
        "sender_full_name": "Matthew Fairtlough",
        "timestamp": 1727542426
    },
    {
        "content": "<p>I would really like it to work but currently there are issues related to the fact that the thing inside <code>.lake/packages/foo</code> is a literal git checkout</p>",
        "id": 473365120,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727542428
    },
    {
        "content": "<p>I tried <code>import Mathlib.Algebra.Ring</code> following a Moogle search which links to source in mathlib4 but no dice; perhaps something should be built that wasn't but I did a <code>lake update mathlib</code> earlier.</p>",
        "id": 473365535,
        "sender_full_name": "Matthew Fairtlough",
        "timestamp": 1727542742
    },
    {
        "content": "<p>a hint from infoview: <code> `Mathlib.Algebra.Ring --no-build` failed </code></p>",
        "id": 473365861,
        "sender_full_name": "Matthew Fairtlough",
        "timestamp": 1727542975
    },
    {
        "content": "<p>what errors or messages do you get from <code>lake exe cache get</code> and/or <code>lake build</code> at the console?</p>",
        "id": 473366562,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727543438
    },
    {
        "content": "<p>lake exe cache get <br>\nNo files to download<br>\nDecompressing 5122 file(s)<br>\nUnpacked in 430 ms<br>\nCompleted successfully!</p>\n<p>Need to fix a bunch of red in my file before building...</p>",
        "id": 473366947,
        "sender_full_name": "Matthew Fairtlough",
        "timestamp": 1727543738
    },
    {
        "content": "<p>builds ok without Mathlib.Algebra.Ring; with it I get<br>\n➜  LaxLogic git:(main) ✗ lake build<br>\n✖ [5135/5137] Running Mathlib.Algebra.Ring<br>\nerror: no such file or directory (error code: 2)<br>\n  file: ././.lake/packages/mathlib/././Mathlib/Algebra/Ring.lean<br>\n✖ [5136/5137] Running LaxLogic<br>\nerror: ././././LaxLogic.lean: bad import 'Mathlib.Algebra.Ring'<br>\nSome required builds logged failures:</p>\n<ul>\n<li>Mathlib.Algebra.Ring</li>\n<li>LaxLogic<br>\nerror: build failed</li>\n</ul>",
        "id": 473368008,
        "sender_full_name": "Matthew Fairtlough",
        "timestamp": 1727544611
    },
    {
        "content": "<p>what's odd is that I do have <br>\n➜  LaxLogic git:(main) ✗ ls .lake/packages/mathlib/Mathlib/Algebra/Ring<br>\nAction               Center.lean          Defs.lean            Hom                  Invertible.lean      Parity.lean          Regular.lean         SumsOfSquares.lean<br>\nAddAut.lean          Centralizer.lean     Divisibility         Idempotents.lean     MinimalAxioms.lean   Pi.lean              Semiconj.lean        ULift.lean<br>\nAut.lean             CentroidHom.lean     Equiv.lean           Identities.lean      Nat.lean             Pointwise            Semireal             Units.lean<br>\nBasic.lean           Commute.lean         Ext.lean             InjSurj.lean         NegOnePow.lean       Prod.lean            Subring              WithZero.lean<br>\nBooleanRing.lean     CompTypeclasses.lean Fin.lean             Int.lean             Opposite.lean        Rat.lean             Subsemiring</p>",
        "id": 473368359,
        "sender_full_name": "Matthew Fairtlough",
        "timestamp": 1727544942
    },
    {
        "content": "<p>doh! </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Ring</span><span class=\"bp\">.</span><span class=\"n\">Defs</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Ring</span><span class=\"bp\">.</span><span class=\"n\">Nat</span>\n</code></pre></div>",
        "id": 473368592,
        "sender_full_name": "Matthew Fairtlough",
        "timestamp": 1727545108
    },
    {
        "content": "<p><code>Mathlib/Algebra/Ring</code> is a directory; ther is no file <code>Mathlib/Algebra/Ring.lean</code>. You can only import files.</p>",
        "id": 473368932,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1727545406
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"759359\">Matthew Fairtlough</span> has marked this topic as resolved.</p>",
        "id": 473371835,
        "sender_full_name": "Notification Bot",
        "timestamp": 1727547526
    }
]