[
    {
        "content": "<p>When I hit autocompletion button inside tactic mode I get list of all tactics:<br>\n<a href=\"/user_uploads/3121/47PKNmDDPxwV2TmrFH-YUVqE/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/47PKNmDDPxwV2TmrFH-YUVqE/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1920x1080\" src=\"/user_uploads/thumbnail/3121/47PKNmDDPxwV2TmrFH-YUVqE/image.png/840x560.webp\"></a></div><p>But this doesn't work for <code>conv</code> mode:<br>\n<a href=\"/user_uploads/3121/I-pkfI7rI2vPd9SCo5sqUA_s/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/I-pkfI7rI2vPd9SCo5sqUA_s/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1920x1080\" src=\"/user_uploads/thumbnail/3121/I-pkfI7rI2vPd9SCo5sqUA_s/image.png/840x560.webp\"></a></div><p>I haven't checked in VSCode, because I don't know how to open autocompletion popup there, but I would be surprised if it were working differently in VSCode.</p>\n<p>Could this be fixed? Also, is there maybe a list of all conv tactics somewhere in lean4 reference, or mathlib? Like <a href=\"https://leanprover-community.github.io/mathlib-manual/html-multi/Tactics/All-tactics/\">https://leanprover-community.github.io/mathlib-manual/html-multi/Tactics/All-tactics/</a></p>",
        "id": 568676533,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1768753484
    },
    {
        "content": "<p>Not very convenient but <code>#help conv</code></p>",
        "id": 568676825,
        "sender_full_name": "Mirek Olšák",
        "timestamp": 1768753758
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">HelpCmd</span>\n\n<span class=\"bp\">#</span><span class=\"n\">help</span><span class=\"w\"> </span><span class=\"n\">conv</span>\n</code></pre></div>",
        "id": 568676871,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1768753803
    },
    {
        "content": "<p>Hm, looks like doc-string for <code>dsimp?</code> got mixed up with doc-string of <code>simp?</code></p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>syntax \"dsimp?\"... [Lean.Parser.Tactic.Conv.dsimpTrace]\n  `simp?` takes the same arguments as `simp`, but reports an equivalent call to `simp only`\n  that would be sufficient to close the goal. See the `simp?` tactic for more information.\n</code></pre></div>",
        "id": 568677104,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1768754000
    },
    {
        "content": "<p>Also, I once wrote a meta-snippet to display all syntaxes (in <a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAGQKYEMB2AoUlZwEIowxJTBIDOGGAJkgGZwDKM1AdAGLQiGtRJgAbFAGMkzUmgDmcABR0Q8AFxMWHLoQCUs8jChxl44FK0HVnKNyUBeOJeEALOPPgB3YDHsY4cAD5xWxAAe8AD6cFYAfP5B8DpQXr7+aBTwRrRo8AyRSSlwaUgZsnS8/EKihlJwcRoJfqwoYGAF1HAocABG4VH1jc2yKCWCImK6RtLVHbX+klAQAK5gcNLtSPYoAG7A0F3TswuykoNlIxLjulora5vQUwEo0mhOO3cPRUfDFWdQNd5+YdnOKgQJqPZDoPKYWgMNAoEBIACy5GkMnI+hUpy0MkeyjBaFYADlYUgTIhUHj4RRyPckAARQhtRRWBICJDwJD6GwgADWAGEIGgdHBMN5WBA6AgUAAvACeCW8cjmj2EMECAH4dtQIHLvHAWak0HQIKjlOZLAB1dz2ACSBqNcEACYS2QgOODKtVwNwebU6xKsND89nZMBzPhwQCJhHJ1PAZDAIJ8qhofj6dXVyBA4a6VTtGnyBTBCXCLR4bYbUW6hd7dazbEiOXAKeQqZJafTRXRTYQi9bbajABfkRlLrGc73Ko0q5AANBDBwOjYBL8krfBgIceNOlMJAwGErG5NckSfldEVtnL2SMOnQMGAhARADUUFByHzQyBy+yfBFWABGVhrciMdcPFZLdGGgKBpRqDBgQKUlwQpGA2gAUSEToABURCvYQ4D5EBuDQFojBoehdWAHRmECbQs2UAtiX0bUcLw6hkJQdp4TgABVNB3DrTVmWrEA5ngWhhAEY0VDYVC+ARBo4DCMJhHTMAH3ZRk4AAbwAXz4+BhEIOsZAABQfcgSFYJTHxIRDggKcgtjxZsYGYG9ZEdBzELQdZE1YXTiEkaAyHIIc0gAQiqFVtLgAp1gdJZWXc9YEkNPQZC5KcQi0IxXR4Lk0lRXifWABg9SqdN2RgLkeIgfBCGIUgKFYdDlS3VgHIACVQahUIqmRHR6yKPKC/D1S5DRWHWFABDmJBVS0IDhWTYryrrcqAlIEBK2E0SeKQETAvPEh4CWmQZE2wKHJpOAloAYgAbQAXVG4NyEcEaIoE+AQFrVSGybFsEL9YABES7YsSJKcuXIDLHlOuB8p1JK4AqzKIdhrVkz3OtPukABqbGhSJREHiJRG4FxuAACIAB00HJ5kIEkEsqqxqgAFoWbgUKAE15liw77HZARSPgMVWgEARLowrdUX50NgowKBFRCYQQBaQWyKzAADBSPIwIA\">live lean</a>) with the possibility to hover over them. Looks like many standard tactics work too.</p>",
        "id": 568677236,
        "sender_full_name": "Mirek Olšák",
        "timestamp": 1768754119
    },
    {
        "content": "<p>Trying to reproduce <span class=\"user-mention\" data-user-id=\"870257\">@Jakub Nowak</span> OP made me realize the <code>module</code> system is breaking the tactic completions. Is this a known issue?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">module</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">sor</span><span class=\"w\"> </span><span class=\"c1\">-- place the cursor here, all completions are fully qualified names</span>\n</code></pre></div>",
        "id": 568677807,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1768754725
    },
    {
        "content": "<p>Hm, it looks it's broken with<code>module</code> because all names are  fully qualified:<br>\n<a href=\"/user_uploads/3121/gIgqbgDLBooAzVONKOJdsnUp/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/gIgqbgDLBooAzVONKOJdsnUp/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1920x1080\" src=\"/user_uploads/thumbnail/3121/gIgqbgDLBooAzVONKOJdsnUp/image.png/840x560.webp\"></a></div><p>But that fully qualified name completion is bonkers. Completing <code>sor</code> gives this, which doesn't work:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">module</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Parser</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">tacticSorry</span>\n</code></pre></div>",
        "id": 568678637,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1768755516
    },
    {
        "content": "<p>it's completing with the parser constant names, which have term-mode values but are not tactics</p>",
        "id": 568679220,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1768756010
    },
    {
        "content": "<p>compare</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">module</span>\n\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">Doc</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">Doc</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">docs</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">allTacticDocs</span>\n<span class=\"w\">  </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"n\">docs</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">TacticDoc</span><span class=\"bp\">.</span><span class=\"n\">userName</span>\n</code></pre></div>\n<p>and</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">Doc</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">Doc</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">docs</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">allTacticDocs</span>\n<span class=\"w\">  </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"n\">docs</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">TacticDoc</span><span class=\"bp\">.</span><span class=\"n\">userName</span>\n</code></pre></div>",
        "id": 568679348,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1768756104
    },
    {
        "content": "<p>Regarding the feature request in the OP: could you open an RFC in core?</p>\n<p>(I can already say that from an implementation perspective, this is likely pretty tricky. Completion in whitespace is pretty subtle, especially if you want it to make use of incrementality, and making it context-dependent on whether you're currently in a <code>conv</code> block or not is even more subtle.)</p>",
        "id": 568757405,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1768815478
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"870257\">Jakub Nowak</span> <a href=\"#narrow/channel/113489-new-members/topic/List.20of.20all.20conv.20tactics/near/568676533\">said</a>:</p>\n<blockquote>\n<p>is there maybe a list of all conv tactics somewhere in lean4 reference</p>\n</blockquote>\n<p>The <a href=\"https://lean-lang.org/doc/reference/latest/find/?domain=Verso.Genre.Manual.section&amp;name=conv\">reference manual section on <code>conv</code></a> contains a list of the tactics.</p>\n<p><span class=\"user-mention\" data-user-id=\"571941\">@Lua Viana Reis</span> <a href=\"https://github.com/leanprover/lean4/pull/12047\">#12047</a> fixes the first-token detection (using a strategy suggested by <span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span> - thanks!). This seems to fix the completion issue as well. Thank you for reporting it!</p>\n<p><a href=\"/user_uploads/3121/h17lHsK12uU6fcI1QAJ9pFsT/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/h17lHsK12uU6fcI1QAJ9pFsT/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1102x420\" src=\"/user_uploads/thumbnail/3121/h17lHsK12uU6fcI1QAJ9pFsT/image.png/840x560.webp\"></a></div>",
        "id": 568827089,
        "sender_full_name": "David Thrane Christiansen",
        "timestamp": 1768836198
    }
]