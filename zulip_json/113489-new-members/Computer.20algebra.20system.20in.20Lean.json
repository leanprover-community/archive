[
    {
        "content": "<p>Is there currently any work towards a computer algebra system library in Lean? For example, I am wondering whether there are currently any tools that would allow me to (symbolically) compute eigenvalues and eigenvectors like what Mathematica does.</p>",
        "id": 471570956,
        "sender_full_name": "Nick Mertes",
        "timestamp": 1726783848
    },
    {
        "content": "<p>I have a same question. I know polyrith tactic uses sage internally</p>",
        "id": 471962599,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1726941907
    },
    {
        "content": "<p>I have a similar question and I'm also new to most Lean-specific issues esp. mathlib; so far I understand that there are loads of powerful tactics for simplifying Nat's and other basic types (norm_num, calc etc) and very general tactics for manipulating general elements of rings (linarith, nlinarith, polyrith, ...?) and field_simp for fields (also ...?) and satisfiability solvers but  I've seen nothing so far anywhere like what Mathematica provides.  I'd love to know if this is on the roadmap for mathlib or other projects.  Also would like to understand aesop and why it always seems to be mentioned with the term \"magic\".  Happy to be corrected if any of this is wrong!</p>",
        "id": 473459444,
        "sender_full_name": "Matthew Fairtlough",
        "timestamp": 1727624278
    },
    {
        "content": "<p>of course theres this <a href=\"https://lean-fro.org/about/roadmap-y2/\">https://lean-fro.org/about/roadmap-y2/</a></p>",
        "id": 473463277,
        "sender_full_name": "Matthew Fairtlough",
        "timestamp": 1727626389
    },
    {
        "content": "<p>I'm new to Lean but I'm used to with CAS like Maxima and Wolfram Mathematica.<br>\nI was thinking too about how cool it would be, as you mentioned, to have both CAS like solving&amp;simplification and Formalization in Lean 4.</p>\n<p>I considered the dummy example of showing that</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>tends to 0 as n goes to infinity via a classic ε-N proof.</p>\n<p>When I ask Wolfram Mathematica</p>\n<div class=\"codehilite\" data-code-language=\"Mathematica\"><pre><span></span><code><span class=\"n\">Reduce</span><span class=\"p\">[</span><span class=\"n\">Abs</span><span class=\"p\">[</span><span class=\"n\">Exp</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"n\">x</span><span class=\"o\">^</span><span class=\"mi\">2</span><span class=\"p\">]]</span><span class=\"o\">&lt;</span><span class=\"err\">ε</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Reals</span><span class=\"p\">]</span>\n</code></pre></div>\n<p>I get the result analogous to</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"o\">(((</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"bp\">-√</span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">ε</span>\n</code></pre></div>\n<p>Then one could have a solve tactic (can also be incomplete and that finds just sufficient conditions for solution, or work only on specific bigger domains where things are more algorithmic) that one could use like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">sx</span><span class=\"w\"> </span><span class=\"bp\">::=</span><span class=\"w\"> </span><span class=\"n\">solution_with_proof</span><span class=\"w\"> </span><span class=\"c\">/-</span><span class=\"cm\">...-/</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span>\n</code></pre></div>\n<p>instead of the tedious</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">sx</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"c\">/-</span><span class=\"cm\">solution_of_...-/</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">--long proof</span>\n</code></pre></div>\n<p>Then the proof would be way more </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">a_tendsto_zero</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intros</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"n\">hε</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">sub_zero</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp_rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">a</span><span class=\"o\">]</span>\n\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">sx</span><span class=\"w\"> </span><span class=\"bp\">::=</span><span class=\"w\"> </span><span class=\"n\">solution_with_proof</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">exp</span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\">   </span><span class=\"c1\">--adds the hypothesis | sn : ∀ (x : ℝ), (((0 &lt; ε ∧ ε &lt; 1) ∧ (x &lt; -√(-Real.log ε) ∨ x &gt; √(-Real.log ε))) ∨ (1 &lt; ε) ) ↔ |Real.exp (- x^2)| &lt; ε</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span>\n<span class=\"cm\">  have sx : ∀ (x : ℝ), (((0 &lt; ε ∧ ε &lt; 1) ∧ (x &lt; -√(-Real.log ε) ∨ x &gt; √(-Real.log ε))) ∨ (1 ≤ ε) ) ↔ |Real.exp (- x^2)| &lt; ε := by</span>\n<span class=\"cm\">    sorry</span>\n<span class=\"cm\">  -/</span>\n\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">ceil</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">N</span>\n<span class=\"w\">  </span><span class=\"n\">intros</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">hn</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sx</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mp</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">hε'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">ε</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">right</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hε'</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">not_le</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hε'</span>\n<span class=\"w\">    </span><span class=\"n\">left</span>\n<span class=\"w\">    </span><span class=\"n\">constructor</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">constructor</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hε</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hε'</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">right</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">lt_of_ceil_lt</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"w\"> </span><span class=\"c1\">-- thanks to Luigi Massacci</span>\n</code></pre></div>\n<p>That is something going in the direction you mentioned that should be added in the next years in my view.</p>\n<p>P.S. Does someone know a theorem that tells </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">ceil</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>\n<p>so I can finish my example? : <span aria-label=\"joy\" class=\"emoji emoji-1f602\" role=\"img\" title=\"joy\">:joy:</span></p>",
        "id": 473814214,
        "sender_full_name": "Giulio Caflisch",
        "timestamp": 1727719704
    },
    {
        "content": "<p><code>exact Nat.lt_of_ceil_lt hn</code></p>",
        "id": 473824493,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1727721982
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> has been advocating an <code>isolate</code> tactic for some time now.  It would \"isolate\" an expression in a given (in)equality by rearranging the stuff around it onto the other side.</p>",
        "id": 473853501,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1727729707
    },
    {
        "content": "<p>In your example you could use it at least three times:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span>\n\n<span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"s2\">\"a\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">)</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">a_tendsto_zero</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intros</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"n\">hε</span>\n<span class=\"w\">  </span><span class=\"n\">dsimp</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">t</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">hn</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">abs_lt</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"n\">n</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">positivity</span>\n<span class=\"w\">    </span><span class=\"n\">linarith</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"n\">hε1</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">hε1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">lt_or_le</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">ε</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"n\">n</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"c1\">-- syntax for the next line would be `isolate (n:ℝ) ^ 2`</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">exp_le_one_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Right</span><span class=\"bp\">.</span><span class=\"n\">neg_nonpos_iff</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">positivity</span>\n<span class=\"w\">    </span><span class=\"n\">linarith</span>\n<span class=\"w\">  </span><span class=\"c1\">-- syntax for the next line would be `isolate n`</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">sub_lt_iff_lt_add</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">lt_log_iff_exp_lt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">positivity</span><span class=\"o\">),</span>\n<span class=\"w\">    </span><span class=\"n\">neg_lt</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">sqrt_lt</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">positivity</span><span class=\"o\">)]</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"c1\">-- THIS IS THE MAIN GOAL: ⊢ √(-log (ε + 0)) &lt; ↑n</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"c1\">-- syntax for the next line would be `isolate ε`</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Right</span><span class=\"bp\">.</span><span class=\"n\">nonneg_neg_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">log_nonpos_iff</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">positivity</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">le_sub_iff_add_le</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">linarith</span>\n</code></pre></div>",
        "id": 473858727,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1727730866
    },
    {
        "content": "<p>So </p>\n<ul>\n<li><code>isolate (n:ℝ) ^ 2</code> reduces <code>⊢ exp (-↑n ^ 2) ≤ 1</code> to <code>⊢ 0 ≤ ↑n ^ 2</code></li>\n<li><code>isolate n</code> reduces <code>⊢ exp (-↑n ^ 2) - 0 &lt; ε</code> to <code>⊢ √(-log (ε + 0)) &lt; ↑n</code> (plus a generated side goal, <code>⊢ 0 ≤ -log (ε + 0)</code>)</li>\n<li><code>isolate ε</code> reduces <code>0 ≤ -log (ε + 0)</code> to <code>ε ≤ 1 - 0</code>.</li>\n</ul>",
        "id": 473860597,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1727731196
    },
    {
        "content": "<p>So this \"isolate\" tactic would somehow know which functions are increasing, where they have special values, or which are inverses of each other? (I know nothing about tactic writing, so I have no idea how difficult it would be)</p>",
        "id": 473868175,
        "sender_full_name": "Philippe Duchon",
        "timestamp": 1727733588
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"726077\">@Philippe Duchon</span> If you look at the lemmas I was invoking, you'll see they are all of the form <code>F x ∼ y ↔ x ∼' B</code>, where <code>∼</code> and <code>∼'</code> are (possibly different) relations (and there may be side conditions before the iff), and <code>y</code> is a variable or constant:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">neg_lt</span><span class=\"w\"> </span><span class=\"c1\">-- `-a &lt; b ↔ -b &lt; a`</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">sub_lt_iff_lt_add</span><span class=\"w\"> </span><span class=\"c1\">-- `a - c &lt; b ↔ a &lt; b + c`</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">le_sub_iff_add_le</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"c1\">-- `a + b ≤ c ↔ a ≤ c - b`</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">Right</span><span class=\"bp\">.</span><span class=\"n\">neg_nonpos_iff</span><span class=\"w\"> </span><span class=\"c1\">-- `-a ≤ 0 ↔ 0 ≤ a`</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">Right</span><span class=\"bp\">.</span><span class=\"n\">nonneg_neg_iff</span><span class=\"w\"> </span><span class=\"c1\">-- `0 ≤ -a ↔ a ≤ 0`</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">exp_le_one_iff</span><span class=\"w\"> </span><span class=\"c1\">-- `exp x ≤ 1 ↔ x ≤ 0`</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">lt_log_iff_exp_lt</span><span class=\"w\"> </span><span class=\"bp\">..</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"c1\">-- `exp x &lt; y ↔ x &lt; log y` (side condition `0 &lt; y`)</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">log_nonpos_iff</span><span class=\"w\"> </span><span class=\"c1\">-- `log x ≤ 0 ↔ x ≤ 1` (side condition `0 &lt; x`)</span>\n</code></pre></div>",
        "id": 473879125,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1727736796
    },
    {
        "content": "<p>The idea would be to tag all such lemmas with an <code>isolate</code> attribute at the place in the library where they are proved:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">isolate</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">lt_log_iff_exp_lt</span><span class=\"w\"> </span><span class=\"bp\">....</span>\n</code></pre></div>\n<p>storing them with the function <code>F</code> and the relation ∼, then have the tactic look them up as needed for the function and relation which it is presented with.  (Side goals can be discharged by e.g. <code>positivity</code>, where possible.)</p>",
        "id": 473879287,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1727736849
    },
    {
        "content": "<p>If you know how the <code>gcongr</code> tactic works, it would be a similar model to that.</p>",
        "id": 473879608,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1727736980
    },
    {
        "content": "<p>I very much back this idea, but what will the tactic do if eg I ask it to isolate <code>a</code> in <code>a - a ≤ 0</code>? Error hopefully?</p>",
        "id": 473963876,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1727766306
    },
    {
        "content": "<p>Actually, I could see a use case for wanting to isolate a term that shows up several times in an expression. Eg in my expansion of <code>y</code> maybe I have a main term <code>x</code> and an error term <code>cos x</code>. Something like <code>y = x + cos x</code> then I might want to isolate <code>x</code> to prove <code>x = y - cos x ≤ y + 1</code>.</p>",
        "id": 473964597,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1727766462
    },
    {
        "content": "<p>So maybe the tactic should take in a expression with holes, something like <code>(_ &lt;- this is the hole I want you to isolate) + _</code> for the example above. Syntax for the distinguished hole TBD.</p>",
        "id": 473964987,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1727766563
    },
    {
        "content": "<p>Maybe the distinguished hole could be <code>?_</code>.</p>",
        "id": 473974823,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1727769036
    }
]