[
    {
        "content": "<p>Hi all,</p>\n<p>While working withÂ <code>PMF</code>Â in mathlib, I noticed that the codomain isÂ <code>ENNReal</code>Â (extended non-negative reals), rather thanÂ <code>NNReal</code>Â or even just the unit intervalÂ <code>[0,1]</code>. This makes some calculations more cumbersome, and I was wondering about the motivation for this design choice. Is it mainly for compatibility with measure theory?</p>\n<p>Additionally, is there a theorem in mathlib that guarantees that the values of a <code>PMF</code> are always â‰¤ 1 (i.e., that the codomain is \"effectively\" bounded because of the sum property)? Or could a <code>PMF</code>in Lean actually take the value âˆž somewhere?</p>\n<p>Finally, I am also curious about the reasoning behind the separation between PMFs and distributions in mathlib. To me, the distinction seems a bit arbitraryâ€”could someone explain the motivation or use cases for keeping them separate?</p>\n<p>Thanks in advance for any insights!</p>",
        "id": 526572449,
        "sender_full_name": "Jasper Ganten",
        "timestamp": 1751364496
    },
    {
        "content": "<p>I tried changing PMFs to NNReal a long while ago (<a href=\"https://github.com/leanprover-community/mathlib4/pull/7155\">https://github.com/leanprover-community/mathlib4/pull/7155</a>), but gave up. It's just super convenient that all infinite sums are <code>Summable</code></p>",
        "id": 526573465,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1751364843
    },
    {
        "content": "<p>I have no problems with taking <code>ENNReal</code> codomain, as long as we get more lemmas about how <code>ENNReal.ofNNReal</code> interacts with arithmetic.</p>",
        "id": 526574215,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1751365088
    },
    {
        "content": "<p>So effectively working in status quo I always have to try to simplify the equality expression by showing that</p>\n<ul>\n<li>p is real</li>\n<li>using <code>PMF.coe_le_one</code> the expression itsself is bounded</li>\n</ul>\n<p>this should yield me an expression in the reals which then can be manipulated easily?<br>\nOr is there a more idiomatic procedure?</p>",
        "id": 526577490,
        "sender_full_name": "Jasper Ganten",
        "timestamp": 1751366243
    },
    {
        "content": "<p>Why is <code>PMF</code> even a thing? To me, it should be a constructor for <code>Measure</code></p>",
        "id": 526591985,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1751371329
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">YaÃ«l Dillies</span> <a href=\"#narrow/channel/113489-new-members/topic/Why.20is.20the.20codomain.20of.20PMF.20in.20mathlib.20ENNReal.20and.20not.20NNReal/near/526591985\">said</a>:</p>\n<blockquote>\n<p>Why is <code>PMF</code> even a thing? To me, it should be a constructor for <code>Measure</code></p>\n</blockquote>\n<p>to my understanding it's separate because it defines a monad structure <a href=\"https://en.wikipedia.org/wiki/Giry_monad\">(see here)</a> and because not all stochastics  is interesting for measure theory.</p>",
        "id": 526600991,
        "sender_full_name": "Jasper Ganten",
        "timestamp": 1751374244
    },
    {
        "content": "<p>Sorry, I should clarify. To me, <code>PMF</code> currently fills two roles:</p>\n<ul>\n<li>It is a way to build a measure from given weights. This use can be replaced by a constructor for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.Measure#doc\">docs#MeasureTheory.Measure</a></li>\n<li>It is a type representing probability measures over a finite space. This use can be replaced by <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.ProbabilityMeasure#doc\">docs#MeasureTheory.ProbabilityMeasure</a></li>\n</ul>",
        "id": 526602034,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1751374566
    },
    {
        "content": "<p>Pointer to more recent discussion here. <a class=\"message-link\" href=\"/#narrow/channel/113489-new-members/topic/Performing.20arithmetic.20with.20ENNReals/near/525936290\">#new members &gt; Performing arithmetic with ENNReals @ ðŸ’¬</a> </p>\n<p>It feels like we should at least have a function <code>PMF S -&gt; S -&gt; NNReal</code>.</p>",
        "id": 526664737,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1751395387
    },
    {
        "content": "<p>It also feels like it would be more convenient API if functions like <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PMF.bernoulli#doc\">docs#PMF.bernoulli</a> did not take ENNReals as arguments, I am having trouble even defining the Bernoulli(1/2) variable.</p>",
        "id": 526665582,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1751395799
    },
    {
        "content": "<p>That may be a youth sin of mineâ€¦</p>",
        "id": 526666753,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1751396323
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/26596\">#26596</a></p>",
        "id": 526674155,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1751399697
    }
]