[
    {
        "content": "<p>As the title states, I am looking for a way to ban some typeclass instances. See this <a href=\"https://live.lean-lang.org/#codez=M4FwTgrgxiFgpgAgPICMBW8aIO4At4FEA7AQwFt4AuRAZXAEtiBzRAKFEhjiQAkJypYongAPEPGIATYCgxYQ7NlAA2pYLIAKpBMRAAleCsQAKTYgDCNfoOIBKXAQRsXU+ADNEAQRUMoSawEhRCoAXkQAbzJKEPCAIh8/eDiAX3Y3TwAhAHtUEMQbYLDI6ID4nNRUlwBaasQASVwhRQAZeCEAFkQQbMQwUgZgJGDCMGywbrxSRVRskDxEJlAhf1koIWI5kVFBxSZJpGAKQ6hsgAd4FyWQFYDEbV0DI29ff0QK2MRAC/JAS/J2a9u+Qekiexg+iTexV+7CAA\">playground</a>.<br>\nWhat I desire is to have Lean4 raise an error when it detects, for all Humans P and C, <br>\na ParentRel P C instance and a ParentRel C P in that same scope. I know I could define an axiom that implies false given the two instances, but that doesn't prevent both instances from being defined in the first place.</p>",
        "id": 563624149,
        "sender_full_name": "CalculiLime325",
        "timestamp": 1765635624
    },
    {
        "content": "<p>why do you want to do this?</p>",
        "id": 563624740,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1765636149
    },
    {
        "content": "<p>It was for the purpose of having fun. I was inspired by <a href=\"https://cliplab.org/~logalg/doc/The_Art_of_Prolog.pdf\">https://cliplab.org/~logalg/doc/The_Art_of_Prolog.pdf</a> and wanted to see if Lean's typeclass system was sufficient for creating logical statements like in Prolog. In summary, It's not really critical that I insist on doing this.</p>",
        "id": 563625159,
        "sender_full_name": "CalculiLime325",
        "timestamp": 1765636529
    },
    {
        "content": "<p>I also wanted to express the fact that the ParentRel relation isn't reversible. I.E Alice can be the parent of Bob, but Bob cannot also be the parent of Alice.</p>",
        "id": 563625277,
        "sender_full_name": "CalculiLime325",
        "timestamp": 1765636641
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"1003922\">CalculiLime325</span> <a href=\"#narrow/channel/113489-new-members/topic/How.20to.20conditionally.20ban.20certain.20typeclass.20instances.3F/near/563625277\">said</a>:</p>\n<blockquote>\n<p>I also wanted to express the fact that the ParentRel relation isn't reversible. I.E Alice can be the parent of Bob, but Bob cannot also be the parent of Alice.</p>\n</blockquote>\n<p>clearly with what you have set up so far this is just not true</p>",
        "id": 563625723,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1765637052
    },
    {
        "content": "<p>I'm still not sure what you want to do</p>",
        "id": 563625737,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1765637064
    },
    {
        "content": "<p>I don't think that's possible. If I were to use your example I would model it probably like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">ParentRel</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">Parent</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Human</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Human</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"w\">  </span><span class=\"n\">ne_Parent_of_Parent</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Human</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Parent</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"n\">Parent</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">P</span>\n</code></pre></div>",
        "id": 563625753,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1765637080
    },
    {
        "content": "<p>The feature you want would also be quite hard to implement. Available typeclass instances depend on the set of imports in the file you're working in.</p>",
        "id": 563626285,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1765637599
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> I am confused here as to what you mean. Sure my playground doesn't actually express that fact in its current state, but I want to learn as to how I can modify my playground to do just that.</p>\n<p><span class=\"user-mention\" data-user-id=\"870257\">@Jakub Nowak</span> I see, that's unfortunate. I will experiment with your definition and see what I can gleam.</p>",
        "id": 563626348,
        "sender_full_name": "CalculiLime325",
        "timestamp": 1765637669
    },
    {
        "content": "<p>it is <em>possible</em> to hook the decl elaborator and throw an error if it's adding a <code>ParentRel</code> whose reverse is inferable by typeclass</p>",
        "id": 563626488,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1765637812
    },
    {
        "content": "<p>I don't recommend it and it doesn't actually stop you from having both directions of <code>ParentRel</code> at once</p>",
        "id": 563626536,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1765637846
    },
    {
        "content": "<p>I don't know if that would be helpful to you, but the closest thing to logic programming in functional languages is List monad. However, it lacks some important features of logic programming languages like prolog.</p>",
        "id": 563626754,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1765638062
    }
]