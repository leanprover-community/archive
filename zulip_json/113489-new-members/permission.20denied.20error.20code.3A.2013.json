[
    {
        "content": "<p>Hello,</p>\n<p>I’m encountering a permission error and haven’t been able to resolve it.<br>\nA couple of days ago, I had no issues building and running <code>lake</code> and <code>lean</code>.<br>\nHowever, after deleting my local repository and re-cloning the project from the global repository,<br>\nboth <code>lake build</code> and <code>lake exe get cache</code> started showing permission errors.</p>\n<p>I can temporarily resolve the issue by granting permissions in the terminal using commands like <code>sudo lake build</code>,<br>\nbut the same issue persists when working in VS Code.</p>\n<p>How can I permanently fix this issue?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">stderr</span><span class=\"o\">:</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">mathlib</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">URL</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">changed</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">deleting</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib'</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">again</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">permission</span><span class=\"w\"> </span><span class=\"n\">denied</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">13</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">file</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">CODE_OF_CONDUCT</span><span class=\"bp\">.</span><span class=\"n\">md</span>\n<span class=\"n\">Invalid</span><span class=\"w\"> </span><span class=\"n\">Lake</span><span class=\"w\"> </span><span class=\"n\">configuration</span><span class=\"bp\">.</span><span class=\"w\">  </span><span class=\"n\">Please</span><span class=\"w\"> </span><span class=\"n\">restart</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">server</span><span class=\"w\"> </span><span class=\"n\">after</span><span class=\"w\"> </span><span class=\"n\">fixing</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">Lake</span><span class=\"w\"> </span><span class=\"n\">configuration</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"bp\">.</span>\n</code></pre></div>",
        "id": 485134373,
        "sender_full_name": "Byung-Hak Hwang",
        "timestamp": 1732899127
    },
    {
        "content": "<p>What are the file permissions on that file? <code>ls -la .lake/build/packages/mathlib/CODE_OF_CONDUCT.md</code></p>",
        "id": 485134738,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1732899296
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"395550\">Henrik Böving</span> <a href=\"#narrow/channel/113489-new-members/topic/permission.20denied.20error.20code.3A.2013/near/485134738\">말함</a>:</p>\n<blockquote>\n<p>What are the file permissions on that file? <code>ls -la .lake/build/packages/mathlib/CODE_OF_CONDUCT.md</code></p>\n</blockquote>\n<p>I got <code>-rw-r--r--  1 root  staff  5319 11 30 01:04 CODE_OF_CONDUCT.md</code></p>",
        "id": 485141788,
        "sender_full_name": "Byung-Hak Hwang",
        "timestamp": 1732902899
    },
    {
        "content": "<p>So it can't be deleted because it's owned by <code>root</code>. Did you clone the project when logged in as root or something? How about just deleting everything and cloning again as the user who wants to use the repo? <code>sudo lake build</code> won't solve the problem, you're just using the repo as root so it will just cause more problems (it will create a bunch more files which will then also be owned by <code>root</code> and hence undeletable by you unless you use sudo yet again). You'd be better off doing <code>sudo rm -rf .lake</code>. Are the regular lean files also owned by root? Just delete everything and start again and don't use sudo at all, is my advice.</p>",
        "id": 485146767,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1732905852
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/113489-new-members/topic/permission.20denied.20error.20code.3A.2013/near/485146767\">말함</a>:</p>\n<blockquote>\n<p>So it can't be deleted because it's owned by <code>root</code>. Did you clone the project when logged in as root or something? How about just deleting everything and cloning again as the user who wants to use the repo? <code>sudo lake build</code> won't solve the problem, you're just using the repo as root so it will just cause more problems (it will create a bunch more files which will then also be owned by <code>root</code> and hence undeletable by you unless you use sudo yet again). You'd be better off doing <code>sudo rm -rf .lake</code>. Are the regular lean files also owned by root? Just delete everything and start again and don't use sudo at all, is my advice.</p>\n</blockquote>\n<p>Thank you for the advice. Following your suggestion, I entirely deleted, set the right permissions, and cloned it again, and now it works!</p>",
        "id": 485151047,
        "sender_full_name": "Byung-Hak Hwang",
        "timestamp": 1732908360
    },
    {
        "content": "<p>Thank you! This was very helpful! I also had to remove <code>.elan</code> from the home directory, but eventually was able to use <code>lake</code> again.</p>",
        "id": 489466208,
        "sender_full_name": "Andrei Burdușa",
        "timestamp": 1734436167
    }
]