[
    {
        "content": "<p><code>ring</code> or <code>linarith</code> work fine for real numbers. Is there any similar tactic for ENNReal?<br>\nI don't know why it's so hard to prove the following theorem :/</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">ENNReal</span><span class=\"bp\">.</span><span class=\"n\">add_sub_cancel_left2</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ENNReal</span><span class=\"o\">}</span><span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">∞</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">∞</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- linarith</span>\n<span class=\"w\">  </span><span class=\"c1\">-- ring</span>\n<span class=\"w\">  </span><span class=\"c1\">-- lift a to ℝ using ha</span>\n<span class=\"w\">  </span><span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">ENNReal</span><span class=\"bp\">.</span><span class=\"n\">add_sub_cancel_left</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 471230145,
        "sender_full_name": "Arshak Parsa",
        "timestamp": 1726657145
    },
    {
        "content": "<p>This is not true. <code>1 + (0 - 1) = 1 + 0 = 1 ≠ 0</code></p>",
        "id": 471232087,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1726657769
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"703970\">@Etienne Marion</span> <br>\nYou are right.</p>",
        "id": 471232342,
        "sender_full_name": "Arshak Parsa",
        "timestamp": 1726657856
    },
    {
        "content": "<p>This works though:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">ENNReal</span><span class=\"bp\">.</span><span class=\"n\">add_sub_cancel_left2</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ENNReal</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hab</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">add_tsub_cancel_of_le</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hab</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 471232658,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1726657973
    },
    {
        "content": "<p>Is there any tactic like ring or linarith for ENNReal?</p>",
        "id": 471232728,
        "sender_full_name": "Arshak Parsa",
        "timestamp": 1726657998
    },
    {
        "content": "<p>I don't think so, but not 100% sure</p>",
        "id": 471232814,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1726658038
    },
    {
        "content": "<p>No, primarily because it would have very bad properties due to <code>∞</code> and truncated subtraction. If you really want access to something like that, you would need to first deal with the <code>∞</code> case, express everything as a coercion from <code>ℝ≥0</code>, apply <code>norm_cast</code> to remove the coercions, then coerce to <code>ℝ</code>, and in the latter step you'll still need to deal with truncated subtraction. All of that is considerable work. For now, I recommend just using the API for <code>ℝ≥0∞</code> as suggested by Etienne.</p>",
        "id": 471255562,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1726664973
    },
    {
        "content": "<p>norm_num still can't handle division in <code>ℝ≥0</code>, though I have a stale PR that makes progress on this</p>",
        "id": 471258842,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1726665912
    }
]