[
    {
        "content": "<p>Hi all. I'm pretty new to lean, and I'm trying to get used to the installation procedures.</p>\n<h1>What I did.</h1>\n<p>Following the <a href=\"https://leanprover-community.github.io/install/macos_details.html\">MacOS install instructions</a>, I downloaded the <a href=\"https://github.com/leanprover/elan/releases/tag/v3.1.1\">latest release of elan v3.1.1</a> (aarch64-apple-darwin), and verified that <code>lake</code>, and <code>elan</code> are all in <code>~/.elan/bin</code>. I then upgraded elan with <code>elan self update</code>.  I installed the latest version of lean with <code>elan toolchain install stable</code>.  Running <code>lean --version</code> in the command line gives:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>lean<span class=\"w\"> </span>--version\nLean<span class=\"w\"> </span><span class=\"o\">(</span>version<span class=\"w\"> </span><span class=\"m\">4</span>.10.0,<span class=\"w\"> </span>arm64-apple-darwin23.5.0,<span class=\"w\"> </span>commit<span class=\"w\"> </span>c375e19f6b65,<span class=\"w\"> </span>Release<span class=\"o\">)</span>\n</code></pre></div>\n<h1>What I'm trying to do.</h1>\n<p>I'm trying to import mathlib4. I created a new directory and a new lean file. In VSCode (with the  <a href=\"https://marketplace.visualstudio.com/items?itemName=leanprover.lean4\">Lean 4 VSCode v0.0.177 Extension</a> installed, I entered the code into the file and I get the following error in the infoview.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n</code></pre></div>\n<p>Error: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">unknown</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"kn\">prefix</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Mathlib'</span>\n<span class=\"n\">No</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Mathlib'</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">lean'</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">search</span><span class=\"w\"> </span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"n\">entries</span><span class=\"o\">:</span>\n<span class=\"bp\">~/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">stable</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span>\n</code></pre></div>\n<p>The <a href=\"https://github.com/leanprover-community/leanprover-community.github.io/pull/520/files\">mathlib4 readme</a> has installation instructions that point to <a href=\"https://leanprover-community.github.io/get_started.html\">this link</a>, which points to <a href=\"https://leanprover-community.github.io/install/macos.html\">MacOS install instructions</a>, which points to <a href=\"https://leanprover-community.github.io/install/macos_details.html\">more general install MacOS instructions</a>, which points to an outdated lake repo (I created a <a href=\"https://github.com/leanprover-community/leanprover-community.github.io/pull/520/files\">pull request</a> to update the link). I read through the lake README but couldn't find out how to install mathlib. I've also tried <code>elan --help</code> and <code>elan toolchain --help</code> but would appreciate any help on this. </p>\n<h1>Question</h1>\n<p>How can I install mathlib4 to a place outside the current project directory? I'd like to just be able to create a new directory, a new stand alone lean file, and run <code>import Mathlib</code> without having to download and build the library. The main reason I'd like to do this is because, every time I try to initialize a new package (for example, by running the <code>lake init snippets math</code> command in a terminal, it takes around 20 minutes for the lean language client to start up again in VSCode. This is because lean and mathlib get redownloaded and rebuilt, even though I've run <code>lake exe cache get</code> per the instructions in the <a href=\"https://github.com/leanprover/lean4/tree/master/src/lake#adding-dependencies\">lake docs</a></p>\n<p>The message I get from VSCode output is pasted below: </p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>~/git/lean4_snippets&gt;<span class=\"w\"> </span>curl<span class=\"w\"> </span>--version\ncurl<span class=\"w\"> </span><span class=\"m\">8</span>.6.0<span class=\"w\"> </span><span class=\"o\">(</span>x86_64-apple-darwin23.0<span class=\"o\">)</span><span class=\"w\"> </span>libcurl/8.6.0<span class=\"w\"> </span><span class=\"o\">(</span>SecureTransport<span class=\"o\">)</span><span class=\"w\"> </span>LibreSSL/3.3.6<span class=\"w\"> </span>zlib/1.2.12<span class=\"w\"> </span>nghttp2/1.61.0\nRelease-Date:<span class=\"w\"> </span><span class=\"m\">2024</span>-01-31\nProtocols:<span class=\"w\"> </span>dict<span class=\"w\"> </span>file<span class=\"w\"> </span>ftp<span class=\"w\"> </span>ftps<span class=\"w\"> </span>gopher<span class=\"w\"> </span>gophers<span class=\"w\"> </span>http<span class=\"w\"> </span>https<span class=\"w\"> </span>imap<span class=\"w\"> </span>imaps<span class=\"w\"> </span>ipfs<span class=\"w\"> </span>ipns<span class=\"w\"> </span>ldap<span class=\"w\"> </span>ldaps<span class=\"w\"> </span>mqtt<span class=\"w\"> </span>pop3<span class=\"w\"> </span>pop3s<span class=\"w\"> </span>rtsp<span class=\"w\"> </span>smb<span class=\"w\"> </span>smbs<span class=\"w\"> </span>smtp<span class=\"w\"> </span>smtps<span class=\"w\"> </span>telnet<span class=\"w\"> </span>tftp\nFeatures:<span class=\"w\"> </span>alt-svc<span class=\"w\"> </span>AsynchDNS<span class=\"w\"> </span>GSS-API<span class=\"w\"> </span>HSTS<span class=\"w\"> </span>HTTP2<span class=\"w\"> </span>HTTPS-proxy<span class=\"w\"> </span>IPv6<span class=\"w\"> </span>Kerberos<span class=\"w\"> </span>Largefile<span class=\"w\"> </span>libz<span class=\"w\"> </span>MultiSSL<span class=\"w\"> </span>NTLM<span class=\"w\"> </span>NTLM_WB<span class=\"w\"> </span>SPNEGO<span class=\"w\"> </span>SSL<span class=\"w\"> </span>threadsafe<span class=\"w\"> </span>UnixSockets\n\n~/git/lean4_snippets&gt;<span class=\"w\"> </span>git<span class=\"w\"> </span>--version\ngit<span class=\"w\"> </span>version<span class=\"w\"> </span><span class=\"m\">2</span>.39.3<span class=\"w\"> </span><span class=\"o\">(</span>Apple<span class=\"w\"> </span>Git-145<span class=\"o\">)</span>\n\n~/git/lean4_snippets&gt;<span class=\"w\"> </span>lean<span class=\"w\"> </span>--version\nLean<span class=\"w\"> </span><span class=\"o\">(</span>version<span class=\"w\"> </span><span class=\"m\">4</span>.10.0,<span class=\"w\"> </span>arm64-apple-darwin23.5.0,<span class=\"w\"> </span>commit<span class=\"w\"> </span>c375e19f6b65,<span class=\"w\"> </span>Release<span class=\"o\">)</span>\n~/git/lean4_snippets&gt;<span class=\"w\"> </span>elan<span class=\"w\"> </span>--version\nelan<span class=\"w\"> </span><span class=\"m\">3</span>.1.1<span class=\"w\"> </span><span class=\"o\">(</span>71ddc6633<span class=\"w\"> </span><span class=\"m\">2024</span>-02-22<span class=\"o\">)</span>\n\n~/git/lean4_snippets&gt;<span class=\"w\"> </span>lean<span class=\"w\"> </span>--version\nLean<span class=\"w\"> </span><span class=\"o\">(</span>version<span class=\"w\"> </span><span class=\"m\">4</span>.10.0,<span class=\"w\"> </span>arm64-apple-darwin23.5.0,<span class=\"w\"> </span>commit<span class=\"w\"> </span>c375e19f6b65,<span class=\"w\"> </span>Release<span class=\"o\">)</span>\n~&gt;<span class=\"w\"> </span>lean<span class=\"w\"> </span>--version\ninfo:<span class=\"w\"> </span>downloading<span class=\"w\"> </span>component<span class=\"w\"> </span><span class=\"s1\">'lean'</span>\ninfo:<span class=\"w\"> </span>installing<span class=\"w\"> </span>component<span class=\"w\"> </span><span class=\"s1\">'lean'</span>\nLean<span class=\"w\"> </span><span class=\"o\">(</span>version<span class=\"w\"> </span><span class=\"m\">4</span>.11.0-rc3,<span class=\"w\"> </span>arm64-apple-darwin23.6.0,<span class=\"w\"> </span>commit<span class=\"w\"> </span>c122849f0759,<span class=\"w\"> </span>Release<span class=\"o\">)</span>\n~&gt;<span class=\"w\"> </span>lake<span class=\"w\"> </span>--version\nLake<span class=\"w\"> </span>version<span class=\"w\"> </span><span class=\"m\">5</span>.0.0-c122849<span class=\"w\"> </span><span class=\"o\">(</span>Lean<span class=\"w\"> </span>version<span class=\"w\"> </span><span class=\"m\">4</span>.11.0-rc3<span class=\"o\">)</span>\n✔<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">6</span>/17<span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span>Optional<span class=\"o\">)</span><span class=\"w\"> </span>Fetched<span class=\"w\"> </span>proofwidgets:optRelease\n✔<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">9</span>/17<span class=\"o\">]</span><span class=\"w\"> </span>Built<span class=\"w\"> </span>Cache.IO\n✔<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">10</span>/17<span class=\"o\">]</span><span class=\"w\"> </span>Built<span class=\"w\"> </span>Cache.Hashing\n✔<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">11</span>/17<span class=\"o\">]</span><span class=\"w\"> </span>Built<span class=\"w\"> </span>Cache.Requests\n✔<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">12</span>/17<span class=\"o\">]</span><span class=\"w\"> </span>Built<span class=\"w\"> </span>Cache.Main\n✔<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">13</span>/17<span class=\"o\">]</span><span class=\"w\"> </span>Built<span class=\"w\"> </span>Cache.Main:c.o\n✔<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">14</span>/17<span class=\"o\">]</span><span class=\"w\"> </span>Built<span class=\"w\"> </span>Cache.Requests:c.o\n✔<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">15</span>/17<span class=\"o\">]</span><span class=\"w\"> </span>Built<span class=\"w\"> </span>Cache.Hashing:c.o\n✔<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">16</span>/17<span class=\"o\">]</span><span class=\"w\"> </span>Built<span class=\"w\"> </span>Cache.IO:c.o\n✔<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">17</span>/17<span class=\"o\">]</span><span class=\"w\"> </span>Built<span class=\"w\"> </span>cache\nDownloaded:<span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span>file<span class=\"o\">(</span>s<span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span>attempted<span class=\"w\"> </span><span class=\"m\">1</span>/5005<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">0</span>%<span class=\"o\">]</span>\n...\nDownloaded:<span class=\"w\"> </span><span class=\"m\">5005</span><span class=\"w\"> </span>file<span class=\"o\">(</span>s<span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span>attempted<span class=\"w\"> </span><span class=\"m\">5005</span>/5005<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">100</span>%<span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">100</span>%<span class=\"w\"> </span>success<span class=\"o\">)</span>\ninfo:<span class=\"w\"> </span>snippets:<span class=\"w\"> </span>no<span class=\"w\"> </span>previous<span class=\"w\"> </span>manifest,<span class=\"w\"> </span>creating<span class=\"w\"> </span>one<span class=\"w\"> </span>from<span class=\"w\"> </span>scratch\ninfo:<span class=\"w\"> </span>leanprover-community/mathlib:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover-community/mathlib4<span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'././.lake/packages/mathlib'</span>\ninfo:<span class=\"w\"> </span>batteries:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover-community/batteries<span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'././.lake/packages/batteries'</span>\ninfo:<span class=\"w\"> </span>Qq:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover-community/quote4<span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'././.lake/packages/Qq'</span>\ninfo:<span class=\"w\"> </span>aesop:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover-community/aesop<span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'././.lake/packages/aesop'</span>\ninfo:<span class=\"w\"> </span>proofwidgets:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover-community/ProofWidgets4<span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'././.lake/packages/proofwidgets'</span>\ninfo:<span class=\"w\"> </span>importGraph:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover-community/import-graph<span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'././.lake/packages/importGraph'</span>\ninfo:<span class=\"w\"> </span>Cli:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover/lean4-cli<span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'././.lake/packages/Cli'</span>\ninfo:<span class=\"w\"> </span>mathlib:<span class=\"w\"> </span>running<span class=\"w\"> </span>post-update<span class=\"w\"> </span>hooks\n<span class=\"o\">[</span>Error<span class=\"w\"> </span>-<span class=\"w\"> </span><span class=\"m\">11</span>:10:09<span class=\"w\"> </span>AM<span class=\"o\">]</span><span class=\"w\"> </span>Client<span class=\"w\"> </span>Lean<span class=\"w\"> </span><span class=\"m\">4</span>:<span class=\"w\"> </span>connection<span class=\"w\"> </span>to<span class=\"w\"> </span>server<span class=\"w\"> </span>is<span class=\"w\"> </span>erroring.<span class=\"w\"> </span>Shutting<span class=\"w\"> </span>down<span class=\"w\"> </span>server.\n<span class=\"o\">[</span>Error<span class=\"w\"> </span>-<span class=\"w\"> </span><span class=\"m\">11</span>:10:09<span class=\"w\"> </span>AM<span class=\"o\">]</span><span class=\"w\"> </span>Stopping<span class=\"w\"> </span>server<span class=\"w\"> </span>failed\nError:<span class=\"w\"> </span>Client<span class=\"w\"> </span>is<span class=\"w\"> </span>not<span class=\"w\"> </span>running<span class=\"w\"> </span>and<span class=\"w\"> </span>can<span class=\"s1\">'t be stopped. It'</span>s<span class=\"w\"> </span>current<span class=\"w\"> </span>state<span class=\"w\"> </span>is:<span class=\"w\"> </span>starting\n<span class=\"w\">    </span>at<span class=\"w\"> </span>_.shutdown<span class=\"w\"> </span><span class=\"o\">(</span>~/.vscode/extensions/leanprover.lean4-0.0.177/dist/extension.js:1:379940<span class=\"o\">)</span>\n<span class=\"w\">    </span>at<span class=\"w\"> </span>_.stop<span class=\"w\"> </span><span class=\"o\">(</span>~/.vscode/extensions/leanprover.lean4-0.0.177/dist/extension.js:1:379521<span class=\"o\">)</span>\n<span class=\"w\">    </span>at<span class=\"w\"> </span>_.stop<span class=\"w\"> </span><span class=\"o\">(</span>~/.vscode/extensions/leanprover.lean4-0.0.177/dist/extension.js:1:541569<span class=\"o\">)</span>\n<span class=\"w\">    </span>at<span class=\"w\"> </span>_.handleConnectionError<span class=\"w\"> </span><span class=\"o\">(</span>~/.vscode/extensions/leanprover.lean4-0.0.177/dist/extension.js:1:386028<span class=\"o\">)</span>\n<span class=\"w\">    </span>at<span class=\"w\"> </span>processTicksAndRejections<span class=\"w\"> </span><span class=\"o\">(</span>node:internal/process/task_queues:95:5<span class=\"o\">)</span>\n</code></pre></div>",
        "id": 466315658,
        "sender_full_name": "Kyle Ellefsen",
        "timestamp": 1725039523
    },
    {
        "content": "<p>I was able to import mathlib <strong>inside</strong> a new package by running the following commands.</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>&gt;<span class=\"w\"> </span>mkdir<span class=\"w\"> </span>hello\n&gt;<span class=\"w\"> </span><span class=\"nb\">cd</span><span class=\"w\"> </span>hello\n&gt;<span class=\"w\"> </span>lake<span class=\"w\"> </span>init<span class=\"w\"> </span>hello\n&gt;<span class=\"w\"> </span>nvim<span class=\"w\"> </span>lakefile.lean<span class=\"w\">  </span><span class=\"c1\"># I added the line `require \"leanprover-community\" / \"mathlib\"`</span>\n&gt;<span class=\"w\"> </span>lake<span class=\"w\"> </span>exe<span class=\"w\"> </span>cache<span class=\"w\"> </span>get\n&gt;<span class=\"w\"> </span>lake<span class=\"w\"> </span>build\n</code></pre></div>\n<p>After running the <code>lake exe cache get</code> command, I got a build failed error, but manually running build afterwards worked.</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>error:<span class=\"w\"> </span>Lean<span class=\"w\"> </span>exited<span class=\"w\"> </span>with<span class=\"w\"> </span>code<span class=\"w\"> </span><span class=\"m\">1</span>\nSome<span class=\"w\"> </span>builds<span class=\"w\"> </span>logged<span class=\"w\"> </span>failures:\n-<span class=\"w\"> </span>Cache.IO\nerror:<span class=\"w\"> </span>build<span class=\"w\"> </span>failed\n</code></pre></div>\n<p>I also saw in the <a href=\"https://github.com/leanprover/lean4/tree/master/src/lake#adding-dependencies\">lake docs</a> I could have just run <code>lake new &lt;package-name&gt; math</code> and that would have automatically added the mathlib4 dependencies.</p>\n<p>I'm still not able to import mathlib outside a project however. I'm still wondering if this is possible.</p>",
        "id": 466324063,
        "sender_full_name": "Kyle Ellefsen",
        "timestamp": 1725043099
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306577\">@Matthew Ballard</span> helped me out in another thread. The way to execute a lean file that depends on libraries stored inside the project's <code>.lake</code> file is with the command:</p>\n<p><code>lake env lean --run myfile.lean</code></p>\n<p>This doesn't allow execution of lean that imports mathlib <strong>outside</strong> a project, but it gets me pretty far so I'm marking this resolved.</p>",
        "id": 467331270,
        "sender_full_name": "Kyle Ellefsen",
        "timestamp": 1725387377
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"673037\">Kyle Ellefsen</span> has marked this topic as resolved.</p>",
        "id": 467331293,
        "sender_full_name": "Notification Bot",
        "timestamp": 1725387385
    }
]