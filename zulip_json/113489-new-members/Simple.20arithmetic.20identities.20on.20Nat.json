[
    {
        "content": "<p>I'm having trouble proving the following proposition, which should be simple enough.</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">|-</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Using <code>simpl_arith</code> reduces the left hand side to <code>2 * (2 ^ h - 1) + 2 = 2 ^ (h + 1)</code>, and I have been trying to continue from there by using <code>calc</code>, but it has been a bit more involved that I had expected at first. Does anyone know of a simple way of solving these kinds of simple arithmetic identities?</p>",
        "id": 466328204,
        "sender_full_name": "Ayhon",
        "timestamp": 1725044959
    },
    {
        "content": "<p>the characteristic that makes this kind of statement more involved than usual, is that it involves a subtraction where it is not immediately clear that the left operand is at least the right operand. in this case, you will somewhere need to make use of the fact that <code>2 ^ h</code> is at least <code>1</code> for all <code>h</code>.<br>\nas such, i'd assume the best way to go about this is to make sure <code>2 ^ h</code> is the only expression containing <code>h</code>, use <code>have</code> to add to the context that <code>1 &lt;= 2 ^ h</code>, then use <code>generalize 2 ^ h = z at this ⊢</code>. from that point on, i think the <code>omega</code> tactic should suffice.</p>",
        "id": 466330254,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1725045950
    },
    {
        "content": "<p>concretely:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">pow_add</span><span class=\"o\">,</span><span class=\"n\">pow_one</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">one_le_pow</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">zero_lt_two</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">generalize</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"bp\">⊢</span>\n<span class=\"w\">  </span><span class=\"n\">omega</span>\n</code></pre></div>",
        "id": 466330605,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1725046109
    },
    {
        "content": "<p>You don't even need the <code>generalize</code> step, as omega will treat <code>2 ^ h</code> like an atom.</p>",
        "id": 466330970,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1725046257
    },
    {
        "content": "<p>You can use <code>rw?</code> to find a result that reduces <code>2 ^ (h + 1)</code>, e.g., <code>rw [Nat.two_pow_succ]</code><br>\nThen, use <code>have : 1 ≤ 2 ^ h := by exact?</code> to get <code>Nat.one_le_two_pow</code>.</p>",
        "id": 466331251,
        "sender_full_name": "Scott Carnahan",
        "timestamp": 1725046397
    },
    {
        "content": "<p>yea, i just feel like these theorems are more generally applicable and therefore good to know about. (although i did have to search for <code>Nat.zero_lt_two</code> ironically <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span> )</p>",
        "id": 466332088,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1725046788
    },
    {
        "content": "<p>I had never heard of <code>omega</code> before. What does it do?</p>",
        "id": 466332166,
        "sender_full_name": "Ayhon",
        "timestamp": 1725046812
    },
    {
        "content": "<p>it is a tactic which proves (in)equalities of natural numbers</p>",
        "id": 466333377,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1725047275
    },
    {
        "content": "<p>see also the hover-text</p>",
        "id": 466333490,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1725047312
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/stream/113489-new-members/topic/Simple.20arithmetic.20identities.20on.20Nat/near/466333377\">said</a>:</p>\n<blockquote>\n<p>it is a tactic which proves (in)equalities of natural numbers</p>\n</blockquote>\n<p>*linear (in)equalities</p>",
        "id": 466335020,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1725047990
    }
]