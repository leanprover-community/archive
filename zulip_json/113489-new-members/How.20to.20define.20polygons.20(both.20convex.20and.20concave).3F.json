[
    {
        "content": "<p>I'm looking at <a href=\"https://en.wikipedia.org/wiki/Polygon\">Wikipedia article about polygon</a> and seeing that I need a 'simple polygon'. Is the wiki's definition okay? Or there's something better?</p>",
        "id": 560937334,
        "sender_full_name": "IlmÄrs CÄ«rulis",
        "timestamp": 1764442914
    },
    {
        "content": "<p>My definition of (closed simple) polygonal chain:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">closed_simple_polygonal_chain</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„•</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NeZero</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">prop1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">â‰ </span><span class=\"w\"> </span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">prop2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">âˆˆ</span><span class=\"w\"> </span><span class=\"n\">segment</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">â†’</span>\n<span class=\"w\">    </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">âˆˆ</span><span class=\"w\"> </span><span class=\"n\">segment</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">â†’</span>\n<span class=\"w\">    </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">prop3</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">â‰ </span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">â‰ </span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">â‰ </span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">â†’</span>\n<span class=\"w\">    </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">âˆˆ</span><span class=\"w\"> </span><span class=\"n\">segment</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">â†’</span>\n<span class=\"w\">    </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">âˆˆ</span><span class=\"w\"> </span><span class=\"n\">segment</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">â†’</span>\n<span class=\"w\">    </span><span class=\"n\">False</span>\n</code></pre></div>\n<p>Looks good to me, at least for the start.</p>\n<p>Should I prove some case of Jordan curve theorem? Then I should be able talk about the \"inside\" and \"outside\" of the polygon in addition to the border.</p>",
        "id": 560946243,
        "sender_full_name": "IlmÄrs CÄ«rulis",
        "timestamp": 1764451613
    },
    {
        "content": "<p>(It seems that Mathlib is without Jordan curve theorem. How reasonable would be to try to prove this theorem for relative beginner? And, of course, maybe someone is already working on it.)</p>\n<p>Edit: Probably not reasonable.</p>",
        "id": 560946369,
        "sender_full_name": "IlmÄrs CÄ«rulis",
        "timestamp": 1764451736
    },
    {
        "content": "<p>This seems related to <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Convex/SimplicialComplex/Basic.html#Geometry.SimplicialComplex\">Geometry.SimplicialComplex</a>, though defining it in terms of that may be tricky.</p>",
        "id": 560947548,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1764452927
    },
    {
        "content": "<p>I think your <code>prop3</code> may be wrong. In the current form it is stronger than <code>prop2</code>.</p>",
        "id": 560947588,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1764452966
    },
    {
        "content": "<p>The question is a bit what you actually want to do with the polygons. If you want to compare two polygons for equality, then a structure containing a <code>Fin n â†’ P</code> will give you problems, because <code>![a,b,c]</code> and <code>![b,c,a]</code> will give \"different\" polygons</p>",
        "id": 560947789,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1764453192
    },
    {
        "content": "<p>Yes, <code>prop3</code> looks wrong. Will fix it.</p>",
        "id": 560948250,
        "sender_full_name": "IlmÄrs CÄ«rulis",
        "timestamp": 1764453624
    },
    {
        "content": "<p>It needs to exclude cases <code>i = j + 1</code> and <code>j = i + 1</code>, too. The case of consecutive segments.</p>",
        "id": 560948644,
        "sender_full_name": "IlmÄrs CÄ«rulis",
        "timestamp": 1764454031
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479299\">Jovan Gerbscheid</span> <a href=\"#narrow/channel/113489-new-members/topic/How.20to.20define.20polygons.20.28both.20convex.20and.20concave.29.3F/near/560947548\">said</a>:</p>\n<blockquote>\n<p>This seems related to <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Convex/SimplicialComplex/Basic.html#Geometry.SimplicialComplex\">Geometry.SimplicialComplex</a>, though defining it in terms of that may be tricky.</p>\n</blockquote>\n<p><span aria-label=\"eyes\" class=\"emoji emoji-1f440\" role=\"img\" title=\"eyes\">:eyes:</span> At the first moment this structure terrifies me, but I will try to use it.</p>",
        "id": 560949533,
        "sender_full_name": "IlmÄrs CÄ«rulis",
        "timestamp": 1764454970
    },
    {
        "content": "<p>Yeah, I agree it doesn't look very simple. It might be easier to not use it. But if you do want to use it, here's my first stab at defining a polygon:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Geometry</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">PartialOrder</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">SimplicialComplex</span><span class=\"bp\">.</span><span class=\"n\">IsSimplePolygon</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimplicialComplex</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"w\">  </span><span class=\"bp\">âˆƒ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">âˆƒ</span><span class=\"w\"> </span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Pairwise</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">â†¦</span><span class=\"w\"> </span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">â‰ </span><span class=\"w\"> </span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">âˆ§</span>\n<span class=\"w\">    </span><span class=\"n\">K</span><span class=\"bp\">.</span><span class=\"n\">facets</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">â†¦</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)}</span>\n</code></pre></div>\n<p>Note that the file defining <code>SimplicialComplex</code> has a TODO about generalizing it to affine spaces, which would be needed to use it for euclidean geometry.</p>",
        "id": 560950978,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1764456670
    },
    {
        "content": "<p>If I use the definition with <code>ğ•œ = â„</code> and <code>E = EuclideanSpace â„ (Fin 2)</code>, does it fail in some way?</p>",
        "id": 560953061,
        "sender_full_name": "IlmÄrs CÄ«rulis",
        "timestamp": 1764458802
    },
    {
        "content": "<p>Yeah, <code>EuclideanSpace â„ (Fin 2)</code> doesn't have a <code>0</code>, but <code>E</code> needs to be an <code>AddCommGroup</code>. That's the point of a space being affine: it has no fixed zero point.</p>",
        "id": 560953128,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1764458901
    },
    {
        "content": "<p>I didn't read the context but <code>EuclideanSpace â„ (Fin 2)</code> does have a 0?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n</code></pre></div>",
        "id": 560953318,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1764459225
    },
    {
        "content": "<p>Oh sorry my bad.</p>",
        "id": 560953332,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1764459255
    },
    {
        "content": "<p>Yes, it seems I got it. If we use affine space then <code>E</code> can't be <code>AddCommGroup</code> because there's no zero. So the definition has to be upgraded somehow.</p>",
        "id": 560953345,
        "sender_full_name": "IlmÄrs CÄ«rulis",
        "timestamp": 1764459274
    },
    {
        "content": "<p>seems to be <code>convexHull</code> that needs generalizing</p>",
        "id": 560953577,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1764459581
    },
    {
        "content": "<p>Indeed, and I think for that we need to generalize <code>Convex</code>, which is awaiting the new definition of <code>ConvexSpace</code> in <a class=\"stream-topic\" data-stream-id=\"217875\" href=\"/#narrow/channel/217875-Is-there-code-for-X.3F/topic/convex.20combinations.3F/with/558990019\">#Is there code for X? &gt; convex combinations?</a></p>",
        "id": 560953770,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1764459760
    },
    {
        "content": "<p>did we have an old definition of <code>ConvexSpace</code>?</p>",
        "id": 560954060,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1764460106
    },
    {
        "content": "<p>No</p>",
        "id": 560954155,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1764460226
    },
    {
        "content": "<p>Is using affine space necessary (to generalize, probably?), if I want to talk about polygons?</p>\n<p>If affirmative, then I could use Euclidean space for now and wait for the upgrade, and then update my definitions and proofs.</p>",
        "id": 560954194,
        "sender_full_name": "IlmÄrs CÄ«rulis",
        "timestamp": 1764460272
    },
    {
        "content": "<p>Yes, I think you should be able to do everying for <code>EuclideanSpace</code> for the short term. And then later it shouldn't be too hard to generalize them. Or rather, you could do it for 2-dimensional real vector spaces.</p>",
        "id": 560954383,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1764460487
    },
    {
        "content": "<p>I think <code>SimplicialComplex</code> overly complicates things and a polygon should simply be a structure containing <code>Fin n â†’ P</code> for an affine space <code>P</code> (and then you add definitions for all the properties you might want a polygon to have - vertices coplanar, boundary a simple curve, convex, etc., and prove results using the minimum conditions required for each result).</p>\n<p>The lack of convexity for affine spaces is not an obstacle here because convexity of sets of points doesn't seem particularly helpful in defining convex polygons. You could define a convex polygon, for example, as one with at least three vertices where, for every two consecutive vertices, all the others are on the same side (<code>AffineSubspace.SSameSide</code>) of the line through those two vertices (which implies the vertices are coplanar, there's no need to restrict to an ambient 2-dimensional space), or many other possible definitions.</p>\n<p>Since I want to be able to state problems with conditions of the form \"Let ABCDE be a convex pentagon\" (where it's definitely meaningful to say that vertex 0 is A, vertex 1 is B, etc., and so to distinguish ABCDE from BCDEA), the consequences for equality of using <code>Fin n â†’ P</code> are exactly what I want.</p>",
        "id": 560959660,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1764466622
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"479299\">@Jovan Gerbscheid</span> Apologies for a noob question... Can such polygon, defined as you show, be concave too? Or only convex?</p>",
        "id": 560962662,
        "sender_full_name": "IlmÄrs CÄ«rulis",
        "timestamp": 1764470897
    },
    {
        "content": "<p>The <code>SimplicialComplex</code> requires</p>\n<ul>\n<li>The points of the faces are affine independent (which doesn't mean anything if the faces are up to 1 dimensional)</li>\n<li>For any face, a sub-face is inside. This means that for each edge {i, i+1}, there must also be the singleton faces {i} and {i+1}.</li>\n<li><code>inter_subset_convexHull</code>, which gives that for any two faces, the intersection of their convex hulls is the convex hull of their intersection. In our case, this means that if two line segments of our polygon intersect, they must actually share an end-point.</li>\n</ul>\n<p>So we get that the polygon is not self intersecting, but we don't get that it is convex</p>",
        "id": 560985366,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1764495987
    },
    {
        "content": "<p>Thank you!</p>",
        "id": 560989202,
        "sender_full_name": "IlmÄrs CÄ«rulis",
        "timestamp": 1764500068
    },
    {
        "content": "<p>Oh and the part about affine independence says that it is an implementation detail. I think it might be possible to prove this from the other axioms?</p>",
        "id": 561005274,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1764514704
    }
]