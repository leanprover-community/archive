[
    {
        "content": "<p>If my type <code>T</code> contains both <code>K</code>s and <code>R</code>s and I have both <code>Membership K T</code> and <code>Membership R T</code> instances defined, how can I specify that for proposition <code>âˆ€ i âˆˆ t, SomeProp i</code> I want <code>i</code> to have type <code>K</code>?</p>\n<p>The normal type annotation syntax doesn't appear to work here:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">SomeProp</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">prop</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">item</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SomeProp</span><span class=\"w\"> </span><span class=\"n\">item</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">K</span>\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">R</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"bp\">Ã—</span><span class=\"w\"> </span><span class=\"n\">R</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">âˆˆ</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">SomeProp</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span>\n<span class=\"c1\">-- doesn't work              ðŸ‘†</span>\n</code></pre></div>",
        "id": 505081394,
        "sender_full_name": "aron",
        "timestamp": 1741773510
    },
    {
        "content": "<p>You shouldn't have both <code>Membership K T</code> and <code>Membership R T</code> because a lot of other things will break too if you do.</p>",
        "id": 505088455,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741775252
    },
    {
        "content": "<p>Oh. Is there no way to specify different kinds of membership for different purposes?</p>",
        "id": 505101691,
        "sender_full_name": "aron",
        "timestamp": 1741778664
    },
    {
        "content": "<p>What purpose are you using this for?</p>",
        "id": 505108044,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741780350
    },
    {
        "content": "<p>I'd suggest not creating Membership instances for T, but instead make use of projections to disambiguate, like <code>i âˆˆ t.1</code></p>\n<p>(It's generally helpful to have a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a>, and in this case, probably something that's more realistic than \"SomeProp\", \"K\", and \"R\", since it obscures what you're trying to model â€” it's not always obvious what the right way to model things is, and the details can help if there's another approach worth suggesting.)</p>",
        "id": 505115174,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1741782099
    },
    {
        "content": "<p>Oh btw I figured this out! it turns out<br>\n<code>âˆ€ i âˆˆ t, SomeProp i</code><br>\nis syntax sugar for<br>\n<code>âˆ€ i, i âˆˆ t â†’ SomeProp i</code><br>\nso you can add a type annotation there as usual:<br>\n<code>âˆ€ (i : K), i âˆˆ t â†’ SomeProp i</code></p>\n<p>Now my example looks for the correct <code>Membership</code> instance:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">SomeProp</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">prop</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">item</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SomeProp</span><span class=\"w\"> </span><span class=\"n\">item</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">K</span>\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">R</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"bp\">Ã—</span><span class=\"w\"> </span><span class=\"n\">R</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">âˆˆ</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"n\">SomeProp</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span>\n<span class=\"c1\">-- failed to synthesize</span>\n<span class=\"c1\">--  Membership K T</span>\n</code></pre></div>",
        "id": 507725261,
        "sender_full_name": "aron",
        "timestamp": 1742814789
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"814082\">aron</span> has marked this topic as resolved.</p>",
        "id": 507725866,
        "sender_full_name": "Notification Bot",
        "timestamp": 1742814926
    }
]