[
    {
        "content": "<p>This isn't anything practical but I'm curious if it's possible to prove anything about a program like this.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"s2\">\"Hello\"</span>\n</code></pre></div>\n<p>Or is it fully opaque to theorems?</p>",
        "id": 537013507,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1756680395
    },
    {
        "content": "<p>Well, you can prove <code>main = main</code>, or something like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"s2\">\"Hello\"</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">main2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"s2\">\"H\"</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"s2\">\"ello\"</span><span class=\"o\">)</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">main2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 537015211,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1756682801
    },
    {
        "content": "<p>But <code>IO.println</code> ultimately calls <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IO.getStdout#doc\">docs#IO.getStdout</a>, which is opaque</p>",
        "id": 537015311,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1756682933
    },
    {
        "content": "<p>or even :</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">exist_string_printed_main</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"bp\">âˆƒ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"s2\">\"Hello\"</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 537015395,
        "sender_full_name": "Alfredo Moreira-Rosa",
        "timestamp": 1756683053
    },
    {
        "content": "<p>so definitely not opaque</p>",
        "id": 537015540,
        "sender_full_name": "Alfredo Moreira-Rosa",
        "timestamp": 1756683213
    },
    {
        "content": "<p>I see, so I guess I can't unfold <code>getStdout</code> (which makes sense) but I can in principle unfold other stuff (including <code>main</code> itself and even some intermediate functions before we get too deep, though maybe that breaks encapsulation too much).</p>",
        "id": 537016353,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1756684581
    }
]