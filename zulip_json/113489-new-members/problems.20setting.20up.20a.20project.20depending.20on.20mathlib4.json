[
    {
        "content": "<p>I'd like to start learning about mathlib4 (I'm very far from being able to help with the port, but maybe I could eventually even learn enough for that). However, I have trouble setting up mathlib4 (no doubt because of my lack of computer skills). I'd appreciate a lot if someone can tell me what I'm doing wrong. I'm on a Ubuntu 16.04 (a bit old admittedly).</p>\n<p>I'm trying to follow instructions from &lt;<a href=\"https://github.com/leanprover-community/mathlib4\">https://github.com/leanprover-community/mathlib4</a>&gt; section \"Using mathlib4 as a dependency\".</p>\n<p>Reading the warning about recent toolchains required, I started as follows:</p>\n<div class=\"codehilite\" data-code-language=\"code\"><pre><span></span><code>$ elan self update\ninfo: checking for self-updates\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"code\"><pre><span></span><code>$ elan default leanprover/lean4:nightly-2023-02-04\ninfo: using existing install for 'leanprover/lean4:nightly-2023-02-04'\ninfo: default toolchain set to 'leanprover/lean4:nightly-2023-02-04'\n\n  leanprover/lean4:nightly-2023-02-04 unchanged - (error reading lean version)\n</code></pre></div>\n<p>The error is not reassuring, but I was not quite sure about it, so I tried to go on.</p>\n<div class=\"codehilite\" data-code-language=\"code\"><pre><span></span><code>$ lake new MyProject math\n/home/kalle/.elan/toolchains/leanprover--lean4---nightly-2023-02-04/bin/lake: /lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.27' not found (required by /home/kalle/.elan/toolchains/leanprover--lean4---nightly-2023-02-04/lib/libLLVM-15.so)\n</code></pre></div>\n<p>At this point I assume that I have failed to set up Mathlib4 this way. The best would be to know how to fix the <code>elan</code> error above, but I tried something else <span aria-label=\"grimacing\" class=\"emoji emoji-1f62c\" role=\"img\" title=\"grimacing\">:grimacing:</span>.</p>",
        "id": 328652596,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1676720991
    },
    {
        "content": "<p>I decided to still try with the stable toolchain, because at least it didn't give elan errors.</p>\n<div class=\"codehilite\" data-code-language=\"code\"><pre><span></span><code>$ elan default leanprover/lean4:stable\ninfo: using existing install for 'leanprover/lean4:stable'\ninfo: default toolchain set to 'leanprover/lean4:stable'\n\n  leanprover/lean4:stable unchanged - Lean (version 4.0.0, commit 7dbfaf9b7519, Release)\n</code></pre></div>\n<p>Looks better. But of course explicitly against the warning that mathlib4 requires a more recent toolchain... Nevertheless, I boldly ran</p>\n<div class=\"codehilite\" data-code-language=\"code\"><pre><span></span><code>lake new MyProject math\n</code></pre></div>\n<p>and got no errors and found a folder <code>MyProject</code></p>\n<div class=\"codehilite\" data-code-language=\"code\"><pre><span></span><code>$ ls MyProject/\nlakefile.lean  MyProject.lean\n</code></pre></div>\n<p>I have seen others at this point also find a file <code>lean-toolchain</code> in this folder, so I don't know if I should be concerned.</p>\n<p>Pretending to be unconcerned, I went on to the folder and ran:</p>\n<div class=\"codehilite\" data-code-language=\"code\"><pre><span></span><code>$ lake exe cache get\ninfo: cloning https://github.com/leanprover-community/mathlib4.git to ./lean_packages/mathlib\nerror: ./lean_packages/mathlib/lakefile.lean:7:2: error: unknown attribute [default_target]\nerror: ./lean_packages/mathlib/lakefile.lean:14:2: error: unknown attribute [default_target]\nerror: ./lean_packages/mathlib/lakefile.lean: package configuration has errors\n</code></pre></div>\n<p>So this failed. Same failure with:</p>\n<div class=\"codehilite\" data-code-language=\"code\"><pre><span></span><code>$ lake build\ninfo: mathlib: no manifest entry; deleting ./lean_packages/mathlib and cloning again\ninfo: cloning https://github.com/leanprover-community/mathlib4.git to ./lean_packages/mathlib\nerror: ./lean_packages/mathlib/lakefile.lean:7:2: error: unknown attribute [default_target]\nerror: ./lean_packages/mathlib/lakefile.lean:14:2: error: unknown attribute [default_target]\nerror: ./lean_packages/mathlib/lakefile.lean: package configuration has errors\n</code></pre></div>\n<p>I assume the package configuration errors are a mismatch of the mathlib4 required toolchain and the stable toolchain that I have.</p>",
        "id": 328652736,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1676721038
    },
    {
        "content": "<p>So I assume the issue is the <code>elan</code> failure at trying to install a more recent toolchain. Does this look like a correct diagnosis to people who understand computers? Does anyone have hints on how to fix the <code>elan</code> failure to install a more recent toolchain? Thanks in advance for any advice!</p>",
        "id": 328652787,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1676721057
    },
    {
        "content": "<p>Yes I think your old OS is preventing you from using a recent lean/lake, which is preventing you from using a recent mathlib4.</p>",
        "id": 328654918,
        "sender_full_name": "Reid Barton",
        "timestamp": 1676721857
    },
    {
        "content": "<p>Ouch... But thanks!</p>\n<p>I can use Lean4 and Lean3+mathlib3 on my OS, so it is a pity that mathlib4 doesn't work.</p>\n<p>Does someone know the reason mathlib4 requires newer OS, and whether it will stay that way? Or will it eventually even be possible to use mathlib4 on Ubuntu 16.04?</p>",
        "id": 328657451,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1676722787
    },
    {
        "content": "<p>The reason is contained in your first error message, mathlib requires a new lean/lake, which requires a new LLVM, which requires a new libm, etc</p>",
        "id": 328657735,
        "sender_full_name": "Reid Barton",
        "timestamp": 1676722886
    },
    {
        "content": "<p>Whether it might change, I can't say.</p>",
        "id": 328657786,
        "sender_full_name": "Reid Barton",
        "timestamp": 1676722912
    },
    {
        "content": "<p>Considering 16.04 is no longer getting free updates, I would guess it's not a priority</p>",
        "id": 328658279,
        "sender_full_name": "Reid Barton",
        "timestamp": 1676723085
    },
    {
        "content": "<p>...and if this is really about the whole (recent) lean-toolchain, is it likely that at some point soon Lean4 itself might no longer work on Ubuntu 16.04?</p>",
        "id": 328659414,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1676723592
    },
    {
        "content": "<p>Well, the version that works will continue to work</p>",
        "id": 328659531,
        "sender_full_name": "Reid Barton",
        "timestamp": 1676723641
    },
    {
        "content": "<p>Sure! But \"stable\" might soon mean a more recent tool chain, right?</p>\n<p>(Sorry, I have a very poor understanding of software, so I may just be totally confused.)</p>",
        "id": 328659766,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1676723703
    },
    {
        "content": "<p>Yes, I would assume so. The current \"stable\" version is from August</p>",
        "id": 328659981,
        "sender_full_name": "Reid Barton",
        "timestamp": 1676723784
    },
    {
        "content": "<p>Thanks a lot for the explanations!</p>\n<p>I will perhaps consider getting a more recent OS, but that looks like a nontrivial project to me, so for now it looks like I will just have to give up on mathlib4. <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span></p>",
        "id": 328660249,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1676723892
    },
    {
        "content": "<p>My first step towards upgrading my os has typically been to buy a new computer, but that may not be practical <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span> </p>\n<p>I'd still strongly recommend getting something newer than 16.04, though</p>",
        "id": 328664594,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1676725653
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"373986\">Kalle Kytölä</span> <a href=\"#narrow/stream/113489-new-members/topic/problems.20setting.20up.20a.20project.20depending.20on.20mathlib4/near/328652596\">said</a>:</p>\n<blockquote>\n<p>I'm very far from being able to help with the port, but maybe I could eventually even learn enough for that.</p>\n</blockquote>\n<p>This isn't true at all. Your Lean 3 work already makes you over-qualified for the port. We have people helping with the port that had never written a single line of Lean code (in any version) before starting their work. All you need is time.</p>",
        "id": 328698463,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1676738751
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"373986\">Kalle Kytölä</span> <a href=\"#narrow/stream/113489-new-members/topic/problems.20setting.20up.20a.20project.20depending.20on.20mathlib4/near/328660249\">said</a>:</p>\n<blockquote>\n<p>Thanks a lot for the explanations!</p>\n<p>I will perhaps consider getting a more recent OS, but that looks like a nontrivial project to me, so for now it looks like I will just have to give up on mathlib4. <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span></p>\n</blockquote>\n<p>I wonder if installing elan via Nix is enough to make Lean 4 work on your computer. I would only recommend this if you have root access (<code>nix-user-chroot</code> exists but it's less polished), but you wouldn't need to upgrade your Ubuntu.</p>",
        "id": 328706268,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1676742280
    },
    {
        "content": "<p>Perhaps there is a better way to work around the glibc version issue, but I tested on an Ubuntu 16.04 VM and installing elan via Nix seems to work. If you'd like to try, you install Nix by downloading <a href=\"https://nixos.org/nix/install\">https://nixos.org/nix/install</a> and running <code>chmod +x install; ./install --no-daemon</code>. Then you restart your terminal, remove your current version of elan and run <code>nix-env -iA nixpkgs.elan</code>.</p>",
        "id": 328713076,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1676746066
    },
    {
        "content": "<p>Upgrading Ubuntu is pretty easy and you don't even need to back up your stuff, at least if you're happy to gamble</p>",
        "id": 328736375,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1676761726
    },
    {
        "content": "<p>I did indeed start upgrading my OS, and it seemed easy enough (also figured 2023 is as good a time as any to upgrade an OS from 2016). I guess a person with normal computer skills would just succeed.</p>\n<p>But I'm afraid I'm not one. I now do have a newer Ubuntu --- just unfortunately without working keyboard input, which makes it hard to use terminal to fix anything (or to do anything else).</p>\n<p>I'm not particularly worried --- it's not my first time messing up computers and I did make backups (for the most part). But I think I'll just opt for a fresh OS install from scratch instead of fighting to fix a borked upgrade of an ancient OS in some recovery mode (in addition to keyboard, at least some third party GPU drivers did not live happily everafter). But that will have to wait until the next weekend...</p>\n<p>I think OS upgrade is a reasonable (but not entirely trivial) option.</p>\n<p>I was too hasty so I never got around to trying the nix solution. That seems like an interesting alternative --- thanks!</p>",
        "id": 328785217,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1676802532
    }
]