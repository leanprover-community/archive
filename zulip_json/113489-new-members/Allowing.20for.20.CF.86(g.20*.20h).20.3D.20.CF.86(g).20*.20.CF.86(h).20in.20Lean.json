[
    {
        "content": "<p>A textbook would describe a group homomorphism as a function φ : G → H such that φ(g * h) = φ(g) * φ(h) for all g, h ∈ G.</p>\n<p>Expressing φ(g * h) = φ(g) * φ(h) for all g, h ∈ G in Lean might look like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"w\"> </span><span class=\"n\">Works</span><span class=\"bp\">.</span>\n</code></pre></div>\n<p>Beginners <del>who might worry about operator precedence</del> sometimes add extra parentheses to be extra clear, which Lean accepts:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"w\"> </span><span class=\"n\">Works</span><span class=\"bp\">.</span>\n</code></pre></div>\n<p>However, writing it <em>exactly</em> like we're used to from textbooks, with parentheses and without spaces, does not work:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"w\"> </span><span class=\"n\">Does</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">work</span><span class=\"bp\">.</span>\n</code></pre></div>\n<p>Why is whitespace significant here? What would break if it wasn't?</p>",
        "id": 495149766,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1737495789
    },
    {
        "content": "<p>Doesn't your question apply equally to any function application? Is there a reason <code>f(12)</code> is any more or less mathematically natural looking when <code>f</code> isn't a group homomorphism?</p>",
        "id": 495150761,
        "sender_full_name": "Julian Berman",
        "timestamp": 1737496267
    },
    {
        "content": "<p><code>φ (g) * φ (h)</code> does not ensure the operator precedence you want--what you actually want to ensure it is <code>(φ g) * (φ h)</code></p>",
        "id": 495150920,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1737496326
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span> Indeed, I just started considering it in the context of group homomorphisms.</p>\n<p><span class=\"user-mention\" data-user-id=\"761203\">@Vlad Tsyrklevich</span> That's true! I suppose a beginner concerned about precedence might fully parenthesize everything like this …</p>\n<p><code>example (φ : G →* H) (g h : G) : φ (g * h) = (φ (g)) * (φ (h)) := by simp # Works.</code></p>\n<p>… which Lean accepts, whereas this …</p>\n<p><code>example (φ : G →* H) (g h : G) : φ(g * h) = (φ(g)) * (φ(h)) := by simp # Does not work.</code></p>\n<p>… is not accepted.</p>",
        "id": 495151996,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1737496800
    },
    {
        "content": "<p>It is just the way it works. Function application has a high level of precedence, so that white spaces play the role played by parentheses in paper maths, so the parentheses are useless, and once you are used to it they just damage readability in my opinion. Anyway as you see this is not authorized.</p>",
        "id": 495153684,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1737497527
    },
    {
        "content": "<p>It could also introduce parser ambiguity, I mean this is a contrived example, but:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">infix</span><span class=\"o\">:</span><span class=\"mi\">50</span><span class=\"w\"> </span><span class=\"s2\">\")(\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)(</span><span class=\"mi\">2</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">)(</span><span class=\"mi\">2</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Is this <code>f 3</code> or <code>(f 1) 2</code></p>",
        "id": 495154569,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1737497919
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"761203\">Vlad Tsyrklevich</span> <a href=\"#narrow/channel/113489-new-members/topic/Allowing.20for.20.CF.86.28g.20*.20h.29.20.3D.20.CF.86.28g.29.20*.20.CF.86.28h.29.20in.20Lean/near/495154569\">said</a>:</p>\n<blockquote>\n<p>It could also introduce parser ambiguity, I mean this is a contrived example, but:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">infix</span><span class=\"o\">:</span><span class=\"mi\">50</span><span class=\"w\"> </span><span class=\"s2\">\")(\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)(</span><span class=\"mi\">2</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">)(</span><span class=\"mi\">2</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Is this <code>f 3</code> or <code>(f 1) 2</code></p>\n</blockquote>\n<p>this just highlights an issue with introducing unmatching bracket notation when usually all bracket notation matches, not an issue with the bracket function application itself.</p>",
        "id": 495155272,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737498231
    },
    {
        "content": "<p>I'm trying to think of a way to explain to a fellow undergraduate mathematics student how <code>φ (g * h) = φ (g) * φ (h)</code> is materially different from <code>φ(g * h) = φ(g) * φ(h)</code>.</p>",
        "id": 495157224,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1737498982
    },
    {
        "content": "<p>Why is \"there are spaces missing\", not a valid explanation?</p>",
        "id": 495157351,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737499037
    },
    {
        "content": "<p>While that response is certainly technically accurate I would expect -- right or wrong -- him/her to simply respond with: \"Why does formalization force me to insert spaces, and exactly where should they go? Isn't this a problem that can be resolved?\".</p>\n<p>I'm trying to figure out how to best answer those questions in a way that is meaningful to an undergraduate mathematics student.</p>",
        "id": 495158537,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1737499549
    },
    {
        "content": "<p>I do not know the details of parsing, but the parser needs to have some assurances that certain things will be of a given form.  I do not think that it is impossible for formalization to remove the spaces, but it would likely be a lot of work to redesign the Lean parsers to accept the syntax that you propose.</p>",
        "id": 495158994,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737499786
    },
    {
        "content": "<p>If you are happy to explain to students the Lean convention just say that you have to put a space after the name of the function.</p>",
        "id": 495160161,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737500319
    },
    {
        "content": "<p>if they ask why you can just say that formalization is very rigid sometimes, it's not like writing math on paper. This sooner or later will happen anyway</p>",
        "id": 495160264,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737500377
    },
    {
        "content": "<p>I understand—so the correct answer is more along the lines of \"that would require a lot of work (and probably isn't worth it)\" rather than \"that would break A, B, and C (which we are unwilling to do)\"?</p>",
        "id": 495160288,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1737500391
    },
    {
        "content": "<p>I am pretty sure that a lot of things would break if you allowed that and the \"work\" would be to fix those other things.</p>",
        "id": 495160469,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737500450
    },
    {
        "content": "<p>I don't think \"it would be lots of work\" is the answer. It was an active decision to not allow this syntax</p>",
        "id": 495161870,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737501129
    },
    {
        "content": "<p>Would you mind elaborating on the reasoning behind this design decision? I'm interested in understanding the factors that led to disallowing that syntax (I'm not questioning the decision, just looking to understand it more fully).</p>",
        "id": 495162507,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1737501409
    },
    {
        "content": "<p>I think one argument is that forbidding the notation for function application lets it be used for custom notation instead</p>",
        "id": 495165080,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737502618
    },
    {
        "content": "<p>eg <code>congr()</code>, <code>ofNat()</code>, and other \"magic\" notation that is doing something at compile-time</p>",
        "id": 495165114,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737502637
    },
    {
        "content": "<p>I just tell my students \"this is how functional programming languages work, turns out mathematicians put too many brackets\"</p>",
        "id": 495218168,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737532340
    },
    {
        "content": "<p>Turns out, not all functional languages work this way - some are worse than mathematicians.</p>\n<p>But essentially, I tell my students the same thing - except, since they are computer science students, I can <em>blame</em> the mathematicians.</p>",
        "id": 495226945,
        "sender_full_name": "Philippe Duchon",
        "timestamp": 1737535644
    },
    {
        "content": "<p>You can try defining </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">macro</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"o\">:</span><span class=\"n\">max</span><span class=\"s2\">\"(\"</span><span class=\"n\">b</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"s2\">\")\"</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"bp\">$</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">b</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>and seeing what breaks</p>",
        "id": 495399784,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1737592934
    }
]