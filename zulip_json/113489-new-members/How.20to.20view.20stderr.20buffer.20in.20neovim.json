[
    {
        "content": "<p>It says in the README of <a href=\"https://github.com/Julian/lean.nvim\">https://github.com/Julian/lean.nvim</a>, that \"The default implementation will redirect to a dedicated stderr window\", but I don't see any new window even though I've used <code>dbgTrace</code>. It works in vscode, I get a \"Lean server printed an error:\" notification.<br>\n<span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span></p>",
        "id": 564628771,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1766126734
    },
    {
        "content": "<p>Can you give me a full example I can try?</p>",
        "id": 564632570,
        "sender_full_name": "Julian Berman",
        "timestamp": 1766128774
    },
    {
        "content": "<p>With this code the message \"here be dragons\" is not found in infoview. Lean prints it on stderr. VS Code prints this in a notification.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">PrettyPrinter</span><span class=\"bp\">.</span><span class=\"n\">Delaborator</span>\n\n<span class=\"kn\">opaque</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">delab</span><span class=\"w\"> </span><span class=\"n\">app</span><span class=\"bp\">.</span><span class=\"n\">x</span><span class=\"kd\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">my_delab</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Delab</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">dbgTrace</span><span class=\"w\"> </span><span class=\"s2\">\"here be dragons\"</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"mi\">42</span><span class=\"o\">)</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- put cursor here</span>\n</code></pre></div>\n<p><a href=\"/user_uploads/3121/TsgLbiWE6hmW6O0NwB2PcCwu/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/TsgLbiWE6hmW6O0NwB2PcCwu/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1920x1080\" src=\"/user_uploads/thumbnail/3121/TsgLbiWE6hmW6O0NwB2PcCwu/image.png/840x560.webp\"></a></div>",
        "id": 564647968,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1766134935
    },
    {
        "content": "<p>Thanks, I don't really understand what causes Lean to decide whether to send that <code>dbgTrace</code> to stderr, I was trying <code>#eval dbgTrace \"foo\" fun _ â†¦ 37</code> which goes to normal LSP diagnostics which is why I asked you for the example.<br>\nAnyways, fixed now in <a href=\"https://github.com/Julian/lean.nvim/commit/f567bd8241044c2ba1e1ab3ca655a43a16374b1b\">f567bd8</a> if you update. I'll try and turn that into a test at some point later, it's been on the list of known test gaps.</p>",
        "id": 564654420,
        "sender_full_name": "Julian Berman",
        "timestamp": 1766137311
    },
    {
        "content": "<p>Yeah, I've also tried with <code>#eval</code> when you asked for mwe, and noticed it's different. I was working on delaboration in mathlib. I don't know why it works that way, but in delaboration function also neither <code>trace</code> nor <code>logInfo</code> works.<br>\nThanks for the fix!</p>",
        "id": 564656522,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1766138022
    },
    {
        "content": "<p>(I am being lazy and not checking but maybe it depends on what monad we're inside or something, or maybe Lean is not happy if a delaborator fails...)</p>",
        "id": 564657168,
        "sender_full_name": "Julian Berman",
        "timestamp": 1766138246
    }
]