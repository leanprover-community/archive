[
    {
        "content": "<p>Following on from a previous discussion,  I'm now looking at implementing a version of <code>le_or_succ_le</code> in a library to go with the educational examples I'm developing. </p>\n<p>I started writing and then compared it to a more expert example (see below):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">le_or_succ_le</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"c1\">-- &lt; -- my attempt</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">le_or_succ_le</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"c1\">-- &lt; -- expert example</span>\n</code></pre></div>\n<p>I have some questions:</p>\n<ul>\n<li><code>theorem</code> or <code>lemma</code>, or doesn't it matter?</li>\n<li><code>Nat.le_or_succ</code> or <code>le_or_succ</code> .. and why? is Nat a reserved namespace?</li>\n<li><code>succ b</code> or <code>b+1</code> ? ... in my environment succ causes an error</li>\n<li>variables declared as natural numbers inside round or curly brackets? H MacBeth's course uses curly brackets, and round brackets for hypotheses.</li>\n</ul>\n<hr>\n<p>for convenience I've copied <span class=\"user-mention\" data-user-id=\"307953\">@Ruben Van de Velde</span>'s suggestion here:</p>\n<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/stream/113489-new-members/topic/mathlib.20version.20of.20.60le_or_succ_le.60/near/474138016\">said</a>:</p>\n<blockquote>\n<p>No opinion on whether it should be in mathlib, but it can be proved quite quickly:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Defs</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">le_or_succ_le</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">succ_le</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">le_or_lt</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span>\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 475307323,
        "sender_full_name": "rzeta0",
        "timestamp": 1728310337
    },
    {
        "content": "<p>curly brackets are implicit parameters. When calling a declaration/theorem one usually doesn't have to provide them. Lean will try to synthesise these parameters from the context provided by the other parameters.</p>",
        "id": 475323809,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1728314927
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"466334\">@Shreyas Srinivas</span> when I changed the round brackets to curley ones, it didn't work:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">le_or_succ_le</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"c1\">--&lt;-- error</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">succ_le</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">le_or_lt</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span>\n</code></pre></div>\n<p>So does having round brackets mean the definitions are necessarily explicit, and is this required when defining lemmas?</p>\n<p>Also I'm not calling the theorem, I'm defining it? Are we talking about different things?</p>",
        "id": 475325774,
        "sender_full_name": "rzeta0",
        "timestamp": 1728315290
    },
    {
        "content": "<p>You need to be a lot more specific than \"<code>--&lt;-- error</code>\" for us to diagnose. What does the error say?</p>",
        "id": 475326046,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1728315342
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> </p>\n<p>Here is the definition - using curly brackets:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">le_or_succ_le</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">succ_le</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">le_or_lt</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span>\n</code></pre></div>\n<p>Here is where it is used:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">le_or_succ_le</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\">     </span><span class=\"c1\">-- &lt; see below for error</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ne_of_lt</span>\n<span class=\"w\">    </span><span class=\"k\">calc</span>\n<span class=\"w\">      </span><span class=\"n\">n</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rel</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ha</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">norm_num</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ne_of_gt</span>\n<span class=\"w\">    </span><span class=\"k\">calc</span>\n<span class=\"w\">      </span><span class=\"n\">n</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rel</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hb</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">norm_num</span>\n</code></pre></div>\n<p>The error is as follows:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>function expected at\n  le_or_succ_le\nterm has type\n  ?m.8274 ≤ ?m.8275 ∨ ?m.8275 + 1 ≤ ?m.8274\n</code></pre></div>\n<p>There is no error when using round brackets in the definition.</p>",
        "id": 475328842,
        "sender_full_name": "rzeta0",
        "timestamp": 1728315864
    },
    {
        "content": "<hr>\n<p>Also i'd appreciate comments on the 4 specific questions in the original post.</p>",
        "id": 475329017,
        "sender_full_name": "rzeta0",
        "timestamp": 1728315918
    },
    {
        "content": "<p>Ah, so the error was not in the code you posted early, but in the code you hadn't posted yet! It's helpful if you can makes your posts <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> s, by also including the <code>import</code> lines.</p>",
        "id": 475329034,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1728315922
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> <a href=\"#narrow/stream/113489-new-members/topic/Questions.20about.20my.20first.20lemma.3A.20.60le_or_succ_le.60/near/475307323\">said</a>:</p>\n<blockquote>\n<ul>\n<li><code>theorem</code> or <code>lemma</code>, or doesn't it matter?</li>\n</ul>\n</blockquote>\n<p>they're the same once you import <code>Mathlib.*</code></p>\n<blockquote>\n<ul>\n<li><code>Nat.le_or_succ</code> or <code>le_or_succ</code> .. and why? is Nat a reserved namespace?</li>\n</ul>\n</blockquote>\n<p>It should have the <code>Nat.</code> prefix, but this is implied if you write it in <code>namespace Nat</code>.</p>\n<blockquote>\n<ul>\n<li><code>succ b</code> or <code>b+1</code> ? ... in my environment succ causes an error</li>\n</ul>\n</blockquote>\n<p>succ causes an error because you have to <code>open Nat</code> or write <code>Nat.succ</code> or already be inside <code>namespace Nat</code></p>",
        "id": 475329342,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1728316007
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> i'd welcome your insights on the curly bracket issue, if you have time.</p>\n<p>I'll also try rewriting the definition using <code>Nat.</code>.</p>",
        "id": 475329772,
        "sender_full_name": "rzeta0",
        "timestamp": 1728316141
    },
    {
        "content": "<p>out of interest, if I don't import Mathlib then I assume the difference between lemma and theorem is in Lean as a language?</p>",
        "id": 475330256,
        "sender_full_name": "rzeta0",
        "timestamp": 1728316278
    },
    {
        "content": "<p>Lemma is a macro that compiles down to theorem. It's syntax sugar to separate small helper theorems from the rest. Currently  it is defined in Mathlib.</p>",
        "id": 475331408,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1728316615
    },
    {
        "content": "<p>So changing the definition to Nat. works if I then invoke the lemma with Nat.</p>\n<p>I notice H MacBeth's course doesn't use Nat. before her own version of <code>le_or_succ_le</code></p>\n<p>But I'm worried that non-official shouldn't be using Nat.  .. should Nat. be reserved for official lemmas/theorems?</p>",
        "id": 475336565,
        "sender_full_name": "rzeta0",
        "timestamp": 1728318006
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> <a href=\"#narrow/stream/113489-new-members/topic/Questions.20about.20my.20first.20lemma.3A.20.60le_or_succ_le.60/near/475336565\">said</a>:</p>\n<blockquote>\n<p>I notice H MacBeth's course doesn't use Nat. before her own version of <code>le_or_succ_le</code></p>\n</blockquote>\n<p>Can you link to this?</p>",
        "id": 475338305,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1728318453
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> <a href=\"#narrow/stream/113489-new-members/topic/Questions.20about.20my.20first.20lemma.3A.20.60le_or_succ_le.60/near/475336565\">said</a>:</p>\n<blockquote>\n<p>I notice H MacBeth's course doesn't use Nat. before her own version of <code>le_or_succ_le</code></p>\n</blockquote>\n<p>My suspicion is that this is because, in the context of her course, there's no other type on which such a lemma makes sense. (In other words, <code>Nat</code> is the only type with a <code>SuccOrder</code> that appears in her course. Therefore, no namespace is required.)</p>\n<p>On the other hand, in Mathlib, there <em>is</em> a general lemma that would make sense, and so the <code>Nat</code>-specific version should be namespaced.</p>",
        "id": 475344627,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1728319797
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/113489-new-members/topic/Questions.20about.20my.20first.20lemma.3A.20.60le_or_succ_le.60/near/475338305\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> <a href=\"#narrow/stream/113489-new-members/topic/Questions.20about.20my.20first.20lemma.3A.20.60le_or_succ_le.60/near/475336565\">said</a>:</p>\n<blockquote>\n<p>I notice H MacBeth's course doesn't use Nat. before her own version of <code>le_or_succ_le</code></p>\n</blockquote>\n<p>Can you link to this?</p>\n</blockquote>\n<p>source: <a href=\"https://github.com/hrmacbeth/math2001/blob/main/Library/Theory/Comparison.lean\">https://github.com/hrmacbeth/math2001/blob/main/Library/Theory/Comparison.lean</a></p>\n<p>example code: <a href=\"https://hrmacbeth.github.io/math2001/02_Proofs_with_Structure.html#sq-ne-two\">https://hrmacbeth.github.io/math2001/02_Proofs_with_Structure.html#sq-ne-two</a></p>\n<p>copied here for convenience:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">le_or_succ_le</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\">   </span><span class=\"c1\">-- &lt; --</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hn</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ne_of_lt</span>\n<span class=\"w\">  </span><span class=\"k\">calc</span>\n<span class=\"w\">    </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rel</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hn</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">numbers</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 475363723,
        "sender_full_name": "rzeta0",
        "timestamp": 1728325691
    }
]