[
    {
        "content": "<p>Hi all, <br>\nI am new to Lean and I am trying to gauge whether it fits my purposes. <br>\nI'd like to use it to prove some results in a Bayesian inference model (i.e. showing that the expression I have obtained for a joint posterior is implied by the prior and likelihood assumptions). Do you have any suggestions on where to start? I am physicist by training with a solid background in statistics.</p>",
        "id": 449659487,
        "sender_full_name": "Riccardo Buscicchio",
        "timestamp": 1720359994
    },
    {
        "content": "<p>I don't see the letters<code>Bayes</code> anywhere in the mathlib docs, or from my 2 minutes of searching on google, so you'd probably have to write the support yourself.</p>\n<p>There is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Probability#doc\">docs#Probability</a>.</p>",
        "id": 449758561,
        "sender_full_name": "Michal Wallace (tangentstorm)",
        "timestamp": 1720407915
    },
    {
        "content": "<p>It's not clear to me yet how necessary all that MeasureTheory stuff is if all you want to do is write proofs using Bayesian inference.</p>",
        "id": 449760333,
        "sender_full_name": "Michal Wallace (tangentstorm)",
        "timestamp": 1720408536
    },
    {
        "content": "<p>If there isn't already some way to do this (I have no idea)...</p>\n<p>I wonder what would happen if you started with something like this, and just implemented all the normal Boolean operations on top of it?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Bayes</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Zero</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Conf</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">:</span><span class=\"n\">Rat</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">&gt;</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">})</span>\n</code></pre></div>\n<p><code>e : E</code> is some lean proposition representing a probabilistic event.</p>\n<p><code>Zero E</code> indicates zero confidence in the event. Therefore, you treat it as false and discard any proof.</p>\n<p><code>Conf e c</code> is true as far as Lean is concerned (because e is an instance of E, and therefore a proof of E). But then you also attach a non-zero confidence level <code>c</code> to it.</p>",
        "id": 449765633,
        "sender_full_name": "Michal Wallace (tangentstorm)",
        "timestamp": 1720410899
    },
    {
        "content": "<p>Well... here's a mockup. It's weird because you have to act as if every statement was 100% true and prove it (disregarding the probabilities), but if you do that, then you can attach confidence levels to it.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Bayes</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">BZero</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">BConf</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"o\">:</span><span class=\"n\">Rat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- { r:Rat // r&gt;0 ∧ r ≤ 1 }</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">Repr</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Bayes</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">bAnd</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">bp</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Bayes</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">bq</span><span class=\"o\">:</span><span class=\"n\">Bayes</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Bayes</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">bp</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BConf</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">pc</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">BConf</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">qc</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">BConf</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">p</span><span class=\"o\">,</span><span class=\"n\">q</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">pc</span><span class=\"bp\">*</span><span class=\"n\">qc</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">BZero</span>\n\n<span class=\"c1\">-- you have to provide a demonstration that the fact is true</span>\n<span class=\"c1\">-- as if all your confidence levels were 1</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">bp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Bayes</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Prime</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BConf</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">prime_five</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Bayes</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BConf</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mf\">0.5</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">br</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Bayes</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BZero</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">bAnd</span><span class=\"w\"> </span><span class=\"n\">bp</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"w\"> </span><span class=\"c1\">-- confidence 1/2</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">bAnd</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"w\"> </span><span class=\"n\">br</span><span class=\"w\"> </span><span class=\"c1\">-- confidence zero</span>\n</code></pre></div>\n<p>Again, I have no idea if there's already some way to do this sort of thing in Lean, or even if this is a good approach. It's just what came to mind. Hope it helps.</p>",
        "id": 449770776,
        "sender_full_name": "Michal Wallace (tangentstorm)",
        "timestamp": 1720413425
    },
    {
        "content": "<p>Thinking about this a bit further, it seems like <code>Xor</code> (or \"not equals\") and its generalizations operation might require some special handling. Suppose  <code>n ∈ { 0, 1, 2, 3 }</code>, and you're trying to gather evidence that <code>n</code> has one of those specific values. You'd want to assign a confidence score to each of the 4 possibilities.</p>\n<p>But, the way I've described it above, you would have to carry around proofs that all four propositions were true at the same time, which is not possible without <code>sorry</code> or introducing contradictory axioms.</p>\n<p>But for statements like these, you could instead have a structure that carried around the actual statement <code>n ∈ { 0, 1, 2, 3 }</code> and then also had a list of probabilities / confidence levels for each possible value.</p>\n<p>I still can't tell if the MeasureTheory stuff is doing anything in this direction...</p>",
        "id": 449970615,
        "sender_full_name": "Michal Wallace (tangentstorm)",
        "timestamp": 1720469115
    }
]