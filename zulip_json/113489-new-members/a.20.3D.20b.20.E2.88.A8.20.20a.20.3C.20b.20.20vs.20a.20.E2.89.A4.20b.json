[
    {
        "content": "<p>Im a bit surprised we dont simp <code>a = b ∨  a &lt; b </code> into <code>a ≤ b</code> in <code>PartialOrder</code>.<br>\nIs there a good reason for this?</p>",
        "id": 574928747,
        "sender_full_name": "Moritz R",
        "timestamp": 1771590322
    },
    {
        "content": "<p>A link to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=le_iff_eq_or_lt#doc\">docs#le_iff_eq_or_lt</a> would help</p>",
        "id": 574929190,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1771590485
    },
    {
        "content": "<p>Yes sorry, im wondering why the reverse direction of that theorem isn't <code>@[simp]</code></p>",
        "id": 574929813,
        "sender_full_name": "Moritz R",
        "timestamp": 1771590694
    },
    {
        "content": "<p>In practice it's quite rare that you ever simplify something into <code>a &lt; b or a = b</code>. There's only 41 uses of <code>le_iff_eq_or_lt</code> in Mathlib, only like three occur in <code>simp</code> calls, and they all simplify the other way around!</p>",
        "id": 575063659,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1771653424
    },
    {
        "content": "<p>Violeta, the proposal was to use <code>@[&lt;- simp]</code> I think</p>",
        "id": 575067681,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1771658536
    },
    {
        "content": "<p>My point is that it's rare for a <code>simp</code> call to leave you with the expression <code>a &lt; b ∨ a = b</code>. So <code>← le_iff_eq_or_lt</code> not a bad <code>simp</code> lemma in principle, but in practice it rarely ever does much for you.</p>",
        "id": 575067772,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1771658659
    },
    {
        "content": "<p>This came up for me in the following. My order turns out to be equivalent to a threeway lexicographic order.<br>\nThe middle condition can typically be completely evaluated, which in some cases essentially leaves me (from the last check, which is stated first here) with <br>\n<code> (big = big' ∧ True ∧ small &lt; small')</code><br>\nwhich simps to<br>\n<code> (big = big' ∧ small &lt; small')</code></p>\n<p>Full lemma description:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- Comparing Literals is equivalent to first comparing the larger term of both atoms.</span>\n<span class=\"sd\">    If these are equal, tiebreak with polarity (neg &gt; pos).</span>\n<span class=\"sd\">    If these are equal, tiebreak with the smaller term of both atoms.</span>\n<span class=\"sd\">    If these are also equal, then the literals are equal. -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">LiteralOrder_iff_lexicographic</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">LinearOrder</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Term</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">L1</span><span class=\"w\"> </span><span class=\"n\">L2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Literal</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">small</span><span class=\"w\"> </span><span class=\"n\">big</span><span class=\"w\"> </span><span class=\"n\">small'</span><span class=\"w\"> </span><span class=\"n\">big'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Term</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hL1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">L1</span><span class=\"bp\">.</span><span class=\"n\">toPos</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">pos</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">(</span><span class=\"n\">small</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">big</span><span class=\"o\">))</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hL2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">L2</span><span class=\"bp\">.</span><span class=\"n\">toPos</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">pos</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">(</span><span class=\"n\">small'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">big'</span><span class=\"o\">))</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">small</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">big</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">small'</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">big'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">L1</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">L2</span><span class=\"w\"> </span><span class=\"bp\">↔</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">big</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">big'</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">L1</span><span class=\"bp\">.</span><span class=\"n\">isPos</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">L2</span><span class=\"bp\">.</span><span class=\"n\">isPos</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">L1</span><span class=\"bp\">.</span><span class=\"n\">isNeg</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">L2</span><span class=\"bp\">.</span><span class=\"n\">isNeg</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">small</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">small'</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">big</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">big'</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">L1</span><span class=\"bp\">.</span><span class=\"n\">isPos</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">L2</span><span class=\"bp\">.</span><span class=\"n\">isNeg</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">big</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">big'</span>\n<span class=\"w\">       </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>",
        "id": 575078087,
        "sender_full_name": "Moritz R",
        "timestamp": 1771670212
    },
    {
        "content": "<p>Probably best to just manually add the lemma to your simp call.</p>",
        "id": 575383814,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1771875686
    },
    {
        "content": "<p>Or: you can add it to a custom simp set, that you then use throughout the relevant code!</p>",
        "id": 575434788,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1771897090
    }
]