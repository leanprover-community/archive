[
    {
        "content": "<p>I'm working with a function <code>ψ : ℝ → ℝ</code> which I only really care about its values on subset <code>I : Set ℝ</code>. In the textbook I'm working from the function is simply defined as <code>ψ : I → ℝ</code>, but because I also want to work with derivatives, I was advised to define it on the entire real line, and just have meaningful values on <code>I</code>. Now I also want to work with it's inverse. I proved that <code>ψ</code> is bijective from <code>I</code> to <code>ψ '' I</code>, and I would like to use this to get that it's inverse is also bijective from  <code>ψ '' I</code> to <code>ψ</code>, but the problem is that since <code>ψ</code> is defined on the entire real line it could be that some real numbers besides the members of <code>I</code> are sent by <code>ψ</code> to <code>ψ '' I</code>. How would you deal with this?</p>",
        "id": 564996768,
        "sender_full_name": "Michael Novak",
        "timestamp": 1766407754
    },
    {
        "content": "<p>You can do things \"by hand\" and use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Set.BijOn#doc\">docs#Set.BijOn</a></p>",
        "id": 564998543,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1766408370
    },
    {
        "content": "<p>Another option is to define a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PartialEquiv#doc\">docs#PartialEquiv</a> --- which has the inverse on a set already built in.</p>",
        "id": 564998614,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1766408398
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/113489-new-members/topic/Working.20.20with.20the.20inverse.20of.20diff.20func.20defined.20on.20a.20set/near/564998543\">said</a>:</p>\n<blockquote>\n<p>You can do things \"by hand\" and use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Set.BijOn#doc\">docs#Set.BijOn</a></p>\n</blockquote>\n<p>I don't think it's possible because of the issue I mentioned, but maybe I'm missing something.</p>",
        "id": 564999155,
        "sender_full_name": "Michael Novak",
        "timestamp": 1766408584
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/113489-new-members/topic/Working.20.20with.20the.20inverse.20of.20diff.20func.20defined.20on.20a.20set/near/564998614\">said</a>:</p>\n<blockquote>\n<p>Another option is to define a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PartialEquiv#doc\">docs#PartialEquiv</a> --- which has the inverse on a set already built in.</p>\n</blockquote>\n<p>Do you think that's the preferred / conventional way to do it in Mathlib for example?</p>",
        "id": 564999338,
        "sender_full_name": "Michael Novak",
        "timestamp": 1766408652
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"952635\">Michael Novak</span> <a href=\"#narrow/channel/113489-new-members/topic/Working.20.20with.20the.20inverse.20of.20diff.20func.20defined.20on.20a.20set/near/564999155\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/113489-new-members/topic/Working.20.20with.20the.20inverse.20of.20diff.20func.20defined.20on.20a.20set/near/564998543\">said</a>:</p>\n<blockquote>\n<p>You can do things \"by hand\" and use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Set.BijOn#doc\">docs#Set.BijOn</a></p>\n</blockquote>\n<p>I don't think it's possible because of the issue I mentioned, but maybe I'm missing something.</p>\n</blockquote>\n<p>It depends on how your inverse function is defined. You want the inverse function to pick not any preimage on <code>\\Psi '' I</code>, but some preimage in <code>I</code>. Once you have this, things should be fine.</p>",
        "id": 564999900,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1766408836
    },
    {
        "content": "<p>That said, using a PartialEquiv will probably allow you to re-use work done in mathlib: my instinct is to try that.</p>",
        "id": 564999954,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1766408856
    },
    {
        "content": "<p>Another question for you: will you want to prove smoothness of the inverse function? (Then you need the inverse function theorem, and I would look at what that theorem hands you.)</p>",
        "id": 565000049,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1766408883
    },
    {
        "content": "<p>Do you think that's a good way to define it (using <code>invFunOn</code>)?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">section</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span>\n\n<span class=\"sd\">/-- Auxiliary definition, this is the reversed (inverse) parameter transformation</span>\n<span class=\"sd\">for the arclength reparametrization. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">arclengthParamTransformAux</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t₀</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">∫</span><span class=\"w\"> </span><span class=\"n\">τ</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">t₀</span><span class=\"bp\">..</span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">τ</span><span class=\"bp\">‖</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">I</span><span class=\"bp\">.</span><span class=\"n\">OrdConnected</span><span class=\"o\">]</span>\n\n<span class=\"c1\">--This is parameter transformation used to construct the arc-length reparametrization.</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">arclengthParamTransform</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t₀</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">letI</span><span class=\"w\"> </span><span class=\"n\">ψ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">arclengthParamTransformAux</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">t₀</span>\n<span class=\"w\">  </span><span class=\"n\">ψ</span><span class=\"bp\">.</span><span class=\"n\">invFunOn</span><span class=\"w\"> </span><span class=\"n\">I</span>\n\n<span class=\"c1\">--Unit speed / arclength reparametrization of a parametrized curve</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">arclengthReparamFrom</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t₀</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">letI</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">arclengthParamTransform</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">t₀</span>\n<span class=\"w\">  </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">φ</span>\n</code></pre></div>",
        "id": 565245213,
        "sender_full_name": "Michael Novak",
        "timestamp": 1766554999
    },
    {
        "content": "<p>Because I think this will give me the properties I want from this function</p>",
        "id": 565245273,
        "sender_full_name": "Michael Novak",
        "timestamp": 1766555071
    },
    {
        "content": "<p>I managed to get <code>BijOn</code> with this definition.</p>",
        "id": 565245727,
        "sender_full_name": "Michael Novak",
        "timestamp": 1766555550
    }
]