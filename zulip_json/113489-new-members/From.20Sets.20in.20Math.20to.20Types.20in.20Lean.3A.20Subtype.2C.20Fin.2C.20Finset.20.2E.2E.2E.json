[
    {
        "content": "<p>I wrote a blog post based on my experience formalizing statements from Tao's Analysis I</p>\n<p><a href=\"https://rkirov.github.io/posts/sets-vs-types/\">From Sets in Math to Types in Lean: Subtype, Fin, Set, Finset, and Fintype</a></p>\n<p>It is aimed towards Lean newcomers (like myself). Since I have no comments on the blog, I am posting it here for a possible discussion, comments, etc.</p>\n<p>Note: AI was used to generate and edit some of the blog text.</p>",
        "id": 574034415,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1771216719
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"488971\">@Rado Kirov</span> Some comments:</p>\n<ul>\n<li><code>Fin n</code> is actually technically not a subtype - I mean it is clearly equivalent to one but it isn't constructed that way!</li>\n<li>I found your writing style a little terse at points - I don't know if you used an LLM for drafting but it reads a bit like that to me, and it gives quite angular thought trains. I don't particularly enjoy this but others might.</li>\n<li>I think there's a lot more you can say about <code>Finset</code>. While it's mostly correct to use API to construct them, I think it would be useful in your exposition to understand how they are (equivalent to) a subtype of <code>Multiset</code>, and how <code>Multiset</code> is a quotient of <code>List</code>.</li>\n<li><code>S : Finset U</code> and <code>Fintype S</code> are more similar than you think - I don't think this is a good full exposition of the options. You can also use the <code>Finite</code> typeclass and the <code>FinEnum</code> typeclass - these could be good alternatives to <code>Fintype</code>. If S naturally sits in some other ambient type, we could have it as a <code>Set</code>,  and then we could use the <code>Set.Finite</code> predicate (which is, under the hood, <code>Finite ‚Ü•S</code>. I think you really do not have a clear picture here.</li>\n<li>You say at one point that is is generally better to use <code> ‚àà S</code> in sums, but in your example it's the opposite - which is it? </li>\n<li>I actually think your example is not perfect. Consider this: why do you index, in <code>E</code>, by <code>Fin n</code>? You do not use the ordering that exists on <code>Fin n</code>, after all: not in the statement, anyway. I think you only really need decidable equality on it. You could instead index by a finite type. I also do not see why S has to be a <code>Fintype</code> - indeed this feels quite unnatural to me. I would expect such an <code>f</code> to quite often be defined on the wider type S is a subset of! There's <em>no use of union</em> in your statement. This theorem is actually <code>Finset.sum_biUnion</code>, I think - go look at that!</li>\n<li>I agree with your overall conclusion but your example is partial, and I would not say personally wholly correct.</li>\n</ul>",
        "id": 574066458,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1771233761
    },
    {
        "content": "<p>Thank you for the careful reading and critique!</p>\n<p>Indeed, I used Claude code both to learn about the concepts in the post and write the post based on my rough draft and editorial direction. My personal unedited style is too rambly and rough, while Claude leans too much on writing short sentences, but cleans up my mess very quickly. Not sure which one is worse. Maybe I should experiment with leaving both versions :/</p>\n<ul>\n<li>will fix the <code>Fin n</code> in correctness. Thanks, I should have checked that one.</li>\n<li>not sure if I can add more to already quite long post about connections with <code>Multiset</code>, but something I will need to explore more myself.</li>\n<li>explicit <code>Finite</code> hypothesis as an alternative is a great suggestion will try to work it in. <code>FinEnum</code> I didn't even know it exists, need to learn more about it.</li>\n<li>the example uses <code>‚àë s, f s = ‚àë i, ‚àë s ‚àà E i, f s</code> so there is one implicit <code>s : S</code> and one explicit <code>s ‚àà E i</code>. The point is that if one naively write <code>s : E i</code> they will be in trouble. I know to an expert that is obviously a disaster, but to a newcomer it feels like an easy mistake.</li>\n<li>Indexing by <code>Fin n</code> is actually a recent change I made because I thought it matches the style of the text best. It used to be :</li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- Exercise 7.1.6 -/</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">sum_union_disjoint</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">disj</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">‚â†</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Disjoint</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">))</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">cover</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">s</span>\n</code></pre></div>\n<p>I take this version would be the one you will recommend I upstream in <a href=\"https://github.com/teorth/analysis/pull/448\">https://github.com/teorth/analysis/pull/448</a> (inspired by <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/BigOperators/Group/Finset/Basic.html#Finset.sum_biUnion\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/BigOperators/Group/Finset/Basic.html#Finset.sum_biUnion</a> with <code>‚Ñù</code> instead of M)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">sum_union_disjoint</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œπ</span><span class=\"w\"> </span><span class=\"n\">Œ∫</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œπ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">Œπ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">Œ∫</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œ∫</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">Œπ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚Üë</span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">PairwiseDisjoint</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">biUnion</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">i</span>\n</code></pre></div>\n<p>While it feels it is the most general for the purpose of mathlib, it feels the most magical and mysterious to a newcomer - one has to know <code>biUnion</code>, there is an coersion <code>(‚Üës)</code> that I don't understand why at glance, and t is defined over all <code>k</code> not just <code>s</code>, so I am not sure I would say that would be the best translation for the purposes of the textbook companion.</p>",
        "id": 574086808,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1771240709
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"488971\">Rado Kirov</span> <a href=\"#narrow/channel/113489-new-members/topic/From.20Sets.20in.20Math.20to.20Types.20in.20Lean.3A.20Subtype.2C.20Fin.2C.20Finset.20.2E.2E.2E/near/574086808\">said</a>:</p>\n<blockquote>\n<p>Indeed, I used Claude code both to learn about the concepts in the post and write the post based on my rough draft and editorial direction.</p>\n</blockquote>\n<p>Can I please ask that in the future if you post a link to AI output that you indicate it in the post? IIUC you asked for human feedback, which means you're asking for humans to read LLM output without indicating it as such.<br>\n(also I'm not sure posting AI blog posts is allowed here, but idk)</p>",
        "id": 574096797,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1771244456
    },
    {
        "content": "<p>Sure, I added a disclosure - \"AI was used to generate and edit some of the blog text.\"</p>\n<p>Judging by your comment (and the AI slop threads) it seems that there is a lot of binary thinking - one either rejects AI fully or adopts it blindly and generates slop. You labelled the whole thing  \"AI blog post\" and wonder if it should even be posted, while I believe it should be seen as the result of \"AI-human\" collaboration. There is a lot of subtlety between the extremes and some true productivity gains will be lost if all AI collaborations are rejected outright.</p>\n<p>I hope you can tell from the post and the discussion I am having above that this post is based on my personal journey of working with Lean, based on my personal struggles on how to formalize a simple math statement and finding multiple correct and incorrect versions. Using AI to teach me the differences and deciding myself which one I believe is best to contribute upstream. I decided that other might benefit from reading about these basic Lean types. I have read every word and it is was written based on my direction.</p>\n<p>It is objectively much faster for me to say \"tighten my prose\", \"move this example\", \"add a section about subtypes in the context of sets\", and get reasonable results. Nothing is fully free and I realize that the cost is producing slightly mechanical voice and \"angular thought trains\" as <span class=\"user-mention\" data-user-id=\"330967\">@Wrenna Robson</span> said, but I cherish the fact that I could get this whole post out in one quick hour, while I get to do enjoy the rest of my vacation with my family. It saved me probably extra 2-3 hours of laborious editing.</p>\n<p>No AI was used in writing the above. Arguing with people on the internet, the last remnant of a purely human activity ;)</p>",
        "id": 574184009,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1771276234
    },
    {
        "content": "<p>And just to add - I empathize  with  the readers frustration with feeling deceived into reading something that was the product of a simple prompt \"write me a blog post on sets vs types\" and plopping the output here without any editing or further directions. But my post is not that.</p>",
        "id": 574184356,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1771276429
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"488971\">@Rado Kirov</span> for what it's worth while AI stuff does often annoy me a bit I understand your use of it here and personally find it pretty benign. I don't have time right now to read all your reply but I'm really glad my critique was useful. Have a lovely evening.</p>",
        "id": 574184499,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1771276508
    },
    {
        "content": "<p>Thank you for adding the disclosure!<br>\nI appreciate the nuances and did not 'reject your post as slop', but I believe the best policy is to put all the cards on the table upfront and let the reader judge for themselves, alleviating any possible deception as you mentioned. This matches with Mathlib's policy on PRs (<a class=\"message-link\" href=\"/#narrow/channel/287929-mathlib4/topic/policy.20proposal.3A.20mention.20AI.20use.20in.20PR.20description.3F/near/539512315\">#mathlib4 &gt; policy proposal: mention AI use in PR description? @ üí¨</a>) where a similar nuance was pointed out.</p>",
        "id": 574187665,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1771278622
    },
    {
        "content": "<blockquote>\n<p>but I believe the best policy is to put all the cards on the table upfront</p>\n</blockquote>\n<p>Agree, will do!</p>",
        "id": 574187770,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1771278698
    },
    {
        "content": "<blockquote>\n<p>It is objectively much faster for me to say \"tighten my prose\", \"move this example\", \"add a section about subtypes in the context of sets\", and get reasonable results.</p>\n</blockquote>\n<p>But people are very good at recognizing things and can't stop notice AI tampering.</p>\n<p>There's a way to workaround this: use AI only as an example generator and don't let it write the final result. Retyping the text gives you an opportunity to rephrase it.</p>",
        "id": 574351042,
        "sender_full_name": "suhr",
        "timestamp": 1771350126
    },
    {
        "content": "<p>I'm a terrible writer myself, and I found a different way to compensate this: I completely rewrite my text several times, alternating between typing and handwriting. For some reason handwriting helps me writing human-readable text, but typed text is easier to see as a whole.</p>",
        "id": 574352141,
        "sender_full_name": "suhr",
        "timestamp": 1771350487
    }
]