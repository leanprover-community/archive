[
    {
        "content": "<p>Really sorry to ask this again.</p>\n<ul>\n<li>How do I find out what the latest mathlib release is (not nightly)?</li>\n<li>What files need to change to reflect the new latest stable version? (lakefile.lean, toolchain?)</li>\n<li>Is <code>lake update</code> in an existing project sufficient now - it used to break.</li>\n</ul>\n<p>I did spend some time searching the main website to find answers to all these questions didn't find any. Perhaps it could be made more prominent or findable?</p>\n<p>And I also searche there for the \"announce / changelog\" channel and again couldn't find it.</p>\n<p>I think I'm current on <code>leanprover/lean4:v4.13.0</code> but not sure if that's Lean or Mathlib or whether they both have the same release number?</p>",
        "id": 497279332,
        "sender_full_name": "rzeta0",
        "timestamp": 1738520971
    },
    {
        "content": "<ul>\n<li><code>leanprover/lean4:v4.13.0</code> is the Lean version. The most current mathlib uses <code>leanprover/lean4:v4.16.0-rc2</code> (a release candidate for the Lean 4.16 release, which will appear in the next day or two).</li>\n<li>mathlib is often used with its latest <code>master</code> branch, but there are tags corresponding to Lean releases; <code>releases/v4.15.0</code> is the most recent of those.</li>\n<li>I <em>think</em> <code>lake update</code> works, and that it updates <code>lean-toolchain</code> correctly. If you have everything committed in Git, you can at least revert to the state before the <code>lake update</code> if it does break.</li>\n<li>Whether you need to update your lakefile depends on whether the lakefile contains a specific version of mathlib. Maybe post it here?</li>\n<li>If you don't have a new enough lake, you can copy <code>lean-toolchain</code> from mathlib to your own project to make sure they match.</li>\n</ul>\n<p>I work within mathlib itself most often, so my knowledge of updating lean/mathlib versions is a bit shaky.</p>",
        "id": 497280173,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738521627
    },
    {
        "content": "<p>Thanks Kyle.</p>\n<p>I do wish the update and version information was easier to find on the official website(s) - I still don't know where to look. The GitHub page doesn't have the usual \"released\" element that most projects do.</p>\n<p>Where would I watch to find out about the new official 4.16 release?</p>\n<p>this is my current  lakefile.lean</p>\n<ul>\n<li><a href=\"https://github.com/rzeta0/Lean-First-Steps/blob/main/lakefile.lean\">https://github.com/rzeta0/Lean-First-Steps/blob/main/lakefile.lean</a></li>\n</ul>\n<p>this my current toolchain:</p>\n<ul>\n<li><a href=\"https://github.com/rzeta0/Lean-First-Steps/blob/main/lean-toolchain\">https://github.com/rzeta0/Lean-First-Steps/blob/main/lean-toolchain</a></li>\n</ul>",
        "id": 497280530,
        "sender_full_name": "rzeta0",
        "timestamp": 1738521943
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> <a href=\"#narrow/channel/113489-new-members/topic/updating.20.28again!.29/near/497280530\">said</a>:</p>\n<blockquote>\n<p>Where would I watch to find out about the new official 4.16 release?</p>\n</blockquote>\n<p>They are announced in the announce channel.</p>\n<p><a href=\"#narrow/channel/113486-announce/topic/ASCII.20plot.20library\"><a class=\"stream-topic\" data-stream-id=\"113486\" href=\"/#narrow/channel/113486-announce/topic/v4.2E16.2E0-rc2\">#announce &gt; v4.16.0-rc2</a></a></p>\n<hr>\n<p>You can pin channels, I have that one pinned.</p>",
        "id": 497281047,
        "sender_full_name": "Eric Taucher",
        "timestamp": 1738522327
    },
    {
        "content": "<p>Ok, if you change <a href=\"https://github.com/rzeta0/Lean-First-Steps/blob/main/lakefile.lean#L12\">https://github.com/rzeta0/Lean-First-Steps/blob/main/lakefile.lean#L12</a> to</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"s2\">\"https://github.com/leanprover-community/mathlib4.git\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"s2\">\"v4.15.0\"</span>\n</code></pre></div>\n<p>(or maybe with <code>\"releases/v4.15.0\"</code>?) then <code>lake update</code> should work.</p>\n<p>You should verify after <code>lake update</code> that <code>lean-toolchain</code> shows <code>leanprover/lean4:v4.15.0</code> after this.</p>\n<p>Also, don't forget to <code>lake exe cache get</code> after all this so that you don't end up spending time building mathlib from scratch.</p>",
        "id": 497281522,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738522718
    },
    {
        "content": "<p>Which website(s) do you mean when you're saying the main/official one -- both Lean and Mathib have release tags in GitHub (so in theory you also can watch the Lean 4 repo for releases if you'd like.)</p>",
        "id": 497281535,
        "sender_full_name": "Julian Berman",
        "timestamp": 1738522735
    },
    {
        "content": "<p>Hi Julian - the mathlib url <a href=\"https://github.com/leanprover-community/mathlib4/releases\">https://github.com/leanprover-community/mathlib4/releases</a>  is screenshotted as follows:</p>\n<p><a href=\"/user_uploads/3121/ahiMqSgH09i7E6CXRosQnE55/Screenshot-2025-02-02-at-19.09.41.png\">Screenshot 2025-02-02 at 19.09.41.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/ahiMqSgH09i7E6CXRosQnE55/Screenshot-2025-02-02-at-19.09.41.png\" title=\"Screenshot 2025-02-02 at 19.09.41.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"2275x1040\" src=\"/user_uploads/thumbnail/3121/ahiMqSgH09i7E6CXRosQnE55/Screenshot-2025-02-02-at-19.09.41.png/840x560.webp\"></a></div><p>I can now see mathlib does have into there: <a href=\"https://github.com/leanprover/lean4/releases\">https://github.com/leanprover/lean4/releases</a></p>",
        "id": 497282434,
        "sender_full_name": "rzeta0",
        "timestamp": 1738523441
    },
    {
        "content": "<p>Click the tags tab, as Mathlib uses normal (non-annotated) release tags.</p>",
        "id": 497282463,
        "sender_full_name": "Julian Berman",
        "timestamp": 1738523470
    },
    {
        "content": "<p>(The way to notice this is that you'll see plenty of releases on the project page: <br>\n<a href=\"/user_uploads/3121/_itSdpDdnz_Odzt--3ftzTbX/Screenshot-2025-02-02-at-14.11.30.png\">Screenshot 2025-02-02 at 14.11.30.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/_itSdpDdnz_Odzt--3ftzTbX/Screenshot-2025-02-02-at-14.11.30.png\" title=\"Screenshot 2025-02-02 at 14.11.30.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"358x138\" src=\"/user_uploads/thumbnail/3121/_itSdpDdnz_Odzt--3ftzTbX/Screenshot-2025-02-02-at-14.11.30.png/840x560.webp\"></a></div>",
        "id": 497282489,
        "sender_full_name": "Julian Berman",
        "timestamp": 1738523512
    },
    {
        "content": "<p>Thanks - so is mathlib a \"nightly\" only rolling release whereas lean4 has discrete stable releases?</p>",
        "id": 497282564,
        "sender_full_name": "rzeta0",
        "timestamp": 1738523548
    },
    {
        "content": "<p>No it's just Mathlib has so many nighty releases between each release that they get moved off the first page</p>",
        "id": 497282582,
        "sender_full_name": "Julian Berman",
        "timestamp": 1738523568
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/tags?after=nightly-testing-2025-01-24\">https://github.com/leanprover-community/mathlib4/tags?after=nightly-testing-2025-01-24</a></p>",
        "id": 497282592,
        "sender_full_name": "Julian Berman",
        "timestamp": 1738523580
    },
    {
        "content": "<p>Aat the bottom there is a tag for <code>4.16.0-rc2</code></p>",
        "id": 497282616,
        "sender_full_name": "Julian Berman",
        "timestamp": 1738523598
    },
    {
        "content": "<p>(And then all the tags after that are nightly tags)</p>",
        "id": 497282622,
        "sender_full_name": "Julian Berman",
        "timestamp": 1738523608
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321696\">Julian Berman</span> <a href=\"#narrow/channel/113489-new-members/topic/updating.20.28again!.29/near/497281535\">said</a>:</p>\n<blockquote>\n<p>Which website(s) do you mean when you're saying the main/official one -- both Lean and Mathib have release tags in GitHub (so in theory you also can watch the Lean 4 repo for releases if you'd like.)</p>\n</blockquote>\n<p>I think the main one <a href=\"https://lean-lang.org\">https://lean-lang.org</a> show make it clear what the latest version of lean and mathlib is, and also a link to the changeling. Just my opinion tho. Most open source projects do this.</p>",
        "id": 497282629,
        "sender_full_name": "rzeta0",
        "timestamp": 1738523622
    },
    {
        "content": "<p><code>lean-lang.org</code> is not related to Mathlib, it's the Lean language's web page.</p>",
        "id": 497282686,
        "sender_full_name": "Julian Berman",
        "timestamp": 1738523649
    },
    {
        "content": "<p>Ah, <code>nightly-testing-***</code> releases are for internal Lean development. Those correspond to nightly builds of Lean itself. I wouldn't recommend these to users.</p>",
        "id": 497282720,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738523698
    },
    {
        "content": "<p>So is this the official website? <a href=\"https://leanprover-community.github.io\">https://leanprover-community.github.io</a></p>",
        "id": 497282745,
        "sender_full_name": "rzeta0",
        "timestamp": 1738523718
    },
    {
        "content": "<p>Yes, for mathlib</p>",
        "id": 497282754,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738523731
    },
    {
        "content": "<p>(I agree <a href=\"http://lean-lang.org\">lean-lang.org</a> should say what the latest version of <em>Lean</em> is FWIW, I suspect that some further content tweaks might be in the pipeline for that sort of thing maybe)</p>",
        "id": 497282766,
        "sender_full_name": "Julian Berman",
        "timestamp": 1738523747
    },
    {
        "content": "<p>It's all so confusing and difficult - and I say that someone who has been using open source in a scientific \"day job\" setting since 1995  !</p>",
        "id": 497282827,
        "sender_full_name": "rzeta0",
        "timestamp": 1738523790
    },
    {
        "content": "<p>mathlib doesn't have nightly releases per se. There's the <code>master</code> branch, but there's no \"blessed\" version of it. People work on whichever <code>master</code> branch version they happened to download, if they're not interested in using one of the releases tied to a specific Lean version.</p>",
        "id": 497282832,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738523800
    },
    {
        "content": "<p>It's not difficult if you take whatever <code>master</code> version you happened to download, and then be ok with not thinking about it too hard :-)</p>",
        "id": 497282857,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738523832
    },
    {
        "content": "<p>I doubt most mathlib users know which Lean version they are using.</p>",
        "id": 497282883,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738523852
    },
    {
        "content": "<p><code>lake</code> and <code>elan</code> manage downloading new versions of Lean for you behind the scenes, so there's not much reason to know, except if there's some new feature you're interested in, or if you need to report a Lean bug.</p>",
        "id": 497282985,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738523945
    },
    {
        "content": "<p>(especially now that <code>lake</code> is supposed to manage your <code>lean-toolchain</code> file too, based on the <code>lean-toolchain</code> of your project's dependencies)</p>",
        "id": 497283016,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738523985
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"724904\">@rzeta0</span> what problem were you trying to solve originally essentially by looking for this info? Perhaps there's some docs missing for how to solve that original problem.</p>",
        "id": 497283104,
        "sender_full_name": "Julian Berman",
        "timestamp": 1738524035
    },
    {
        "content": "<p>This is the document you're probably looking for: <a href=\"https://leanprover-community.github.io/install/project.html#updating-mathlib-in-your-project\">https://leanprover-community.github.io/install/project.html#updating-mathlib-in-your-project</a></p>",
        "id": 497283170,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738524105
    },
    {
        "content": "<p>though it seems like it's a bit out of date</p>",
        "id": 497283242,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738524140
    },
    {
        "content": "<p>and it's not addressing <span class=\"user-mention\" data-user-id=\"724904\">@rzeta0</span>'s situation, where there's a specific mathlib version in the lakefile (the document doesn't say how to set that up in the first place)</p>",
        "id": 497283258,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738524164
    },
    {
        "content": "<p>yep - I did stumble upon that document and seeing \"curl\" made me think, this isn't correct - especially as it was suggested a few moons ago that a a simple \"update version number and run lake update\" would be the cycle - although I see in the 4.16-rc channel that is still not reliable enough yet.</p>",
        "id": 497283526,
        "sender_full_name": "rzeta0",
        "timestamp": 1738524387
    },
    {
        "content": "<p>and asking what problem I was trying to solve is the right approach.</p>\n<p>the problem is the same on that many others will have: \"how to update an existing project using only official released / blessed combinations of mathlib and lean\".</p>",
        "id": 497283585,
        "sender_full_name": "rzeta0",
        "timestamp": 1738524461
    },
    {
        "content": "<p>My answer to that question with FLT is \"just run the script in the <code>scripts</code> directory which someone else wrote for me and then fix up the proofs which have now broken\". Note that as far as I'm concerned, every commit to mathlib master is blessed, whenever I update (which is a couple of times a month) I just bump to whatever the last commit to mathlib was.</p>",
        "id": 497283892,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738524695
    },
    {
        "content": "<p>Often I update because I wrote some code and PRed it to mathlib because I want it in my repo and so I just need today's version if it got merged today</p>",
        "id": 497284026,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738524777
    },
    {
        "content": "<p>Random question - does Visual Studio Code update automatically (as I believe, but don't know)? I mean, Lean and Mathlib</p>",
        "id": 497284108,
        "sender_full_name": "Ilmārs Cīrulis",
        "timestamp": 1738524842
    },
    {
        "content": "<p>For FLT if I tried updating via VS Code in the past, it wouldn't work because the repo depended on doc-gen in a way which wasn't officially sanctioned by the FRO. We might have changed this recently but I'm yet to bump mathlib since the change because I'm working through a PR backlog currently</p>",
        "id": 497284246,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738524942
    },
    {
        "content": "<p>i don't think VSCode updates your lean toolchain and dependencies? i'd be <em>very very</em> surprised if it did.</p>",
        "id": 497284309,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1738524974
    },
    {
        "content": "<p>The lean extension does this, I believe?</p>",
        "id": 497284320,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738524995
    },
    {
        "content": "<p>not automatically, afaik</p>",
        "id": 497284337,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1738525024
    },
    {
        "content": "<p>It's just that it never worked in the past for FLT. It wouldn't surprise me if it worked now though, after we merged the change to doc-gen</p>",
        "id": 497284359,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738525042
    },
    {
        "content": "<p>\"Run the script someone wrote for my project\" obviously isn't very scalable :) sounds like at least updating that part of the docs would help maybe</p>",
        "id": 497284372,
        "sender_full_name": "Julian Berman",
        "timestamp": 1738525060
    },
    {
        "content": "<p>Oh no not automatically! You click on \"update dependencies\" or whatever</p>",
        "id": 497284378,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738525066
    },
    {
        "content": "<p>yea exactly</p>",
        "id": 497284426,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1738525084
    },
    {
        "content": "<p>Ah, thank you! :)</p>",
        "id": 497284462,
        "sender_full_name": "Ilmārs Cīrulis",
        "timestamp": 1738525119
    },
    {
        "content": "<p>I interpreted \"you can click on update dependencies in VS Code\" as an instance of \"VS Code updates your lean toolchain and dependencies\"! Sorry for the misunderstanding! Yes it's definitely a manual process!</p>",
        "id": 497284499,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738525155
    },
    {
        "content": "<p>Aah I now see the word \"automatically\" in Ilmārs' post :-)</p>",
        "id": 497284624,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738525239
    },
    {
        "content": "<p>For those wondering what feature Kevin's talking about:</p>\n<p><a href=\"/user_uploads/3121/McjDgBReLDBYiqDDymmIFuEC/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/McjDgBReLDBYiqDDymmIFuEC/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1482x918\" src=\"/user_uploads/thumbnail/3121/McjDgBReLDBYiqDDymmIFuEC/image.png/840x560.webp\"></a></div>",
        "id": 497284644,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738525258
    },
    {
        "content": "<p>yea, it's precisely because of that that i reacted like that. updating it automatically would likely be an <em>un</em>desirable feature</p>",
        "id": 497284671,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1738525285
    },
    {
        "content": "<p>(yeah sorry, not at a computer so lower quality posts :-) )</p>",
        "id": 497284680,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738525294
    },
    {
        "content": "<p>This doesn't help with rzeta0's case though, since the lakefile in the project is pinned to a specific mathlib version.</p>",
        "id": 497284688,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738525299
    },
    {
        "content": "<p>I only had it pinned to a specific version number as that is what I found it had months ago when I first started with lean+mathlib. I can't remember exactly how I got the setup working. It may be what the Lean VSC extension did by itself.</p>\n<p>If today's best practice is to use some form of alias to \"latest stable\" in the config files and not a specific number then do tell me how to update the files and I'll go with that. The links to the toolchain and lakefile I use are above in this thread.</p>\n<p>Since the repo I'm building is educational examples, there is some assurance in saying \"it works with the pinned version\" but I think I trust the project to always work going forward.</p>",
        "id": 497284857,
        "sender_full_name": "rzeta0",
        "timestamp": 1738525421
    },
    {
        "content": "<p>What's the current state of this thread? Do you need any help updating anymore? Did my suggestion to update the lakefile work?</p>",
        "id": 497285406,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738525840
    },
    {
        "content": "<p>I see the question \"how should I get to the newest stable in the future\" here, but I wanted to make sure your initial questions are answered.</p>",
        "id": 497285507,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738525926
    },
    {
        "content": "<p>I'll wait for the 4.16 release and try an update.</p>\n<p>(unless there is some syntax that keeps it updated to the latest released without specifying numbers)</p>",
        "id": 497289898,
        "sender_full_name": "rzeta0",
        "timestamp": 1738529558
    },
    {
        "content": "<p>I actually went ahead once I found this blog which seems to set out what files are what and what commands to run and why.</p>\n<p><a href=\"https://malv.in/posts/2024-12-09-howto-update-lean-dependencies.html\">https://malv.in/posts/2024-12-09-howto-update-lean-dependencies.html</a></p>\n<p>I updated the lean-toolchain to v.4.15.0 and the lakefile.lean to point to the 4.15.0 mathlib4 dependency.</p>\n<p>I manually deleted the manifest file and also the <code>.lake</code> directory.</p>\n<p>After a while it said it was done. However I did an <code>elan show</code> and I was surprised to find 3 toolchains - even after I had deleted the <code>.lake</code> above:</p>\n<div class=\"codehilite\" data-code-language=\"test\"><pre><span></span><code>% elan show\ninstalled toolchains\n--------------------\n\nleanprover/lean4:stable (default)\nleanprover/lean4:v4.13.0\nleanprover/lean4:v4.15.0\nleanprover/lean4:v4.3.0\n\nactive toolchain\n----------------\n\nleanprover/lean4:v4.15.0 (overridden by '/Users/???/Desktop/Lean-First-Steps/lean-toolchain')\nLean (version 4.15.0, arm64-apple-darwin23.6.0, commit 11651562caae, Release)\n</code></pre></div>\n<p>How do I remove the v4.3.0 and v.14.0 toolchains? Is this why my folder is 3Gb in size!?</p>",
        "id": 497303533,
        "sender_full_name": "rzeta0",
        "timestamp": 1738539962
    },
    {
        "content": "<blockquote>\n<p>How do I remove the v4.3.0 and v.14.0 toolchains?</p>\n</blockquote>\n<p><code>elan toolchain uninstall leanprover/lean4:v4.13.0</code> if you must, though newer elan will now remove them automatically if you don't use them for awhile.</p>\n<blockquote>\n<p>Is this why my folder is 3Gb in size!?</p>\n</blockquote>\n<p>No, the toolchain is tiny, it's Mathlib that's large.</p>",
        "id": 497303935,
        "sender_full_name": "Julian Berman",
        "timestamp": 1738540283
    },
    {
        "content": "<p>I have a dir <code>~/.elan/toolchains</code> that I think is where the \"past\" toolchains are stored.</p>",
        "id": 497303937,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1738540286
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> has marked this topic as resolved.</p>",
        "id": 497306380,
        "sender_full_name": "Notification Bot",
        "timestamp": 1738541894
    },
    {
        "content": "<p>Don't be sorry for asking. It certainly is confusing because there's so many things to watch out for at the same time. For updating a project depending on mathlib, I usually follow the steps laid out <a href=\"https://leanprover-community.github.io/install/project.html#updating-mathlib-in-your-project\">here</a>. That is, I first get the lean toolchain file from the current mathlib master branch, and then I hit <code>lake update</code>, that's it; so far that has worked for me.</p>",
        "id": 497324275,
        "sender_full_name": "Paul Schwahn",
        "timestamp": 1738555282
    }
]