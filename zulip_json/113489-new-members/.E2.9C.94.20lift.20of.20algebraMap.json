[
    {
        "content": "<p>Hi! I found something interesting. I set <code>open scoped algebraMap</code> , there exist an algebra map B to L, so lean should automatically lift my element in B to L, and it works well everywhere in my proof other than this statement:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"n\">Padic</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">algebraMap</span>\n\n<span class=\"kn\">variable</span>\n<span class=\"w\">    </span><span class=\"c1\">-- let K be a number field with ring of integers A</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsDedekindDomain</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NumberField</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">IsFractionRing</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">IsIntegralClosure</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"c1\">-- let L be an algebraic closure of K</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsScalarTower</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">IsAlgClosure</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"c1\">-- and let B be the integral closure of A in L</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsScalarTower</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">IsIntegralClosure</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"c1\">-- Let G be the Galois group of L/K</span>\n<span class=\"w\">    </span><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">MulSemiringAction</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">SMulCommClass</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">IsInvariant</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">MulSemiringAction</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">SMulCommClass</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">IsInvariant</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">IsScalarTower</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"c1\">-- Let F be an element of G</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"c1\">-- Let I be a maximal ideal of B</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hI</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"bp\">.</span><span class=\"n\">IsMaximal</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"c1\">-- assume F is a Frobenius element at I</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hF</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsArithFrobAt</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"c1\">-- Then for a prime ell not in I...</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Prime</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">)](</span><span class=\"n\">hlp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">∉</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"o\">)</span>\n\n\n\n\n<span class=\"c1\">-- the value of the cyclotomic character at Frob_I is #A/PA where P = I ∩ A</span>\n<span class=\"n\">include</span><span class=\"w\"> </span><span class=\"n\">hI</span><span class=\"w\"> </span><span class=\"n\">hF</span><span class=\"w\"> </span><span class=\"n\">hlp</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">cyclo_thing</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">((</span><span class=\"n\">cyclotomicCharacter</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MulSemiringAction</span><span class=\"bp\">.</span><span class=\"n\">toRingEquiv</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ_</span><span class=\"o\">[</span><span class=\"n\">l</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">      </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">⧸</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"bp\">.</span><span class=\"n\">under</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">⧸</span><span class=\"w\"> </span><span class=\"n\">under</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"o\">))</span>\n<span class=\"w\">      </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MulSemiringAction</span><span class=\"bp\">.</span><span class=\"n\">toRingEquiv</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">)</span>\n\n\n<span class=\"w\">      </span><span class=\"c1\">--∀i:ℕ , ↑(l^i) ∉ I</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">primeI</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"bp\">.</span><span class=\"n\">IsPrime</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hI</span><span class=\"bp\">.</span><span class=\"n\">isPrime</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"n\">i</span><span class=\"o\">:</span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"bp\">^</span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∉</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">        </span><span class=\"n\">by_contra</span><span class=\"w\"> </span><span class=\"n\">hi</span>\n<span class=\"w\">        </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hi</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">mem_radical_iff</span><span class=\"o\">,</span><span class=\"n\">IsPrime</span><span class=\"bp\">.</span><span class=\"n\">radical</span><span class=\"w\"> </span><span class=\"n\">primeI</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hi</span>\n<span class=\"w\">        </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hlp</span><span class=\"w\"> </span><span class=\"n\">hi</span>\n\n<span class=\"w\">      </span><span class=\"c1\">--B in an integral domain, should be tautology</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">DomainB</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsDomain</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">        </span><span class=\"gr\">sorry</span>\n\n<span class=\"w\">      </span><span class=\"c1\">--reduce modular l^i</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">PadicInt</span><span class=\"bp\">.</span><span class=\"n\">ext_of_toZModPow</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span>\n<span class=\"w\">      </span><span class=\"n\">specialize</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"n\">i</span>\n\n<span class=\"w\">      </span><span class=\"c1\">--have enough roots in B</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">ineed</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">HasEnoughRootsOfUnity</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">):=</span><span class=\"gr\">sorry</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">ext_root</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">ζ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">,</span><span class=\"n\">IsPrimitiveRoot</span><span class=\"w\"> </span><span class=\"n\">ζ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">):=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">        </span><span class=\"gr\">sorry</span>\n<span class=\"w\">      </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">ζ</span><span class=\"o\">,</span><span class=\"n\">hζ</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ext_root</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hζ'</span><span class=\"o\">:((</span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">ζ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"bp\">^</span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">=</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n\n\n\n\n<span class=\"w\">      </span><span class=\"c1\">--real proof starts here</span>\n\n\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">ccspec</span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">cyclotomicCharacter</span><span class=\"bp\">.</span><span class=\"n\">spec</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"n\">ζ</span><span class=\"w\"> </span><span class=\"n\">hζ'</span>\n\n\n\n\n\n\n\n\n\n\n\n\n<span class=\"w\">      </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 525993450,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750981577
    },
    {
        "content": "<p>If I write :</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hζ'</span><span class=\"o\">:((</span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">ζ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"bp\">^</span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">=</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>It works.<br>\nBut if I write </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hζ'</span><span class=\"o\">:(</span><span class=\"bp\">↑</span><span class=\"n\">ζ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"bp\">^</span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">=</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>It gives me a type mismatch.</p>",
        "id": 525993538,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750981663
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"879979\">@Chengyan Hu</span> your code does not run by itself because you forgot the theorem statement so <code>obtain</code> does nothing</p>",
        "id": 525993565,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750981692
    },
    {
        "content": "<p>oh sorry, I 'll edit it</p>",
        "id": 525993583,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750981717
    },
    {
        "content": "<p>now you've cut off the assumptions at the beginning so it still does not run by itself</p>",
        "id": 525993915,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750981974
    },
    {
        "content": "<p>Yeah I think now it should work</p>",
        "id": 525993982,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750982045
    },
    {
        "content": "<p>Sorry for the really long setting to make it run</p>",
        "id": 525993996,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750982059
    },
    {
        "content": "<p>What I wanna ask it just the last two sentence</p>",
        "id": 525994009,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750982073
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"879979\">Chengyan Hu</span> <a href=\"#narrow/channel/113489-new-members/topic/lift.20of.20algebraMap/near/525993450\">said</a>:</p>\n<blockquote>\n<p>there exist an algebra map B to L, so lean should automatically lift my element in B to L, and it works well everywhere in my proof</p>\n</blockquote>\n<p>I don't think this is true. Where else did you do it successfully?</p>",
        "id": 525994173,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750982266
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">good_Andrew</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"n\">ζ</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"o\">(</span><span class=\"n\">ζ</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">⧸</span><span class=\"w\"> </span><span class=\"n\">under</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">):=</span><span class=\"k\">by</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">Andrew_Theorem</span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">AlgHom</span><span class=\"bp\">.</span><span class=\"n\">IsArithFrobAt</span><span class=\"bp\">.</span><span class=\"n\">apply_of_pow_eq_one</span><span class=\"w\"> </span><span class=\"n\">hF</span><span class=\"w\"> </span><span class=\"n\">hζ</span><span class=\"bp\">.</span><span class=\"n\">pow_eq_one</span><span class=\"w\"> </span><span class=\"n\">H</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">tauto</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"o\">(</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">ζ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"n\">ζ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">algebraMap</span><span class=\"bp\">.</span><span class=\"n\">coe_smul</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">ζ</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"n\">tauto</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"n\">Andrew_Theorem</span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 525994203,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750982296
    },
    {
        "content": "<p>It works well here</p>",
        "id": 525994211,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750982309
    },
    {
        "content": "<p>oh wait, it does actually work, wow i didn't know this</p>",
        "id": 525994213,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750982311
    },
    {
        "content": "<p>the fix is:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">   </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hζ'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ζ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 525994230,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750982325
    },
    {
        "content": "<p>it's because when you just write the uparrow, Lean has nothing to infer that you meant to cast it to L</p>",
        "id": 525994249,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750982340
    },
    {
        "content": "<p>Oh this is a good news</p>",
        "id": 525994255,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750982344
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/_rGebTtIUOunfYqmWERWj_zo/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/_rGebTtIUOunfYqmWERWj_zo/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"225x128\" src=\"/user_uploads/thumbnail/3121/_rGebTtIUOunfYqmWERWj_zo/image.png/840x560.webp\"></a></div>",
        "id": 525994275,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750982363
    },
    {
        "content": "<p>Ah i see, but why it do work sometime?</p>",
        "id": 525994280,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750982370
    },
    {
        "content": "<p>if you use the infoview to your advantage, you can see that if you type the wrong statement, zeta still has type B</p>",
        "id": 525994301,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750982384
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"879979\">Chengyan Hu</span> <a href=\"#narrow/channel/113489-new-members/topic/lift.20of.20algebraMap/near/525994280\">said</a>:</p>\n<blockquote>\n<p>Ah i see, but why it do work sometime?</p>\n</blockquote>\n<p>because Lean has other ways to tell which type you want to coerce it to</p>",
        "id": 525994347,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750982407
    },
    {
        "content": "<p>btw generally the uparrow by itself does nothing when you type it, it's only there in the pretty printer (i.e. the infoview you see) to show you that it has been coerced</p>",
        "id": 525994381,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750982429
    },
    {
        "content": "<p>when you actually type code, coercion is automatic</p>",
        "id": 525994399,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750982436
    },
    {
        "content": "<p>More specifically, when you type <code>g ζ</code>, Lean sees <code>g</code> has type <code>L ≃+* L</code>, so Lean infers that the input has to be of type <code>L</code>, but <code>ζ</code> has type <code>B</code>, so Lean does the coercion automatically</p>",
        "id": 525994555,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750982519
    },
    {
        "content": "<p>Interesting. I feel kind of afraid to type things directly, as I stucked quit long today morning to make lean understand I want to do <code>algebraMap B L</code>, it doesn't work until I <code>open scoped algebraMap</code></p>",
        "id": 525994735,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750982632
    },
    {
        "content": "<p>aha, that's another new fact for me. the reason is that <a href=\"https://github.com/leanprover-community/mathlib4/blob/82b6d2467bbc5e42e612f664c39286ffad398515/Mathlib/Algebra/Algebra/Defs.lean#L113-L115\">the coercion is tagged with <code>scoped</code></a>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">coeHTCT</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommSemiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Semiring</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">CoeHTCT</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">cast</span><span class=\"bp\">⟩</span>\n</code></pre></div>",
        "id": 525994892,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750982753
    },
    {
        "content": "<p>the <code>scoped</code> means that you can only access it specifically with <code>open scoped algebraMap</code> indeed</p>",
        "id": 525994921,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750982774
    },
    {
        "content": "<p>I'm really not sure if I can use without up arrow here. Like when I writing that <code>good_Andrew</code>, It doesn't work that good.</p>",
        "id": 525994928,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750982778
    },
    {
        "content": "<p>for me I just keep all the <code>algebraMap</code> around, because it makes it clearer whenever you are changing types</p>",
        "id": 525994946,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750982792
    },
    {
        "content": "<p>Like <code>rw [←tauto, ←Andrew_Theorem]</code> is required although it's actually the same thing mod cast.</p>",
        "id": 525994976,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750982818
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/113489-new-members/topic/lift.20of.20algebraMap/near/525994946\">said</a>:</p>\n<blockquote>\n<p>for me I just keep all the <code>algebraMap</code> around, because it makes it clearer whenever you are changing types</p>\n</blockquote>\n<p>Ah i see.</p>",
        "id": 525995034,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750982857
    },
    {
        "content": "<p>However it really makes thing tedious i guess? As like here I'm using <code>algebraMap</code> almost everywhere.</p>",
        "id": 525995091,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750982895
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"879979\">Chengyan Hu</span> <a href=\"#narrow/channel/113489-new-members/topic/lift.20of.20algebraMap/near/525994928\">said</a>:</p>\n<blockquote>\n<p>I'm really not sure if I can use without up arrow here. Like when I writing that <code>good_Andrew</code>, It doesn't work that good.</p>\n</blockquote>\n<p>Right, I can see that in this case it's because <code>↑(ζ ^ Nat.card (A ⧸ under A I))</code> gives you that thing itself, but <code>(ζ ^ Nat.card (A ⧸ under A I))</code> gives you  <code>↑ζ ^ Nat.card (A ⧸ under A I)</code>, which I would argue is actually the better form.</p>\n<p>But what I'm advocating here is that instead of writing the up-arrow, you should just use type ascriptions (sparingly, not everywhere), so in this case if you want to delay coercion, I would instead write:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">good_Andrew</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">ζ</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ζ</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">⧸</span><span class=\"w\"> </span><span class=\"n\">under</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">Andrew_Theorem</span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">AlgHom</span><span class=\"bp\">.</span><span class=\"n\">IsArithFrobAt</span><span class=\"bp\">.</span><span class=\"n\">apply_of_pow_eq_one</span><span class=\"w\"> </span><span class=\"n\">hF</span><span class=\"w\"> </span><span class=\"n\">hζ</span><span class=\"bp\">.</span><span class=\"n\">pow_eq_one</span><span class=\"w\"> </span><span class=\"n\">H</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">tauto</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">ζ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">ζ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">algebraMap</span><span class=\"bp\">.</span><span class=\"n\">coe_smul</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">ζ</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"n\">tauto</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"n\">Andrew_Theorem</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>(btw we just use 2 spaces for tabs, not 6)</p>",
        "id": 525995187,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750983005
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"879979\">Chengyan Hu</span> <a href=\"#narrow/channel/113489-new-members/topic/lift.20of.20algebraMap/near/525995091\">said</a>:</p>\n<blockquote>\n<p>However it really makes thing tedious i guess? As like here I'm using <code>algebraMap</code> almost everywhere.</p>\n</blockquote>\n<p>I guess it's a preference thing; but I would prefer if you keep <code>algebraMap</code> at least in the statements.</p>",
        "id": 525995228,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750983051
    },
    {
        "content": "<p>Six spaces is a lot</p>",
        "id": 525995255,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750983070
    },
    {
        "content": "<p>thanks! Get it</p>",
        "id": 525995434,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750983215
    },
    {
        "content": "<p>Sorry! 1 more question: How can I change back an element in L to an element in B?</p>",
        "id": 525996120,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750983683
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"879979\">Chengyan Hu</span> <a href=\"#narrow/channel/113489-new-members/topic/lift.20of.20algebraMap/near/525996120\">said</a>:</p>\n<blockquote>\n<p>Sorry! 1 more question: How can I change back an element in L to an element in B?</p>\n</blockquote>\n<p>well you can't always do that!</p>",
        "id": 525996160,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750983722
    },
    {
        "content": "<p>think about what that means in maths</p>",
        "id": 525996167,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750983727
    },
    {
        "content": "<p>Like here, for  hypothesis <code>ccspec</code> we have<code> g ↑ζ = ↑ζ ^ ((PadicInt.toZModPow i) ↑((cyclotomicCharacter L l) g)).val</code></p>",
        "id": 525996169,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750983731
    },
    {
        "content": "<p>What if I want <code> g (ζ:B) = ζ ^ ((PadicInt.toZModPow i) ↑((cyclotomicCharacter L l) g)).val</code></p>",
        "id": 525996191,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750983754
    },
    {
        "content": "<p>if you type it out you'll find that Lean thinks they're the same statement <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 525996233,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750983797
    },
    {
        "content": "<p>I think this is a symptom of thinking in set theory rather than type theory</p>",
        "id": 525996405,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750983986
    },
    {
        "content": "<p>In set theory you're used to Z being a subset of C</p>",
        "id": 525996414,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750983996
    },
    {
        "content": "<p>so the complex number exp(2iπ/3) + exp(4iπ/3) is \"obviously\" an integer</p>",
        "id": 525996443,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750984024
    },
    {
        "content": "<p>but in type theory, Z and C are completely different things</p>",
        "id": 525996475,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750984049
    },
    {
        "content": "<p>the function Z -&gt; C is called coercion and looks like an up arrow because it means \"there's one canonical way that you can make an element of Z into an element of C\"</p>",
        "id": 525996499,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750984072
    },
    {
        "content": "<p>but you still shouldn't think of them as subsets</p>",
        "id": 525996503,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750984078
    },
    {
        "content": "<p>I felt kind of surprised that when I type <code>have check: g ↑ζ = ↑ζ ^ ((PadicInt.toZModPow i) ↑((cyclotomicCharacter L l) g)).val:=sorry</code> i got an error message</p>",
        "id": 525996798,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750984378
    },
    {
        "content": "<p>It shouldn't act like that as it's just the statement of my hypothesis and it do work somewhere else</p>",
        "id": 525996849,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750984425
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/113489-new-members/topic/lift.20of.20algebraMap/near/525996443\">said</a>:</p>\n<blockquote>\n<p>so the complex number exp(2iπ/3) + exp(4iπ/3) is \"obviously\" an integer</p>\n</blockquote>\n<p>Ahh i see, this makes things clear</p>",
        "id": 525996988,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750984567
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"879979\">Chengyan Hu</span> <a href=\"#narrow/channel/113489-new-members/topic/lift.20of.20algebraMap/near/525996798\">said</a>:</p>\n<blockquote>\n<p>I felt kind of surprised that when I type <code>have check: g ↑ζ = ↑ζ ^ ((PadicInt.toZModPow i) ↑((cyclotomicCharacter L l) g)).val:=sorry</code> i got an error message</p>\n</blockquote>\n<p>It's helpful to look at the error message even if you don't understand it, because it usually contains exactly what went wrong. In this case, the error message reads:</p>\n<p><a href=\"/user_uploads/3121/o0BbPiaLX4RjxSV9LydOawkZ/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/o0BbPiaLX4RjxSV9LydOawkZ/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"460x233\" src=\"/user_uploads/thumbnail/3121/o0BbPiaLX4RjxSV9LydOawkZ/image.png/840x560.webp\"></a></div><p>Yes it's a bit weird that Lean didn't know how to guess the <code>l</code> to make <code>ℤ_[l]ˣ</code> coerce to <code>ℤ_[l]</code>, I don't exactly know why, but I did fix it by just ascribing the type manually:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">check</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">ζ</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">ζ</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">PadicInt</span><span class=\"bp\">.</span><span class=\"n\">toZModPow</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">cyclotomicCharacter</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ_</span><span class=\"o\">[</span><span class=\"n\">l</span><span class=\"o\">]))</span><span class=\"bp\">.</span><span class=\"n\">val</span>\n</code></pre></div>\n<p>Things like this is again why I advocate type ascription <code>(term : type_you_want)</code> rather than putting an uparrow anywhere</p>",
        "id": 525997140,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750984703
    },
    {
        "content": "<p>Fantastic! I think I finally realize all the thing here.</p>",
        "id": 525997214,
        "sender_full_name": "Chengyan Hu",
        "timestamp": 1750984788
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/stream/113489-new-members/topic/lift.20of.20algebraMap/near/525994381\">said</a>:</p>\n<blockquote>\n<p>btw generally the uparrow by itself does nothing when you type it, it's only there in the pretty printer (i.e. the infoview you see) to show you that it has been coerced</p>\n</blockquote>\n<p>That's incorrect. It tells Lean that a coercion should be inserted in a given position. This is important in arithmetic expressions where coercions by default get inserted as deep as possible</p>",
        "id": 526022212,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1751007063
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"879979\">Chengyan Hu</span> has marked this topic as resolved.</p>",
        "id": 526235398,
        "sender_full_name": "Notification Bot",
        "timestamp": 1751155744
    }
]