[
    {
        "content": "<p>I think I read somewhere that Lean uses the proof of a lemma when applying it.</p>\n<p>That is, the statement of variables and conclusion (proposition) on the first line of a lemma definition are not sufficient. </p>\n<p>I would therefore expect the following code to produce an error - but it reports no errors. It seems the <code>example</code> successful uses the lemma <code>Nat.le_or_succ_le</code> even though it has no proof!</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">le_or_succ_le</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">--rw [Nat.succ_le]</span>\n<span class=\"w\">  </span><span class=\"c1\">--exact le_or_lt a b</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">le_or_succ_le</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n</code></pre></div>\n<p><strong>I'd be grateful for a clarification.</strong> </p>\n<p>Even if <code>sorry</code> suppresses errors, how would the internal compilation work if the lemma actually has no proof?</p>",
        "id": 481797581,
        "sender_full_name": "rzeta0",
        "timestamp": 1731354399
    },
    {
        "content": "<p>No, applying theorems and lemmas never will look at the proofs.</p>",
        "id": 481797682,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731354447
    },
    {
        "content": "<p>The type of the theorem/proof (that is, the statement of variables and the conclusion, what you see when you hover over <code>Nat.le_or_succ_le</code> or when you do <code>#check Nat.le_or_succ_le</code>) is all that is considered.</p>",
        "id": 481797903,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731354529
    },
    {
        "content": "<p>Another experiment you can do is use <code>axiom</code> instead of <code>lemma</code>.</p>",
        "id": 481797978,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731354560
    },
    {
        "content": "<p>In contrast, sometimes processes in Lean will unfold a <em>definition</em> when type checking.</p>",
        "id": 481798163,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731354623
    },
    {
        "content": "<p>(I think that the main place that happens is when a definition appears in the type of something.)</p>",
        "id": 481798371,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731354717
    },
    {
        "content": "<p>I'm surprised !</p>\n<p>So for very large complex multi-part proofs, how does Lean ensure that one part of the proof didn't use an unproven lemma?</p>\n<p>Is there a switch or option which tells lean to throw up an error if it finds an unjustified lemma?</p>",
        "id": 481799861,
        "sender_full_name": "rzeta0",
        "timestamp": 1731355313
    },
    {
        "content": "<p>I think the answer is that <code>sorry</code> is not an unfinished proof, it's invoking the \"sorry axiom\" <code>sorryAx</code>. This axiom lets you prove anything. It's by convention that we treat this as an unfinished proof.</p>\n<p>Also, <code>sorry</code> logs a warning, so you can't miss that it was used. You can see if a theorem depends on a theorem making use of <code>sorry</code> by using <code>#print axioms theTheoremYouCareAbout</code></p>",
        "id": 481801555,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731356033
    },
    {
        "content": "<p>Just to be clear here -- the proofs using other sorried results <em>compile</em>, but the <code>sorry</code> is viral in the sense that <code>print axioms</code> will always remember any sorry used anywhere along the way.</p>",
        "id": 481805821,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1731357776
    }
]