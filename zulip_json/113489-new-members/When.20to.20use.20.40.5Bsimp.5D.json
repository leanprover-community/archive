[
    {
        "content": "<p>I've read the <a href=\"https://leanprover-community.github.io/extras/simp.html\">simp page</a> on the lean community site, but I still had a few questions about when a lemma should carry @[simp]. One simple example is <code>neg_inj</code>: in Mathlib, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=neg_inj#doc\">docs#neg_inj</a> is a simp lemma, so for example:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n</code></pre></div>\n<p>leaves you with the final goal \"a = b\", but lean's internal <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Int.neg_inj#doc\">docs#Int.neg_inj</a> is not marked <code>@[simp]</code>, so removing the Mathlib import leaves the final state as \"-a = -b\". This example is kind of trivial, since perhaps it's not necessary to get rid of the negative signs for simp to close the goal if you can actually simplify <code>a</code> and <code>b</code> to the same term, but given that Int.neg_inj is in the core library I thought perhaps there was a principled reason for why they chose to not mark it <code>@[simp]</code>.</p>\n<p>I guess I often see theorems not marked <code>@[simp]</code> that are clearly simplifying the LHS, and I'm not sure if they're not marked as such for a specific reason to do with normal forms/confluence/etc. or if there is also just a factor of 'the author didn't consider the theorem general enough to mark it <code>@[simp]</code>'</p>",
        "id": 495961710,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1737893191
    }
]