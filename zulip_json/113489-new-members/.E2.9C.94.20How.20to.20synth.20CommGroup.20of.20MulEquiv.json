[
    {
        "content": "<p>Say I have the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommGroup</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>I failed to synth <code>CommGroup</code> for <code>S</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">synth</span><span class=\"w\"> </span><span class=\"n\">CommGroup</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"c1\">-- failed!</span>\n</code></pre></div>",
        "id": 510552737,
        "sender_full_name": "Zhang Qinchuan",
        "timestamp": 1743997318
    },
    {
        "content": "<p>Typeclass inference won't do this automatically, you'll have to make the instance manually. <del>Independent of that, your hypotheses imply that 0 is invertible in R and hence that R and S are trivial.</del>(edit: sorry I misread the first CommGroup as CommRing)</p>",
        "id": 510570423,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744006949
    },
    {
        "content": "<p>What zero?</p>",
        "id": 510570525,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1744007016
    },
    {
        "content": "<p>Also note that such an instance won't work, as lean won't look in your context if you have such an isomorphism</p>",
        "id": 510570685,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1744007094
    },
    {
        "content": "<p>Yes unfortunately typeclass inference isn't the way to solve all problems of the form \"this is a group/ring/field\"</p>",
        "id": 510570889,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744007184
    },
    {
        "content": "<p>Worth a try: <span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> MulEquiv, CommGroup, Group</p>",
        "id": 510570944,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1744007212
    },
    {
        "content": "<p><span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span> nothing found</p>",
        "id": 510570945,
        "sender_full_name": "loogle",
        "timestamp": 1744007213
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MulAut#doc\">docs#MulAut</a></p>",
        "id": 510621867,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744020991
    },
    {
        "content": "<p>i don't think that is relevant to this conversation?</p>",
        "id": 510622904,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1744021283
    },
    {
        "content": "<p>Ah sorry, I was going by the title alone, that <code>MulEquiv</code> itself forms a CommGroup</p>",
        "id": 510629852,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744023162
    },
    {
        "content": "<p>Seems currently there is not a straight way to create a <code>CommGroup</code> from a <code>MulEquiv</code> hence I use <code>Std.Commutative</code> instead.</p>",
        "id": 510883099,
        "sender_full_name": "Zhang Qinchuan",
        "timestamp": 1744104624
    },
    {
        "content": "<p>It's not that hard to get the instance with right defeq:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommGroup</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">commGroupOfMulEquiv</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CommGroup</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">__</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">‹_›</span>\n<span class=\"w\">  </span><span class=\"n\">mul_comm</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">injective</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp_rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">map_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_comm</span><span class=\"o\">])</span>\n</code></pre></div>",
        "id": 510888011,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1744105995
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"757121\">Zhang Qinchuan</span> has marked this topic as resolved.</p>",
        "id": 511051641,
        "sender_full_name": "Notification Bot",
        "timestamp": 1744160200
    }
]