[
    {
        "content": "<p>I'm looking at <a href=\"https://lean-lang.org/functional_programming_in_lean/hello-world/starting-a-project.html\">https://lean-lang.org/functional_programming_in_lean/hello-world/starting-a-project.html</a> and attempting to start a new project, having installed lean4 / lake5. When I create a new project it sets up a lakefile.toml rather than a lakefile.lean which I think means it's getting confused?</p>\n<p>tops@TOPS:~$ lake --version<br>\nLake version 5.0.0-410fab7 (Lean version 4.14.0)<br>\ntops@TOPS:~$ lean --version<br>\nLean (version 4.14.0, x86_64-unknown-linux-gnu, commit 410fab728470, Release)</p>",
        "id": 490372952,
        "sender_full_name": "Twm Stone",
        "timestamp": 1734858526
    },
    {
        "content": "<p><code>lakefile.toml</code> is the new default for projects</p>",
        "id": 490373178,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734858765
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/pull/5504\">lean4#5504</a></p>",
        "id": 490373274,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734858863
    },
    {
        "content": "<p>oh so the textbook is just out of date?</p>",
        "id": 490373279,
        "sender_full_name": "Twm Stone",
        "timestamp": 1734858882
    },
    {
        "content": "<p>I originally was looking into this because having created a new project I get the error</p>\n<p>unknown module prefix 'Py2lean'</p>\n<p>No directory 'Py2lean' or file 'Py2lean.olean' in the search path entries:<br>\n/home/tops/.elan/toolchains/stable/lib/lean</p>",
        "id": 490373322,
        "sender_full_name": "Twm Stone",
        "timestamp": 1734858945
    },
    {
        "content": "<p>and I assumed that the absolute minimal project <code>lake</code> would create wouldn't have errors in it</p>",
        "id": 490373369,
        "sender_full_name": "Twm Stone",
        "timestamp": 1734858965
    },
    {
        "content": "<p>Where are you getting this error?</p>",
        "id": 490373529,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734859161
    },
    {
        "content": "<p>the tool has created a <code>Main.lean</code> which looks like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Py2lean</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"Hello, {hello}!\"</span>\n</code></pre></div>\n<p>I've opened it in VSCode and the import statement is marked as an error in the Lean Infoview</p>",
        "id": 490373636,
        "sender_full_name": "Twm Stone",
        "timestamp": 1734859257
    },
    {
        "content": "<p>How did you open it in VSCode? Did you open the project folder?</p>",
        "id": 490373655,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734859285
    },
    {
        "content": "<p>yes</p>",
        "id": 490373672,
        "sender_full_name": "Twm Stone",
        "timestamp": 1734859312
    },
    {
        "content": "<p>If you do <code>lake build</code> from within the root of the project on the command line, do you get an error?</p>",
        "id": 490373740,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734859358
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">tops</span><span class=\"bp\">@</span><span class=\"n\">TOPS</span><span class=\"o\">:</span><span class=\"bp\">~/</span><span class=\"n\">py2lean</span><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">py2lean</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">previous</span><span class=\"w\"> </span><span class=\"n\">manifest</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">creating</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">scratch</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">updated</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">already</span><span class=\"w\"> </span><span class=\"n\">up</span><span class=\"bp\">-</span><span class=\"n\">to</span><span class=\"bp\">-</span><span class=\"n\">date</span>\n<span class=\"bp\">âœ–</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"mi\">5</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">py2lean</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././././</span><span class=\"n\">Main</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">bad</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Py2lean'</span>\n<span class=\"bp\">âœ–</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">3</span><span class=\"bp\">/</span><span class=\"mi\">5</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">Py2lean</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">file</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././././</span><span class=\"n\">Py2lean</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"bp\">âœ–</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">4</span><span class=\"bp\">/</span><span class=\"mi\">5</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">Main</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././././</span><span class=\"n\">Main</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">bad</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Py2lean'</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">py2lean</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Py2lean</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Main</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"bp\">```</span>\n</code></pre></div>",
        "id": 490373768,
        "sender_full_name": "Twm Stone",
        "timestamp": 1734859394
    },
    {
        "content": "<p>(And be sure to double check you've opened the folder containing the lakefile. This is a common mistake when getting started.)</p>",
        "id": 490373769,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734859396
    },
    {
        "content": "<p><code>tops@TOPS:~/py2lean$ ls -la\ntotal 44\ndrwxr-xr-x  5 tops tops 4096 Dec 22 09:22 .\ndrwxr-x--- 16 tops tops 4096 Dec 22 09:22 ..\ndrwxr-xr-x  7 tops tops 4096 Dec 22 09:22 .git\ndrwxr-xr-x  3 tops tops 4096 Dec 22 09:14 .github\n-rw-r--r--  1 tops tops    7 Dec 22 09:14 .gitignore\n-rw-r--r--  1 tops tops   71 Dec 22 09:14 Main.lean\ndrwxr-xr-x  2 tops tops 4096 Dec 22 09:14 Py2lean\n-rw-r--r--  1 tops tops    9 Dec 22 09:14 README.md\n-rw-r--r--  1 tops tops  113 Dec 22 09:22 lake-manifest.json\n-rw-r--r--  1 tops tops  140 Dec 22 09:14 lakefile.toml\n-rw-r--r--  1 tops tops    7 Dec 22 09:14 lean-toolchain</code></p>",
        "id": 490373796,
        "sender_full_name": "Twm Stone",
        "timestamp": 1734859432
    },
    {
        "content": "<p>What's the contents of the lakefile?</p>\n<p>I'm wondering if there's a case sensitivity issue.</p>",
        "id": 490373899,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734859492
    },
    {
        "content": "<p>ooh, maybe</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">tops</span><span class=\"bp\">@</span><span class=\"n\">TOPS</span><span class=\"o\">:</span><span class=\"bp\">~/</span><span class=\"n\">py2lean</span><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">cat</span><span class=\"w\"> </span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">toml</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"py2lean\"</span>\n<span class=\"n\">version</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"0.1.0\"</span>\n<span class=\"n\">defaultTargets</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"s2\">\"py2lean\"</span><span class=\"o\">]</span>\n\n<span class=\"o\">[[</span><span class=\"n\">lean_lib</span><span class=\"o\">]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"Py2lean\"</span>\n\n<span class=\"o\">[[</span><span class=\"n\">lean_exe</span><span class=\"o\">]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"py2lean\"</span>\n<span class=\"n\">root</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"Main\"</span><span class=\"bp\">```</span>\n</code></pre></div>",
        "id": 490373953,
        "sender_full_name": "Twm Stone",
        "timestamp": 1734859520
    },
    {
        "content": "<p>I'm looking at your directory listing again, and where's the <code>Py2lean.lean</code> file?</p>",
        "id": 490374107,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734859639
    },
    {
        "content": "<p>I just did <code>lake new Py2lean</code> and <code>lake new py2lean</code> to check, and in both cases there's a Py2lean.lean file</p>",
        "id": 490374134,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734859678
    },
    {
        "content": "<p>I'm using the exact same version of lake as you are</p>",
        "id": 490374193,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734859704
    },
    {
        "content": "<p>doesn't look like I have one</p>",
        "id": 490374219,
        "sender_full_name": "Twm Stone",
        "timestamp": 1734859758
    },
    {
        "content": "<p>I'm running on WSL / Ubuntu, in case that makes any difference</p>",
        "id": 490374241,
        "sender_full_name": "Twm Stone",
        "timestamp": 1734859786
    },
    {
        "content": "<p>What's the exact <code>lake new</code> command you ran?</p>",
        "id": 490374327,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734859845
    },
    {
        "content": "<p>looking at my bash history, it existed before I ran the build command ??</p>",
        "id": 490374344,
        "sender_full_name": "Twm Stone",
        "timestamp": 1734859864
    },
    {
        "content": "<p>I'll recreate py2lean</p>",
        "id": 490374361,
        "sender_full_name": "Twm Stone",
        "timestamp": 1734859881
    },
    {
        "content": "<p>ok wtf that now builds</p>",
        "id": 490374497,
        "sender_full_name": "Twm Stone",
        "timestamp": 1734860035
    },
    {
        "content": "<p>thanks for your help, I think that should just be fine now, apparently</p>",
        "id": 490374549,
        "sender_full_name": "Twm Stone",
        "timestamp": 1734860093
    },
    {
        "content": "<p>What a mystery, glad you're not stuck on build systems now</p>",
        "id": 490374586,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734860157
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"814491\">Twm Stone</span> <a href=\"#narrow/channel/113489-new-members/topic/Lake.20creates.20lean3.20project.20structure/near/490373279\">said</a>:</p>\n<blockquote>\n<p>oh so the textbook is just out of date?</p>\n</blockquote>\n<p>If you're following Functional Programming in Lean, the best way to have a smooth experience is to use the Lean version it was tested on, which is 4.1.0. If you use a newer version of Lean, you will encounter a few minor issues. To use Lean 4.1.0,  you can create the project with <code>lake +leanprover/lean4:v4.1.0 new greeting</code>. You don't need to include the <code>+leanprover/lean4:v4.1.0</code> part in other Lake commands. See <a class=\"message-link\" href=\"/#narrow/channel/113488-general/topic/.E2.9C.94.20Error.20in.20proof.20example.20from.20Functional.20Programming.20book.3F/near/486098743\">#general &gt; âœ” Error in proof example from Functional Programming book? @ ðŸ’¬</a> for an in-depth discussion by the author.</p>\n<p>(Don't get discouraged by that, the book is great and almost all you learn there will transfer to newer Lean versions! The changes were minor. You can also proceed with your current version and ask further questions here if some sample does not work. If you're not following the book closely, then using the most recent Lean version is probably better, as there have been multiple usability improvements.)</p>",
        "id": 490376526,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1734862140
    }
]