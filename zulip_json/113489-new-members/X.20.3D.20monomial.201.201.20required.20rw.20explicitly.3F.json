[
    {
        "content": "<p>Hi in the following code why is <code>rw [eq1]</code> necessary? The equation can be proved by <code>rfl</code>. But if it’s omitted, <code>rw [monomial_mul_monomial]</code> does not work.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">monomial</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span>\n\n<span class=\"kn\">example</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"n\">monomial</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n\n<span class=\"kn\">example</span><span class=\"o\">:</span><span class=\"n\">X</span><span class=\"bp\">*</span><span class=\"n\">X</span><span class=\"bp\">=</span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">eq1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">monomial</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">eq1</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">monomial_mul_monomial</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"c1\">-- let h:= monomial_mul_monomial 1 1 (1:R) (1:R)</span>\n<span class=\"w\">  </span><span class=\"c1\">-- rw [h]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n</code></pre></div>",
        "id": 500560791,
        "sender_full_name": "Shanghe Chen",
        "timestamp": 1739939425
    },
    {
        "content": "<p>Because <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Polynomial.X#doc\">docs#Polynomial.X</a> is defeq (at default transparency) to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Polynomial.monomial#doc\">docs#Polynomial.monomial</a> <code>1 (1 : R)</code>, but not at <em>reducible</em> transparency, which is the transparency at which <code>rw</code> operates.</p>",
        "id": 500563484,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739941317
    },
    {
        "content": "<p>You can see this because</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">monomial</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">with_reducible</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"c1\">-- fails</span>\n</code></pre></div>",
        "id": 500563602,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739941354
    },
    {
        "content": "<p><code>rw [monomial_mul_monomial]</code> looks for <code>monomial</code> but doesn't see it, because it doesn't see through the definition of <code>X</code>.</p>",
        "id": 500563685,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739941423
    },
    {
        "content": "<p>However, you don't need to write <code>eq1</code> itself, you can just use: <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Polynomial.monomial_one_one_eq_X#doc\">docs#Polynomial.monomial_one_one_eq_X</a></p>",
        "id": 500563779,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739941487
    },
    {
        "content": "<p>Oh thanks for pointing out the difference of transparencies and the theorem. I didn’t realize it exists in Mathlib!</p>",
        "id": 500563924,
        "sender_full_name": "Shanghe Chen",
        "timestamp": 1739941589
    },
    {
        "content": "<p>I find that Mario's answer in <a href=\"https://proofassistants.stackexchange.com/questions/2457/what-is-the-precise-meaning-of-reducible\">what-is-the-precise-meaning-of-reducible</a> explains the difference in detail too</p>",
        "id": 500565404,
        "sender_full_name": "Shanghe Chen",
        "timestamp": 1739942740
    }
]