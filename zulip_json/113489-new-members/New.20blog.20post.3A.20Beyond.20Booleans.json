[
    {
        "content": "<p>Continuing my Lean series, I wrote a new post:</p>\n<p><a href=\"https://overreacted.io/beyond-booleans/\">https://overreacted.io/beyond-booleans/</a></p>\n<p>(The audience is mostly programmers like me.)</p>\n<p>Would appreciate sharing in your circles (if you think someone might find it helpful) as well as any feedback/comments in case something is factually incorrect or misleading.</p>\n<p>Thanks!</p>",
        "id": 534784370,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755378147
    },
    {
        "content": "<p>FWIW Lean does also have a <code>==</code> which is notation for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=BEq.beq#doc\">docs#BEq.beq</a> which returns <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Bool#doc\">docs#Bool</a> which does have values <code>Bool.true</code> and <code>Bool.false</code></p>",
        "id": 534785059,
        "sender_full_name": "Lawrence Wu (llllvvuu)",
        "timestamp": 1755379106
    },
    {
        "content": "<p>One potential nit is that ‚ÄúLean REPL‚Äù calls to mind <a href=\"https://github.com/leanprover-community/repl\">https://github.com/leanprover-community/repl</a>, whereas we would normally call <a href=\"http://live.lean-lang.org\">live.lean-lang.org</a> the ‚Äúweb editor‚Äù or ‚Äúplayground‚Äù</p>",
        "id": 534785161,
        "sender_full_name": "Lawrence Wu (llllvvuu)",
        "timestamp": 1755379258
    },
    {
        "content": "<p>Thanks. Corrected to \"playground\". I'm severely downplaying Lean booleans to avoid confusion (with a \"can do booleans\" to be strict) so I figured I won't expand on them here.</p>",
        "id": 534785878,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755380186
    },
    {
        "content": "<blockquote>\n<p><strong>But when you write <code>2 + 2 = 4</code> in Lean, it doesn‚Äôt ‚Äúcollapse‚Äù into anything.</strong></p>\n</blockquote>\n<p>Are you sure about that? The reason why you can prove <code>2 + 2 = 4</code> with <code>rfl</code> is because Lean converts it into <code>4 = 4</code>.</p>",
        "id": 534786119,
        "sender_full_name": "suhr",
        "timestamp": 1755380639
    },
    {
        "content": "<p>Ah, wording. Fair. Lemme chew on that..</p>",
        "id": 534786129,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755380659
    },
    {
        "content": "<p>I'm not sure that wording is quite accurate</p>",
        "id": 534786145,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1755380686
    },
    {
        "content": "<p>Yea, I'll rephrase that it specifically doesn't collapse into a <code>true</code> or <code>false</code>. I do get into \"unfolding\" a little bit later but it's just too much to do during exposition. At this point, the main intuition I'm fighting with is the intuition of it being immediately computed.</p>",
        "id": 534786180,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755380745
    },
    {
        "content": "<p>Also, you can remove magic and write <code>Eq.refl 4</code> instead of <code>by rfl</code>. Eq is just a type family, Haskell programmers should be familiar with them.</p>",
        "id": 534786193,
        "sender_full_name": "suhr",
        "timestamp": 1755380766
    },
    {
        "content": "<blockquote>\n<p>Also, you can remove magic and write¬†<code>Eq.refl 4</code>¬†instead of¬†<code>by rfl</code>. Eq is just a type family, Haskell programmers should be familiar with them.</p>\n</blockquote>\n<p>I do that at the (very) end! But I'm the kind of person who closes an article as soon as it smells like Haskell because it's just too functional-brained for me. I can't read it.</p>",
        "id": 534786211,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755380802
    },
    {
        "content": "<p>Also, <code>2 + 2 = 4</code> is a pretty bad example to illustrate proof irrelevance because of Hedberg‚Äôs¬†Theorem (decidable equality implies equality of equality proofs).</p>",
        "id": 534786437,
        "sender_full_name": "suhr",
        "timestamp": 1755381203
    },
    {
        "content": "<p>Ah interesting, can you briefly explain this? This is a bit further than I can understand.</p>",
        "id": 534786462,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755381251
    },
    {
        "content": "<p>Basically, are you saying that because it's decidable, they would be equal anyway for some other reason?</p>",
        "id": 534786475,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755381282
    },
    {
        "content": "<p>Yep.</p>",
        "id": 534786512,
        "sender_full_name": "suhr",
        "timestamp": 1755381358
    },
    {
        "content": "<p><a href=\"https://mini-hott.readthedocs.io/en/latest/src/HedbergLemmas.html\">https://mini-hott.readthedocs.io/en/latest/src/HedbergLemmas.html</a></p>",
        "id": 534786538,
        "sender_full_name": "suhr",
        "timestamp": 1755381416
    },
    {
        "content": "<p>Alas, this is outside of my competence for now. I'll keep it in mind and maybe add a note. One constraint I'm working with is that my audience has never seen a proof in their life (and also doesn't know mathematics) so I'm trying to keep it very easy to mentally parse.</p>",
        "id": 534786581,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755381507
    },
    {
        "content": "<p>I guess pedantically it still doesn't hurt to say that all proofs are equal (since it's still correct) but maybe remove the \"proof irrelevance\" title so that this particular example doesn't claim to be an example of that.</p>\n<p>Whoever knows that this is a bad example already knows enough to not get confused by this example. And whoever doesn't know that would still walk away with the right takeaway.</p>",
        "id": 534786607,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755381561
    },
    {
        "content": "<p>Would it be fair to say that \"proofs are opaque\"? As a title of that section.</p>",
        "id": 534786960,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755382116
    },
    {
        "content": "<p>well that's not quite true either</p>",
        "id": 534787027,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755382251
    },
    {
        "content": "<p><code>theorem</code>s are opaque, but not every proof has to be declared using <code>theorem</code></p>",
        "id": 534787046,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755382267
    },
    {
        "content": "<p>and you can still unfold them</p>",
        "id": 534787064,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755382288
    },
    {
        "content": "<p>Right. I guess I mean that you can't introspect values of a prop.</p>",
        "id": 534787066,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755382288
    },
    {
        "content": "<p>Counterpoint: I think <code>2 + 2 = 4</code> is a perfectly ok example. Hedberg's lemma just says that <em>in certain other proof systems</em> (such as HoTT), in which whether proofs are irrelevant depends on which proposition they are a proof <em>of</em>, <code>2 + 2 = 4</code> would have irrelevant proofs whereas a different proposition might not. But in Lean, all proofs are irrelevant, so any proposition works as an example.</p>",
        "id": 534787091,
        "sender_full_name": "ùö†ùöòùöìùöåùöíùöéùöåùöë ùöóùöäùö†ùöõùöòùöåùöîùöí",
        "timestamp": 1755382333
    },
    {
        "content": "<p>Lean has definitional proof irrelevance, which is something that Hedberg's theorem doesn't give you</p>",
        "id": 534787132,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755382419
    },
    {
        "content": "<p>It might be cool to mention how you can simulate passing proofs around in Typescript by using opaque types</p>",
        "id": 534797059,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1755399561
    },
    {
        "content": "<p>for example, you say \"you can‚Äôt do much better than throwing a runtime error\" if you want to write a function that takes a value between 0 and 1, but that's not entirely true</p>\n<p>you could define an opaque type called BetweenOneAndZero and write a type guard that validates the input and returns the typed value</p>",
        "id": 534797150,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1755399687
    },
    {
        "content": "<p>(Typescript doesn't yet support opaque types, so you have to simulate them, but it can still be done in a minimally hacky way)</p>",
        "id": 534797190,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1755399771
    },
    {
        "content": "<p>something like this:</p>\n<div class=\"codehilite\" data-code-language=\"TypeScript\"><pre><span></span><code><span class=\"kr\">type</span><span class=\"w\"> </span><span class=\"nx\">Opaque</span><span class=\"o\">&lt;</span><span class=\"nx\">base</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">tag</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">base</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"nx\">__tag</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">tag</span><span class=\"w\"> </span><span class=\"p\">};</span>\n\n<span class=\"kr\">type</span><span class=\"w\"> </span><span class=\"nx\">UnitInterval</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">Opaque</span><span class=\"o\">&lt;</span><span class=\"kt\">number</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s1\">'UnitInterval'</span><span class=\"o\">&gt;</span><span class=\"p\">;</span>\n\n<span class=\"kd\">function</span><span class=\"w\"> </span><span class=\"nx\">isUnitInterval</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nx\">input</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">number</span><span class=\"p\">)</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"nx\">input</span><span class=\"w\"> </span><span class=\"nx\">is</span><span class=\"w\"> </span><span class=\"nx\">UnitInterval</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">  </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mf\">0</span><span class=\"w\"> </span><span class=\"o\">&lt;=</span><span class=\"w\"> </span><span class=\"nx\">input</span><span class=\"w\"> </span><span class=\"o\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"nx\">input</span><span class=\"w\"> </span><span class=\"o\">&lt;=</span><span class=\"w\"> </span><span class=\"mf\">1</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"kd\">function</span><span class=\"w\"> </span><span class=\"nx\">someFunction</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nx\">input</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">UnitInterval</span><span class=\"p\">)</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">number</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">  </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"nx\">input</span><span class=\"w\"> </span><span class=\"o\">**</span><span class=\"w\"> </span><span class=\"mf\">2</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</code></pre></div>",
        "id": 534797721,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1755400845
    },
    {
        "content": "<p>though this is more like a Lean Subtype than passing in a proof</p>",
        "id": 534797796,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1755401040
    },
    {
        "content": "<p>Ah yeah that‚Äôs true. Hmm. Can you think of an example that would more strongly convey the difference? Not that I want to redo the entire section but I wonder if there‚Äôs something that type guards like this would struggle to express.</p>",
        "id": 534816065,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755428122
    },
    {
        "content": "<p>I guess I'd say this is still not \"much\" better since the actual enforcement is still done via a runtime check.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">UnitInterval</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">number</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"bp\">__</span><span class=\"n\">brand</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">UnitInterval'</span><span class=\"w\"> </span><span class=\"o\">}</span><span class=\"bp\">;</span>\n\n<span class=\"n\">function</span><span class=\"w\"> </span><span class=\"n\">makeUnitInterval</span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">number</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">UnitInterval</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&gt;=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&lt;=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"n\">UnitInterval</span><span class=\"bp\">;</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"n\">throw</span><span class=\"w\"> </span><span class=\"n\">RangeError</span><span class=\"o\">(</span><span class=\"bp\">'</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">must</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">between</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"bp\">'</span><span class=\"o\">)</span><span class=\"bp\">;</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">function</span><span class=\"w\"> </span><span class=\"n\">someFunction</span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">UnitInterval</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">number</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">  </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">**</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"bp\">;</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">someFunction</span><span class=\"o\">(</span><span class=\"mf\">0.5</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">Doesn't</span><span class=\"w\"> </span><span class=\"n\">typecheck</span>\n<span class=\"n\">someFunction</span><span class=\"o\">(</span><span class=\"mf\">1.2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">Doesn't</span><span class=\"w\"> </span><span class=\"n\">typecheck</span>\n<span class=\"n\">someFunction</span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">Doesn't</span><span class=\"w\"> </span><span class=\"n\">typecheck</span>\n\n<span class=\"n\">someFunction</span><span class=\"o\">(</span><span class=\"n\">makeUnitInterval</span><span class=\"o\">(</span><span class=\"mf\">0.5</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">Typechecks</span>\n<span class=\"n\">someFunction</span><span class=\"o\">(</span><span class=\"n\">makeUnitInterval</span><span class=\"o\">(</span><span class=\"mf\">1.2</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">Typechecks</span>\n<span class=\"n\">someFunction</span><span class=\"o\">(</span><span class=\"n\">makeUnitInterval</span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">Typechecks</span>\n</code></pre></div>",
        "id": 534825011,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755438715
    },
    {
        "content": "<p>Alright, I made \"much\" a link pointing to <a href=\"https://gist.github.com/gaearon/966446d27de88ba4d4806a9a5b291d0a\">https://gist.github.com/gaearon/966446d27de88ba4d4806a9a5b291d0a</a>.</p>",
        "id": 534825371,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755439063
    },
    {
        "content": "<p>Some discussion and opportunity to answer people's questions about Lean:</p>\n<p><a href=\"https://www.reddit.com/r/typescript/comments/1mss4im/beyond_booleans/\">https://www.reddit.com/r/typescript/comments/1mss4im/beyond_booleans/</a></p>\n<p><a href=\"https://www.reddit.com/r/ProgrammingLanguages/comments/1mss18c/beyond_booleans/\">https://www.reddit.com/r/ProgrammingLanguages/comments/1mss18c/beyond_booleans/</a></p>\n<p><a href=\"https://www.reddit.com/r/programming/comments/1ms7jwx/beyond_booleans/\">https://www.reddit.com/r/programming/comments/1ms7jwx/beyond_booleans/</a></p>",
        "id": 534836511,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755452086
    },
    {
        "content": "<p>yeah, I suppose the difference is that in Typescript you don't have a compile-time proof of the property... you only have a compile-time proof that you passed the value into a runtime validation function</p>\n<p>still useful though, especially in a large codebase where it allows you to validate at the edges and preserve that information within</p>",
        "id": 534840829,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1755457030
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/stream/113489-new-members/topic/New.20blog.20post.3A.20Beyond.20Booleans/near/534787066\">said</a>:</p>\n<blockquote>\n<p>Right. I guess I mean that you can't introspect values of a prop.</p>\n</blockquote>\n<p>I believe this isn't strictly the case; though I think actually doing do is very rare</p>",
        "id": 534867994,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755490694
    }
]