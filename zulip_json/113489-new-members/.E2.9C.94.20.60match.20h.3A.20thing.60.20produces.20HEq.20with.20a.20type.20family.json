[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">Defs</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">section</span><span class=\"w\"> </span><span class=\"n\">DAG</span>\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">DAG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Vx</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">PartialOrder</span><span class=\"w\"> </span><span class=\"n\">Vx</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">Vx</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">adj</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Vx</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"w\">  </span><span class=\"n\">topo_order</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subrelation</span><span class=\"w\"> </span><span class=\"n\">adj</span><span class=\"w\"> </span><span class=\"n\">LT</span><span class=\"bp\">.</span><span class=\"n\">lt</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Vx</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">DAG</span><span class=\"w\"> </span><span class=\"n\">Vx</span><span class=\"o\">]</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">DAG</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Vx</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">point</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"o\">}:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">z</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">adj</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">concat</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Vx</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">point</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">b</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">tail</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">concat</span><span class=\"w\"> </span><span class=\"n\">tail</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span>\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">DAG</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">Multitree</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Vx</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">DAG</span><span class=\"w\"> </span><span class=\"n\">Vx</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">uniquePath</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"k\">forall</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Vx</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"o\">:=</span><span class=\"n\">toDAG</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Multitree</span><span class=\"w\"> </span><span class=\"n\">Vx</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Vx</span><span class=\"o\">)</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">diagonal_path_sum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">su</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sv</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ut</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">vt</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">same</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">concat</span><span class=\"w\"> </span><span class=\"n\">su</span><span class=\"w\"> </span><span class=\"n\">ut</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">concat</span><span class=\"w\"> </span><span class=\"n\">sv</span><span class=\"w\"> </span><span class=\"n\">vt</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Multitree</span><span class=\"bp\">.</span><span class=\"n\">uniquePath</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n<span class=\"w\">  </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">su</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sv</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">point</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"n\">sv</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">point</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"n\">su</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">z1</span><span class=\"w\"> </span><span class=\"n\">e1</span><span class=\"w\"> </span><span class=\"n\">t1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">z2</span><span class=\"w\"> </span><span class=\"n\">e2</span><span class=\"w\"> </span><span class=\"n\">t2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"c1\">--&lt;-- here I have two unnamed hypotheses v† = v, u† = u,</span>\n<span class=\"w\">      </span><span class=\"c1\">-- (su, sv) are renamed, and I have h = HEq (su†, sv†) ...</span>\n<span class=\"w\">      </span><span class=\"c1\">-- likewise, `same` has `su`, `sv` unsubstituted</span>\n</code></pre></div>\n<p>I understand the renaming happens so that the first two cases can cast <code>su</code> and <code>sv</code> given equalities <code>s = u</code> and <code>s = v</code>. But this renders <code>h</code> fairly useless (being an <code>HEq</code>) and <code>same</code> also remains unsubstituted.<br>\nI was able to do the construction using <code>cases</code> and tactics mode, but it makes all other branches more cumbersome because it nukes names <code>su</code>, <code>sv</code>.</p>\n<p>How would I finish that construction?</p>",
        "id": 479150730,
        "sender_full_name": "Alex Mobius",
        "timestamp": 1730050443
    },
    {
        "content": "<p>It's always better to use multiple discriminants in a <code>match</code> than to use tuples.</p>\n<p>This seems like progress:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">diagonal_path_sum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">su</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sv</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ut</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">vt</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">same</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">concat</span><span class=\"w\"> </span><span class=\"n\">su</span><span class=\"w\"> </span><span class=\"n\">ut</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">concat</span><span class=\"w\"> </span><span class=\"n\">sv</span><span class=\"w\"> </span><span class=\"n\">vt</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Multitree</span><span class=\"bp\">.</span><span class=\"n\">uniquePath</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n<span class=\"w\">  </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">hu</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">su</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hv</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">sv</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">point</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"n\">sv</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">point</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"n\">su</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">z1</span><span class=\"w\"> </span><span class=\"n\">e1</span><span class=\"w\"> </span><span class=\"n\">t1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">z2</span><span class=\"w\"> </span><span class=\"n\">e2</span><span class=\"w\"> </span><span class=\"n\">t2</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">subst_vars</span>\n<span class=\"w\">    </span><span class=\"c\">/-</span>\n<span class=\"cm\">    Vx : Type ?u.2556</span>\n<span class=\"cm\">    G : Multitree Vx</span>\n<span class=\"cm\">    s t v u z1 : Vx</span>\n<span class=\"cm\">    e1 : DAG.adj s z1</span>\n<span class=\"cm\">    t1 : Path z1 u</span>\n<span class=\"cm\">    z2 : Vx</span>\n<span class=\"cm\">    e2 : DAG.adj s z2</span>\n<span class=\"cm\">    t2 : Path z2 v</span>\n<span class=\"cm\">    ut : Path u t</span>\n<span class=\"cm\">    vt : Path v t</span>\n<span class=\"cm\">    same : concat (Path.cons z1 e1 t1) ut = concat (Path.cons z2 e2 t2) vt</span>\n<span class=\"cm\">    ⊢ Path u v ⊕ Path v u</span>\n<span class=\"cm\">    -/</span>\n</code></pre></div>",
        "id": 479151046,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1730050726
    },
    {
        "content": "<p>It looks like you can make progress even with the tuples:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">diagonal_path_sum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">su</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sv</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ut</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">vt</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">same</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">concat</span><span class=\"w\"> </span><span class=\"n\">su</span><span class=\"w\"> </span><span class=\"n\">ut</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">concat</span><span class=\"w\"> </span><span class=\"n\">sv</span><span class=\"w\"> </span><span class=\"n\">vt</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Multitree</span><span class=\"bp\">.</span><span class=\"n\">uniquePath</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n<span class=\"w\">  </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">su</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sv</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">point</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"n\">sv</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">point</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"n\">su</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">z1</span><span class=\"w\"> </span><span class=\"n\">e1</span><span class=\"w\"> </span><span class=\"n\">t1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">z2</span><span class=\"w\"> </span><span class=\"n\">e2</span><span class=\"w\"> </span><span class=\"n\">t2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">subst_vars</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"c\">/-</span>\n<span class=\"cm\">    Vx : Type ?u.2556</span>\n<span class=\"cm\">    G : Multitree Vx</span>\n<span class=\"cm\">    s t v u z1 : Vx</span>\n<span class=\"cm\">    e1 : DAG.adj s z1</span>\n<span class=\"cm\">    t1 : Path z1 u</span>\n<span class=\"cm\">    z2 : Vx</span>\n<span class=\"cm\">    e2 : DAG.adj s z2</span>\n<span class=\"cm\">    t2 : Path z2 v</span>\n<span class=\"cm\">    su : Path s u</span>\n<span class=\"cm\">    sv : Path s v</span>\n<span class=\"cm\">    ut : Path u t</span>\n<span class=\"cm\">    vt : Path v t</span>\n<span class=\"cm\">    same : concat su ut = concat sv vt</span>\n<span class=\"cm\">    ⊢ Path u v ⊕ Path v u</span>\n<span class=\"cm\">    -/</span>\n</code></pre></div>",
        "id": 479151096,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1730050778
    },
    {
        "content": "<p>However, it's usually not a good idea to tactics to construct definitions, so it would be worth figuring out how to avoid <code>subst_vars</code>, etc., once you make the definition.</p>",
        "id": 479151189,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1730050835
    },
    {
        "content": "<p>Much obliged! <code>subst_vars</code> seems like progress indeed, and I also learned about <code>rename</code> from Aesop. I don't think I even need to name the match clause anymore.</p>\n<blockquote>\n<p>it's usually not a good idea to tactics to construct definitions</p>\n</blockquote>\n<p>May I wonder why? I try to limit those to proofs of type equality, though this particular function is a construction for proof purposes (it's easier to operate on paths than on their existence).</p>",
        "id": 479151623,
        "sender_full_name": "Alex Mobius",
        "timestamp": 1730051242
    },
    {
        "content": "<p>It's because usually you want to prove things about a definition, and so you want to control what the definition actually looks like. With tactics, you're letting automation create the terms.</p>",
        "id": 479151707,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1730051298
    },
    {
        "content": "<p>I've already suggested to you the idea of using a <code>copy</code>/<code>cast</code> function <a href=\"#narrow/channel/113489-new-members/topic/Constructor.20elimination.20under.20HEq/near/478977615\">here</a>. I think this is a good way to work with index equalities for paths.</p>",
        "id": 479151878,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1730051453
    },
    {
        "content": "<p>Fair, though this construction is again part of a proof itself.<br>\nYeah, I need to write a copy for my type, probably :) is there no way to make a global type substitution based on an equality outside of tactics mode? Or is there a subtle soundness issue with that?</p>",
        "id": 479152034,
        "sender_full_name": "Alex Mobius",
        "timestamp": 1730051585
    },
    {
        "content": "<p>There is, the triangle operator <code>▸</code></p>",
        "id": 479152071,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1730051635
    },
    {
        "content": "<p>If you search Zulip for <code>vector.cast</code> you can see some discussion.</p>",
        "id": 479152153,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1730051685
    },
    {
        "content": "<p>Also, I'd like to mention that you could be using <code>SimpleGraph</code> here and get <code>SimpleGraph.Walk</code> for free. It's fair to reimplement all of this for learning purposes of course.</p>",
        "id": 479152211,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1730051743
    },
    {
        "content": "<p>Oh right, not <code>SimpleGraph</code>, and our <code>DirectedGraph</code> doesn't have walks yet.</p>",
        "id": 479152305,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1730051780
    },
    {
        "content": "<p>I made a <code>Digraph</code> type with walks by adapting the whole <code>SimpleGraph</code> library here: <a href=\"https://github.com/kmill/msri2023_graphs/blob/main/GraphProjects/DigraphConnectivity.lean\">https://github.com/kmill/msri2023_graphs/blob/main/GraphProjects/DigraphConnectivity.lean</a></p>",
        "id": 479152366,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1730051846
    },
    {
        "content": "<p>That's very comprehensive! Yeah, learning is definitely part of my motivation here. Though I seem to be mostly done with basic definitions, and moving on to my actual algorithms now :)</p>",
        "id": 479152483,
        "sender_full_name": "Alex Mobius",
        "timestamp": 1730051977
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"767265\">Alex Mobius</span> has marked this topic as resolved.</p>",
        "id": 479152786,
        "sender_full_name": "Notification Bot",
        "timestamp": 1730052159
    }
]