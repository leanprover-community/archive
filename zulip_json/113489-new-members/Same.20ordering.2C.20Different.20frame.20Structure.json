[
    {
        "content": "<p>Hi,<br>\nI'm currently trying to define Sublocales in Lean to prove that the sublocales of a locale X are isomorphic to the nuclei on X.<br>\nTherefore, I'm currently trying to follow this definition of a sublocale on <a href=\"https://ncatlab.org/nlab/show/sublocale\">nlab</a>:</p>\n<blockquote>\n<p>[L is a frame]<br>\nThus, sublocales of L can be defined as subsets S of L such that S is a locale once we equip it with the order induced from L, and the left adjoint to the inclusion S→L exists and preserves finite meets. [...]<br>\n(The inclusion S→L need not preserve joins, so in particular, the lattice structure on S may be different from that of L, only the ordering is the same.)</p>\n</blockquote>\n<p>This is what I have so far:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Sublocale</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">Frame</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">carrier</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">X</span>\n<span class=\"w\">  </span><span class=\"n\">frm</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">Frame</span><span class=\"w\"> </span><span class=\"n\">carrier</span>\n<span class=\"w\">  </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">InfHom</span><span class=\"w\">  </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"n\">carrier</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">frm</span><span class=\"bp\">.</span><span class=\"n\">toMin</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">gc</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">GaloisConnection</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">frm</span><span class=\"bp\">.</span><span class=\"n\">toPreorder</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">val</span>\n</code></pre></div>\n<p>But this definition has one problem. In Mathlib, there is the Instance <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Order/Basic.html#Subtype.preorder\">Subtype.preorder</a> which gives <code>carrier</code> the same ordering as <code>X</code>. But the <code>carrier</code> also has to be a <code>Frame</code>, which could be different from the <code>Frame</code> on <code>X</code>. I used the <code>frm</code> Field to assert that <code>carrier</code> has to be a Frame. But this is almost certainly wrong, because the Ordering of <code>frm</code> is possibly not the same as the Ordering of <code>X</code> which is supplied by the <code>Subtype.preorder</code> instance.<br>\nHow can I express in lean, that <code>carrier</code> should be a Frame with the same ordering as <code>X</code>? <br>\n(<a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMB0B5KAEwFMocA5AVwGN1jKBnAKCYDckpgks64BvABpwAXHAAqATzDEAVAF84AbQIkyAMShIQxOAIC6LBjCg0YlKDoDKlHhGpJeACiGjJ0mQEolK0jg1adfTgAd1RSYiY4OHsoTlIROEtieAFIuAAzKBAEn3VNbWiOOKg09ASAAQBJADt0gAkIbN04QETCGOK4AH04R0yQHBgIBGBqjzSAc2oKgHEHCGAGAGEIauriahhgFa6d7t6sgYgABQtoVS8y6ywYKWIcdnQWEaMkauodPgYEq/Q7B0CFKJcn58joGDh2sB4sIALxwcF9FjsTjcJxfUQ/P68ARjJgAYmoYWoAGt4Tg+ocTsQzqR8QwJNU0HAqTSoGTIbSALTcuCcgB84jCEjgHB0hGA6XS4UZcCwlHgDFQEEo6EIsp0aDBASAA\">MWE</a>)</p>",
        "id": 517377760,
        "sender_full_name": "Christian Krause",
        "timestamp": 1746982403
    },
    {
        "content": "<p>You should instead assume that <code>carrier</code> is closed under frame operations. See how <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Subgroup#doc\">docs#Subgroup</a> is made</p>",
        "id": 517378205,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1746982709
    },
    {
        "content": "<p>Probably you want to instead express that <code>carrier</code> is closed under the frame operations?</p>",
        "id": 517378206,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746982710
    },
    {
        "content": "<p>Extending <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Sublattice#doc\">docs#Sublattice</a> would presumably be a good start</p>",
        "id": 517378258,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746982752
    },
    {
        "content": "<p>I looked into <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CompleteSublattice#doc\">docs#CompleteSublattice</a>, but I'm not sure if that's what I want, because the definition says:</p>\n<blockquote>\n<p>(The inclusion S→L need not preserve joins, so in particular, the lattice structure on S may be different from that of L, only the ordering is the same</p>\n</blockquote>\n<p>Or am I not understanding this sentence correctly?</p>",
        "id": 517378448,
        "sender_full_name": "Christian Krause",
        "timestamp": 1746982877
    },
    {
        "content": "<p>I could probably just use this definition:</p>\n<blockquote>\n<p>Equivalently, sublocales of L can also be described (PP12 §2.1) as subsets S of L that are closed under all meets and for any s∈S and x∈L, we have (x→s)∈S.</p>\n</blockquote>\n<p>which could be implemented in a similar way as <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Sublattice#doc\">docs#Sublattice</a>, but I do want to understand how the first definition would work in lean.</p>",
        "id": 517378769,
        "sender_full_name": "Christian Krause",
        "timestamp": 1746983102
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"652766\">Christian K</span> <a href=\"#narrow/channel/113489-new-members/topic/Same.20ordering.2C.20Different.20frame.20Structure/near/517378448\">said</a>:</p>\n<blockquote>\n<p>I looked into <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CompleteSublattice#doc\">docs#CompleteSublattice</a>, but I'm not sure if that's what I want, because the definition says:</p>\n<blockquote>\n<p>(The inclusion S→L need not preserve joins, so in particular, the lattice structure on S may be different from that of L, only the ordering is the same</p>\n</blockquote>\n<p>Or am I not understanding this sentence correctly?</p>\n</blockquote>\n<p>Where do you see this sentence? It doesn't appear in this file AFAICT</p>",
        "id": 517378868,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1746983168
    },
    {
        "content": "<p>It is from the definition of sublocales in nlab.  (I should have phrased this more clearly earlier ...)</p>",
        "id": 517378894,
        "sender_full_name": "Christian Krause",
        "timestamp": 1746983192
    },
    {
        "content": "<p>As far as I understand, this is the opposite of what <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Sublattice#doc\">docs#Sublattice</a> does.</p>",
        "id": 517378968,
        "sender_full_name": "Christian Krause",
        "timestamp": 1746983255
    }
]