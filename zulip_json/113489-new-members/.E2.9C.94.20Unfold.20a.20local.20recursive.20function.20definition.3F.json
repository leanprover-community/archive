[
    {
        "content": "<p>In a proof I am doing as an exercise, I need to introduce a recursive function then prove a few things about it.  Here is a <br>\nmwe.  In the example that follows, I know I can just move the definition of the factorial out of the proof and work there,  (or use the proofs that already are in Mathlib) but I am hoping there is a way to this \"inside\" the proof term for my specific subsequence. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">rec</span><span class=\"w\"> </span><span class=\"n\">myFactorial</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\">  </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">myFactorial</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">myFactorial</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h3</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">),</span><span class=\"n\">myFactorial</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">myFactorial</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>I appreciate any help.</p>",
        "id": 490006037,
        "sender_full_name": "Kent Van Vels",
        "timestamp": 1734626542
    },
    {
        "content": "<p>Local recursive definitions don't have any equation lemmas yet, so you can't prove anything about them. What you need to do is to lift it out to a global definition.</p>",
        "id": 490013650,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734628475
    },
    {
        "content": "<p>Sometimes sequences can be defined without creating recursive definitions, for example using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.iterate#doc\">docs#Nat.iterate</a> or <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.fold#doc\">docs#Nat.fold</a></p>",
        "id": 490013922,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734628564
    },
    {
        "content": "<p>Do you mean that this going to be added, or do you mean that it is  somehow impossible to be added? </p>\n<p>I was able to write my subsequence as an iteration and have been making progress.   Thank you, <span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> .</p>",
        "id": 490018678,
        "sender_full_name": "Kent Van Vels",
        "timestamp": 1734630307
    },
    {
        "content": "<p>I mean \"yet\" as in \"at the point in elaboration where you want to unfold them\" — it's not possible</p>",
        "id": 490025603,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734632975
    },
    {
        "content": "<p>Thanks for the info, I was able to get it to work.</p>",
        "id": 490061775,
        "sender_full_name": "Kent Van Vels",
        "timestamp": 1734648493
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"519925\">Kent Van Vels</span> has marked this topic as resolved.</p>",
        "id": 490061784,
        "sender_full_name": "Notification Bot",
        "timestamp": 1734648499
    }
]