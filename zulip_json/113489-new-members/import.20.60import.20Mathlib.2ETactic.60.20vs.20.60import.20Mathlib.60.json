[
    {
        "content": "<p>I've been trying to create starter minimal examples suitable for beginners like me.</p>\n<p>I've been using </p>\n<p><code>import Mathlib.Tactic</code></p>\n<p>but I've noticed several replies to my questions here use</p>\n<p><code>import Mathlib</code></p>\n<p>Question: is <code>import Mathlib</code> more conventional? Is it wasteful because it imports \"everything\"? What are the pros/cons?</p>",
        "id": 451086738,
        "sender_full_name": "rzeta0",
        "timestamp": 1720823339
    },
    {
        "content": "<p>It usually shouldn't be used as it makes compilation slower, but when writing a short example it can be convenient as you don't need to figure out what imports are actually needed</p>",
        "id": 451108730,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1720834831
    },
    {
        "content": "<p>For pedagogical purposes, I'd either try to minimize imports to something reasonable (#min_imports helps with this; perhaps you already heard of this) or just <code>import Mathlib</code> as a sign \"this is clearly not minimal\".</p>",
        "id": 451110081,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1720835673
    },
    {
        "content": "<p>I sometimes use <code>import Mathlib</code> when replying to questions, when the questioner has not done their job properly i.e. not made an <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> so I don't know what imports I should be using. It's definitely wasteful, for example it makes <code>exact?</code> take much longer</p>",
        "id": 451141596,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1720858793
    },
    {
        "content": "<p>On the other hand, sometimes you can state the problem without the imports you need for a (natural) proof</p>",
        "id": 451141837,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1720858944
    },
    {
        "content": "<p>I find it really hard to reason about what needs to be imported to use a certain thing (and sometimes also what import leads to some things being available unexpectedly). You basically have to become familiar with the internal import graph of Mathlib?</p>\n<p>If the engineering problems could be solved, it's a much nicer experience to be able to just always use <code>import Mathlib</code>...</p>",
        "id": 451156437,
        "sender_full_name": "Adomas Baliuka",
        "timestamp": 1720867987
    },
    {
        "content": "<p>what does #min_imports do?</p>\n<p>my search engine isn't helping...</p>",
        "id": 451170767,
        "sender_full_name": "rzeta0",
        "timestamp": 1720876424
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> <a href=\"#narrow/stream/113489-new-members/topic/import.20.60import.20Mathlib.2ETactic.60.20vs.20.60import.20Mathlib.60/near/451170767\">said</a>:</p>\n<blockquote>\n<p>what does #min_imports do?</p>\n<p>my search engine isn't helping...</p>\n</blockquote>\n<p>It used to be called #minimize_imports, and was recently renamed. From its docstring.<br>\n:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Try</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">compute</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">minimal</span><span class=\"w\"> </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">imports</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">analyzing</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">declarations</span><span class=\"bp\">.</span>\n\n<span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">must</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">aware</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">tactics</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">so</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">results</span><span class=\"w\"> </span><span class=\"n\">will</span><span class=\"w\"> </span><span class=\"n\">likely</span><span class=\"w\"> </span><span class=\"n\">need</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">adjusted</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">hand</span><span class=\"bp\">.</span>\n</code></pre></div>",
        "id": 451172289,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1720877415
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"638715\">Adomas Baliuka</span> <a href=\"#narrow/stream/113489-new-members/topic/import.20.60import.20Mathlib.2ETactic.60.20vs.20.60import.20Mathlib.60/near/451156437\">said</a>:</p>\n<blockquote>\n<p>I find it really hard to reason about what needs to be imported to use a certain thing (and sometimes also what import leads to some things being available unexpectedly). You basically have to become familiar with the internal import graph of Mathlib?</p>\n<p>If the engineering problems could be solved, it's a much nicer experience to be able to just always use <code>import Mathlib</code>...</p>\n</blockquote>\n<p>I don't know mathlib's import graph by heart either! A reasonable workflow is \"start with import Mathlib, write your code and then use #min_imports to reduce to a reasonable subset\". Another (more suitable for working on a mathlib branch) is to gradually add imports as you need them.<br>\nIf you want to use a certain definition, the <a href=\"https://leanprover-community.github.io/mathlib4_docs/\">API docs</a> (or search in VS Code) will tell you where that is located, so importing that file will do.</p>",
        "id": 451172423,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1720877525
    },
    {
        "content": "<p>Playing around with <code>#min_imports</code> suggests that many files inside Mathlib have unnecessary imports. Should one try to remove those? Is there a reason we don't have a linter for unused imports?</p>",
        "id": 451351122,
        "sender_full_name": "Adomas Baliuka",
        "timestamp": 1720961530
    },
    {
        "content": "<p>We do have that linter</p>",
        "id": 451352068,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1720962312
    },
    {
        "content": "<p>You may be discovering imports that are still imported transitively if you remove the direct import</p>",
        "id": 451352088,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1720962345
    },
    {
        "content": "<p>shake doesn't complain about imports which can be removed because they're importing something which is already there??</p>",
        "id": 451352374,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1720962672
    },
    {
        "content": "<p>That's correct</p>",
        "id": 451355081,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1720964248
    },
    {
        "content": "<p>Is that desired? Alternatively, would it make any difference (to e.g. performance or docs, etc.) if we remove such unnecessary imports?</p>",
        "id": 451356804,
        "sender_full_name": "Adomas Baliuka",
        "timestamp": 1720965495
    },
    {
        "content": "<p>I think it's likely a minimal win on those measures, at the expense of more ci failures</p>",
        "id": 451366650,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1720974536
    }
]