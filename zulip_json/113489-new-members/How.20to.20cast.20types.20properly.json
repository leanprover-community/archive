[
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">α</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">func</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasEquiv</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">func</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">≈</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>I want to make the example work as expected. Of course it is possible to define an explicit coersion method, like <code>of\\alpha : \\alpha \\to \\beta</code>, but it will lead to not-simp-normal-form error if the theorem <code>of\\alpha a = a</code> is simp, which is very reasonable if I'm right.</p>",
        "id": 497833755,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1738743913
    },
    {
        "content": "<p><code>func b</code> is defeq abuse so I'm not sure what \"work as expected\" means here, if you commit defeq abuse then it's hard to know what to expect.</p>",
        "id": 497874238,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738756274
    },
    {
        "content": "<p>So I'd like to state an equivalence between <code>func b</code> and <code>b</code> as an element of type <code>\\beta</code>. In my case, <code>\\alpha</code> is actually a list, so it bothers me quite a lot.</p>",
        "id": 497875171,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1738756614
    },
    {
        "content": "<p>But <code>func</code> is not a function on beta</p>",
        "id": 497879152,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738757779
    },
    {
        "content": "<p>Then should I make a copy of <code>func</code> and its related theorems which works with <code>\\beta</code>?</p>",
        "id": 497879430,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1738757873
    },
    {
        "content": "<p>And <code>of\\alpha a = a</code> is also defeq abuse so shouldn't be a simp lemma or indeed a lemma</p>",
        "id": 497879439,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738757876
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"574112\">Jihoon Hyun</span> <a href=\"#narrow/stream/113489-new-members/topic/How.20to.20cast.20types.20properly/near/497879430\">said</a>:</p>\n<blockquote>\n<p>Then should I make a copy of <code>func</code> and its related theorems which works with <code>\\beta</code>?</p>\n</blockquote>\n<p>Sure! In mathlib we have plenty of examples of avoiding defeq abuse by carefully using of\\alpha and to\\alpha even on types which are defeq</p>",
        "id": 497879779,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738757979
    },
    {
        "content": "<p>usually in this kind of situation, we have a few casting equivalences (for example, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FreeMonoid.toList#doc\">docs#FreeMonoid.toList</a>) which allow you to convert from one to the other</p>",
        "id": 497879817,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1738757990
    },
    {
        "content": "<p>see for example <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FreeMonoid.countP%27#doc\">docs#FreeMonoid.countP'</a></p>",
        "id": 497879964,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1738758026
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/stream/113489-new-members/topic/How.20to.20cast.20types.20properly/near/497879964\">said</a>:</p>\n<blockquote>\n<p>see for example <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FreeMonoid.countP%27#doc\">docs#FreeMonoid.countP'</a></p>\n</blockquote>\n<p>Thank you for a nice example!</p>",
        "id": 497880471,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1738758207
    }
]