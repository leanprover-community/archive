[
    {
        "content": "<p>I'm not sure where this command is defined, so I'm not sure what's the right thing to feed it. If not, is the only way of debugging the <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/17423416377/job/49465942190?pr=29253\">error below</a> given by building all mathlib and then running the linter?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c\">/-</span><span class=\"cm\"> The `simpNF` linter reports:</span>\n<span class=\"cm\">SOME SIMP LEMMAS ARE NOT IN SIMP-NORMAL FORM.</span>\n<span class=\"cm\">see note [simp-normal form] for tips how to debug this.</span>\n<span class=\"cm\">https://leanprover-community.github.io/mathlib_docs/notes.html#simp-normal%20form -/</span>\n<span class=\"c1\">-- Mathlib.Combinatorics.SimpleGraph.Finite</span>\n<span class=\"n\">Error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">actions</span><span class=\"bp\">-</span><span class=\"n\">runner</span><span class=\"bp\">/_</span><span class=\"n\">work</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"bp\">/</span><span class=\"n\">pr</span><span class=\"bp\">-</span><span class=\"n\">branch</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Combinatorics</span><span class=\"bp\">/</span><span class=\"n\">SimpleGraph</span><span class=\"bp\">/</span><span class=\"n\">Finite</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">111</span><span class=\"o\">:</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">SimpleGraph</span><span class=\"bp\">.</span><span class=\"n\">edgeSet_univ_card</span><span class=\"w\"> </span><span class=\"n\">LINTER</span><span class=\"w\"> </span><span class=\"n\">FAILED</span><span class=\"o\">:</span>\n<span class=\"n\">simplify</span><span class=\"w\"> </span><span class=\"n\">fails</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">left</span><span class=\"bp\">-</span><span class=\"n\">hand</span><span class=\"w\"> </span><span class=\"n\">side</span><span class=\"o\">:</span>\n<span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">synthesize</span>\n<span class=\"w\">  </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"bp\">â†‘</span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">edgeSet</span>\n<span class=\"o\">(</span><span class=\"n\">deterministic</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">timeout</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"ss\">`typeclass</span><span class=\"bp\">`</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">maximum</span><span class=\"w\"> </span><span class=\"n\">number</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">heartbeats</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">20000</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">reached</span>\n</code></pre></div>",
        "id": 537408731,
        "sender_full_name": "Fernando Chu",
        "timestamp": 1756881079
    },
    {
        "content": "<p>Putting <code>#lint</code> at the end of the file should do the trick</p>",
        "id": 537409694,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1756881577
    },
    {
        "content": "<p>Thanks! However <code>#lint</code> succeeds locally, so is this just some weird CI business? What should I do?</p>",
        "id": 537410901,
        "sender_full_name": "Fernando Chu",
        "timestamp": 1756882209
    },
    {
        "content": "<p>The <code>simp</code>-normal form linter uses the whole environment.  If you put <code>#lint</code> at the end of the file, the whole environment is what has been built up to that file.  In CI, the whole environment also uses declarations that happen in <em>later</em> files and the check can fail later, but not fail on the file itself.</p>",
        "id": 537411329,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1756882403
    },
    {
        "content": "<p>I see, thanks! So that means I have to rebuild all of mathlib to debug this, that's a bit sad :'(</p>",
        "id": 537411508,
        "sender_full_name": "Fernando Chu",
        "timestamp": 1756882491
    },
    {
        "content": "<p>If you're lucky, you might have cache</p>",
        "id": 537411686,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1756882574
    },
    {
        "content": "<p>Looking at the failure, it seems like it is not an actual <code>simp</code>-NF exception, but rather that some change in the typeclass system causes a timeout and hence the <code>simp</code>-NF linter complains.</p>",
        "id": 537412789,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1756883072
    },
    {
        "content": "<p>Did you add some instances?</p>",
        "id": 537412803,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1756883079
    },
    {
        "content": "<p>The stated lemma does not seem to require any <code>Nonempty</code>ness...</p>",
        "id": 537412837,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1756883095
    },
    {
        "content": "<p>I had changed some instances yes, and by trial and error I figured out the offending ones. These shouldn't have been instances and should have been defs anyways so it's fine. Thanks!</p>",
        "id": 537520494,
        "sender_full_name": "Fernando Chu",
        "timestamp": 1756919092
    }
]