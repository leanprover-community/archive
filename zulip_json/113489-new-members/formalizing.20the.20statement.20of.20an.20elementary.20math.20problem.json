[
    {
        "content": "<p>I was toying with formalizing  some basic high school math problems from <a href=\"https://books.openbookpublishers.com/10.11647/obp.0181.pdf\">https://books.openbookpublishers.com/10.11647/obp.0181.pdf</a> </p>\n<p>Got stuck pretty quickly on formalizing the statement of this problem:</p>\n<p><a href=\"/user_uploads/3121/bf8rQOKJ53MnXwUHeI4AaT2Z/Screenshot-2025-10-09-at-11.47.35PM.png\">Screenshot 2025-10-09 at 11.47.35 PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/bf8rQOKJ53MnXwUHeI4AaT2Z/Screenshot-2025-10-09-at-11.47.35PM.png\" title=\"Screenshot 2025-10-09 at 11.47.35 PM.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"583x297\" src=\"/user_uploads/thumbnail/3121/bf8rQOKJ53MnXwUHeI4AaT2Z/Screenshot-2025-10-09-at-11.47.35PM.png/840x560.webp\"></a></div><p>my attempt, which doesn't compile</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hn</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hn</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))))</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">∧</span>\n<span class=\"w\">    </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">∧</span>\n<span class=\"w\">    </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Is there a way bake in the <code>2 ≤ n</code> proof, so I can write <code>x 0</code> and <code>x 1</code> without errors.</p>",
        "id": 544097773,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1760079007
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NeZero</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hn</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hn</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">ofNat</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)))))</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">∧</span>\n<span class=\"w\">    </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">∧</span>\n<span class=\"w\">    </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>seems to work</p>",
        "id": 544098636,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1760079462
    },
    {
        "content": "<p><code>i + 1</code> means <code>i + 1 % n</code></p>",
        "id": 544132538,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760091148
    },
    {
        "content": "<p>since it's <code>Fin</code></p>",
        "id": 544132660,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760091189
    },
    {
        "content": "<p>Oh yeah, you can just write <code>x (i + 1)</code>. I was just trying to fix the code upthread</p>",
        "id": 544135019,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1760092020
    },
    {
        "content": "<p>also your associativity is wrong <code>a / b * c</code> means <code>(a / b) * c</code></p>",
        "id": 544135344,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760092134
    },
    {
        "content": "<blockquote>\n<p><code>i + 1</code> means <code>i + 1 % n</code></p>\n</blockquote>\n<p>oh, i didn't know that. Why just adding <code>[NeZero n]</code> makes all of these errors go away?<br>\n<a href=\"/user_uploads/3121/dEe_UswjbPWoZIlBphQ2NCx_/Screenshot-2025-10-10-at-7.46.50AM.png\">Screenshot 2025-10-10 at 7.46.50 AM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/dEe_UswjbPWoZIlBphQ2NCx_/Screenshot-2025-10-10-at-7.46.50AM.png\" title=\"Screenshot 2025-10-10 at 7.46.50 AM.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1336x230\" src=\"/user_uploads/thumbnail/3121/dEe_UswjbPWoZIlBphQ2NCx_/Screenshot-2025-10-10-at-7.46.50AM.png/840x560.webp\"></a></div>",
        "id": 544187605,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1760107646
    },
    {
        "content": "<p>because there is no 1 in Fin 0 (indeed there is nothing in Fin 0)</p>",
        "id": 544187669,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760107669
    },
    {
        "content": "<p>I see, this is a great example of why <code>[NeZero n]</code> is useful, instead of explicit <code>h: n &gt; 0</code> which I assume will have to manually be passed everywhere.</p>",
        "id": 544187876,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1760107728
    },
    {
        "content": "<p>You don't have to manually pass it <em>everywhere</em>, you can do <code>have : NeZero n := ⟨Nat.ne_zero_of_lt h⟩</code> and then you can automatically pass it to other functions that already take <code>[NeZero n]</code>, like <code>Fin</code> coercion.</p>",
        "id": 544190106,
        "sender_full_name": "Vilim Lendvaj",
        "timestamp": 1760108356
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"976673\">Vilim Lendvaj</span> <a href=\"#narrow/channel/113489-new-members/topic/formalizing.20the.20statement.20of.20an.20elementary.20math.20problem/near/544190106\">said</a>:</p>\n<blockquote>\n<p>You don't have to manually pass it <em>everywhere</em>, you can do <code>have : NeZero n := ⟨Nat.ne_zero_of_lt h⟩</code> and then you can automatically pass it to other functions that already take <code>[NeZero n]</code>, like <code>Fin</code> coercion.</p>\n</blockquote>\n<p>How and where (before?) would you put this in the statement of the theorem?</p>",
        "id": 544299302,
        "sender_full_name": "Thomas Preu",
        "timestamp": 1760170607
    },
    {
        "content": "<p>with the other assumptions</p>",
        "id": 544299319,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760170635
    },
    {
        "content": "<p>OK, so as in the post of Ruben Van de Velde above. This is not supposed to be something global, is it?<br>\nBut that only applies to <code>[NeZero n]</code>, but not to <code>have : NeZero n := ⟨Nat.ne_zero_of_lt h⟩</code>, correct?</p>",
        "id": 544299457,
        "sender_full_name": "Thomas Preu",
        "timestamp": 1760170810
    },
    {
        "content": "<p>yes</p>",
        "id": 544299615,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760170960
    },
    {
        "content": "<p>OK, so where would you use <code>have : NeZero n := ⟨Nat.ne_zero_of_lt h⟩</code> then?</p>",
        "id": 544299656,
        "sender_full_name": "Thomas Preu",
        "timestamp": 1760171009
    },
    {
        "content": "<p>when lean complains that it doesn't know NeZero n</p>",
        "id": 544299778,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760171123
    },
    {
        "content": "<p>The statement above starts with <code>theorem p2 {n: ℕ} [NeZero n] (x: Fin n → ℝ) (hn: 2 ≤ n) </code><br>\nWill <code>[NeZero n]</code> be inferred from Hypothesis <code>hn</code>? Does the order matter or should <code>hn</code>come before <code>[NeZero n]</code>?</p>",
        "id": 544300488,
        "sender_full_name": "Thomas Preu",
        "timestamp": 1760171824
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"680252\">Thomas Preu</span> <a href=\"#narrow/channel/113489-new-members/topic/formalizing.20the.20statement.20of.20an.20elementary.20math.20problem/near/544300488\">said</a>:</p>\n<blockquote>\n<p>Will <code>[NeZero n]</code> be inferred from Hypothesis <code>hn</code></p>\n</blockquote>\n<p>you can't prove an assumption in the assumptions</p>",
        "id": 544300600,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760171946
    },
    {
        "content": "<p>the order does not matter, because they are independent</p>",
        "id": 544300609,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760171958
    },
    {
        "content": "<p>Does this mean that <code>have : NeZero n := ⟨Nat.ne_zero_of_lt h⟩</code> has to be supplied in the proof, where there is only <code>sorry</code> now?</p>",
        "id": 544300791,
        "sender_full_name": "Thomas Preu",
        "timestamp": 1760172142
    },
    {
        "content": "<p>I'm not sure what your code looks like now, so that's hard to answer :)</p>",
        "id": 544313288,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1760183792
    },
    {
        "content": "<p>As a rule of thumb, you can't derive typeclass arguments (<code>[Blah]</code>) from normal arguments (<code>(h : Foo)</code>)</p>",
        "id": 544313339,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1760183840
    },
    {
        "content": "<p>I did not work with type classes so far and was completely lost on how to use them. So I curiously inquired where this have-clause would be placed. Still don't have a clue, possibly to the extent that I can't explain my loss of understanding sufficiently.</p>",
        "id": 544331835,
        "sender_full_name": "Thomas Preu",
        "timestamp": 1760198850
    },
    {
        "content": "<p>The best way to ask a question is to post some code instead of writing sentences</p>",
        "id": 544332317,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1760199276
    },
    {
        "content": "<blockquote>\n<p>The statement above starts with <code>theorem p2 {n: ℕ} [NeZero n] (x: Fin n → ℝ) (hn: 2 ≤ n)</code><br>\nWill <code>[NeZero n]</code> be inferred from Hypothesis <code>hn</code>? Does the order matter or should <code>hn</code>come before <code>[NeZero n]</code>?</p>\n</blockquote>\n<p>I think there might be some confusion here... there's no need to infer it from <code>hn</code> because you already stated it as an assumption. It's not like <code>[NeZero n]</code> means \"I can prove <code>n</code> is not zero\". It means \"<code>n</code> is not zero\".</p>",
        "id": 544336926,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1760203855
    }
]