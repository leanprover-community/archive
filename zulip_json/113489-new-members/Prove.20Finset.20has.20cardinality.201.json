[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">}</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>How do you prove this? I tried proving <code>{x ∈ s | x = a} = {a}</code>, but no luck</p>",
        "id": 542659562,
        "sender_full_name": "Nathan",
        "timestamp": 1759384864
    },
    {
        "content": "<p>If you can prove <code>{x ∈ s | x = a} = {a}</code>, then I believe <code>simp</code> should give you result. To prove <code>{x ∈ s | x = a} = {a}</code>, you can use the <code>ext</code> tactic.</p>",
        "id": 542663592,
        "sender_full_name": "Yongxi Lin (Aaron)",
        "timestamp": 1759387067
    },
    {
        "content": "<p>I guessed that there would be a <code>Finset.card_filter</code> lemma, then <code>simp</code> turned out to basically prove it.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">}</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">card_filter</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"n\">assumption</span>\n</code></pre></div>\n<p>The proof can be compressed to <code>simp [Finset.card_filter, h]</code>.</p>",
        "id": 542674699,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1759391288
    },
    {
        "content": "<p>thanks!</p>",
        "id": 542748133,
        "sender_full_name": "Nathan",
        "timestamp": 1759413317
    },
    {
        "content": "<p>Why does this work though? Finset.card_filter changes it to a sum, why is that better?</p>",
        "id": 542828677,
        "sender_full_name": "Nathan",
        "timestamp": 1759438027
    },
    {
        "content": "<p>If you replace <code>simp</code> by <code>simp?</code>, it shows what lemmas were used:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">sum_ite_eq'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ite_eq_left_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">zero_ne_one</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">imp_false</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Decidable</span><span class=\"bp\">.</span><span class=\"n\">not_not</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 542830539,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1759438803
    },
    {
        "content": "<p>So notably <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finset.sum_ite_eq%27#doc\">docs#Finset.sum_ite_eq'</a> shows there's at most one term that contributes to the sum</p>",
        "id": 542830674,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1759438862
    },
    {
        "content": "<p>oh yeah that would do it</p>",
        "id": 542830941,
        "sender_full_name": "Nathan",
        "timestamp": 1759438980
    },
    {
        "content": "<p>it should be possible with ext too, right? i was struggling to show a ∈ {a}. maybe i'll take another look</p>",
        "id": 542831125,
        "sender_full_name": "Nathan",
        "timestamp": 1759439074
    },
    {
        "content": "<blockquote>\n<p>i was struggling to show a ∈ {a}</p>\n</blockquote>\n<p>you can use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finset.mem_singleton_self#doc\">docs#Finset.mem_singleton_self</a> if you're talking about Finset singletons (there's a separate lemma for sets)</p>",
        "id": 542833801,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1759440527
    },
    {
        "content": "<p>thanks!</p>",
        "id": 542835122,
        "sender_full_name": "Nathan",
        "timestamp": 1759441408
    },
    {
        "content": "<p>can simp and rw be used on the constants in the context, or only on the goal?</p>",
        "id": 542837183,
        "sender_full_name": "Nathan",
        "timestamp": 1759442699
    },
    {
        "content": "<p><code>simp ... at &lt;hypothesis&gt;</code>, <code>rw ... at &lt;hypothesis&gt;</code> for hypothesis in the context.</p>",
        "id": 542837363,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1759442819
    },
    {
        "content": "<p>oh awesome</p>",
        "id": 542837468,
        "sender_full_name": "Nathan",
        "timestamp": 1759442891
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">}</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">t</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Iff</span><span class=\"bp\">.</span><span class=\"n\">intro</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">ts</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">ts</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ts</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">mem_singleton_self</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">ta</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">ta</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span>\n<span class=\"w\">      </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>getting there... am i on the right track?</p>",
        "id": 542838161,
        "sender_full_name": "Nathan",
        "timestamp": 1759443384
    },
    {
        "content": "<p>you can just <code>simp</code> it</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">}</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">ext_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">this</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 542838524,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759443584
    },
    {
        "content": "<p><span aria-label=\"astonished\" class=\"emoji emoji-1f632\" role=\"img\" title=\"astonished\">:astonished:</span></p>",
        "id": 542840370,
        "sender_full_name": "Nathan",
        "timestamp": 1759444625
    },
    {
        "content": "<p><code>rfl</code> there is not great, especially given that <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finset.card_singleton#doc\">docs#Finset.card_singleton</a> is right there</p>",
        "id": 542840513,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1759444720
    },
    {
        "content": "<p>the thing i've been thinking about regarding tactics is, when changes are made it could break people's code</p>",
        "id": 542845223,
        "sender_full_name": "Nathan",
        "timestamp": 1759447022
    },
    {
        "content": "<p>why do you have to open classical to use excluded middle, but not for Nat.lt_trichotomy?</p>",
        "id": 542858897,
        "sender_full_name": "Nathan",
        "timestamp": 1759458920
    },
    {
        "content": "<p>i'm working on a proof that's currently 241 lines, which i fully expect to be reduced to like 20 lines if someone takes a look at it <span aria-label=\"joy\" class=\"emoji emoji-1f602\" role=\"img\" title=\"joy\">:joy:</span></p>",
        "id": 542858995,
        "sender_full_name": "Nathan",
        "timestamp": 1759459001
    },
    {
        "content": "<p>thanks for the tip earlier, Aaron</p>",
        "id": 542859077,
        "sender_full_name": "Nathan",
        "timestamp": 1759459084
    },
    {
        "content": "<p>I don't think you have to open classical to use excluded middle</p>",
        "id": 542870035,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1759468949
    },
    {
        "content": "<p>you can just use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=em#doc\">docs#em</a> ... it uses choice under the hood, but you don't have to <code>open classical</code> to take advantage of that</p>",
        "id": 542870189,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1759469079
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"968025\">Nathan</span> <a href=\"#narrow/channel/113489-new-members/topic/Prove.20Finset.20has.20cardinality.201/near/542858897\">said</a>:</p>\n<blockquote>\n<p>why do you have to open classical to use excluded middle, but not for Nat.lt_trichotomy?</p>\n</blockquote>\n<p>the first part is not true, but the second part is because you can prove that particular instance of excluded middle without using the axiom</p>",
        "id": 542909688,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759485392
    },
    {
        "content": "<p>when we say choiceless lean rejects excluded middle, it doesn't mean every instance of excluded middle is literally false; some instances can still be proved</p>",
        "id": 542909809,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759485426
    },
    {
        "content": "<p>what <code>open Classical</code> does is enable <code>if then else</code> for any condition</p>",
        "id": 542910248,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759485560
    }
]