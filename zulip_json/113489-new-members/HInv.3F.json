[
    {
        "content": "<p>Is there a heterogeneous inverse type? I expected to find <code>HInv</code> along with <code>HPow</code>, but I could not find one.</p>",
        "id": 504161812,
        "sender_full_name": "Ben Selfridge",
        "timestamp": 1741373396
    },
    {
        "content": "<p>How would that work, given that inv is a unary function? What would be heterogenous about it?</p>",
        "id": 504162361,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1741373558
    },
    {
        "content": "<p>Takes an <code>α</code>, returns a <code>β</code></p>",
        "id": 504162785,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741373705
    },
    {
        "content": "<p>And the return type would be inferred from the context? I think even for HFoo binary functions, the return type is usually constrained by the two input types.</p>",
        "id": 504163139,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1741373838
    },
    {
        "content": "<p>Ah, that makes sense. I figured if it didn't exist, there would have to be a reason.</p>",
        "id": 504163985,
        "sender_full_name": "Ben Selfridge",
        "timestamp": 1741374108
    },
    {
        "content": "<p>It could work if there were a way to encode functional dependencies or open type families in Lean, but I'm not sure if there is.</p>",
        "id": 504164240,
        "sender_full_name": "Ben Selfridge",
        "timestamp": 1741374180
    },
    {
        "content": "<p>Functional dependencies is approximated by <code>outParam</code></p>",
        "id": 504166470,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1741374866
    },
    {
        "content": "<p>but then you might as well have a plain <code>Inv X</code> and then <code>Coe X Y</code></p>",
        "id": 504166519,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1741374886
    },
    {
        "content": "<p>Oh, maybe I will try that then. I just want nice notation for the inverse of an isomorphism.</p>",
        "id": 504168325,
        "sender_full_name": "Ben Selfridge",
        "timestamp": 1741375499
    },
    {
        "content": "<p>(with an isomorphism type i'm custom defining for my own purposes)</p>",
        "id": 504168526,
        "sender_full_name": "Ben Selfridge",
        "timestamp": 1741375569
    },
    {
        "content": "<p>That's a nice example where a <code>Coe</code> wouldn't work</p>",
        "id": 504169434,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1741375868
    },
    {
        "content": "<p>Why wouldn't that work?</p>",
        "id": 504172270,
        "sender_full_name": "Ben Selfridge",
        "timestamp": 1741376881
    },
    {
        "content": "<p>Digging on this subject.  Could'nt we define HInv as :</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">HInv</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">outParam</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">hInv</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span>\n</code></pre></div>\n<p>Example usage, for Dimensional analysis :</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">δ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">δ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Repr</span><span class=\"w\"> </span><span class=\"n\">δ</span><span class=\"o\">]</span>\n\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">dim</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">δ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">δ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">    </span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">    </span><span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">Inhabited</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">BEq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">DecidableEq</span>\n\n<span class=\"kn\">instance</span><span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">Inv</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HInv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">    </span><span class=\"n\">hInv</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"bp\">⁻¹⟩</span>\n</code></pre></div>\n<p>Would it not work for everyone ? <br>\nThat what i want to do on my lib. But today it clash with <code>Inv</code> because the notation is not targetting <code>HInv</code>. For it to work we need this decl on Std so that notation is targeting <code>HInv</code> instead of Inv. And When defining an <code>Inv</code> have an instance of <code>HInv</code> automatically provided like for other <code>H&lt;Op&gt;</code> we have.</p>",
        "id": 537630516,
        "sender_full_name": "Alfredo Moreira-Rosa",
        "timestamp": 1756978422
    },
    {
        "content": "<p>And maybe the same could be done for <code>HNeg</code></p>",
        "id": 537631397,
        "sender_full_name": "Alfredo Moreira-Rosa",
        "timestamp": 1756978708
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"515652\">Ben Selfridge</span> <a href=\"#narrow/channel/113489-new-members/topic/HInv.3F/near/504168325\">said</a>:</p>\n<blockquote>\n<p>Oh, maybe I will try that then. I just want nice notation for the inverse of an isomorphism.</p>\n</blockquote>\n<p>but the inverse of an isomorphism is still an isomorphism? (i.e. i don't see why you need heterogeneous)</p>",
        "id": 537643704,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1756983074
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/113489-new-members/topic/HInv.3F/near/537643704\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"515652\">Ben Selfridge</span> <a href=\"#narrow/channel/113489-new-members/topic/HInv.3F/near/504168325\">said</a>:</p>\n<blockquote>\n<p>Oh, maybe I will try that then. I just want nice notation for the inverse of an isomorphism.</p>\n</blockquote>\n<p>but the inverse of an isomorphism is still an isomorphism? (i.e. i don't see why you need heterogeneous)</p>\n</blockquote>\n<p>The inverse of an isomorphism <code>FooEquiv α β</code> is a <code>FooEquiv β α</code> (which is a different type)</p>",
        "id": 537646229,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1756984107
    }
]