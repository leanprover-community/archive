[
    {
        "content": "<p>It seems we do not have topoi in mathlib, has anyone made progress or worked on formalizing them or is this something a person could work on? It seems there are no branches of mathlib with topoi or topos in the name at least.</p>",
        "id": 451225182,
        "sender_full_name": "Coleton Kotch",
        "timestamp": 1720903530
    },
    {
        "content": "<p><a href=\"#narrow/stream/284757-job-postings/topic/Join.20Huawei.20in.20Paris.20or.20London/near/443015853\">This</a> may interest you</p>",
        "id": 451227550,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1720905811
    },
    {
        "content": "<p>IIRC, there is no topos theory in mathlib4 at the moment.<br>\nApart from the mathlib4 repository:<br>\n<a href=\"https://github.com/b-mehta/topos\">Bhavik Mehta's topos repository</a></p>\n<blockquote>\n<p>This repository contains formal verification of results in Topos Theory, drawing from \"Sheaves in Geometry and Logic\" and \"Sketches of an Elephant\".</p>\n</blockquote>",
        "id": 451228394,
        "sender_full_name": "Nick Decroos",
        "timestamp": 1720906610
    },
    {
        "content": "<p>Yes, <span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span> is our local topos expert and you two should talk</p>",
        "id": 451297586,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1720931828
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"587941\">@Coleton Kotch</span> what do you want to do with topoi? If you‚Äôre happy to use Grothendieck topoi then you can just use the category of (type-valued) sheaves on a site for now.</p>",
        "id": 451358800,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1720967477
    },
    {
        "content": "<p>As far as I know, mathlib doesn‚Äôt yet know about subobject classifiers. I think that‚Äôs some low hanging fruit that someone could work on right away.</p>",
        "id": 451359125,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1720967839
    },
    {
        "content": "<p>I wasn‚Äôt looking at doing anything too fancy with topoi. I was thinking about aiming to formalize the etale fundamental group and felt we should probably have sites and Grothendieck topologies first.</p>",
        "id": 451682330,
        "sender_full_name": "Coleton Kotch",
        "timestamp": 1721106680
    },
    {
        "content": "<p>Those we do have.</p>",
        "id": 451692923,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1721113352
    },
    {
        "content": "<p>As well as a bunch of stuff on Galois categories</p>",
        "id": 451692946,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1721113371
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"587941\">Coleton Kotch</span> <a href=\"#narrow/stream/113489-new-members/topic/Topoi.20in.20Mathlib/near/451225182\">said</a>:</p>\n<blockquote>\n<p>It seems we do not have topoi in mathlib, has anyone made progress or worked on formalizing them or is this something a person could work on? It seems there are no branches of mathlib with topoi or topos in the name at least.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"587941\">@Coleton Kotch</span> <br>\nOur group has started a formalization of toposes and we're waiting for being granted permission to make the code open-source. In particular, we learned today the permission should be granted on July 26, then I will open a non-master branch to share our code. You will be welcome to participate if you wish so.</p>",
        "id": 452118028,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1721232483
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"125073\">@Anthony Bordg</span> Just to clarify: this will be <em>elementary toposes</em>?</p>",
        "id": 452265300,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1721286505
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/113489-new-members/topic/Topoi.20in.20Mathlib/near/452265300\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"125073\">Anthony Bordg</span> Just to clarify: this will be <em>elementary toposes</em>?</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span>  no, Grothendieck toposes.</p>",
        "id": 452278271,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1721290157
    },
    {
        "content": "<p>oh ok... but then mathlib has quite a lot already, right?</p>",
        "id": 452291942,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1721293722
    },
    {
        "content": "<p>We don't yet have Giraud's axioms in mathlib (yet), as far as I know. Maybe that's what <span class=\"user-mention\" data-user-id=\"125073\">@Anthony Bordg</span> and his group are working toward?</p>",
        "id": 452375798,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1721316713
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/113489-new-members/topic/Topoi.20in.20Mathlib/near/452291942\">said</a>:</p>\n<blockquote>\n<p>oh ok... but then mathlib has quite a lot already, right?</p>\n</blockquote>\n<p>Since a Grothendieck topos has infinitely many presentations, we do not want a definition tied to a specific presentation.</p>",
        "id": 452425644,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1721331152
    },
    {
        "content": "<p>I'm glad to announce that we were granted permission yesterday for making this project open-source and contribute our code to mathlib. I open a first PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/14908\">#14908</a>, hopefully more to come :)</p>",
        "id": 452571139,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1721396060
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"125073\">@Anthony Bordg</span> I left a few comments on your PR. The main points are: (1) the names you chose unfortunately don't follow mathlib's naming conventions. We have an explanation <a href=\"https://leanprover-community.github.io/contribute/naming.html\">here</a>. (2) A few proofs have nonterminal <code>simp</code>s, and several tactics on a single line, which, again, we try to avoid in mathlib. Some of these points are explained in <a href=\"https://leanprover-community.github.io/contribute/style.html\">this page</a>.</p>",
        "id": 452574607,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1721397121
    },
    {
        "content": "<p>In <a href=\"https://github.com/leanprover-community/mathlib4/blob/AnthonyBordg_covering_families/Mathlib/CategoryTheory/Sites/CoveringFamilies.lean\">CoveringFamilies</a>, I'm working on <code>CoveringFamilies.GeneratedTopology</code>, the Grothendieck topology <code>J</code> generated by a collection of covering families <code>cf</code> by the formula </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">sieves</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">cf</span><span class=\"bp\">.</span><span class=\"n\">basis</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">generate</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span>\n</code></pre></div>\n<p>I know how to prove <code>transitivity'</code> for <code>J</code> on paper, but I'm unsure how to proceed in Lean. Given <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi><mo>‚àà</mo><mi mathvariant=\"normal\">Œ©</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">R\\in \\Omega(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7224em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚àà</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">Œ©</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo>‚àà</mo><mi>J</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">S\\in J(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7224em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚àà</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span> such that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo>‚ãÜ</mo></msup><mo stretchy=\"false\">(</mo><mi>R</mi><mo stretchy=\"false\">)</mo><mo>‚àà</mo><mi>J</mi><mo stretchy=\"false\">(</mo><msup><mi>X</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f^\\star(R) \\in J(X&#x27;)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">‚ãÜ</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚àà</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">‚Ä≤</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> for every morphism <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo>:</mo><msup><mi>X</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">‚Ä≤</mo></msup><mo>‚Üí</mo><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">f: X&#x27; \\rightarrow X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">‚Ä≤</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>, there exists <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>f</mi></msub><mo>‚àà</mo><mtext>basis</mtext><mtext>‚Äâ</mtext><msup><mi>X</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">‚Ä≤</mo></msup></mrow><annotation encoding=\"application/x-tex\">Q_f \\in \\text{basis}\\, X&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚àà</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord text\"><span class=\"mord\">basis</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">‚Ä≤</span></span></span></span></span></span></span></span></span></span></span></span> satisfying <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>generate</mtext><mtext>‚Äâ</mtext><msub><mi>Q</mi><mi>f</mi></msub><mo>‚â§</mo><msup><mi>f</mi><mo>‚ãÜ</mo></msup><mo stretchy=\"false\">(</mo><mi>R</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{generate}\\, Q_f \\leq f^\\star(R)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord text\"><span class=\"mord\">generate</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚â§</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">‚ãÜ</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mclose\">)</span></span></span></span>, thus by <code>multicomposition_stable</code> we have <code>P.bind Q ‚àà basis X</code>, where <code>P</code> comes from the assumption <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo>‚àà</mo><mi>J</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">S\\in J(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7224em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚àà</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span> and <code>Q</code> is defined as </p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>Q</mi><mtext>‚Äâ</mtext><msup><mi>X</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">‚Ä≤</mo></msup><mtext>‚Äâ</mtext><mi>f</mi><mtext>‚Äâ</mtext><mo stretchy=\"false\">(</mo><mi>p</mi><mo>:</mo><mi>P</mi><mtext>‚Äâ</mtext><mi>f</mi><mo stretchy=\"false\">)</mo><mo>:</mo><mo>=</mo><msub><mi>Q</mi><mi>f</mi></msub><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">Q \\,X&#x27;\\, f\\, (p: P\\,f) := Q_f.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0519em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">‚Ä≤</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span></p>\n<p>Since <code>P.bind Q \\leq R</code>, one concludes <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi><mo>‚àà</mo><mi>J</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">R\\in J(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7224em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚àà</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span>. <br>\nHow to define <code>Q</code> in this situation in Lean?</p>",
        "id": 452982430,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1721567179
    },
    {
        "content": "<p>Is the <code>choose</code> tactic what you want?</p>",
        "id": 452992661,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1721572944
    },
    {
        "content": "<p>or, to avoid using tactics, the lemma <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Exists.choose#doc\">docs#Exists.choose</a> (along with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Exists.choose_spec#doc\">docs#Exists.choose_spec</a> )?</p>",
        "id": 452993146,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1721573205
    },
    {
        "content": "<p>Have you looked at <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Coverage.Saturate#doc\">docs#CategoryTheory.Coverage.Saturate</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Coverage.toGrothendieck%3F#doc\">docs#CategoryTheory.Coverage.toGrothendieck?</a> Your <code>CoveringFamilies</code> is a coverage (pullback-stable), so you might want to define <code>CoveringFamilies.GeneratedTopology</code> using this API, and then prove a theorem that the covering sieves are precisely the ones that contain a sieve of the form <code>generate P</code>¬†where <code>P</code> is in the basis. It's mathematically the same as proving that your <code>CoveringFamilies.GeneratedTopology</code> is a Grothendieck topology, but you will have access to the induction of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Coverage.Saturate#doc\">docs#CategoryTheory.Coverage.Saturate</a>, which might be convenient. </p>\n<p>For an example of how to use this API (the inductive principle) you could take a look at <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.extensiveTopology.mem_sieves_iff_contains_colimit_cofan#doc\">docs#CategoryTheory.extensiveTopology.mem_sieves_iff_contains_colimit_cofan</a></p>",
        "id": 453045230,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1721600367
    },
    {
        "content": "<p>Good to know! I will have a look as soon as possible.</p>",
        "id": 453161743,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1721650488
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Sites/Coverage.html#CategoryTheory.Coverage.toGrothendieck_eq_sInf\">CategoryTheory.Coverage.toGrothendieck_eq_sInf</a> is probably also relevant if you would like to switch to using coverages.</p>",
        "id": 453227885,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1721667228
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243562\">Adam Topaz</span> <a href=\"#narrow/stream/113489-new-members/topic/Topoi.20in.20Mathlib/near/452574607\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"125073\">Anthony Bordg</span> I left a few comments on your PR. The main points are: (1) the names you chose unfortunately don't follow mathlib's naming conventions. We have an explanation <a href=\"https://leanprover-community.github.io/contribute/naming.html\">here</a>. (2) A few proofs have nonterminal <code>simp</code>s, and several tactics on a single line, which, again, we try to avoid in mathlib. Some of these points are explained in <a href=\"https://leanprover-community.github.io/contribute/style.html\">this page</a>.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"243562\">@Adam Topaz</span> <span class=\"user-mention\" data-user-id=\"387244\">@Ya√´l Dillies</span> A big thank you. Leaned quite a lot during the process, hopefully will be smoother next time.  I'm going to rework covering families based on the API for coverages mentioned by <span class=\"user-mention\" data-user-id=\"519559\">@Dagur Asgeirsson</span> .</p>",
        "id": 453759832,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1721842971
    },
    {
        "content": "<p>Glad you didn't hate it <span aria-label=\"blush\" class=\"emoji emoji-1f60a\" role=\"img\" title=\"blush\">:blush:</span> I promise I will be less nasty next time <span aria-label=\"innocent\" class=\"emoji emoji-1f607\" role=\"img\" title=\"innocent\">:innocent:</span></p>",
        "id": 453764737,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1721844559
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"519559\">Dagur Asgeirsson</span> <a href=\"#narrow/stream/113489-new-members/topic/Topoi.20in.20Mathlib/near/453045230\">said</a>:</p>\n<blockquote>\n<p>Have you looked at <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Coverage.Saturate#doc\">docs#CategoryTheory.Coverage.Saturate</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Coverage.toGrothendieck%3F#doc\">docs#CategoryTheory.Coverage.toGrothendieck?</a> Your <code>CoveringFamilies</code> is a coverage (pullback-stable), so you might want to define <code>CoveringFamilies.GeneratedTopology</code> using this API, and then prove a theorem that the covering sieves are precisely the ones that contain a sieve of the form <code>generate P</code>¬†where <code>P</code> is in the basis. </p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"519559\">@Dagur Asgeirsson</span> Is it what you had in mind?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"w\"> </span><span class=\"n\">Sieve</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n\n<span class=\"c\">/-</span><span class=\"cm\">! ### The notion of covering families -/</span>\n\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">CoveringFamilies</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">Coverage</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">retraction_mem</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">‚ü∂</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">‚¶Ñ,</span><span class=\"w\"> </span><span class=\"n\">IsSplitEpi</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Presieve</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">X</span>\n<span class=\"w\">  </span><span class=\"n\">heredity</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Presieve</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">generate</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">X</span>\n<span class=\"w\">  </span><span class=\"n\">multicomposition_stable</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Presieve</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">Xi</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xi</span><span class=\"w\"> </span><span class=\"bp\">‚ü∂</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">‚¶Ñ,</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Presieve</span><span class=\"w\"> </span><span class=\"n\">Xi</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">hQ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">Xi</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xi</span><span class=\"w\"> </span><span class=\"bp\">‚ü∂</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">Xi</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">bind</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">X</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CoveringFamilies</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">CoveringFamilies</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">GeneratedTopology</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">GrothendieckTopology</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">cf</span><span class=\"bp\">.</span><span class=\"n\">toGrothendieck</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">covering_of_generatedTopology_iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sieve</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">GeneratedTopology</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">cf</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">sieves</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">cf</span><span class=\"bp\">.</span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">generate</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">admit</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">CoveringFamilies</span>\n</code></pre></div>",
        "id": 453782397,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1721850630
    },
    {
        "content": "<p>Yes, exactly</p>",
        "id": 453782677,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1721850743
    },
    {
        "content": "<p>Do you know why I'm unable to use <code>use Presieve.singleton (ùüô X); split</code> in the proof of the case <code>| top X</code> below</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">covering_of_generatedTopology_iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sieve</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">GeneratedTopology</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">cf</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">sieves</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">cf</span><span class=\"bp\">.</span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">generate</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">hS</span>\n<span class=\"w\">    </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">hS</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">hS</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hS</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">top</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">Presieve</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ùüô</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">cf</span><span class=\"bp\">.</span><span class=\"n\">retraction_mem</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">IsSplitEpi</span><span class=\"bp\">.</span><span class=\"n\">of_iso</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ùüô</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)),</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">generate_of_singleton_isSplitEpi</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ùüô</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)]</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">transitive</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">hS</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Sieve</span><span class=\"bp\">.</span><span class=\"n\">generate_sieve</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">arrows</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">cf</span><span class=\"bp\">.</span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">cf</span><span class=\"bp\">.</span><span class=\"n\">heredity</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Sieve</span><span class=\"bp\">.</span><span class=\"n\">generate_sieve</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">rcases</span><span class=\"w\"> </span><span class=\"n\">hS</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">P</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h1P</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h2P</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">      </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h1P</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">LE</span><span class=\"bp\">.</span><span class=\"n\">le</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">le_generate</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h2P</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Coverage</span><span class=\"bp\">.</span><span class=\"n\">Saturate</span><span class=\"bp\">.</span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">S</span>\n<span class=\"w\">    </span><span class=\"n\">simpa</span>\n</code></pre></div>",
        "id": 454020128,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1721931268
    },
    {
        "content": "<p>can you post a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> please?</p>",
        "id": 454024350,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1721932013
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Sites</span><span class=\"bp\">.</span><span class=\"n\">Coverage</span>\n\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"w\"> </span><span class=\"n\">Sieve</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">CoveringFamilies</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">Coverage</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">retraction_mem</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">‚ü∂</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">‚¶Ñ,</span><span class=\"w\"> </span><span class=\"n\">IsSplitEpi</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Presieve</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">X</span>\n<span class=\"w\">  </span><span class=\"n\">heredity</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Presieve</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">generate</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">X</span>\n<span class=\"w\">  </span><span class=\"n\">multicomposition_stable</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Presieve</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">Xi</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xi</span><span class=\"w\"> </span><span class=\"bp\">‚ü∂</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">‚¶Ñ,</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Presieve</span><span class=\"w\"> </span><span class=\"n\">Xi</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">hQ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">Xi</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xi</span><span class=\"w\"> </span><span class=\"bp\">‚ü∂</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">Xi</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">bind</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">X</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CoveringFamilies</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">GeneratedTopology</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">GrothendieckTopology</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">cf</span><span class=\"bp\">.</span><span class=\"n\">toGrothendieck</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">covering_of_generatedTopology_iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sieve</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">GeneratedTopology</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">cf</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">sieves</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">cf</span><span class=\"bp\">.</span><span class=\"n\">covering</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">generate</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">hS</span>\n<span class=\"w\">    </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">hS</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">hS</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hS</span>\n<span class=\"w\">    </span><span class=\"c1\">-- tactic 'split' failed, consider using `set_option trace.split.failure true`</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">top</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">Presieve</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ùüô</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">split</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">transitive</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 454026309,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1721932563
    },
    {
        "content": "<p>you should use <code>constructor</code> instead of <code>split</code> here</p>",
        "id": 454026597,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1721932688
    },
    {
        "content": "<p><code>split</code> is for breaking up <code>ite</code> and pattern matches.</p>",
        "id": 454026639,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1721932720
    },
    {
        "content": "<p>Is not <code>split</code> use for proving goal of the form <code>‚ä¢¬†P¬†‚àß¬†Q</code>?</p>",
        "id": 454028208,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1721933303
    },
    {
        "content": "<p>In lean3, but it doesn't something else entirely in lean4</p>",
        "id": 454029090,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1721933651
    },
    {
        "content": "<p>The equivalent tactic to lean3's split is lean4's constructor</p>",
        "id": 454029136,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1721933676
    },
    {
        "content": "<p>PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/15224\">#15224</a></p>",
        "id": 454616453,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1722176073
    },
    {
        "content": "<p>I have a conflict in <code>lake-manifest.json</code>.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span><span class=\"w\"> </span><span class=\"n\">AnthonyBordg_covering_families</span>\n<span class=\"w\">   </span><span class=\"s2\">\"rev\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"ac82ca1064a77eb76d37ae2ab2d1cdeb942d57fe\"</span><span class=\"o\">,</span>\n<span class=\"bp\">=======</span>\n<span class=\"w\">   </span><span class=\"s2\">\"rev\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"e7897807913fafdab31b01b9f627550bcc96cff2\"</span><span class=\"o\">,</span>\n<span class=\"bp\">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span><span class=\"w\"> </span><span class=\"n\">master</span>\n</code></pre></div>\n<p>What am I supposed to do ?</p>",
        "id": 454617113,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1722176612
    },
    {
        "content": "<p>Drop your change. I don't see why you would need to update <code>lake-manifest.json</code> in this PR?</p>",
        "id": 454617344,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1722176702
    },
    {
        "content": "<p>Indeed. Which line(s) to delete?</p>",
        "id": 454617710,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1722176850
    },
    {
        "content": "<p>If you've done <code>git merge</code>, the top ones. If you've done <code>git rebase</code>, the lower ones.</p>",
        "id": 454618183,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1722177048
    },
    {
        "content": "<p>Likely, keeping the one closest to <code>master</code> is the correct choice! <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 454619031,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1722177605
    },
    {
        "content": "<p>Done. Thanks.</p>",
        "id": 454619366,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1722177860
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"125073\">Anthony Bordg</span> <a href=\"#narrow/stream/113489-new-members/topic/Topoi.20in.20Mathlib/near/454616453\">said</a>:</p>\n<blockquote>\n<p>PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/15224\">#15224</a></p>\n</blockquote>\n<p>It's relatively short, ~80 lines of actual code <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span></p>",
        "id": 454899194,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1722274424
    },
    {
        "content": "<p>I left a few comments</p>",
        "id": 454935335,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1722283446
    },
    {
        "content": "<p>What would be a short, but not too short, first PR on toposes for quickly getting some feedback and for ease of handling PRs by reviewers? Probably not the def alone? What about the partial order on subtoposes of a given topos?</p>",
        "id": 455379056,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1722433594
    },
    {
        "content": "<p>Whenever you contribute something (say a definition of a topos), it's always good to try to relate it to existing notions in the library (if you define a typeclass <code>Topos</code>, this could for example be to give a <code>Topos (Sheaf J Type)</code>¬†instance). </p>\n<p>Note that relating your material to existing notions in the library doesn't need to happen in the same PR. However, it's good to point to it already in the initial PR (the way to do this is to open a big PR with the significant contribution, and then split it up into smaller PRs, referencing the big one to say \"look, this small contribution Y is useful to prove X\")</p>\n<p>It's difficult to suggest something to contribute without knowing what you have already formalized. Can you point to a public repo or is your code private?</p>",
        "id": 455381512,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1722434358
    },
    {
        "content": "<p>For example, if you had a followup PR to <a href=\"https://github.com/leanprover-community/mathlib4/pull/15224\">#15224</a> where <code>CoveringFamilies</code> is applied to do something which shows some advantage of it over <code>GrothendieckTopology</code>, we probably wouldn't be as hesitant to merge it.</p>",
        "id": 455383517,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1722434934
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"519559\">Dagur Asgeirsson</span> <a href=\"#narrow/stream/113489-new-members/topic/Topoi.20in.20Mathlib/near/455381512\">said</a>:</p>\n<blockquote>\n<p>Can you point to a public repo or is your code private?</p>\n</blockquote>\n<p>Will put some code soon in a non-master branch, since this is apparently the workflow.</p>",
        "id": 455569295,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1722495769
    },
    {
        "content": "<p>I'm wondering about the best workflow. <br>\nHaving a separate public Github repo, where collaborators can work in parallel on different files, and having a single non-master branch opened at any time on mathlib4 for the next submission ? Or no need for an external repo and just work with non-master branches, possibly a few opened simultaneously to work on files that are independent from each other or to limit the size of PRs? <br>\nSome inputs?</p>",
        "id": 455888621,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1722592136
    },
    {
        "content": "<p>The model I have been using for LeanAPAP, PFR, GibbsMeasure, etc... works great (for me and my collaborators). It consists of:</p>\n<ul>\n<li>a external public repository <code>MyProject</code> where everyone has push access (except in PFR where we worked with PRs).</li>\n<li>a <code>MyProject.Mathlib</code> folder mirroring the Mathlib arborescence. The rule is that file <code>MyProject.Mathlib.X</code> only imports <code>Mathlib.X</code> + possibly <code>MyProject.Mathlib.Y</code> where <code>Mathlib.X</code> transitively mports <code>Mathlib.Y</code>.</li>\n<li>a <code>MyProject.ForMathlib</code> folder containing code that should eventually be in Mathlib and is more or less ready for inclusion, but doesn't fit in an existing Mathlib file.</li>\n<li>The rest, containing the unfinished stuff along with the code that should never be in Mathlib.</li>\n</ul>",
        "id": 455891888,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1722593519
    },
    {
        "content": "<p>I would discourage you from using Mathlib branches for development as:</p>\n<ol>\n<li>They are harder to track than both a single external repo and open PRs.</li>\n<li>You can't host a blueprint alongside it.</li>\n<li>It's less externally visible. In particular it won't show up on Reservoir.</li>\n</ol>",
        "id": 455892545,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1722593808
    },
    {
        "content": "<p>This very much depends on the scale of the project. I should think branches are fine for smaller developments, for example my experiments with Frobenius elements are on a branch <a href=\"https://github.com/leanprover-community/mathlib4/pull/14155\">https://github.com/leanprover-community/mathlib4/pull/14155</a></p>",
        "id": 456150937,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722688820
    },
    {
        "content": "<p>Thank you Yael and Kevin for sharing your experience. Yesterday, I set up an external public repo <a href=\"https://github.com/AnthonyBordg/Topos-Theory\">Topos-Theory</a>.</p>",
        "id": 456220443,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1722717697
    },
    {
        "content": "<p>I sketched a definition of topos in the mwe below. <br>\nI want to prove that a category of sheaves is a topos. For this, and given my <code>presentation</code> field, I want to reuse the site that comes with this category of sheaves, but there is something fishy with universes, can someone help me figure out the explicit universe declarations required to fix this?</p>\n<div class=\"codehilite\" data-code-language=\"code\"><pre><span></span><code>import Mathlib.CategoryTheory.Sites.Sheaf\nimport Mathlib.CategoryTheory.Equivalence\n\nopen CategoryTheory\n\nvariable {C : Type*} [Category C]\n\n/-! ### Grothendieck toposes -/\n\nvariable [SmallCategory C] (J : GrothendieckTopology C)\n\nnamespace InducedPresentation\n\nvariable {E : Type*} [Category E] [LocallySmall E] (l : C ‚•§ E)\n\ntheorem isSheaf_of_induced_presentation (X : E) : Presheaf.IsSheaf J (l.op ‚ãô yoneda.obj X) := by admit\n\ndef inducedPresentation : E ‚•§ Sheaf J Type* where\n  obj := fun X =&gt; ‚ü®l.op ‚ãô yoneda.obj X, isSheaf_of_induced_presentation J l X‚ü©\n  map := fun f =&gt; ‚ü®whiskerLeft l.op (yoneda.map f)‚ü©\n\nend InducedPresentation\n\nopen InducedPresentation\n\nclass Topos (‚Ñ∞ : Type*) [Category ‚Ñ∞] [LocallySmall ‚Ñ∞] : Prop where\n  presentation : ‚àÉ (C : Type*) (_ : SmallCategory C) (J : GrothendieckTopology C) (l : C ‚•§ ‚Ñ∞),\n    Functor.IsEquivalence (inducedPresentation J l)\n\nvariable {A : Type*} [Category A]\n\ninstance : Topos (Sheaf J A) where\n  presentation := by\n  /- type mismatch C has type Type u_1 : Type (u_1 + 1) but is expected to have type Type u_4 : Type\n  (u_4 + 1)Lean 4 -/\n    use C\n</code></pre></div>\n<p>Also, since mathlib doesn't require the underlying category of a site to be small, I realise that some of the assumptions in the file, e.g. <code>SmallCategory C</code> or even <code>LocallySmall ‚Ñ∞</code>  may not be needed.</p>",
        "id": 456223021,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1722719918
    },
    {
        "content": "<p>I think that you need to clarify what to do with universes. Presumably, <code>Topos</code> should take only one universe parameter <code>u</code>, and a <code>Topos.{w}</code> should then be a category that is equivalent to <code>Sheaf J (Type w)</code> with <code>J</code> a Grothendieck topology on a small category <code>C : Type w</code>.</p>",
        "id": 456293342,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1722764352
    },
    {
        "content": "<p>(More precisely, if <code>E : Type u</code> and <code>Category.{v} E</code>,  then <code>E</code> satisfies <code>Topos.{w}</code> if it is equivalent to <code>Sheaf J (Type w)</code> for some <code>J</code> on a small category <code>C : Type w</code>.)</p>",
        "id": 456298839,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1722766607
    },
    {
        "content": "<p>Thank you, Joel.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"459699\">Jo√´l Riou</span> <a href=\"#narrow/stream/113489-new-members/topic/Topoi.20in.20Mathlib/near/456293342\">said</a>:</p>\n<blockquote>\n<p>I think that you need to clarify what to do with universes.</p>\n</blockquote>\n<p>Indeed! I'm not used to handling universes, but your answer helps.</p>\n<p>A few remarks:</p>\n<ul>\n<li>Mathlib doesn't require the underlying category of a site to be small, so I certainly can drop my hypothesis <code>[SmallCategory C]</code></li>\n<li>I believe <code>[LocallySmall E]</code> is not required here for <code>inducedPresentation</code> to be well-defined, contrary to what happens on paper, since one can specify the universe level as in <code>E ‚•§ Sheaf J (Type v)</code>.</li>\n<li>I should use <code>Type w</code> instead of <code>variable {A : Type w} [Category A]</code>, as you did, to avoid the unnecessary instance <code>Category A</code> and benefit from the instantiated categorical structure of <code>Type w</code>.</li>\n</ul>",
        "id": 456490182,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1722850216
    },
    {
        "content": "<p>I do not understand <code>isSheaf_of_induced_presentation</code>: without further assumptions, this seems wrong to me. Also, a category of sheaves in an arbitrary <code>A</code> may not be a topos in general.</p>\n<p>The definition I would do for <code>Topos</code> would be this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">universe</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">u</span>\n\n<span class=\"kd\">class</span><span class=\"w\"> </span><span class=\"n\">Topos</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">exists_equivalence</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SmallCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">GrothendieckTopology</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"bp\">‚âå</span><span class=\"w\"> </span><span class=\"n\">Sheaf</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">))</span>\n\n<span class=\"kd\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SmallCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">GrothendieckTopology</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Topos</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">w</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Sheaf</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">exists_equivalence</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">‚ü®</span><span class=\"n\">C</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">‚ü®</span><span class=\"n\">Equivalence.refl</span><span class=\"o\">‚ü©‚ü©</span>\n</code></pre></div>\n<p>This is SGA 4 IV 1.1.</p>\n<p>Using some work by <span class=\"user-mention\" data-user-id=\"519559\">@Dagur Asgeirsson</span> on equivalences of sheaf categories, we may get slightly more general instances (when the category <code>C</code> has more general universe parameters and <code>w</code> is a big enough universe), but for the <em>definition</em> of a topos, I believe this is the most correct definition.</p>",
        "id": 456495981,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1722851711
    },
    {
        "content": "<p>Why assuming that <code>C</code> is a small category if a category of sheaves in mathlib is not a category of presheaves on a small index category?</p>",
        "id": 456502743,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1722852894
    },
    {
        "content": "<p>The definition of the category of sheaves in mathlib doesn't require the defining site to be small, simply because the notion of a sheaf on a large site may be interesting/useful (e.g. condensed sets). However, you're trying to define what it means to be a Grothendieck topos, and indeed the standard definition there requires the defining site to be small. </p>\n<p>Is this not the definition you have in mind? It helps to have a clear mathematical idea beforehand of the concept you're trying to formalize.</p>",
        "id": 456504189,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1722853233
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"125073\">Anthony Bordg</span> <a href=\"#narrow/stream/113489-new-members/topic/Topoi.20in.20Mathlib/near/456502743\">said</a>:</p>\n<blockquote>\n<p>Why assuming that <code>C</code> is a small category if a category of sheaves in mathlib is not a category of presheaves on a small index category?</p>\n</blockquote>\n<p>If the category is large, e.g. <code>C : Type (u + 1)</code> and morphisms in <code>Type u</code> (or more), we may still consider the category of sheaves of <code>C</code> with values in <code>Type u</code>, but it may not behave properly (sheafification may involve colimits in <code>Type u</code> indexed by a category in <code>Type (u + 1)</code>, which may not exist). In mathlib, without universe assumptions, we have typeclasses asserting that it behaves not so badly (e.g. we have a sheafification functor). I believe not all such categories of sheaves deserve to be named topos, only those that are equivalent to a category of sheaves in the most favourable case should be (I am not expert in topos theory though). Then, for example, if <code>C</code> is a small category in <code>Type u</code>, we may consider the topos of sheaves with values in <code>Type u</code>, but we may also consider the category of sheaves with values in <code>Type (u + 1)</code>, which does not obviously satisfy my definition (for  <code>w := u + 1</code>), but as <code>C</code> is equivalent to a small category in <code>Type (u + 1)</code>, it shall satisfy my definition anyway thanks to Dagur's results in <code>CategoryTheory.Sites.Equivalence</code>.</p>",
        "id": 456532418,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1722861043
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459699\">Jo√´l Riou</span> <a href=\"#narrow/stream/113489-new-members/topic/Topoi.20in.20Mathlib/near/456495981\">said</a>:</p>\n<blockquote>\n<p>... I believe this is the most correct definition.</p>\n</blockquote>\n<p>I completely agree with this definition. Alternatively, one could formulate a definition using Giraud's axioms (and in fact this is what I thought <span class=\"user-mention\" data-user-id=\"125073\">@Anthony Bordg</span>  had in mind originally).</p>",
        "id": 456626892,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1722871347
    },
    {
        "content": "<p>Yes, this is also the definition I used in the topos project</p>",
        "id": 456875377,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1722955470
    },
    {
        "content": "<p>Is there a proposition <code>IsFullyFaithful</code> that corresponds to the type <code>FullyFaithful</code> in the same way there is a proposition <code>IsEquivalence</code> (in addition to the <code>Equivalence</code> type)?</p>",
        "id": 477198603,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1729080306
    },
    {
        "content": "<p>There is just <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Functor.Full#doc\">docs#CategoryTheory.Functor.Full</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Functor.Faithful#doc\">docs#CategoryTheory.Functor.Faithful</a></p>",
        "id": 477198784,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1729080363
    },
    {
        "content": "<p>no, <code>Full</code> contains the data of a preimage</p>",
        "id": 477198808,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1729080370
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243562\">Adam Topaz</span> <a href=\"#narrow/stream/113489-new-members/topic/Topoi.20in.20Mathlib/near/477198808\">said</a>:</p>\n<blockquote>\n<p>no, <code>Full</code> contains the data of a preimage</p>\n</blockquote>\n<p>Not anymore</p>",
        "id": 477198859,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1729080386
    },
    {
        "content": "<p>this is because it is often useful to have good defeq properties of the preimage</p>",
        "id": 477198873,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1729080389
    },
    {
        "content": "<p>OH!</p>",
        "id": 477198879,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1729080392
    },
    {
        "content": "<p><code>FullyFaithful</code> contains the data of a preimage</p>",
        "id": 477198922,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1729080404
    },
    {
        "content": "<p>I'm behind the times!</p>",
        "id": 477198923,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1729080404
    },
    {
        "content": "<p>BTW, I think <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Functor.IsEquivalence#doc\">docs#CategoryTheory.Functor.IsEquivalence</a> does still contain data?</p>",
        "id": 477199381,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1729080520
    },
    {
        "content": "<p>No it doesn't!</p>",
        "id": 477199402,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1729080528
    },
    {
        "content": "<p>Okay, I'm really behind the times here :)</p>",
        "id": 477199537,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1729080582
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459699\">Jo√´l Riou</span> <a href=\"#narrow/channel/113489-new-members/topic/Topoi.20in.20Mathlib/near/456495981\">said</a>:</p>\n<blockquote>\n<p>I do not understand <code>isSheaf_of_induced_presentation</code></p>\n</blockquote>\n<p>I finally found the time to come back to this. Is it clearer now? <a href=\"https://github.com/LMCRC/Topos-Theory/blob/master/ToposTheory/GrothendieckTopos.lean\">Link</a></p>",
        "id": 479258500,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1730116829
    },
    {
        "content": "<p>This seems unnecessarily complicated as a definition. What's wrong with using the definition suggested by Jo√´l, that being a <code>Topos</code> means that there exists an equivalence with a category of sheaves of sets on a small site? That definition gives you a fully faithful functor to presheaves, a left adjoint (sheafification), etc. </p>\n<p>If you want to go more in the direction of the approach you linked, then I think you mean something a bit different. Requiring the existence of a functor from the defining site to the topos seems too restrictive, don't you mean to just require the existence of a fully faithful functor to the category of presheaves? Not necessarily of the form <code>associatedFunctor</code></p>",
        "id": 479261564,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1730117740
    },
    {
        "content": "<p>At first glance, I thought you meant to write something like this with your definition of <code>IsPresentation</code>¬†</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Sites</span><span class=\"bp\">.</span><span class=\"n\">Equivalence</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">EssentialImage</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">Preserves</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u‚ÇÅ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v‚ÇÅ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SmallCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">GrothendieckTopology</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Presheaf</span><span class=\"w\"> </span><span class=\"n\">Functor</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">IsPresentation</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"bp\">‚•§</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"bp\">·µí·µñ</span><span class=\"w\"> </span><span class=\"bp\">‚•§</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">faithful</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"n\">Faithful</span>\n<span class=\"w\">  </span><span class=\"n\">full</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"n\">Full</span>\n<span class=\"w\">  </span><span class=\"n\">left_adjoint</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"bp\">·µí·µñ</span><span class=\"w\"> </span><span class=\"bp\">‚•§</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚•§</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">PreservesFiniteLimits</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">‚ä£</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">True</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span>\n</code></pre></div>\n<p>(although I would probably make the left adjoint part of the data of <code>IsPresentation</code>). </p>\n<p>But looking more closely it seems like your doing something different. Is your definition mathematically correct? Are you following a source?</p>",
        "id": 479263890,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1730118521
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"519559\">Dagur Asgeirsson</span> <a href=\"#narrow/channel/113489-new-members/topic/Topoi.20in.20Mathlib/near/479261564\">said</a>:</p>\n<blockquote>\n<p>This seems unnecessarily complicated as a definition. What's wrong with using the definition suggested by Jo√´l, that being a <code>Topos</code> means that there exists an equivalence with a category of sheaves of sets on a small site? [...] Are you following a source?</p>\n</blockquote>\n<p>It would be maybe a bit weird to talk for Laurent, the best is probably to invite him to share his motivations on this Zulip, something I will do.</p>",
        "id": 479314167,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1730132568
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"519559\">Dagur Asgeirsson</span> <a href=\"#narrow/channel/113489-new-members/topic/Topoi.20in.20Mathlib/near/479263890\">said</a>:</p>\n<blockquote>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">left_adjoint</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"bp\">·µí·µñ</span><span class=\"w\"> </span><span class=\"bp\">‚•§</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚•§</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">PreservesFiniteLimits</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">‚ä£</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">True</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span>\n</code></pre></div>\n<p>(although I would probably make the left adjoint part of the data of <code>IsPresentation</code>).</p>\n</blockquote>\n<p>A remark wrt this, one can show that the functor denoted <code>F</code> in my code is necessarily left adjoint to the functor <code>associatedFunctor l</code>.</p>",
        "id": 479316208,
        "sender_full_name": "Anthony Bordg",
        "timestamp": 1730133212
    },
    {
        "content": "<p>In any case, it seems much safer to use the very simple definition given above. The <code>IsPresentation</code> property may have certain merits (mostly, I see it as a complicated way to encode an equivalence with a sheaf category), but this cannot be <em>the</em> definition. With probably some small design modifications (to include some data rather than only properties as Dagur observed), this could be a structure for which we could have a constructor in order to prove the <code>Topos</code> property.</p>",
        "id": 479335199,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1730139430
    },
    {
        "content": "<p>I suggested this definition of toposes to Anthony Bordg because we need to distinguish the abstract level of toposes and the concrete constructive level of their presentations. A topos is abstract by nature (in the sense that its objects and morphisms are defined only axiomatically, not constructively in general) and cannot be made fully explicit but it can be presented from concrete data consisting in small categories endowed with a topology. In fact, it is even always possible to choose for any topos E presentation categories C which are fully explicit in the sense that their objects are indexed by simple combinatorial data and the Hom sets between arbitrary pairs of objects are finite and computable. When presenting a topos E in terms of such a category C, the natural functor l from C to E can also be made fully explicit. Whereas its extension as a functor from C^ to E preserving colimits cannot be considered explicit as the objects and morphisms in a presheaf category C^ are defined axiomatically, not by a constructive process. The functor l from C to E is the fundamental structure through which abstract topos-theoretic definitions and constructions can get concrete expressions in terms of C and its topology corresponding to E. A topos is a category which is too big and too rich to be known but which can be defined from fully constructive data through the abstract axiomatic definition of sheaves and sheaf morphisms on a site. Anthony and myself propose to formulate in this way the definition of toposes because, for computational purposes, we need to always distinguish between what can be made constructive and what cannot be made constructive.</p>",
        "id": 479475709,
        "sender_full_name": "Laurent Lafforgue",
        "timestamp": 1730207572
    },
    {
        "content": "<p>By the way, this is also why the definitions of the notion of Grothendieck topology on a category C in terms of covering sieves or in terms of covering families of morphisms (or \"presieves\") are both worth formulating. They are indeed axiomatically equivalent but not constructively equivalent as, in general, the sieve generated by a family of morphisms cannot be computed. When one wants to make computations on topologies, it appears that most of the time the definition in terms of covering families of morphisms (or presieves) is preferable. In fact, except for very particular cases, a sieve is usually presented in terms of a generating family of morphisms.</p>",
        "id": 479478446,
        "sender_full_name": "Laurent Lafforgue",
        "timestamp": 1730208381
    },
    {
        "content": "<p>We do have both: <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.GrothendieckTopology#doc\">docs#CategoryTheory.GrothendieckTopology</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Coverage#doc\">docs#CategoryTheory.Coverage</a></p>",
        "id": 479480723,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1730208727
    },
    {
        "content": "<p>If I understand correctly, given a presentation in Dagur's sense the functor <code>C -&gt; E</code> would be the composition of the yoneda embedding with <code>L</code> (which admittedly would be defined with choice if one formulates the definition as Dagur did, but one could instead add <code>L</code> and the adjunction to the data as Dagur suggests). The difference between this and the approach of starting with <code>C -&gt; E</code> is just in terms of the definitional properties of <code>C -&gt; E</code> vs the presentation in terms of presheaves. To be able to control the definitional properties of all functors involved, one <em>could</em> add them all as data and include various isomorphisms and properties ensuring compatibility. Then one could provide constructors which let you start with just <code>C -&gt; E</code>, or just <code>E -&gt; (C^op -&gt; Type)</code>, etc.</p>",
        "id": 479481737,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1730208885
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"519559\">Dagur Asgeirsson</span> <a href=\"#narrow/channel/113489-new-members/topic/Topoi.20in.20Mathlib/near/479480723\">said</a>:</p>\n<blockquote>\n<p>We do have both: <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.GrothendieckTopology#doc\">docs#CategoryTheory.GrothendieckTopology</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Coverage#doc\">docs#CategoryTheory.Coverage</a></p>\n</blockquote>\n<p>Additionally it's relatively straightforward to go back and forth between presieves and indexes families with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Presieve.ofArrows#doc\">docs#CategoryTheory.Presieve.ofArrows</a></p>",
        "id": 479482153,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1730208949
    },
    {
        "content": "<p>Regarding the definition of a topos: In mathlib, considerations like the ones you mention are not in general part of the <em>definition</em> of an object. We prefer simpler, more widely usable definitions. Then you can develop all the API you want around that definition</p>",
        "id": 479482884,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1730209056
    },
    {
        "content": "<p>If I understand correctly, a notion of \"coverage\" has to be stable under pull-back but is not required to verify the \"stability\" axiom of Grothendieck topologies. So the topology generated by a notion of coverage can have many more covering families than \"coverages\".</p>",
        "id": 479483103,
        "sender_full_name": "Laurent Lafforgue",
        "timestamp": 1730209083
    },
    {
        "content": "<p>Yes, but the sheaf condition can be checked on the covering families of the coverage</p>",
        "id": 479483499,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1730209148
    },
    {
        "content": "<p>That is this theorem: <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Sites/Coverage.html#CategoryTheory.Presieve.isSheaf_coverage\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Sites/Coverage.html#CategoryTheory.Presieve.isSheaf_coverage</a></p>",
        "id": 479486390,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1730209644
    },
    {
        "content": "<p>The general problem of provability in first-order geometric logic is constructively equivalent to the general problem of generating topologies from given families of morphisms (see for instance : <a href=\"https://www.oliviacaramello.com/Talks/DeductiveSystemsGrothendieckTopologies.pdf\">https://www.oliviacaramello.com/Talks/DeductiveSystemsGrothendieckTopologies.pdf</a>). This means that the difference between a notion of coverage and the generated notion of covering presieve cab be as deep as the difference between the axioms of a first-order geometric theory and the results which can be provably deduced from these axioms.</p>",
        "id": 479486727,
        "sender_full_name": "Laurent Lafforgue",
        "timestamp": 1730209739
    },
    {
        "content": "<p>The Grothendieck topology generated by a coverage is defined inductively in mathlib, unlike the definition one usually finds in books. This is probably much closer to the ‚Äúprovability‚Äù point of view.</p>",
        "id": 479489335,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1730210539
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"519559\">Dagur Asgeirsson</span> <a href=\"#narrow/channel/113489-new-members/topic/Topoi.20in.20Mathlib/near/479482884\">said</a>:</p>\n<blockquote>\n<p>you</p>\n</blockquote>\n<p>The Lean formalization system is intended for machine processing.<br>\nFor machine computing, the distinction between what is constructive and what is not constructive seems very important.</p>",
        "id": 479491495,
        "sender_full_name": "Laurent Lafforgue",
        "timestamp": 1730211176
    },
    {
        "content": "<p>Lean can also be used for computing. That‚Äôs not the focus of mathlib, but it is possible to do computations with the category theory library if one sets up the definitions in a suitable way</p>",
        "id": 479492826,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1730211574
    },
    {
        "content": "<p>Yes, and there can be an abstract <em>definition</em> of what is a topos, and at the same time, for more constructive definitions/theorems, the input could be a functor <code>C ‚•§ E</code> (+ some extra data and properties packaged in a <code>ToposPresentation</code> structure).</p>",
        "id": 479512528,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1730217096
    }
]