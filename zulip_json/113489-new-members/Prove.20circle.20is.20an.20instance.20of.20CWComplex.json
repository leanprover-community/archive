[
    {
        "content": "<p>Hello, I am trying to prove that the unit circle in the complex plane is an instance of the CWComplex, but am having some trouble. <br>\nFor the unit circle, I use the existing definition in <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Complex/Circle.html\">Mathlib.Analysis.Complex.Circle</a>, and the for CWComplex, I use the existing class in <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/CWComplex/Classical/Basic.html#Topology.CWComplex\">Mathlib.Topology.CWComplex.Classical.Basic</a>.</p>\n<p>Here is my current code:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">Circle</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">CWComplex</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">autoImplicit</span><span class=\"w\"> </span><span class=\"n\">false</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">Metric</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"w\"> </span><span class=\"n\">Topology</span>\n\n<span class=\"sd\">/-- The indexing type for the cells of S¹.</span>\n<span class=\"sd\">We have one 0-cell and one 1-cell.</span>\n<span class=\"sd\">-/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">S1Cell</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CWComplex</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">univ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Circle</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">    </span><span class=\"sd\">/-- The indexing type of the cells of dimension `n`. -/</span>\n<span class=\"w\">  </span><span class=\"n\">cell</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The characteristic map of the `n`-cell given by the index `i`.</span>\n<span class=\"sd\">  This map is a bijection when restricting to `ball 0 1`, where we consider `(Fin n → ℝ)`</span>\n<span class=\"sd\">  endowed with the maximum metric. -/</span>\n<span class=\"w\">  </span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cell</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PartialEquiv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Already at the line <code>instance : CWComplex (univ : Set Circle) </code>, Lean complains that</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"k\">at</span>\n<span class=\"w\">  </span><span class=\"n\">CWComplex</span>\n<span class=\"n\">term</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">198</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>To solve this, I typed <code>#check CWComplex</code>, which gave me</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">CWComplex</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>but I don't know how to proceed.</p>",
        "id": 547865641,
        "sender_full_name": "Hank",
        "timestamp": 1761809189
    },
    {
        "content": "<p>Hello, <br>\nGlad to see you are interested in CW complexes in Lean! So I don't know which version of Mathlib you are on to get this error. When I open this in the Lean playground I get a complaint that <code>Mathlib.Topology.CWComplex</code> does not exist because as you note in your message the correct file would be <code>Mathlib.Topology.CWComplex.Classical.Basic</code>.  And to be able to just write <code>CWComplex</code> instead of  <code>Topology.CWComplex</code> I think you need to have <code>open Topology</code> not just <code>open scoped Topology</code>. </p>\n<p>I actually have code on the CW structure on spheres in real euclidean space <a href=\"https://github.com/scholzhannah/CWComplexes/blob/master/CWcomplexes/Examples.lean\">here</a> but it is unfortunatly still far from polished. (This is not to discourage you to try this, just as a reference.)</p>",
        "id": 547874244,
        "sender_full_name": "Hannah Scholz",
        "timestamp": 1761812794
    },
    {
        "content": "<p>Hello Hannah,<br>\nYes, it is probably due to different versions. I was writing the code in <code>lean4:v4.17.0-rc1</code>. I created a new project using the recent version <code>lean4:v4.25.0-rc2</code> and pasted my code there. Then things happened just like what you said. <br>\nAlso, thank you for sharing your CW complex project! It is very cool!</p>",
        "id": 548269929,
        "sender_full_name": "Hank",
        "timestamp": 1761966400
    }
]