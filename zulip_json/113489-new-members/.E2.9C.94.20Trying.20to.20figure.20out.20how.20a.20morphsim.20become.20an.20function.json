[
    {
        "content": "<p>Hi everyone. Is there an coercion before the f below applied to 0?  If so, how can I see it in the infoview? Thanks.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Comma</span><span class=\"bp\">.</span><span class=\"n\">Arrow</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Types</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Comma</span><span class=\"bp\">.</span><span class=\"n\">Over</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Functor</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Opposite</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Equivalence</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">trace</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">synthInstance</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">trace</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">FunInd</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">all</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">coercions</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n</code></pre></div>",
        "id": 472282013,
        "sender_full_name": "Shujian Yan",
        "timestamp": 1727110199
    },
    {
        "content": "<p>Why do you think there is a coercion? <code>f</code>is a honest function and you're applying it to a <code>Nat</code>...</p>",
        "id": 472282295,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1727110273
    },
    {
        "content": "<p>Indeed, the infoview simply displays <code>f 0</code>.</p>",
        "id": 472282335,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1727110286
    },
    {
        "content": "<p>Ah, I see. It is a morphism!</p>",
        "id": 472282432,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1727110319
    },
    {
        "content": "<p>i don't think this is coersion, this is defeq?</p>",
        "id": 472282951,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727110477
    },
    {
        "content": "<p>see also:<br>\n<a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.types#doc\">docs#CategoryTheory.types</a></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 472283290,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727110562
    },
    {
        "content": "<p>In particular <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.types_hom#doc\">docs#CategoryTheory.types_hom</a></p>",
        "id": 472284367,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1727110877
    },
    {
        "content": "<p>(whose proof is <code>rfl</code>, as <span class=\"user-mention\" data-user-id=\"684366\">@Edward van de Meent</span> points out).</p>",
        "id": 472284437,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1727110899
    },
    {
        "content": "<p>thinking about it, i think every (proven) equality is defeq in lean, but that's slightly besides the point</p>",
        "id": 472284743,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727111002
    },
    {
        "content": "<p>Here'a an example that's not defeq.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Comma</span><span class=\"bp\">.</span><span class=\"n\">Arrow</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Types</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Comma</span><span class=\"bp\">.</span><span class=\"n\">Over</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Functor</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Opposite</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Equivalence</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">trace</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">synthInstance</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">trace</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">FunInd</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">all</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">coercions</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">a</span>\n</code></pre></div>",
        "id": 472285381,
        "sender_full_name": "Shujian Yan",
        "timestamp": 1727111198
    },
    {
        "content": "<p><del>But pay attention that in your first example <code>Nat</code> was not a category, it was an object of the category <code>Type</code> of types.</del></p>",
        "id": 472285589,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1727111271
    },
    {
        "content": "<p>in the second example it still is, i don't see your point?</p>",
        "id": 472285733,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727111314
    },
    {
        "content": "<p>Oh right, forget my comment.</p>",
        "id": 472285864,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1727111359
    },
    {
        "content": "<p>if you want a morphism in a category of categories, you can't use any <code>t:Type</code> as domain/codomain for your morphism... for that, you need to work with <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Category/Cat.html#CategoryTheory.Cat\">CategoryTheory.Cat</a></p>",
        "id": 472286092,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727111422
    },
    {
        "content": "<p>(using <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Category/Cat.html#CategoryTheory.Cat.of\">CategoryTheory.Cat.of</a> to turn <code>Nat:Type</code> into the corresponding object in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>Cat</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{Cat}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">Cat</span></span></span></span></span>)</p>",
        "id": 472286252,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727111481
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20figure.20out.20how.20a.20morphsim.20become.20an.20function/near/472282951\">said</a>:</p>\n<blockquote>\n<p>i don't think this is coersion, this is defeq?</p>\n</blockquote>\n<p>It can be a coercion even if the types are defeq. Sometimes coercions are inserted just to change the syntactic form of a type, since different typeclasses and simp lemmas could apply. In this case though, one can verify that there's no CoeFun instance being searched for.</p>",
        "id": 472286432,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1727111525
    },
    {
        "content": "<p>it doesn't even search for it?</p>",
        "id": 472286672,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727111572
    },
    {
        "content": "<p>does the elaborator always try to fully reduce the type before searching for coersion?</p>",
        "id": 472286966,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727111653
    },
    {
        "content": "<p>When the elaborator encounters a function application, it tries to reduce the function's type to whnf to get a pi type. If that fails, it searches for a CoeFun instance.</p>",
        "id": 472287552,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1727111836
    },
    {
        "content": "<p>right, that makes sense. (i indeed seem to recall reading in the <code>CoeFun</code> documentation that search begins when a type error is raised, or something like that)</p>",
        "id": 472287765,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727111895
    },
    {
        "content": "<p>In retrospect, your rfl check that the type is <code>Nat -&gt; Nat</code> was correct. This does mean there is no coercion here :-)</p>",
        "id": 472288556,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1727112133
    },
    {
        "content": "<p>I thought for a while, this exmaple is ok for my purpose.</p>",
        "id": 472288594,
        "sender_full_name": "Shujian Yan",
        "timestamp": 1727112144
    },
    {
        "content": "<p>Sorry for the slow reply. I'm bad at writing.</p>",
        "id": 472288998,
        "sender_full_name": "Shujian Yan",
        "timestamp": 1727112280
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20figure.20out.20how.20a.20morphsim.20become.20an.20function/near/472286432\">said</a>:</p>\n<blockquote>\n<p>It can be a coercion even if the types are defeq</p>\n</blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20figure.20out.20how.20a.20morphsim.20become.20an.20function/near/472287552\">said</a>:</p>\n<blockquote>\n<p>When the elaborator encounters a function application, it tries to reduce the function's type to whnf to get a pi type.</p>\n</blockquote>\n<p>i don't think these agree? if <code>Foo</code> is defeq to some <code>A -&gt; B</code>, surely reducing to whnf must find that fact, and therefore it never searches for a coersion?</p>",
        "id": 472289097,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727112314
    },
    {
        "content": "<p>from what i can tell, it can only be a coersion if somehow <code>Foo : Type u</code> is wrong, triggering a <code>CoeSort</code> search first? something like that?</p>",
        "id": 472289369,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727112397
    },
    {
        "content": "<p>The second example is not defeq. There must be some kind of coe, right?</p>",
        "id": 472289430,
        "sender_full_name": "Shujian Yan",
        "timestamp": 1727112418
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"735478\">Shujian Yan</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20figure.20out.20how.20a.20morphsim.20become.20an.20function/near/472285381\">said</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">a</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>even in this example, it is defeq. like i said, this is because the morphism <code>f</code> is not a morphism in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>Cat</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{Cat}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">Cat</span></span></span></span></span> but a morphism in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>Type</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{Type}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">Type</span></span></span></span></span></p>",
        "id": 472289745,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727112508
    },
    {
        "content": "<p>the way lean figures out what category some <code>f : t ⟶ t</code> is in, is by searching for an instance <code>Category T</code> (assuming <code>t:T</code>)</p>",
        "id": 472290050,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727112608
    },
    {
        "content": "<p>You are right.</p>",
        "id": 472290068,
        "sender_full_name": "Shujian Yan",
        "timestamp": 1727112614
    },
    {
        "content": "<p>I should have just paste the actually code that trigger the question. Sorry for the x-y here. I thought that would be long but actually not. Here's the code:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Comma</span><span class=\"bp\">.</span><span class=\"n\">Arrow</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Types</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Comma</span><span class=\"bp\">.</span><span class=\"n\">Over</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Functor</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Opposite</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Equivalence</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">trace</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">synthInstance</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">trace</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">FunInd</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">all</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">coercions</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Arrow</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"n\">a</span>\n</code></pre></div>",
        "id": 472293151,
        "sender_full_name": "Shujian Yan",
        "timestamp": 1727113627
    },
    {
        "content": "<p>Would It be ok if I create a new  post with just the above exmple?</p>",
        "id": 472293686,
        "sender_full_name": "Shujian Yan",
        "timestamp": 1727113812
    },
    {
        "content": "<p>i don't think that's needed tbh, i think i understand your question...</p>",
        "id": 472293787,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727113847
    },
    {
        "content": "<p>Thanks for your patience. It's 2 am here. zzzzzzz.</p>",
        "id": 472294160,
        "sender_full_name": "Shujian Yan",
        "timestamp": 1727113972
    },
    {
        "content": "<p>still, i think in this case it is defeq?</p>",
        "id": 472294165,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727113974
    },
    {
        "content": "<p>basically, if you <code>#check f.hom</code>, you can see a whole lot of implicit arguments, followed by <code>L.obj self.left ⟶ R.obj self.right</code>, which in the category underlying <code>Arrow (Type u)</code> (i.e. the category <code>Type u</code>) is defeq to <code>f.left -&gt; f.right</code></p>",
        "id": 472294732,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727114158
    },
    {
        "content": "<p>(from what i can tell)</p>",
        "id": 472294803,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727114170
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20figure.20out.20how.20a.20morphsim.20become.20an.20function/near/472294732\">said</a>:</p>\n<blockquote>\n<p>basically, if you <code>#check f.hom</code>, you can see a whole lot of implicit arguments, followed by <code>L.obj self.left ⟶ R.obj self.right</code>, which in the category underlying <code>Arrow (Type u)</code> (i.e. the category <code>Type u</code>) is defeq to <code>f.left -&gt; f.right</code></p>\n</blockquote>\n<p>Can f.hom be in some other Category B If f is itself an object of the Comma category where both of the left and right functor makes the Comma category point to B?</p>",
        "id": 472395180,
        "sender_full_name": "Shujian Yan",
        "timestamp": 1727152894
    },
    {
        "content": "<p>Yes. In this case, I believe the <code>.hom</code> refers to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Comma.hom#doc\">docs#CategoryTheory.Comma.hom</a> ?</p>",
        "id": 472403786,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727157409
    },
    {
        "content": "<p>Again, lean deduces in what category a Hom is by looking at the type of the domain and codomain, and then searching for the <code>Category</code> instance of that type.</p>",
        "id": 472404463,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727157781
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20figure.20out.20how.20a.20morphsim.20become.20an.20function/near/472404463\">said</a>:</p>\n<blockquote>\n<p>Again, lean deduces in what category a Hom is by looking at the type of the domain and codomain, and then searching for the <code>Category</code> instance of that type.</p>\n</blockquote>\n<p>Oh I understand now! You already told me why. Sorry for my silly. Thanks again.  I think I can  mark this post as closed now.</p>",
        "id": 472424101,
        "sender_full_name": "Shujian Yan",
        "timestamp": 1727164505
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"735478\">Shujian Yan</span> has marked this topic as resolved.</p>",
        "id": 472424170,
        "sender_full_name": "Notification Bot",
        "timestamp": 1727164524
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/stream/113489-new-members/topic/.E2.9C.94.20Trying.20to.20figure.20out.20how.20a.20morphsim.20become.20an.20function/near/472284743\">said</a>:</p>\n<blockquote>\n<p>thinking about it, i think every (proven) equality is defeq in lean, but that's slightly besides the point</p>\n</blockquote>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Init/Core.html#Quot.sound\"><code>Quot.sound</code></a> certainly isn't def-eq <span aria-label=\"stuck out tongue\" class=\"emoji emoji-1f61b\" role=\"img\" title=\"stuck out tongue\">:stuck_out_tongue:</span></p>",
        "id": 472445211,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1727170134
    },
    {
        "content": "<p>in general it's definitely not the case that all equalities are defeq. A classic example is <code>x + y = y + x</code>, this is not a defeq when <code>x</code> and <code>y</code> are variables of type <code>Nat</code></p>",
        "id": 472513609,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727189737
    },
    {
        "content": "<p>i meant equalities <em>of types</em></p>",
        "id": 472513671,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727189756
    },
    {
        "content": "<p>that's also not true, I have an example sitting around somewhere of a nontrivial type equality obtained by using cantor's theorem to show that a certain parameteric inductive type can't possibly be injective</p>",
        "id": 472513945,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727189823
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/stream/113489-new-members/topic/.E2.9C.94.20Trying.20to.20figure.20out.20how.20a.20morphsim.20become.20an.20function/near/472513671\">said</a>:</p>\n<blockquote>\n<p>i meant equalities <em>of types</em></p>\n</blockquote>\n<p>That's also not the case --- <code>Fin (x + y) = Fin (y + x)</code></p>",
        "id": 472513973,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727189831
    },
    {
        "content": "<p>^ or that</p>",
        "id": 472514032,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727189846
    },
    {
        "content": "<p>Equalities of props, maybe? :)</p>",
        "id": 472514610,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1727190011
    },
    {
        "content": "<p><del>would requiring all free variables being <code>Type</code>-typed be sufficient?</del> nope, you can use <code>card</code> to get around that</p>",
        "id": 472514868,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727190072
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/stream/113489-new-members/topic/.E2.9C.94.20Trying.20to.20figure.20out.20how.20a.20morphsim.20become.20an.20function/near/472514610\">said</a>:</p>\n<blockquote>\n<p>Equalities of props, maybe? :)</p>\n</blockquote>\n<p>arguably, <code>Prop</code>-values aren't <code>Type</code>s</p>",
        "id": 472515104,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727190141
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Bool</span>\n<span class=\"w\">  </span><span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">DecidableEq</span>\n\n<span class=\"kn\">section</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">U_th1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">U_th2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">not_forall</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U_th1</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U_th2</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">choose</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">U_th3</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U_th2</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">choose_spec</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">U_th4</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U_th2</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">choose_spec</span><span class=\"bp\">.</span><span class=\"m\">2</span>\n<span class=\"kn\">end</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"n\">I</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">I</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">th1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">U_th3</span><span class=\"w\"> </span><span class=\"n\">I</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">th2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">U_th4</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">Y</span><span class=\"bp\">.</span><span class=\"n\">eq_1</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"n\">eq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"n\">U_th1</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 472516272,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727190518
    },
    {
        "content": "<p>this is extra fun because <code>I</code> is a computationally relevant type so you can actually compile elements of these types and obtain exotic terms by transporting elements across this equality</p>",
        "id": 472516749,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727190677
    },
    {
        "content": "<p>this lets you \"prove theorems\" using <code>#eval</code> which cannot be proved using the kernel alone</p>",
        "id": 472516854,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727190710
    },
    {
        "content": "<p>i.e. <code>native_decide</code> is not a conservative extension, even setting aside hacks that use IO or other stuff</p>",
        "id": 472517088,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727190766
    },
    {
        "content": "<p>i'm still trying to get my head around what this proof is... you're proving two empty types are the same?</p>",
        "id": 472517204,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727190800
    },
    {
        "content": "<p>It doesn't actually matter what the inductive definition is, I made it a Bool to make it less trivial</p>",
        "id": 472517942,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727191012
    },
    {
        "content": "<p>This is an inductive type with a parameter <code>w</code>, and there are too many values of the parameter for all of them to result in different types</p>",
        "id": 472518026,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727191046
    },
    {
        "content": "<p>so at least some pair, name it <code>X</code> and <code>Y</code>, must yield equal types</p>",
        "id": 472518071,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727191064
    },
    {
        "content": "<p>this is just cantor's theorem applied to <code>I</code> treated as a function</p>",
        "id": 472518113,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727191076
    },
    {
        "content": "<p>Here's an example of the unprovable equality you can prove by <code>#eval</code> or <code>native_decide</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">true1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">true2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">th1</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">true</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">true1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">true2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"w\"> </span><span class=\"c1\">-- conjectured unprovable</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">true1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">true2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">native_decide</span><span class=\"w\"> </span><span class=\"c1\">-- works</span>\n</code></pre></div>",
        "id": 472518243,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727191109
    },
    {
        "content": "<p>here the key aspect making this possible is the axiom of choice?</p>",
        "id": 472518310,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727191136
    },
    {
        "content": "<p>basically (but note that it is being used in a computationally irrelevant position, which is why I never needed to use the <code>noncomputable</code> keyword above and <code>#eval</code> works)</p>",
        "id": 472518460,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727191186
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/.E2.9C.94.20Trying.20to.20figure.20out.20how.20a.20morphsim.20become.20an.20function/near/472518243\">said</a>:</p>\n<blockquote>\n<p>Here's an example of the unprovable equality you can prove by <code>#eval</code> or <code>native_decide</code>:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">true1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">true2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">th1</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">true</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">true1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">true2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"w\"> </span><span class=\"c1\">-- conjectured unprovable</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">true1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">true2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">native_decide</span><span class=\"w\"> </span><span class=\"c1\">-- works</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Why is the first example only conjectured unprovable? Isn't that something that can be proven (assuming consistency of Lean)?</p>",
        "id": 472521548,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727192115
    },
    {
        "content": "<p>i'm guessing because <code>I.mk X true</code> doesn't need to be equal to <code>I.mk Y true</code>?</p>",
        "id": 472522142,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727192320
    },
    {
        "content": "<p>I mean that the unprovability can be proven</p>",
        "id": 472522566,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727192458
    },
    {
        "content": "<p>so it's <em>theoremed</em> unprovable? <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span></p>",
        "id": 472522692,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727192499
    },
    {
        "content": "<p>I have a sketch of a proof, but these things tend to be subtle</p>",
        "id": 472523830,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727192867
    },
    {
        "content": "<p>Can anything be said about <code>cast</code> for non-defeq equalities?</p>",
        "id": 472526440,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727193687
    },
    {
        "content": "<p>as long as the equality is induced by an equality on the indices (as in your <code>Fin (x + y) = Fin (y + x)</code> example), you can prove it commutes with the constructors. This is a rare situation where this is not the case</p>",
        "id": 472526821,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727193788
    },
    {
        "content": "<p>How do you prove it, for example, in here?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 472527346,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727193961
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 472538546,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727197764
    }
]