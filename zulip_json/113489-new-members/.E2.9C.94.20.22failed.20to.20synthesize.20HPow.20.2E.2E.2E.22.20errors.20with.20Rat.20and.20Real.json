[
    {
        "content": "<p>What is the best way to work with rational and real powers in terms of types? Say I want to show that, for example,</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">l1</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Rat</span><span class=\"o\">}:</span><span class=\"w\"> </span><span class=\"mi\">9</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">27</span><span class=\"w\"> </span><span class=\"bp\">&lt;-&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">l2</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"o\">}:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">9</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">27</span><span class=\"w\"> </span><span class=\"bp\">&lt;-&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>l1 (and l2 unless I specify that 9 is real) have an error similar to </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">synthesize</span>\n<span class=\"w\">  </span><span class=\"n\">HPow</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">691</span>\n</code></pre></div>\n<p>It seems like, other than with natural numbers, \"real\" ^ \"real\" = \"real\" is pretty much the only working combination, but is it? Also, I have no idea what \"?m.691\" is, since changing types of both 9 and 27 in l1 does not change much. <br>\nIs there also a way to change all constants so that they will automatically be ( : Real)?</p>",
        "id": 516445833,
        "sender_full_name": "V S",
        "timestamp": 1746538211
    },
    {
        "content": "<p>Well, it is the only working combination for good reasons: to say that a type <code>T</code> has <code>HPow</code> from a type <code>X</code> means that for each <code>x : X</code> and each <code>t :T</code> you know that <code>t^x</code> is a well-typed terms of <code>T</code>. This is basically false for every pair of <code>T</code> and <code>X</code> (it is sometimes true, clearly, like for <code>HPow Nat Nat</code>). </p>\n<p>I would really say that \"helping\"  lean in understanding the type you have in mind by explicitly typing it is quite good, since it forces you to remember that something potential dangerous is going on, like <code>(-3)^(1/3)</code>.</p>",
        "id": 516449002,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1746539005
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"300245\">Filippo A. E. Nuccio</span> <a href=\"#narrow/channel/113489-new-members/topic/.22failed.20to.20synthesize.20HPow.20.2E.2E.2E.22.20errors.20with.20Rat.20and.20Real/near/516449002\">said</a>:</p>\n<blockquote>\n<p>Well, it is the only working combination for good reasons: to say that a type <code>T</code> has <code>HPow</code> from a type <code>X</code> means that for each <code>x : X</code> and each <code>t :T</code> you know that <code>t^x</code> is a well-typed terms of <code>T</code>. This is basically false for every pair of <code>T</code> and <code>X</code> (it is sometimes true, clearly, like for <code>HPow Nat Nat</code>). </p>\n<p>I would really say that \"helping\"  lean in understanding the type you have in mind by explicitly typing it is quite good, since it forces you to remember that something potential dangerous is going on, like <code>(-3)^(1/3)</code>.</p>\n</blockquote>\n<p>However, it seems weird that \"real\" ^ \"rat\" is not a thing when \"real\" ^ \"real\" is</p>",
        "id": 516450099,
        "sender_full_name": "V S",
        "timestamp": 1746539289
    },
    {
        "content": "<p>I would agree, but if you look at the documentation of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Real.rpow#doc\">docs#Real.rpow</a>, it says</p>\n<blockquote>\n<p>The real power function <code>x ^ y</code>, defined as the real part of the complex power function. For <code>x &gt; 0</code>, it is equal to <code>exp (y log x)</code>. For <code>x = 0</code>, one sets <code>0 ^ 0=1</code> and <code>0 ^ y=0</code> for <code>y ≠ 0</code>. For <code>x &lt; 0</code>, the definition is somewhat arbitrary as it depends on the choice of a complex determination of the logarithm. With our conventions, it is equal to <code>exp (y log x) cos (π y)</code>.</p>\n</blockquote>\n<p>which shows that we want a real-real power but without expecting too much of it.</p>",
        "id": 516453039,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1746540035
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"300245\">Filippo A. E. Nuccio</span> <a href=\"#narrow/channel/113489-new-members/topic/.22failed.20to.20synthesize.20HPow.20.2E.2E.2E.22.20errors.20with.20Rat.20and.20Real/near/516453039\">said</a>:</p>\n<blockquote>\n<p>I would agree, but if you look at the documentation of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Real.rpow#doc\">docs#Real.rpow</a>, it says</p>\n<blockquote>\n<p>The real power function <code>x ^ y</code>, defined as the real part of the complex power function. For <code>x &gt; 0</code>, it is equal to <code>exp (y log x)</code>. For <code>x = 0</code>, one sets <code>0 ^ 0=1</code> and <code>0 ^ y=0</code> for <code>y ≠ 0</code>. For <code>x &lt; 0</code>, the definition is somewhat arbitrary as it depends on the choice of a complex determination of the logarithm. With our conventions, it is equal to <code>exp (y log x) cos (π y)</code>.</p>\n</blockquote>\n<p>which shows that we want a real-real power but without expecting too much of it.</p>\n</blockquote>\n<p>I see, thank you!</p>",
        "id": 516458301,
        "sender_full_name": "V S",
        "timestamp": 1746541319
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"874708\">V S</span> has marked this topic as resolved.</p>",
        "id": 516458357,
        "sender_full_name": "Notification Bot",
        "timestamp": 1746541326
    }
]