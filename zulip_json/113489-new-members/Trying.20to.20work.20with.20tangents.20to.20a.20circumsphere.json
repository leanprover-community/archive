[
    {
        "content": "<p>Hi! I'd like to prove the alternate segment theorem, which does not appear to currently have a proof in Lean4. Does this formalization seem reasonable? Are there any better tools I should be using? (Currently just browsing Mathlib.Geometry.Euclidean.)</p>\n<p><code>theorem AlternateSegments (A B C K I : Pt) (triangleABC : Triangle ℝ Pt) (H: AffineIndependent ℝ ![A, B, C]): triangleABC = ⟨_, H⟩ → K = triangleABC.circumcenter → ∠ K B I = Real.pi/2 ∧ ∠ K B I = ∠ K B C + ∠ C B I → ∠ B A C = ∠ C B I</code></p>",
        "id": 505876121,
        "sender_full_name": "Riley Riles",
        "timestamp": 1742065371
    },
    {
        "content": "<p>Just a tip: instead of using one backtick, wrap your code with 3 backticks (```), like so:</p>\n<p>\\```<br>\n[code]<br>\n\\```</p>\n<p>but without the backslashes. Also make sure to include any imports. Check out <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> for more info.</p>",
        "id": 505877061,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1742066080
    },
    {
        "content": "<p>Thanks, let me rewrite that:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Geometry</span><span class=\"bp\">.</span><span class=\"n\">Euclidean</span><span class=\"bp\">.</span><span class=\"n\">Angle</span><span class=\"bp\">.</span><span class=\"n\">Sphere</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Affine</span><span class=\"w\"> </span><span class=\"n\">Affine</span><span class=\"bp\">.</span><span class=\"n\">Simplex</span><span class=\"w\"> </span><span class=\"n\">EuclideanGeometry</span><span class=\"w\"> </span><span class=\"n\">FiniteDimensional</span><span class=\"w\"> </span><span class=\"n\">Module</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">Affine</span><span class=\"w\"> </span><span class=\"n\">EuclideanGeometry</span><span class=\"w\"> </span><span class=\"n\">Real</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Pt</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">InnerProductSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MetricSpace</span><span class=\"w\"> </span><span class=\"n\">Pt</span><span class=\"o\">]</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedAddTorsor</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"n\">Pt</span><span class=\"o\">]</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">AlternateSegments</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Pt</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">triangleABC</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Triangle</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">Pt</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AffineIndependent</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"n\">A</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]):</span><span class=\"w\"> </span><span class=\"n\">triangleABC</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⟨_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">triangleABC</span><span class=\"bp\">.</span><span class=\"n\">circumcenter</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∠</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">pi</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">∠</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">∠</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">∠</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∠</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">∠</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">I</span>\n</code></pre></div>",
        "id": 505877170,
        "sender_full_name": "Riley Riles",
        "timestamp": 1742066166
    },
    {
        "content": "<p>Make sure that the last 3 ticks are on their own line (and feel free to edit your post instead of making a new one). But that looks much better, thanks!</p>",
        "id": 505877317,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1742066283
    },
    {
        "content": "<p>Gotcha! Thanks for explaining, I'm still new here.</p>",
        "id": 505877366,
        "sender_full_name": "Riley Riles",
        "timestamp": 1742066323
    },
    {
        "content": "<p>I have six open PRs adding more geometrical definitions to mathlib (focused at present more on definitions than on theorems); <a href=\"https://github.com/leanprover-community/mathlib4/pull/22483\">#22483</a> is the one defining tangents (but not doing anything connecting them to angles).</p>",
        "id": 505881897,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1742069860
    },
    {
        "content": "<p>The idiomatic way of distinguishing the alternate segment from the one opposite it is to use <code>SOppSide</code> (to say two points are on opposite sides of a chord).</p>",
        "id": 505882040,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1742069957
    },
    {
        "content": "<p>I expect the result to be easier to prove with oriented angles mod π. Note that we only have angles in the same segment for oriented angles mod π; we don't yet have anything deducing it for angles mod 2π (when you go mod 2π, you start needing to distinguish \"angles in same segment\" and \"opposite angles of a cyclic quadrilateral\" as different theorems; mod π, they are the same theorem).</p>",
        "id": 505882187,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1742070066
    },
    {
        "content": "<p>Working mod π, you also don't need any <code>SOppSide</code> condition in the statement.</p>",
        "id": 505882238,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1742070115
    },
    {
        "content": "<p>Once you have the result for oriented angles mod 2π, there should be enough existing API for converting between oriented and unoriented angles, and for proving that two angles have the same sign, to enable going to the corresponding result for unoriented angles.</p>",
        "id": 505882346,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1742070185
    },
    {
        "content": "<p>My inclination would also be to use a sphere containing the three different points that's passed as its own hypothesis rather than directly using <code>circumsphere</code>, since while the spheres will be equal, a general sphere may be more convenient for users.</p>",
        "id": 505882724,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1742070470
    },
    {
        "content": "<p>When going from oriented to unoriented angles for such a result, there's the additional complication that the oriented angle result is inherently two-dimensional but the unoriented angle result should work in an ambient space of more than two dimensions (given a condition that the centre of the sphere is coplanar with all the other points involved, probably). In principle this can be done by moving between an affine subspace and the full space (using lemmas that isometries preserve various geometrical quantities), but you might find places where we don't have all the lemmas needed about things being preserved by isometries.</p>",
        "id": 505883005,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1742070670
    },
    {
        "content": "<p>Thanks, that helps a lot!</p>",
        "id": 505885173,
        "sender_full_name": "Riley Riles",
        "timestamp": 1742072415
    }
]