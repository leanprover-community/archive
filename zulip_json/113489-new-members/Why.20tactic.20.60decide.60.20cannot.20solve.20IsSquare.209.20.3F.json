[
    {
        "content": "<p>My code:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">nine_is_square</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsSquare</span><span class=\"w\"> </span><span class=\"mi\">9</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">decide</span>\n</code></pre></div>\n<p><a href=\"/user_uploads/3121/h5BNPYdrjuHDthUUd6EarGmP/2024-12-05-00.33.25.png\">screenshot2024-12-05 00.33.25.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/h5BNPYdrjuHDthUUd6EarGmP/2024-12-05-00.33.25.png\" title=\"screenshot2024-12-05 00.33.25.png\"><img data-original-dimensions=\"2085x573\" src=\"/user_uploads/thumbnail/3121/h5BNPYdrjuHDthUUd6EarGmP/2024-12-05-00.33.25.png/840x560.webp\"></a></div>",
        "id": 486134265,
        "sender_full_name": "ptrl",
        "timestamp": 1733330036
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">unseal</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">sqrt</span><span class=\"bp\">.</span><span class=\"n\">iter</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">nine_is_square</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsSquare</span><span class=\"w\"> </span><span class=\"mi\">9</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">decide</span>\n</code></pre></div>\n<p>fixes it</p>",
        "id": 486134598,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733330123
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span>, it would be great to have some documentation in the <code>decide</code> tactic about the interaction with well-founded recursion</p>",
        "id": 486134682,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733330153
    },
    {
        "content": "<p>I recall some talk about being allowed to unfold well-founded recursion on ground terms, which could also solve this</p>",
        "id": 486141303,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1733332195
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> May I ask a more further question?<br>\nHow to solve this by decide? \\sqrt 7 will be solved, but \\sqrt 7 + 1 not work</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">unseal</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">sqrt</span><span class=\"bp\">.</span><span class=\"n\">iter</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Irrational</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">√</span><span class=\"mi\">7</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">decide</span>\n</code></pre></div>",
        "id": 486212456,
        "sender_full_name": "ptrl",
        "timestamp": 1733365064
    },
    {
        "content": "<p>You can use</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">synth</span><span class=\"w\"> </span><span class=\"n\">Decidable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Irrational</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"mi\">7</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>to see that <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=instDecidableIrrationalSqrtOfNatReal#doc\">docs#instDecidableIrrationalSqrtOfNatReal</a> is being used, which only applies when there is no addition</p>",
        "id": 486212807,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733365294
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/113489-new-members/topic/Why.20tactic.20.60decide.60.20cannot.20solve.20IsSquare.209.20.3F/near/486212807\">said</a>:</p>\n<blockquote>\n<p>You can use</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">synth</span><span class=\"w\"> </span><span class=\"n\">Decidable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Irrational</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"mi\">7</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>to see that <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=instDecidableIrrationalSqrtOfNatReal#doc\">docs#instDecidableIrrationalSqrtOfNatReal</a> is being used, which only applies when there is no addition</p>\n</blockquote>\n<p>Hi, <span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> <br>\nIf I want to solve <code>Irrational (√7 + 1)</code>, what should I do? I want to use <code>Irrational.rat_add</code>, but <code>1</code> is not a rational, it is \\R.<br>\nAnd what about <code>Irrational (√7 - 1)</code>? I think it is more difficult</p>",
        "id": 486213902,
        "sender_full_name": "ptrl",
        "timestamp": 1733365932
    },
    {
        "content": "<p>this works, though I would hope there's a way to do this without the <code>Nat.cast_one</code> rewrite:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"n\">unseal</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">sqrt</span><span class=\"bp\">.</span><span class=\"n\">iter</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Irrational</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">√</span><span class=\"mi\">7</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">cast_one</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">irrational_add_nat_iff</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">decide</span>\n</code></pre></div>",
        "id": 486214153,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1733366113
    },
    {
        "content": "<p>and then you can do the same for <code>- 1</code> using <code>irrational_sub_nat_iff</code></p>",
        "id": 486214463,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1733366305
    },
    {
        "content": "<p>We should add an <code>ofNat</code> version of that lemma, and rename that one to natCast</p>",
        "id": 486215621,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733367074
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"690858\">Daniel Weber</span> <a href=\"#narrow/channel/113489-new-members/topic/Why.20tactic.20.60decide.60.20cannot.20solve.20IsSquare.209.20.3F/near/486141303\">said</a>:</p>\n<blockquote>\n<p>I recall some talk about being allowed to unfold well-founded recursion on ground terms, which could also solve this</p>\n</blockquote>\n<p>Probably <code>decide +kernel</code>, since the kernel doesn't care about irreducibility</p>",
        "id": 486275811,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1733395846
    },
    {
        "content": "<p>Why \\sqrt 4 = 2 cannot be solved by decide? <span aria-label=\"sob\" class=\"emoji emoji-1f62d\" role=\"img\" title=\"sob\">:sob:</span></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">unseal</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">sqrt</span><span class=\"bp\">.</span><span class=\"n\">iter</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">sqrt4eq2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"o\">(</span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">decide</span>\n</code></pre></div>",
        "id": 486325456,
        "sender_full_name": "ptrl",
        "timestamp": 1733410845
    },
    {
        "content": "<p>does <code>decide +kernel</code> work?</p>",
        "id": 486325612,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1733410881
    },
    {
        "content": "<p>That's not <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.sqrt#doc\">docs#Nat.sqrt</a>, that's <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Real.sqrt#doc\">docs#Real.sqrt</a> (and reals are noncomputable)</p>",
        "id": 486325687,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1733410901
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">sqrt4eq2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"o\">(</span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">sqrt_eq_iff_eq_sq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">norm_num</span>\n</code></pre></div>\n<p>works</p>",
        "id": 486326233,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1733411038
    },
    {
        "content": "<p>perhaps <code>norm_num</code> should have a module for Real.sqrt that does this, although it's obviously limited to rational squares</p>",
        "id": 486326513,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1733411103
    },
    {
        "content": "<p><a href=\"#narrow/channel/113489-new-members/topic/sqrt.7B25.7D.20.3D.205.20.3F/near/477522335\">I agree</a></p>",
        "id": 486333808,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1733412962
    }
]