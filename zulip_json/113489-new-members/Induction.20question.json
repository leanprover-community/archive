[
    {
        "content": "<p>I have a function <code>foo (s : Finset x) : Finset y</code> and I want to prove a property of <code>foo</code> by induction on <code>s.card</code>, rather than on <code>s</code>, because there is no simple relationship between <code>foo s</code> and <code>foo (insert a s)</code>.  How do I do it?  I tried <code>induction s.card</code>, but it does not give me meaningful goals.</p>\n<p>One idea I have is to define <code>foo' (s : Finset x) (n : ℕ) (h : s.card = n) : Finset y</code> and induct on n.  Is this the only way?</p>",
        "id": 497208827,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1738453644
    },
    {
        "content": "<p>You could do <code>generalize h : s.card = n</code> and then do induction on <code>n</code></p>\n<p>There's probably also an induction principle somewhere in mathlib you could use with a <code>using</code> clause.</p>",
        "id": 497208894,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738453723
    },
    {
        "content": "<p>This is a great question in the sense that (a) I have run into this before (induction on size of finset is strictly more powerful than the default induction theorem for finsets) (b) I've asked about it before and (c) there's definitely an answer on this server somewhere ;-) but i've forgotten it :-(</p>",
        "id": 497208904,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738453734
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finset.induction#doc\">docs#Finset.induction</a> is <code>insert</code>-based induction</p>",
        "id": 497208942,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738453788
    },
    {
        "content": "<p>so <code>induction s using Finset.induction</code></p>",
        "id": 497208995,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738453807
    },
    {
        "content": "<p>yeah that was what I meant by \"the default induction theorem\". The issue comes when the proof for <code>insert a s</code> follows from e.g. the proof for all subsets of <code>insert a s</code> of size |s|, rather than just s itself.</p>",
        "id": 497209045,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738453906
    },
    {
        "content": "<p>The can be done with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finset.strongInduction#doc\">docs#Finset.strongInduction</a> (which should be renamed to <code>Finset.strongRec</code>).</p>",
        "id": 497209335,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1738454187
    },
    {
        "content": "<p>Let me give some more details: <code>foo s</code> is the set of permutations of the elements of s, represented as a Finset of bijective maps from s to the set {0, 1, ..., s.card - 1}.  What I want to prove is that <code>(foo s).card = s.card.factorial</code>.  I don't think any of the Finset induction schemes is really usable (including the strong one), because the recurrence relation that results are complicated.  The informal argument is to induct on s.card and write <code>foo s</code> as the disjoint union indexed by the last element of the permutation.  Hence my question.</p>",
        "id": 497209829,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1738454566
    },
    {
        "content": "<p>I have spent a lot of time trying to reduce my goal to some theorems about permutations already in mathlib, but so far in vain.</p>",
        "id": 497209978,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1738454715
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110637\">Ching-Tsun Chou</span> <a href=\"#narrow/channel/113489-new-members/topic/Induction.20question/near/497209829\">said</a>:</p>\n<blockquote>\n<p>The informal argument is to induct on s.card and write <code>foo s</code> as the disjoint union indexed by the last element of the permutation.  Hence my question.</p>\n</blockquote>\n<p>Is this not just <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finset.induction#doc\">docs#Finset.induction</a><br>\nYou are writing the argument to <code>p</code> as <code>insert a s</code> where <code>a ∉ s</code></p>",
        "id": 497210233,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1738454966
    },
    {
        "content": "<p>Oh you need access to all of the subcases</p>",
        "id": 497210336,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1738455042
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/113489-new-members/topic/Induction.20question/near/497208894\">said</a>:</p>\n<blockquote>\n<p>You could do <code>generalize h : s.card = n</code> and then do induction on <code>n</code></p>\n</blockquote>\n<p>Did you try this? This is how you do what you asked in your question.</p>",
        "id": 497210379,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738455116
    },
    {
        "content": "<p>Or you could do <code>induction' h : s.card</code>. (Unfortunately <code>induction</code> doesn't yet support <code>h : </code> syntax)</p>",
        "id": 497210545,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738455276
    },
    {
        "content": "<p>I have not finished the proof, but I think the following should work (in the sense that the resulting goals do look like true statements):<br>\n<code>``lean4</code><br>\n  generalize h : s.card = n<br>\n  revert s<br>\n  induction' n with n ih<br>\n...</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code>\n</code></pre></div>",
        "id": 497211547,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1738456370
    },
    {
        "content": "<p>Without the <code>revert s</code>, the induction hypothesis will not be usable because it refers to the same <code>s</code> as in the assumption <code>s.card = n + 1</code>.</p>",
        "id": 497211756,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1738456581
    },
    {
        "content": "<p>You can say <code>induction' n generalizing s</code> to do the revert automatically.</p>",
        "id": 497212010,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1738456909
    }
]