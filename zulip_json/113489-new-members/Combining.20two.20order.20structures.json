[
    {
        "content": "<p>I'm trying to combine Order.Frame and OrderedAddCommMonoid, but somehow Lean does not see that this should (I think) be working on the same order structure. How do I fix this? I seem to be overlooking somthing.</p>\n<p>This is an example of a trivial proof that works:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Time</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">OrderedAddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">Time</span><span class=\"o\">]</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">add_le_left_time</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Time</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intros</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">OrderedAddCommMonoid</span><span class=\"bp\">.</span><span class=\"n\">add_le_add_left</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">c</span>\n</code></pre></div>\n<p>But when I add [Order.Frame Time] (or [PartialOrder Time], or similar)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Time</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">OrderedAddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">Time</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">Frame</span><span class=\"w\"> </span><span class=\"n\">Time</span><span class=\"o\">]</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">add_le_left_time</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Time</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intros</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">OrderedAddCommMonoid</span><span class=\"bp\">.</span><span class=\"n\">add_le_add_left</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">c</span>\n</code></pre></div>\n<p>I get an error that <code>h</code> is of the wrong type. It seems that Lean get's confused about which ≤ I mean.</p>\n<p>What is happening here?</p>",
        "id": 554065191,
        "sender_full_name": "Pieter Cuijpers",
        "timestamp": 1762428498
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"563058\">@Pieter Cuijpers</span> OrderedAddCommMonoid was removed for this very reason, and replaced with IsOrderedAddMonoid. Perhaps you are using an older version of Mathlib.</p>",
        "id": 554066436,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762428927
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/commit/1cd54028c4522f638c29d173737f831552055c15#diff-b7e2a9cad39a929d367ebafb50a8fee9a683847bfe6cf4965d26c8b73d938162\">https://github.com/leanprover-community/mathlib4/commit/1cd54028c4522f638c29d173737f831552055c15#diff-b7e2a9cad39a929d367ebafb50a8fee9a683847bfe6cf4965d26c8b73d938162</a><br>\nah, it was removed last week (but deprecated in April)</p>",
        "id": 554066708,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762429022
    },
    {
        "content": "<p>Whenever you have assumptions like <code>[OrderedAddCommMonoid Time] [Order.Frame Time]</code>, both classes carry a (different) definition of &lt;=, and there is no guarantee that they are the same relation.</p>",
        "id": 554066888,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762429075
    },
    {
        "content": "<p>Thanks, that clarifies things. Indeed, we have been working on an older version for a while for this work. I'll tell my student to update ;-)</p>",
        "id": 554072908,
        "sender_full_name": "Pieter Cuijpers",
        "timestamp": 1762430933
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"563058\">@Pieter Cuijpers</span> how old is the version? your student might want to update it slowly, since there is very little backwards compatibility</p>",
        "id": 554073407,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762431106
    },
    {
        "content": "<p>That is, it's usually easier to bump update to lean/mathlib v4.n.0, 4.(n+1).0, 4.(n+2).0, ... rather than to the most recent version in one step</p>",
        "id": 554114378,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1762441498
    }
]