[
    {
        "content": "<p>Is there an option to limit the number of cores <code>lake build</code> uses? Building mathlib takes a few hours, and because it uses all threads it makes my desktop unrensponsive. Tried <code>lake build -j10</code> but it didn't work.</p>",
        "id": 536956615,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1756613606
    },
    {
        "content": "<p>Do you know about the cache? Generally you don't build all of Mathlib yourself.</p>",
        "id": 536956995,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1756614254
    },
    {
        "content": "<p><code>lake exe cache get</code></p>",
        "id": 536957004,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1756614267
    },
    {
        "content": "<p>I did run this command. Even with this <code>lake build</code> takes a few hours.</p>",
        "id": 536962390,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1756621145
    },
    {
        "content": "<p>It shouldn't build anything with the cache downloaded?</p>",
        "id": 536962430,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1756621191
    },
    {
        "content": "<p>It should only build files that are not from mathlib.</p>",
        "id": 536962465,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1756621230
    },
    {
        "content": "<p>I just built clean repo.</p>",
        "id": 536962474,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1756621249
    },
    {
        "content": "<p>So I guess that means cache isn't working for me?</p>",
        "id": 536962684,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1756621481
    },
    {
        "content": "<p>I imagine so: running <code>lake build</code> on a project with a successfully downloaded cache should zoom by the mathlib files and then spend time on your local files.</p>",
        "id": 536962850,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1756621650
    },
    {
        "content": "<p>Try using <code>lake exe cache get!</code> and see if that helps.</p>",
        "id": 536962887,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1756621694
    },
    {
        "content": "<p>The <code>!</code> forces redownloading files, even if they are already there (or some approximation to this).</p>",
        "id": 536962915,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1756621741
    },
    {
        "content": "<p>I removed <code>.lake</code> and run <code>lake exe cache get!</code> and now it works! Thanks!</p>",
        "id": 536963085,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1756621941
    },
    {
        "content": "<p>I also remember, that when I created new project depending on mathlib in vscode, it was also compiling mathlib for a few hours. Does the cache also works when mathlib is dependency, and does vscode downloads it automatically?</p>",
        "id": 536963198,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1756622140
    },
    {
        "content": "<p>Yes, the cache also works when mathlib is a dependency --- but right now, it only works for mathlib files. (My understanding is that this will change in the future.)</p>",
        "id": 536964136,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1756623466
    }
]