[
    {
        "content": "<p>I have two (syntax?) questions about the use of hypotheses. </p>\n<p>The following are two attempts at a simple problem:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">calc</span>\n<span class=\"w\">  </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hb</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ha</span><span class=\"o\">]</span>\n\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">calc</span>\n<span class=\"w\">  </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hb</span>\n<span class=\"w\">  </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"bp\">&lt;--</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"bp\">!</span>\n</code></pre></div>\n<p>Q1: What's the difference between the following two ways of writing what I think is the same thing?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hb</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hb</span>\n</code></pre></div>\n<p>Q2. They can't be fully equivalent because the second version gives an error. What's the reason the following doesn't work?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ha</span><span class=\"o\">]</span>\n<span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"bp\">&lt;--</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"bp\">!</span>\n</code></pre></div>",
        "id": 474517651,
        "sender_full_name": "rzeta0",
        "timestamp": 1727943004
    },
    {
        "content": "<p>The first one works because <code>hb</code> is literally of the type <code>p = n+1</code>. For the second one, you're rewriting the <code>n</code> part of <code>n+1</code> to <code>m^2</code> to get <code>m^2+1</code>. There the hypothesis <code>ha</code> is not of the correct type (<code>n = m^2</code> instead of <code>n + 1 = m^2 + 1</code>)</p>",
        "id": 474518245,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1727943249
    },
    {
        "content": "<p><code>rw [h]</code>, where for example <code>h : n = 5</code>, means \"replace all <code>n</code> by <code>5</code> and then check is there is something else to prove\", while <code> := h</code> means \"the goal is exactly <code>n = 5</code>\".</p>",
        "id": 474518349,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1727943297
    },
    {
        "content": "<p>Thanks. </p>\n<p>Just out of interest I was going to ask how the matching is done (naive text matching vs comparing object types somehow, i'm not an expert), so I tried the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"c1\">-- &lt; works</span>\n<span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"c1\">-- &lt; error</span>\n</code></pre></div>\n<p>This suggests that the matching is simpler than I expected, because my inexpert brain tells me that <code>n+1</code>  and <code>1+n</code> have the same \"type\".</p>\n<p>I'd welcome further insight into the underlying mechanism.</p>",
        "id": 474519563,
        "sender_full_name": "rzeta0",
        "timestamp": 1727943688
    },
    {
        "content": "<p>Here the type of <code>hb</code> is <code>p = n+1</code> (meaning it is a proof of this fact), and it is <em>not</em> <code>p=1+n</code> (that is another fact). What you are saying to Lean is \"<code>p=1+n</code> because <code>p=n+1</code>\" and Lean is saying \"I don't get why this two propositions are the same\".</p>",
        "id": 474520430,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1727943964
    },
    {
        "content": "<p>The type of <code>n+1</code> or <code>1+n</code> is irrelevant, what you are doing is proving a proposition.</p>",
        "id": 474520541,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1727943996
    },
    {
        "content": "<p>... and while the type of <code>n+1</code> vs <code>1+n</code> is irrelevant, it is true that those types are the same and they are <code>Nat</code>.  However, they are <em>different</em> terms of type <code>Nat</code>.</p>",
        "id": 474520701,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1727944048
    },
    {
        "content": "<p>Where <em>different</em> means \"not definitionally equal\". Of course they are propositionally equal.</p>",
        "id": 474520942,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1727944109
    },
    {
        "content": "<p>It's been a long time since I used mathematica, but if I recall correctly, its internal representation would have <code>n+1</code> and <code>1+n</code> as equivalent.</p>\n<p>So is there benefit in Lean not having them equivalent? That is, propositionally the same, but not lexically the same?</p>\n<p>I'm not challenging this - I'm just wondering if in more advanced maths there is a benefit?</p>",
        "id": 474521748,
        "sender_full_name": "rzeta0",
        "timestamp": 1727944389
    },
    {
        "content": "<p>In Lean everything must be proven from the axioms (this is one of the main points of using a proof assistant). The fact that addition on natural numbers is commutative is just a (not very difficult) theorem, that has to be proven like everything else, you cannot expect Lean to automatically know it.</p>",
        "id": 474524740,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1727945227
    },
    {
        "content": "<p>Of course you can use tactics that find this fact, but it cannot be \"built-in\" into Lean (indeed not even the natural numbers are built-in, they're defined <a href=\"https://leanprover-community.github.io/mathlib4_docs/Init/Prelude.html#Nat\">here</a>).</p>",
        "id": 474525290,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1727945302
    },
    {
        "content": "<p>There is a short list of rules that tell when two things are \"the same\", but this list is <em>very</em> short, and it only contains <em>completely trivial</em> stuff, like <code>a</code> and <code>a</code> are the same or the functions <code>a ↦ a^2</code> and <code>b ↦ b^2</code> are the same. Everything else must be proven.</p>",
        "id": 474526400,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1727945439
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> has marked this topic as resolved.</p>",
        "id": 474533387,
        "sender_full_name": "Notification Bot",
        "timestamp": 1727946810
    }
]