[
    {
        "content": "<p>Hello!<br>\nI'm new to lean and going through the book <code>Theorem proving in Lean</code>.<br>\nIn chapter 2 <code>Dependent Types</code>there's an example to illustrate the difference of local definition using <code>let</code> and <code>fun</code>.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n</code></pre></div>\n<p>The first example type checks, while the second example cannot compile, and the info view gives me the information that <code>failed to synthesize instance\n  HAdd a Nat (?m.1936 a x)</code>.</p>\n<p>And I also don't quite understand the second example here. Could someone explain it to me?<br>\nThanks in advance!</p>",
        "id": 454479420,
        "sender_full_name": "Lingyin Luo",
        "timestamp": 1722091553
    },
    {
        "content": "<p>in order for lean to make <code>(fun a =&gt; fun x : a =&gt; x + 2) Nat</code> work, it first needs to \"translate\" what <code>(fun a =&gt; fun x : a =&gt; x + 2)</code> means. in order to do that, it needs to know what <code>x + 2</code> means for all types <code>a</code> that could be passed to this function. the info view complains about the fact that it <em>doesn't</em> know that; <code>+</code> is defined via instances <code>HAdd a b c</code>, where <code>(. + .)</code> takes type <code>a</code> on the left, <code>b</code> on the right, and returns type <code>c</code>.</p>",
        "id": 454480036,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722091795
    },
    {
        "content": "<p>the first example doesn't have this problem, because the inner <code>x + 2</code> part is able to find out that <code>a</code> is equal to <code>Nat</code>, and there is an instance <code>HAdd Nat Nat Nat</code></p>",
        "id": 454480223,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722091866
    },
    {
        "content": "<p>basically, lean is complaining in the second example that it doesn't \"know\" that <code>a</code> will mean <code>Nat</code> in this case</p>",
        "id": 454480368,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722091926
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/stream/113489-new-members/topic/let.20keyword.20and.20fun.20expression.3F/near/454480036\">said</a>:</p>\n<blockquote>\n<p>in order for lean to make <code>(fun a =&gt; fun x : a =&gt; x + 2) Nat</code> work, it first needs to \"translate\" what <code>(fun a =&gt; fun x : a =&gt; x + 2)</code> means. in order to do that, it needs to know what <code>x + 2</code> means for all types <code>a</code> that could be passed to this function. the info view complains about the fact that it <em>doesn't</em> know that; <code>+</code> is defined via instances <code>HAdd a b c</code>, where <code>(. + .)</code> takes type <code>a</code> on the left, <code>b</code> on the right, and returns type <code>c</code>.</p>\n</blockquote>\n<p>Ah Ok, now I understand the sentence from the book what exactly means : <code>there are expressions of the form let a:= t1; t2 that cannot be expressed as (fun a =&gt; t2) t1</code>.<br>\n Thank you!</p>",
        "id": 454481214,
        "sender_full_name": "Lingyin Luo",
        "timestamp": 1722092463
    },
    {
        "content": "<p>I think this example is explained by <a href=\"https://leanprover.github.io/theorem_proving_in_lean4/\">#tpil</a></p>",
        "id": 454598675,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722164385
    },
    {
        "content": "<p><a href=\"https://leanprover.github.io/theorem_proving_in_lean4/dependent_type_theory.html#local-definitions\">https://leanprover.github.io/theorem_proving_in_lean4/dependent_type_theory.html#local-definitions</a></p>",
        "id": 454598894,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722164459
    }
]