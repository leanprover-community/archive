[
    {
        "content": "<p>I am trying to express (-1)^n in Lean, but having trouble because it seems not to like -1. What's  the right way to express this theorem?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">thm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">≡</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MOD</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">≡</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MOD</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Error: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">synthesize</span>\n<span class=\"w\">  </span><span class=\"n\">Neg</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n</code></pre></div>",
        "id": 479767550,
        "sender_full_name": "Alex Gu",
        "timestamp": 1730323750
    },
    {
        "content": "<p><code>[MOD _]</code> notation is for natural number. If you want to deal with integers, you should be using <code>[ZMOD _]</code> notation <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 479768288,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730324108
    },
    {
        "content": "<p>This isn't quite related to the question, but you should be aware that we have a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SignType#doc\">docs#SignType</a></p>",
        "id": 479769005,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1730324504
    },
    {
        "content": "<p>Depending on what your application is, it may be convenient. But if you're just doing some modular arithmetic, then sticking to integers is probably the way to go.</p>",
        "id": 479769124,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1730324560
    },
    {
        "content": "<p>Thanks both :) Getting a bit stuck with the proof now, any good tips here? </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">thm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">≡</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ZMOD</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">≡</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ZMOD</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">even_or_odd</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"n\">he</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">k</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hk</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">he</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hk</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">pow_mul</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"n\">ho</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n</code></pre></div>",
        "id": 479770001,
        "sender_full_name": "Alex Gu",
        "timestamp": 1730325054
    },
    {
        "content": "<p><code>aesop</code> can finish from there.</p>",
        "id": 479770354,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730325266
    },
    {
        "content": "<p>Got it! Is there a way to do it by finding the contradiction instead of proving the theorem? (I saw the aesop proof actually ignores the contradcition and goes ahead to prove it)</p>",
        "id": 479770891,
        "sender_full_name": "Alex Gu",
        "timestamp": 1730325584
    },
    {
        "content": "<p>What contradiction?</p>",
        "id": 479771063,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730325656
    },
    {
        "content": "<p>Oh, you mean using the redundant hypothesis?</p>",
        "id": 479771110,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730325692
    },
    {
        "content": "<p>That is n = 0 mod 2, then n cannot be odd</p>",
        "id": 479771113,
        "sender_full_name": "Alex Gu",
        "timestamp": 1730325694
    },
    {
        "content": "<p>You could do this</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">    </span><span class=\"n\">exfalso</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Int</span><span class=\"bp\">.</span><span class=\"n\">modEq_iff_dvd</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">zero_sub</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">dvd_neg</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"n\">norm_cast</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">not_even_iff_odd</span><span class=\"bp\">.</span><span class=\"n\">mpr</span><span class=\"w\"> </span><span class=\"n\">ho</span>\n<span class=\"w\">    </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">even_iff_exists_two_nsmul</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mpr</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>",
        "id": 479771897,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730326141
    },
    {
        "content": "<p>You might also just want to work in <code>ZMod 2</code> rather than using <code>[ZMOD 2]</code></p>",
        "id": 479773989,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1730327361
    },
    {
        "content": "<p>What's the difference?</p>",
        "id": 479774310,
        "sender_full_name": "Alex Gu",
        "timestamp": 1730327555
    },
    {
        "content": "<p>With <code>ZMod 2</code> you work in the type that has only two elements, <code>0</code> and <code>1</code>. Working with <code>[ZMOD 2]</code> means working with integers, but considering an equivalence relation on it with two equivalence classes.</p>",
        "id": 479774842,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1730327950
    },
    {
        "content": "<p>I see, what would be the equivalent way to write it in ZMod 2 then?</p>",
        "id": 479777190,
        "sender_full_name": "Alex Gu",
        "timestamp": 1730329529
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">thm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ZMod</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ZMod</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 479781606,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1730331976
    },
    {
        "content": "<p>Though the <code>.val</code> there makes it slightly debatable whether this is the same theorem.</p>",
        "id": 479781658,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1730332049
    },
    {
        "content": "<p>i don't think you even need <code>h</code> here? shouldn't this just be true for all <code>n:Nat</code>?</p>",
        "id": 479841382,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1730368804
    },
    {
        "content": "<p>because mod 2, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mn>1</mn><mo>=</mo><mn>1</mn><mo>=</mo><msup><mn>1</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">-1=1=1^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>?</p>",
        "id": 479841450,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1730368828
    },
    {
        "content": "<p>or am i missing something?</p>",
        "id": 479841549,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1730368869
    },
    {
        "content": "<p>I think the lower <code>[MOD 2]</code> is unintended, and the TS is trying to express <code>if even n then 1 else -1</code></p>",
        "id": 479846233,
        "sender_full_name": "Alex Mobius",
        "timestamp": 1730370494
    },
    {
        "content": "<p>ah... in that case, i think that the idiomatic way to express this would be this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Normed</span><span class=\"bp\">.</span><span class=\"n\">Field</span><span class=\"bp\">.</span><span class=\"n\">Lemmas</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"n\">Even</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"n\">Int</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Even</span><span class=\"bp\">.</span><span class=\"n\">neg_one_pow</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>",
        "id": 479847011,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1730370767
    },
    {
        "content": "<p>Mathlib: there's a lemma for everything (good luck with looking for it) :)</p>",
        "id": 479853231,
        "sender_full_name": "Alex Mobius",
        "timestamp": 1730372980
    },
    {
        "content": "<p><code>exact?</code> was used in this case</p>",
        "id": 479856400,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1730374243
    }
]