[
    {
        "content": "<p>This is admittedly a very narrow \"rabbit hole\" question but I wanted the clarity.</p>\n<p>When we apply a lemma to a current goal, eg <code>apply ne_of_lt</code>, is it true that the current goal is always changed?</p>\n<p>If applying a lemma has no effect on the \"state\" then there is no point in applying it.</p>\n<p>And I can't think of a scenario when that effect is on anything other than the current goal.</p>\n<p>I'd welcome guidance here.</p>",
        "id": 478092197,
        "sender_full_name": "rzeta0",
        "timestamp": 1729525095
    },
    {
        "content": "<p>The few lemmas I have seen are of the form \"if P then Q\" where Q corresponds to the current goal, so the application of the lemma changes the current goal to P.</p>\n<p>Is there another possibility that I just haven't seen yet?</p>",
        "id": 478092625,
        "sender_full_name": "rzeta0",
        "timestamp": 1729525228
    },
    {
        "content": "<p>If you do <code>apply id</code> it will do nothing. This is applying the lemma <code>P -&gt; P</code>.</p>",
        "id": 478092696,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729525248
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/113489-new-members/topic/do.20lemmas.20applied.20to.20the.20current.20goal.20*always*.20change.20them.3F/near/478092696\">said</a>:</p>\n<blockquote>\n<p>If you do <code>apply id</code> it will do nothing. This is applying the lemma <code>P -&gt; P</code>.</p>\n</blockquote>\n<p>not always, but usually yes. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">id</span>\n</code></pre></div>",
        "id": 478093603,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1729525491
    },
    {
        "content": "<p>ok - aside from <code>id</code> the original idea holds?</p>",
        "id": 478097270,
        "sender_full_name": "rzeta0",
        "timestamp": 1729526508
    },
    {
        "content": "<p>The only thing that <code>apply</code> can do is replace the current goal with zero or more new goals. These new goals will have the exact same local contexts, and the only difference will be the target of the goal(s). (The \"target\" being what comes after the <code>|-</code>)</p>",
        "id": 478097954,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729526684
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> <a href=\"#narrow/channel/113489-new-members/topic/do.20lemmas.20applied.20to.20the.20current.20goal.20*always*.20change.20them.3F/near/478097270\">said</a>:</p>\n<blockquote>\n<p>ok - aside from <code>id</code> the original idea holds?</p>\n</blockquote>\n<p>Somewhat vacuously if I make assumptions about what I think you're asking, I think the answer is \"yes\", in the sense that if you apply a lemma you're trying to make progress. And progress usually means changing state. If you don't make progress, there's not really a point in doing something. So it's <em>possible</em> to do something that doesn't change things (like the <code>id</code> example) but this is a bit like writing a line of code in your program that does nothing -- it's not <em>wrong</em> and not <em>impossible</em> to do, it's just pointless and potentially wasteful.</p>\n<p>I do think it's worth being aware that you can sometimes apply a lemma which <em>looks</em> like it has done nothing but in fact has done something, because what you <em>see</em> in the infoview is sometimes a pretty representation of some other more complicated thing. Specifically to use an example you're already familiar with, you can apply lemmas which change  some <code>1</code>s in your goal state from being a natural to an int perhaps, but it may seem like nothing has changed unless you hover over things or \"unfold\" things, because you'll see the number <code>1</code> before and after.</p>",
        "id": 478103881,
        "sender_full_name": "Julian Berman",
        "timestamp": 1729528401
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> has marked this topic as resolved.</p>",
        "id": 478139232,
        "sender_full_name": "Notification Bot",
        "timestamp": 1729540738
    },
    {
        "content": "<p>Btw, Mathlib has a linter that checks if, more generally, a tactic does not change the goal and warns you if that is the case.  The definition of \"not change\" is <em>very strict</em>, so <code>apply id</code> does not actually count as \"not changing\".</p>",
        "id": 478142250,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1729541794
    },
    {
        "content": "<p>Here is an example:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Init</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"w\">  </span><span class=\"c1\">-- no warning</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"w\"> </span><span class=\"c1\">-- no warning</span>\n<span class=\"w\">  </span><span class=\"n\">skip</span><span class=\"w\">      </span><span class=\"c1\">-- warning here</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">a</span>\n</code></pre></div>",
        "id": 478142392,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1729541851
    }
]