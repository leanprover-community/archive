[
    {
        "content": "<p>Hello,</p>\n<p>I would like to formalize the notion of a formal power series for weighted languages.</p>\n<p>In Mathlib4, I see there are a few definitions for formal power series, such as <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/PowerSeries/Basic.html#PowerSeries\">PowerSeriesBasic</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/MvPowerSeries/Basic.html#MvPowerSeries\">MvPowerSeries</a>, and <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Calculus/FormalMultilinearSeries.html#FormalMultilinearSeries\">FormalMultilinearSeries</a>.</p>\n<p>However, I am not sure these are the definitions I am looking for.</p>\n<p>For a weigted language, I have an alphabet <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Σ</mi></mrow><annotation encoding=\"application/x-tex\">\\Sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Σ</span></span></span></span> with strings <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">y</mi><mo>∈</mo><msup><mi mathvariant=\"normal\">Σ</mi><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{y} \\in \\Sigma^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6887em;\"></span><span class=\"mord\"><span class=\"mord\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span>, and a semiring <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">W</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi mathvariant=\"double-struck\">K</mi><mo separator=\"true\">,</mo><mo>+</mo><mo separator=\"true\">,</mo><mo>×</mo><mo separator=\"true\">,</mo><mn mathvariant=\"bold\">0</mn><mo separator=\"true\">,</mo><mn mathvariant=\"bold\">1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal{W} = (\\mathbb{K}, +, \\times, \\mathbf{0}, \\mathbf{1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.08222em;\">W</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathbb\">K</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">+</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">×</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">1</span><span class=\"mclose\">)</span></span></span></span>.</p>\n<p>The weighted language <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span> is described by a function <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo>:</mo><msup><mi mathvariant=\"normal\">Σ</mi><mo>∗</mo></msup><mo>→</mo><mi mathvariant=\"double-struck\">K</mi></mrow><annotation encoding=\"application/x-tex\">f : \\Sigma^* \\to \\mathbb{K}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6887em;\"></span><span class=\"mord\"><span class=\"mord\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">K</span></span></span></span>, such that:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>L</mi><mo>=</mo><mo stretchy=\"false\">{</mo><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">y</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">y</mi><mo stretchy=\"false\">)</mo><mo>∣</mo><mi mathvariant=\"bold\">y</mi><mo>∈</mo><msup><mi mathvariant=\"normal\">Σ</mi><mo>∗</mo></msup><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">L = \\{ (f(\\mathbf{y}), \\mathbf{y}) \\mid \\mathbf{y} \\in \\Sigma^* \\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7387em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mclose\">}</span></span></span></span></span></p>\n<p>Which can be written as:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>L</mi><mo>=</mo><munder><mo>∑</mo><mrow><mi mathvariant=\"bold\">y</mi><mo>∈</mo><msup><mi mathvariant=\"normal\">Σ</mi><mo>∗</mo></msup></mrow></munder><mi>f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">y</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"bold\">y</mi></mrow><annotation encoding=\"application/x-tex\">L = \\sum_{\\mathbf{y} \\in \\Sigma^*} f(\\mathbf{y}) \\mathbf{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4804em;vertical-align:-1.4304em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8557em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbf mtight\" style=\"margin-right:0.01597em;\">y</span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mtight\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6183em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4304em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mclose\">)</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span></span></p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(\\mathbf{y})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mclose\">)</span></span></span></span> is the weight for string <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">y</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span>.</p>\n<p>Is there a formalization of this in Mathlib4 already? Or are one of the formal power series definitions in Mathlib4 suitable for this?</p>\n<p>Thank you!</p>",
        "id": 503285694,
        "sender_full_name": "Rudy Peterson",
        "timestamp": 1741099473
    },
    {
        "content": "<p>Is the weighted language  <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span> a set of ordered pairs or a sum?</p>",
        "id": 503298233,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741102416
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113489-new-members/topic/Formal.20Power.20Series.20for.20Weighted.20Languages/near/503298233\">said</a>:</p>\n<blockquote>\n<p>Is the weighted language  <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span> a set of ordered pairs or a sum?</p>\n</blockquote>\n<p>That's a good question... I am not sure if it is actually a sum... it may just be a function.</p>\n<p>If it is just a function I am not sure why it is written as a sum...</p>",
        "id": 503299253,
        "sender_full_name": "Rudy Peterson",
        "timestamp": 1741102696
    },
    {
        "content": "<p>This looks like a multivariate power series, but with noncommuting indeterminates. I looked for them in Mathlib a few weeks ago (I wanted to try formalizing the beginining of the Berstel-Reutenauer book on them), but did not find them.</p>\n<p>As a starting point, they could be defined as mappings from the free monoid on your alphabet, to your semiring <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span> - this is similar to the way <code>MvPowerSeries</code> are defined, the free monoid <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>W</mi><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">W^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6887em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span> replacing finite support mappings from the alphabet to the naturals. I didn't go much further than that :)</p>\n<p>As to whether they would be sums... you'd need to extend the work on the <code>PiTopology</code> of <code>MvPowerSeries</code> (power series are the sum of their monomials). They should be sums. I'm not sure how much of this would depend on the finiteness of the alphabet, or details of the topology on <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span> you're using (most likely, the discrete topology).</p>",
        "id": 503326142,
        "sender_full_name": "Philippe Duchon",
        "timestamp": 1741109842
    },
    {
        "content": "<p>I would guess that you are writing the formal sum to make it easier to think about termwise addition and convolutional multiplication. You can express this using the existing Hahn series framework by imposing a suitable partial ordering on the set of strings, but it's possible that a more specialized set of tools would serve you better.</p>",
        "id": 503327547,
        "sender_full_name": "Scott Carnahan",
        "timestamp": 1741110253
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"726077\">Philippe Duchon</span> <a href=\"#narrow/channel/113489-new-members/topic/Formal.20Power.20Series.20for.20Weighted.20Languages/near/503326142\">said</a>:</p>\n<blockquote>\n<p>This looks like a multivariate power series, but with noncommuting indeterminates. I looked for them in Mathlib a few weeks ago (I wanted to try formalizing the beginining of the Berstel-Reutenauer book on them), but did not find them.</p>\n</blockquote>\n<p>Isn't this just the <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FreeAlgebra#doc\">docs#FreeAlgebra</a></p>",
        "id": 503330813,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741111251
    },
    {
        "content": "<p>Or maybe not, since it's a series</p>",
        "id": 503330874,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741111265
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113489-new-members/topic/Formal.20Power.20Series.20for.20Weighted.20Languages/near/503330813\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"726077\">Philippe Duchon</span> <a href=\"#narrow/channel/113489-new-members/topic/Formal.20Power.20Series.20for.20Weighted.20Languages/near/503326142\">said</a>:</p>\n<blockquote>\n<p>This looks like a multivariate power series, but with noncommuting indeterminates. I looked for them in Mathlib a few weeks ago (I wanted to try formalizing the beginining of the Berstel-Reutenauer book on them), but did not find them.</p>\n</blockquote>\n<p>Isn't this just the <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FreeAlgebra#doc\">docs#FreeAlgebra</a></p>\n</blockquote>\n<p>That's quite possible; my knowledge of algebra is rather dated and limited (and quite possibly, even more limited than it was when I learned about it). The Mathlib definition, though, doesn't seem to match what I had in mind; it's defined through a quotient, whereas I had a concrete definition in mind.</p>\n<p>I'll try to have a look at the API for this and see if I can make it click for me.</p>",
        "id": 503334844,
        "sender_full_name": "Philippe Duchon",
        "timestamp": 1741112561
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FreeAlgebra#doc\">docs#FreeAlgebra</a> is the multivariate <em>polynomial</em> with noncommuting indeterminates, not the series</p>",
        "id": 503336107,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741112967
    },
    {
        "content": "<p>I think fundamentally want I need is just functions from elements of a free monad to elements of a semiring.</p>\n<p>So maybe I don't need any of this stuff?</p>",
        "id": 505189921,
        "sender_full_name": "Rudy Peterson",
        "timestamp": 1741797813
    }
]