[
    {
        "content": "<p>hi, I'm stuck trying to prove something.<br>\n<a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQODOMUArgMYzFQCmcAisUgHYzAwCecA7qldTnHBYgaALjgAlFPzjoqjAOZo4YyTGkgk+fMolSBpStWY7V0mFXC8UlUbrUD0xEMEYRi+AJLM5+VhxV6cEggbswA8gBmAMrEWIRMpLamACa8wABuLvISVGBQeKkRghAAalTk0HAAFACOOvRMLOwAlDpVAEIo5lDAVPgAdGUVUHZwAOytIgC80gDE6QDa0gI1/UJUADTLcKuyCmhbAiv9GlqHR6sGUEYw58fmllDW1Hc7/Y7Oru5e5oy+7K9VsFQjBIjE4jAElRpABdApUIoRKAQEBDGCVKrpHSdGDdXoDNGVVTjSZ0BjMPzKGYCADe23WR0ZTIE0zgiwADDDXntFKhmczWYsAIxc7anbT8gVTNkLABMosZVxukqOgoWAGYFUcHmArBRqPy1QAWLUOJwuNyebx/SlqgCspqCIWI4WisXijESVJlADY4QIAL54HBoKjQCxkxp+QlQcShZJEYBgap1MQNCktHRIlEx6ro3M1VrS1PSrBsMxIYjovCh8MgOAx9NNNhxl0JnrJzFiHF4vqDcrokbEiY6fMDjHZ1HjkbpIts71l6RUAAe8GAcDA0jLAH1SJo+nA+WJgFN2fwALTnuA7vf4A8Aax0J6FF6v7ho99f17Yu/32nQT5TLKX7vjIX43n+cD1seUzqiBd5QeBP63gejCAUa8E0IwSG/ne2gQIBdqYXAEA4Sh2ipnAJ4+sRNTBpesxUOkSAAVUswLHA7IbJx3FCtxsrcVxPGcTC9Tks2zRAA\">This is my code.</a><br>\nI want to prove Isomorphism of my own Quantity type and Batteries.Vector Rat 7.<br>\nI'm stuck on the proof of VectorQuantityRoundtrip.</p>",
        "id": 476595905,
        "sender_full_name": "wuyoli",
        "timestamp": 1728815345
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">toVector</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">fromVector</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 476701065,
        "sender_full_name": "Martin Dvo≈ô√°k",
        "timestamp": 1728890799
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"762847\">@wuyoli</span>, I was tinkering with your code last night, but couldn't find a proof without <code>cases</code> repetition. Did <code>simp [toVector, fromVector, h]</code> resolve your issue? I couldn't find <code>h</code>. I was thinking that maybe Martin meant <code>p</code>, but that didn't work.</p>",
        "id": 476852227,
        "sender_full_name": "Derek Rhodes",
        "timestamp": 1728940159
    },
    {
        "content": "<p>for sufficiently small n, you can match on each case of <code>Fin n</code> directly:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œ±</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">time</span>\n<span class=\"w\">  </span><span class=\"n\">length</span>\n<span class=\"w\">  </span><span class=\"n\">mass</span>\n<span class=\"w\">  </span><span class=\"n\">current</span>\n<span class=\"w\">  </span><span class=\"n\">temperature</span>\n<span class=\"w\">  </span><span class=\"n\">luminousIntensity</span>\n<span class=\"w\">  </span><span class=\"n\">amount</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">)</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"bp\">‚âÉ</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"o\">[</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">time</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">mass</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">current</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">temperature</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">luminousIntensity</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">amount</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">  </span><span class=\"n\">invFun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">x</span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">[</span><span class=\"mi\">2</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">[</span><span class=\"mi\">3</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">[</span><span class=\"mi\">4</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">[</span><span class=\"mi\">5</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">[</span><span class=\"mi\">6</span><span class=\"o\">]</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">  </span><span class=\"n\">left_inv</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"n\">right_inv</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Vector</span><span class=\"bp\">.</span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"k\">fun</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 476863334,
        "sender_full_name": "Cob Cobson",
        "timestamp": 1728947313
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"317929\">@Derek Rhodes</span> I was wondering about the h too.<br>\n<span class=\"user-mention\" data-user-id=\"762089\">@Cob Cobson</span> why are you doing this with example instead of of theorem?</p>",
        "id": 477028471,
        "sender_full_name": "wuyoli",
        "timestamp": 1729009995
    },
    {
        "content": "<p>Is it possible to rewrite <code>i</code> as a <code>Fin 7</code> (using <code>simp_rw</code>?)  and use <code>fin_cases &lt;;&gt; refl</code> to finish this?<br>\nI wasn't able to get the rewrite done.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">VectorQuantityRoundtrip</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">Rat</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">toVector</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fromVector</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">p</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">toVector</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">fromVector</span><span class=\"o\">]</span>\n\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">p</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hj</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hi</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">val_cast_of_lt</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"c1\">-- both the rewrites fail even with simp_rw</span>\n<span class=\"w\">  </span><span class=\"c1\">-- rw [hj]</span>\n<span class=\"w\">  </span><span class=\"c1\">-- rw [‚Üêhi]</span>\n</code></pre></div>",
        "id": 477128685,
        "sender_full_name": "Karthik ü¶ã",
        "timestamp": 1729058679
    },
    {
        "content": "<p>It looks like you forgot to include the theorem statement?</p>",
        "id": 477129022,
        "sender_full_name": "Timo Carlin-Burns",
        "timestamp": 1729058828
    },
    {
        "content": "<p>Ah sorry for that. Fixed it.</p>",
        "id": 477129896,
        "sender_full_name": "Karthik ü¶ã",
        "timestamp": 1729059190
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a>? Even after adding <code>import Batteries</code> I get an error that <code>toVector</code> is not defined</p>",
        "id": 477130110,
        "sender_full_name": "Timo Carlin-Burns",
        "timestamp": 1729059287
    },
    {
        "content": "<p><a href=\"#narrow/stream/113489-new-members/topic/Help.20with.20simple.20proof/near/476595905\">https://leanprover.zulipchat.com/#narrow/stream/113489-new-members/topic/Help.20with.20simple.20proof/near/476595905</a></p>\n<p>I was referring to the code in this message earlier.</p>",
        "id": 477130363,
        "sender_full_name": "Karthik ü¶ã",
        "timestamp": 1729059370
    },
    {
        "content": "<p>Ohh got it. Here <code>interval_cases</code> is probably more direct than <code>fin_cases</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Batteries</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">2</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">3</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">4</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">5</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">6</span><span class=\"o\">]][</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">interval_cases</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>But if you do want to use <code>fin_cases</code>, one way is to use <code>subst hj</code> rather than <code>rw [hj]</code>.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Batteries</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">2</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">3</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">4</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">5</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">6</span><span class=\"o\">]][</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">p</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hj</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"n\">clear_value</span><span class=\"w\"> </span><span class=\"n\">j</span>\n<span class=\"w\">  </span><span class=\"n\">subst</span><span class=\"w\"> </span><span class=\"n\">hj</span>\n<span class=\"w\">  </span><span class=\"n\">fin_cases</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>The version with <code>rw [hj]</code> gives an error because the syntax <code>v[i]</code> is implicitly constructing a proof of <code>i &lt; 7</code>, and then this proof becomes type-incorrect when <code>i</code> changes  to<code>‚Üëj</code> because it is not a proof of <code>‚Üëj &lt; 7</code>. In general <code>rw</code> doesn't work for replacing subterms which are depended on in the type of another subterm in the goal.</p>",
        "id": 477132393,
        "sender_full_name": "Timo Carlin-Burns",
        "timestamp": 1729060185
    },
    {
        "content": "<p>Thats great. Thanks.</p>\n<p>Why do we have to use <code>clear_value</code>? I notice that if I define j using a <code>have</code>, we don't have to do that.</p>",
        "id": 477139215,
        "sender_full_name": "Karthik ü¶ã",
        "timestamp": 1729062454
    },
    {
        "content": "<p><code>subst hj</code> tries to replace all occurrences of <code>i</code> with <code>‚Üëj</code> but since <code>j</code> is defined as <code>j := Fin.mk i p</code>, then that would result in <code>j := Fin.mk ‚Üëj p</code> which would not be a valid definition because it has endless recursion</p>",
        "id": 477139650,
        "sender_full_name": "Timo Carlin-Burns",
        "timestamp": 1729062577
    },
    {
        "content": "<p>That makes sense. Thanks.</p>",
        "id": 477139921,
        "sender_full_name": "Karthik ü¶ã",
        "timestamp": 1729062656
    },
    {
        "content": "<p>after experimenting a bit I came to this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"o\">(</span>\n<span class=\"w\">  </span><span class=\"n\">time</span>\n<span class=\"w\">  </span><span class=\"n\">length</span>\n<span class=\"w\">  </span><span class=\"n\">mass</span>\n<span class=\"w\">  </span><span class=\"n\">current</span>\n<span class=\"w\">  </span><span class=\"n\">temperature</span>\n<span class=\"w\">  </span><span class=\"n\">luminousIntensity</span>\n<span class=\"w\">  </span><span class=\"n\">amountOfSubstance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"o\">)</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">Repr</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">toVector</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"w\">  </span><span class=\"mi\">7</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">#</span><span class=\"n\">v</span><span class=\"o\">[</span>\n<span class=\"w\">    </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">time</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">mass</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">current</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">temperature</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">luminousIntensity</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">amountOfSubstance</span>\n<span class=\"w\">  </span><span class=\"o\">]</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">fromVector</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"n\">time</span><span class=\"w\">              </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"o\">],</span>\n<span class=\"w\">    </span><span class=\"n\">length</span><span class=\"w\">            </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">],</span>\n<span class=\"w\">    </span><span class=\"n\">mass</span><span class=\"w\">              </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">2</span><span class=\"o\">],</span>\n<span class=\"w\">    </span><span class=\"n\">current</span><span class=\"w\">           </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">3</span><span class=\"o\">],</span>\n<span class=\"w\">    </span><span class=\"n\">temperature</span><span class=\"w\">       </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">4</span><span class=\"o\">],</span>\n<span class=\"w\">    </span><span class=\"n\">luminousIntensity</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">5</span><span class=\"o\">],</span>\n<span class=\"w\">    </span><span class=\"n\">amountOfSubstance</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">6</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">QuantityVectorRoundtrip</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">fromVector</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">toVector</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">VectorQuantityRoundtrip</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">toVector</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fromVector</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">p</span>\n<span class=\"w\">  </span><span class=\"n\">interval_cases</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>this works. Is this generally OK or is there still some problem?</p>",
        "id": 477290540,
        "sender_full_name": "wuyoli",
        "timestamp": 1729108777
    },
    {
        "content": "<p>hi, I continued on this and hit another Problem: I can't implement <code>hDiv</code> for another type I defined called <code>physicalUnit</code>. <a href=\"https://live.lean-lang.org/#codez=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\">This</a> is the current version of my code. there seems to be a colliding name of the definition of <code>hDiv</code>. how can I avoid this?</p>",
        "id": 478958934,
        "sender_full_name": "wuyoli",
        "timestamp": 1729876447
    },
    {
        "content": "<p>the colon is in the wrong place.</p>",
        "id": 478959440,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1729876672
    },
    {
        "content": "<p>it should be after <code>instance</code></p>",
        "id": 478959532,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1729876703
    },
    {
        "content": "<p>here's the fixed instance:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HDiv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PhysicalUnit</span><span class=\"w\"> </span><span class=\"n\">aq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PhysicalUnit</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PhysicalUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">aq</span><span class=\"bp\">/</span><span class=\"n\">bq</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">hDiv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PhysicalUnit</span><span class=\"w\"> </span><span class=\"n\">aq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PhysicalUnit</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PhysicalUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">aq</span><span class=\"bp\">/</span><span class=\"n\">bq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">PhysicalUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">av</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PhysicalUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PhysicalUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">av</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PhysicalUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">aq</span><span class=\"bp\">/</span><span class=\"n\">bq</span><span class=\"o\">))</span>\n</code></pre></div>",
        "id": 478959932,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1729876874
    },
    {
        "content": "<p>note that it needs brackets around <code>aq/bq</code> as otherwise it interprets it as <code>(PhysicalUnit aq)/bq</code> (which ofc doesn't make sense).</p>",
        "id": 478960048,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1729876921
    },
    {
        "content": "<p>I still can't do this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">Diameter</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">Period</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">Diameter</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">Period</span>\n</code></pre></div>\n<p>Is there some magic I have to do to make this possible?</p>",
        "id": 478962774,
        "sender_full_name": "wuyoli",
        "timestamp": 1729878039
    },
    {
        "content": "<p>I thought this would be taken care of automatically. This worked for my Implementation of the <code>Mul</code>and <code>Div</code> interface. Does this maybe not work automatically for <code>HDiv</code>?</p>",
        "id": 478976293,
        "sender_full_name": "wuyoli",
        "timestamp": 1729884228
    },
    {
        "content": "<p>Hi, changing  <code>def</code> to <code>abbrev</code> helps it <code>#check</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Meter</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">PhysicalUnit</span><span class=\"w\">  </span><span class=\"n\">length</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Second</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">PhysicalUnit</span><span class=\"w\">  </span><span class=\"n\">time</span>\n</code></pre></div>",
        "id": 478981490,
        "sender_full_name": "Derek Rhodes",
        "timestamp": 1729886577
    },
    {
        "content": "<p>yeah, that works great, but <code>#check</code> gives <code>Diameter / Period : PhysicalUnit (length / length)</code> which should be equivalent to <code>PhysicalUnit #{0,0,0,0,0,0,0}</code> which is basically a number instead of meters/second which is what I would expect.</p>",
        "id": 478982965,
        "sender_full_name": "wuyoli",
        "timestamp": 1729887327
    },
    {
        "content": "<p>yeah, your code has a bug <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span> : </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Second</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">PhysicalUnit</span><span class=\"w\">  </span><span class=\"n\">length</span><span class=\"w\">  </span><span class=\"c1\">-- &lt;-- length should be time</span>\n</code></pre></div>",
        "id": 478983440,
        "sender_full_name": "Derek Rhodes",
        "timestamp": 1729887581
    },
    {
        "content": "<p>Bruh, thank you</p>",
        "id": 478983843,
        "sender_full_name": "wuyoli",
        "timestamp": 1729887778
    },
    {
        "content": "<p>as you can see in the <code>macro_rules</code> part (line 50-70) I Made My own Notation. is this a sane way to do this? It feels a bit cumbersome to do it this way. (as you can see I did some experiments but It didn't work.) Is there a better way to do this?</p>",
        "id": 478985145,
        "sender_full_name": "wuyoli",
        "timestamp": 1729888428
    },
    {
        "content": "<p>There is a <code>mk</code> constructor that <code>structure</code> provides which allows for:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">time</span><span class=\"w\">              </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">length</span><span class=\"w\">            </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mass</span><span class=\"w\">              </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">current</span><span class=\"w\">           </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">temperature</span><span class=\"w\">       </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">luminousIntensity</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">amountOfSubstance</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>\n<p>There is another way using <code>with</code> syntax for <a href=\"https://leanprover.github.io/functional_programming_in_lean/getting-to-know/structures.html#updating-structures\">updating structures</a></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">default</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"c1\">-- ...</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">amountOfSubstance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">default</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">amountOfSubstance</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>",
        "id": 478991336,
        "sender_full_name": "Derek Rhodes",
        "timestamp": 1729892094
    },
    {
        "content": "<p>aah, ok, this makes it pretty simple</p>",
        "id": 478991987,
        "sender_full_name": "wuyoli",
        "timestamp": 1729892483
    },
    {
        "content": "<p>I have a Type for which i automatically derived the <code>Ord</code> class. but I still can't use <code>&gt;</code> and <code>&lt;</code> with it. I saw a class <code>LT</code> and <code>LE</code>exist for this, but I can't generate those implementations using <code>deriving LE, LT</code> what's the difference here?</p>",
        "id": 479568594,
        "sender_full_name": "wuyoli",
        "timestamp": 1730237507
    },
    {
        "content": "<p>It's just not implemented. You can do</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LT</span><span class=\"w\"> </span><span class=\"n\">myThing</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ltOfOrd</span>\n<span class=\"kn\">instance</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LE</span><span class=\"w\"> </span><span class=\"n\">myThing</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">leOfOrd</span>\n</code></pre></div>\n<p>but I had trouble subsequently proving lemmas about my LT/LE. Maybe someone more experienced will chime in and explain it better.</p>",
        "id": 479569376,
        "sender_full_name": "Alex Mobius",
        "timestamp": 1730237870
    },
    {
        "content": "<p>Th have the following definitions:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Energy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Torque</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Energy</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">==</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Torque</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>as you can see when doing it this way I get two values which lean considers to be the same, but I don't want them to be the same. How can I convince  lean five Newton-meter are not equal to five Joules?</p>",
        "id": 480131264,
        "sender_full_name": "wuyoli",
        "timestamp": 1730504369
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"762847\">@wuyoli</span>, could you please paste a link to the updated code you have for this now? I could not find a definition for <code>BasicUnit</code>.</p>",
        "id": 480138397,
        "sender_full_name": "Derek Rhodes",
        "timestamp": 1730511306
    },
    {
        "content": "<p><a href=\"https://live.lean-lang.org/#codez=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\">here</a> is my current version. as you can see there are some other experiments going on, but the current problem is in line 88</p>",
        "id": 480140200,
        "sender_full_name": "wuyoli",
        "timestamp": 1730513137
    },
    {
        "content": "<p>Unfortunately, this is not possible the way you have it currently set up, since in Lean (and more generally, in math) if two objects are constructed exactly the same way, they are equal.</p>\n<p>If you really want <code>N*m</code> to differ from <code>J</code>, the only thing I can think of is adding an 8th dimension for angles, and then doing <code>N*m*radian</code> instead. However, even though I know very little about physics, I think angles are supposed to be dimensionless so this might not be very appealing.</p>\n<p>Maybe instead of drawing the distinction at the actual units, you could split the <code>BasicUnit</code> type into <code>ScalarWithDimension</code> and <code>VectorWithDimension</code> (or whatever you want to call them) types, with the latter having a vector space as a parameter. So that way Energy could be a scalar, while Torque is a dimensional vector in <code>R^3</code> or the exterior power of <code>R^3</code>, depending on whether you like working with cross products or wedge products.</p>",
        "id": 480177929,
        "sender_full_name": "Niels Voss",
        "timestamp": 1730517859
    },
    {
        "content": "<p>I guess it depends on how much of a problem you think it is that 5 newton-meters = 5 joules. I mean, at some point someone might want to ask \"How much energy does it take to apply 5 newton-meters of torque over an angle of 1 radian\" and because radians are unitless, that's basically like multiplying by 1.</p>",
        "id": 480178110,
        "sender_full_name": "Niels Voss",
        "timestamp": 1730517999
    },
    {
        "content": "<p>Aside from \"the torque being a vector issue\", haskell has a <code>newtype</code> feature that allows for something like:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">newtype</span><span class=\"w\"> </span><span class=\"n\">Int1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Int1</span><span class=\"w\"> </span><span class=\"n\">Int</span>\n<span class=\"n\">newtype</span><span class=\"w\"> </span><span class=\"n\">Int2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Int2</span><span class=\"w\"> </span><span class=\"n\">Int</span>\n</code></pre></div>\n<p>, so that passing an <code>Int1</code> in place of <code>Int2</code> is a type error. But, I could not find a Lean4 version of <code>newtype</code>.</p>",
        "id": 480179353,
        "sender_full_name": "Derek Rhodes",
        "timestamp": 1730519287
    },
    {
        "content": "<p>In practice, we either use</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">irreducible</span><span class=\"kd\">]</span>\n<span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">Int1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Int</span>\n</code></pre></div>\n<p>which is a relatively weak sort of encapsulation, since some things go through it and others don't. A stronger version is</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">structure</span><span class=\"w\"> </span><span class=\"n\">Int1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">    </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span>\n</code></pre></div>\n<p>Maybe you would also include a  <code>deriving</code> statement at the bottom, for things like <code>DecidableEq</code> and <code>Repr</code></p>",
        "id": 480179600,
        "sender_full_name": "Niels Voss",
        "timestamp": 1730519577
    },
    {
        "content": "<p>The latter is, for example, used by <code>String</code> to require explicit conversions between <code>String</code> and <code>List Char</code> (and also to allow the compiler to represent strings in UTF-8 while the programming representation is a list of unicode codepoints)</p>",
        "id": 480179696,
        "sender_full_name": "Niels Voss",
        "timestamp": 1730519691
    },
    {
        "content": "<p>Nice! Thanks for the insight Niels.  It looks like including @[irreducible] addresses <span class=\"user-mention\" data-user-id=\"762847\">@wuyoli</span>'s immediate concern.  It sounds like you are seeing some future hurdles. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">irreducible</span><span class=\"kd\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Energy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 480180069,
        "sender_full_name": "Derek Rhodes",
        "timestamp": 1730520009
    },
    {
        "content": "<p>Do note that <code>@[irreducible]</code> doesn't actually change the mathematics behind the theory, it just encourages certain parts of Lean to not unfold the definition in some circumstances. So it's still technically possible to prove <code>Int1 = Int</code>, it's just more difficult.<br>\nThe <code>structure</code> definition on the other hand does actually make it impossible to prove <code>Int1 = Int</code>. It's also not possible to prove <code>Int1 ‚â† Int</code>, because in Lean if types <code>A, B</code> defined in distinct locations have the same cardinality, then the statement <code>A = B</code> is neither provable nor disprovable in Lean. (Although usually most people don't care about equality between types)</p>",
        "id": 480180580,
        "sender_full_name": "Niels Voss",
        "timestamp": 1730520451
    },
    {
        "content": "<p>my main concern is not only equality between types but also somehow making it impossible to do \"illegal\" operations with them (e.g. adding a angle to a natural number even tough their dimensions are equal)</p>",
        "id": 480226544,
        "sender_full_name": "wuyoli",
        "timestamp": 1730560098
    },
    {
        "content": "<p>when doing it with </p>\n<p><span class=\"user-mention silent\" data-user-id=\"521331\">Niels Voss</span> <a href=\"#narrow/channel/113489-new-members/topic/Help.20with.20simple.20proof/near/480179600\">said</a>:</p>\n<blockquote>\n<p>[...] A stronger version is</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">structure</span><span class=\"w\"> </span><span class=\"n\">Int1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">    </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span>\n</code></pre></div>\n<p>[...]</p>\n</blockquote>\n<p>when doing it this way I can't implement any classes for the derived types, right?<br>\nwould it be possible to do something like:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">n</span>\n</code></pre></div>\n<p>with n being somehow guaranteed to be unique every time an new type is generated with <code>BasicUnit</code>?</p>",
        "id": 480253418,
        "sender_full_name": "wuyoli",
        "timestamp": 1730584737
    },
    {
        "content": "<p>What do you mean by derived types? You can certainly implement typeclass instances for <code>Int1</code>, but you have to do so manually. And if you wanted to be able to add <code>Int</code> and <code>Int1</code> you would have to derive an instance of <code>HAdd Int1 Int Int1</code> or maybe allow <code>Int</code> to be coerced into <code>Int1</code>.</p>\n<p>As for your example with <code>n</code>, afaik this is only possible with metaprogramming, where you can derive your own <code>def_unit</code> command to replace <code>def</code>.</p>",
        "id": 480255009,
        "sender_full_name": "Niels Voss",
        "timestamp": 1730586373
    },
    {
        "content": "<p>Maybe an <code>isAngular : Bool</code> parameter would be better than a <code>n : Nat</code> parameter?</p>",
        "id": 480255076,
        "sender_full_name": "Niels Voss",
        "timestamp": 1730586478
    },
    {
        "content": "<p>I'm not sure if there are really no physical <a href=\"https://en.wikipedia.org/wiki/Physical_quantity#Kind\">kinds</a> which differ in more aspects than \"angularity\"</p>",
        "id": 480255552,
        "sender_full_name": "wuyoli",
        "timestamp": 1730586936
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"521331\">Niels Voss</span> <a href=\"#narrow/channel/113489-new-members/topic/Help.20with.20simple.20proof/near/480255009\">said</a>:</p>\n<blockquote>\n<p>What do you mean by derived types? You can certainly implement typeclass instances for <code>Int1</code>, but you have to do so manually. And if you wanted to be able to add <code>Int</code> and <code>Int1</code> you would have to derive an instance of <code>HAdd Int1 Int Int1</code> or maybe allow <code>Int</code> to be coerced into <code>Int1</code>.</p>\n</blockquote>\n<p>I meant exactly this automatic generation of implementations especially since I Intend to introduce a new \"level\" in this tree with toleranced Units something like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">TolerancedUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">toTuple</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">√ó</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">min_lt_max</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">compare</span><span class=\"w\"> </span><span class=\"n\">toTuple</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">toTuple</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">==</span><span class=\"w\"> </span><span class=\"n\">Ordering</span><span class=\"bp\">.</span><span class=\"n\">lt</span>\n</code></pre></div>\n<p>(this is inspired by the Implementation of the <a href=\"https://github.com/leanprover-community/batteries/blob/dc72dcdb8e97b3c56bd70f06f043ed2dee3258e6/Batteries/Data/Vector/Basic.lean#L23-L28\">Vector type</a>)</p>",
        "id": 480256033,
        "sender_full_name": "wuyoli",
        "timestamp": 1730587435
    },
    {
        "content": "<blockquote>\n<p>I meant exactly this automatic generation of implementations especially since I Intend to introduce a new \"level\" in this tree with toleranced Units something like this:</p>\n</blockquote>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">TolerancedUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">toTuple</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">√ó</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">min_lt_max</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">compare</span><span class=\"w\"> </span><span class=\"n\">toTuple</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">toTuple</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">==</span><span class=\"w\"> </span><span class=\"n\">Ordering</span><span class=\"bp\">.</span><span class=\"n\">lt</span>\n</code></pre></div>\n<p>This part is i think whats a bit ambiguous.</p>\n<p>You also said </p>\n<blockquote>\n<p>with n being somehow guaranteed to be unique every time an new type is generated with¬†<code>BasicUnit</code>?</p>\n</blockquote>\n<p>This is actually similar to what a dependent arrow type already does.  This paragraph from 'Theorem Proving in Lean' could help:</p>\n<p>\"Given Œ± : Type and Œ≤ : Œ± ‚Üí Type, think of Œ≤ as a family of types over Œ±, that is, a type Œ≤ a for each a : Œ±. In that case, the type (a : Œ±) ‚Üí Œ≤ a denotes the type of functions f with the property that, for each a : Œ±, f a is an element of Œ≤ a. In other words, the type of the value returned by f depends on its input.</p>\n<p>Notice that (a : Œ±) ‚Üí Œ≤ makes sense for any expression Œ≤ : Type. When the value of Œ≤ depends on a (as does, for example, the expression Œ≤ a in the previous paragraph), (a : Œ±) ‚Üí Œ≤ denotes a dependent function type. When Œ≤ doesn't depend on a, (a : Œ±) ‚Üí Œ≤ is no different from the type Œ± ‚Üí Œ≤. Indeed, in dependent type theory (and in Lean), Œ± ‚Üí Œ≤ is just notation for (a : Œ±) ‚Üí Œ≤ when Œ≤ does not depend on a.\"</p>\n<p>Taken from <a href=\"https://leanprover.github.io/theorem_proving_in_lean4/dependent_type_theory.html\">https://leanprover.github.io/theorem_proving_in_lean4/dependent_type_theory.html</a></p>\n<p>Edit: And more specifically, maybe dependent products are helpful:<br>\n\"Just as dependent function types¬†<code>(a : Œ±) ‚Üí Œ≤ a</code>¬†generalize the notion of a function type¬†<code>Œ± ‚Üí Œ≤</code>¬†by allowing¬†<code>Œ≤</code>¬†to depend on¬†<code>Œ±</code>, dependent Cartesian product types¬†<code>(a : Œ±) √ó Œ≤ a</code>¬†generalize the Cartesian product¬†<code>Œ± √ó Œ≤</code>¬†in the same way. Dependent products are also called¬†<em>sigma</em>¬†types, and you can also write them as¬†<code>Œ£ a : Œ±, Œ≤ a</code>. You can use¬†<code>‚ü®a, b‚ü©</code>¬†or¬†<code>Sigma.mk a b</code>¬†to create a dependent pair. \"</p>",
        "id": 480365057,
        "sender_full_name": "Yan Yablonovskiy",
        "timestamp": 1730693811
    },
    {
        "content": "<p>is there a good way to implement a vectorspace? I would like to implement the <code>Quantity</code> type as a vectorspace, but there doesn't seem to be a vectorspace typeclass. There seems to be the <code>Mathlib.LinearAlgebra.Basis</code> but I don't understand how to use this.</p>",
        "id": 482483836,
        "sender_full_name": "wuyoli",
        "timestamp": 1731618810
    },
    {
        "content": "<p>You'd be implementing <code>Module</code></p>",
        "id": 482483960,
        "sender_full_name": "Rishi Mathur",
        "timestamp": 1731618862
    },
    {
        "content": "<p><code>variable {K M : Type*} [Field K] [AddCommGroup M] [Module K M]</code> says that <code>M</code> is a vector space over <code>K</code>. If you want <code>‚Ñù</code>-vector spaces, just remove <code>K</code> and use <code>variable {M : Type*} [AddCommGroup M] [Module ‚Ñù M]</code>.</p>",
        "id": 482497239,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1731624846
    },
    {
        "content": "<p>I Don't understand. what is this language construct with  <code>[...]</code> called? <br>\nDo you mean something similar to:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span>\n</code></pre></div>\n<p>(I realized I probably can't make <code>Quantity</code> into a  vector space because addition is not defined for all pairs of values. (only defined if both elements are equal.))</p>",
        "id": 482516805,
        "sender_full_name": "wuyoli",
        "timestamp": 1731635532
    },
    {
        "content": "<p>I just mean that</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>is the translation in Lean of the English sentence \"Let <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span> be an <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">R</span></span></span></span>-vector space\".</p>",
        "id": 482559139,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1731660150
    },
    {
        "content": "<p>Can you explain in words what you want to formalize?</p>",
        "id": 482559300,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1731660220
    },
    {
        "content": "<p>I have the type Family <code>BasicUnit</code>, which is parametrized by a <code>Quantity</code>. I Implemented Multiplication and Division for all combinations of this family, but addition and subtraction only for <code>BasicUnit</code>s with the same <code>Quantity</code>.</p>",
        "id": 482561676,
        "sender_full_name": "wuyoli",
        "timestamp": 1731660987
    },
    {
        "content": "<p>Without knowing what <code>Quantity</code> is and a precise definition of <code>BasicUnit</code> it seems difficult to help. Also, I don't understand exactly what you want to do.</p>",
        "id": 482562725,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1731661297
    },
    {
        "content": "<p><a href=\"https://live.lean-lang.org/#codez=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\">here</a> is the current version of my code</p>",
        "id": 482568500,
        "sender_full_name": "wuyoli",
        "timestamp": 1731663148
    },
    {
        "content": "<p>I continued working on this, and now this is my current code: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Rat</span><span class=\"bp\">.</span><span class=\"n\">Init</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">Integral</span><span class=\"bp\">.</span><span class=\"n\">IntervalIntegral</span>\n\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Vector</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">Quantity Represents a Basic Quantity in a 6-Dimensional Vectorspace.</span>\n<span class=\"sd\">Each coordiante is a exponent for a base Unit.</span>\n<span class=\"sd\">Inspired by &lt;https://www.youtube.com/watch?v=bI-FS7aZJpY&amp;t=335s&gt;</span>\n\n<span class=\"sd\">Time, length, mass, current and temperature are self-explanatory.</span>\n\n<span class=\"sd\">Angle is needed to allow for differentiation between e.g. Energy</span>\n<span class=\"sd\">and Torque.</span>\n\n<span class=\"sd\">Luminous Intensity is not in this structure even though it is</span>\n<span class=\"sd\">one of the 7 SI-base units because its analogous to radiant Intensity</span>\n<span class=\"sd\">which is in turn not linearly independent to the other Units</span>\n\n<span class=\"sd\">Amount of substance is not here either because it is just a conversion</span>\n<span class=\"sd\">factor and its Dimension is the null vector.</span>\n<span class=\"sd\">--/</span>\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"o\">(</span>\n<span class=\"w\">  </span><span class=\"n\">time</span>\n<span class=\"w\">  </span><span class=\"n\">length</span>\n<span class=\"w\">  </span><span class=\"n\">mass</span>\n<span class=\"w\">  </span><span class=\"n\">current</span>\n<span class=\"w\">  </span><span class=\"n\">temperature</span>\n<span class=\"w\">  </span><span class=\"n\">angle</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"o\">)</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">DecidableEq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Repr</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">BEq</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">toVector</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"w\">  </span><span class=\"mi\">6</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">#</span><span class=\"n\">v</span><span class=\"o\">[</span>\n<span class=\"w\">    </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">time</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">mass</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">current</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">temperature</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">angle</span>\n<span class=\"w\">  </span><span class=\"o\">]</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">fromVector</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"n\">time</span><span class=\"w\">        </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"o\">],</span>\n<span class=\"w\">    </span><span class=\"n\">length</span><span class=\"w\">      </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">],</span>\n<span class=\"w\">    </span><span class=\"n\">mass</span><span class=\"w\">        </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">2</span><span class=\"o\">],</span>\n<span class=\"w\">    </span><span class=\"n\">current</span><span class=\"w\">     </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">3</span><span class=\"o\">],</span>\n<span class=\"w\">    </span><span class=\"n\">temperature</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">4</span><span class=\"o\">],</span>\n<span class=\"w\">    </span><span class=\"n\">angle</span><span class=\"w\">       </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"mi\">5</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">QuantityVectorRoundtrip</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">fromVector</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">toVector</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">VectorQuantityRoundtrip</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">toVector</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fromVector</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">p</span>\n<span class=\"w\">  </span><span class=\"n\">interval_cases</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">scalar</span><span class=\"w\">      </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">time</span><span class=\"w\">        </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">length</span><span class=\"w\">      </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mass</span><span class=\"w\">        </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">current</span><span class=\"w\">     </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">temperature</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">angle</span><span class=\"w\">       </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Mul</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">fromVector</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Vector</span><span class=\"bp\">.</span><span class=\"n\">zipWith</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">toVector</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">toVector</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Add</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Div</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">div</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">fromVector</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Vector</span><span class=\"bp\">.</span><span class=\"n\">zipWith</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">toVector</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">toVector</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Sub</span><span class=\"bp\">.</span><span class=\"n\">sub</span><span class=\"o\">)</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">ToTypst</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">toTypst</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">String</span>\n\n<span class=\"c1\">--TODO: units are curently not formatted correctly</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ToTypst</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">toTypst</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">unit</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">      </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"bp\">==</span><span class=\"w\"> </span><span class=\"mf\">0.0</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">        </span><span class=\"s2\">\"\"</span>\n<span class=\"w\">      </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"bp\">==</span><span class=\"w\"> </span><span class=\"mf\">1.0</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">        </span><span class=\"n\">s!</span><span class=\"s2\">\"{unit} \"</span>\n<span class=\"w\">      </span><span class=\"k\">else</span>\n<span class=\"w\">        </span><span class=\"n\">s!</span><span class=\"s2\">\"{unit}^{exp} \"</span><span class=\"bp\">;</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"s2\">\"s\"</span><span class=\"w\">  </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">time</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">++</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"s2\">\"m\"</span><span class=\"w\">  </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">++</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"s2\">\"g\"</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">mass</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">++</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"s2\">\"A\"</span><span class=\"w\">  </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">current</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">++</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"s2\">\"K\"</span><span class=\"w\">  </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">temperature</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">++</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"s2\">\"tr\"</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">angle</span><span class=\"o\">)</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">The naming is inspired by ASME Y14.5, which uses \"basic dimension\"</span>\n<span class=\"sd\">and \"directly toleranced dimension\". Here \"unit\" is used instead of</span>\n<span class=\"sd\">\"dimension\" to avoid confusion with the \"dimension\" of a physical</span>\n<span class=\"sd\">quantity.</span>\n<span class=\"sd\">--/</span>\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span>\n<span class=\"w\">  </span><span class=\"c1\">--| mk : Float ‚Üí BasicUnit q</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">Repr</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">BEq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Ord</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HAdd</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">hAdd</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">av</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">av</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HSub</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">hSub</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">av</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">av</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HMul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">aq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">aq</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">hMul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">aq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">aq</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">av</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">av</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">aq</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">))</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HDiv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">aq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">aq</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">hDiv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">aq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">aq</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">av</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">av</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">aq</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">))</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">myMod</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Float</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Float</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Float</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Float</span><span class=\"bp\">.</span><span class=\"n\">floor</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HMod</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">aq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">aq</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">hMod</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">aq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">aq</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">av</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">av</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">aq</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">bq</span><span class=\"o\">))</span>\n<span class=\"w\">      </span><span class=\"c1\">--| BasicUnit.mk av, BasicUnit.mk bv =&gt; (BasicUnit.mk (myMod av bv) : BasicUnit (aq / bq))</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ToTypst</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">toTypst</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"{a} {ToTypst.toTypst q}\"</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Second</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">time</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Meter</span><span class=\"w\">  </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">length</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Gram</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">mass</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Ampere</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">current</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Kelvin</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">temperature</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Turn</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">angle</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Diameter</span><span class=\"w\">      </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Meter</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mf\">4.8</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">DiameterSmall</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Meter</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mf\">3.5</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Period</span><span class=\"w\">        </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Second</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mf\">4.8</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">DiameterSmall</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">Period</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Diameter</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">Period</span><span class=\"o\">)</span>\n\n<span class=\"c1\">-- Torque ‚â† Energy</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Joule</span><span class=\"w\">       </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">NewtonMeter</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">))</span>\n<span class=\"bp\">#</span><span class=\"n\">check_failure</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Joule</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">==</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NewtonMeter</span><span class=\"o\">)</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">ToTypst</span><span class=\"bp\">.</span><span class=\"n\">toTypst</span><span class=\"w\"> </span><span class=\"n\">Diameter</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">exampleTorque</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NewtonMeter</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mf\">44.8</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">exampleTorque</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">ToTypst</span><span class=\"bp\">.</span><span class=\"n\">toTypst</span><span class=\"w\"> </span><span class=\"n\">exampleTorque</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Rotations</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Turn</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mf\">4.0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"o\">)</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">MyEnergy</span><span class=\"w\">  </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Joule</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">exampleTorque</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">Rotations</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">exampleTorque</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">Rotations</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">ToTypst</span><span class=\"bp\">.</span><span class=\"n\">toTypst</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">exampleTorque</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">Rotations</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 486061090,
        "sender_full_name": "wuyoli",
        "timestamp": 1733308706
    },
    {
        "content": "<p>The preferred way to post code here is within triple back-ticks, like this for example:</p>\n<p>(duplicate code now removed)</p>\n<p>That way people can (a) see the code instantly (even on mobile) (b) jump to the <code>live.lean-lang.org</code> web page if they like (by clicking on the \"View in Lean 4 playground\" link at the top right of the code) and (c) copy the code into their clipboard and paste it locally into VS Code (by clicking on the other link in the top right).</p>",
        "id": 486061878,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1733308953
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/113489-new-members/topic/Help.20with.20simple.20proof/near/486061878\">said</a>:</p>\n<blockquote>\n<p>The preferred way to post code here is within triple back-ticks, like this for example:</p>\n</blockquote>\n<p>thank you, did that.</p>",
        "id": 486063694,
        "sender_full_name": "wuyoli",
        "timestamp": 1733309571
    },
    {
        "content": "<p>I'm currently wondering why the <code>#check</code> in line 151 doesn't evaluate the type further?<br>\nIn line 166 the type is at least unfolded a step further, but still in line 165 the definiton does not work even though the type <code>({ time := -2, length := 2, mass := 1, current := 0, temperature := 0, angle := -1 } / angle)</code> should be the same as <code>Joule</code></p>",
        "id": 486083455,
        "sender_full_name": "wuyoli",
        "timestamp": 1733316070
    },
    {
        "content": "<p>The types <code>BasicUnit ({ time := -2, length := 2, mass := 1, current := 0, temperature := 0, angle := -1 } / angle)</code> and <code>Joule</code> are indeed (propositionally) equal. However, it takes some computation to prove that they are equal, so they aren't definitionally equal (<a href=\"https://www.ma.imperial.ac.uk/~buzzard/xena/formalising-mathematics-2023/Part_B/equality.html\">https://www.ma.imperial.ac.uk/~buzzard/xena/formalising-mathematics-2023/Part_B/equality.html</a>). Thus, Lean's type checking system, which only unfolds definitions and does not do any computations or reasoning, is not able to determine that they are equal.</p>\n<p>Lean's type checking system does not attempt to check whether types are propositionally equal because propositional equality is undecidable. It is even undecidable whether basic types like <code>‚Ñï</code> and <code>‚Ñ§</code> are equal to each other: <a class=\"stream-topic\" data-stream-id=\"113489\" href=\"/#narrow/channel/113489-new-members/topic/Newbie.20question.20.3A.20Equality.20of.20Types\">#new members &gt; Newbie question : Equality of Types</a> </p>\n<p>The solution to this problem is to include the <code>Quantity</code> as a field of the <code>BasicUnit</code>, rather than as an argument.<br>\nThis will allow the user to write down illegal expressions such as <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mtext>¬†seconds</mtext><mo>+</mo><mn>5</mn><mtext>¬†meters</mtext></mrow><annotation encoding=\"application/x-tex\">2\\text{ seconds} + 5\\text{ meters}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mord text\"><span class=\"mord\">¬†seconds</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span><span class=\"mord text\"><span class=\"mord\">¬†meters</span></span></span></span></span>, which you can assign the \"junk value\" <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> (or <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>7</mn><mtext>¬†seconds</mtext></mrow><annotation encoding=\"application/x-tex\">7\\text{ seconds}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">7</span><span class=\"mord text\"><span class=\"mord\">¬†seconds</span></span></span></span></span>, or whatever is most convenient). See <a href=\"https://xenaproject.wordpress.com/2020/07/05/division-by-zero-in-type-theory-a-faq/\">https://xenaproject.wordpress.com/2020/07/05/division-by-zero-in-type-theory-a-faq/</a> for why this design is preferable, even though it may seem inelegant at first.</p>",
        "id": 486130537,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1733329052
    },
    {
        "content": "<p>Isn't the whole point of a type system like this not to allow \"illegal\" operations? I thought about this and it seems really easy to accidentally add two values of different units and get unexpected results this way. from the xenaproject blogpost I understand I have to define Theorems to help with this, but I don't understand how this helps.</p>",
        "id": 486560060,
        "sender_full_name": "wuyoli",
        "timestamp": 1733505222
    },
    {
        "content": "<p>It's just not possible to prevent \"illegal\" operations in the way that you're asking for. For example, consider the effect of the following lines to the end of your code. By Fermat's last theorem, <code>length'</code> is the same thing as <code>length</code>, therefore <code>Meter</code> is the same thing as <code>Meter'</code>, therefore it should be possible to perform the addition in the last line below. However, it is not reasonable to expect the Lean compiler to know that it is possible. This is obviously an extreme example, but it the same problem you are running into when you try to reinterpret <code>exampleTorque / Rotations</code> as type <code>Joule</code>.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Classical</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">length'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">‚â•</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"n\">time</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"n\">length</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Meter'</span><span class=\"w\">  </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BasicUnit</span><span class=\"w\"> </span><span class=\"n\">length'</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Meter</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BasicUnit</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Meter'</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>You could prevent \"illegal\" operations by throwing an error at runtime, but you cannot do it using type checking.</p>",
        "id": 486569443,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1733508521
    },
    {
        "content": "<p>You can write <code>unseal Rat.sub in</code> to make lean see through some things. <br>\nBut this still won't make your example work because <code>NewtonMeter</code> has <code>angle := -1</code> so <code>exampleTorque / Rotations</code> has <code>angle := -2</code> but a term of type <code>Joule</code> should have <code>angle := 0</code>.<br>\nShouldn't angles be dimensionless anyway?</p>",
        "id": 486569457,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1733508530
    },
    {
        "content": "<p>For example if <code>NewtonMeter</code> is changed to <code>angle := 1</code> then</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">unseal</span><span class=\"w\"> </span><span class=\"n\">Rat</span><span class=\"bp\">.</span><span class=\"n\">sub</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">MyEnergy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Joule</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\">  </span><span class=\"n\">exampleTorque</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">Rotations</span>\n</code></pre></div>\n<p>just works</p>",
        "id": 486569679,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1733508622
    },
    {
        "content": "<p>Yeah, thanks the unseal worked. </p>\n<blockquote>\n<p>Shouldn't angles be dimensionless anyway?</p>\n</blockquote>\n<p>usually yes, but doing it this way allows me to draw a distinction between Torque and energy, which would otherwise have the same Dimension. </p>\n<blockquote>\n<p>For example if <code>NewtonMeter</code> is changed to <code>angle := 1</code> then [...] just works</p>\n</blockquote>\n<p>yeah, my bad this is the correct Dimension of NewtonMeter.</p>\n<p>Is there a way to make the <code>unseal</code> a part of the HDiv implementation for <code>BasicUnit</code>?</p>",
        "id": 486591621,
        "sender_full_name": "wuyoli",
        "timestamp": 1733517840
    },
    {
        "content": "<p>The <code>unseal Rat.sub in</code> is abusing the fact that <code>2 - 1 = 1</code> <strong>definitionally</strong> so that you won't run into the issues that Mitchell pointed out above. These issues occur when you want to show that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>s</mi><mrow><mn>2</mn><mo>‚àí</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">s^{2-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mbin mtight\">‚àí</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span> is defeq to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>s</mi><mn>1</mn></msup></mrow><annotation encoding=\"application/x-tex\">s^1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span> so you need to explicitly add that line in your applications.</p>\n<p>Alternatively, you can do <code>attribute [local reducible]  Rat.add Rat.sub</code> at the top of the file to effectively achieve the same thing for the whole file, but as the warning indicates, this might cause some automation to not function correctly.</p>",
        "id": 486596199,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1733519926
    },
    {
        "content": "<p>In that case I don't get the  point of lean. I understand that this creates undecidable statemants, but Isn't the point of this to enable automatic generation of types and implementations for those types?</p>",
        "id": 486599823,
        "sender_full_name": "wuyoli",
        "timestamp": 1733521746
    },
    {
        "content": "<p>I am not really sure what you want the type checking system to do. You cannot expect it to prevent the user from writing down undefined expressions in all possible cases. For example, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mi mathvariant=\"normal\">/</mi><mo stretchy=\"false\">(</mo><mn>3</mn><mo>‚ãÖ</mo><mn>2</mn><mo>‚àí</mo><mn>6</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">2 / (3 \\cdot 2 - 6)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2/</span><span class=\"mopen\">(</span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">‚ãÖ</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">‚àí</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">6</span><span class=\"mclose\">)</span></span></span></span> is undefined, but you can still write down <code>(2 / (3 * 2 - 6) : ‚Ñù)</code>in Lean. The compiler won't complain because there's no way to know that it's undefined without actually computing it, which is not what the type checking system is designed to do. We get around this issue by assigning a junk value to division by 0, so that <code>(2 / (3 * 2 - 6) : ‚Ñù) = 0</code> in Lean.</p>\n<p>Similarly, there's no way to know that an expression like <code>(BasicUnit.mk 5 : Joule) + (BasicUnit.mk 5 : NewtonMeter) / (BasicUnit.mk 4 : Turn)</code> is well-defined without actually computing the <code>Quantity</code> of each term. This is why the type system rejects it unless you unseal <code>Rat.sub</code>. The solution to this issue is to make a single type that keeps track of both the value and the <code>Quantity</code>.</p>",
        "id": 486605099,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1733524597
    },
    {
        "content": "<p>I mean, in theory you <em>could</em> define Real division as requiring that the 2nd argument be of type</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">‚â†</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>\n<p>but the point is that the downsides would outweigh the benefits... it would make things unmanageable</p>",
        "id": 486626273,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1733540561
    },
    {
        "content": "<p>In the field of software engineering, \"make illegal states unrepresentable\" is a good rule of thumb, but in Lean it turns out that allowing \"illegal\" states is actually much easier to work with, as mathematicians often care less about the exact value of a variable and more about <em>what properties the value has</em>... when they try to prove those properties, that's when the restrictions come in.</p>",
        "id": 486626603,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1733540844
    },
    {
        "content": "<p>A friend of mine who knows some Agda tried helping me with this and we got here (the rest of the code is the same):<br>\n<a href=\"https://live.lean-lang.org/#codez=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\">this is the code</a><br>\nwe got to the error :\"cannot evaluate, types are not computationally relevant \" is this just another way of looking a the same plroblem we were discussing before or is there some way to do this?</p>",
        "id": 503144994,
        "sender_full_name": "wuyoli",
        "timestamp": 1741044842
    },
    {
        "content": "<p>What do you expect the <code>#eval</code> to do? Remember it needs to print a string.</p>",
        "id": 503145404,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741045036
    },
    {
        "content": "<p>didn't I do <code>deriving Repr</code> for just that?</p>",
        "id": 503145675,
        "sender_full_name": "wuyoli",
        "timestamp": 1741045173
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"762847\">wuyoli</span> <a href=\"#narrow/channel/113489-new-members/topic/Help.20with.20simple.20proof/near/503145675\">said</a>:</p>\n<blockquote>\n<p>didn't I do <code>deriving Repr</code> for just that?</p>\n</blockquote>\n<p>Doing <code>deriving Repr</code> on <code>X</code> means that objects of type <code>X</code> can be printed. But <code>X</code> does not have type <code>X</code>: usually <code>X : Prop</code> or <code>X : Type</code>, but never <code>X : X</code>.</p>",
        "id": 503147039,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741045814
    },
    {
        "content": "<p>but #check doesn't evaluate the expression I give it. is there another command like that?</p>",
        "id": 503147174,
        "sender_full_name": "wuyoli",
        "timestamp": 1741045891
    },
    {
        "content": "<p>You can <code>#reduce (types := true)</code></p>",
        "id": 503147326,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741045972
    }
]