[
    {
        "content": "<p>Why does the following typecheck? <code>groundI I</code> isn't an <code>Option</code> yet i can compare it with <code>some Is</code></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">F</span><span class=\"o\">}</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">groundI</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">why</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"o\">(</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Is</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">groundI</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">Is</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">True</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 575533554,
        "sender_full_name": "Moritz R",
        "timestamp": 1771937626
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=optionCoe#doc\">docs#optionCoe</a></p>",
        "id": 575534232,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1771937795
    },
    {
        "content": "<p>In other words, <code>groundI I</code> gets coerced into <code>some (groundI I)</code></p>",
        "id": 575534453,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1771937856
    },
    {
        "content": "<p>Hm, why does it not show any coercion arrow or anything in the editor (only in the infoview i can see <code>some (groundI I)</code></p>",
        "id": 575534555,
        "sender_full_name": "Moritz R",
        "timestamp": 1771937885
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/4-V1EmlA-snytxRfMACWKvvu/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/4-V1EmlA-snytxRfMACWKvvu/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"3276x452\" src=\"/user_uploads/thumbnail/3121/4-V1EmlA-snytxRfMACWKvvu/image.png/840x560.webp\"></a></div>",
        "id": 575534727,
        "sender_full_name": "Moritz R",
        "timestamp": 1771937943
    },
    {
        "content": "<p>Do we only have coercion arrows in the infoview?</p>",
        "id": 575535153,
        "sender_full_name": "Moritz R",
        "timestamp": 1771938069
    },
    {
        "content": "<p>Coercions don't have dedicated syntax, instead they expand directly, e.g. like how <code>((3 : Nat) : Int)</code> elaborates to <code>(Nat.cast 3 : Int)</code>. The coercion arrow only comes from the fact that <code>Nat.cast</code> is tagged <code>@[coe]</code>. In this case we have <code>(groundI I : Option (List Nat))</code> turn into <code>some (groundI I)</code>. <code>some</code> is not tagged <code>@[coe]</code> (that would surely be confusing) so it just shows up as normal.</p>",
        "id": 575536699,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1771938516
    },
    {
        "content": "<p>I was thinking more about something that would show on the left side that some coercion is applied to <code>groundI I</code></p>",
        "id": 575537510,
        "sender_full_name": "Moritz R",
        "timestamp": 1771938753
    },
    {
        "content": "<p>in the infoview shortening <code>some I</code> to <code>↑I</code> is confusing, i agree</p>",
        "id": 575537643,
        "sender_full_name": "Moritz R",
        "timestamp": 1771938791
    },
    {
        "content": "<p>In the editor? Like the place you input text?</p>",
        "id": 575537844,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1771938841
    },
    {
        "content": "<p>yes</p>",
        "id": 575537873,
        "sender_full_name": "Moritz R",
        "timestamp": 1771938848
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/omqo-4rO8NZTIDLV4GgXRVGj/image.png\">image.png</a><br>\nSome annotation like these implicitly inferred arguments that we already have</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/omqo-4rO8NZTIDLV4GgXRVGj/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"118x70\" src=\"/user_uploads/thumbnail/3121/omqo-4rO8NZTIDLV4GgXRVGj/image.png/840x560.webp\"></a></div>",
        "id": 575537975,
        "sender_full_name": "Moritz R",
        "timestamp": 1771938877
    },
    {
        "content": "<p>so a shadowy arrow in front of <code>groundI I</code></p>",
        "id": 575538085,
        "sender_full_name": "Moritz R",
        "timestamp": 1771938910
    },
    {
        "content": "<p>afaik autoimplicits is the only thing that shows up in the editor directly like that</p>",
        "id": 575538539,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1771939033
    }
]