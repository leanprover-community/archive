[
    {
        "content": "<p>How can I convert a sphere into a ball?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">convert_sphere_into_a_ball</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sphere</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">??</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">convert_sphere_into_a_ball</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Metric</span><span class=\"bp\">.</span><span class=\"n\">sphere</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>A more fundamental way to ask my question might be: If I have an element of a type, is it possible to retrieve the information about how that element was constructed? Alternatively, are there other ways to preserve its construction details?</p>",
        "id": 488837124,
        "sender_full_name": "ptrl",
        "timestamp": 1734095505
    },
    {
        "content": "<p>You can't in your specific example: in the integers, all the spheres centered at 0 of irrational radius, say, are empty, so the sphere does not determine the radius, and in particular the sphere does not determine the corresponding ball.</p>",
        "id": 488837901,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1734095795
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110050\">Sébastien Gouëzel</span> <a href=\"#narrow/channel/113489-new-members/topic/How.20can.20I.20convert.20a.20sphere.20into.20a.20ball.3F/near/488837901\">said</a>:</p>\n<blockquote>\n<p>You can't in your specific example: in the integers, all the spheres centered at 0 of irrational radius, say, are empty, so the sphere does not determine the radius, and in particular the sphere does not determine the corresponding ball.</p>\n</blockquote>\n<p>What about I change it to this? This is a sphere in Three-dimensional Euclidean space.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">convert_sphere_into_a_ball</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sphere</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">??</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">convert_sphere_into_a_ball</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Metric</span><span class=\"bp\">.</span><span class=\"n\">sphere</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 488849547,
        "sender_full_name": "ptrl",
        "timestamp": 1734099277
    },
    {
        "content": "<p>Note first that <code>#eval</code> is most of the time not something you want to use (how would you print an arbitrary set of R^3 on your screen? That's not possible, so <code>#eval</code> can't say something interesting here).</p>\n<p>Then, your function <code>convert_sphere_into_a_ball</code> is taking as argument an arbitrary subset of <code>ℝ^3</code>. What is it supposed to answer if your set is not a sphere?</p>\n<p>Finally, you could do something like: if your argument happens to be a sphere, then use the axiom of choice to pick a center and a radius, and return the ball with corresponding center and radius. And if your argument does not happen to be a sphere, then return the empty set, say. This is a perfectly meaningful Lean function, which would work in any metric space but could have a weird behavior in some situations, as the example of the integer shows. The real question is: what would you like to do with such a function.</p>",
        "id": 488852065,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1734099975
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110050\">Sébastien Gouëzel</span> <a href=\"#narrow/channel/113489-new-members/topic/How.20can.20I.20convert.20a.20sphere.20into.20a.20ball.3F/near/488852065\">said</a>:</p>\n<blockquote>\n<p>Note first that <code>#eval</code> is most of the time not something you want to use (how would you print an arbitrary set of R^3 on your screen? That's not possible, so <code>#eval</code> can't say something interesting here).</p>\n<p>Then, your function <code>convert_sphere_into_a_ball</code> is taking as argument an arbitrary subset of <code>ℝ^3</code>. What is it supposed to answer if your set is not a sphere?</p>\n<p>Finally, you could do something like: if your argument happens to be a sphere, then use the axiom of choice to pick a center and a radius, and return the ball with corresponding center and radius. And if your argument does not happen to be a sphere, then return the empty set, say. This is a perfectly meaningful Lean function, which would work in any metric space but could have a weird behavior in some situations, as the example of the integer shows. The real question is: what would you like to do with such a function.</p>\n</blockquote>\n<p>Here’s my scenario: I have three real variables, x, y, and z. I want to determine the volume of the ball whose sphere defined by the equation (x - a)^2 + (y - b)^2 + (z - c)^2 = r^2. Since this equation specifies a sphere, I need to compute its ball's volume, which requires translating sphere to ball.</p>",
        "id": 488860076,
        "sender_full_name": "ptrl",
        "timestamp": 1734102110
    },
    {
        "content": "<p>I don't see why you would need to start with the equation of the sphere instead of the equation of the ball here. If you want to compute the volume of a ball, isn't it better to formulate it as: the volume of this ball is ..., instead of: the volume of the ball associated to this sphere is ...?</p>",
        "id": 488866531,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1734103911
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"456598\">ptrl</span> <a href=\"#narrow/channel/113489-new-members/topic/How.20can.20I.20convert.20a.20sphere.20into.20a.20ball.3F/near/488860076\">said</a>:</p>\n<blockquote>\n<p>I have three real variables, x, y, and z. I want to determine the volume of the ball whose sphere defined by the equation (x - a)^2 + (y - b)^2 + (z - c)^2 = r^2</p>\n</blockquote>\n<p>Can you be more explicit by providing an <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a>? I have no clear idea what you mean by \"I have three real variables, x, y, and z\". Do you just mean <code>x y z : ℝ</code>? Also, do you have access to the radius <code>r : ℝ</code>? (or the center point?)</p>",
        "id": 488867684,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734104265
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span> <span class=\"user-mention\" data-user-id=\"197836\">@Jireh Loreaux</span> <br>\nIt is from a math exercise, and I want to construct a strictly formal proof of it. So I cannot skip any step here. Here is my <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">RealInnerProductSpace</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"w\"> </span><span class=\"n\">Set</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">BigOperators</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">convert_sphere_to_ball</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sphere</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sphere</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)))</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">hs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">sphere</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"bp\">⟫</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"mi\">10</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"mi\">40</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">8</span><span class=\"o\">]</span><span class=\"bp\">⟫</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">volume</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">convert_sphere_to_ball</span><span class=\"w\"> </span><span class=\"n\">sphere</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">toReal</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">12348</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">π</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 488869066,
        "sender_full_name": "ptrl",
        "timestamp": 1734104685
    },
    {
        "content": "<p>In your code above <code>sphere</code> (in the <code>def</code>) isn't a sphere. It's just some random subset in <code>ℝ³</code>.</p>",
        "id": 488872136,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734105572
    },
    {
        "content": "<p>What do you expect that definition to do when you give it a set which is <em>not</em> a sphere? What do you expect it to do when you give it <code>Set.univ</code>, <code>∅</code>, <code>{x}</code>, or <code>{x, y}</code> for example?</p>",
        "id": 488872740,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734105731
    },
    {
        "content": "<p>Also, why do you prefer to specify a sphere as <code>{v : EuclideanSpace ℝ (Fin 3) | ⟪v, v⟫ = ⟪v, ![10, -40, 8]⟫}</code>?</p>",
        "id": 488873025,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734105824
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/113489-new-members/topic/How.20can.20I.20convert.20a.20sphere.20into.20a.20ball.3F/near/488872740\">said</a>:</p>\n<blockquote>\n<p>What do you expect that definition to do when you give it a set which is <em>not</em> a sphere? What do you expect it to do when you give it <code>Set.univ</code>, <code>∅</code>, <code>{x}</code>, or <code>{x, y}</code> for example?</p>\n</blockquote>\n<p>Maybe <code>∅</code> is fine. <br>\nWhy I prefer to specify a sphere as <code>{v : EuclideanSpace ℝ (Fin 3) | ⟪v, v⟫ = ⟪v, ![10, -40, 8]⟫}</code> because it is from a math exercise:<br>\n<a href=\"/user_uploads/3121/7uKXHq9S0qyyQCwwTPtA6_WF/2024-12-14-00.17.45.png\">screenshot2024-12-14 00.17.45.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/7uKXHq9S0qyyQCwwTPtA6_WF/2024-12-14-00.17.45.png\" title=\"screenshot2024-12-14 00.17.45.png\"><img data-original-dimensions=\"1332x290\" src=\"/user_uploads/thumbnail/3121/7uKXHq9S0qyyQCwwTPtA6_WF/2024-12-14-00.17.45.png/840x560.webp\"></a></div>",
        "id": 488875989,
        "sender_full_name": "ptrl",
        "timestamp": 1734106697
    },
    {
        "content": "<p>okay, in that case, I suggest you provide a function that takes <code>w : EuclideanSpace ℝ (Fin 3)</code> and outputs the center and radius of the sphere <code>{v : EuclideanSpace ℝ (Fin 3) | ⟪v, v⟫ = ⟪v, w⟫}</code>. It's actually rather straightforward. Do you know how to do this on paper?</p>",
        "id": 488876606,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734106920
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/113489-new-members/topic/How.20can.20I.20convert.20a.20sphere.20into.20a.20ball.3F/near/488876606\">said</a>:</p>\n<blockquote>\n<p>okay, in that case, I suggest you provide a function that takes <code>w : EuclideanSpace ℝ (Fin 3)</code> and outputs the center and radius of the sphere <code>{v : EuclideanSpace ℝ (Fin 3) | ⟪v, v⟫ = ⟪v, w⟫}</code>. It's actually rather straightforward. Do you know how to do this on paper?</p>\n</blockquote>\n<p>Sorry I don't know. Could you please tell me how to do? <span aria-label=\"exploding head\" class=\"emoji emoji-1f92f\" role=\"img\" title=\"exploding head\">:exploding_head:</span></p>",
        "id": 488877408,
        "sender_full_name": "ptrl",
        "timestamp": 1734107165
    },
    {
        "content": "<p>I suggest you start by doing this in two dimensions. In that case, <code>⟪v, v⟫ = ⟪v, w⟫</code> will represent the equation of a circle (say <code>v = ![x, y]</code> and <code>w = ![a, b]</code>, so <code>x y</code> are your variables and <code>a b</code> your constants).</p>",
        "id": 488877640,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734107261
    },
    {
        "content": "<p>Your goal is then to change the equation into the form <code>(x - h) ^ 2 + (y - k) ^ 2 = r ^ 2</code>. Hint: you'll need to complete the square (twice).</p>",
        "id": 488877832,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734107325
    },
    {
        "content": "<p>Once you do this in two dimensions, and you find your center and radius, I think it will be more clear how to generalize to three dimensions.</p>",
        "id": 488877959,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734107364
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/113489-new-members/topic/How.20can.20I.20convert.20a.20sphere.20into.20a.20ball.3F/near/488877640\">said</a>:</p>\n<blockquote>\n<p>I suggest you start by doing this in two dimensions. In that case, <code>⟪v, v⟫ = ⟪v, w⟫</code> will represent the equation of a circle (say <code>v = ![x, y]</code> and <code>w = ![a, b]</code>, so <code>x y</code> are your variables and <code>a b</code> your constants).</p>\n</blockquote>\n<p>Thanks! I will try it out <span aria-label=\"high five\" class=\"emoji emoji-1f590\" role=\"img\" title=\"high five\">:high_five:</span></p>",
        "id": 488878210,
        "sender_full_name": "ptrl",
        "timestamp": 1734107433
    },
    {
        "content": "<p>The informal idea \"convert a sphere into a ball\" makes more sense if you start with a <em>bundled</em> sphere - not a set of points but a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=EuclideanGeometry.Sphere#doc\">docs#EuclideanGeometry.Sphere</a> which bundles the information about the <code>center</code> and <code>radius</code>. It would indeed make sense to add functions to mathlib that convert such an object to the set of points for the corresponding <code>ball</code> or <code>closedBall</code>. (Despite the name and location, <code>EuclideanGeometry.Sphere</code> is defined in any <code>MetricSpace</code> and the definition would work in any <code>PseudoMetricSpace</code>. It would probably make sense to move it to a more general location, though a suitable new name would be needed that clearly distinguishes it from the unbundled definition <code>Metric.sphere</code>.)</p>",
        "id": 488891683,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1734112043
    },
    {
        "content": "<p>(So if you start with an equation for the sphere, the mathlib-style approach would start with an operation that constructs a bundled sphere from the equation, then compose that with an operation to construct an unbundled ball from the bundled sphere.)</p>",
        "id": 488892772,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1734112426
    },
    {
        "content": "<p>Sure, but I think the issue in this case is that the original problem is ill-posed. That equation does <em>not</em> specify a \"solid\" (at least not in the traditional sense of something with Hausdorff dimension 3), and instead one needs the inequality <code>⟪v, v⟫ ≤ ⟪v, w⟫</code>, where <code>w</code> is fixed. In this case, the set of such <code>v</code> is (relatively easily) identified with <code>Metric.closedBall x r</code> for an appropriate <code>x</code> and <code>r</code> (which I am explicitly omitting so that the OP can figure it out for themselves).</p>",
        "id": 488894013,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734112857
    },
    {
        "content": "<p>In other words, the Lean theorem statement which corresponds to the informally stated problem is:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">InnerProductSpace</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Metric</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span><span class=\"w\"> </span><span class=\"n\">ENNReal</span><span class=\"w\"> </span><span class=\"n\">Real</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">volume</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"bp\">⟫_</span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">!₂</span><span class=\"o\">[(</span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"mi\">40</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">8</span><span class=\"o\">]</span><span class=\"bp\">⟫_</span><span class=\"n\">ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofReal</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">12348</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">π</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 488896854,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734114021
    },
    {
        "content": "<p>I've proven this, by the way. The annoying bit was mainly that we don't have a version of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=EuclideanSpace.volume_closedBall#doc\">docs#EuclideanSpace.volume_closedBall</a> specialized to three dimensions.</p>",
        "id": 488898316,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734114603
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">InnerProductSpace</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Metric</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span><span class=\"w\"> </span><span class=\"n\">ENNReal</span><span class=\"w\"> </span><span class=\"n\">Real</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">volume_closedBall_dim_three</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">volume</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">closedBall</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofReal</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">π</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">EuclideanSpace</span><span class=\"bp\">.</span><span class=\"n\">volume_closedBall</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">card_fin</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">ENNReal</span><span class=\"bp\">.</span><span class=\"n\">ofReal_pow</span><span class=\"w\"> </span><span class=\"n\">hr</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">cast_ofNat</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">ENNReal</span><span class=\"bp\">.</span><span class=\"n\">ofReal_mul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">pow_nonneg</span><span class=\"w\"> </span><span class=\"n\">hr</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)]</span>\n<span class=\"w\">  </span><span class=\"n\">congr</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">Gamma_add_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">norm_num</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">norm_num</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">Gamma_add_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">norm_num</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">Gamma_one_half_eq</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"n\">π</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">sqrt_pos_of_pos</span><span class=\"w\"> </span><span class=\"n\">pi_pos</span>\n<span class=\"w\">  </span><span class=\"n\">field_simp</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">pow_succ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">√</span><span class=\"n\">π</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">sq_sqrt</span><span class=\"w\"> </span><span class=\"n\">pi_nonneg</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">ring</span>\n</code></pre></div>",
        "id": 488898578,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734114684
    },
    {
        "content": "<p>I have some calculations related to this which I will PR shortly.</p>",
        "id": 488910173,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734119540
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"456598\">ptrl</span> <a href=\"#narrow/channel/113489-new-members/topic/How.20can.20I.20convert.20a.20sphere.20into.20a.20ball.3F/near/488849547\">said</a>:</p>\n<blockquote>\n<p>[<code>Metric.sphere ((0,0,0) : ℝ × ℝ × ℝ) 1</code>] is a sphere in Three-dimensional Euclidean space.</p>\n</blockquote>\n<p>It looks like you worked this out yourself by using EuclideanSpace, but I want to emphasize that the code you gave here is the surface of cube!</p>",
        "id": 488922189,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1734124540
    },
    {
        "content": "<p>indeed, since the <code>MetricSpace</code> instance for <code>Prod</code> is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Prod.metricSpaceMax#doc\">docs#Prod.metricSpaceMax</a></p>",
        "id": 488922550,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1734124696
    },
    {
        "content": "<p>see also <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/MetricSpace/Pseudo/Constructions.html#Prod.dist_eq\">Prod.dist_eq</a></p>",
        "id": 488922667,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1734124759
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/19949\">#19949</a> computes the volume of Euclidean balls in even and odd dimensions (with the nice factorial and double factorial formulas), and gives specialized <code>simp</code> lemmas for dimensions two and three.</p>",
        "id": 488934817,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734130830
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"456598\">@ptrl</span> Now that the above PR is merged, this can problem can be solved (reasonably) easily, although it still requires a bit of familiarity with the library. Note: the solution below contains spoilers, namely about the center and radius of the sphere described in the problem. The center and radius are easily described, even in an arbitrary number of dimensions, so I've done that.</p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>solution (contains spoilers)</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib.MeasureTheory.Measure.Lebesgue.VolumeOfBalls</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">scoped</span><span class=\"w\"> </span><span class=\"n\">InnerProductSpace</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span><span class=\"w\"> </span><span class=\"n\">ENNReal</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"w\"> </span><span class=\"n\">Metric</span>\n\n<span class=\"kd\">lemma</span><span class=\"w\"> </span><span class=\"n\">set_inner_sub_inner_nonneg_eq_closedBall</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">closedBall</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‖</span><span class=\"n\">w</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">v</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">PiLp.inner_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">RCLike.inner_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">conj_trivial</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sub_nonneg</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Set.mem_setOf_eq</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">one_div</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mem_closedBall</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">dist_eq_norm</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">abs_of_nonneg</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">norm_nonneg</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">abs_of_nonneg</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"n\">w</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">positivity</span><span class=\"o\">),</span>\n<span class=\"w\">    </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">sq_le_sq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">div_pow</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">PiLp.norm_sq_eq_of_L2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PiLp.sub_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PiLp.smul_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">smul_eq_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Real.norm_eq_abs</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">sq_abs</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Finset.sum_div</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">sub_nonneg</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">sub_nonneg</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Finset.sum</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"o\">)]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Finset.sum_sub_distrib</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">congr</span><span class=\"bp\">!</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">-</span>\n<span class=\"w\">  </span><span class=\"n\">ring</span>\n\n<span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">volume</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">!₂</span><span class=\"o\">[(</span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"mi\">40</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">8</span><span class=\"o\">]</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofReal</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">12348</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">π</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">set_inner_sub_inner_nonneg_eq_closedBall</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace.volume_closedBall_fin_three</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">ofReal_pow</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">positivity</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">ofReal_mul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">positivity</span><span class=\"o\">)]</span>\n<span class=\"w\">  </span><span class=\"n\">congr</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">PiLp.norm_eq_of_L2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">WithLp.equiv_symm_pi_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">norm_eq_abs</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sq_abs</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"bp\">?</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fin.sum_univ_def</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">List.map</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">says</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fin.sum_univ_def</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">List.map</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Fin.zero_eta</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Fin.isValue</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Matrix.cons_val_zero</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"n\">Fin.mk_one</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Matrix.cons_val_one</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Matrix.head_cons</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">even_two</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Even.neg_pow</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Fin.reduceFinMk</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"n\">Matrix.cons_val_two</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat.succ_eq_add_one</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat.reduceAdd</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Matrix.tail_cons</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">List.sum_cons</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"n\">List.sum_nil</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">add_zero</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"mi\">1764</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">42</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Real.sqrt_eq_iff_eq_sq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">norm_num</span>\n<span class=\"w\">  </span><span class=\"n\">norm_num</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">this</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">ring</span>\n</code></pre></div>\n</div></div>",
        "id": 489014331,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734199409
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/113489-new-members/topic/How.20can.20I.20convert.20a.20sphere.20into.20a.20ball.3F/near/489014331\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"456598\">ptrl</span> Now that the above PR is merged, this can problem can be solved (reasonably) easily, although it still requires a bit of familiarity with the library. Note: the solution below contains spoilers, namely about the center and radius of the sphere described in the problem. The center and radius are easily described, even in an arbitrary number of dimensions, so I've done that.</p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>solution (contains spoilers)</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib.MeasureTheory.Measure.Lebesgue.VolumeOfBalls</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">scoped</span><span class=\"w\"> </span><span class=\"n\">InnerProductSpace</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span><span class=\"w\"> </span><span class=\"n\">ENNReal</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"w\"> </span><span class=\"n\">Metric</span>\n\n<span class=\"kd\">lemma</span><span class=\"w\"> </span><span class=\"n\">set_inner_sub_inner_nonneg_eq_closedBall</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">closedBall</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‖</span><span class=\"n\">w</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">v</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">PiLp.inner_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">RCLike.inner_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">conj_trivial</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sub_nonneg</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Set.mem_setOf_eq</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">one_div</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mem_closedBall</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">dist_eq_norm</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">abs_of_nonneg</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">norm_nonneg</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">abs_of_nonneg</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"n\">w</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">positivity</span><span class=\"o\">),</span>\n<span class=\"w\">    </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">sq_le_sq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">div_pow</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">PiLp.norm_sq_eq_of_L2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PiLp.sub_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PiLp.smul_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">smul_eq_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Real.norm_eq_abs</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">sq_abs</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Finset.sum_div</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">sub_nonneg</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">sub_nonneg</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Finset.sum</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"o\">)]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Finset.sum_sub_distrib</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">congr</span><span class=\"bp\">!</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">-</span>\n<span class=\"w\">  </span><span class=\"n\">ring</span>\n\n<span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">volume</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">!₂</span><span class=\"o\">[(</span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"mi\">40</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">8</span><span class=\"o\">]</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofReal</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">12348</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">π</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">set_inner_sub_inner_nonneg_eq_closedBall</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace.volume_closedBall_fin_three</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">ofReal_pow</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">positivity</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">ofReal_mul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">positivity</span><span class=\"o\">)]</span>\n<span class=\"w\">  </span><span class=\"n\">congr</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">PiLp.norm_eq_of_L2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">WithLp.equiv_symm_pi_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">norm_eq_abs</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sq_abs</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"bp\">?</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fin.sum_univ_def</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">List.map</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">says</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fin.sum_univ_def</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">List.map</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Fin.zero_eta</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Fin.isValue</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Matrix.cons_val_zero</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"n\">Fin.mk_one</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Matrix.cons_val_one</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Matrix.head_cons</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">even_two</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Even.neg_pow</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Fin.reduceFinMk</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"n\">Matrix.cons_val_two</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat.succ_eq_add_one</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat.reduceAdd</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Matrix.tail_cons</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">List.sum_cons</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"n\">List.sum_nil</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">add_zero</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"mi\">1764</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">42</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Real.sqrt_eq_iff_eq_sq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">norm_num</span>\n<span class=\"w\">  </span><span class=\"n\">norm_num</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">this</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">ring</span>\n</code></pre></div>\n<p></div></div><br>\n</p>\n</blockquote>\n<p>Thank you so much for your answer. It’s incredibly helpful to me. I really appreciate it! <span aria-label=\"heart\" class=\"emoji emoji-2764\" role=\"img\" title=\"heart\">:heart:</span></p>",
        "id": 489053518,
        "sender_full_name": "ptrl",
        "timestamp": 1734238663
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"456598\">ptrl</span> has marked this topic as resolved.</p>",
        "id": 489057434,
        "sender_full_name": "Notification Bot",
        "timestamp": 1734242532
    }
]