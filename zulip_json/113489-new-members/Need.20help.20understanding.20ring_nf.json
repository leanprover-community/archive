[
    {
        "content": "<p>I think I am lacking understanding on how Floats and Real work in Mathlib.  In particular, I have a hard time seeing how <code>ring_nf</code> works for <code>foo</code> but not <code>bar</code> in the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mf\">0.27</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">27</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">100</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">ring_nf</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.27</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">27</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">100</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">ring_nf</span><span class=\"w\"> </span><span class=\"c1\">-- why doesn't this work?</span>\n</code></pre></div>\n<p>How can one find out how Lean interpreted the constants <code>0.27</code> and <code>27 / 100</code> in <code>bar</code>?  I suppose Lean automatically treats <code>27 / 100</code> as <code>ℝ</code> in <code>foo</code>. Is that right? Also, is <code>bar</code> actually provable? Any help is greatly appreciated.</p>",
        "id": 497728897,
        "sender_full_name": "Kevin Cheung",
        "timestamp": 1738693038
    },
    {
        "content": "<p><code>Float</code> is not a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CommSemiring#doc\">docs#CommSemiring</a>, so <code>ring_nf</code> will not work.</p>",
        "id": 497729769,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1738693358
    },
    {
        "content": "<p>So, in <code>bar</code>, Lean is treating everything as <code>Float</code>? In this case, is it provable?</p>",
        "id": 497729940,
        "sender_full_name": "Kevin Cheung",
        "timestamp": 1738693432
    },
    {
        "content": "<p>I don't think it is provable, since floats are opaque.</p>",
        "id": 497730120,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1738693494
    },
    {
        "content": "<p>It's impossible to prove statements involving floats? For example, the following is unprovable?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.2</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mf\">0.1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 497730809,
        "sender_full_name": "Kevin Cheung",
        "timestamp": 1738693768
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"397075\">Kevin Cheung</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497728897\">said</a>:</p>\n<blockquote>\n<p>...<br>\nHow can one find out how Lean interpreted the constants <code>0.27</code> and <code>27 / 100</code> in <code>bar</code>? <br>\n...</p>\n</blockquote>\n<p>For future situations, if you mouse over the term <code>0.27</code> in the Lean Infoview, you'll see the way that Lean interprets the literal:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">@</span><span class=\"n\">OfScientific.ofScientific</span><span class=\"w\"> </span><span class=\"n\">Float</span><span class=\"w\"> </span><span class=\"n\">instOfScientificFloat</span><span class=\"w\"> </span><span class=\"mi\">27</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Float</span>\n</code></pre></div>\n<p>Does anyone know the programmatic way to obtain what the Infoview is showing? I browsed the <a href=\"https://leanprover-community.github.io/lean4-metaprogramming-book/\">metaprogramming book</a> but couldn't find it.</p>",
        "id": 497744957,
        "sender_full_name": "Walter Moreira",
        "timestamp": 1738698897
    },
    {
        "content": "<p>What do you mean by programmatic?</p>",
        "id": 497745639,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1738699124
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"397075\">Kevin Cheung</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497730809\">said</a>:</p>\n<blockquote>\n<p>It's impossible to prove statements involving floats? For example, the following is unprovable?</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.2</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mf\">0.1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>This seems to be unprovable.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.2</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mf\">0.1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">GT</span><span class=\"bp\">.</span><span class=\"n\">gt</span><span class=\"w\"> </span><span class=\"n\">LT</span><span class=\"bp\">.</span><span class=\"n\">lt</span><span class=\"w\"> </span><span class=\"n\">instLTFloat</span><span class=\"w\"> </span><span class=\"n\">Float</span><span class=\"bp\">.</span><span class=\"n\">lt</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">OfScientific</span><span class=\"bp\">.</span><span class=\"n\">ofScientific</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">instOfScientificFloat</span>\n<span class=\"w\">  </span><span class=\"k\">show</span>\n<span class=\"w\">    </span><span class=\"n\">FloatSpec</span><span class=\"bp\">.</span><span class=\"n\">lt</span>\n<span class=\"w\">      </span><span class=\"n\">floatSpec</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">Float</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Float</span><span class=\"bp\">.</span><span class=\"n\">ofScientific</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">nat_lit</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">nat_lit</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)))</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">Float</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Float</span><span class=\"bp\">.</span><span class=\"n\">ofScientific</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">nat_lit</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">nat_lit</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)))</span>\n<span class=\"w\">  </span><span class=\"c1\">-- no further reduction is possible</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"c1\">-- `1`, `2`, and `true` are fully reduced terms</span>\n\n<span class=\"c1\">-- `floatSpec` and `Float.ofScientific` are opaque constants with no definition</span>\n\n<span class=\"c1\">-- `FloatSpec.lt` is a projection coming from the type `FloatSpec`</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">info: structure FloatSpec : Type 1</span>\n<span class=\"sd\">number of parameters: 0</span>\n<span class=\"sd\">fields:</span>\n<span class=\"sd\">  FloatSpec.float : Type</span>\n<span class=\"sd\">  FloatSpec.val : self.float</span>\n<span class=\"sd\">  FloatSpec.lt : self.float → self.float → Prop</span>\n<span class=\"sd\">  FloatSpec.le : self.float → self.float → Prop</span>\n<span class=\"sd\">  FloatSpec.decLt : DecidableRel self.lt</span>\n<span class=\"sd\">  FloatSpec.decLe : DecidableRel self.le</span>\n<span class=\"sd\">constructor:</span>\n<span class=\"sd\">  FloatSpec.mk (float : Type) (val : float) (lt le : float → float → Prop) (decLt : DecidableRel lt)</span>\n<span class=\"sd\">    (decLe : DecidableRel le) : FloatSpec</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">FloatSpec</span>\n\n<span class=\"c1\">-- `Float.val` is a projection coming from the type `Float`</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">info: structure Float : Type</span>\n<span class=\"sd\">number of parameters: 0</span>\n<span class=\"sd\">fields:</span>\n<span class=\"sd\">  Float.val : floatSpec.float</span>\n<span class=\"sd\">constructor:</span>\n<span class=\"sd\">  Float.mk (val : floatSpec.float) : Float</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">Float</span>\n\n<span class=\"c1\">-- however,</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.2</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mf\">0.1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">native_decide</span>\n<span class=\"c1\">-- '_example' depends on axioms: [propext, Classical.choice, Lean.ofReduceBool]</span>\n</code></pre></div>",
        "id": 497748611,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1738700141
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"269975\">Walter Moreira</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497744957\">said</a>:</p>\n<blockquote>\n<p>Does anyone know the programmatic way to obtain what the Infoview is showing?</p>\n</blockquote>\n<p><code>#check 0.27</code> ?</p>",
        "id": 497752064,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1738701462
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497745639\">said</a>:</p>\n<blockquote>\n<p>What do you mean by programmatic?</p>\n</blockquote>\n<p>I was too vague. I would like to find a function or command (similar to <code>#print</code>) that shows the term with the the coercions that Lean is applying.</p>",
        "id": 497752486,
        "sender_full_name": "Walter Moreira",
        "timestamp": 1738701614
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"269975\">Walter Moreira</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497752486\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497745639\">said</a>:</p>\n<blockquote>\n<p>What do you mean by programmatic?</p>\n</blockquote>\n<p>I was too vague. I would like to find a function or command (similar to <code>#print</code>) that shows the term with the the coercions that Lean is applying.</p>\n</blockquote>\n<p>I have also been trying to find such a command as well to no avail.</p>",
        "id": 497752589,
        "sender_full_name": "Kevin Cheung",
        "timestamp": 1738701668
    },
    {
        "content": "<p>Looking at <code>native_decide</code>, it seems that it takes computations from outside the trusted kernel. Is this the only way one can deal with proofs involving <code>Float</code>?</p>",
        "id": 497752860,
        "sender_full_name": "Kevin Cheung",
        "timestamp": 1738701796
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"761203\">Vlad Tsyrklevich</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497752064\">said</a>:</p>\n<blockquote>\n<p><code>#check 0.27</code> ?</p>\n</blockquote>\n<p>Yes, that definitely shows <code>Float</code> as the type of the literal. Is it always guaranteed that will be the coercion in an arbitrary expression (like <code>bar</code> above)?</p>",
        "id": 497752938,
        "sender_full_name": "Walter Moreira",
        "timestamp": 1738701827
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"269975\">Walter Moreira</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497752486\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497745639\">said</a>:</p>\n<blockquote>\n<p>What do you mean by programmatic?</p>\n</blockquote>\n<p>I was too vague. I would like to find a function or command (similar to <code>#print</code>) that shows the term with the the coercions that Lean is applying.</p>\n</blockquote>\n<p><code>#print</code> is a command. Is that no good? You can also <code>#check</code>.</p>",
        "id": 497753220,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1738701940
    },
    {
        "content": "<p>In the following, <code>#check</code> just shows <code>Prop</code> and <code>#print</code> fails</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mf\">0.27</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">)</span>\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mf\">0.27</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 497753635,
        "sender_full_name": "Kevin Cheung",
        "timestamp": 1738702112
    },
    {
        "content": "<p>But one can hover over the numbers in Infoview to see the full picture for <code>#check</code>. So that works.</p>",
        "id": 497753757,
        "sender_full_name": "Kevin Cheung",
        "timestamp": 1738702175
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"397075\">Kevin Cheung</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497753757\">said</a>:</p>\n<blockquote>\n<p>But one can hover over the numbers in Infoview to see the full picture for <code>#check</code>. So that works.</p>\n</blockquote>\n<p>Yes, that's what I meant. Is this no good?</p>",
        "id": 497753802,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1738702196
    },
    {
        "content": "<p>Or do you want to print it without having to hover?</p>",
        "id": 497753877,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1738702210
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"397075\">Kevin Cheung</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497752860\">said</a>:</p>\n<blockquote>\n<p>Looking at <code>native_decide</code>, it seems that it takes computations from outside the trusted kernel. Is this the only way one can deal with proofs involving <code>Float</code>?</p>\n</blockquote>\n<p>Broadly speaking yes, because of what was said above about opaqueness. Having said that, are you sure you want to work with floats as opposed to rationals? floats are really nasty to prove anything about even on paper: addition and multiplication are not associative, do not distribute over each other, etc</p>",
        "id": 497753896,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1738702218
    },
    {
        "content": "<p>Yes. Print without hovering, if possible.</p>",
        "id": 497753920,
        "sender_full_name": "Kevin Cheung",
        "timestamp": 1738702233
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497753802\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"397075\">Kevin Cheung</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497753757\">said</a>:</p>\n<blockquote>\n<p>But one can hover over the numbers in Infoview to see the full picture for <code>#check</code>. So that works.</p>\n</blockquote>\n<p>Yes, that's what I meant. Is this no good?</p>\n</blockquote>\n<p>We were hoping to get the more informative term: <code>@OfScientific.ofScientific Float instOfScientificFloat 27 true 2 : Float\n</code></p>",
        "id": 497754021,
        "sender_full_name": "Walter Moreira",
        "timestamp": 1738702279
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"466290\">Luigi Massacci</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497753896\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"397075\">Kevin Cheung</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497752860\">said</a>:</p>\n<blockquote>\n<p>Looking at <code>native_decide</code>, it seems that it takes computations from outside the trusted kernel. Is this the only way one can deal with proofs involving <code>Float</code>?</p>\n</blockquote>\n<p>Broadly speaking yes, because of what was said above about opaqueness. Having said that, are you sure you want to work with floats as opposed to rationals? floats are really nasty to prove anything about even on paper: addition and multiplication are not associative, do not distribute over each other, etc</p>\n</blockquote>\n<p>I'm not at the point of doing the following but what if I want to prove some properties about numerical algorithms that work with <code>Float</code>? This kind of work is unavoidable, I think, in numerical analysis.</p>",
        "id": 497754098,
        "sender_full_name": "Kevin Cheung",
        "timestamp": 1738702313
    },
    {
        "content": "<p>I mean, pen and paper correctness proofs for numerical analysis quite often pretend to work with the reals anyway, which is more than fine in most cases</p>",
        "id": 497754529,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1738702489
    },
    {
        "content": "<p>(and given how little numerical stuff there is in lean, right now that would already be a solid project, without worrying about verifying the correctness of an actually runnable implementation)</p>",
        "id": 497754859,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1738702614
    },
    {
        "content": "<p>also, for actual software, <code>native_decide</code> is not bad at all</p>",
        "id": 497755329,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1738702767
    },
    {
        "content": "<p>If you want examples of working with Float though, you can look at <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf\">SciLean</a> by <span class=\"user-mention\" data-user-id=\"346070\">@Tomas Skrivan</span></p>",
        "id": 497755635,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1738702886
    },
    {
        "content": "<p>In SciLean, I have a class <code>RealScalar R</code>(extends <code>RCLike R</code>) that says <code>R</code> behaves like a real number and provides all the basic functions like <code>exp</code>, <code>sin</code> etc. Most of the definitions and theorems are then parameterized by this type <code>R</code>and instance of <code>RealScalar R</code>. When it comes to actually running the programs I just provide inconsistent instance <code>RealScalar Float</code>.</p>",
        "id": 497756245,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1738703118
    },
    {
        "content": "<p>I was able to write this (it doesn't handle corner cases), still can't find a builtin command to do it.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">Elab</span><span class=\"w\"> </span><span class=\"n\">Command</span><span class=\"w\"> </span><span class=\"n\">Meta</span>\n\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">see</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"s2\">\"#see\"</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">command</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">command_elab</span><span class=\"w\"> </span><span class=\"n\">see</span><span class=\"kd\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">elabShow</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CommandElab</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"bp\">#</span><span class=\"n\">see</span><span class=\"bp\">%$</span><span class=\"n\">tk</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">term</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">withoutModifyingEnv</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">runTermElabM</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">withDeclName</span><span class=\"w\"> </span><span class=\"ss\">`_show</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"c1\">-- -- show signature for `#check id`/`#check @id`</span>\n<span class=\"w\">    </span><span class=\"c1\">-- if let `($id:ident) := term then</span>\n<span class=\"w\">    </span><span class=\"c1\">--   try</span>\n<span class=\"w\">    </span><span class=\"c1\">--     for c in (← realizeGlobalConstWithInfos term) do</span>\n<span class=\"w\">    </span><span class=\"c1\">--       addCompletionInfo &lt;| .id term id.getId (danglingDot := false) {} none</span>\n<span class=\"w\">    </span><span class=\"c1\">--       logInfoAt tk &lt;| .signature c</span>\n<span class=\"w\">    </span><span class=\"c1\">--       return</span>\n<span class=\"w\">    </span><span class=\"c1\">--   catch _ =&gt; pure ()  -- identifier might not be a constant but constant + projection</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">elabTerm</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"n\">none</span>\n<span class=\"w\">    </span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">synthesizeSyntheticMVarsNoPostponing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ignoreStuckTC</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"c1\">-- Users might be testing out buggy elaborators. Let's typecheck before proceeding:</span>\n<span class=\"w\">    </span><span class=\"n\">withRef</span><span class=\"w\"> </span><span class=\"n\">tk</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">e</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">levelMVarToParam</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">instantiateMVars</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">isSyntheticSorry</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">      </span><span class=\"n\">return</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">inferType</span><span class=\"w\"> </span><span class=\"n\">e</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">str</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MessageData</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">withApp</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"bp\">↦</span>\n<span class=\"w\">      </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"bp\">.</span><span class=\"n\">foldl</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\" {n}\"</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\"{f}\"</span>\n<span class=\"w\">    </span><span class=\"n\">logInfoAt</span><span class=\"w\"> </span><span class=\"n\">tk</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">str</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\" : {type}\"</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">throwUnsupportedSyntax</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">info: @OfScientific.ofScientific Float instOfScientificFloat 27 true 2 : Float</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"bp\">#</span><span class=\"n\">see</span><span class=\"w\"> </span><span class=\"mf\">0.27</span>\n</code></pre></div>\n<p>I did find that <code>norm_num</code> has a command form <code>#norm_num</code></p>",
        "id": 497758440,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1738703950
    },
    {
        "content": "<p>I would recommend formalizing numerical algorithms something like this. Example for Lagrange interpolating polynomial:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">Set</span>\n\n<span class=\"c1\">-- specification over reals</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">lagrangeInterpolSpec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"c1\">-- executable program</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">lagrangeInterpol</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Add</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Mul</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Zero</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">One</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"c1\">-- exacutable program satisfies the spec</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">lagrangeInterpol_spec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">lagrangeInterpol</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">lagrangeInterpolSpec</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"c1\">-- Lagrange interpolating polynom is actually converging to the function under some assumptions</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">lagrangeInterpolSpec_limit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">Icc</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">lim</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"bp\">⊤</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">lagrangeInterpolSpec</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 497758564,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1738703995
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113489-new-members/topic/Need.20help.20understanding.20ring_nf/near/497758440\">said</a>:</p>\n<blockquote>\n<p>I was able to write this (it doesn't handle corner cases), still can't find a builtin command to do it.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">Elab</span><span class=\"w\"> </span><span class=\"n\">Command</span><span class=\"w\"> </span><span class=\"n\">Meta</span>\n\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">see</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"s2\">\"#see\"</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">command</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">command_elab</span><span class=\"w\"> </span><span class=\"n\">see</span><span class=\"kd\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">elabShow</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CommandElab</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"bp\">#</span><span class=\"n\">see</span><span class=\"bp\">%$</span><span class=\"n\">tk</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">term</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">withoutModifyingEnv</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">runTermElabM</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">withDeclName</span><span class=\"w\"> </span><span class=\"ss\">`_show</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"c1\">-- -- show signature for `#check id`/`#check @id`</span>\n<span class=\"w\">    </span><span class=\"c1\">-- if let `($id:ident) := term then</span>\n<span class=\"w\">    </span><span class=\"c1\">--   try</span>\n<span class=\"w\">    </span><span class=\"c1\">--     for c in (← realizeGlobalConstWithInfos term) do</span>\n<span class=\"w\">    </span><span class=\"c1\">--       addCompletionInfo &lt;| .id term id.getId (danglingDot := false) {} none</span>\n<span class=\"w\">    </span><span class=\"c1\">--       logInfoAt tk &lt;| .signature c</span>\n<span class=\"w\">    </span><span class=\"c1\">--       return</span>\n<span class=\"w\">    </span><span class=\"c1\">--   catch _ =&gt; pure ()  -- identifier might not be a constant but constant + projection</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">elabTerm</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"n\">none</span>\n<span class=\"w\">    </span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">synthesizeSyntheticMVarsNoPostponing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ignoreStuckTC</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"c1\">-- Users might be testing out buggy elaborators. Let's typecheck before proceeding:</span>\n<span class=\"w\">    </span><span class=\"n\">withRef</span><span class=\"w\"> </span><span class=\"n\">tk</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">e</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">levelMVarToParam</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">instantiateMVars</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">isSyntheticSorry</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">      </span><span class=\"n\">return</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">inferType</span><span class=\"w\"> </span><span class=\"n\">e</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">str</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MessageData</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">withApp</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"bp\">↦</span>\n<span class=\"w\">      </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"bp\">.</span><span class=\"n\">foldl</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\" {n}\"</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\"{f}\"</span>\n<span class=\"w\">    </span><span class=\"n\">logInfoAt</span><span class=\"w\"> </span><span class=\"n\">tk</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">str</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\" : {type}\"</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">throwUnsupportedSyntax</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">info: @OfScientific.ofScientific Float instOfScientificFloat 27 true 2 : Float</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"bp\">#</span><span class=\"n\">see</span><span class=\"w\"> </span><span class=\"mf\">0.27</span>\n</code></pre></div>\n<p>I did find that <code>norm_num</code> has a command form <code>#norm_num</code></p>\n</blockquote>\n<p>I don't quite understand why without <code>#guard_msgs</code>, <code>#see 0.27</code> would produce an error. I'm not very familiar with metaprogramming so pardon my ignorance.</p>",
        "id": 497879103,
        "sender_full_name": "Kevin Cheung",
        "timestamp": 1738757764
    },
    {
        "content": "<p>If you comment out <code>#guard_msgs</code>, the <code>docComment</code> gets attached to <code>#see</code>, which is illegal.</p>",
        "id": 497879837,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1738757999
    },
    {
        "content": "<p>I see. I guess I don't quite know how docComment works.</p>",
        "id": 497881641,
        "sender_full_name": "Kevin Cheung",
        "timestamp": 1738758615
    }
]