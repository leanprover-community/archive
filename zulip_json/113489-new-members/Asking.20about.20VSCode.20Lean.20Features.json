[
    {
        "content": "<p>Hey guys, </p>\n<p>A few things I'm curious about with people that use VSCode to write Lean code.</p>\n<ol>\n<li>For cases where there's a lot of inheritance of type classes, is there a way you guys easily can visualize the type hierarchy? In VSCode, there's <code>&gt; Types: Show Type Hierarchy</code> but it doesn't seem to work with Lean structures. For example, if I type a keyboard shortcut while my cursor is over <code>Group</code>, I'd love to see a tree that has <code>Group</code> as the root and branches out to <code>DivInvMonoid</code> which branches out to <code>Monoid</code>, <code>Inv</code>, <code>Div</code> and so on...</li>\n<li>I noticed that I can't lookup every reference in VSCode. To be precise I'm referring to <code>editor.action.revealDefinition</code> in VSCode. It would be really lovely to have this always work. For example, when I type out this code below, I can use my keyboard shortcut for <code>editor.action.revealDefinition</code> to view <code>one</code>, <code>mul</code>, <code>inv</code>, <code>mul_assoc</code>, and <code>mul_left_inv</code>, but it doesn't work for <code>one_mul</code> and <code>mul_one</code> <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span> </li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">ext</span><span class=\"kd\">]</span>\n<span class=\"kd\">structure</span><span class=\"w\"> </span><span class=\"n\">DirectProduct</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">fst</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"n\">snd</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">dpMul</span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">](</span><span class=\"n\">d₁</span><span class=\"w\"> </span><span class=\"n\">d₂</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">DirectProduct</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">DirectProduct</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">fst</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">d₁.fst</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">d₂.fst</span>\n<span class=\"w\">  </span><span class=\"n\">snd</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">d₁.snd</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">d₂.snd</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">dpInv</span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">](</span><span class=\"n\">d₁</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">DirectProduct</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">DirectProduct</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">fst</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">d₁.fst</span><span class=\"bp\">⁻¹</span>\n<span class=\"w\">  </span><span class=\"n\">snd</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">d₁.snd</span><span class=\"bp\">⁻¹</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">dpOne</span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]:</span><span class=\"w\"> </span><span class=\"n\">DirectProduct</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">fst</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"n\">snd</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"kd\">variable</span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span>\n<span class=\"kd\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">DirectProduct</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">dpOne</span>\n<span class=\"w\">  </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">dpMul</span>\n<span class=\"w\">  </span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">dpInv</span>\n<span class=\"w\">  </span><span class=\"n\">mul_assoc</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">one_mul</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">mul_one</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">mul_left_inv</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<ol start=\"3\">\n<li>Finally, I'm reading through some Lean tutorials like <a href=\"https://eric-wieser.github.io/lftcm-2023/#/4\">this one</a> and there's mention of a lightbulb that will appear in VSCode if you start typing out a definition. I verified that \"lightbulb\" is enabled in my VSCode settings, but it doesn't appear when I start creating a definition for an instance of <code>Group</code>. How do you get it to show? Keeping with the Lean code above when I start typing</li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">variable</span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span>\n<span class=\"kd\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">DirectProduct</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">where</span>\n</code></pre></div>\n<p>I don't see anything particular interesting. It would be really cool to have it autofill with the fields so I can easily fill in all of the requisite fields to create an instance of Group for my custom type <code>DirectProduct</code></p>",
        "id": 449684987,
        "sender_full_name": "Noah Stebbins",
        "timestamp": 1720370192
    },
    {
        "content": "<p>For 3, try writing <code>:= _</code> rather than <code>where</code></p>",
        "id": 449685341,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1720370480
    },
    {
        "content": "<p>No dice. This is exactly what I'm seeing.</p>\n<p><a href=\"/user_uploads/3121/_KOGciXhRRO5aZB8RxRry4nP/Screenshot-2024-07-07-at-12.42.41PM.png\">Screenshot-2024-07-07-at-12.42.41PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/_KOGciXhRRO5aZB8RxRry4nP/Screenshot-2024-07-07-at-12.42.41PM.png\" title=\"Screenshot-2024-07-07-at-12.42.41PM.png\"><img src=\"/user_uploads/3121/_KOGciXhRRO5aZB8RxRry4nP/Screenshot-2024-07-07-at-12.42.41PM.png\"></a></div>",
        "id": 449685471,
        "sender_full_name": "Noah Stebbins",
        "timestamp": 1720370585
    },
    {
        "content": "<p>Doesn't that show the light bulb in the bottom left corner?</p>",
        "id": 449686164,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1720371203
    },
    {
        "content": "<p>Ok, yea I see the lightbulb now <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 449688313,
        "sender_full_name": "Noah Stebbins",
        "timestamp": 1720372065
    },
    {
        "content": "<p>We don't implement the type hierarchy request (yet). The go-to-definition issue is worth reporting in the Lean 4 repository (with a Mathlib-free MWE that includes a minimized version of that part of the <code>Group</code> hierarchy).</p>",
        "id": 449709827,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1720381544
    },
    {
        "content": "<p>Gotcha any chance you know if a visual type hierarchy is supported in other IDEs like Neovim?</p>",
        "id": 449719353,
        "sender_full_name": "Noah Stebbins",
        "timestamp": 1720385583
    },
    {
        "content": "<p>No. This feature needs language server support, which we currently don't provide. Neither VS Code nor NeoVim can accurately compute this kind of information on their own.</p>",
        "id": 449788857,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1720421912
    }
]