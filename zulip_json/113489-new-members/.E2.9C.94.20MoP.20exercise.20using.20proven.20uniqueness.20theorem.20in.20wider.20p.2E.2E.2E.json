[
    {
        "content": "<p>I've spent a couple of days grappling with MoP exercise 6.6.6.3.</p>\n<p>The exercise suggests I prove the <code>uniqueness</code> theorem first before proving the unique existence theorem:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">uniqueness</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≡</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ZMOD</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">])</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≡</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ZMOD</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃!</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≡</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ZMOD</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Thanks to some hints here, I did manage to prove <code>uniqueness</code>. </p>\n<p>Now, to prove unique existence I need to show two things:</p>\n<ol>\n<li>That a chosen expression meets the criteria</li>\n<li>That the criteria entail that expression</li>\n</ol>\n<p>I have done (1) with <code>use fmod a b</code>, unfolding the definition of <code>fmod</code> and using lemmas we've develop in previous exercises. </p>\n<p>I haven't done (2) and it looks horrible:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>∀ (y : ℤ), 0 ≤ y ∧ y &lt; b ∧ a ≡ y [ZMOD b] → y = fmod a b\n</code></pre></div>\n<p><strong>Question:</strong> I can't see how to use the <code>uniqueness</code> theorem I just proved. The required hypotheses obviously match the goal but beyond that I can't see the connection. Also, the <code>uniqueness</code> theorem avoids mentioning the <code>fmod</code>  user-defined function, so I can't see how to eliminate it.</p>",
        "id": 499361600,
        "sender_full_name": "rzeta0",
        "timestamp": 1739411243
    },
    {
        "content": "<p>The conclusion of <code>uniqueness</code> has the pattern <code>r = s</code>, so you can <code>apply</code> it to any goal which is an equality of <code>Int</code>s. First <code>intro y hy</code>, and then <code>apply uniqueness</code>. You will have to prove (1) again to satisfy the hypothesis of <code>uniqueness</code>, so you may want to factor that out into a separate lemma.</p>",
        "id": 499363475,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1739412530
    },
    {
        "content": "<p>There are (at least) two ways to prove unique existence:<br>\nThe first way is to provide a witness <code>x</code> (existence), and then show that any <code>y</code> which also satisfies the property is equal to <code>x</code> (uniqueness).<br>\nThe second way is to provide a witness <code>x</code> (existence), and then show that all pairs <code>y₁, y₂</code> which both satisfy the property are equal (uniqueness).</p>\n<p>Mathlib uses the first definition for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ExistsUnique#doc\">docs#ExistsUnique</a>.</p>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ExistsUnique.exists#doc\">docs#ExistsUnique.exists</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ExistsUnique.unique#doc\">docs#ExistsUnique.unique</a>, and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=existsUnique_of_exists_of_unique#doc\">docs#existsUnique_of_exists_of_unique</a> together show that these two are equivalent.</p>",
        "id": 499364245,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1739413079
    },
    {
        "content": "<p>Thanks Aaron, you helped me unlock the idea of applying <code>uniqueness</code> to the goal which also is an equality <code>=</code>.</p>\n<p>However the resulting 5 goals are of a form I am not familiar with, and look like an error:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>⊢ 0 &lt; ?h.refine_2.b\n\n⊢ 0 ≤ y ∧ y &lt; ?h.refine_2.b ∧ ?h.refine_2.a ≡ y [ZMOD ?h.refine_2.b]\n\n⊢ 0 ≤ fmod a b ∧ fmod a b &lt; ?h.refine_2.b ∧ ?h.refine_2.a ≡ fmod a b [ZMOD ?h.refine_2.b]\n\n⊢ ℤ\n\n⊢ ℤ\n</code></pre></div>\n<p>What is <code>?h.refine</code> ?</p>",
        "id": 499471404,
        "sender_full_name": "rzeta0",
        "timestamp": 1739452984
    },
    {
        "content": "<p>the reason for these 'odd' goals is because there are some arguments lean can't figure out. giving <code>uniqueness</code> more arguments when you apply it will likely fix this 'issue'</p>",
        "id": 499472505,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1739453276
    },
    {
        "content": "<hr>\n<p>I'm trying</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hy</span>\n<span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">uniqueness</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">hy</span>\n</code></pre></div>\n<p>but that also fails. </p>\n<p>I'll keep trying.</p>",
        "id": 499472708,
        "sender_full_name": "rzeta0",
        "timestamp": 1739453315
    },
    {
        "content": "<p>lean particularly wants you to supply <code>b := y</code>, i think</p>",
        "id": 499472843,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1739453351
    },
    {
        "content": "<p>this looks promising:</p>\n<p><code>apply uniqueness y b h</code></p>\n<p>thanks again for helping me able to see <code>=</code> in a goal and looking at the <code>uniqueness</code> theorem which is also about <code>=</code> and trying to apply - that was the key lesson for me here.</p>",
        "id": 499473199,
        "sender_full_name": "rzeta0",
        "timestamp": 1739453440
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"724904\">rzeta0</span> has marked this topic as resolved.</p>",
        "id": 499474311,
        "sender_full_name": "Notification Bot",
        "timestamp": 1739453728
    }
]