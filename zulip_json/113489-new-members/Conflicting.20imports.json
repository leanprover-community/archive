[
    {
        "content": "<p>I've authored a file (call it file B) with some auxiliary results that depends on a couple of files from MathLib. When I import these into another file (file A) in my workspace, I get a conflict as some of the MathLib imports in file A already import the imports from file B. How do I deal with this? The error I'm getting is: <code>import MathLib.CategoryTheory.Adjunction.Reflective failed, environment already contains 'CategoryTheory.coreflectorAdjunction._rarg._cstage2' from Mathlib.CategoryTheory.Adjunction.Reflective</code></p>",
        "id": 477668490,
        "sender_full_name": "Nathan Corbyn",
        "timestamp": 1729261739
    },
    {
        "content": "<p>Does removing the error imports in file A solves it? If A import B and B imports C there is no need to import C in A</p>",
        "id": 477670895,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1729262443
    },
    {
        "content": "<p>In A I'm importing:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Sites</span><span class=\"bp\">.</span><span class=\"n\">Coverage</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Sites</span><span class=\"bp\">.</span><span class=\"n\">Sieves</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Sites</span><span class=\"bp\">.</span><span class=\"n\">Sheaf</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Sites</span><span class=\"bp\">.</span><span class=\"n\">Sheafification</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Sites</span><span class=\"bp\">.</span><span class=\"n\">Equivalence</span>\n</code></pre></div>\n<p>and in B I'm importing</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">MathLib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Adjunction</span><span class=\"bp\">.</span><span class=\"n\">Reflective</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">MathLib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Yoneda</span>\n</code></pre></div>\n<p>I think the problem is that the A imports also import <code>MathLib.CategoryTheory.Adjunction.Reflective</code></p>",
        "id": 477671239,
        "sender_full_name": "Nathan Corbyn",
        "timestamp": 1729262534
    },
    {
        "content": "<p>The error goes away if I remove the imports in A, but then A doesn't build anymore <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 477671544,
        "sender_full_name": "Nathan Corbyn",
        "timestamp": 1729262621
    },
    {
        "content": "<p>Careful about <code>MathLib</code> vs <code>Mathlib</code> if you have a case-insensitive OS, in principle lean knows not to import the same file twice but here there is a typo that confuses it.</p>",
        "id": 477671557,
        "sender_full_name": "Vincent Beffara",
        "timestamp": 1729262625
    },
    {
        "content": "<p>Oh my goodness! That was it!</p>",
        "id": 477671803,
        "sender_full_name": "Nathan Corbyn",
        "timestamp": 1729262699
    },
    {
        "content": "<p>Thank you very much!</p>",
        "id": 477671840,
        "sender_full_name": "Nathan Corbyn",
        "timestamp": 1729262705
    },
    {
        "content": "<p>(On a case-sensitive OS, the imports on B would just fail.)</p>",
        "id": 477671842,
        "sender_full_name": "Vincent Beffara",
        "timestamp": 1729262705
    },
    {
        "content": "<p>I didn't even notice the case---thank you so much</p>",
        "id": 477671917,
        "sender_full_name": "Nathan Corbyn",
        "timestamp": 1729262738
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"752755\">@Nathan Corbyn</span> Would you mind adding a comment on <a href=\"https://github.com/leanprover/lean4/pull/2768\">lean4#2768</a> with details of what operating system you are using and the output of <code>#eval Lean.versionString</code>? Thanks!</p>",
        "id": 477680694,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729265373
    },
    {
        "content": "<p>Will do!</p>",
        "id": 477685887,
        "sender_full_name": "Nathan Corbyn",
        "timestamp": 1729266985
    }
]