[
    {
        "content": "<p>Hi everyone! <span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span></p>\n<p>I was (naively?) expecting the notation <code>(b : A)</code> to convert a term of type <code>B</code> to type <code>A</code> when <code>B</code> is defined by</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">A</span>\n</code></pre></div>\n<p>In context:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Pointer</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Size</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">ptr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Pointer</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Size</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">512</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">ptr</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"c1\">-- fails as expected</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ptr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- too bad I was expecting this to work :(</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">ptr_as_nat</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ptr</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">ptr_as_nat</span><span class=\"w\"> </span><span class=\"c1\">-- Nat, as expected</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">size_as_nat</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">size</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">size_as_nat</span><span class=\"w\"> </span><span class=\"c1\">-- Nat, as expected</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">ptr_as_nat</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">size_as_nat</span><span class=\"w\"> </span><span class=\"c1\">-- OK</span>\n\n<span class=\"c1\">-- But</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">ptr_as_nat'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ptr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">ptr_as_nat'</span><span class=\"w\"> </span><span class=\"c1\">-- Pointer :(</span>\n</code></pre></div>\n<p>Here the expression <code>(ptr : Nat)</code> is not rejected as incorrect, but doesn't perform the conversion I was expecting. What is it doing then? What should I do to perform the conversion? I'd like to avoid the explicit creation of intermediate variables like <code>ptr_as_nat</code>if that's possible.</p>\n<p>Cheers!</p>\n<p>Sébastien</p>",
        "id": 534252758,
        "sender_full_name": "Sébastien Boisgérault",
        "timestamp": 1755098219
    },
    {
        "content": "<p><code>(b : A)</code> instructs Lean to elaborate <code>b</code> as a term of type <code>A</code>, and then check to make sure that the result really has type <code>A</code>. To put a marker on <code>b</code> that says \"I have type <code>A</code>\", you can do <code>show A from b</code> instead.</p>",
        "id": 534253297,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755098379
    },
    {
        "content": "<p>Understood. Thank you! <span aria-label=\"pray\" class=\"emoji emoji-1f64f\" role=\"img\" title=\"pray\">:pray:</span></p>",
        "id": 534260854,
        "sender_full_name": "Sébastien Boisgérault",
        "timestamp": 1755100891
    }
]