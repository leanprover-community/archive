[
    {
        "content": "<p>Hi All, I would like to assert that <code>exp</code> is a left inverse of <code>log</code> for positive real numbers. I'd like to reuse the mathlib definition for <code>LeftInverse</code>, or at least use some definition within mathlib as opposed to using my own. However, I don't know how to restrict the domain to the positive reals</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Function</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LeftInverse</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">exp_log</span>\n<span class=\"w\">  </span><span class=\"c1\">--&lt;-- when cursor is here, need to show 0 &lt; x</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Normally, I'd specify a hypothesis in the lemma, <code>(h : 0 &lt; x)</code>, but the definition of <code>LeftInverse</code> starts with a universal quantifier : <code>∀ x, ...</code> that is, the <code>x</code> is bound within an inner scope, and is inaccessible. My instinct was to try to \"lift a condition into the <code>∀ x</code>\", or use a pattern that would achieve something like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">with_cond</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">LeftInverse</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"c1\">--                        ^ 'with_cond' would pass the `x` from the ∀ into there.</span>\n</code></pre></div>",
        "id": 500963718,
        "sender_full_name": "Derek Rhodes",
        "timestamp": 1740083370
    },
    {
        "content": "<p>Is there a LeftInverseOn?</p>",
        "id": 500965265,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740083980
    },
    {
        "content": "<p>There is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Set.LeftInvOn#doc\">docs#Set.LeftInvOn</a></p>",
        "id": 500965989,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1740084274
    },
    {
        "content": "<p>yeah,</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">LeftInverse</span><span class=\"bp\">.</span><span class=\"n\">leftInvOn</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LeftInverse</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LeftInvOn</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>",
        "id": 500966049,
        "sender_full_name": "Derek Rhodes",
        "timestamp": 1740084297
    },
    {
        "content": "<p>ok these are good clues, thank you!</p>",
        "id": 500966667,
        "sender_full_name": "Derek Rhodes",
        "timestamp": 1740084559
    },
    {
        "content": "<p><code>Set.LeftInvOn</code> looks best, but in case you want to know how to restrict the domain and codomain:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">exp</span><span class=\"bp\">.</span><span class=\"n\">mapsTo_pos</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">MapsTo</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Ioi</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Ioi</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">log</span><span class=\"bp\">.</span><span class=\"n\">mapsTo_pos</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">MapsTo</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Ioi</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Ioi</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LeftInverse</span><span class=\"w\"> </span><span class=\"n\">exp</span><span class=\"bp\">.</span><span class=\"n\">mapsTo_pos</span><span class=\"bp\">.</span><span class=\"n\">restrict</span><span class=\"w\"> </span><span class=\"n\">log</span><span class=\"bp\">.</span><span class=\"n\">mapsTo_pos</span><span class=\"bp\">.</span><span class=\"n\">restrict</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 500967188,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1740084790
    },
    {
        "content": "<p>Thanks Kyle, I'll see if I can prove these.</p>",
        "id": 500967417,
        "sender_full_name": "Derek Rhodes",
        "timestamp": 1740084888
    },
    {
        "content": "<p>(I stated them wrong; I think I fixed it)</p>",
        "id": 500967508,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1740084934
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"317929\">Derek Rhodes</span> has marked this topic as resolved.</p>",
        "id": 500982184,
        "sender_full_name": "Notification Bot",
        "timestamp": 1740090822
    }
]