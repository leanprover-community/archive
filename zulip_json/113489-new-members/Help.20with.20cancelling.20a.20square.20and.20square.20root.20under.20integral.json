[
    {
        "content": "<p>I'm currently trying to prove that a d-dimensional gaussian is normalized. My goal at the moment is </p>\n<blockquote>\n<p>∫ (x : Fin d → ℝ), ((4 * π * t) ^ (d / 2))⁻¹ * rexp (-√(inner x x) ^ 2 / (4 * t)) = 1</p>\n</blockquote>\n<p>and I'm trying to use \"simp_rw [sq_sqrt]\" to cancel the square root and square, but I just got \"simp made no progress\". Can anyone explain why this is happening and how to fix it?</p>",
        "id": 498663127,
        "sender_full_name": "Strategist _",
        "timestamp": 1739157637
    },
    {
        "content": "<p>It needs to know that the argument is nonnegative</p>",
        "id": 498663297,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1739157752
    },
    {
        "content": "<p>Also, this is not a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a></p>",
        "id": 498663324,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1739157778
    },
    {
        "content": "<p>Whoops. I didn't know the mwe requirement. Pretty new to this. Thanks! Here's my mwe</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">SpecialFunctions</span><span class=\"bp\">.</span><span class=\"n\">Exp</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">Integral</span><span class=\"bp\">.</span><span class=\"n\">Lebesgue</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">InnerProductSpace</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Finset</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">heat_kernel</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">    </span><span class=\"o\">((</span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">π</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"o\">(</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">))</span><span class=\"bp\">⁻¹</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-‖</span><span class=\"n\">x</span><span class=\"bp\">‖^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"k\">else</span>\n<span class=\"w\">    </span><span class=\"mi\">0</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">heat_kernal_normalized</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∫</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">heat_kernel</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">t</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h1</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">heat_kernel</span>\n<span class=\"w\">  </span><span class=\"n\">simp_rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">if_pos</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp_rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">norm_eq_sqrt_real_inner</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp_rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">sq_sqrt</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 498663672,
        "sender_full_name": "Strategist _",
        "timestamp": 1739158049
    },
    {
        "content": "<p>I tried including inner_self_nonneg after the sq_sqrt as well, but that didn't fix it</p>",
        "id": 498663768,
        "sender_full_name": "Strategist _",
        "timestamp": 1739158097
    },
    {
        "content": "<p>Try <code>simp</code></p>",
        "id": 498663788,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1739158121
    },
    {
        "content": "<p>Like, replacing the simp_rw with simp? That just gives </p>\n<blockquote>\n<p>∫ (x : Fin d → ℝ), ((4 * π * t) ^ (d / 2))⁻¹ * rexp (-√(∑ x_1 : Fin d, x x_1 * x x_1) ^ 2 / (4 * t)) = 1</p>\n</blockquote>",
        "id": 498664065,
        "sender_full_name": "Strategist _",
        "timestamp": 1739158306
    },
    {
        "content": "<p>It turns the norm into a sum, but doesn't cancel the square or square root</p>",
        "id": 498664121,
        "sender_full_name": "Strategist _",
        "timestamp": 1739158323
    },
    {
        "content": "<p>Oh huh wait using real_inner_self_nonneg did fix it. I guess inner x x doesn't qualify as an <a href=\"http://RCLike.re\">RCLike.re</a> (inner x x)?</p>",
        "id": 498664451,
        "sender_full_name": "Strategist _",
        "timestamp": 1739158584
    },
    {
        "content": "<p>Thank you for your help!</p>",
        "id": 498664458,
        "sender_full_name": "Strategist _",
        "timestamp": 1739158594
    },
    {
        "content": "<p>This topic was moved here from <a class=\"stream-topic\" data-stream-id=\"113488\" href=\"/#narrow/channel/113488-general/topic/Help.20with.20cancelling.20a.20square.20and.20square.20root.20under.20integral\">#general &gt; Help with cancelling a square and square root under integral</a> by <span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span>.</p>",
        "id": 498672334,
        "sender_full_name": "Notification Bot",
        "timestamp": 1739164362
    },
    {
        "content": "<p><code>simp_rw [a, b]</code> is <code>simp only [a]; simp only [b]</code>. So, if you need 2 lemmas in one <code>simp</code> call, then you should use <code>simp only</code> or <code>simp</code>.</p>",
        "id": 498672378,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1739164407
    }
]