[
    {
        "content": "<p>I'm trying to write the following code:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">set_zero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"bp\">.</span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"n\">L</span>\n</code></pre></div>\n<p>I get the following error:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">prove</span><span class=\"w\"> </span><span class=\"n\">index</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">valid</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">possible</span><span class=\"w\"> </span><span class=\"n\">solutions</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Use</span><span class=\"w\"> </span><span class=\"ss\">`have</span><span class=\"bp\">`-</span><span class=\"n\">expressions</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">prove</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">index</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">valid</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Use</span><span class=\"w\"> </span><span class=\"ss\">`a</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"bp\">!`</span><span class=\"w\"> </span><span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"n\">instead</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">runtime</span><span class=\"w\"> </span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">performed</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Panic'</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">message</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">produced</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">index</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">valid</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Use</span><span class=\"w\"> </span><span class=\"ss\">`a</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"bp\">?`</span><span class=\"w\"> </span><span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"n\">instead</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">result</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"ss\">`Option</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Use</span><span class=\"w\"> </span><span class=\"ss\">`a</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"bp\">'</span><span class=\"n\">h</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"n\">instead</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"ss\">`h</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">proof</span><span class=\"w\"> </span><span class=\"n\">that</span><span class=\"w\"> </span><span class=\"n\">index</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">valid</span>\n</code></pre></div>\n<p>I have tried to provide a proof that the index is in bounds, but I can't get the syntax right. How can I fix this?</p>",
        "id": 489592032,
        "sender_full_name": "Benjamin",
        "timestamp": 1734479420
    },
    {
        "content": "<p>I don't know anything about <code>Vector</code> but does <code>if h : i &lt; n then...</code> help?</p>",
        "id": 489592177,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1734479512
    },
    {
        "content": "<p>That does work, thanks. But in my actual application, I have something like <code>if h : i &lt; n &amp;&amp; j &lt; n then ...</code>, and it no longer works there.</p>",
        "id": 489592872,
        "sender_full_name": "Benjamin",
        "timestamp": 1734479911
    },
    {
        "content": "<p>I guess I need a function that transforms <code>i &lt; n &amp;&amp; j &lt; n</code>to <code>i &lt; n</code>. If I were using Coq, I would use the Search tactic to find such a function. How can I do this in Lean?</p>",
        "id": 489593134,
        "sender_full_name": "Benjamin",
        "timestamp": 1734480046
    },
    {
        "content": "<p>I fixed it by replacing <code>&amp;&amp;</code> with <code>/\\</code>, although I'm not sure why that fixes it.</p>",
        "id": 489595223,
        "sender_full_name": "Benjamin",
        "timestamp": 1734481177
    },
    {
        "content": "<p>do you understand the difference between <code>&amp;&amp;</code> and <code>/\\</code>?</p>",
        "id": 489597919,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1734482865
    },
    {
        "content": "<p>I think I do. Since I'm working with decidable propositions, I figured I should use <code>&amp;&amp;</code>.</p>",
        "id": 489598554,
        "sender_full_name": "Benjamin",
        "timestamp": 1734483295
    },
    {
        "content": "<p>nah, you can use the propositional <code>/\\</code> instead of the boolean <code>&amp;&amp;</code>... if <code>A</code> and <code>B</code> are decidable then <code>A /\\ B</code> is decidable</p>",
        "id": 489598730,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1734483383
    },
    {
        "content": "<p><code>&amp;&amp;</code> ends up doing some conversion to boolean that you don't need</p>",
        "id": 489598819,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1734483433
    },
    {
        "content": "<p>I think that's why <code>&amp;&amp;</code> didn't work... you end up losing the propositional information and just combining the whole thing into one <code>true</code> value</p>",
        "id": 489598946,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1734483495
    },
    {
        "content": "<p>on the subject of looking for functions, one method is to use the <code>exact?</code> and <code>apply?</code> tactics</p>",
        "id": 489599223,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1734483666
    },
    {
        "content": "<p><a href=\"https://loogle.lean-lang.org\">Loogle</a> is also useful</p>",
        "id": 489599292,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1734483711
    },
    {
        "content": "<p>Lean has a <code>Decidable</code> typeclass, so you can feel free to work with the more powerful <code>Prop</code> universe and still keep track of decidability. For example <code>i &lt; n</code> is a decidable Prop but it's still a Prop and <code>if</code> still works constructively.</p>",
        "id": 489601593,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1734485362
    }
]