[
    {
        "content": "<p>Title says it all.<br>\nIf i have a Lean project that I want to import as a git repo, will it also import all of the submodules as well?</p>",
        "id": 540547524,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758327482
    },
    {
        "content": "<p>no I don't think so</p>",
        "id": 540547549,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1758327523
    },
    {
        "content": "<p>I guess it depends on what you mean by \"import as a git repo\"</p>",
        "id": 540547560,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1758327539
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> Like as part of the lakefile<br>\n<a href=\"https://lean-lang.org/doc/reference/4.19.0/Build-Tools-and-Distribution/Lake/#The-Lean-Language-Reference--Build-Tools-and-Distribution--Lake--Configuration-File-Format--Lean-Format--Dependencies\">https://lean-lang.org/doc/reference/4.19.0/Build-Tools-and-Distribution/Lake/#The-Lean-Language-Reference--Build-Tools-and-Distribution--Lake--Configuration-File-Format--Lean-Format--Dependencies</a></p>",
        "id": 540547949,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758327997
    },
    {
        "content": "<p>I don't think that imports anything by itself</p>",
        "id": 540547967,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1758328021
    },
    {
        "content": "<p><a href=\"https://lean-lang.org/doc/reference/4.19.0/Build-Tools-and-Distribution/Lake/#The-Lean-Language-Reference--Build-Tools-and-Distribution--Lake--Configuration-File-Format--Declarative-TOML-Format--Dependencies\">https://lean-lang.org/doc/reference/4.19.0/Build-Tools-and-Distribution/Lake/#The-Lean-Language-Reference--Build-Tools-and-Distribution--Lake--Configuration-File-Format--Declarative-TOML-Format--Dependencies</a></p>",
        "id": 540547994,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758328037
    },
    {
        "content": "<p>it just adds the dependency to your project</p>",
        "id": 540547995,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1758328037
    },
    {
        "content": "<p>Yeah does that dependency include git submodules?</p>",
        "id": 540548004,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758328049
    },
    {
        "content": "<p><code>[[require]]\nname = \"example\"\ngit = \"https://git.example.com/example.git\"\nrev = \"main\"\nversion = \"2.12\"</code></p>",
        "id": 540548021,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758328064
    },
    {
        "content": "<p>so when building your project lake will checkout the repository</p>",
        "id": 540548028,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1758328070
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"950553\">Srayan Jana</span> <a href=\"#narrow/channel/113489-new-members/topic/Does.20importing.20dependency.20as.20git.20repository.20clone.20submodules/near/540548004\">said</a>:</p>\n<blockquote>\n<p>Yeah does that dependency include git submodules?</p>\n</blockquote>\n<p>I don't know what that is</p>",
        "id": 540548030,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1758328078
    },
    {
        "content": "<p>I looked it up and it seems very weird</p>",
        "id": 540548085,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1758328152
    },
    {
        "content": "<p>you have another repo inside your repo?</p>",
        "id": 540548097,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1758328165
    },
    {
        "content": "<p>Yes, its a pretty common feature for git repositories.</p>",
        "id": 540548109,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758328184
    },
    {
        "content": "<p>I don't know why you would do that for a Lean project</p>",
        "id": 540548118,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1758328190
    },
    {
        "content": "<p>I'm working on SDL bindings for lean and I need a way to link Lean to SDL's git repo, so I have SDL as a gitsubmodule <br>\n<a href=\"https://github.com/oOo0oOo/LeanDoomed/tree/main/vendor\">https://github.com/oOo0oOo/LeanDoomed/tree/main/vendor</a></p>",
        "id": 540548164,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758328233
    },
    {
        "content": "<p>interesting</p>",
        "id": 540548201,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1758328274
    },
    {
        "content": "<p><a href=\"https://github.com/oOo0oOo/LeanDoomed/blob/main/.gitmodules\">https://github.com/oOo0oOo/LeanDoomed/blob/main/.gitmodules</a></p>",
        "id": 540548203,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758328275
    },
    {
        "content": "<p>I will try to find out if this will affect anything</p>",
        "id": 540548233,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1758328298
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> <a href=\"https://github.com/Ravbug/sdl3-sample/tree/main\">https://github.com/Ravbug/sdl3-sample/tree/main</a><br>\nhere's a C++ project that uses submodules as dependencies, and update the repositories every so often</p>",
        "id": 540548341,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758328452
    },
    {
        "content": "<p>I think it clones the repo so whatever that does</p>",
        "id": 540548367,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1758328489
    },
    {
        "content": "<p>probably relevant<br>\n<a href=\"https://github.com/leanprover/lean4/blob/c6abc3c0368e10c49e9762fda1819ad0e95c9bb0/src/lake/Lake/Util/Git.lean#L65-L66\">https://github.com/leanprover/lean4/blob/c6abc3c0368e10c49e9762fda1819ad0e95c9bb0/src/lake/Lake/Util/Git.lean#L65-L66</a><br>\n<a href=\"https://github.com/leanprover/lean4/blob/c6abc3c0368e10c49e9762fda1819ad0e95c9bb0/src/lake/Lake/Load/Materialize.lean#L38-L47\">https://github.com/leanprover/lean4/blob/c6abc3c0368e10c49e9762fda1819ad0e95c9bb0/src/lake/Lake/Load/Materialize.lean#L38-L47</a><br>\n<a href=\"https://github.com/leanprover/lean4/blob/c6abc3c0368e10c49e9762fda1819ad0e95c9bb0/src/lake/Lake/DSL/Syntax.lean#L125-L129\">https://github.com/leanprover/lean4/blob/c6abc3c0368e10c49e9762fda1819ad0e95c9bb0/src/lake/Lake/DSL/Syntax.lean#L125-L129</a></p>",
        "id": 540548517,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1758328658
    },
    {
        "content": "<p>oof it doesnt seem to clone the submodules, thats a big issue.<br>\nThere should be a command being called that looks something like<br>\n<code>git submodule update --init --recursive</code><br>\n<a href=\"https://stackoverflow.com/a/10168693\">https://stackoverflow.com/a/10168693</a></p>",
        "id": 540549005,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758329238
    },
    {
        "content": "<p>it should be called right after git clone is called on the repository</p>",
        "id": 540549018,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758329259
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113489-new-members/topic/Does.20importing.20dependency.20as.20git.20repository.20clone.20submodules/near/540548118\">said</a>:</p>\n<blockquote>\n<p>I don't know why you would do that for a Lean project</p>\n</blockquote>\n<p>I've seen at least one Lean project with submodules, for instance <a href=\"https://github.com/leanprover/SampCert/blob/main/.gitmodules\">https://github.com/leanprover/SampCert/blob/main/.gitmodules</a></p>",
        "id": 540549039,
        "sender_full_name": "Anthony Wang",
        "timestamp": 1758329292
    },
    {
        "content": "<p>If you clone using <code>git clone --recursive</code> then it will also clone the submodules so you don't have to run that <code>git submodule</code> command manually, but it looks like lake doesn't do that, based on the <a href=\"https://github.com/leanprover/lean4/blob/c6abc3c0368e10c49e9762fda1819ad0e95c9bb0/src/lake/Lake/Util/Git.lean#L65-L66\">https://github.com/leanprover/lean4/blob/c6abc3c0368e10c49e9762fda1819ad0e95c9bb0/src/lake/Lake/Util/Git.lean#L65-L66</a> link that <span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> sent.</p>",
        "id": 540549160,
        "sender_full_name": "Anthony Wang",
        "timestamp": 1758329443
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/issues/10467\">https://github.com/leanprover/lean4/issues/10467</a> <br>\nmade an issue, this should be a pretty easy fix/thing to test</p>",
        "id": 540549302,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758329609
    },
    {
        "content": "<p>Made a test project to show that it doesn't work: <a href=\"https://github.com/ValorZard/Test-Lean-Git-Submodule\">https://github.com/ValorZard/Test-Lean-Git-Submodule</a><br>\n(it doesn't compile for other reasons, but you can see that it never fills out the gits ubmodule in \".lake\\packages\\SampCert\\Tests\\IBM\"</p>",
        "id": 540553910,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758335854
    },
    {
        "content": "<p>In the interim switching to subtrees (which are anyhow better <span aria-label=\"devil\" class=\"emoji emoji-1f47f\" role=\"img\" title=\"devil\">:devil:</span> ) is a workaround just in case you haven't considered that.</p>",
        "id": 540663716,
        "sender_full_name": "Julian Berman",
        "timestamp": 1758467463
    }
]