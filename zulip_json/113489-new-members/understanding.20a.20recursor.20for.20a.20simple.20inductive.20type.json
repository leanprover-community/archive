[
    {
        "content": "<p>The following is a simplified inductive type based on a bigger example from TPIL4:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Weekend</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">sunday</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Weekend</span>\n<span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">monday</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Weekend</span>\n\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">Weekend</span><span class=\"bp\">.</span><span class=\"n\">rec</span>\n</code></pre></div>\n<p>The output from <code>#check</code> is:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Weekend</span><span class=\"bp\">.</span><span class=\"n\">rec</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Weekend</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sunday</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"n\">Weekend</span><span class=\"bp\">.</span><span class=\"n\">sunday</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">monday</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"n\">Weekend</span><span class=\"bp\">.</span><span class=\"n\">monday</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Weekend</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"n\">t</span>\n</code></pre></div>\n<p>I'm trying to do two things: (1) understand what a recursor is (my preconception was that it was an iterator), and (2) understand what the above output actually means.</p>\n<p>I'd welcome help on those 2 things.</p>\n<p>My own attempt is this - the following is likely wrong:</p>\n<ul>\n<li><code>Weekend.rec.{u} {motive : Weekend → Sort u} </code>  means <code>Weekend</code> is a type, not a term.</li>\n<li><code>motive</code> is not defined so is a placeholder for a function that maps from Weekend to some other type <code>u</code>.</li>\n<li><strong>IF</strong> <code>sunday</code> and <code>monday</code> are in the co-domain of that function <code>motive</code>, and <code>t</code> is of type <code>Weekend</code> <strong>THEN</strong> that function <code>motive</code> can be applied to <code>t</code> (interpreted as any <code>t</code> in <code>Weekend</code>)</li>\n</ul>\n<p>Not sure what that last bullet point actually means. I know Kevin Buzzard's blog tries to explain this but it was beyond my brain sadly.</p>",
        "id": 493620559,
        "sender_full_name": "rzeta0",
        "timestamp": 1736871336
    },
    {
        "content": "<p>High level, the purpose of a recursor is to define a function whose domain is (in this case) <code>Weekend</code>, by specifying how the function acts on each variant</p>",
        "id": 493621525,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1736871616
    },
    {
        "content": "<p>So if I eat one pizza on Sunday and two pizzas on Monday, you can define a function <code>Weekend → Nat</code> that returns how many pizzas I had by writing</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">pizzas</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Weekend</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Weekend</span><span class=\"bp\">.</span><span class=\"n\">rec</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">sunday</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">monday</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">d</span>\n</code></pre></div>",
        "id": 493622090,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1736871786
    },
    {
        "content": "<p>In this case, <code>motive</code> is <code>fun _ =&gt; Nat</code></p>",
        "id": 493622235,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1736871832
    },
    {
        "content": "<p>Thanks Ruben. Let me dig a bit deeper.</p>\n<p>The <code>pizzas</code> function maps elements of <code>Weekend</code>to a natural number. </p>\n<p>The definition you've kindly provided uses <code>Weekend.rec</code> and not <code>match d with</code> to make clearer what recursor does.</p>\n<p>Looking at your example, my initial assumption that a <strong>recursor is an iterator</strong> that provides access to every element of an inductive type (<strong>lazily</strong>, perhaps) seems correct. Is it?</p>\n<p>And the <code>match d with</code> is syntax sugar for what you have written?</p>",
        "id": 493623341,
        "sender_full_name": "rzeta0",
        "timestamp": 1736872175
    },
    {
        "content": "<p>Depends on what you mean by \"iterator\", I suppose :)</p>",
        "id": 493624064,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1736872375
    },
    {
        "content": "<p>If you're familiar with object-oriented programming design patterns, recursors implement the visitor pattern. The recursor is the <code>visit</code> method.</p>\n<p>Rather than passing a single object to <code>visit</code>, in Lean we pass multiple arguments. The arguments could in principle be the methods of a visitor object.</p>",
        "id": 493630379,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1736874242
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> Thanks, this is a nice description. Makes me wish there were a dictionary for translating functional patterns into their imperative equivalents</p>",
        "id": 493664547,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1736886574
    }
]