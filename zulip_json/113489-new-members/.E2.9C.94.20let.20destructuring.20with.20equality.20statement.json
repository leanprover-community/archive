[
    {
        "content": "<p>I want to proof this: <code>(helperMemo n m).fst = maxDollars_spec n ∧ memo_map_correct (helperMemo n m).snd</code>.<br>\nFor that, I want to introduce <code>r := helperMemo n m</code> and get the goal <code>r.fst = maxDollars_spec n ∧ memo_map_correct r.snd</code> and the hypothesis <code>r_def: r  = helperMemo n m</code> (so I don't have to unfold <code>helperMemo</code> twice, its a big function).</p>\n<p>I found it surprisingly hard to do that, <a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAZRgEwHQBECGNOoBKYDOAFgLKZgBQokscAggKaERWuMB2iKlvyjAMzghMAD3QQANpMxRCAfUJhGAYzgAKLgC44AOWwBKODv3wtAXkpw4wIV0AmRHAAccGMU5W4AWi9wAQkSMcCqBOgLQcAAGDs6RADQ2MADkhHAARowwMIxQrhBwhIzSru7BEMBcyMBQqjCSAJ6ontYcnkWFnj5wAEqqAK5ywABuQSGFOirEEBCFJUEioqB9IOmZAO6MnAVFkhUA5nNlFXBVNSp19XCYHMhwjKKT13v7iU3W1gtwXOoLEtKyCiUqg0XAA9HAAExGADUwjEfxkckUyjUmjg4IAzDC4eIpIjASiQei4AAWAwGXiUfhCdySZRQUiMED5EzYOCAJMI4AQSOQwHo2aYOfz4AB1rlEMgUYXCzwAHy+CRATPy5gAfM04TBJsJlQBtDgAXQA/HA1sA3Br5SwlXAhnA1RohorlUZvL5MJIaphkJcQpNGMhLV8IBwgmqNdZbF84I4XG4tu9E9YumlAsFQttiipypVqrUGhH3pJMjrmUljOZSxBUBVCnQuK0k+9NM6yxSm+1GIXk74zgNCMNGBMIOA+tlVoR4PdHhw9kEhh6+oxW+UAF4vD0hg7x02YerduDF+DqIYARhXp6MFjgtPpjOZRPBUKrB6PjohK+f19vOXv+TRmJGEqzKnq+JYnhiK5YhWN5FHeyqPqSQHKhCYHwBkk4wZ83xnnAsJDBCeG2liaFVuW17ARAGI1hwdbwFwGEwAe6iMSuSQUlSgg4giAJ/kSrIwFe0oWJ46g/gyCHfNykpgKgTJgDA9TkqgAiTpS1JVvIIhgPI2ZQGcx4gDo0m8tKpgGDoAAKUCsDBgAARNGTrCPqxr2gUI7zt4qrcXiALIsCXCVkMvDxtATJ3OAilacqunQAZOiUVpFCxfptQaCZFByZFSkwWklwDuAcC6ol2kpQZBohe4YUrHpBnyLWOQwElFQ4LWZW1KGhCpD8RhiaeCUxaVtVpSAvXEBCOh2pWvy+UiQJqAA1hZGolclw3nBoIA0XRcALbaV6Vnlnh9Bw4SSLcq06et8BsgAVJ4LU2Y5wSeFAaxFRlslzjAACixYgEa9W0Y1BpXPAKieEouw3eDngepI8h7BAHqpAVOnw5SlChTUKziX+7UbZoAm9aNm3yMQA3MklV1xSNFkaHjknCAYKmYdN8KzQSAVwIA5ESaUNtOE4zD5cKNqCEDcuX7pGNx9OcwAhtGfQDrOwrizANmzr0KgAPJcHOoZQB6wDrqrICeGMQQVLcXDAMQ9rqtYvDWG+uTfnBv5M+b1gkBA71QKz8Ds7i/xzYSXB85dBPwAHEuBtYxCYCMcBQPIGk6LklbC/koswVAAiSM77n6fUQA\">and ended up with this</a>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">helperMemo</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span>\n<span class=\"w\">  </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"bp\">.</span><span class=\"n\">fst</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">maxDollars_spec</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">memo_map_correct</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"bp\">.</span><span class=\"n\">snd</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">r_def</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">helperMemo</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>I'm not happy that I have to restate the goal, as in other cases the goal is much larger.<br>\nI also want to destructure the tuple into <code>(rv, rm)</code> and was hoping that I could make <code>let (rv, rm) := helperMemo n m</code> work.<br>\nHowever, I just didn't manage to get the equality <code>r_def</code> with that.</p>\n<p>Is there a better way to do this? Is there some tactic <code>set (rv, rm) := x with r_def</code>, that generates an equality statement <code>r_def: (rv, rm) = x</code>?</p>",
        "id": 525377198,
        "sender_full_name": "Henning Dieterichs",
        "timestamp": 1750699384
    },
    {
        "content": "<p>In the next Lean release, you'll be able to write <code>let +generalize r := helperMemo n m</code>. That doesn't help you now, but I thought I'd mention it :-)</p>",
        "id": 525377983,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1750699601
    },
    {
        "content": "<p>You'll also be able to write <code>let +generalize (eq := r_def) r := helperMemo n m</code> to get the <code>r_def</code> hypothesis.</p>",
        "id": 525378209,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1750699656
    },
    {
        "content": "<p>That's good to know :) what would +generalize do?</p>",
        "id": 525378240,
        "sender_full_name": "Henning Dieterichs",
        "timestamp": 1750699665
    },
    {
        "content": "<p>What you're asking, to replace <code>helperMemo n m</code> in the goal with <code>r</code>.</p>",
        "id": 525378443,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1750699714
    },
    {
        "content": "<p>(It's more of a generalization if you use <code>have</code> instead of <code>let</code>.)</p>",
        "id": 525378649,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1750699765
    },
    {
        "content": "<p>A tactic you can use right now though is <code>generalize r_def : helperMemo n m = r</code></p>",
        "id": 525378754,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1750699793
    },
    {
        "content": "<p>Thanks, didn't know about <code>generalize</code>! It solves my use-case! Thanks for your help :)</p>",
        "id": 525379455,
        "sender_full_name": "Henning Dieterichs",
        "timestamp": 1750699972
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"234196\">Henning Dieterichs</span> has marked this topic as resolved.</p>",
        "id": 525379460,
        "sender_full_name": "Notification Bot",
        "timestamp": 1750699975
    },
    {
        "content": "<p>I guess <code>let +generalize</code> is replacing the <code>set</code> tactic from mathlib?</p>",
        "id": 525397860,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750707915
    }
]