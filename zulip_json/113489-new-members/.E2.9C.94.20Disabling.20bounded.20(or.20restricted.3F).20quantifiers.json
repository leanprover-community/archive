[
    {
        "content": "<p>Hi. I'm very new to Lean and exploring it for teaching purposes, and I'm struggling with bounded (or should I say restricted?) quantifiers.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\">  </span><span class=\"c1\">-- displays ∀ a ∈ A, a ∈ B : Prop</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\">  </span><span class=\"c1\">-- also displays ∀ a ∈ A, a ∈ B : Prop</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\">  </span><span class=\"c1\">-- displays ∃ a ∈ A, a ∈ B : Prop</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\">  </span><span class=\"c1\">-- also displays ∃ a ∈ A, a ∈ B  : Prop</span>\n</code></pre></div>\n<p>I'd like to be able to locally and temporarily opt out of the \"condensed\" syntax of bounded quantifiers. This is mainly for teaching reasons, for instance to explain more gently what these condensed forms mean, why <code>intro x h</code> works on a goal of the form <code>∀ a ∈ A, a ∈ B</code>, why properties involving negation and quantifiers are true, to avoid a student's statement to become unrecognizable when printed out by Lean, and so on. </p>\n<p>Even better would be to be able to rewrite statements from one form to the other. </p>\n<p>I've tried to make sense of various pieces of information I found here, on the web or in Lean books but I'm quickly getting lost. I've seen similar concerns on being able to turn off these notations <a href=\"https://github.com/leanprover-community/mathlib3/pull/5440#issuecomment-771604030\">here</a> but this was apparently for Lean 3 and is no longer relevant. I've tried</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">piBinderTypes</span><span class=\"w\"> </span><span class=\"n\">false</span>\n</code></pre></div>\n<p>which seems to deactivate this piece of pretty-printing for universal quantifiers, but not for existential ones (and probably has other undesirable effects).</p>\n<p>Now I'm out of ideas and don't know enough to directly find the answer in the code... any help would be appreciated. Sorry if this is stupid.</p>",
        "id": 482413771,
        "sender_full_name": "Antoine Meyer",
        "timestamp": 1731596777
    },
    {
        "content": "<p>The code is here: <a href=\"https://github.com/leanprover/lean4/blob/master/src/Init/BinderPredicates.lean\">https://github.com/leanprover/lean4/blob/master/src/Init/BinderPredicates.lean</a></p>",
        "id": 482417281,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1731597660
    },
    {
        "content": "<p>I found it by putting my cursor here: <code>#check ∃ a ∈| A, a ∈ B</code> and hitting F12 in vs code</p>",
        "id": 482417401,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1731597694
    },
    {
        "content": "<p>Thanks, I should have thought of that. It doesn't tell me how to disable it, but at least I can see how it's done.</p>",
        "id": 482418897,
        "sender_full_name": "Antoine Meyer",
        "timestamp": 1731598075
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> Do you know if there are further options to finetune this?</p>",
        "id": 482429159,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1731600653
    },
    {
        "content": "<p>The pretty printers are from mathlib, and there are no options to control it: Mathlib/Util/Delaborators.lean</p>\n<p>We could add some options to control it easily enough.</p>\n<p>As far as being able to rewrite from one from to another, that would be hard to pull off because <code>∀ a, a ∈ A → a ∈ B</code> and <code>∀ a ∈ A, a ∈ B</code> represent the exact same expression. You would have to insert some sort of metadata into the expression to tell the delaborator not to merge, and you would have to hope this metadata doesn't get in the way of anything else in Lean.</p>",
        "id": 482442573,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731604321
    },
    {
        "content": "<p>I think an option to turn off the delaboration of these binders would be a good idea.  I agree that, for teaching purposes, this can be confusing.</p>",
        "id": 482445679,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1731605271
    },
    {
        "content": "<p>I'm adding <code>pp.mathlib.binderPredicates</code> right now</p>",
        "id": 482445793,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731605290
    },
    {
        "content": "<p>Thanks Kyle!</p>",
        "id": 482445955,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1731605355
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"780145\">@Antoine Meyer</span> By the way, <code>set_option pp.piBinderTypes false</code> does have a side effect that I think you might find undesirable:  something like  <code>∀ (x : ℕ), x = x</code> gets pretty printed as <code>`∀ x, x = x</code>.  For teaching purposes, I think showing the types of quantified variables is a good idea.</p>\n<p>By default, types for existentially quantified variables are not displayed.  In <a href=\"https://djvelleman.github.io/HTPIwL/\">How To Prove It With Lean</a> I used <code>set_option pp.funBinderTypes true</code> to get types of existentially quantified variables to be pretty printed.</p>",
        "id": 482447303,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1731605806
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/19040\">#19040</a> has <code>pp.mathlib.binderPredicates</code></p>",
        "id": 482447437,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731605856
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"453098\">Dan Velleman</span> <a href=\"#narrow/channel/113489-new-members/topic/Disabling.20bounded.20.28or.20restricted.3F.29.20quantifiers/near/482447303\">said</a>:</p>\n<blockquote>\n<p>I used <code>set_option pp.funBinderTypes true</code> to get types of existentially quantified variables to be pretty printed.</p>\n</blockquote>\n<p>I've wanted some solution to this problem — one idea that's come to mind before is to have a system of \"predelaborators\" that can add some pretty printing hints before delaboration is actually run. In this case, <code>Exists</code> can have a predelaborator that adds <code>pp.funBinderTypes := true</code> to its last argument.</p>",
        "id": 482447936,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731606017
    },
    {
        "content": "<p>Does the new option only handle universal quantifiers?  Can it do existential too?</p>",
        "id": 482448112,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1731606079
    },
    {
        "content": "<p>Existentials too. I made the option apply everywhere we were pretty printing with these binder predicates.</p>",
        "id": 482448263,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731606124
    },
    {
        "content": "<p>I think <code>notation3</code>-defined notations never got the ability to pretty print with binder predicates, but if they ever do, we need to make sure this option is honored there as well.</p>",
        "id": 482448500,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731606209
    },
    {
        "content": "<p>This is great. Thanks a lot for your answers!</p>",
        "id": 482449508,
        "sender_full_name": "Antoine Meyer",
        "timestamp": 1731606549
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"780145\">Antoine Meyer</span> has marked this topic as resolved.</p>",
        "id": 482450097,
        "sender_full_name": "Notification Bot",
        "timestamp": 1731606744
    },
    {
        "content": "<p>Perhaps <span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span> would be interested in this discussion.</p>",
        "id": 482471480,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1731614210
    }
]