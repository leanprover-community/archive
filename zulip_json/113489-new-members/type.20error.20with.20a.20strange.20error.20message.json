[
    {
        "content": "<p>This error message is not very useful, and I don't know why the file below spits an error.<br>\nWhat is the real type error at play  ?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- type mismatch</span>\n<span class=\"c1\">-- t'</span>\n<span class=\"c1\">-- has type</span>\n<span class=\"c1\">-- LimitCone (Functor.empty Cat) : Type (max (max (u + 1) (v + 1)) u v)</span>\n<span class=\"c1\">-- but is expected to have type</span>\n<span class=\"c1\">-- LimitCone (Functor.empty Cat) : Type (max (max (u + 1) (v + 1)) u v)</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">ChosenFiniteProducts</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Cat</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Limits</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">terminal</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LimitCone</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Functor</span><span class=\"bp\">.</span><span class=\"n\">empty</span><span class=\"w\"> </span><span class=\"n\">Cat</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"n\">cone</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">asEmptyCone</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cat</span><span class=\"bp\">.</span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Discrete</span><span class=\"w\"> </span><span class=\"n\">PUnit</span><span class=\"o\">)),</span>\n<span class=\"w\">    </span><span class=\"n\">isLimit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">GOOD</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ChosenFiniteProducts</span><span class=\"w\"> </span><span class=\"n\">Cat</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">product</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cat</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">terminal</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">terminal</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">BAD</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ChosenFiniteProducts</span><span class=\"w\"> </span><span class=\"n\">Cat</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">product</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cat</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">terminal</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">):=</span><span class=\"w\"> </span><span class=\"n\">terminal</span>\n<span class=\"w\">                  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">t</span>\n<span class=\"w\">                  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">t'</span>\n<span class=\"w\">                  </span><span class=\"c1\">-- type mismatch</span>\n<span class=\"w\">                  </span><span class=\"c1\">--   t'</span>\n<span class=\"w\">                  </span><span class=\"c1\">-- has type</span>\n<span class=\"w\">                  </span><span class=\"c1\">--   LimitCone (Functor.empty Cat) : Type (max (max (u + 1) (v + 1)) u v)</span>\n<span class=\"w\">                  </span><span class=\"c1\">-- but is expected to have type</span>\n<span class=\"w\">                  </span><span class=\"c1\">--   LimitCone (Functor.empty Cat) : Type (max (max (u + 1) (v + 1)) u v)</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Cat</span>\n</code></pre></div>",
        "id": 455052787,
        "sender_full_name": "Nicolas Rolland",
        "timestamp": 1722324828
    },
    {
        "content": "<p>You can try <code>convert t'</code> to see the difference between the two terms</p>",
        "id": 455066757,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1722328673
    },
    {
        "content": "<p>where is <code>convert</code> defined ?</p>\n<p>using </p>\n<p><code>set_option pp.universes true</code></p>\n<p>I could get more info :</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- type mismatch</span>\n<span class=\"c1\">--   t'</span>\n<span class=\"c1\">-- has type</span>\n<span class=\"c1\">--   LimitCone.{0, 0, max u v, (max u v) + 1}</span>\n<span class=\"c1\">--     (Functor.empty.{0, max u v, (max u v) + 1} Cat.{max u v, max u v}) : Type (max (max (u + 1) (v + 1)) u v)</span>\n<span class=\"c1\">-- but is expected to have type</span>\n<span class=\"c1\">--   LimitCone.{0, 0, max u v, max (u + 1) (v + 1)}</span>\n<span class=\"c1\">--     (Functor.empty.{0, max u v, max (u + 1) (v + 1)} Cat.{v, u}) : Type (max (max (u + 1) (v + 1)) u v)</span>\n</code></pre></div>\n<p>(I think the underlying error itself is related to the category instance of <code>Discrete</code> which is a \"small category\"  aka <code>Cat.{u,u}</code>)</p>",
        "id": 455087050,
        "sender_full_name": "Nicolas Rolland",
        "timestamp": 1722333573
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"257803\">Nicolas Rolland</span> <a href=\"#narrow/stream/113489-new-members/topic/type.20error.20with.20a.20strange.20error.20message/near/455087050\">said</a>:</p>\n<blockquote>\n<p>where is <code>convert</code> defined ?</p>\n</blockquote>\n<p>These both work:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"c1\">-- import Mathlib.Tactic.Convert</span>\n<span class=\"bp\">#</span><span class=\"n\">min_imports</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">))</span>\n\n<span class=\"bp\">#</span><span class=\"n\">min_imports</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\">  </span><span class=\"c1\">-- import Mathlib.Tactic.Convert</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>",
        "id": 455089034,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1722334141
    }
]