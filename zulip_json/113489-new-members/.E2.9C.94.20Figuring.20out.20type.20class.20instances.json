[
    {
        "content": "<p>I am trying to read some mathlib code and in particular figure out how <code>Filter.Tendsto.mul</code> works for reals,  clicking on it, I see that instance of <code>ContinuousMul</code> does the main work. so I tried to synthesize that class for reals. and I see the instance comes from <code>IsTopologicalSemiring</code>.  Trying to synthesize that, I see it's coming from <code>IsTopologicalRing</code>. Finally, trying to synthesize that I found this <a href=\"https://github.com/leanprover-community/mathlib4/blob/c05f2327e9fd8d4429dc98cb29f0d01abc73bfa6/Mathlib/Topology/Algebra/Ring/Real.lean#L56-L56\">line</a> which creates the instance with inferInstance. But now I'm stuck, I can't figure out where is the <code>continuous_mul</code> proof for reals coming from. So my general question is how to figure out the details of the instance when they are done via <code>inferInstance</code>?</p>",
        "id": 517644680,
        "sender_full_name": "Sabbir Rahman",
        "timestamp": 1747078705
    },
    {
        "content": "<p>It ultimately comes from <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsStrictOrderedRing.topologicalRing#doc\">docs#IsStrictOrderedRing.topologicalRing</a> which gets its proof from <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsTopologicalRing.of_norm#doc\">docs#IsTopologicalRing.of_norm</a></p>",
        "id": 517646068,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1747079092
    },
    {
        "content": "<p>You can put <code>#synth IsTopologicalRing ℝ</code> on the line above that shortcut instance</p>",
        "id": 517647376,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1747079485
    },
    {
        "content": "<p>Thanks a lot, but how would I have figured this myself? am I stuck after getting to inferInstance without prior knowledge of how things are done?</p>",
        "id": 517647400,
        "sender_full_name": "Sabbir Rahman",
        "timestamp": 1747079492
    },
    {
        "content": "<p>Here's a neat trick: you can put the term in the tactic state and just keep unfolding.</p>",
        "id": 517647660,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1747079560
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/channel/113489-new-members/topic/Figuring.20out.20type.20class.20instances/near/517647376\">said</a>:</p>\n<blockquote>\n<p>You can put <code>#synth IsTopologicalRing ℝ</code> on the line above that shortcut instance</p>\n</blockquote>\n<p>ok that works, but kinda surprising. I was hoping there was a more expressive api to uncover instance shananigans.</p>",
        "id": 517647796,
        "sender_full_name": "Sabbir Rahman",
        "timestamp": 1747079608
    },
    {
        "content": "<p>Let me know if you find one :)</p>",
        "id": 517647970,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1747079653
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113489-new-members/topic/Figuring.20out.20type.20class.20instances/near/517647660\">said</a>:</p>\n<blockquote>\n<p>Here's a neat trick: you can put the term in the tactic state and just keep unfolding.</p>\n</blockquote>\n<p>I am not sure I quite follow, should I put the <code>instTopologicalRingReal</code> in tactic state and try <code>unfold</code>?</p>",
        "id": 517648458,
        "sender_full_name": "Sabbir Rahman",
        "timestamp": 1747079800
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">proofs</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContinuousMul</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">inferInstanceAs</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ContinuousMul</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">inferInstanceAs</span><span class=\"w\"> </span><span class=\"n\">IsTopologicalSemiring</span><span class=\"bp\">.</span><span class=\"n\">toContinuousMul</span>\n<span class=\"w\">    </span><span class=\"n\">IsTopologicalRing</span><span class=\"bp\">.</span><span class=\"n\">toIsTopologicalSemiring</span><span class=\"w\"> </span><span class=\"n\">instIsTopologicalRingReal</span>\n<span class=\"w\">    </span><span class=\"n\">inferInstance</span><span class=\"w\"> </span><span class=\"n\">IsTopologicalDivisionRing</span><span class=\"bp\">.</span><span class=\"n\">toIsTopologicalRing</span>\n<span class=\"w\">    </span><span class=\"n\">IsStrictOrderedRing</span><span class=\"bp\">.</span><span class=\"n\">toIsTopologicalDivisionRing</span>\n<span class=\"w\">    </span><span class=\"n\">IsStrictOrderedRing</span><span class=\"bp\">.</span><span class=\"n\">topologicalRing</span><span class=\"w\"> </span><span class=\"n\">IsTopologicalRing</span><span class=\"bp\">.</span><span class=\"n\">of_norm</span>\n<span class=\"w\">    </span><span class=\"n\">IsTopologicalRing</span><span class=\"bp\">.</span><span class=\"n\">of_addGroup_of_nhds_zero</span>\n<span class=\"w\">  </span><span class=\"c1\">-- you can see the proof term now!</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 517648700,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1747079864
    },
    {
        "content": "<p>Thanks aaron and ruben, both if the techniques are helpful in jumping around type inferences.</p>",
        "id": 517910423,
        "sender_full_name": "Sabbir Rahman",
        "timestamp": 1747165598
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"484770\">Sabbir Rahman</span> has marked this topic as resolved.</p>",
        "id": 517910449,
        "sender_full_name": "Notification Bot",
        "timestamp": 1747165608
    }
]