[
    {
        "content": "<p>I think the following MWE should be easy, but I am stuck. I have a group G, with a subset S that forms a basis for a FreeGroup isomorphic to G. I want to prove that the closure of S is all of G by making use of the fact that S generates F(S) and G is isomorphic to F(S), but despite a lot of loogling I've not found much to help. I suspect I am just missing something obvious:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">myexample</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroupBasis</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₁</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">closure_range_of</span><span class=\"w\"> </span><span class=\"n\">S</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">repr</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₃</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h₂</span><span class=\"bp\">.</span><span class=\"n\">mapSubgroup</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₄</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h₂</span><span class=\"bp\">.</span><span class=\"n\">comapSubgroup</span>\n\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">@</span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">eq_top_iff'</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">mem_map_iff_mem</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">repr</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">EquivLike</span><span class=\"bp\">.</span><span class=\"n\">injective</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">repr</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">|&gt;.</span><span class=\"n\">mp</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">@</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">map_closure</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">@</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">coe_coe</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 514655934,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1745767534
    },
    {
        "content": "<p>I think you want an equivalence and not an equality there</p>",
        "id": 514658566,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1745769392
    },
    {
        "content": "<p>I think equality is fine because subgroups are terms not types</p>",
        "id": 514659453,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1745769938
    },
    {
        "content": "<p>Oh, its a group isomorphism. Ty, this gave me an idea &lt;3</p>",
        "id": 514661792,
        "sender_full_name": "lorã",
        "timestamp": 1745771464
    },
    {
        "content": "<p>Wait, is this even true? I just looked at the definition of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FreeGroupBasis#doc\">docs#FreeGroupBasis</a> and it contains data (I had guessed it was a Prop). You've either written a statement which isn't the statement you're thinking of, or you've made a math error. For example G can be the integers, S can be {2}, and h can just be the isomorphism between 2Z and Z, and your conclusion is false.</p>",
        "id": 514677101,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1745782597
    },
    {
        "content": "<p>In short, apologies to <span class=\"user-mention\" data-user-id=\"466290\">@Luigi Massacci</span> , I don't see how you can get better than an isomorphism, and an isomorphism looks pretty weird because they're both terms. Note that in your statement you're promoting a term <code>S</code> to a type, so you're losing all the termy information about e.g. how it sits in G.</p>",
        "id": 514677261,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1745782712
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/113489-new-members/topic/Mapping.20property.20across.20isomorphism/near/514677261\">said</a>:</p>\n<blockquote>\n<p>In short, apologies to <span class=\"user-mention silent\" data-user-id=\"466290\">Luigi Massacci</span> , I don't see how you can get better than an isomorphism, and an isomorphism looks pretty weird because they're both terms. Note that in your statement you're promoting a term <code>S</code> to a type, so you're losing all the termy information about e.g. how it sits in G.</p>\n</blockquote>\n<p>I only learned to be suspicious of equality because of your blog posts anyway : )</p>",
        "id": 514680378,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1745784948
    },
    {
        "content": "<p>I indeed made the math error you mentioned, thank you for correcting my oversight.</p>",
        "id": 514682386,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1745786399
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"761203\">Vlad Tsyrklevich</span> has marked this topic as resolved.</p>",
        "id": 514682822,
        "sender_full_name": "Notification Bot",
        "timestamp": 1745786675
    }
]