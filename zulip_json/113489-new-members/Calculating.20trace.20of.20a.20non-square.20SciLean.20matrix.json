[
    {
        "content": "<p>Hi all, <br>\nI ran into this problem trying to implement a custom trace function of general matrices:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">SciLean</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Scilean</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Finset</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">trace</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Float</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"n\">m</span><span class=\"o\">]):</span><span class=\"w\"> </span><span class=\"n\">Float</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∑</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">[</span><span class=\"bp\">⟨</span><span class=\"n\">k</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"bp\">⟩</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">k</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"bp\">⟩</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>It seems that I would need to prove that k is in Fin n and k is in Fin m, but I'm not sure how to proceed. Sorry for what is probably a very basic question?</p>\n<p>Best regards, Felix</p>",
        "id": 497023128,
        "sender_full_name": "frisbro",
        "timestamp": 1738334789
    },
    {
        "content": "<p>This is not a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a>, so I can't know exactly what problem you're having, but try summing <code>∑ k : Fin (min n m), A[k.castLE (min_le_left n m), k.castLE (min_le_right n m)]</code> instead?</p>",
        "id": 497030674,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1738337018
    },
    {
        "content": "<p>I apologize for not posting a mwe, I've updated the question to include the opens and import. Thank you for your answer, that indeed solved the problem!</p>",
        "id": 497031549,
        "sender_full_name": "frisbro",
        "timestamp": 1738337275
    }
]