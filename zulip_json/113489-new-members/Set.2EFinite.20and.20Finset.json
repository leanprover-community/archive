[
    {
        "content": "<p>Hi! I'm new to Mathlib.<br>\nI need some way to express that a collection of elements is finite. The Mathematics in Lean Book makes heavy use of Fintype/Finset so I tried using Finset. I found working with it however cumbersome, because constructing at new Finset is somewhat difficult. I discovered now the Set.Finite predicate in the library, with a note that it should be preferred in theorems. My questions is now, which to use when?</p>",
        "id": 481138951,
        "sender_full_name": "Tobias Leichtfried",
        "timestamp": 1730991551
    },
    {
        "content": "<p>Hey! In what context do you want to work with finite sets?</p>",
        "id": 481146154,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730993631
    },
    {
        "content": "<p>I am formalizing nondeterministic pushdown automata. These have a transition function which when given the state at a point in time return a set of possible new states.</p>",
        "id": 481156561,
        "sender_full_name": "Tobias Leichtfried",
        "timestamp": 1730996856
    },
    {
        "content": "<p>From what you are describing, it looks like your finite sets are all subsets of a finite set? So you could probably work with a <code>S: Fintype</code> for your global set of states, and <code>X: Set S</code> for a set <code>X</code> of states?</p>",
        "id": 481164836,
        "sender_full_name": "Philippe Duchon",
        "timestamp": 1730999412
    },
    {
        "content": "<p>No, that is not possible, as the automaton can push a list of arbitrary length on the stack, so there is a non finite amount of possible next states</p>",
        "id": 481250628,
        "sender_full_name": "Tobias Leichtfried",
        "timestamp": 1731048108
    },
    {
        "content": "<p>Can you give an example of a Finset that you are finding difficult to construct?</p>",
        "id": 481251868,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731048938
    },
    {
        "content": "<p>A very concrete example would be the following snippet</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">transition_fun'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContextFreeGrammar</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">NT</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">nonterminal</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Q</span><span class=\"bp\">.</span><span class=\"n\">loop</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">rules</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">∅</span>\n</code></pre></div>\n<p>The set which this function returns is finite, because G.rules is a list. But more generally a ordinary Set I can construct just using a predicate, a finset can not be constructed this way if there is no obvious finite superset.</p>",
        "id": 481303702,
        "sender_full_name": "Tobias Leichtfried",
        "timestamp": 1731068656
    }
]