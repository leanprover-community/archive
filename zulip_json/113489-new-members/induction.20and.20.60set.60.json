[
    {
        "content": "<p>I'm sure this has been discussed before, but 'set' is a useless search keyword. I want to prove an equality of two function calls valued in Nat using induction, say <code>foo α = bar α</code>. Using <code>set n := foo α with hn</code> creates the variable/hypothesis</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"n\">hn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"n\">α</span>\n</code></pre></div>\n<p>but when I try to <code>induction n</code>, the value of n is not replaced in hn. If I write the variable/hypothesis explicitly obviously everything works as expected. What am I missing to make this work?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">opaque</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"kn\">opaque</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">baz</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">hn</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"c1\">-- hn : n = foo α</span>\n<span class=\"w\">    </span><span class=\"c1\">-- ⊢ 0 = bar α</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">baz2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"c1\">-- hn : 0 = foo α</span>\n<span class=\"w\">    </span><span class=\"c1\">-- ⊢ 0 = bar α</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 539396703,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1757844907
    },
    {
        "content": "<p>that's so weird</p>",
        "id": 539396949,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1757845184
    },
    {
        "content": "<p>oh never mind it makes sense now</p>",
        "id": 539396966,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1757845195
    },
    {
        "content": "<p><code>have (eq := hn) n := foo α</code> should work better since it doesn't create a let declaration</p>",
        "id": 539397039,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1757845296
    },
    {
        "content": "<p>it's because <code>n</code> is not a <code>cdecl</code> or nondependent <code>ldecl</code>, so <code>induction</code> treats it differently</p>",
        "id": 539397054,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1757845308
    },
    {
        "content": "<p>the same as doing <code>induction foo α</code>, it only generalizes the occurrences in the goal</p>",
        "id": 539397092,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1757845349
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"873547\">Robin Arnez</span> <a href=\"#narrow/channel/113489-new-members/topic/induction.20and.20.60set.60/near/539397039\">said</a>:</p>\n<blockquote>\n<p><code>have (eq := hn) n := foo α</code> should work better since it doesn't create a let declaration</p>\n</blockquote>\n<p>Thanks! If I had infinite time it'd be nice to add a warning to induction to inform users of this when they hit this case.</p>",
        "id": 539397165,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1757845427
    },
    {
        "content": "<p>Oh and maybe <code>have +generalize (eq := hn) n := foo α</code> if you want to replace the <code>foo α</code> in the goal</p>",
        "id": 539397385,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1757845675
    }
]