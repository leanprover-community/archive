[
    {
        "content": "<p>Hey, I'm new here trying to learn lean, by following the Functional Programming in Lean book.<br>\nI'm running into a few troubles with some of the examples provided.<br>\nThe following should work according to the book, but the prove by simp doesn't seem to work for me. What am I doing wrong?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">NonEmptyList</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"n\">head</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"n\">tail</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">α</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">idahoSpiders</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NonEmptyList</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">  </span><span class=\"n\">head</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"Banded Garden Spider\"</span><span class=\"o\">,</span>\n<span class=\"w\">  </span><span class=\"n\">tail</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">[</span>\n<span class=\"w\">    </span><span class=\"s2\">\"Long-legged Sac Spider\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"Wolf Spider\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"Hobo Spider\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"Cat-faced Spider\"</span>\n<span class=\"w\">  </span><span class=\"o\">]</span>\n<span class=\"o\">}</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">NonEmptyList</span><span class=\"bp\">.</span><span class=\"n\">get?</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NonEmptyList</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"bp\">.</span><span class=\"n\">head</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"bp\">.</span><span class=\"n\">tail</span><span class=\"bp\">.</span><span class=\"n\">get?</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">NonEmptyList</span><span class=\"bp\">.</span><span class=\"n\">inBounds</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NonEmptyList</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"bp\">.</span><span class=\"n\">tail</span><span class=\"bp\">.</span><span class=\"n\">length</span>\n\n<span class=\"c\">/-</span>\n<span class=\"cm\">unsolved goals</span>\n\n<span class=\"cm\">⊢ 2 ≤ idahoSpiders.tail.length</span>\n<span class=\"cm\">-/</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">atLeastThreeSpiders</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">idahoSpiders</span><span class=\"bp\">.</span><span class=\"n\">inBounds</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n</code></pre></div>",
        "id": 454549547,
        "sender_full_name": "Tristan Kobusch",
        "timestamp": 1722128838
    },
    {
        "content": "<p>nothing. the docs appear to be wrong. you can fix it by changing <code>def</code> to <code>abbrev</code> for <code>idahoSpiders</code>, or by putting <code>@[simp]</code> in front of this definition.</p>\n<p>Perhaps something has changed in lean since the docs were generated?</p>",
        "id": 454551265,
        "sender_full_name": "Michal Wallace (tangentstorm)",
        "timestamp": 1722130132
    },
    {
        "content": "<p>thank you so much. Both variants work. Looks like I'm also not the first person, to run into this issue<br>\n<a href=\"https://github.com/leanprover/fp-lean/issues/137\">https://github.com/leanprover/fp-lean/issues/137</a>. As you suspected something got changed in Lean 4.3</p>",
        "id": 454551589,
        "sender_full_name": "Tristan Kobusch",
        "timestamp": 1722130423
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"740359\">Tristan Kobusch</span> has marked this topic as resolved.</p>",
        "id": 454551598,
        "sender_full_name": "Notification Bot",
        "timestamp": 1722130438
    }
]