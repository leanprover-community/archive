[
    {
        "content": "<p>Hey everyone. I have been playing around with Lean for Advent of Code just to learn more about Lean in general but ran into something a bit confusing. I am sure its probably just a lack of knowledge from my part. I have a simplistic example:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"mf\">39.000</span><span class=\"bp\">.</span><span class=\"n\">toInt32</span><span class=\"w\"> </span><span class=\"c1\">-- outputs 39 as I would expect</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(((</span><span class=\"mf\">50239.0</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mf\">100.0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mf\">502.39</span><span class=\"bp\">.</span><span class=\"n\">floor</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"mf\">100.0</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toInt32</span><span class=\"w\"> </span><span class=\"c1\">-- outputs 38 but the part before .toInt32 will output 39.0000</span>\n</code></pre></div>\n<p>Is 38 actually what is expected in this case? I am confused a bit since I expect this to have the same result as the first example</p>",
        "id": 563035655,
        "sender_full_name": "mdioc",
        "timestamp": 1765395565
    },
    {
        "content": "<p>I think you are getting tripped up by floating point arithmetic here and not lean, see this in python:</p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"p\">((</span><span class=\"mf\">50239.0</span><span class=\"o\">/</span><span class=\"mf\">100.0</span> <span class=\"o\">-</span> <span class=\"nb\">int</span><span class=\"p\">(</span><span class=\"mf\">502.39</span><span class=\"p\">))</span> <span class=\"o\">*</span> <span class=\"mi\">100</span><span class=\"p\">)</span>\n<span class=\"mf\">38.999999999998636</span>\n</code></pre></div>\n<p>It is ever so slightly less than 39, so floor operation rounds it down.</p>",
        "id": 563036374,
        "sender_full_name": "One Happy Fellow",
        "timestamp": 1765395847
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"983119\">One Happy Fellow</span> <a href=\"#narrow/channel/113489-new-members/topic/Confused.20about.20result.20of.20float.20to.20int32.20conversion/near/563036374\">said</a>:</p>\n<blockquote>\n<p>I think you are getting tripped up by floating point arithmetic here and not lean, see this in python:</p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"p\">((</span><span class=\"mf\">50239.0</span><span class=\"o\">/</span><span class=\"mf\">100.0</span> <span class=\"o\">-</span> <span class=\"nb\">int</span><span class=\"p\">(</span><span class=\"mf\">502.39</span><span class=\"p\">))</span> <span class=\"o\">*</span> <span class=\"mi\">100</span><span class=\"p\">)</span>\n<span class=\"mf\">38.999999999998636</span>\n</code></pre></div>\n<p>It is ever so slightly less than 39, so floor operation rounds it down.</p>\n</blockquote>\n<p>Yep I do indeed seem to be tripped up by the floating point math. Does #eval do some form of rounding for output?</p>\n<p>I guess I was confused more by the fact that:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"mf\">50239.0</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mf\">100.0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mf\">502.39</span><span class=\"bp\">.</span><span class=\"n\">floor</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"mf\">100.0</span><span class=\"w\"> </span><span class=\"c1\">-- outputs 39.000000</span>\n</code></pre></div>\n<p>but your example does show the culprit :)</p>",
        "id": 563037256,
        "sender_full_name": "mdioc",
        "timestamp": 1765396226
    },
    {
        "content": "<p>it's <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Float.toString#doc\">docs#Float.toString</a> that's rounding</p>",
        "id": 563038431,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1765396698
    },
    {
        "content": "<p>Excellent, thanks both!</p>",
        "id": 563039611,
        "sender_full_name": "mdioc",
        "timestamp": 1765397192
    }
]