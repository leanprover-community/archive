[
    {
        "content": "<p>I was looking at the <code>TODO: assume weaker typeclasses</code> for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsOrderedMonoid#doc\">docs#IsOrderedMonoid</a>. </p>\n<p>Here is the current definition:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">IsOrderedMonoid</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommMonoid</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">PartialOrder</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"kn\">protected</span><span class=\"w\"> </span><span class=\"n\">mul_le_mul_left</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b</span>\n<span class=\"w\">  </span><span class=\"kn\">protected</span><span class=\"w\"> </span><span class=\"n\">mul_le_mul_right</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mul_comm</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_comm</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">mul_le_mul_left</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">c</span>\n</code></pre></div>\n<p>A barebone version of the class could be</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">IsOrderedCommMagma</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommMagma</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LE</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"kn\">protected</span><span class=\"w\"> </span><span class=\"n\">mul_le_mul_left</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b</span>\n<span class=\"w\">  </span><span class=\"kn\">protected</span><span class=\"w\"> </span><span class=\"n\">mul_le_mul_right</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mul_comm</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_comm</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">mul_le_mul_left</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">c</span>\n</code></pre></div>\n<p>Is this the right approach?</p>\n<p>We can state the monotonicity properties with just <code>[LE α]</code>, but we do not have much to say about it unless we atleast have a <code>[Preorder α]</code>. What's the general philosophy here? Do we choose the absolute minimum typeclass required to state the props (<code>LE</code>), or the \"interesting minimum\" required to build a useful theory (<code>Preorder</code>)?</p>",
        "id": 527349247,
        "sender_full_name": "Peter Hansen",
        "timestamp": 1751810894
    },
    {
        "content": "<p>I was thinking weaken <code>CommMonoid</code> to <code>Monoid</code> or <code>Semigroup</code> or <code>Mul</code></p>",
        "id": 527350015,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1751811671
    },
    {
        "content": "<p>That way it can be applied to ordinals which do not have commutative multiplication</p>",
        "id": 527350037,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1751811701
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113489-new-members/topic/Absolute.20minimum.20vs.2E.20interesting.20minimum.20mixins.2E/near/527350015\">said</a>:</p>\n<blockquote>\n<p>I was thinking weaken <code>CommMonoid</code> to <code>Monoid</code> or <code>Semigroup</code> or <code>Mul</code></p>\n</blockquote>\n<p>I suppose there is no intrinsic reason for the operation to be commutative ...  or associative really  ... so maybe just a <code>Mul</code>?</p>",
        "id": 527353570,
        "sender_full_name": "Peter Hansen",
        "timestamp": 1751815395
    },
    {
        "content": "<p>Also changing <code>PartialOrder</code> to <code>Preorder</code> does have a use (I have a use in mind)</p>",
        "id": 527353688,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1751815541
    },
    {
        "content": "<p>but not sure about <code>Preorder</code> to <code>LE</code></p>",
        "id": 527353703,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1751815548
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113489-new-members/topic/Absolute.20minimum.20vs.2E.20interesting.20minimum.20mixins.2E/near/527353703\">said</a>:</p>\n<blockquote>\n<p>but not sure about <code>Preorder</code> to <code>LE</code></p>\n</blockquote>\n<p>No, I doubt it would have much use without at least a preorder.  Hence my question in the post. There seem to be little gained from using <code>LE</code>, but is there any expense?</p>",
        "id": 527354180,
        "sender_full_name": "Peter Hansen",
        "timestamp": 1751816076
    },
    {
        "content": "<p>It's not clear to me that you shoud change the name of the class. For example we have things like <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=RingHom#doc\">docs#RingHom</a> which is more general than homomorphisms between rings but is called <code>RingHom</code> to maximise readability.</p>",
        "id": 527355089,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751817036
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/113489-new-members/topic/Absolute.20minimum.20vs.2E.20interesting.20minimum.20mixins.2E/near/527355089\">said</a>:</p>\n<blockquote>\n<p>It's not clear to me that you shoud change the name of the class. For example we have things like <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=RingHom#doc\">docs#RingHom</a> which is more general than homomorphisms between rings but is called <code>RingHom</code> to maximise readability.</p>\n</blockquote>\n<p>Fair enough - let's keep it an ordered monoid then.  If you have any thoughts regarding the type-classes it should assume, I would very much like to hear it :)</p>",
        "id": 527356238,
        "sender_full_name": "Peter Hansen",
        "timestamp": 1751818080
    },
    {
        "content": "<p>I don't really know how the basic stuff like this should be wired up. Just git blame who wrote the TODO and ping them here :-)</p>",
        "id": 527358326,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751820359
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"400289\">@Artie Khovanov</span>, I'm sure you would enjoy the discussion <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span></p>",
        "id": 527358498,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1751820562
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"455791\">@Yuyang Zhao</span></p>",
        "id": 527359725,
        "sender_full_name": "Peter Hansen",
        "timestamp": 1751821656
    },
    {
        "content": "<p>Cheers Yaël <span aria-label=\"sob\" class=\"emoji emoji-1f62d\" role=\"img\" title=\"sob\">:sob:</span><br>\nYes, I have my own proposals in this space<br>\nAround <code>IsOrderedRing</code></p>",
        "id": 527360871,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1751822984
    },
    {
        "content": "<p>Just wanted to say that I'd be excited to see a version that includes noncommutative ordered semigroups as I need them in a project of mine!</p>\n<p>Here's an example of the definitions I care about in case that's helpful <a href=\"https://github.com/ericluap/OrderedSemigroups/blob/ebe70b1e703d21aeaf88ee3ba5b3f13b46bca0f0/OrderedSemigroups/Defs.lean\">Defs.lean</a></p>",
        "id": 527381202,
        "sender_full_name": "Eric Paul",
        "timestamp": 1751846104
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"512030\">@Eric Paul</span> are you aware of the unbundled order mixins in <code>Algebra.Order.Monoid.Unbundled.Defs</code>?</p>",
        "id": 527385083,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1751850310
    },
    {
        "content": "<p>I'm roughly aware of them but wasn't certain the best way to interact with them. I went ahead and tried to copy the way mathlib currently sets up <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsOrderedMonoid#doc\">docs#IsOrderedMonoid</a>, that is defining an <code>IsOrdered___</code> and then giving it the instances of those unbundled things.</p>",
        "id": 527562380,
        "sender_full_name": "Eric Paul",
        "timestamp": 1751922046
    },
    {
        "content": "<p>I noticed that some people might want weaker assumptions. But to avoid affecting the benchmark results, I didn't weaken it in that PR. I'm not sure whether <code>[LE α]</code> or <code>[Preorder α]</code> is better. Regarding the name issue, it has already been asked once at <a href=\"#narrow/channel/287929-mathlib4/topic/Ways.20to.20speed.20up.20Mathlib/near/494192310\">https://leanprover.zulipchat.com/#narrow/channel/287929-mathlib4/topic/Ways.20to.20speed.20up.20Mathlib/near/494192310</a>.</p>",
        "id": 532466794,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1754150504
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113489-new-members/topic/Absolute.20minimum.20vs.2E.20interesting.20minimum.20mixins.2E/near/527353688\">said</a>:</p>\n<blockquote>\n<p>Also changing <code>PartialOrder</code> to <code>Preorder</code> does have a use (I have a use in mind)</p>\n</blockquote>\n<p>What's the use you have in mind?</p>",
        "id": 570001663,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1769395556
    },
    {
        "content": "<p>Oh actually I guess combinatorial games would fall into this category</p>",
        "id": 570001689,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1769395582
    },
    {
        "content": "<p>Since this thread was linked from <a href=\"https://github.com/leanprover-community/mathlib4/pull/34295\">#34295</a>, I'd like to encourage participants here to take a look at that PR and leave reviews!</p>",
        "id": 570693311,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1769652832
    }
]