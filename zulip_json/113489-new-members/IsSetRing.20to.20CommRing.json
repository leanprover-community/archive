[
    {
        "content": "<p>I tried to fill this <code>where</code> and it complains but I can't understand what it's talking about.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">SymmDiff</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">MeasurableSpace</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span>\n\n\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">symmDiff_zero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">symmDiff</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∅</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">symmDiff_eq_left</span><span class=\"bp\">.</span><span class=\"n\">mpr</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">zero_symmDiff</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">symmDiff</span><span class=\"w\"> </span><span class=\"bp\">∅</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">symmDiff_eq_right</span><span class=\"bp\">.</span><span class=\"n\">mpr</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n\n\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">IsSetRing_CommRing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsSetRing</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">symmDiff</span>\n<span class=\"w\">  </span><span class=\"n\">add_assoc</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">symmDiff_assoc</span>\n<span class=\"w\">  </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">∅</span>\n<span class=\"w\">  </span><span class=\"n\">zero_add</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"n\">reduce</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">imp_false</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">false_and</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">false_or</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">    </span><span class=\"n\">constructor</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">      </span><span class=\"n\">constructor</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"n\">add_zero</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"n\">reduce</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">s</span>\n<span class=\"w\">    </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">    </span><span class=\"n\">constructor</span>\n<span class=\"w\">    </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">ha</span>\n<span class=\"w\">    </span><span class=\"n\">constructor</span>\n<span class=\"w\">    </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">ha</span>\n<span class=\"w\">    </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"n\">nsmul</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">  </span><span class=\"n\">add_comm</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">symmDiff_comm</span>\n<span class=\"w\">  </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">inter</span>\n<span class=\"w\">  </span><span class=\"n\">left_distrib</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">inter_symmDiff_distrib_left</span>\n<span class=\"w\">  </span><span class=\"n\">right_distrib</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">inter_symmDiff_distrib_right</span>\n<span class=\"w\">  </span><span class=\"n\">zero_mul</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">empty_inter</span>\n<span class=\"w\">  </span><span class=\"n\">mul_zero</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">inter_empty</span>\n<span class=\"w\">  </span><span class=\"n\">mul_assoc</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">inter_assoc</span>\n<span class=\"w\">  </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">univ</span>\n<span class=\"w\">  </span><span class=\"n\">one_mul</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">univ_inter</span>\n<span class=\"w\">  </span><span class=\"n\">mul_one</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">inter_univ</span>\n<span class=\"w\">  </span><span class=\"n\">neg</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">id</span>\n<span class=\"w\">  </span><span class=\"n\">zsmul</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">  </span><span class=\"n\">neg_add_cancel</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">symmDiff_self</span>\n<span class=\"w\">  </span><span class=\"n\">mul_comm</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">inter_comm</span>\n\n\n<span class=\"c\">/-</span>\n\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">x✝ : Set α</span>\n<span class=\"cm\">⊢ (fun n a ↦ a) 0 x✝ = 0</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">x✝ : Set α</span>\n<span class=\"cm\">⊢ (fun n a ↦ a) 0 x✝ = 0</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">x✝ : Set α</span>\n<span class=\"cm\">⊢ (fun n a ↦ a) 0 x✝ = 0</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">x✝ : Set α</span>\n<span class=\"cm\">⊢ (fun n a ↦ a) (n✝ + 1) x✝ = (fun n a ↦ a) n✝ x✝ + x✝</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">x✝ : Set α</span>\n<span class=\"cm\">⊢ (fun n a ↦ a) (n✝ + 1) x✝ = (fun n a ↦ a) n✝ x✝ + x✝</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">x✝ : Set α</span>\n<span class=\"cm\">⊢ (fun n a ↦ a) (n✝ + 1) x✝ = (fun n a ↦ a) n✝ x✝ + x✝</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">⊢ NatCast.natCast 0 = 0</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">⊢ NatCast.natCast 0 = 0</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">⊢ NatCast.natCast (n✝ + 1) = NatCast.natCast n✝ + 1</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">⊢ NatCast.natCast (n✝ + 1) = NatCast.natCast n✝ + 1</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">x✝ : Set α</span>\n<span class=\"cm\">⊢ npowRecAuto 0 x✝ = 1</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">x✝ : Set α</span>\n<span class=\"cm\">⊢ npowRecAuto 0 x✝ = 1</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">x✝ : Set α</span>\n<span class=\"cm\">⊢ npowRecAuto (n✝ + 1) x✝ = npowRecAuto n✝ x✝ * x✝</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">x✝ : Set α</span>\n<span class=\"cm\">⊢ npowRecAuto (n✝ + 1) x✝ = npowRecAuto n✝ x✝ * x✝</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">a✝ b✝ : Set α</span>\n<span class=\"cm\">⊢ a✝ - b✝ = a✝ + -b✝</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">a✝ b✝ : Set α</span>\n<span class=\"cm\">⊢ a✝ - b✝ = a✝ + -b✝</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">a✝ : Set α</span>\n<span class=\"cm\">⊢ (fun z a ↦ a) 0 a✝ = 0</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">a✝ : Set α</span>\n<span class=\"cm\">⊢ (fun z a ↦ a) 0 a✝ = 0</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">a✝ : Set α</span>\n<span class=\"cm\">⊢ (fun z a ↦ a) 0 a✝ = 0</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">a✝ : Set α</span>\n<span class=\"cm\">⊢ (fun z a ↦ a) (↑n✝.succ) a✝ = (fun z a ↦ a) (↑n✝) a✝ + a✝</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">a✝ : Set α</span>\n<span class=\"cm\">⊢ (fun z a ↦ a) (↑n✝.succ) a✝ = (fun z a ↦ a) (↑n✝) a✝ + a✝</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">a✝ : Set α</span>\n<span class=\"cm\">⊢ (fun z a ↦ a) (↑n✝.succ) a✝ = (fun z a ↦ a) (↑n✝) a✝ + a✝</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">a✝ : Set α</span>\n<span class=\"cm\">⊢ (fun z a ↦ a) (Int.negSucc n✝) a✝ = -(fun z a ↦ a) (↑n✝.succ) a✝</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">a✝ : Set α</span>\n<span class=\"cm\">⊢ (fun z a ↦ a) (Int.negSucc n✝) a✝ = -(fun z a ↦ a) (↑n✝.succ) a✝</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">⊢ IntCast.intCast ↑n✝ = ↑n✝</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">⊢ IntCast.intCast ↑n✝ = ↑n✝</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">⊢ IntCast.intCast (Int.negSucc n✝) = -↑(n✝ + 1)</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">⊢ IntCast.intCast (Int.negSucc n✝) = -↑(n✝ + 1)</span>\n<span class=\"cm\">Messages (6)</span>\n<span class=\"cm\">01.lean:22:66</span>\n<span class=\"cm\">could not synthesize default value for field 'nsmul_zero' of 'AddMonoid' using tactics</span>\n<span class=\"cm\">01.lean:22:66</span>\n<span class=\"cm\">tactic 'rfl' failed, the left-hand side</span>\n<span class=\"cm\">  (fun n a ↦ a) 0 x✝</span>\n<span class=\"cm\">is not definitionally equal to the right-hand side</span>\n<span class=\"cm\">  0</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">x✝ : Set α</span>\n<span class=\"cm\">⊢ (fun n a ↦ a) 0 x✝ = 0</span>\n<span class=\"cm\">01.lean:22:66</span>\n<span class=\"cm\">could not synthesize default value for field 'nsmul_succ' of 'AddMonoid' using tactics</span>\n<span class=\"cm\">01.lean:22:66</span>\n<span class=\"cm\">tactic 'rfl' failed, the left-hand side</span>\n<span class=\"cm\">  (fun n a ↦ a) (n✝ + 1) x✝</span>\n<span class=\"cm\">is not definitionally equal to the right-hand side</span>\n<span class=\"cm\">  (fun n a ↦ a) n✝ x✝ + x✝</span>\n<span class=\"cm\">α : Type</span>\n<span class=\"cm\">s : Set (Set α)</span>\n<span class=\"cm\">m : MeasurableSpace α</span>\n<span class=\"cm\">hs : IsSetRing s</span>\n<span class=\"cm\">n✝ : ℕ</span>\n<span class=\"cm\">x✝ : Set α</span>\n<span class=\"cm\">⊢ (fun n a ↦ a) (n✝ + 1) x✝ = (fun n a ↦ a) n✝ x✝ + x✝</span>\n<span class=\"cm\">01.lean:22:66</span>\n<span class=\"cm\">could not synthesize default value for field 'zsmul_zero'' of 'Ring' using tactics</span>\n<span class=\"cm\">01.lean:22:66</span>\n<span class=\"cm\">could not synthesize default value for field 'zsmul_succ'' of 'Ring' using tactics</span>\n<span class=\"cm\"> -/</span>\n</code></pre></div>",
        "id": 491238185,
        "sender_full_name": "Iocta",
        "timestamp": 1735535339
    },
    {
        "content": "<p>Huh, that's kind of weird... I went to add a proof for <code>nsmul_zero</code> and it said there were 26 goals. Not sure what's going on.</p>\n<p>Maybe those are for other fields in the structure.</p>\n<p>I mean you do have to prove <code>∀ x, nsmul 0 x = 0</code>, and you defined it as <code>nsmul n a := a</code>, so I think that proposition is false. Maybe you need to change the definition of <code>nsmul</code>.</p>",
        "id": 491239192,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1735536474
    },
    {
        "content": "<p>Lean provides <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=nsmulRec#doc\">docs#nsmulRec</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=zsmulRec#doc\">docs#zsmulRec</a> for defining <code>nsmul</code> and <code>zsmul</code></p>",
        "id": 491240877,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1735538086
    },
    {
        "content": "<p>This is a known bug which was fixed at <a href=\"https://github.com/leanprover/lean4/pull/6408\">lean#6408</a>. Are you able to update your Lean version?</p>",
        "id": 491241047,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1735538281
    },
    {
        "content": "<p>Ah, so the extra goals is a Lean bug, gotcha. I think there's also a separate problem with the definition, which is that <code>nsmul</code> and <code>zsmul</code> aren't defined correctly. (Though that might've been more obvious without the extra goals.)</p>\n<p><span class=\"user-mention\" data-user-id=\"253355\">@Iocta</span> you can define <code>nsmul</code> as <code>nsmulRec</code> and define <code>zsmul</code> as <code>zsmulRec</code>. You might need to add <code>Zero</code>, <code>Add</code>, and <code>Neg</code> instances for <code>Set α</code> beforehand.</p>",
        "id": 491241432,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1735538484
    },
    {
        "content": "<p>You could also define <code>Set α</code> as a <code>BooleanRing</code> via the existing <code>BooleanAlgebra</code> instance on <code>Set α</code> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=BooleanAlgebra.toBooleanRing#doc\">docs#BooleanAlgebra.toBooleanRing</a>. Then you automatically get a <code>CommRing</code> via <code>BooleanRing.toCommRing</code> and I believe it's the same structure you're trying to define? (<code>+</code> is symm diff, <code>*</code> is intersection, etc.)</p>",
        "id": 491243380,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1735540082
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BooleanRing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BooleanAlgebra</span><span class=\"bp\">.</span><span class=\"n\">toBooleanRing</span>\n\n<span class=\"bp\">#</span><span class=\"n\">synth</span><span class=\"w\"> </span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 491243547,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1735540219
    },
    {
        "content": "<p>(though if what you're really trying to prove is that <code>s</code> is a <code>CommRing</code>, then that won't be sufficient)</p>",
        "id": 491245398,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1735541731
    },
    {
        "content": "<p>in that case maybe you could construct a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Subring#doc\">docs#Subring</a> using the proof of <code>IsSetRing</code> and then you'll get the <code>CommRing</code> via <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Subring.toCommRing#doc\">docs#Subring.toCommRing</a></p>\n<p>(<strong>Edit:</strong> Okay that might not work since <code>s</code> would need to contain <code>1</code> i.e. <code>Set.univ</code>...)</p>",
        "id": 491246194,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1735542321
    }
]