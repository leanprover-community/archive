[
    {
        "content": "<p>In <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Convex/Basic.html\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Convex/Basic.html</a> it says \"TODO: Generalize all this file to affine spaces\". What is the progress on this? For context, if this becomes usable for affine spaces, it will make some of my intermediate lemma cleaner at <a href=\"https://github.com/leanprover-community/mathlib4/pull/34826\">#34826</a> (e.g. <a href=\"https://github.com/leanprover-community/mathlib4/pull/34826/changes#diff-dcda78101cd6770dc2de63aea2f40a253a4bd827e64f6bd860070e0bc53bc70eR232\">this</a> would be just <code>Convex s.closedInterior</code>)</p>",
        "id": 572050035,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1770260489
    },
    {
        "content": "<p>See <a href=\"https://github.com/leanprover-community/mathlib4/pull/34594\">#34594</a> - but note (a) even with that in, all the theory of convexity would need adapting to <code>ConvexSpace</code>, and (b) I'm not sure this <em>should</em> be an instance, as opposed to a <code>def</code>, because of the diamond issue (semimodules over ordered semirings should also be convex spaces, but then you get a diamond for a module over a ring, which can be a convex space either through the module structure or as an affine space for itself, and the two convex space structures would be equal but not defeq).</p>",
        "id": 572269617,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1770335524
    },
    {
        "content": "<p>One way is to use the same typeclass for affine spaces and convex spaces.</p>",
        "id": 572283239,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1770345004
    },
    {
        "content": "<p>(and don't use <code>AddTorsor</code>)</p>",
        "id": 572283258,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1770345015
    },
    {
        "content": "<p>This means even more refactors.</p>",
        "id": 572283308,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1770345056
    },
    {
        "content": "<p>I mean, <code>ConvexSpace R X := AffineSpace {x : R // 0 \\le x} X</code>, where <code>AffineSpace</code> is defined in the way we define <code>ConvexSpace</code>. Then we'll have a <code>def</code> going from <code>AddTorsor</code> to <code>AffineSpace</code>.</p>",
        "id": 572283434,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1770345146
    },
    {
        "content": "<p>That would still need to be a <code>def</code> not an <code>instance</code> to avoid a diamond (on the basis that semimodules over semirings would also be that kind of <code>AffineSpace</code> directly). I think the diamond is essential to anything involving affine combinations of points both in semimodules and in torsors for modules (though you could have a <code>Prop</code> typeclass to assert that the affine combinations in a torsor are the expected ones).</p>",
        "id": 572481117,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1770422580
    }
]