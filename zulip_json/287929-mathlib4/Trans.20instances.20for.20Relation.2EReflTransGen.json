[
    {
        "content": "<p>Should these instances (from a discussion with <span class=\"user-mention\" data-user-id=\"931332\">@Thomas Waring</span> ) exist?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Relation</span><span class=\"w\"> </span><span class=\"n\">Relation</span><span class=\"bp\">.</span><span class=\"n\">ReflTransGen</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Trans</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ReflTransGen</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">hab</span><span class=\"w\"> </span><span class=\"n\">hbc</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">head</span><span class=\"w\"> </span><span class=\"n\">hab</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">single</span><span class=\"w\"> </span><span class=\"n\">hbc</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Trans</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ReflTransGen</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ReflTransGen</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨</span><span class=\"n\">head</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Trans</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ReflTransGen</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ReflTransGen</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨</span><span class=\"n\">tail</span><span class=\"bp\">⟩</span>\n</code></pre></div>\n<p>There are already <a href=\"https://loogle.lean-lang.org/?q=Relation.ReflTransGen%2C+Trans\">some similar instances</a> relating <code>ReflTransGen</code> and <code>TransGen</code>. This would have the benefit of allowing you to switch back and forth between single and multiple applications of the relation in a <code>calc</code> block.</p>",
        "id": 529338916,
        "sender_full_name": "Chris Henson",
        "timestamp": 1752778619
    },
    {
        "content": "<p>That's a neat idea. I don't see anything immediately wrong with it.</p>\n<p>Maybe, it could be nice to have some <code>Trans</code> instances for <code>WCovby</code> and <code>CovBy</code> and <code>≤</code> and <code>&lt;</code> too, for the same reason.</p>",
        "id": 529341746,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1752779861
    },
    {
        "content": "<p>These instances look like a good idea to me</p>",
        "id": 529350719,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1752783952
    },
    {
        "content": "<p>Adding these seems to break a few existing usages of <code>calc</code> and <code>trans</code> in <code>Mathlib.Order.Lattice</code> and <code>Mathlib.Algebra.GCDMonoid.Basic</code>. Specifically:</p>\n<ul>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Monotone.forall_le_of_antitone#doc\">docs#Monotone.forall_le_of_antitone</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=le_of_inf_le_sup_le#doc\">docs#le_of_inf_le_sup_le</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=gcd_pow_right_dvd_pow_gcd#doc\">docs#gcd_pow_right_dvd_pow_gcd</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=gcd_pow_left_dvd_pow_gcd#doc\">docs#gcd_pow_left_dvd_pow_gcd</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=pow_dvd_of_mul_eq_pow#doc\">docs#pow_dvd_of_mul_eq_pow</a></li>\n</ul>",
        "id": 529355922,
        "sender_full_name": "Chris Henson",
        "timestamp": 1752786299
    },
    {
        "content": "<p>It's probably easier for you to make a draft PR so that people can play around with the failure themselves using an olean cache</p>",
        "id": 529363385,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1752790442
    },
    {
        "content": "<p>I have opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/27240\">#27240</a>. (This is my first Mathlib PR, so hopefully I did that correctly...).</p>",
        "id": 529365559,
        "sender_full_name": "Chris Henson",
        "timestamp": 1752791962
    }
]