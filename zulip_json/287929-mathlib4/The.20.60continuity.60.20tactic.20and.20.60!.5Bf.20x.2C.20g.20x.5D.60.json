[
    {
        "content": "<p>Is it expected that <code>continuity</code> can't handle this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">attribute</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">continuity</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Continuous</span><span class=\"bp\">.</span><span class=\"n\">matrixVecCons</span>\n\n<span class=\"c1\">-- fails</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Continuous</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">θ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">sin</span><span class=\"w\"> </span><span class=\"n\">θ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">cos</span><span class=\"w\"> </span><span class=\"n\">θ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">continuity</span>\n\n<span class=\"c1\">-- succeeds</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Continuous</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">θ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">sin</span><span class=\"w\"> </span><span class=\"n\">θ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">cos</span><span class=\"w\"> </span><span class=\"n\">θ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Continuous</span><span class=\"bp\">.</span><span class=\"n\">matrixVecCons</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">continuity</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Continuous</span><span class=\"bp\">.</span><span class=\"n\">matrixVecCons</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">continuity</span>\n<span class=\"w\">  </span><span class=\"n\">continuity</span>\n</code></pre></div>",
        "id": 491617111,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1735827708
    },
    {
        "content": "<p>(<a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Continuous.matrixVecCons#doc\">docs#Continuous.matrixVecCons</a> isn't in the web editor nor the docs just yet, but is in master)</p>",
        "id": 491617154,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1735827723
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"346070\">@Tomas Skrivan</span>, is this something that <code>fun_prop</code> can hope to handle?</p>",
        "id": 491617271,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1735827768
    },
    {
        "content": "<p><del> are you maybe missing the <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Data/Fin/VecNotation.html#Matrix.vecEmpty\">Matrix.vecEmpty</a> version? </del></p>",
        "id": 491622452,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1735830013
    },
    {
        "content": "<p>Huh, I guess it <em>is</em> surprising that the second <code>· continuity</code> works, but I assume something about <code>Unique</code> is firing (edit: changed to not rely on this)</p>",
        "id": 491625098,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1735831285
    },
    {
        "content": "<p>are there any places where <code>continuity</code> is still preferred to <code>fun_prop</code> <em>at all</em>? My hope would be that we could deprecate <code>continuity</code> sometime soon.</p>",
        "id": 491626298,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1735831754
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/channel/287929-mathlib4/topic/The.20.60continuity.60.20tactic.20and.20.60!.5Bf.20x.2C.20g.20x.5D.60/near/491622452\">said</a>:</p>\n<blockquote>\n<p><del> are you maybe missing the <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Data/Fin/VecNotation.html#Matrix.vecEmpty\">Matrix.vecEmpty</a> version? </del></p>\n</blockquote>\n<p>(<code>continuous_const</code> dispatches this one)</p>",
        "id": 491627102,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1735832139
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/287929-mathlib4/topic/The.20.60continuity.60.20tactic.20and.20.60!.5Bf.20x.2C.20g.20x.5D.60/near/491617271\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"346070\">Tomas Skrivan</span>, is this something that <code>fun_prop</code> can hope to handle?</p>\n</blockquote>\n<p>It is definitely something I want to support. However, last time I wanted to prove differentiability for <code>![...]</code> I noticed that it is implemented using <code>List</code> which is not a vector space so I wasn't sure how to proceed.</p>\n<p>It might be a case that one has to write a sufficiently smart theorem to handle it. I will think about it.</p>",
        "id": 491640801,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1735838439
    },
    {
        "content": "<p>I think you're getting confused with <code>#[]</code>?</p>",
        "id": 491643177,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1735839604
    },
    {
        "content": "<p><code>![</code> makes no mention of <code>List</code></p>",
        "id": 491643194,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1735839617
    },
    {
        "content": "<p><code>![</code> unfolds to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matrix.vecCons#doc\">docs#Matrix.vecCons</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matrix.vecEmpty#doc\">docs#Matrix.vecEmpty</a></p>",
        "id": 491644171,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1735840069
    },
    {
        "content": "<p>Then marking theorems like <code>Continuous.matrixVecCons</code> with <code>fum_prop</code> should be enough.</p>",
        "id": 491644397,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1735840186
    },
    {
        "content": "<p>I will test it out, there might be an issue and <code>fun_prop</code> might expect the theorem to have the index of the output vector fixed.</p>",
        "id": 491644616,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1735840299
    },
    {
        "content": "<p>Yes, I get the feeling this is either an indexing problem, or that I have stated the wrong theorem and it expects the one saying that it is jointly continuous in all the arguments</p>",
        "id": 491647155,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1735841625
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"346070\">Tomas Skrivan</span> <a href=\"#narrow/channel/287929-mathlib4/topic/The.20.60continuity.60.20tactic.20and.20.60!.5Bf.20x.2C.20g.20x.5D.60/near/491644397\">said</a>:</p>\n<blockquote>\n<p>Then marking theorems like <code>Continuous.matrixVecCons</code> with <code>fum_prop</code> should be enough.</p>\n</blockquote>\n<p><del>The web editor is now up to date; unfortunately this doesn't work there</del></p>",
        "id": 491647248,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1735841664
    },
    {
        "content": "<p>Nevermind, it does work after all!</p>",
        "id": 491647288,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1735841694
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"346070\">Tomas Skrivan</span> <a href=\"#narrow/channel/287929-mathlib4/topic/The.20.60continuity.60.20tactic.20and.20.60!.5Bf.20x.2C.20g.20x.5D.60/near/491640801\">said</a>:</p>\n<blockquote>\n<p>However, last time I wanted to prove differentiability for <code>![...]</code> ...</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/20407\">#20407</a> should help a lot here, <del>though this only does the FDeriv half and there are some TODOs</del></p>",
        "id": 491656174,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1735846304
    }
]