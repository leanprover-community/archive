[
    {
        "content": "<p>Often, I find that <code>exact?</code> is able to close the goal, but by applying a lemma which is obviously not the right one (e.g., taking advantages of weird defeqs, or using one direction of an <code>iff</code> lemma while the direction exists as a standalone lemma, or suggesting <code>rfl</code> when there is a lemma saying exactly what I need, that I could use in a sequence of rewrites for instance). MWE:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo_def</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo_def2</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">exact?</span>\n</code></pre></div>\n<p>The <code>exact?</code> suggests <code>rfl</code>, while a suggestion to use <code>foo_def</code> would clearly be better.</p>\n<p>Would it be easy to have a variant <code>exact!?</code> or <code>exact??</code> that gives all the working results, instead of only the first one, to let the user pick whichever is best?</p>",
        "id": 473309858,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1727511511
    },
    {
        "content": "<p>Yes, this should be easy, and I would merge a PR that does this. I would suggest <code>exact?*</code> as the syntax perhaps? Not sure there.</p>",
        "id": 473316728,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1727514241
    },
    {
        "content": "<p>I like <code>exact?!</code> as \"a stronger version of <code>exact?</code>\"</p>",
        "id": 473331635,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1727522057
    },
    {
        "content": "<p>Not a general solution, but often <code>rw?</code> finds something better</p>",
        "id": 473335373,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1727523208
    },
    {
        "content": "<p>This wouldn’t really be stronger, I think <code>exact?*</code> is better.</p>",
        "id": 473348155,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1727530547
    },
    {
        "content": "<p>Exactly --- I don't like the <code>!</code> because we're not asking it to try any harder, just to not stop at the first successful result. I suspect it really is a small change to implement, and you wouldn't need to go into the internals at all.</p>",
        "id": 473389584,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1727561702
    },
    {
        "content": "<p>Would a <code>with_reducible exact?</code> be possible, for this specific case?</p>",
        "id": 473389617,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1727561746
    },
    {
        "content": "<p>How about <code>exact??</code> ?</p>",
        "id": 473389619,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1727561748
    },
    {
        "content": "<p>Oh, sorry, Sébastien already suggested that :-)</p>",
        "id": 473389642,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1727561762
    },
    {
        "content": "<p>How about <code>exact‽</code> ?</p>",
        "id": 473392252,
        "sender_full_name": "Vincent Beffara",
        "timestamp": 1727564624
    },
    {
        "content": "<p>I will happily merge a PR implementing either <code>exact?*</code> or <code>exact??</code> (hint hint :-)</p>",
        "id": 473395179,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1727568018
    },
    {
        "content": "<p>Has anyone made this? Otherwise I can give this  a go</p>",
        "id": 525988221,
        "sender_full_name": "Calle Sönne",
        "timestamp": 1750976979
    },
    {
        "content": "<p>Okay I have a working prototype of this. Should this be PRd to mathlib, batteries or lean core?</p>\n<p>A related question is: can I reuse private definitions in other files? I needed to adjust some functions in<br>\n<code>Lean/Meta/Tactic/LibrarySearch.lean</code>. However these rely on private definitions in that file, so if I want to PR this to mathlib do I have to manually copy over all the private definitions that I need to use? Or can I somehow reuse them?</p>",
        "id": 526025340,
        "sender_full_name": "Calle Sönne",
        "timestamp": 1751008634
    },
    {
        "content": "<p>Demo it at LLL today!</p>",
        "id": 526025547,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751008738
    },
    {
        "content": "<p>I could! Although this was quite simple to make as <code>exact?</code> pretty much had all the functionality already, I just had to choose to store it :)</p>",
        "id": 526025926,
        "sender_full_name": "Calle Sönne",
        "timestamp": 1751008946
    }
]