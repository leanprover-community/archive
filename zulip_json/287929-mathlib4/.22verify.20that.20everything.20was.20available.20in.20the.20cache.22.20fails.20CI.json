[
    {
        "content": "<p>Has anyone else noticed that the \"verify that everything was available in the cache\" seems to repeatedly fail in CI across several PRs? Here's an example: <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/16645293850/job/47106735985\">https://github.com/leanprover-community/mathlib4/actions/runs/16645293850/job/47106735985</a></p>",
        "id": 532239460,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1754031650
    },
    {
        "content": "<p><a class=\"message-link\" href=\"/#narrow/channel/287929-mathlib4/topic/Failing.20CI/near/531890225\">#mathlib4 &gt; Failing CI @ ðŸ’¬</a></p>",
        "id": 532243199,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754033024
    },
    {
        "content": "<p>Ah thanks! I previously thought that was unrelated</p>",
        "id": 532245134,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1754033684
    },
    {
        "content": "<p>(Borrowing this old thread just for the title)</p>\n<p>Just a heads up that cache verification after a successful build seems to be an (intermittent) issue again; I cannot investigate much more today, but here are some examples:</p>\n<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19014954726/job/54301744273#step:6:7277\">error in post-build step</a>, <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19014954726/job/54301453032#step:24:59\">upload step</a></li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/18936917752/job/54067479624#step:6:6005\">error in post-build step</a>, <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/18936917752/job/54065962219#step:24:412\">upload step</a></li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/18820091374/job/53694483814#step:6:7173\">error in post-build step</a>, <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/18820091374/job/53694228736#step:24:25\">upload step</a></li>\n</ul>\n<p>One thing I noticed: the cache upload steps don't seem to contain actual uploads to Azure, cf. the messages from curl in <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19014709344/job/54300852287#step:24:438\">a successful run</a>.</p>\n<p>I'd be grateful if anyone could take a look or offer ideas!</p>",
        "id": 553260110,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1762104239
    },
    {
        "content": "<p>5 messages were moved from this topic to <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/need.20to.20run.20lake.20exe.20cache.20twice.20to.20get.20cache/with/553502041\">#mathlib4 &gt; need to run lake exe cache twice to get cache</a> by <span class=\"user-mention silent\" data-user-id=\"123965\">Bryan Gin-ge Chen</span>.</p>",
        "id": 553502042,
        "sender_full_name": "Notification Bot",
        "timestamp": 1762214655
    },
    {
        "content": "<p>The <code>staging</code> build for <a href=\"https://github.com/leanprover-community/mathlib4/pull/30138\">#30138</a> just failed due to this as well: <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19051706538/job/54415498291#step:6:17\">error in post-build step</a>, <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19051706538/job/54413218969#step:24:2705\">upload step</a>.</p>",
        "id": 553502204,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1762214767
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/27308\">#27308</a> is also failing in CI at the \"verify that everything was available in the cache\" step. It seems that relevant things are discussed here, so does anyone know how I should fix this now?</p>",
        "id": 553580784,
        "sender_full_name": "Wang Jingting",
        "timestamp": 1762253471
    },
    {
        "content": "<p>Can you merge master? If that does not fix the bug, come back here :-)</p>",
        "id": 553581503,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1762253689
    },
    {
        "content": "<p>Merging master solved that, thanks!</p>",
        "id": 553587462,
        "sender_full_name": "Wang Jingting",
        "timestamp": 1762255386
    },
    {
        "content": "<p>3 messages were moved here from <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/Failing.20CI/with/535034067\">#mathlib4 &gt; Failing CI</a> by <span class=\"user-mention silent\" data-user-id=\"123965\">Bryan Gin-ge Chen</span>.</p>",
        "id": 553615569,
        "sender_full_name": "Notification Bot",
        "timestamp": 1762263544
    },
    {
        "content": "<p>I think there's still some underlying issue that we haven't figured out here; I've moved the posts to this thread where I've been tracking the reoccurrences of this.</p>",
        "id": 553615876,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1762263613
    },
    {
        "content": "<p>Just a cross-link to another recent example: <a class=\"message-link\" href=\"/#narrow/channel/287929-mathlib4/topic/CI.3A.20uploading.20cache/near/553687199\">#mathlib4 &gt; CI: uploading cache @ ðŸ’¬</a></p>",
        "id": 553693235,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1762283143
    },
    {
        "content": "<p>Yet another example from <a href=\"https://github.com/leanprover-community/mathlib4/pull/31716\">#31716</a>: <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19448683220/job/55652636076\">https://github.com/leanprover-community/mathlib4/actions/runs/19448683220/job/55652636076</a></p>",
        "id": 556971383,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1763436697
    },
    {
        "content": "<p>An example from today that caused a <code>staging</code> batch to fail <a class=\"message-link\" href=\"/#narrow/channel/116290-rss/topic/mathlib.20bors.20notifications/near/561183164\">#rss &gt; mathlib bors notifications @ ðŸ’¬</a> : <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19825049194/job/56802191297\">https://github.com/leanprover-community/mathlib4/actions/runs/19825049194/job/56802191297</a></p>",
        "id": 561185915,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1764601378
    },
    {
        "content": "<p>Another <code>staging</code> failure: <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19828882529/job/56815568392\">https://github.com/leanprover-community/mathlib4/actions/runs/19828882529/job/56815568392</a></p>",
        "id": 561224937,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1764609217
    },
    {
        "content": "<p>Yet another: <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19830752220/job/56815905221\">https://github.com/leanprover-community/mathlib4/actions/runs/19830752220/job/56815905221</a></p>",
        "id": 561238215,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1764611910
    },
    {
        "content": "<p>I noticed this because it's holding up getting <a href=\"https://github.com/leanprover-community/mathlib4/pull/32277\">#32277</a> landed and I want to start working on bumping FLT (the PR had limited effect on mathlib but it will break a bunch of stuff in FLT). Bors has now failed twice on the PR but it's hard for me to imagine that the PR is the problem. If it's any help, the \"verify that everything was available in the cache\" output is long and the parts that look weird in the last-but-one failure posted above are:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>...\nâœ” [91/117] Replayed Batteries.Data.List.Lemmas\n  â„¹ [92/117] Replayed Batteries.Data.Array.Match\n  trace: .&gt; LEAN_PATH=/home/runner/work/mathlib4/mathlib4/.lake/packages/Cli/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/Qq/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/aesop/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/proofwidgets/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/importGraph/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/LeanSearchClient/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/plausible/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/build/lib/lean /home/runner/.elan/toolchains/leanprover--lean4---v4.26.0-rc2/bin/lean /home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/Batteries/Data/Array/Match.lean -o /home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/Array/Match.olean -i /home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/Array/Match.ilean -c /home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/.lake/build/ir/Batteries/Data/Array/Match.c --setup /home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/.lake/build/ir/Batteries/Data/Array/Match.setup.json --json\n  âœ” [93/117] Replayed Batteries.Data.List.Matcher\n  âœ” [94/117] Replayed Batteries.Lean.EStateM\n...\nâœ” [115/303] Replayed Batteries.Logic\n  âœ– [116/303] Building Mathlib.Algebra.Group.Defs\n  error: target is out-of-date and needs to be rebuilt\n  âœ” [117/303] Replayed Batteries.Util.ExtendedBinder\n ...\nâœ” [173/303] Replayed Aesop.Util.UnorderedArraySet\n  â„¹ [174/303] Replayed Batteries.Data.String.Basic\n  trace: .&gt; LEAN_PATH=/home/runner/work/mathlib4/mathlib4/.lake/packages/Cli/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/Qq/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/aesop/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/proofwidgets/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/importGraph/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/LeanSearchClient/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/plausible/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/build/lib/lean /home/runner/.elan/toolchains/leanprover--lean4---v4.26.0-rc2/bin/lean /home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/Batteries/Data/String/Basic.lean -o /home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/String/Basic.olean -i /home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/String/Basic.ilean -c /home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/.lake/build/ir/Batteries/Data/String/Basic.c --setup /home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/.lake/build/ir/Batteries/Data/String/Basic.setup.json --json\n  âœ” [175/303] Replayed Aesop.Util.Basic\n  âœ” [176/303] Replayed Aesop.Forward.Substitution\n...\nâœ” [498/546] Ran widgetPackageJson\n  â„¹ [499/546] Replayed proofwidgets/widgetPackageLock\n  trace: ././widget&gt; npm install\n  trace: stdout:\n  added 1 package, changed 2 packages, and audited 367 packages in 2s\n\n  67 packages are looking for funding\n    run `npm fund` for details\n\n  [lots and lots of output suppressed]\n\ndist/animatedHtml.js â†’ ../.lake/build/js...\n  created ../.lake/build/js in 128ms\n  âœ” [501/546] Replayed ProofWidgets.Compat\n  âœ” [502/546] Replayed ProofWidgets.Component.Basic\n...\nâœ” [7422/7685] Replayed Mathlib.Tactic.Linter.FindDeprecations\n  â„¹ [7423/7685] Replayed Batteries.Data.String.Matcher\n  trace: .&gt; LEAN_PATH=/home/runner/work/mathlib4/mathlib4/.lake/packages/Cli/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/Qq/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/aesop/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/proofwidgets/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/importGraph/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/LeanSearchClient/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/packages/plausible/.lake/build/lib/lean:/home/runner/work/mathlib4/mathlib4/.lake/build/lib/lean /home/runner/.elan/toolchains/leanprover--lean4---v4.26.0-rc2/bin/lean /home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/Batteries/Data/String/Matcher.lean -o /home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/String/Matcher.olean -i /home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/String/Matcher.ilean -c /home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/.lake/build/ir/Batteries/Data/String/Matcher.c --setup /home/runner/work/mathlib4/mathlib4/.lake/packages/batteries/.lake/build/ir/Batteries/Data/String/Matcher.setup.json --json\n  âœ” [7424/7685] Replayed Mathlib.Tactic.Linter.TextBased\n  âœ” [7425/7685] Replayed Mathlib.Tactic.Linter.ValidatePRTitle\n...\n  âœ” [7694/7694] Ran mathlib/Mathlib:default\n  Some required targets logged failures:\n  - Mathlib.Algebra.Group.Defs\n  Error: Process completed with exit code 3.\n</code></pre></div>\n<p>Perhaps specific attention needs to be given to</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">âœ”</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">115</span><span class=\"bp\">/</span><span class=\"mi\">303</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Replayed</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Logic</span>\n<span class=\"w\">  </span><span class=\"bp\">âœ–</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">116</span><span class=\"bp\">/</span><span class=\"mi\">303</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Building</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">Defs</span>\n<span class=\"w\">  </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"bp\">-</span><span class=\"n\">of</span><span class=\"bp\">-</span><span class=\"n\">date</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">needs</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">rebuilt</span>\n<span class=\"w\">  </span><span class=\"bp\">âœ”</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">117</span><span class=\"bp\">/</span><span class=\"mi\">303</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Replayed</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Util</span><span class=\"bp\">.</span><span class=\"n\">ExtendedBinder</span>\n</code></pre></div>",
        "id": 561238333,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1764611931
    },
    {
        "content": "<p>Is there any way to purge the cache and force a clean build, as one would do locally with <code>lake exe cache clean</code>?</p>",
        "id": 561247126,
        "sender_full_name": "David Loeffler",
        "timestamp": 1764614019
    },
    {
        "content": "<p>Not at the moment as far as I know. I too would like to know what's causing this and more importantly, how we can mitigate this...</p>",
        "id": 561250090,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1764615004
    },
    {
        "content": "<p>The current bors staging run seems to have successfully passed the danger point of \"verify that everything was available in the cache\". Let's hope the problem doesn't reappear.</p>",
        "id": 561250750,
        "sender_full_name": "David Loeffler",
        "timestamp": 1764615214
    },
    {
        "content": "<p>Seems to be working fine again now. I don't know if Bryan (or someone else) did something specific to get it unstuck â€“Â if so then many thanks! â€“Â or if it just solved itself somehow. Now we just have to wait for the backlog to clear.</p>",
        "id": 561270728,
        "sender_full_name": "David Loeffler",
        "timestamp": 1764622050
    },
    {
        "content": "<p>See you guys again on Jan 1st (failures often occur on 1st of the month)</p>",
        "id": 561271057,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1764622201
    },
    {
        "content": "<p>I didn't do anything!</p>",
        "id": 561271410,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1764622356
    },
    {
        "content": "<blockquote>\n<p>See you guys again on Jan 1st (failures often occur on 1st of the month)</p>\n</blockquote>\n<p><a href=\"https://thedailywtf.com/articles/a-date-next-month\">https://thedailywtf.com/articles/a-date-next-month</a></p>",
        "id": 561276794,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1764624057
    },
    {
        "content": "<p>Here's a <code>staging</code> failure due to this today: <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19935188966/job/57164551335\">https://github.com/leanprover-community/mathlib4/actions/runs/19935188966/job/57164551335</a></p>",
        "id": 561953350,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1764874281
    },
    {
        "content": "<p>I've seen this failure trying to merge <a href=\"https://github.com/leanprover-community/mathlib4/pull/31452\">#31452</a>.</p>",
        "id": 562194998,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1764975439
    },
    {
        "content": "<p>There was another <code>staging</code> failure with the same cause earlier too: <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19976411490/job/57297659509\">https://github.com/leanprover-community/mathlib4/actions/runs/19976411490/job/57297659509</a></p>",
        "id": 562197946,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1764977794
    },
    {
        "content": "<p>Another example: <a class=\"message-link\" href=\"/#narrow/channel/116290-rss/topic/mathlib.20bors.20notifications/near/564471541\">#rss &gt; mathlib bors notifications @ ðŸ’¬</a> <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/20338985258/job/58436170361\">https://github.com/leanprover-community/mathlib4/actions/runs/20338985258/job/58436170361</a></p>",
        "id": 564511677,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1766076834
    },
    {
        "content": "<p><a class=\"message-link\" href=\"/#narrow/channel/116290-rss/topic/mathlib.20bors.20notifications/near/565001882\">#rss &gt; mathlib bors notifications @ ðŸ’¬</a> : <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/20432091702/job/58707693865\">https://github.com/leanprover-community/mathlib4/actions/runs/20432091702/job/58707693865</a></p>",
        "id": 565003569,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1766410131
    },
    {
        "content": "<p><a href=\"#narrow/channel/116290-rss/topic/mathlib.20bors.20notifications/near/565107142\">https://leanprover.zulipchat.com/#narrow/channel/116290-rss/topic/mathlib.20bors.20notifications/near/565107142</a></p>",
        "id": 565109236,
        "sender_full_name": "Moritz Doll",
        "timestamp": 1766474744
    },
    {
        "content": "<p>Is this related?<br>\n<a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/20454373467/job/58774211365\">https://github.com/leanprover-community/mathlib4/actions/runs/20454373467/job/58774211365</a><br>\nIt's a spurious failure (<code>error: external command 'git' exited with code 128 </code>) but it's in the cache step</p>",
        "id": 565111835,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1766476239
    },
    {
        "content": "<p>Oh Mathlib's master is also failing<br>\n<a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/20450592711/job/58762585560\">https://github.com/leanprover-community/mathlib4/actions/runs/20450592711/job/58762585560</a></p>",
        "id": 565112059,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1766476351
    },
    {
        "content": "<p>Hmm, seems like bors twice <a href=\"https://github.com/leanprover-community/mathlib4/pull/31133#issuecomment-3733559731\">failed to find</a> the new file (Mathlib.Lean.Linter) introduced in <a href=\"https://github.com/leanprover-community/mathlib4/pull/31133\">#31133</a> in the cache. Is this a hint of something being not quite right?</p>",
        "id": 567349926,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1768082176
    },
    {
        "content": "<p>I merged master and it failed a third time <span aria-label=\"cold sweat\" class=\"emoji emoji-1f630\" role=\"img\" title=\"cold sweat\">:cold_sweat:</span> Have I done something wrong, or...?</p>",
        "id": 567351176,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1768084001
    },
    {
        "content": "<p>I don't know what causes this but it seems to be some kind of sporadic issue with uploading oleans -- you might have to merge <code>master</code> again after more commits hit and see if it works then...</p>",
        "id": 567351391,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1768084302
    }
]