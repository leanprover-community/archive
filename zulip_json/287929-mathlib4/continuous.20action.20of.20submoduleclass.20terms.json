[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalRing</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subring</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span>\n\n<span class=\"c1\">-- all these exist</span>\n<span class=\"bp\">#</span><span class=\"n\">synth</span><span class=\"w\"> </span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span>\n<span class=\"bp\">#</span><span class=\"n\">synth</span><span class=\"w\"> </span><span class=\"n\">TopologicalRing</span><span class=\"w\"> </span><span class=\"n\">R</span>\n<span class=\"bp\">#</span><span class=\"n\">synth</span><span class=\"w\"> </span><span class=\"n\">SMul</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span>\n\n<span class=\"c1\">-- but this fails</span>\n<span class=\"c1\">--#synth ContinuousSMul R A</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">Subring</span><span class=\"bp\">.</span><span class=\"n\">instContinuousSMul</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContinuousSMul</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">IsInducing</span><span class=\"bp\">.</span><span class=\"n\">continuousSMul</span><span class=\"w\"> </span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">IsInducing</span><span class=\"bp\">.</span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"n\">continuous_subtype_val</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>I would like this instance and obviously it's harmless because it's a prop (and because <code>R : Subring A</code> I don't think it will cause the kind of problems which subtypes acting on objects sometimes cause right now). But if we have this then probably we should have the submonoid version. But should we have the <code>Submonoidclass</code> version? I'm a bit scared about this because this fails:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Monoid</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">SetLike</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SubmonoidClass</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span>\n\n<span class=\"bp\">#</span><span class=\"n\">synth</span><span class=\"w\"> </span><span class=\"n\">Mul</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"c1\">-- yes</span>\n<span class=\"c1\">-- #synth SMul R A -- no</span>\n</code></pre></div>\n<p>so if we go down this route I'd have to make that instance and I'm slightly worried that it will cause diamonds (aka I don't really know what I'm doing). However I tested it for submonoids, subrings and subalgebras and in all cases we have</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>Is it safe to make the <code>SMul</code> instance on <code>SubmonoidClass</code>?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Monoid</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">SetLike</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SubmonoidClass</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SMul</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">smul</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">a</span>\n</code></pre></div>",
        "id": 495393541,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737589384
    },
    {
        "content": "<p>This looks safe to me from a diamond perspective</p>",
        "id": 495398301,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737592111
    },
    {
        "content": "<p>I guess from a performance perspective you'll have to just try and see</p>",
        "id": 495398324,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737592128
    },
    {
        "content": "<p>Actually, I'd expect something more general like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SMul</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">SetLike</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SMul</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">smul</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">a</span>\n</code></pre></div>",
        "id": 495398614,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737592303
    },
    {
        "content": "<p>Promoting to <code>SubmonoidClass</code> for MulAction etc</p>",
        "id": 495398755,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737592389
    },
    {
        "content": "<p>That one does scare me though because now the moment you're looking for an action of a subtype on <em>anything</em> you open the door to a wild goose chase which my variant won't let you open.</p>",
        "id": 495439708,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737617555
    },
    {
        "content": "<p>cf lean taking a long time to fail trying to find SMul Complex Real because of instances like the above</p>",
        "id": 495440010,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737617700
    },
    {
        "content": "<p>I think the instance above already exists specialized to <code>Subring</code> and <code>Subalgebra</code></p>",
        "id": 495464812,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737626724
    },
    {
        "content": "<p>OK so this is added in <a href=\"https://github.com/leanprover-community/mathlib4/pull/20983\">#20983</a> and now in theory it's possible to do some tidying up. For example the instance <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Subgroup.continuousSMul#doc\">docs#Subgroup.continuousSMul</a> is now not needed and probably I can remove several more instances. Should I remove them? (I removed this one but not the others, I guess it should probably be an all or nothing move here?) Sounds like it might be a use case for TryAtEachStep if we actually want to find them, although maybe shortcut instances are helpful and fine?</p>",
        "id": 495477604,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737630492
    },
    {
        "content": "<p>I'm not sure what our policy is here, in principle we could delete <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Subring.toRing#doc\">docs#Subring.toRing</a> but we haven't done so</p>",
        "id": 495480298,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737631582
    },
    {
        "content": "<p>See the benchmarking for <a href=\"https://github.com/leanprover-community/mathlib4/pull/11304\">#11304</a> to see what happens when you start deleting instances. Maybe they're good shortcuts? I hadn't realised that this PR was going to take me several hours, but we may as well try and get it right.</p>",
        "id": 495511011,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737642277
    },
    {
        "content": "<p>My guess: this is going to be painful performance-wise. But maybe not! <a href=\"https://github.com/leanprover-community/mathlib4/pull/11304\">#11304</a> has to be transient issue. The instructions don't match the wall clock.</p>",
        "id": 495511586,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1737642435
    },
    {
        "content": "<p>My guess is that if I start deleting instances willy-nilly then it is going to be painful performance-wise. But if I just add the new instances I need (which generalize existing instances and which we don't have) and check I've not created any diamonds then I think I'm going to be OK.</p>",
        "id": 495516190,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737643608
    },
    {
        "content": "<p>Hopefully easy question: how do I get a submonoid from a submonoidclass?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Monoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SetLike</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SubmonoidClass</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Submonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"c1\">-- not like this, it seems</span>\n</code></pre></div>",
        "id": 495518964,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737644337
    },
    {
        "content": "<p>looks like we're missing a <code>toSubMonoid</code> coersion...</p>",
        "id": 495519307,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737644420
    },
    {
        "content": "<p>or actually, those seem to be missing for most of the \"sub_\" classes?</p>",
        "id": 495519592,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737644491
    },
    {
        "content": "<p>you <em>could</em> use something like <code>SubmonoidClass.subtype s |&gt;.range</code>, maybe?</p>",
        "id": 495519882,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737644574
    },
    {
        "content": "<p><code>MonoidHom.mrange (SubmonoidClass.subtype s)</code> seems to work</p>",
        "id": 495520971,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737644844
    },
    {
        "content": "<p>but it's not pretty at all</p>",
        "id": 495520994,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737644850
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> unlike for bundled function classes, there are no \"concretisation\" maps for bundled subject classes<br>\nInstead, the particular instance map is used (eg Subfield.toSubring)<br>\nThere is no particular reason that this is the case, but it's the design across the library<br>\nPinging <span class=\"user-mention\" data-user-id=\"238446\">@Anne Baanen</span> because I asked them about this before</p>",
        "id": 495607674,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1737677236
    },
    {
        "content": "<p>But I don't have a subfield in my case, I really have a submonoidclass! I don't need the submonoid, I was just trying to golf something.</p>",
        "id": 495611739,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737679915
    },
    {
        "content": "<p>What's the application where you actually end up working in the generality of SubmonoidClass?</p>",
        "id": 495611889,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737680006
    },
    {
        "content": "<p>This is not anything worth worrying about, I just was surprised. The use case was the following: the file Mathlib/Algebra/Group/Submonoid/DistribMulAction.lean currently has</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">distribMulAction</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddMonoid</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DistribMulAction</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Submonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">DistribMulAction</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">DistribMulAction</span><span class=\"bp\">.</span><span class=\"n\">compHom</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">subtype</span>\n</code></pre></div>\n<p>i.e. a one-line proof, and in the PR proposing the change from <code>Submonoid</code> to <code>SubmonoidClass</code> I change it to</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SetLike</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SubmonoidClass</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddMonoid</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DistribMulAction</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">DistribMulAction</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">smul_zero</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">smul_zero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">smul_add</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">smul_add</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>which is a two-line proof. I was wondering if I could reuse the one line proof but for that I need access to <code>Submonoid.subtype</code>.</p>",
        "id": 495668596,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737710752
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/287929-mathlib4/topic/continuous.20action.20of.20submoduleclass.20terms/near/495611739\">said</a>:</p>\n<blockquote>\n<p>But I don't have a subfield in my case, I really have a submonoidclass! I don't need the submonoid, I was just trying to golf something.</p>\n</blockquote>\n<p>Yeah I understand, I guess I'm saying that in practice nothing nontrivial in Mathlib is ever stated via <code>SubmonoidClass</code> (due to the map you want not existing). I don't have anything against changing this, but it's what I've found after trying to do things your way in the past.</p>",
        "id": 495735064,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1737731193
    }
]