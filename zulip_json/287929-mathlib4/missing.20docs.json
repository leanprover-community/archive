[
    {
        "content": "<p>I have a vague idea that doc-string for declarations can now <em>only</em> be added in the module where the declaration is defined.</p>",
        "id": 479224436,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730105855
    },
    {
        "content": "<p>If that is so, a syntax linter could warn about missing docs reliably: would that be desirable?</p>",
        "id": 479224446,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730105858
    },
    {
        "content": "<p>I would find that valuable, but perhaps I'm biased :-)</p>",
        "id": 479224580,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1730105894
    },
    {
        "content": "<p>It is still good to hear the opinion of one of the house linters... <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 479224732,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730105944
    },
    {
        "content": "<p>It think it's important not to make it too annoying -- lots of people like to write their module docs as a final step.</p>",
        "id": 479224806,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730105970
    },
    {
        "content": "<p>Right and, if you have to trigger it manually, you might as well use <code>#lint</code>.  So, not a clear win for the syntax linter...</p>",
        "id": 479225005,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730106023
    },
    {
        "content": "<p>There might still be value in getting a CI warning early, rather than having to wait for everything until the lint step to find out that you missed a doc-string.</p>",
        "id": 479225273,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730106117
    },
    {
        "content": "<p>So maybe just adding it to CI as an earlier step, since CI is going to fail anyway if you do not have docs, but at least you know earlier.</p>",
        "id": 479225397,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730106155
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> <a href=\"#narrow/channel/287929-mathlib4/topic/missing.20docs/near/479225273\">said</a>:</p>\n<blockquote>\n<p>There might still be value in getting a CI warning early, rather than having to wait for everything until the lint step to find out that you missed a doc-string.</p>\n</blockquote>\n<p>I'm not so sure, I think being encouraged to write the docstring sometime after getting everything building is a feature</p>",
        "id": 479239918,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1730110705
    },
    {
        "content": "<p>In that you end up coming back in a separate session, perhaps with a clearer big picture</p>",
        "id": 479239977,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1730110729
    },
    {
        "content": "<p>Ok, I was just in the situation where I had written the docs to a structure, explaining also what the fields meant and I got a lint error for not writing the docs of each field separately.  I realize that this is a fairly special case!  <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 479240906,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730110931
    },
    {
        "content": "<p>I have had several occasions where I thought my PR was all set, to have CI fail linting with a missing docs warning on some side definition. I found that disruptive and not particularly helpful. Returning to a PR with a fresh set of eyes is useful - but do we need to <em>impose</em> it in this way?</p>",
        "id": 479268056,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1730119856
    },
    {
        "content": "<p>Yes, I agree there's tension here!</p>",
        "id": 479276729,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730122384
    },
    {
        "content": "<p>My comment above was primarily about module docstrings, where the fresh set of eyes is probably more valuable than on individual definitions</p>",
        "id": 479277249,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1730122536
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> <a href=\"#narrow/channel/287929-mathlib4/topic/missing.20docs/near/479224446\">said</a>:</p>\n<blockquote>\n<p>If that is so, a syntax linter could warn about missing docs reliably: would that be desirable?</p>\n</blockquote>\n<p>Doesn't this already exist as <code>linter.missingDocs</code>, and Batteries uses it?</p>",
        "id": 479277398,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1730122568
    },
    {
        "content": "<p>Oh, for module-docs, that linter is already in mathlib...</p>",
        "id": 479277417,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730122572
    },
    {
        "content": "<p>About <code>#lint</code>: I was exactly wondering if adding something that would be automatically on, rather than calling it explicitly was useful.  I know of <code>#lint</code> and I only sometimes remember about it before sending a PR to CI.</p>",
        "id": 479277770,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730122678
    },
    {
        "content": "<p>It is a rather niche use, I am not too invested in it and am happy to leave things the way they are now.</p>",
        "id": 479277974,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730122728
    },
    {
        "content": "<p>Besides, I think that linters should have as close to unanimous support as possible, since they can be very intrusive: they should only flag issues that everyone feels strongly in favour of!</p>",
        "id": 479278443,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730122863
    },
    {
        "content": "<p>So this thread is really asking \"Should we add <code>(`linter.missingDocs, true)</code> to the mathlib lakefile?\"?</p>",
        "id": 479283225,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1730124069
    },
    {
        "content": "<p>Yes, it looks like it!  <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span>   I also think that the discussion answered that question.</p>",
        "id": 479284416,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730124389
    },
    {
        "content": "<p>One downside in such a strategy is that I think <code>linter.missingDocs</code> does not permit nolints</p>",
        "id": 479291646,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1730126486
    },
    {
        "content": "<p>So I doubt you can just turn it on and have the build succeed</p>",
        "id": 479291683,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1730126498
    }
]