[
    {
        "content": "<p>I've formalised the existence theorem for local flows of vector fields by refactoring <code>Analysis/ODE/PicardLindelof</code> (<a href=\"https://github.com/leanprover-community/mathlib4/pull/20704\">#20704</a>). I have also formalised the lemma that the solution is Lipschitz continuous in the initial condition (<a href=\"https://github.com/leanprover-community/mathlib4/pull/20733\">#20733</a>), and the lemma that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>C</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">C^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span> vector fields have <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>C</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">C^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span> solutions, but I would like to hear some feedback on the refactor first, before submitting more PRs. I'm pinging <span class=\"user-mention\" data-user-id=\"214703\">@Yury G. Kudryashov</span> who authored the original file and <span class=\"user-mention\" data-user-id=\"634338\">@Michael Rothgang</span> who expressed interest in reviewing it.</p>\n<p>Things I learnt (which are probably obvious to others):</p>\n<ol>\n<li>The best way to understand all the design choices of a formalisation is to do it from scratch yourself. I rewrote my own formalisation multiple times over several days, with moments of \"aha, that's why Yury wrote it that way\", until I felt comfortable going beyond the choices Yury had made.</li>\n<li>It is incredible how big a gap in rigour there is between a maths textbook and the formalisation. The process of formalisation forced me to stare at the same obvious proof for days, which exposed many errors in the textbook.</li>\n<li>The tooling can still be improved. For example, Lean makes manipulating integrals (on the real line) much more tedious by asking for integrability all the time, when normally you already know the function is integrable by virtue of having written an integral of it earlier. There is also a lack of tactics for intervals (<code>t ∈ Ioo (t - ε) (t + ε)</code>, etc.) and min/max (<code>|b - d| ≤ max (c - d) (d - a)</code> whenever <code>a ≤ b ≤ c</code>), even though they're often just glorified inequalities needing some case analysis. I'm hoping something can be built for this.</li>\n<li>Good type-theoretic design is very important. Because I did not have the foresight, I had to rewrite the definition of a structure many times to suit use cases as they come up, either for mathematical generality or type theory limitations (avoid propositional equality of types!).</li>\n</ol>",
        "id": 493343088,
        "sender_full_name": "Winston Yin (尹維晨)",
        "timestamp": 1736772637
    },
    {
        "content": "<p>Sounds very good. Unfortunately, I won't be able to review it until next week (I'm traveling, and I forgot my personal laptop).</p>",
        "id": 493370845,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1736779870
    },
    {
        "content": "<p>It sounds like the whole story of ODEs in Mathlib could make a nice formalization paper. I think you should consider <a href=\"https://icetcs.github.io/frocos-itp-tableaux25/itp/\">https://icetcs.github.io/frocos-itp-tableaux25/itp/</a></p>",
        "id": 493458320,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1736805616
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/21286\">#21286</a> shows that solutions to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>C</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">C^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span> ODEs are themselves <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>C</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">C^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span> in time, and <a href=\"https://github.com/leanprover-community/mathlib4/pull/21777\">#21777</a> (WIP but sorry-free) shows the existence of local flows on manifolds.</p>\n<p>Couple directions to go from here. We now have all the ingredients to show that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>C</mi><mn>1</mn></msup></mrow><annotation encoding=\"application/x-tex\">C^1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span> vector fields on compact manifolds define global flows on the manifold. I would also like to formalise the theorem that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>C</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">C^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span> vector fields have <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>C</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">C^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span> dependence on the initial condition, following Lang's <em>Fundamentals of Differential Geometry</em> (pp. 81-88), but this is currently waiting for a corollary of the implicit function theorem. This proof is the longer of two proofs given in the book, but it can be generalised to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>H</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">H^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span> spaces.</p>\n<p>On the Lie group side, a little over a year ago, I wanted to formalise that left-invariant vector fields on Lie groups define global integral curves, but at the time, mathlib was missing:</p>\n<ul>\n<li>Lie groups are manifolds without boundary</li>\n<li>Lie groups are Hausdorff (<code>T2Space</code>)</li>\n<li>Left-invariant vector fields are smooth<br>\nwhich have possibly been added to mathlib since then(?)</li>\n</ul>",
        "id": 499156661,
        "sender_full_name": "Winston Yin (尹維晨)",
        "timestamp": 1739341115
    },
    {
        "content": "<p>The fact that left-invariant vector fields are smooth is proved in <a href=\"https://github.com/leanprover-community/mathlib4/pull/18396\">#18396</a> (constructing the Lie algebra of a Lie group in full generality), but this is not merged yet. For the fact that Lie groups are manifolds without boundary, I think we need invariance of domain, so don't hold your breath (but you could just assume it as a typeclass assumption, with a todo saying to remove it).</p>",
        "id": 499166510,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1739346183
    },
    {
        "content": "<p>I forgot to answer your question about the fact that Lie groups are T2. This is essentially already in mathlib (albeit not an instance, as Lean would have no way to guess the model space): it follows from the fact that charted spaces are T1 (<a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ChartedSpace.t1Space#doc\">docs#ChartedSpace.t1Space</a>) and that a T1 topological group is T2 (found by <code>infer_instance</code>, the key point is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=TopologicalGroup.regularSpace#doc\">docs#TopologicalGroup.regularSpace</a>)</p>",
        "id": 499431379,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1739441523
    },
    {
        "content": "<p>Just an update on this. I've formalised in <a href=\"https://github.com/leanprover-community/mathlib4/pull/34288\">#34288</a> that the integral curves of $C^n$ ODEs on Banach spaces are $C^n$ with respect to the initial condition, using the implicit function theorem. I'd like to invite any suggestions to golf or reorganise the proof.</p>\n<p>Note that this is only part of the way towards the smoothness of the flow with respect to $(t_0,x_0)$ simultaneously.</p>",
        "id": 572049927,
        "sender_full_name": "Winston Yin (尹維晨)",
        "timestamp": 1770260421
    }
]