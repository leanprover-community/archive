[
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/actions?query=is%3Aqueued\">https://github.com/leanprover-community/mathlib4/actions?query=is%3Aqueued</a><br>\nIs our Github Action bandwidth enough?</p>",
        "id": 547542819,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761669562
    },
    {
        "content": "<p>We have 10 self-hosted runners and they're all busy at the moment. It looks like we've just hit a busy period.</p>",
        "id": 547543124,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1761669642
    },
    {
        "content": "<p>One thing I will do is dedicate one of the runners to our bors jobs so that we can keep commits flowing into <code>master</code>.</p>",
        "id": 547543817,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1761669819
    },
    {
        "content": "<p>Browsing the runs on that page, it looks like there's actually a bunch of dead jobs from August; I'll try and delete those from the list so that the count is more useful.</p>",
        "id": 547546833,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1761670613
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"123965\">@Bryan Gin-ge Chen</span> there are also duplicate runs on that page; if I understand correctly, if two commits are pushed, the first one would be skipped; but it seems like the \"skipping\" doesn't happen while the run is being queued</p>",
        "id": 547550820,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761671749
    },
    {
        "content": "<p>I think that's controlled by the <a href=\"https://docs.github.com/en/actions/how-tos/write-workflows/choose-when-workflows-run/control-workflow-concurrency\"><code>concurrency</code> setting</a> for our workflows -- I don't know off the top of my head whether what you're observing is expected or if we need to tweak this somehow.</p>",
        "id": 547552004,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1761672133
    },
    {
        "content": "<p>it looks like the first one was in fact not skipped... maybe this is suboptimal?</p>",
        "id": 547560171,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761674902
    },
    {
        "content": "<p>Report of the current situation: The CI of one of my PRs has been waiting for 1h10m ... Still pending.</p>",
        "id": 547569344,
        "sender_full_name": "Jiang Jiedong",
        "timestamp": 1761678279
    },
    {
        "content": "<p>Unfortunately all 10 of our runners are still busy (and I've changed the dedicated runner back so that it will run jobs from ordinary PRs as well). You can take a look at <a href=\"https://github.com/leanprover-community/mathlib4/actions?query=is%3Aqueued\">this link</a> (also posted by Kenny above) to see how many jobs are currently queued, and maybe get a sense of how much longer it might take.</p>",
        "id": 547571566,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1761678991
    },
    {
        "content": "<p>I've noticed that CI on a PR that is assigned to me seemed to build all of Mathlib, which I think it should not do.<br>\nIf this happens across the board, all these CI runs are taking a rather long time...</p>",
        "id": 547573400,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1761679681
    },
    {
        "content": "<p>It's possible that something has gone wrong with caching, though if that's happening I'm surprised that we're not getting straight-up errors -- if you can link to an example log where you expected a short build but got a long one, I can take a quick look.</p>",
        "id": 547574782,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1761680154
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/github.20action.20bandwidth/near/547550820\">said</a>:</p>\n<blockquote>\n<p>@Bryan Gin-ge Chen there are also duplicate runs on that page; if I understand correctly, if two commits are pushed, the first one would be skipped; but it seems like the \"skipping\" doesn't happen while the run is being queued</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"123965\">@Bryan Gin-ge Chen</span> who might know about this?</p>",
        "id": 547577179,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761681103
    },
    {
        "content": "<p>Hmm, looks like the concurrency groups aren't causing multiple runs from the same PR to be canceled for some reason. I'll try and look into this.</p>",
        "id": 547579432,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1761681973
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"123965\">Bryan Gin-ge Chen</span> <a href=\"#narrow/channel/287929-mathlib4/topic/github.20action.20bandwidth/near/547574782\">said</a>:</p>\n<blockquote>\n<p>if you can link to an example log</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/18873417562/job/53857106530?pr=27978\">Here</a></p>",
        "id": 547579455,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1761681986
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"479359\">@Michael Stoll</span> I'm not sure if it's the root cause but it looks like the PR author hadn't merged <code>master</code> for some time, and some big changes were made to the cache with Lean v4.25.0-rc2 which may have made it incompatible with old PRs. We probably should have made an announcement, but it slipped my mind at least. I think merging <code>master</code>, as the PR author did, should hopefully fix things.</p>\n<p>Maybe we need to bring back the \"please-merge-master\" label idea I mentioned here  <a class=\"message-link\" href=\"/#narrow/channel/287929-mathlib4/topic/CI.20failure/near/539759905\">#mathlib4 &gt; CI failure @ ðŸ’¬</a></p>",
        "id": 547580470,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1761682439
    },
    {
        "content": "<p>yeah that might be it, master was changed</p>",
        "id": 547580541,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761682470
    },
    {
        "content": "<p>Just to be clear: I'm not the author of this PR :-)</p>",
        "id": 547580559,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1761682476
    },
    {
        "content": "<p>But in any  case, if there are many older PRs that haven't merged master in a while, it could be a similar effect.</p>",
        "id": 547580676,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1761682520
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"123965\">Bryan Gin-ge Chen</span> <a href=\"#narrow/channel/287929-mathlib4/topic/github.20action.20bandwidth/near/547579432\">said</a>:</p>\n<blockquote>\n<p>Hmm, looks like the concurrency groups aren't causing multiple runs from the same PR to be canceled for some reason. I'll try and look into this.</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/31032\">#31032</a> is my attempt at fixing this</p>",
        "id": 547585018,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1761684305
    },
    {
        "content": "<p><del>@<strong>Bryan Gin-ge Chen</strong> I'm afraid that doesn't seem to have worked, there are two parallel runs from <a href=\"https://github.com/leanprover-community/mathlib4/pull/31004\">#31004</a> happening at the moment, both triggered in the last 10 minutes. (Or does the change to CI only take effect once existing PR authors merge master?)</del> oops, sorry, of course the CI change is still an open PR, clearly I am not thinknig straight and need to get some sleep.</p>",
        "id": 547590883,
        "sender_full_name": "David Loeffler",
        "timestamp": 1761686796
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"481963\">@David Loeffler</span> what Bryan linked to is an open PR</p>",
        "id": 547590996,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761686846
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"123965\">Bryan Gin-ge Chen</span> <a href=\"#narrow/channel/287929-mathlib4/topic/github.20action.20bandwidth/near/547585018\">said</a>:</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/31032\">#31032</a> is my attempt at fixing this</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">I've</span><span class=\"w\"> </span><span class=\"n\">hit</span><span class=\"w\"> </span><span class=\"n\">merge</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">please</span><span class=\"w\"> </span><span class=\"n\">everyone</span><span class=\"w\"> </span><span class=\"n\">keep</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">eye</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">changes</span><span class=\"w\"> </span><span class=\"n\">when</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">lands</span><span class=\"bp\">.</span>\n</code></pre></div>",
        "id": 547620172,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1761706244
    },
    {
        "content": "<p>I just observed a push of a new commit at <a href=\"https://github.com/leanprover-community/mathlib4/pull/30759\">#30759</a> canceling <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/18932213949/job/54051134777?pr=30759\">this run</a> so <a href=\"https://github.com/leanprover-community/mathlib4/pull/31032\">#31032</a> might be working as expected (I'm not 100% sure because <a href=\"https://github.com/leanprover-community/mathlib4/pull/30759\">#30759</a> is not from a fork though)</p>",
        "id": 547862730,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1761807580
    }
]