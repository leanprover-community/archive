[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"266253\">@Joseph Myers</span>, What do you think of a <code>signedDist</code> in the global namespace, for two points <code>p q : P</code> in an affine space and a vector <code>v : V</code>, measuring the distance from <code>p</code> to <code>q</code> in the direction of <code>v</code>?</p>\n<p>I think your recently added <code>AffineSubspace.signedDist</code> is the signed version of <code>Metric.infDist</code>, while <code>signedDist</code> would be the signed version of <code>dist</code>. Then <code>AffineSubspace.signedDist</code> could be renamed to <code>AffineSubspace.signedInfDist</code>.</p>",
        "id": 509964847,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743692309
    },
    {
        "content": "<p>This could be used in my formalization of IMO2020Q6.</p>\n<p>And I think we also need it for stating results about the power of a point/the (signed) intersecting chords theorem</p>",
        "id": 509965902,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743692572
    },
    {
        "content": "<p>I'm not particularly concerned with the precise names, and having some form of signed distance between points (with lemmas linking it to signed distance between a single-point affine subspace and a point) makes sense. Note that <code>AffineSubspace.signedDist</code> is a bundled affine map. I think the one between points with a vector for the direction could be bundled affine in both points (that is, a bundled affine map with codomain a type of bundled affine maps).</p>",
        "id": 510049705,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1743720609
    },
    {
        "content": "<p>The existing material in <code>Mathlib.Geometry.Euclidean.Sphere.Power</code> is indeed rather ad hoc and probably could do with being reworked in terms of an actual definition of <code>power</code> together with signed distance.</p>",
        "id": 510049792,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1743720672
    },
    {
        "content": "<p>I noticed <code>signedDist_apply_self</code> uses <code>‚Äñp -·µ• orthogonalProjection s p‚Äñ</code> instead of <code>dist p (orthogonalProjection s p)</code>, while <code>abs_signedInfDist_eq_dist_of_mem_affineSpan_insert</code> uses <code>dist</code>. Should they both use <code>dist</code>?</p>",
        "id": 510052386,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743722150
    },
    {
        "content": "<p>It probably makes sense to be more consistent there (though neither form is likely to be a good <code>simp</code> normal form - that is, <code>dist_eq_norm_vsub</code> wouldn't be a good <code>simp</code> lemma in either direction - since the most convenient form depends on the context).</p>",
        "id": 510057787,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1743725163
    },
    {
        "content": "<p>I've made a PR for the renaming (<a href=\"https://github.com/leanprover-community/mathlib4/pull/23646\">#23646</a>)</p>",
        "id": 510064142,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743728969
    },
    {
        "content": "<p>It would be nice to define <code>signedInfDist</code> in terms of <code>signedDist</code>. However this would require a way to compose <code>signedDist : P ‚Üí·µÉ[‚Ñù] P ‚Üí·µÉ[‚Ñù] ‚Ñù</code> with <code>AffineMap.id ‚Ñù P : P ‚Üí·µÉ[‚Ñù] P</code> and <code>s.subtype.comp (orthogonalProjection s) : P ‚Üí·µÉ[‚Ñù] P</code>, that is, create as an affine map the function <code>fun x =&gt; signedDist x (orthogonalProjection s x)</code></p>",
        "id": 510065231,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743729602
    },
    {
        "content": "<p><del>Does mathlib have some sort of support for SKI combinator calculus to do this? (In this case it is just the S combinator)</del><br>\nedit: nevermind, you can't define the S combinator on general linear maps.</p>",
        "id": 510065280,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743729630
    },
    {
        "content": "<p>In <a href=\"https://github.com/leanprover-community/mathlib4/pull/24245\">#24245</a>, I've defined <code>signedDist (v : V) : P ‚Üí·µÉ[‚Ñù] P ‚Üí·µÉ[‚Ñù] ‚Ñù</code> between two points. I then used <code>signedDist</code> to rewrite the definition of <code>signedInfDist</code>.</p>",
        "id": 514005698,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1745466965
    },
    {
        "content": "<p>I have an alternative redefinition of <code>signedInfDist</code> in <a href=\"https://github.com/leanprover-community/mathlib4/pull/24338\">#24338</a> as a bundled continuous affine map (depends on <a href=\"https://github.com/leanprover-community/mathlib4/pull/23732\">#23732</a> and <a href=\"https://github.com/leanprover-community/mathlib4/pull/24295\">#24295</a> to provide continuous affine map versions of the operations being composed to produce <code>signedInfDist</code>).</p>",
        "id": 514058213,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745485200
    },
    {
        "content": "<p>I propose that we merge the two approaches. That is, use my definition, but then as a bundled continuous affine map (though I haven't tried this yet)</p>",
        "id": 514072996,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1745488569
    },
    {
        "content": "<p>But I don't quite get the point of the bunled continuous version. Isn't every affine linear map also continuous? (In a normed space)</p>",
        "id": 514074510,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1745488979
    },
    {
        "content": "<p><a href=\"https://en.wikipedia.org/wiki/Discontinuous_linear_map#General_existence_theorem\">https://en.wikipedia.org/wiki/Discontinuous_linear_map#General_existence_theorem</a></p>",
        "id": 514085160,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745491547
    },
    {
        "content": "<p>Thanks, that makes sense now. But I am still confused about the notation for the bundled maps and equivalences: <code>P‚ÇÅ ‚âÉ·µÉL[k] P‚ÇÇ</code> is a continuous affine equivalence, but <code>P‚ÇÅ ‚Üí·¥¨[k] P‚ÇÇ</code> is a continuous affine map? Why don't they use the same letters?</p>",
        "id": 514228263,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1745528450
    },
    {
        "content": "<p>I don't know the reasons behind notation in specific cases, but in general some irregularities in notation for bundled affine maps of various kinds may arise from bundled algebra maps having got there first with various uses of \"a\" and \"A\", and affine maps having to fit in with variants of notation that weren't already in use for algebra maps.</p>",
        "id": 514229964,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745529201
    },
    {
        "content": "<p>Hmm, surely we could at least have the map and equivalence of the same kind use the same letters?</p>",
        "id": 514230182,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1745529307
    },
    {
        "content": "<p>I tried to define <code>signedDist</code> as a continuous affine map, but I ran into the lack of a <code>ContinuousAffineMap.id</code>. (you also observed this in <a href=\"https://github.com/leanprover-community/mathlib4/pull/23732\">#23732</a>)</p>",
        "id": 514230657,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1745529543
    },
    {
        "content": "<p>See <a class=\"message-link\" href=\"/#narrow/channel/287929-mathlib4/topic/RFC.3A.20notation.20for.20continuous.20maps.20in.20algebra/near/491885653\">#mathlib4 &gt; RFC: notation for continuous maps in algebra @ üí¨</a>  for some discussion about my attempt to unify notation here</p>",
        "id": 514231134,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1745529776
    },
    {
        "content": "<p>I looked through the current conventions around this, and I concluded that the notation for ContinuousAffineEquiv is a mistake and should be <code>P‚ÇÅ ‚âÉ·¥¨[k] P‚ÇÇ</code></p>",
        "id": 514238168,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1745533658
    },
    {
        "content": "<p>I made a PR for fixing this: <a href=\"https://github.com/leanprover-community/mathlib4/pull/24357\">#24357</a></p>",
        "id": 514242803,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1745536526
    },
    {
        "content": "<p>I have another question about <code>ContinuousAffineMap</code> and <code>ContinuousAffineEquiv</code>. They are defined as an <code>AffineMap</code>/<code>AffineEquiv</code> where the underlying (affine) function is continuous. <del>Wouldn't it be better to instead require the underlying <code>LinearMap</code>/<code>LinearEquiv</code> to be <code>Continuous</code>? Then the underlying linear map would automatically be (bundled) continuous.</del></p>\n<p>edit: The actual reason I wanted the above is that I want to be able to construct a <code>ContinuousAffineMap</code> by proving that the underlying linear map is continuous instead of proving that the affine map itself is continuous. But this should be possible to do with a constructor. I'll post about it in the <code>AffineSubspace.mk</code> thread since it is related.</p>",
        "id": 514358142,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1745581016
    },
    {
        "content": "<p>In the common case, the topologies on the spaces of points and vectors are compatible and the affine map is continuous if and only if the linear map is continuous. It's true that some material that's meaningful in that case is only actually present in mathlib for the more restricted normed space case (<code>Mathlib.Analysis.Normed.Affine.ContinuousAffineMap</code>). If someone would like to make such material more general in mathlib, getting <a href=\"https://github.com/leanprover-community/mathlib4/pull/22583\">#22583</a> in might be a good start.</p>\n<p>In the uncommon case where the topologies aren't compatible, it would seem counterintuitive for <code>ContinuousAffineMap</code> not actually to be continuous.</p>",
        "id": 514460022,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745614067
    }
]