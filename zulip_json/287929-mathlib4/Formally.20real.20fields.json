[
    {
        "content": "<p>Is there anything in Mathlib on the relationship between formally real fields [-1 not a sum of squares] and [linear] ordered fields? I see that a notion of positive cones has been defined for groups and rings; is there anything more?</p>\n<p>(I think this notion can be extended to formally real rings, I could implement that too if people want)</p>",
        "id": 462192977,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1723576187
    },
    {
        "content": "<p>I don't think there is. Sounds reasonable!</p>",
        "id": 462244461,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723601813
    },
    {
        "content": "<p>We already have the notion of formally real field. cc <span class=\"user-mention\" data-user-id=\"513540\">@Flo (Florent Schaffhauser)</span></p>",
        "id": 462252315,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1723606900
    },
    {
        "content": "<p>Where is this defined? I can't find it from a quick search.</p>",
        "id": 462393076,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1723658016
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"400289\">@Artie Khovanov</span> <span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span></p>\n<p>Sorry, I am not fully available these days. We had a repo on formally real fields here:</p>\n<p><a href=\"https://github.com/riccardobrasca/formally_real\">https://github.com/riccardobrasca/formally_real</a></p>\n<p>And in Mathlib, we have the following:</p>\n<ul>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsSumSq#doc\">docs#IsSumSq</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsSemireal#doc\">docs#IsSemireal</a></li>\n</ul>\n<p>The repo on <span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span> 's GitHub contains a proof that a field is formally real iff it admits an ordering compatible with field structure (Artin-Schreier theory). Would you be interested in working jointly on getting this into mathlib? We could meet over Zoom to discuss this, or manage it via DM <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 462499039,
        "sender_full_name": "Florent Schaffhauser",
        "timestamp": 1723708981
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span>, it's good practice to include a licence in your repo so that we know we can PR stuff from it to Mathlib. Of course, we should also ask you first, but in the event of a really long beach enjoyment session on your part it's good to know that we can get those juicy positive cones in</p>",
        "id": 462547998,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1723727583
    },
    {
        "content": "<p>As an outsider looking at the definition of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsSemireal#doc\">docs#IsSemireal</a>, why have we included the condition that <code>0 ≠ 1</code>? In any type where <code>-0 = 0</code> holds, this follows from <code>¬IsSumSq (-1)</code> and the definition of <code>IsSumSq</code>. And surely we don't care about types where <code>-0 = 0</code> fails.</p>",
        "id": 462596530,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1723741966
    },
    {
        "content": "<p>I also find the definition of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsSemireal#doc\">docs#IsSemireal</a> a bit odd, for orthogonal reasons: we could replace <code>¬IsSumSq (-1 : R)</code> with something like <code>¬∃ (x : R), IsSumSq x ∧ x + 1 = 0</code> and avoid <code>[Neg R]</code> altogether.</p>",
        "id": 462652762,
        "sender_full_name": "Scott Carnahan",
        "timestamp": 1723761305
    },
    {
        "content": "<p>I agree with both of these objections; I want to refactor the two files on cones and IsSemireal to make them easier to use and more general, as well as integrating the additional material on formally real fields.</p>",
        "id": 462657036,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1723763774
    },
    {
        "content": "<p>I generalised the IsSemireal file using <span class=\"user-mention\" data-user-id=\"111080\">@Floris van Doorn</span> and <span class=\"user-mention\" data-user-id=\"630477\">@Scott Carnahan</span>'s suggestions. Here is my draft:<br>\n<a href=\"https://github.com/leanprover-community/mathlib4/commit/5fa28782c709f9db08987f052a348af91c9330f2\">https://github.com/leanprover-community/mathlib4/commit/5fa28782c709f9db08987f052a348af91c9330f2</a><br>\nI welcome any feedback -- I will hopefully be building on this to integrate <span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span>'s work in the future.</p>",
        "id": 464188283,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1724281241
    },
    {
        "content": "<p>Thanks, I left two comments on GH</p>",
        "id": 464274007,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1724308405
    },
    {
        "content": "<p>Have updated accordingly.</p>",
        "id": 464358989,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1724329746
    },
    {
        "content": "<p>Is your code on some branch? (I don't know how to find your new commit)</p>",
        "id": 464360309,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1724330125
    },
    {
        "content": "<p>Oh sorry<br>\nIt's the <code>real-closed-field-dev</code> branch:<br>\n<a href=\"https://github.com/leanprover-community/mathlib4/tree/real_closed_field_dev\">https://github.com/leanprover-community/mathlib4/tree/real_closed_field_dev</a></p>",
        "id": 464360986,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1724330380
    },
    {
        "content": "<p>I want to replace the definition of <code>sumSqIn</code> with multiple definitions for the various structures (AddMonoid, Semiring, RingCone) called <code>AddMonoid.sumSqIn</code> etc.<br>\n<span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span> I belive you were the one that made <code>sumSqIn</code> be defined as a monoid; will this change fundamentally break anything downstream? At worst I think this would require renaming some stuff, but I am inexperienced with the design of the library.</p>",
        "id": 464436848,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1724346786
    },
    {
        "content": "<p>By the way my PR rewriting positive cones is about to go live:<br>\n<a href=\"https://github.com/leanprover-community/mathlib4/pull/15975\">https://github.com/leanprover-community/mathlib4/pull/15975</a></p>",
        "id": 464437091,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1724346832
    },
    {
        "content": "<p>I worry a little about how many new structures that PR introduces, because every new structure creates quite a big API burden. On the other hand, that doesn't mean that it's the wrong approach, just that we should have more machinery to make it more obviously the right approach!</p>",
        "id": 464439200,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1724347312
    },
    {
        "content": "<p>The new structures I have added are the multiplicative versions of the group cones, and also the cones with squares, which I will need for the formally real field stuff.</p>\n<p>The other structures already existed, but I rewrote them to have a more standard definition and also to extend Submonoid and Subsemiring to make them easier to work with.</p>",
        "id": 464439624,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1724347425
    },
    {
        "content": "<p>By the way, what alternatives are there to structures in this sort of situation?</p>",
        "id": 464441907,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1724348081
    },
    {
        "content": "<p>One option is to have fewer structures and more predicates; for instance, we don't have a structure for \"injective linear maps\", you have to pass the linear maps and <code>Function.Injective</code> separately</p>",
        "id": 464442187,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1724348188
    },
    {
        "content": "<p>That's not to say this is a better choice in your situation</p>",
        "id": 464442198,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1724348198
    },
    {
        "content": "<p>Oh I see what you mean. Having predicates for the <code>Maximal</code> and <code>WithSquares</code> forms would be fine, I'm pretty indifferent.</p>",
        "id": 464442330,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1724348257
    },
    {
        "content": "<p>Should I refactor it to that? Or is it good as is?</p>",
        "id": 464462191,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1724354126
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"400289\">Artie Khovanov</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Formally.20real.20fields/near/464436848\">said</a>:</p>\n<blockquote>\n<p>I want to replace the definition of <code>sumSqIn</code> with multiple definitions for the various structures (AddMonoid, Semiring, RingCone) called <code>AddMonoid.sumSqIn</code> etc.<br>\n<span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> I belive you were the one that made <code>sumSqIn</code> be defined as a monoid; will this change fundamentally break anything downstream? At worst I think this would require renaming some stuff, but I am inexperienced with the design of the library.</p>\n</blockquote>\n<p>Update: a draft of my additions is available at<br>\n<a href=\"https://github.com/leanprover-community/mathlib4/blob/real_closed_field_dev/Mathlib/Algebra/Ring/SumsOfSquares.lean\">https://github.com/leanprover-community/mathlib4/blob/real_closed_field_dev/Mathlib/Algebra/Ring/SumsOfSquares.lean</a><br>\n(Compare: <a href=\"https://github.com/leanprover-community/mathlib4/compare/real_closed_field_dev\">https://github.com/leanprover-community/mathlib4/compare/real_closed_field_dev</a>)</p>",
        "id": 464511712,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1724372743
    },
    {
        "content": "<p>Update: here is my PR<br>\n<a href=\"https://github.com/leanprover-community/mathlib4/pull/16094\">https://github.com/leanprover-community/mathlib4/pull/16094</a></p>",
        "id": 464646620,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1724418504
    },
    {
        "content": "<p>Note that you can simply write <a href=\"https://github.com/leanprover-community/mathlib4/pull/16094\">#16094</a>. (For some value of simply.)</p>",
        "id": 464646730,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1724418547
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"400289\">@Artie Khovanov</span> please update the title of the PR to follow the commit guidelines: <a href=\"https://leanprover-community.github.io/contribute/commit.html\">https://leanprover-community.github.io/contribute/commit.html</a></p>",
        "id": 464647460,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1724418796
    },
    {
        "content": "<p>Have now changed the title</p>",
        "id": 464647913,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1724418925
    },
    {
        "content": "<p>My branches have silly names but that's because I made them before Yael convinced me to use a sane workflow.</p>",
        "id": 464648049,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1724418956
    }
]