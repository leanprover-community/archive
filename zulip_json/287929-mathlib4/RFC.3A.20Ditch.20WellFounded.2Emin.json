[
    {
        "content": "<p>I've come to the opinion that <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=WellFounded.min#doc\">docs#WellFounded.min</a> is an antipattern we've been falling victim to, and should be removed in favor of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=WellFounded.has_min#doc\">docs#WellFounded.has_min</a></p>",
        "id": 462591119,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723740136
    },
    {
        "content": "<p>Here's my reasoning:</p>\n<ol>\n<li>This is often not the correct spelling for what we want. If we have a well-order, we can define the stronger <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ConditionallyCompleteLinearOrderBot#doc\">docs#ConditionallyCompleteLinearOrderBot</a> instance, and use <code>Inf</code> instead.</li>\n<li>When we don't have a well-order, choosing an explicit but arbitrary minimal element is basically pointless.</li>\n<li>The arguments of <code>min</code>, <code>min_mem</code>, and <code>not_lt_min</code> are annoyingly duplicated. Using <code>obtain</code> on <code>has_min</code> solves this issue entirely.</li>\n</ol>",
        "id": 462591540,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723740325
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> what do you think?</p>",
        "id": 462591602,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723740351
    },
    {
        "content": "<p>My biggest complaint is that it's completely unsearchable. Every time I look for it, I search for something like <code>Set.Nonempty.exists_min</code></p>",
        "id": 462592329,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1723740645
    },
    {
        "content": "<p>That could very well be made into an alias</p>",
        "id": 462592607,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723740758
    },
    {
        "content": "<p>I'm not sure if we have examples of theorems where two separate arguments allow for dot notation, though</p>",
        "id": 462592660,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723740783
    },
    {
        "content": "<p>Hypothetically <code>min</code> could be useful in the following, very specific case:</p>\n<ol>\n<li>A well-founded order that isn't a well-order</li>\n<li>Under a relation other than <code>&lt;</code></li>\n<li>With a single minimal element</li>\n<li>That can't be defined explicitly</li>\n</ol>",
        "id": 462617640,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723748367
    },
    {
        "content": "<p>The closest thing to that is <code>ZFSet</code> membership, but of course the empty set is perfectly definable</p>",
        "id": 462617721,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723748402
    },
    {
        "content": "<p>If such a specific case did arose... Surely we could just use <code>Classical.some &lt;| WellFounded.has_mem</code> explicitly</p>",
        "id": 462617943,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723748454
    },
    {
        "content": "<p>I'll make the PR tonight if there's no objections</p>",
        "id": 462628731,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723751979
    },
    {
        "content": "<p>Actually, we do have three other definitions depending on <code>WellFounded.min</code>. These are <code>WellFounded.sup</code>, <code>WellFounded.succ</code>, and <code>Function.argmin</code>.</p>",
        "id": 462652779,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723761312
    },
    {
        "content": "<p>These... also have distinct problems</p>",
        "id": 462652799,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723761325
    },
    {
        "content": "<p><code>WellFounded.sup</code> is very misleading. It's only the supremum in a well-ordered type (in which case we almost definitely should be using <code>Sup</code> instead), and otherwise, it's just some random \"minimal upper bound\" for the set.</p>",
        "id": 462653019,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723761445
    },
    {
        "content": "<p>Fortunately, it doesn't seem to be used anywhere (not even in the definition of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsWellOrder.conditionallyCompleteLinearOrderBot#doc\">docs#IsWellOrder.conditionallyCompleteLinearOrderBot</a>) so we can just axe it</p>",
        "id": 462653137,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723761517
    },
    {
        "content": "<p><code>WellFounded.succ</code> has the same problem; it's only valid for a well-order, and a <code>SuccOrder</code> instance exists in the overwhelmingly common case where the order relation is <code>&lt;</code></p>",
        "id": 462653203,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723761567
    },
    {
        "content": "<p>That one is actually used in another file, namely Order/IsWellOrderLimitElement</p>",
        "id": 462653297,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723761614
    },
    {
        "content": "<p>That file proves theorems for <code>LinearOrder α</code> and <code>IsWellOrder α (· &lt; ·)</code>, which is completely equivalent to <code>ConditionallyCompleteLinearOrder α</code> + <code>IsWellOrder α (· &lt; ·)</code></p>",
        "id": 462653550,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723761767
    },
    {
        "content": "<p>In my view, the \"correct\" notion of a limit element is that of a <code>SuccOrder</code>, namely a (non-minimal) element that is not a successor</p>",
        "id": 462653647,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723761835
    },
    {
        "content": "<p>So really that whole file is problematic to me</p>",
        "id": 462653654,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723761841
    },
    {
        "content": "<p>Looking at the discussion on <a href=\"https://github.com/leanprover-community/mathlib4/pull/11584\">#11584</a>, it seems <span class=\"user-mention\" data-user-id=\"224323\">@Junyan Xu</span> agrees with me</p>",
        "id": 462654146,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723762121
    },
    {
        "content": "<p>As for <code>Function.argmin</code>, it does seem to get used a bit more throughout MathLib.</p>",
        "id": 462654212,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723762181
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 462654229,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723762196
    },
    {
        "content": "<p>I'm not quite sure how I feel about it. I think it should probably be made specific to lattices, but it can stay for now, I guess</p>",
        "id": 462657729,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723764197
    },
    {
        "content": "<p>I opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/15863\">#15863</a>, which should be an initial step towards getting rid of / refactoring <code>IsWellOrderLimitElement.lean</code></p>",
        "id": 462719718,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723790556
    },
    {
        "content": "<p>You know, I'm beginning to see how <code>WellFounded.min</code> is useful</p>",
        "id": 462862897,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723846079
    },
    {
        "content": "<p>It serves some purpose within nonconstructive definitions, particularly when you're working not with <code>&lt;</code> but with an arbitrary relation</p>",
        "id": 462863045,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723846160
    },
    {
        "content": "<p>In that case, it's useful even in the well-order case</p>",
        "id": 462863067,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723846177
    },
    {
        "content": "<p>Of course, we should avoid working with general well-orders like that, but this is simply how some parts of the library are set up. For instance, ordinals are defined as a quotient of well-ordered types under otherwise arbitrary relations.</p>",
        "id": 462863149,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723846229
    },
    {
        "content": "<p>I think the actual thing to be doing is refactoring the uses of <code>min</code> out whenever possible, if they can be replaced by <code>sInf</code> or <code>obtains _ := WellFounded.has_min</code>. There's few legitimate uses, but that's not zero.</p>",
        "id": 462865825,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1723848023
    }
]