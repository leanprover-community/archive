[
    {
        "content": "<p>I ran out of disc space yesterday and the reason was that I had 145 gigs in <code>\\~/.cache/mathlib</code>; this turned out to be 2.4 million files called things like <code>8521368773646758302.tar.gz</code> and <code>55c0087019cbc8cd.ltar</code>; it was not completely trivial to even delete them because <code>rm *.ltar</code> gave me a bash error <code>/usr/bin/rm: Argument list too long</code> :-)</p>",
        "id": 536070791,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1756142125
    },
    {
        "content": "<p><code>rm -rf 1*.ltar</code> and work your way through hex !</p>",
        "id": 536072761,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1756142796
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">buzzard</span><span class=\"bp\">@</span><span class=\"n\">brutus</span><span class=\"o\">:</span><span class=\"bp\">~/.</span><span class=\"n\">cache</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">rm</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"bp\">*.</span><span class=\"n\">ltar</span>\n<span class=\"n\">bash</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">usr</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">rm</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Argument</span><span class=\"w\"> </span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"n\">too</span><span class=\"w\"> </span><span class=\"n\">long</span>\n<span class=\"n\">buzzard</span><span class=\"bp\">@</span><span class=\"n\">brutus</span><span class=\"o\">:</span><span class=\"bp\">~/.</span><span class=\"n\">cache</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">rm</span><span class=\"w\"> </span><span class=\"mi\">11</span><span class=\"bp\">*.</span><span class=\"n\">ltar</span>\n<span class=\"n\">buzzard</span><span class=\"bp\">@</span><span class=\"n\">brutus</span><span class=\"o\">:</span><span class=\"bp\">~/.</span><span class=\"n\">cache</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">$</span>\n</code></pre></div>\n<p>but <code>rm 0[01234]*.ltar</code> was OK. Took me a while! The machine is from 2019 or so (and has been used to do little else but Lean since then).</p>",
        "id": 536073732,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1756143129
    },
    {
        "content": "<p>I might be imagining it but my impression is that the \"Decompressing/Unpacked\" part at the end of <code>lake exe cache get</code> is now much much quicker on this machine.</p>",
        "id": 536074484,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1756143404
    },
    {
        "content": "<p>We had to add a step to our CI a while back because of the same problem. I guess we want some kind of auto-cleanup for users as well in Cache?</p>",
        "id": 536075368,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1756143728
    },
    {
        "content": "<p>This gets around the <code>Argument list too long</code> issue:</p>\n<p><code>% find .cache/mathlib/ -type f -name \"*.ltar\" -exec rm {} \\;</code></p>\n<p>If you want to do a \"dry run\" first:</p>\n<p><code>% find .cache/mathlib/ -type f -name \"*.ltar\" -exec ls -dl {} \\;</code></p>",
        "id": 536105040,
        "sender_full_name": "Louis Cabarion",
        "timestamp": 1756154521
    },
    {
        "content": "<p>Doesn't just <code>rm -rf .cache/mathlib</code> also suffice?</p>",
        "id": 536132030,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1756168770
    },
    {
        "content": "<p>I was scared about removing the stuff which wasn't .ltar files! (loads of versions of <code>leantar</code>)</p>",
        "id": 536192818,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1756199774
    },
    {
        "content": "<p>I've been hovering around 10 gigs left for the past few months. A tool to clear the cache every once in a while would be quite appreciated!</p>",
        "id": 536193480,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1756200025
    }
]