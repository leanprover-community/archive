[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span>, I just noticed the commandStart linter is broken with <code>grind</code>.</p>\n<p>We will need to add many annotations of the form <code>@[grind =]</code>, but the commandStart linter says:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"n\">space</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">source</span>\n\n<span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">part</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">code</span>\n<span class=\"w\">  </span><span class=\"bp\">'=</span><span class=\"o\">]</span>\n<span class=\"kn\">theorem</span><span class=\"bp\">'</span>\n<span class=\"n\">should</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">written</span><span class=\"w\"> </span><span class=\"n\">as</span>\n<span class=\"w\">  </span><span class=\"bp\">'</span><span class=\"kd\">@[</span><span class=\"n\">grind</span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"bp\">'</span>\n\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">style</span><span class=\"bp\">.</span><span class=\"n\">commandStart</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n</code></pre></div>\n<p>Can you make this problem go away for me? :-)</p>",
        "id": 524978490,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750395774
    },
    {
        "content": "<p>Can you share some working code where the linter complains?</p>",
        "id": 524979055,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750396332
    },
    {
        "content": "<p>Without knowing more about the syntax that grind produces, I can simply silence the linter on attributes, but if I could silence it more granularly, that would probably be better.</p>",
        "id": 524979081,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750396366
    },
    {
        "content": "<p>On nightly-testing, just write </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">axiom</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\">  </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"kn\">axiom</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"kd\">@[</span><span class=\"n\">grind</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 524979132,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750396417
    },
    {
        "content": "<p>Alternatively, if you prefer <code>@[grind =]</code> to <code>@[grind= ]</code>, you can also change the pretty-printer for <code>grind</code>.</p>",
        "id": 524979149,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750396430
    },
    {
        "content": "<p>Oh, I see, it's a pretty-printer problem!</p>",
        "id": 524979161,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750396445
    },
    {
        "content": "<p>Okay, I will look into that.</p>",
        "id": 524979166,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750396452
    },
    {
        "content": "<p>Yes, the commandStart linter uses the pretty-printer to decide what should change.</p>",
        "id": 524979178,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750396464
    },
    {
        "content": "<p>I actually don't know how to pretty print attributes on declaration, any suggestions how to test?</p>",
        "id": 524979195,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750396485
    },
    {
        "content": "<p>But since the pretty-printer does not always get it right, the linter has an override option to ignore certain syntaxnodekinds.</p>",
        "id": 524979198,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750396492
    },
    {
        "content": "<p>This should be some syntax annotation where <code>grind</code> is defined.</p>",
        "id": 524979225,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750396529
    },
    {
        "content": "<p>Yes, but how do test my fix without going back to Mathlib?</p>",
        "id": 524979238,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750396546
    },
    {
        "content": "<p>Let me first get a version of nightly that works and take a look at the syntax.</p>",
        "id": 524979243,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750396549
    },
    {
        "content": "<p>I need to run the pretty printer in some way that will actually try to show an attribute.</p>",
        "id": 524979251,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750396561
    },
    {
        "content": "<p>Ah, I can extract what pretty-printed thing the linter would think in a moment!</p>",
        "id": 524979273,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750396581
    },
    {
        "content": "<p>Actually, while I download nightly-testing, the linter only needs <code>import Lean.Elab.Command</code>, so you could also simply copy the file into Lean and import it to see what it does.</p>",
        "id": 524979562,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750396894
    },
    {
        "content": "<p>I'd prefer not to touch your linter if possible. :-)</p>",
        "id": 524979689,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750396995
    },
    {
        "content": "<p>Ok, I am having problems building some files in nightly-testing.  Give me a minute!</p>",
        "id": 524979702,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750397021
    },
    {
        "content": "<p>Do you know how to test the pretty printer on an attribute? e.g. running <code>#print foo</code> doesn't show any attributes.</p>",
        "id": 524979744,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750397051
    },
    {
        "content": "<p>I think that this is what the commandStart sees:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">run_cmd</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">stx</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"kd\">@[</span><span class=\"n\">grind</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">fmt</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"n\">Format</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span>\n<span class=\"w\">        </span><span class=\"n\">liftCoreM</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">PrettyPrinter</span><span class=\"bp\">.</span><span class=\"n\">ppCategory</span><span class=\"w\"> </span><span class=\"ss\">`command</span><span class=\"w\"> </span><span class=\"n\">stx</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">fmt</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">fmt</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">fmt</span><span class=\"bp\">.</span><span class=\"n\">pretty</span>\n<span class=\"w\">  </span><span class=\"n\">dbg_trace</span><span class=\"w\"> </span><span class=\"n\">st</span>\n</code></pre></div>",
        "id": 524979897,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750397209
    },
    {
        "content": "<p>I probably should extract this to some standalone function for just this purpose.</p>",
        "id": 524979950,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750397256
    },
    {
        "content": "<p>Great, I can reproduce in Lean.</p>",
        "id": 524980171,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750397474
    },
    {
        "content": "<p>Ok, I am still having import problems: I don't seem to be able to actually restart files.</p>",
        "id": 524980209,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750397503
    },
    {
        "content": "<p>Ah, it's tricky to fix, because these syntax are used as both prefixes and suffixes.</p>\n<p>We write <code>@[grind =] theorem foo</code>, but also <code>grind [= foo]</code>.</p>",
        "id": 524980288,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750397551
    },
    {
        "content": "<p>The spaces are set up for the second use case, and so are wrong for the first.</p>",
        "id": 524980300,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750397566
    },
    {
        "content": "<p>Ok, I'll look up the syntaxnodekind and add an exception to the linter.</p>",
        "id": 524980336,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750397588
    },
    {
        "content": "<p><code>grind</code> has some very persistent pretty-printing formatting!  I could only make the linter silent by disabling entirely on attributes, not just <code>grind</code>.  Anyway, this is what you can do:</p>\n<div class=\"codehilite\" data-code-language=\"Diff\"><pre><span></span><code><span class=\"gh\">diff --git a/Mathlib/Tactic/Linter/CommandStart.lean b/Mathlib/Tactic/Linter/CommandStart.lean</span>\n<span class=\"gh\">index c981cc7e6ce..fb8d4002299 100644</span>\n<span class=\"gd\">--- a/Mathlib/Tactic/Linter/CommandStart.lean</span>\n<span class=\"gi\">+++ b/Mathlib/Tactic/Linter/CommandStart.lean</span>\n<span class=\"gu\">@@ -242,6 +242,7 @@ abbrev unlintedNodes := #[</span>\n\n<span class=\"w\"> </span>  -- The pretty-printer adds a space between the backticks and the actual name.\n<span class=\"w\"> </span>  ``Parser.Term.doubleQuotedName,\n<span class=\"gi\">+  ``Parser.Term.attributes,</span>\n<span class=\"w\"> </span>  ]\n\n<span class=\"w\"> </span>/--\n</code></pre></div>\n<p>Do you want me to make a PR with this?</p>",
        "id": 524980901,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750398063
    },
    {
        "content": "<p>Still thinking about fixing it at the syntax end, I'll let you know if I get stuck.</p>",
        "id": 524981110,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750398238
    },
    {
        "content": "<p>Since I'll have to leave soon, I'll make a PR with the blanket change up there: feel free to incorporate or ignore!</p>\n<p>I also thought that the linter had a pretty fine-grained method for allowing exceptions, but <code>grind</code> is proving me wrong, so I'd like to see what I should be improving anyway.</p>",
        "id": 524981270,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750398396
    },
    {
        "content": "<p>So far I have persuaded it to pretty print as <code>@[grind = ]</code>... i.e. a space on both sides.</p>",
        "id": 524981288,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750398407
    },
    {
        "content": "<p>To be fair, it is not unreasonable for the pretty-printer to do this, but I agree that skipping the final space would look better.</p>",
        "id": 524981398,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750398498
    },
    {
        "content": "<p>By the way, the linter already special cases something else for a similar reason (although it is not an attribute):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"c1\">-- notation for `Finset.slice`, the pretty-printer prefers `ùíú #r` over `ùíú # r` (mathlib style)</span>\n<span class=\"w\">  </span><span class=\"ss\">`Finset</span><span class=\"bp\">.¬´</span><span class=\"n\">term_</span><span class=\"bp\">#_¬ª</span><span class=\"o\">,</span>\n</code></pre></div>",
        "id": 524981460,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750398563
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/26196\">#26196</a> and I've asked for your review.</p>",
        "id": 524981933,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750398969
    },
    {
        "content": "<p>I will only have a few scattered moments throughout the day where I can act on things, so I wanted to leave this in a state where there was at least one solution available!  <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 524982172,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750399168
    },
    {
        "content": "<p>Thank you! Prompt help very much appreciated. :-)</p>",
        "id": 524982748,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750399506
    },
    {
        "content": "<p>I wanted to fix this in <a href=\"https://github.com/leanprover/lean4/pull/8424\">lean#8424</a>, basically:</p>\n<div class=\"codehilite\" data-code-language=\"Diff\"><pre><span></span><code>src/Init/Grind/Tactics.lean\n<span class=\"gu\">@@ -15,22 +15,22 @@ Reset all `grind` attributes. This command is intended for testing purposes only</span>\n<span class=\"w\"> </span>syntax (name := resetGrindAttrs) \"reset_grind_attrs%\" : command\n\n<span class=\"w\"> </span>namespace Attr\n<span class=\"gd\">-syntax grindEq     := \"= \"</span>\n<span class=\"gd\">-syntax grindEqBoth := atomic(\"_\" \"=\" \"_ \")</span>\n<span class=\"gd\">-syntax grindEqRhs  := atomic(\"=\" \"_ \")</span>\n<span class=\"gd\">-syntax grindEqBwd  := atomic(\"‚Üê\" \"= \") &lt;|&gt; atomic(\"&lt;-\" \"= \")</span>\n<span class=\"gd\">-syntax grindBwd    := \"‚Üê \" &lt;|&gt; \"-&gt; \"</span>\n<span class=\"gd\">-syntax grindFwd    := \"‚Üí \" &lt;|&gt; \"&lt;- \"</span>\n<span class=\"gd\">-syntax grindRL     := \"‚áê \" &lt;|&gt; \"&lt;= \"</span>\n<span class=\"gd\">-syntax grindLR     := \"‚áí \" &lt;|&gt; \"=&gt; \"</span>\n<span class=\"gd\">-syntax grindUsr    := &amp;\"usr \"</span>\n<span class=\"gd\">-syntax grindCases  := &amp;\"cases \"</span>\n<span class=\"gd\">-syntax grindCasesEager := atomic(&amp;\"cases\" &amp;\"eager \")</span>\n<span class=\"gd\">-syntax grindIntro  := &amp;\"intro \"</span>\n<span class=\"gd\">-syntax grindExt    := &amp;\"ext \"</span>\n<span class=\"gi\">+syntax grindEq     := \"=\"</span>\n<span class=\"gi\">+syntax grindEqBoth := atomic(\"_\" \"=\" \"_\")</span>\n<span class=\"gi\">+syntax grindEqRhs  := atomic(\"=\" \"_\")</span>\n<span class=\"gi\">+syntax grindEqBwd  := atomic(\"‚Üê\" \"=\") &lt;|&gt; atomic(\"&lt;-\" \"=\")</span>\n<span class=\"gi\">+syntax grindBwd    := \"‚Üê\" &lt;|&gt; \"&lt;-\"</span>\n<span class=\"gi\">+syntax grindFwd    := \"‚Üí\" &lt;|&gt; \"-&gt;\"</span>\n<span class=\"gi\">+syntax grindRL     := \"‚áê\" &lt;|&gt; \"&lt;=\"</span>\n<span class=\"gi\">+syntax grindLR     := \"‚áí\" &lt;|&gt; \"=&gt;\"</span>\n<span class=\"gi\">+syntax grindUsr    := &amp;\"usr\"</span>\n<span class=\"gi\">+syntax grindCases  := &amp;\"cases\"</span>\n<span class=\"gi\">+syntax grindCasesEager := atomic(&amp;\"cases \" &amp;\"eager\")</span>\n<span class=\"gi\">+syntax grindIntro  := &amp;\"intro\"</span>\n<span class=\"gi\">+syntax grindExt    := &amp;\"ext\"</span>\n<span class=\"w\"> </span>syntax grindMod := grindEqBoth &lt;|&gt; grindEqRhs &lt;|&gt; grindEq &lt;|&gt; grindEqBwd &lt;|&gt; grindBwd &lt;|&gt; grindFwd &lt;|&gt; grindRL &lt;|&gt; grindLR &lt;|&gt; grindUsr &lt;|&gt; grindCasesEager &lt;|&gt; grindCases &lt;|&gt; grindIntro &lt;|&gt; grindExt\n<span class=\"gd\">-syntax (name := grind) \"grind\" (grindMod)? : attr</span>\n<span class=\"gd\">-syntax (name := grind?) \"grind?\" (grindMod)? : attr</span>\n<span class=\"gi\">+syntax (name := grind) \"grind\" (ppSpace grindMod)? : attr</span>\n<span class=\"gi\">+syntax (name := grind?) \"grind?\" (ppSpace grindMod)? : attr</span>\n<span class=\"w\"> </span>end Attr\n<span class=\"w\"> </span>end Lean.Parser\n\n<span class=\"gu\">@@ -139,19 +139,19 @@ namespace Lean.Parser.Tactic</span>\n<span class=\"w\"> </span>`grind` tactic and related tactics.\n<span class=\"w\"> </span>-/\n\n<span class=\"w\"> </span>syntax grindErase := \"-\" ident\n<span class=\"gd\">-syntax grindLemma := (Attr.grindMod)? ident</span>\n<span class=\"gi\">+syntax grindLemma := (Attr.grindMod ppSpace)? ident</span>\n<span class=\"w\"> </span>syntax grindParam := grindErase &lt;|&gt; grindLemma\n\n<span class=\"w\"> </span>syntax (name := grind)\n<span class=\"w\"> </span>  \"grind\" optConfig (&amp;\" only\")?\n<span class=\"w\"> </span>  (\" [\" withoutPosition(grindParam,*) \"]\")?\n<span class=\"gd\">-  (\"on_failure \" term)? : tactic</span>\n<span class=\"gi\">+  (&amp;\" on_failure \" term)? : tactic</span>\n\n\n<span class=\"w\"> </span>syntax (name := grindTrace)\n<span class=\"w\"> </span>  \"grind?\" optConfig (&amp;\" only\")?\n<span class=\"w\"> </span>  (\" [\" withoutPosition(grindParam,*) \"]\")?\n<span class=\"gd\">-  (\"on_failure \" term)? : tactic</span>\n<span class=\"gi\">+  (&amp;\" on_failure \" term)? : tactic</span>\n\n<span class=\"w\"> </span>end Lean.Parser.Tactic\n</code></pre></div>",
        "id": 524986221,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1750402158
    },
    {
        "content": "<p>Oh I see you already did most of this and ran into the same bootstrapping issue :-)</p>",
        "id": 524986986,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1750402587
    },
    {
        "content": "<p>Gah... bootstrapping sucks, I'm quite frustrated by this PR.</p>",
        "id": 524988065,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750403266
    },
    {
        "content": "<p>(<a href=\"https://github.com/leanprover/lean4/pull/8424\">lean#8424</a>)</p>",
        "id": 525050061,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1750428699
    },
    {
        "content": "<p>If someone would like to get involved in more annoying <del>syntax</del>pretty-printing fixing, here is another issue unearthed by the <code>commandStart</code> linter of a similar nature:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Command</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">info: @[simp‚Üê ]</span>\n<span class=\"sd\">example :=</span>\n<span class=\"sd\">  0</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"n\">run_cmd</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">stx</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">logInfo</span><span class=\"w\"> </span><span class=\"n\">stx</span>\n</code></pre></div>\n<p>Note how <code>@[simp ‚Üê]</code> gets pretty-printed as <code>@[simp‚Üê ]</code>.</p>",
        "id": 527636773,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1751965418
    },
    {
        "content": "<p>Would anyone be kind enough to fix this?  <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 527636819,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1751965431
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> <a href=\"#narrow/channel/287929-mathlib4/topic/commandStart.20linter.20broken.20with.20.60grind.60/near/527636773\">said</a>:</p>\n<blockquote>\n<p>If someone would like to get involved in more annoying <del>syntax</del>pretty-printing fixing, here is another issue unearthed by the <code>commandStart</code> linter of a similar nature:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Command</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">info: @[simp‚Üê ]</span>\n<span class=\"sd\">example :=</span>\n<span class=\"sd\">  0</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"n\">run_cmd</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">stx</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">logInfo</span><span class=\"w\"> </span><span class=\"n\">stx</span>\n</code></pre></div>\n<p>Note how <code>@[simp ‚Üê]</code> gets pretty-printed as <code>@[simp‚Üê ]</code>.</p>\n</blockquote>\n<p>This came up in <a href=\"https://github.com/leanprover-community/mathlib4/pull/27064\">#27064</a></p>",
        "id": 532242386,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1754032756
    }
]