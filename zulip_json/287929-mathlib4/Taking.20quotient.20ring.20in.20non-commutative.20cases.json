[
    {
        "content": "<p>I was trying to formalize the concept of symmetric algebra, which is basically  the tensor algebra taking quotient by relations of the form <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>âŠ—</mo><mi>y</mi><mo>âˆ’</mo><mi>y</mi><mo>âŠ—</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x \\otimes y - y \\otimes x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âŠ—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âŠ—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>. So I came across this problem about, how should I take the quotient when the ring I started with is non-commutative. </p>\n<p>There seems to be several approaches of doing this, either by using RingQuot or taking the quotient by a TwoSidedIdeal (but the HasQuotient instance seems to be missing until now). So I thought it would probably be better to come to zulip and ask for some advice from the more experienced ones. In which way should I formalize this (which presumably is more convenient when adding instances)? And when should I prefer RingQuot over the other way if provided the method of taking a quotient by a TwoSidedIdeal? </p>\n<p>In addition, I'm also curious about how we should formalize taking quotients by TwoSidedIdeals. A few questions came up when I was discussing this with a friend of mine, such as, is it possible to make this DefEq to taking quotient by an Ideal in the commutative case, or even DefEq to taking RingQuot? Some ideas we came up with is:</p>\n<ol>\n<li>\n<p>Simply taking RingQuot of the RingCon inside the TwoSidedIdeal <br>\n(which is not DefEq to anything, and isomorphisms would be used to do the conversions)</p>\n</li>\n<li>\n<p>Defining it to be taking the quotient of a relation analogous of how quotients of ideals are defined, something like </p>\n</li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasQuotient</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">TwoSidedIdeal</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">quotient'</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quotient</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">I</span><span class=\"bp\">.</span><span class=\"n\">ringCon</span><span class=\"bp\">.</span><span class=\"n\">toSetoid</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>which makes it DefEq for R / I.toTwoSided and R / I for an ideal I in the case of commutative rings, and for a two-sided ideal J, R / J.asIdeal is propositionally equal to R / J.</p>\n<ol start=\"3\">\n<li>Refactoring the definition of ideals so that the data of that RingCon is contained in the structure, and things would be DefEq in a rather simple way (but seems like a lot of work)</li>\n</ol>\n<p>Which would you prefer among these ideas? Or probably you can suggest another better one?</p>\n<p>P.S. I'm also curious about why RingQuot has been defined as a structure wrapped around some Quot, does anyone have some ideas on that?</p>\n<p>Thanks in advance! I would really appreciate your help!</p>",
        "id": 489254056,
        "sender_full_name": "Wang Jingting",
        "timestamp": 1734360042
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=RingQuot#doc\">docs#RingQuot</a> I think?</p>",
        "id": 489254751,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1734360209
    },
    {
        "content": "<p>Yes, I personally think that the api aroud <code>RingQuot</code> is quite pleasant to use.</p>",
        "id": 489254856,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1734360240
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243562\">Adam Topaz</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Taking.20quotient.20ring.20in.20non-commutative.20cases/near/489254751\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=RingQuot#doc\">docs#RingQuot</a> I think?</p>\n</blockquote>\n<p>Sure that makes sense, but since we already have TwoSidedIdeal, probably taking quotient by that would be a better way? RingQuot seems to be designed in a way that's not DefEq to any other thing, so I'm curious about why had it been designed like this. (which the docs didn't say about?)</p>",
        "id": 489255415,
        "sender_full_name": "Wang Jingting",
        "timestamp": 1734360372
    },
    {
        "content": "<p>In general we use wrappers (such as one for <code>RingQuot</code>) to add a layer of separation between the \"original\" object and the new object being defined. With this approach there can be no confusion between types of <code>Quot ...</code> and types of <code>RingQuot ...</code>, but if we did <code>def RingQuot ... := Quot ...</code> there could be such a confusion.</p>",
        "id": 489255489,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1734360389
    },
    {
        "content": "<p>I'm not sure why you have a two sided ideal. You could define an inductive relation for the symmetric algebra as </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">inductive</span><span class=\"w\"> </span><span class=\"n\">SymmRel</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SymmRel</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>(untested) and use that in <code>RingQuot</code>.</p>",
        "id": 489255810,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1734360461
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243562\">Adam Topaz</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Taking.20quotient.20ring.20in.20non-commutative.20cases/near/489255489\">said</a>:</p>\n<blockquote>\n<p>In general we use wrappers (such as one for <code>RingQuot</code>) to add a layer of separation between the \"original\" object and the new object being defined. With this approach there can be no confusion between types of <code>Quot ...</code> and types of <code>RingQuot ...</code>, but if we did <code>def RingQuot ... := Quot ...</code> there could be such a confusion.</p>\n</blockquote>\n<p>Yeah, I agree with that, but it occurred to me that when formalizing things on a type-theoretical basis, making things DefEq would often make life easier? Like, why wouldn't we wany this to be DefEq to something when taking quotient by an ideal (in the commutative case)?</p>",
        "id": 489256318,
        "sender_full_name": "Wang Jingting",
        "timestamp": 1734360573
    },
    {
        "content": "<p>Let me point to another approach at <a href=\"https://github.com/leanprover-community/mathlib4/pull/17930\">#17930</a> introducing a typeclass <code>Ideal.IsTwoSided</code> to generalize existing materials on CommRing quotient to the setting of Ring + IsTwoSided (and therefore the defeq with AddCommGroup/Module quotient is kept). The new typeclass and generalizations caused some slowdown, and even though I reduced the slowdown to 0.217/0.201%, I temporarily ran out of ideas to further reduce it. I think the new class is pretty reasonable since <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Ideal.IsPrime#doc\">docs#Ideal.IsPrime</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Ideal.IsMaximal#doc\">docs#Ideal.IsMaximal</a> are already classes.</p>",
        "id": 489257083,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1734360764
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243562\">Adam Topaz</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Taking.20quotient.20ring.20in.20non-commutative.20cases/near/489255810\">said</a>:</p>\n<blockquote>\n<p>I'm not sure why you have a two sided ideal. You could define an inductive relation for the symmetric algebra as </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">inductive</span><span class=\"w\"> </span><span class=\"n\">SymmRel</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SymmRel</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>(untested) and use that in <code>RingQuot</code>.</p>\n</blockquote>\n<p>We were thinking the exact same thing when we started! We actually wrote a definition like this and already proved some properties, and this question came up when I was trying to give it a gradedAlgebra structure and start thinking about probably we should talk about taking quotients of homogeneous two-sided ideals more generally. So then I began to look at things about TwoSidedIdeals and I was really surprised to find that we're still unable to take quotients by them. (this makes another part of the background story)</p>",
        "id": 489257086,
        "sender_full_name": "Wang Jingting",
        "timestamp": 1734360766
    },
    {
        "content": "<p>Yeah mathlib has been pretty commutative-algebra focused, and I think the lack of more two-sided ideal support is a major roadblocker against the development of more noncommutative theory.</p>",
        "id": 489257638,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1734360888
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"224323\">Junyan Xu</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Taking.20quotient.20ring.20in.20non-commutative.20cases/near/489257083\">said</a>:</p>\n<blockquote>\n<p>Let me point to another approach at <a href=\"https://github.com/leanprover-community/mathlib4/pull/17930\">#17930</a> introducing a typeclass <code>Ideal.IsTwoSided</code> to generalize existing materials on CommRing quotient to the setting of Ring + IsTwoSided (and therefore the defeq with AddCommGroup/Module quotient is kept). The new typeclass and generalizations caused some slowdown, and even though I reduced the slowdown to 0.217/0.201%, I temporarily ran out of ideas to further reduce it. I think the new class is pretty reasonable since <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Ideal.IsPrime#doc\">docs#Ideal.IsPrime</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Ideal.IsMaximal#doc\">docs#Ideal.IsMaximal</a> are already classes.</p>\n</blockquote>\n<p>I see your point on that, it seems reasonable to me, but since we already have a class called TwoSidedIdeal in mathlib, wouldn't developing them both in parallel cause some confusions? Or perhaps your idea is that we only take quotient by ideals, and the quotient is a ring only in the case we have [I.isTwoSided] on it?</p>",
        "id": 489258516,
        "sender_full_name": "Wang Jingting",
        "timestamp": 1734361079
    },
    {
        "content": "<blockquote>\n<p>Or perhaps your idea is that we only take quotient by ideals, and the quotient is a ring only in the case we have [I.isTwoSided] on it?</p>\n</blockquote>\n<p>Yeah that's exactly the case.<br>\nMore discussions at <a class=\"message-link\" href=\"/#narrow/channel/144837-PR-reviews/topic/.2317908.20Hopkins.E2.80.93Levitzki.20theorem/near/481460482\">#PR reviews &gt; #17908 Hopkinsâ€“Levitzki theorem @ ðŸ’¬</a></p>",
        "id": 489258885,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1734361156
    },
    {
        "content": "<p>Ideal is a special case (reducibly defeq) of Submodule, and there's already a HasQuotient instance for Submodules <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Submodule.hasQuotient#doc\">docs#Submodule.hasQuotient</a>.</p>",
        "id": 489259866,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1734361358
    },
    {
        "content": "<p>This is where I detail the reason why I'm not taking quotients by <code>TwoSidedIdeal</code>s: <a class=\"message-link\" href=\"/#narrow/channel/287929-mathlib4/topic/two-sided.20ideals/near/482522231\">#mathlib4 &gt; two-sided ideals @ ðŸ’¬</a></p>",
        "id": 489264980,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1734362475
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"224323\">Junyan Xu</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Taking.20quotient.20ring.20in.20non-commutative.20cases/near/489258885\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>Or perhaps your idea is that we only take quotient by ideals, and the quotient is a ring only in the case we have [I.isTwoSided] on it?</p>\n</blockquote>\n<p>Yeah that's exactly the case.<br>\nMore discussions at <a class=\"message-link\" href=\"/#narrow/channel/144837-PR-reviews/topic/.2317908.20Hopkins.E2.80.93Levitzki.20theorem/near/481460482\">#PR reviews &gt; #17908 Hopkinsâ€“Levitzki theorem @ ðŸ’¬</a></p>\n</blockquote>\n<p>Thanks a lot! That seems to be a helpful related discussion. I'd say that's a reasonable idea (which seems a bit more natural then the current approach), but probably they're expecting something more on the performance? Anyway, thanks again!</p>",
        "id": 489265819,
        "sender_full_name": "Wang Jingting",
        "timestamp": 1734362681
    }
]