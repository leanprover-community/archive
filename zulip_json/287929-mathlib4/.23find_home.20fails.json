[
    {
        "content": "<p>In this example, <code>#find_home</code> thinks for a long time, then suggests the current file:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">formPerm_sign</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Î±</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">Î±</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">Î±</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Î±</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"bp\">.</span><span class=\"n\">Nodup</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Perm</span><span class=\"bp\">.</span><span class=\"n\">sign</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"bp\">.</span><span class=\"n\">formPerm</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"bp\">.</span><span class=\"n\">tail</span><span class=\"bp\">.</span><span class=\"n\">length</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">[],</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">_</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">nodup_cons</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mem_cons</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">not_or</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">formPerm_sign</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">pow_succ</span><span class=\"o\">]</span>\n\n<span class=\"bp\">#</span><span class=\"n\">find_home</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">formPerm_sign</span>\n</code></pre></div>",
        "id": 512687741,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744837944
    },
    {
        "content": "<p>You mean you make a scratch file in the mathlib repo with <code>import Mathlib</code> and then <code>#find_home</code> gives you the name of the scratch file? For me this is the usual behaviour.</p>",
        "id": 512688650,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744838107
    },
    {
        "content": "<p>What should I do instead?</p>",
        "id": 512688773,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744838133
    },
    {
        "content": "<p>I don't have a clue!</p>",
        "id": 512688816,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744838142
    },
    {
        "content": "<p>CC: <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span></p>",
        "id": 512689092,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744838192
    },
    {
        "content": "<p>Indeed I can reproduce with your example.</p>",
        "id": 512689266,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744838228
    },
    {
        "content": "<p><code>List.formPerm_sign</code> uses <code>List.formPerm_sign.match_1</code> which was defined in this file</p>",
        "id": 512689279,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1744838232
    },
    {
        "content": "<p>I guess, it fails to filter out some aux def in the same file.</p>",
        "id": 512689317,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744838253
    },
    {
        "content": "<p>Or at least, that's my hypothesis</p>",
        "id": 512689360,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1744838280
    },
    {
        "content": "<p>workaround:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">find_home</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">formPerm_sign</span><span class=\"bp\">.</span><span class=\"n\">match_1</span>\n</code></pre></div>\n<p>!<br>\nAnswer:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">[</span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">MLList</span><span class=\"bp\">.</span><span class=\"n\">Basic</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">String</span><span class=\"bp\">.</span><span class=\"n\">Basic</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Gcd</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">WF</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Aesop</span><span class=\"bp\">.</span><span class=\"n\">Nanos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">Init</span><span class=\"bp\">.</span><span class=\"n\">Lemmas</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Basic</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">ByteSubarray</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">EStateM</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Util</span><span class=\"bp\">.</span><span class=\"n\">Panic</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Stream</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">Process</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Init</span><span class=\"bp\">.</span><span class=\"n\">Prelude</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">BitVec</span><span class=\"bp\">.</span><span class=\"n\">Basic</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Aesop</span><span class=\"bp\">.</span><span class=\"n\">Forward</span><span class=\"bp\">.</span><span class=\"n\">LevelIndex</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Float</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Array</span><span class=\"bp\">.</span><span class=\"n\">Match</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">System</span><span class=\"bp\">.</span><span class=\"n\">IO</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Aesop</span><span class=\"bp\">.</span><span class=\"n\">Forward</span><span class=\"bp\">.</span><span class=\"n\">SlotIndex</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">FloatArray</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Aesop</span><span class=\"bp\">.</span><span class=\"n\">Forward</span><span class=\"bp\">.</span><span class=\"n\">PremiseIndex</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Array</span><span class=\"bp\">.</span><span class=\"n\">Init</span><span class=\"bp\">.</span><span class=\"n\">Lemmas</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">ArrayMap</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Control</span><span class=\"bp\">.</span><span class=\"n\">ForInStep</span><span class=\"bp\">.</span><span class=\"n\">Basic</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Plausible</span><span class=\"bp\">.</span><span class=\"n\">Random</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Control</span><span class=\"bp\">.</span><span class=\"n\">Lemmas</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Aesop</span><span class=\"bp\">.</span><span class=\"n\">Percent</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Util</span><span class=\"bp\">.</span><span class=\"n\">ExtendedBinder</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Control</span><span class=\"bp\">.</span><span class=\"n\">Lawful</span><span class=\"bp\">.</span><span class=\"n\">MonadLift</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 512689479,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744838315
    },
    {
        "content": "<p>It's returning <code>Init.Prelude</code>, which is surely wrong</p>",
        "id": 512689541,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1744838348
    },
    {
        "content": "<p>That's because we need another <code>match</code> branch.</p>",
        "id": 512689586,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744838365
    },
    {
        "content": "<p>Does <code>#find_home!</code> work?</p>",
        "id": 512689614,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1744838376
    },
    {
        "content": "<p>I'm on a very slow laptop right now, so it will take me a minute or two to test.</p>",
        "id": 512689716,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744838406
    },
    {
        "content": "<p>Looks like the same answer:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">[</span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">MLList</span><span class=\"bp\">.</span><span class=\"n\">Basic</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">String</span><span class=\"bp\">.</span><span class=\"n\">Basic</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Gcd</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">WF</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Aesop</span><span class=\"bp\">.</span><span class=\"n\">Nanos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">Init</span><span class=\"bp\">.</span><span class=\"n\">Lemmas</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Basic</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">ByteSubarray</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">EStateM</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Util</span><span class=\"bp\">.</span><span class=\"n\">Panic</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Stream</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">Process</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Init</span><span class=\"bp\">.</span><span class=\"n\">Prelude</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">BitVec</span><span class=\"bp\">.</span><span class=\"n\">Basic</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Aesop</span><span class=\"bp\">.</span><span class=\"n\">Forward</span><span class=\"bp\">.</span><span class=\"n\">LevelIndex</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Float</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Array</span><span class=\"bp\">.</span><span class=\"n\">Match</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">System</span><span class=\"bp\">.</span><span class=\"n\">IO</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Aesop</span><span class=\"bp\">.</span><span class=\"n\">Forward</span><span class=\"bp\">.</span><span class=\"n\">SlotIndex</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">FloatArray</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Aesop</span><span class=\"bp\">.</span><span class=\"n\">Forward</span><span class=\"bp\">.</span><span class=\"n\">PremiseIndex</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Array</span><span class=\"bp\">.</span><span class=\"n\">Init</span><span class=\"bp\">.</span><span class=\"n\">Lemmas</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">ArrayMap</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Control</span><span class=\"bp\">.</span><span class=\"n\">ForInStep</span><span class=\"bp\">.</span><span class=\"n\">Basic</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Plausible</span><span class=\"bp\">.</span><span class=\"n\">Random</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Control</span><span class=\"bp\">.</span><span class=\"n\">Lemmas</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Aesop</span><span class=\"bp\">.</span><span class=\"n\">Percent</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Util</span><span class=\"bp\">.</span><span class=\"n\">ExtendedBinder</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Control</span><span class=\"bp\">.</span><span class=\"n\">Lawful</span><span class=\"bp\">.</span><span class=\"n\">MonadLift</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 512689765,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744838422
    },
    {
        "content": "<p>I got</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">[</span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">QuadraticForm</span><span class=\"bp\">.</span><span class=\"n\">Real</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">InnerProductSpace</span><span class=\"bp\">.</span><span class=\"n\">Semisimple</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">RingTheory</span><span class=\"bp\">.</span><span class=\"n\">WittVector</span><span class=\"bp\">.</span><span class=\"n\">Compare</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">NumberTheory</span><span class=\"bp\">.</span><span class=\"n\">LegendreSymbol</span><span class=\"bp\">.</span><span class=\"n\">GaussEisensteinLemmas</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">StronglyMeasurable</span><span class=\"bp\">.</span><span class=\"n\">Lemmas</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">RingTheory</span><span class=\"bp\">.</span><span class=\"n\">Perfection</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">NumberTheory</span><span class=\"bp\">.</span><span class=\"n\">LSeries</span><span class=\"bp\">.</span><span class=\"n\">Basic</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Geometry</span><span class=\"bp\">.</span><span class=\"n\">Euclidean</span><span class=\"bp\">.</span><span class=\"n\">Sphere</span><span class=\"bp\">.</span><span class=\"n\">Power</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">RingTheory</span><span class=\"bp\">.</span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">Cyclotomic</span><span class=\"bp\">.</span><span class=\"n\">Basic</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">NumberTheory</span><span class=\"bp\">.</span><span class=\"n\">EulerProduct</span><span class=\"bp\">.</span><span class=\"n\">ExpLog</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">NumberTheory</span><span class=\"bp\">.</span><span class=\"n\">NumberField</span><span class=\"bp\">.</span><span class=\"n\">Discriminant</span><span class=\"bp\">.</span><span class=\"n\">Defs</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">NumberTheory</span><span class=\"bp\">.</span><span class=\"n\">Zsqrtd</span><span class=\"bp\">.</span><span class=\"n\">QuadraticReciprocity</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Calculus</span><span class=\"bp\">.</span><span class=\"n\">FDeriv</span><span class=\"bp\">.</span><span class=\"n\">Measurable</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">QuadraticForm</span><span class=\"bp\">.</span><span class=\"n\">Complex</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">FieldTheory</span><span class=\"bp\">.</span><span class=\"n\">Galois</span><span class=\"bp\">.</span><span class=\"n\">Profinite</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">PSeriesComplex</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Normed</span><span class=\"bp\">.</span><span class=\"n\">Lp</span><span class=\"bp\">.</span><span class=\"n\">PiLp</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Combinatorics</span><span class=\"bp\">.</span><span class=\"n\">SimpleGraph</span><span class=\"bp\">.</span><span class=\"n\">Regularity</span><span class=\"bp\">.</span><span class=\"n\">Bound</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Calculus</span><span class=\"bp\">.</span><span class=\"n\">LineDeriv</span><span class=\"bp\">.</span><span class=\"n\">QuadraticMap</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">NumberTheory</span><span class=\"bp\">.</span><span class=\"n\">Cyclotomic</span><span class=\"bp\">.</span><span class=\"n\">CyclotomicCharacter</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">Isometry</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">NumberTheory</span><span class=\"bp\">.</span><span class=\"n\">ClassNumber</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">UpperHalfPlane</span><span class=\"bp\">.</span><span class=\"n\">Basic</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 512689821,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1744838446
    },
    {
        "content": "<p>If this is true, then the answer is \"create a new file\".</p>",
        "id": 512689900,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744838485
    },
    {
        "content": "<p>You'll have a hard time convincing me that we need quadratic forms to get that proof working</p>",
        "id": 512689919,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744838496
    },
    {
        "content": "<p>But it would be nice to have <code>#find_home</code> fixed.</p>",
        "id": 512689940,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744838506
    },
    {
        "content": "<p>It's possible that nothing before one of these files has both <code>Equiv.Perm.sign</code> and <code>List.formPerm</code> in the context.</p>",
        "id": 512690081,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744838549
    },
    {
        "content": "<p>I am confused now - surely <code>List.formPerm_sign.match_1</code> cannot live in <code>Init.Prelude</code>, because it uses <code>List.Nodup</code> defined in <code>Init.Data.List.Basic</code></p>",
        "id": 512690272,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1744838634
    },
    {
        "content": "<p>This proves that there is a bug in <code>#find_home</code>. Let's wait for Kim.</p>",
        "id": 512690433,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744838697
    },
    {
        "content": "<p><code>#find_home!</code> is usually much better than <code>#find_home</code> (although in this specific case all its suggestions are too advanced, but it's probably because there is no suitable file)</p>",
        "id": 512690975,
        "sender_full_name": "SÃ©bastien GouÃ«zel",
        "timestamp": 1744838924
    },
    {
        "content": "<p>Sorry, I don't think I'm any better equipped to fix it than anyone here. :-) I'm trying to be busy with grind and proposals today!</p>",
        "id": 512716627,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1744853478
    },
    {
        "content": "<p>I have also observed some unexpected behaviour in <code>#find_home</code>, but never managed to get a convincing example of something that was clearly a bug.</p>",
        "id": 512719502,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1744855334
    },
    {
        "content": "<p>However, I am also hard-pressed for Lean time this week, so I won't be able to look at this soon.</p>",
        "id": 512719541,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1744855368
    },
    {
        "content": "<p>In case someone wants to look at this, I have a suspicion that <code>#find_home</code> deals improperly with imports across repositories (or maybe simply imports that are not in mathlib).</p>",
        "id": 512720687,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1744855951
    },
    {
        "content": "<p>My file was in <code>Mathlib</code>.</p>",
        "id": 512732552,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744863098
    },
    {
        "content": "<p>I've created a file <code>Mathlib/tmp.lean</code>, and put the code above there.</p>",
        "id": 512732577,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744863120
    },
    {
        "content": "<p>What I meant is that I suspect that when the computed upper bounds range between different repositories, there might be issues.  But I've never isolated an actual problem, so I really don't know.</p>",
        "id": 512745257,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1744869896
    },
    {
        "content": "<p>Could <code>#find_home</code> take multiple arguments? Instead of passing the full declaration (with complete proof) to <code>#find_home</code>, I usually only pass a few key decls used in the proof or statement in the following format: <a class=\"message-link\" href=\"/#narrow/channel/217875-Is-there-code-for-X.3F/topic/.E2.9C.94.20file.20importing.20DirectSum.20and.20ker/near/504234213\">#Is there code for X? &gt; âœ” file importing DirectSum and ker @ ðŸ’¬</a> <br>\nto avoid issues like picking up unwanted instances in too advanced files. It would be more convenient if I could pass multiple decls directly rather than manually wrapping them in the same decl.</p>",
        "id": 515420041,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1746057612
    },
    {
        "content": "<p>That should be easy to do, but I'm not sure when I'll have the time to look at it.</p>",
        "id": 515435857,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1746067723
    }
]