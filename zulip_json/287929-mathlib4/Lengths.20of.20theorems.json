[
    {
        "content": "<p>I wrote a script to count the number of lines of theorems and defs in Mathlib.</p>\n<p>The current longest theorem is 213 lines in <code>engel_isBot_of_isMin</code> in <a href=\"https://github.com/leanprover-community/mathlib4/blob/d19cd93f3db24ca3a2ab957c266dd7e1ce2110fa/Mathlib/Algebra/Lie/CartanExists.lean#L130\">Mathlib/Algebra/Lie/CartanExists.lean#L130</a>.</p>",
        "id": 528175143,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752191355
    },
    {
        "content": "<p>Python script:</p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"c1\"># Put me in a folder in mathlib4</span>\n<span class=\"c1\"># Add that folder to .git/info/exclude</span>\n\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">os</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">re</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">sys</span>\n\n<span class=\"n\">freq</span> <span class=\"o\">=</span> <span class=\"nb\">dict</span><span class=\"p\">()</span>\n<span class=\"n\">longestTen</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"n\">warn</span> <span class=\"o\">=</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s2\">\"line-count-warnings.txt\"</span><span class=\"p\">,</span> <span class=\"s2\">\"w\"</span><span class=\"p\">)</span>\n\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">record</span><span class=\"p\">(</span><span class=\"n\">filename</span><span class=\"p\">,</span> <span class=\"n\">start</span><span class=\"p\">,</span> <span class=\"n\">count</span><span class=\"p\">):</span>\n    <span class=\"k\">global</span> <span class=\"n\">freq</span><span class=\"p\">,</span> <span class=\"n\">longestTen</span>\n    <span class=\"k\">if</span> <span class=\"n\">count</span> <span class=\"ow\">in</span> <span class=\"n\">freq</span><span class=\"p\">:</span>\n        <span class=\"n\">freq</span><span class=\"p\">[</span><span class=\"n\">count</span><span class=\"p\">]</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"n\">freq</span><span class=\"p\">[</span><span class=\"n\">count</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mi\">1</span>\n    <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">longestTen</span> <span class=\"ow\">or</span> <span class=\"n\">longestTen</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">][</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">&lt;</span> <span class=\"n\">count</span><span class=\"p\">:</span>\n        <span class=\"n\">longestTen</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">((</span><span class=\"n\">count</span><span class=\"p\">,</span><span class=\"n\">filename</span><span class=\"p\">,</span><span class=\"n\">start</span><span class=\"p\">))</span>\n        <span class=\"n\">longestTen</span><span class=\"o\">.</span><span class=\"n\">sort</span><span class=\"p\">(</span><span class=\"n\">key</span><span class=\"o\">=</span><span class=\"k\">lambda</span> <span class=\"n\">t</span><span class=\"p\">:</span><span class=\"n\">t</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n        <span class=\"n\">longestTen</span> <span class=\"o\">=</span> <span class=\"n\">longestTen</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">10</span><span class=\"p\">:]</span>\n\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">process</span><span class=\"p\">(</span><span class=\"n\">filename</span><span class=\"p\">,</span> <span class=\"n\">file</span><span class=\"p\">):</span>\n    <span class=\"k\">global</span> <span class=\"n\">warn</span>\n    <span class=\"n\">i</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n    <span class=\"n\">lineCount</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n    <span class=\"n\">start</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n    <span class=\"n\">state</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n    <span class=\"k\">for</span> <span class=\"n\">line</span> <span class=\"ow\">in</span> <span class=\"n\">file</span><span class=\"o\">.</span><span class=\"n\">split</span><span class=\"p\">(</span><span class=\"s2\">\"</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span><span class=\"p\">):</span>\n        <span class=\"n\">i</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n        <span class=\"k\">if</span> <span class=\"n\">line</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">:]</span> <span class=\"o\">==</span> <span class=\"s2\">\"--\"</span><span class=\"p\">:</span>\n            <span class=\"k\">pass</span>\n        <span class=\"k\">elif</span> <span class=\"n\">state</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">:</span> <span class=\"c1\"># Outside</span>\n            <span class=\"k\">if</span> <span class=\"n\">re</span><span class=\"o\">.</span><span class=\"n\">search</span><span class=\"p\">(</span><span class=\"s2\">\":=( (by|calc))?$\"</span><span class=\"p\">,</span> <span class=\"n\">line</span><span class=\"p\">):</span>\n                <span class=\"n\">state</span> <span class=\"o\">=</span> <span class=\"mi\">1</span>\n                <span class=\"n\">lineCount</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n                <span class=\"n\">start</span> <span class=\"o\">=</span> <span class=\"n\">i</span>\n        <span class=\"k\">elif</span> <span class=\"n\">state</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">:</span> <span class=\"c1\"># Inside theorem/def</span>\n            <span class=\"k\">if</span> <span class=\"n\">line</span><span class=\"p\">[:</span><span class=\"mi\">2</span><span class=\"p\">]</span> <span class=\"o\">==</span> <span class=\"s2\">\"  \"</span><span class=\"p\">:</span>\n                <span class=\"n\">lineCount</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n            <span class=\"k\">else</span><span class=\"p\">:</span> <span class=\"c1\"># theorem/def ended</span>\n                <span class=\"n\">record</span><span class=\"p\">(</span><span class=\"n\">filename</span><span class=\"p\">,</span> <span class=\"n\">start</span><span class=\"p\">,</span> <span class=\"n\">lineCount</span><span class=\"p\">)</span>\n                <span class=\"n\">lineCount</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n                <span class=\"k\">if</span> <span class=\"n\">line</span> <span class=\"o\">!=</span> <span class=\"s2\">\"\"</span><span class=\"p\">:</span>\n                    <span class=\"n\">warn</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">(</span><span class=\"s2\">\"</span><span class=\"si\">%d</span><span class=\"s2\"> </span><span class=\"si\">%s</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span><span class=\"o\">%</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">,</span><span class=\"n\">filename</span><span class=\"p\">))</span> <span class=\"c1\"># Warning: theorem/def ended but not newline</span>\n                <span class=\"n\">state</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n\n\n<span class=\"n\">fileCount</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n<span class=\"k\">for</span> <span class=\"n\">root</span><span class=\"p\">,</span> <span class=\"n\">dirs</span><span class=\"p\">,</span> <span class=\"n\">files</span> <span class=\"ow\">in</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">walk</span><span class=\"p\">(</span><span class=\"s1\">'../Mathlib'</span><span class=\"p\">):</span>\n    <span class=\"k\">for</span> <span class=\"n\">file</span> <span class=\"ow\">in</span> <span class=\"n\">files</span><span class=\"p\">:</span>\n        <span class=\"n\">filename</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">root</span><span class=\"p\">,</span> <span class=\"n\">file</span><span class=\"p\">)</span>\n        <span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"n\">filename</span><span class=\"p\">,</span> <span class=\"s2\">\"r\"</span><span class=\"p\">,</span> <span class=\"n\">encoding</span><span class=\"o\">=</span><span class=\"s2\">\"UTF-8\"</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">auto</span><span class=\"p\">:</span>\n            <span class=\"n\">fileCount</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n            <span class=\"k\">if</span> <span class=\"n\">fileCount</span> <span class=\"o\">%</span> <span class=\"mi\">100</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">stdout</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">(</span><span class=\"s2\">\"</span><span class=\"se\">\\r</span><span class=\"si\">%d</span><span class=\"s2\"> files processed.\"</span><span class=\"o\">%</span><span class=\"n\">fileCount</span><span class=\"p\">)</span>\n                <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">stdout</span><span class=\"o\">.</span><span class=\"n\">flush</span><span class=\"p\">()</span>\n            <span class=\"n\">process</span><span class=\"p\">(</span><span class=\"n\">filename</span><span class=\"p\">,</span> <span class=\"n\">auto</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">())</span>\n\n<span class=\"n\">warn</span><span class=\"o\">.</span><span class=\"n\">close</span><span class=\"p\">()</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"</span><span class=\"se\">\\r</span><span class=\"si\">%d</span><span class=\"s2\"> files processed.\"</span> <span class=\"o\">%</span> <span class=\"n\">fileCount</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"</span><span class=\"si\">%d</span><span class=\"s2\"> theorems/defs processed.\"</span> <span class=\"o\">%</span> <span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">freq</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">freq</span><span class=\"p\">))</span>\n<span class=\"nb\">print</span><span class=\"p\">()</span>\n\n<span class=\"n\">keys</span> <span class=\"o\">=</span> <span class=\"n\">freq</span><span class=\"o\">.</span><span class=\"n\">keys</span><span class=\"p\">()</span>\n<span class=\"n\">maxKeys</span> <span class=\"o\">=</span> <span class=\"nb\">max</span><span class=\"p\">(</span><span class=\"n\">keys</span><span class=\"p\">)</span> <span class=\"c1\"># What if `keys` is empty?</span>\n<span class=\"n\">log10</span> <span class=\"o\">=</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">maxKeys</span><span class=\"p\">))</span>\n\n<span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">maxKeys</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">):</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"</span><span class=\"si\">%s</span><span class=\"s2\">: </span><span class=\"si\">%d</span><span class=\"s2\">\"</span><span class=\"o\">%</span><span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">rjust</span><span class=\"p\">(</span><span class=\"n\">log10</span><span class=\"p\">,</span><span class=\"s2\">\" \"</span><span class=\"p\">),</span> <span class=\"n\">freq</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">,</span><span class=\"mi\">0</span><span class=\"p\">)))</span>\n<span class=\"nb\">print</span><span class=\"p\">()</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Longest ten theorems/defs:\"</span><span class=\"p\">)</span>\n<span class=\"k\">for</span> <span class=\"n\">t</span> <span class=\"ow\">in</span> <span class=\"n\">longestTen</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"</span><span class=\"si\">%d</span><span class=\"s2\"> lines: Line </span><span class=\"si\">%d</span><span class=\"s2\"> in </span><span class=\"si\">%s</span><span class=\"s2\">\"</span><span class=\"o\">%</span><span class=\"p\">(</span><span class=\"n\">t</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">t</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">],</span> <span class=\"n\">t</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]))</span>\n</code></pre></div>",
        "id": 528175167,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752191368
    },
    {
        "content": "<p>Output:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>6607 files processed.\n166886 theorems/defs processed.\n\n  0: 187\n  1: 96891\n  2: 20776\n  3: 12312\n  4: 7433\n  5: 5690\n  6: 3957\n  7: 3273\n  8: 2466\n  9: 1881\n 10: 1636\n 11: 1352\n 12: 1103\n 13: 936\n 14: 787\n 15: 669\n 16: 571\n 17: 546\n 18: 454\n 19: 364\n 20: 319\n 21: 306\n 22: 252\n 23: 223\n 24: 206\n 25: 183\n 26: 169\n 27: 148\n 28: 152\n 29: 134\n 30: 126\n 31: 100\n 32: 86\n 33: 76\n 34: 56\n 35: 63\n 36: 65\n 37: 52\n 38: 38\n 39: 58\n 40: 50\n 41: 40\n 42: 39\n 43: 45\n 44: 35\n 45: 25\n 46: 30\n 47: 34\n 48: 34\n 49: 18\n 50: 18\n 51: 20\n 52: 16\n 53: 14\n 54: 9\n 55: 11\n 56: 12\n 57: 7\n 58: 10\n 59: 18\n 60: 9\n 61: 12\n 62: 12\n 63: 10\n 64: 12\n 65: 12\n 66: 8\n 67: 14\n 68: 9\n 69: 13\n 70: 8\n 71: 13\n 72: 5\n 73: 4\n 74: 10\n 75: 5\n 76: 4\n 77: 5\n 78: 3\n 79: 3\n 80: 5\n 81: 6\n 82: 5\n 83: 6\n 84: 3\n 85: 3\n 86: 4\n 87: 6\n 88: 3\n 89: 4\n 90: 3\n 91: 3\n 92: 5\n 93: 2\n 94: 3\n 95: 3\n 96: 1\n 97: 1\n 98: 3\n 99: 3\n100: 6\n101: 6\n102: 1\n103: 4\n104: 0\n105: 0\n106: 1\n107: 3\n108: 2\n109: 0\n110: 2\n111: 0\n112: 0\n113: 2\n114: 1\n115: 1\n116: 1\n117: 0\n118: 1\n119: 0\n120: 2\n121: 2\n122: 1\n123: 0\n124: 1\n125: 2\n126: 0\n127: 4\n128: 1\n129: 1\n130: 0\n131: 0\n132: 0\n133: 2\n134: 0\n135: 1\n136: 0\n137: 0\n138: 1\n139: 0\n140: 0\n141: 1\n142: 2\n143: 0\n144: 0\n145: 0\n146: 0\n147: 0\n148: 2\n149: 1\n150: 1\n151: 1\n152: 0\n153: 0\n154: 1\n155: 0\n156: 0\n157: 1\n158: 0\n159: 1\n160: 0\n161: 0\n162: 0\n163: 0\n164: 0\n165: 0\n166: 0\n167: 0\n168: 0\n169: 0\n170: 0\n171: 0\n172: 0\n173: 0\n174: 0\n175: 0\n176: 0\n177: 0\n178: 0\n179: 0\n180: 0\n181: 1\n182: 0\n183: 0\n184: 0\n185: 0\n186: 0\n187: 0\n188: 0\n189: 0\n190: 0\n191: 0\n192: 0\n193: 0\n194: 0\n195: 0\n196: 0\n197: 0\n198: 0\n199: 0\n200: 0\n201: 0\n202: 0\n203: 0\n204: 0\n205: 0\n206: 0\n207: 0\n208: 0\n209: 0\n210: 0\n211: 0\n212: 0\n213: 1\n</code></pre></div>",
        "id": 528175208,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752191404
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>Longest ten theorems/defs:\n148 lines: Line 250 in ../Mathlib\\MeasureTheory\\Covering\\Vitali.lean\n148 lines: Line 673 in ../Mathlib\\SetTheory\\Game\\Basic.lean\n149 lines: Line 174 in ../Mathlib\\MeasureTheory\\Integral\\RieszMarkovKakutani\\Real.lean\n150 lines: Line 30 in ../Mathlib\\Analysis\\SpecificLimits\\FloorPow.lean\n151 lines: Line 745 in ../Mathlib\\Topology\\MetricSpace\\GromovHausdorff.lean\n154 lines: Line 157 in ../Mathlib\\CategoryTheory\\Limits\\FilteredColimitCommutesFiniteLimit.lean\n157 lines: Line 435 in ../Mathlib\\Algebra\\Lie\\Weights\\RootSystem.lean\n159 lines: Line 859 in ../Mathlib\\MeasureTheory\\Covering\\Besicovitch.lean\n181 lines: Line 196 in ../Mathlib\\MeasureTheory\\Integral\\Layercake.lean\n213 lines: Line 130 in ../Mathlib\\Algebra\\Lie\\CartanExists.lean\n</code></pre></div>",
        "id": 528175233,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752191419
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span></p>",
        "id": 528175439,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752191560
    },
    {
        "content": "<p>so 58.1% of the theorems are one-liners</p>",
        "id": 528175503,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752191602
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>N = 166886\nmean = 3.29553\nstdev = 6.13141\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"n\">N</span> <span class=\"o\">=</span> <span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">freq</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">keys</span><span class=\"p\">)</span>\n<span class=\"n\">E</span> <span class=\"o\">=</span> <span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"o\">*</span><span class=\"n\">freq</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">keys</span><span class=\"p\">)</span><span class=\"o\">/</span><span class=\"n\">N</span>\n<span class=\"n\">E2</span> <span class=\"o\">=</span> <span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"o\">*</span><span class=\"n\">i</span><span class=\"o\">*</span><span class=\"n\">freq</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">keys</span><span class=\"p\">)</span><span class=\"o\">/</span><span class=\"n\">N</span>\n<span class=\"n\">s</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">E2</span><span class=\"o\">-</span><span class=\"n\">E</span><span class=\"o\">*</span><span class=\"n\">E</span><span class=\"p\">)</span><span class=\"o\">**</span><span class=\"mf\">.5</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"N = </span><span class=\"si\">%d</span><span class=\"s2\">\"</span><span class=\"o\">%</span><span class=\"n\">N</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"mean = </span><span class=\"si\">%.5f</span><span class=\"s2\">\"</span><span class=\"o\">%</span><span class=\"n\">E</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"stdev = </span><span class=\"si\">%.5f</span><span class=\"s2\">\"</span><span class=\"o\">%</span><span class=\"n\">s</span><span class=\"p\">)</span>\n</code></pre></div>",
        "id": 528175852,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752191820
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/eELJ0O8WxFx9MaInfaHzs4Sz/image.png\">The frequency data, on a log scale</a>, and the <a href=\"https://docs.google.com/spreadsheets/d/1F4VHd3g7epMuYoZOPWFekV0XzArjZ_cmRWVGEB0stMQ/edit?gid=2119182114#gid=2119182114\">sheet to compute it</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/eELJ0O8WxFx9MaInfaHzs4Sz/image.png\" title=\"The frequency data, on a log scale\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"594x354\" src=\"/user_uploads/thumbnail/3121/eELJ0O8WxFx9MaInfaHzs4Sz/image.png/840x560.webp\"></a></div>",
        "id": 528176445,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1752192247
    },
    {
        "content": "<p>I have already seen this list, but I can't find the topic...</p>",
        "id": 528185439,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752200030
    },
    {
        "content": "<p>I had not posted it maybe, but this is what I had:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">Elab</span><span class=\"w\"> </span><span class=\"n\">Command</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">info: (424, 1) #[Lean.Language.Lean.process]</span>\n<span class=\"sd\">(354, 1) #[Lean.Compiler.LCNF.ToLCNF.toLCNF]</span>\n<span class=\"sd\">(311, 1) #[Mathlib.Linter.DirectoryDependency.forbiddenImportDirs]</span>\n<span class=\"sd\">(273, 1) #[Lean.Elab.Tactic.BVDecide.Frontend.ReifiedBVExpr.of]</span>\n<span class=\"sd\">(271, 1) #[Lean.Parser.Tactic.grind]</span>\n<span class=\"sd\">(266, 1) #[Std.Tactic.BVDecide.LRAT.Internal.DefaultFormula.insertUnitInvariant_insertUnit]</span>\n<span class=\"sd\">(241, 2) #[_aux_Init_Data_UInt_Lemmas___macroRules_commandDeclare_uint_theorems___1, commandDeclare_uint_theorems__]</span>\n<span class=\"sd\">(240, 1) #[Lean.Tactic.FunInd.deriveInductionStructural]</span>\n<span class=\"sd\">(227, 1) #[Lean.Tactic.FunInd.deriveInductionStructural.doRealize]</span>\n<span class=\"sd\">(222, 2) #[LieAlgebra.engel_isBot_of_isMin, _private.Lean.Meta.Match.MatchEqs.0.Lean.Meta.Match.mkSplitterProof]</span>\n<span class=\"sd\">(219, 2) #[Lean.Expr, Lean.Expr.data]</span>\n<span class=\"sd\">(215, 1) #[Lean.Elab.Tactic.Omega.asLinearComboImpl]</span>\n<span class=\"sd\">(214, 1) #[ToAdditive.to_additive]</span>\n<span class=\"sd\">(208, 1) #[Std.Tactic.BVDecide.BVExpr.bitblast.go_denote_eq]</span>\n<span class=\"sd\">(207, 1) #[Std.Tactic.BVDecide.LRAT.Internal.DefaultFormula.confirmRupHint_preserves_invariant_helper]</span>\n<span class=\"sd\">(206, 1) #[Lean.Elab.Term.CollectPatternVars.collect]</span>\n<span class=\"sd\">(201, 1) #[Lean.Elab.Tactic.ElimApp.evalAlts]</span>\n<span class=\"sd\">(199, 1) #[Lean.Meta.Simp.simpHaveTelescope]</span>\n<span class=\"sd\">(198, 1) #[Vitali.exists_disjoint_covering_ae]</span>\n<span class=\"sd\">(196, 1) #[MeasureTheory.lintegral_comp_eq_lintegral_meas_le_mul_of_measurable]</span>\n<span class=\"sd\">(194, 1) #[Lean.Language.Lean.process.parseCmd]</span>\n<span class=\"sd\">(193, 1) #[Lean.Server.Test.Runner.main]</span>\n<span class=\"sd\">(192, 1) #[Mathlib.Tactic.Monoidal.instMkEvalHorizontalCompMonoidalM]</span>\n<span class=\"sd\">(189, 1) #[Lean.Meta.mkRichHCongr]</span>\n<span class=\"sd\">(188, 2) #[Std.Tactic.BVDecide.BVExpr.bitblast, _private.Lean.Elab.Quotation.0.Lean.Elab.Term.Quotation.getHeadInfo]</span>\n<span class=\"sd\">(176, 2) #[Mathlib.Notation3._aux_Mathlib_Util_Notation3___elabRules_Mathlib_Notation3_notation3_1, Mathlib.Notation3.notation3]</span>\n<span class=\"sd\">(174, 1) #[Std.Tactic.BVDecide.BVExpr.bitblast.go]</span>\n<span class=\"sd\">(171, 1) #[Lean.Meta.MatcherApp.transform]</span>\n<span class=\"sd\">(169, 1) #[Lean.Elab.Term.elabMutualDef]</span>\n<span class=\"sd\">(167, 2) #[Besicovitch.exists_closedBall_covering_tsum_measure_le, Lean.Meta.IndPredBelow.mkBelowMatcher]</span>\n<span class=\"sd\">(166, 1) #[Lean.Meta.Hint.readableDiff]</span>\n<span class=\"sd\">(164, 1) #[Lean.resolveLocalName]</span>\n<span class=\"sd\">(162, 2) #[Lean.IR.ToIR.lowerLet, Mathlib.Tactic.CC.CCM.addEqvStep]</span>\n<span class=\"sd\">(161, 2) #[Lean.Elab.Tactic.BVDecide.Frontend.ReifiedBVExpr.of.go, LieAlgebra.IsKilling.eq_top_of_invtSubmodule_ne_bot]</span>\n<span class=\"sd\">(160, 3) #[GromovHausdorff.totallyBounded, Lean.Elab.Term.toParserDescr, Lean.Meta.Grind.Arith.Linear.getStructId?]</span>\n<span class=\"sd\">(159, 1) #[CategoryTheory.Limits.colimitLimitToLimitColimit_surjective]</span>\n<span class=\"sd\">(157, 1) #[tendsto_div_of_monotone_of_exists_subseq_tendsto_div]</span>\n<span class=\"sd\">(156, 1) #[Mathlib.Tactic.Monoidal.instMonadMor₂MonoidalM]</span>\n<span class=\"sd\">(154, 2) #[Lean.Tactic.FunInd.buildInductionBody, Lean.Tactic.FunInd.foldAndCollect]</span>\n<span class=\"sd\">(153, 1) #[Mathlib.Tactic.Bicategory.instMonadMor₂BicategoryM]</span>\n<span class=\"sd\">(152, 3) #[Lean.Elab.PartialFixpoint.deriveInduction, Mathlib.Tactic.TermCongr.mkCongrOf, _private.Mathlib.MeasureTheory.Integral.RieszMarkovKakutani.Real.0.RealRMK.integral_riesz_aux]</span>\n<span class=\"sd\">(151, 3) #[Aesop.addRappUnsafe, Std.Time.Modifier, _private.Mathlib.RingTheory.Spectrum.Prime.ChevalleyComplexity.0.ChevalleyThm.PolynomialC.induction_aux]</span>\n<span class=\"sd\">(150, 3) #[Lean.Elab.Tactic.BVDecide.Frontend.Normalize.isSupportedMatch, Lean.Meta.Grind.Arith.Linear.getStructId?.go?, Lean.Meta.addPPExplicitToExposeDiff]</span>\n<span class=\"sd\">(149, 2) #[Lean.Meta.ACLt.main, SetTheory.PGame.quot_mul_assoc]</span>\n<span class=\"sd\">(148, 1) #[MeasureTheory.measurableSet_range_of_continuous_injective]</span>\n<span class=\"sd\">(147, 4)</span>\n<span class=\"sd\">(146, 1) #[AkraBazziRecurrence.smoothingFn_mul_asympBound_isBigO_T]</span>\n<span class=\"sd\">(145, 1) #[Lean.Compiler.LCNF.Simp.simpJpCases?]</span>\n<span class=\"sd\">(144, 2) #[Lean.Elab.partialFixpoint, VitaliFamily.exists_measurable_supersets_limRatio]</span>\n<span class=\"sd\">(143, 3) #[Lean.PrettyPrinter.Delaborator.TopDownAnalyze.analyzeAppStagedCore, Lean.Server.FileWorker.locationLinksOfInfo, eVariationOn.add_point]</span>\n<span class=\"sd\">(142, 1) #[Besicovitch.exists_disjoint_closedBall_covering_ae_of_finiteMeasure_aux]</span>\n<span class=\"sd\">(140, 2) #[AlgebraicGeometry.Proj.valuativeCriterion_existence_aux, Mathlib.Tactic.ITauto.applyProof]</span>\n<span class=\"sd\">(138, 2) #[GromovHausdorff.hausdorffDist_optimal, MeasureTheory.hasFDerivAt_convolution_right_with_param]</span>\n<span class=\"sd\">(137, 1) #[exists_closed_cover_approximatesLinearOn_of_hasFDerivWithinAt]</span>\n<span class=\"sd\">(136, 3) #[ApproximatesLinearOn.surjOn_closedBall_of_nonlinearRightInverse, FDerivMeasurableAux.D_subset_differentiable_set, Lean.Meta.Simp.Config]</span>\n<span class=\"sd\">(135, 4)</span>\n<span class=\"sd\">(134, 1) #[MultilinearMap.map_sum_finset_aux]</span>\n<span class=\"sd\">(132, 4)</span>\n<span class=\"sd\">(131, 2) #[Lean.Compiler.LCNF.Simp.simp, Submodule.basis_of_pid_aux]</span>\n<span class=\"sd\">(130, 2) #[ContMDiffWithinAt.mfderivWithin, Mathlib.Tactic.Bicategory.instMkEvalWhiskerRightBicategoryM]</span>\n<span class=\"sd\">(129, 3) #[Aesop.Options, Besicovitch.exist_finset_disjoint_balls_large_measure, Mathlib.Tactic.CC.CCM.addEqvStep.go]</span>\n<span class=\"sd\">(128, 3) #[AddCircle.addWellApproximable_ae_empty_or_univ, MeasureTheory.hahn_decomposition, _private.Lean.Elab.Inductive.0.Lean.Elab.Command.elabCtors]</span>\n<span class=\"sd\">(127, 2) #[Mathlib.Tactic.Bicategory.instMonadNormalizeNaturalityBicategoryM, _private.Lean.Data.FuzzyMatching.0.Lean.FuzzyMatching.fuzzyMatchCore]</span>\n<span class=\"sd\">(126, 6)</span>\n<span class=\"sd\">(125, 2) #[EMetric.instParacompactSpace, Lean.Meta.Simp.simpHaveTelescope.simpHaveTelescopeAux]</span>\n<span class=\"sd\">(124, 1) #[_private.Mathlib.RingTheory.Spectrum.Prime.ChevalleyComplexity.0.ChevalleyThm.PolynomialC.statement]</span>\n<span class=\"sd\">(123, 1) #[Std.Tactic.BVDecide.LRAT.Internal.DefaultFormula.assignmentsInvariant_insertRupUnits_of_assignmentsInvariant]</span>\n<span class=\"sd\">(122, 5)</span>\n<span class=\"sd\">(121, 2) #[Lean.Elab.Tactic.BVDecide.Frontend.Normalize.intToBitVecPass, Lean.Parser.Command.variable]</span>\n<span class=\"sd\">(120, 2) #[MeasureTheory.eLpNorm_le_eLpNorm_fderiv_of_eq_inner, _private.Lean.Server.FileWorker.0.Lean.Server.FileWorker.reportSnapshots]</span>\n<span class=\"sd\">(119, 6)</span>\n<span class=\"sd\">(118, 2) #[Besicovitch.TauPackage.color_lt, _private.Std.Time.Format.Basic.0.Std.Time.formatWith]</span>\n<span class=\"sd\">(117, 4)</span>\n<span class=\"sd\">(116, 4)</span>\n<span class=\"sd\">(115, 4)</span>\n<span class=\"sd\">(114, 3) #[Lean.Meta.Simp.tryAutoCongrTheorem?, Lean.Parser.Command.open, _private.Mathlib.Combinatorics.SimpleGraph.Tutte.0.SimpleGraph.tutte_exists_isPerfectMatching_of_near_matchings]</span>\n<span class=\"sd\">(113, 11)</span>\n<span class=\"sd\">(112, 4)</span>\n<span class=\"sd\">(111, 4)</span>\n<span class=\"sd\">(110, 3) #[Lean.Elab.Term.elabLetDeclAux, Lean.Tactic.FunInd.deriveUnaryInduction, _private.Std.Time.Format.Basic.0.Std.Time.parseWith]</span>\n<span class=\"sd\">(109, 4)</span>\n<span class=\"sd\">(108, 5)</span>\n<span class=\"sd\">(107, 2) #[Lean.Meta.unifyEq?, MeasureTheory.GridLines.T_insert_le_T_lmarginal_singleton]</span>\n<span class=\"sd\">(106, 7)</span>\n<span class=\"sd\">(105, 4)</span>\n<span class=\"sd\">(104, 10)</span>\n<span class=\"sd\">(103, 6)</span>\n<span class=\"sd\">(102, 4)</span>\n<span class=\"sd\">(101, 6)</span>\n<span class=\"sd\">(100, 5)</span>\n<span class=\"sd\">(99, 7)</span>\n<span class=\"sd\">(98, 6)</span>\n<span class=\"sd\">(97, 4)</span>\n<span class=\"sd\">(96, 11)</span>\n<span class=\"sd\">(95, 8)</span>\n<span class=\"sd\">(94, 6)</span>\n<span class=\"sd\">(93, 4)</span>\n<span class=\"sd\">(92, 8)</span>\n<span class=\"sd\">(91, 7)</span>\n<span class=\"sd\">(90, 10)</span>\n<span class=\"sd\">(89, 8)</span>\n<span class=\"sd\">(88, 17)</span>\n<span class=\"sd\">(87, 4)</span>\n<span class=\"sd\">(86, 9)</span>\n<span class=\"sd\">(85, 10)</span>\n<span class=\"sd\">(84, 8)</span>\n<span class=\"sd\">(83, 14)</span>\n<span class=\"sd\">(82, 12)</span>\n<span class=\"sd\">(81, 11)</span>\n<span class=\"sd\">(80, 13)</span>\n<span class=\"sd\">(79, 14)</span>\n<span class=\"sd\">(78, 15)</span>\n<span class=\"sd\">(77, 15)</span>\n<span class=\"sd\">(76, 22)</span>\n<span class=\"sd\">(75, 23)</span>\n<span class=\"sd\">(74, 14)</span>\n<span class=\"sd\">(73, 20)</span>\n<span class=\"sd\">(72, 26)</span>\n<span class=\"sd\">(71, 24)</span>\n<span class=\"sd\">(70, 27)</span>\n<span class=\"sd\">(69, 22)</span>\n<span class=\"sd\">(68, 20)</span>\n<span class=\"sd\">(67, 25)</span>\n<span class=\"sd\">(66, 21)</span>\n<span class=\"sd\">(65, 36)</span>\n<span class=\"sd\">(64, 27)</span>\n<span class=\"sd\">(63, 26)</span>\n<span class=\"sd\">(62, 33)</span>\n<span class=\"sd\">(61, 27)</span>\n<span class=\"sd\">(60, 31)</span>\n<span class=\"sd\">(59, 34)</span>\n<span class=\"sd\">(58, 39)</span>\n<span class=\"sd\">(57, 34)</span>\n<span class=\"sd\">(56, 29)</span>\n<span class=\"sd\">(55, 44)</span>\n<span class=\"sd\">(54, 40)</span>\n<span class=\"sd\">(53, 43)</span>\n<span class=\"sd\">(52, 51)</span>\n<span class=\"sd\">(51, 51)</span>\n<span class=\"sd\">(50, 62)</span>\n<span class=\"sd\">(49, 65)</span>\n<span class=\"sd\">(48, 87)</span>\n<span class=\"sd\">(47, 71)</span>\n<span class=\"sd\">(46, 84)</span>\n<span class=\"sd\">(45, 103)</span>\n<span class=\"sd\">(44, 79)</span>\n<span class=\"sd\">(43, 97)</span>\n<span class=\"sd\">(42, 102)</span>\n<span class=\"sd\">(41, 114)</span>\n<span class=\"sd\">(40, 124)</span>\n<span class=\"sd\">(39, 148)</span>\n<span class=\"sd\">(38, 149)</span>\n<span class=\"sd\">(37, 157)</span>\n<span class=\"sd\">(36, 183)</span>\n<span class=\"sd\">(35, 193)</span>\n<span class=\"sd\">(34, 207)</span>\n<span class=\"sd\">(33, 242)</span>\n<span class=\"sd\">(32, 275)</span>\n<span class=\"sd\">(31, 294)</span>\n<span class=\"sd\">(30, 280)</span>\n<span class=\"sd\">(29, 352)</span>\n<span class=\"sd\">(28, 369)</span>\n<span class=\"sd\">(27, 428)</span>\n<span class=\"sd\">(26, 428)</span>\n<span class=\"sd\">(25, 502)</span>\n<span class=\"sd\">(24, 576)</span>\n<span class=\"sd\">(23, 662)</span>\n<span class=\"sd\">(22, 716)</span>\n<span class=\"sd\">(21, 820)</span>\n<span class=\"sd\">(20, 955)</span>\n<span class=\"sd\">(19, 1101)</span>\n<span class=\"sd\">(18, 1270)</span>\n<span class=\"sd\">(17, 1537)</span>\n<span class=\"sd\">(16, 1724)</span>\n<span class=\"sd\">(15, 2030)</span>\n<span class=\"sd\">(14, 2362)</span>\n<span class=\"sd\">(13, 2964)</span>\n<span class=\"sd\">(12, 3516)</span>\n<span class=\"sd\">(11, 4406)</span>\n<span class=\"sd\">(10, 5364)</span>\n<span class=\"sd\">(9, 6915)</span>\n<span class=\"sd\">(8, 9206)</span>\n<span class=\"sd\">(7, 12304)</span>\n<span class=\"sd\">(6, 16900)</span>\n<span class=\"sd\">(5, 24863)</span>\n<span class=\"sd\">(4, 41164)</span>\n<span class=\"sd\">(3, 65002)</span>\n<span class=\"sd\">(2, 56790)</span>\n<span class=\"sd\">(1, 76074)</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"n\">run_cmd</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">getEnv</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">csts</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"bp\">.</span><span class=\"n\">constants</span><span class=\"bp\">.</span><span class=\"n\">map₁</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mut</span><span class=\"w\"> </span><span class=\"n\">lengthToNames</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Std</span><span class=\"bp\">.</span><span class=\"n\">HashMap</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"n\">NameSet</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">∅</span>\n<span class=\"w\">  </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">nm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">csts</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">rg</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">declRangeExt</span><span class=\"bp\">.</span><span class=\"n\">find?</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">nm</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">      </span><span class=\"n\">lengthToNames</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">lengthToNames</span><span class=\"bp\">.</span><span class=\"n\">alter</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rg</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"bp\">.</span><span class=\"n\">endPos</span><span class=\"bp\">.</span><span class=\"n\">line</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">rg</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"bp\">.</span><span class=\"n\">pos</span><span class=\"bp\">.</span><span class=\"n\">line</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·.</span><span class=\"n\">getD</span><span class=\"w\"> </span><span class=\"bp\">∅</span><span class=\"w\"> </span><span class=\"bp\">|&gt;.</span><span class=\"n\">insert</span><span class=\"w\"> </span><span class=\"n\">nm</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">nms</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">lengthToNames</span><span class=\"bp\">.</span><span class=\"n\">toArray</span><span class=\"bp\">.</span><span class=\"n\">qsort</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"bp\">·.</span><span class=\"m\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"n\">dbg_trace</span><span class=\"w\"> </span><span class=\"s2\">\"{(l, nms.size)}{if nms.size ≤ 3 then s!\"</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">nms</span><span class=\"bp\">.</span><span class=\"n\">toArray</span><span class=\"bp\">.</span><span class=\"n\">qsort</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·.</span><span class=\"n\">toString</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"bp\">·.</span><span class=\"n\">toString</span><span class=\"o\">)}</span><span class=\"s2\">\" else \"\"}\"</span>\n</code></pre></div>",
        "id": 528188749,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752203113
    },
    {
        "content": "<p>It shows the number of lines, followed by how many declarations of that length there are.  When there are at most 3 declarations, it also prints their names.</p>",
        "id": 528188852,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752203201
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span> could you share its output?</p>",
        "id": 528189152,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752203522
    },
    {
        "content": "<p>Sure, I updated the message above!</p>",
        "id": 528189232,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752203592
    },
    {
        "content": "<p>Note that the list above includes all declarations that are actually written somewhere and also includes the docstrings.</p>",
        "id": 528189261,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752203630
    },
    {
        "content": "<p>Ah, now with the full name, I found the message!</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">Elab</span><span class=\"w\"> </span><span class=\"n\">Command</span>\n\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Lengths</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">repos</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"n\">Name</span>\n<span class=\"w\">  </span><span class=\"n\">lengths</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Std</span><span class=\"bp\">.</span><span class=\"n\">HashMap</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"n\">Name</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">replicate</span><span class=\"w\"> </span><span class=\"n\">repos</span><span class=\"bp\">.</span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"bp\">∅</span><span class=\"w\"> </span><span class=\"bp\">|&gt;.</span><span class=\"n\">toArray</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Lengths</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ls</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lengths</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">repo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Name</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">decl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Name</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lengths</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">idx</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ls</span><span class=\"bp\">.</span><span class=\"n\">repos</span><span class=\"bp\">.</span><span class=\"n\">findIdx?</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">==</span><span class=\"w\"> </span><span class=\"n\">repo</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">ls</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">lengths</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ls</span><span class=\"bp\">.</span><span class=\"n\">lengths</span><span class=\"bp\">.</span><span class=\"n\">modify</span><span class=\"w\"> </span><span class=\"n\">idx</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·.</span><span class=\"n\">alter</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·.</span><span class=\"n\">getD</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[]</span><span class=\"w\"> </span><span class=\"bp\">|&gt;.</span><span class=\"n\">push</span><span class=\"w\"> </span><span class=\"n\">decl</span><span class=\"o\">))}</span>\n<span class=\"w\">  </span><span class=\"k\">else</span>\n<span class=\"w\">    </span><span class=\"n\">ls</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Data_toMessageData</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">repo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Name</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">dat</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"n\">Name</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">threshold</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MessageData</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">tot</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">dat</span><span class=\"bp\">.</span><span class=\"n\">foldl</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">names</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">names</span><span class=\"bp\">.</span><span class=\"n\">size</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">dat</span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"o\">]</span><span class=\"bp\">!.</span><span class=\"m\">1</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">header</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\"{tot} decls, {dat.size} lengths between {min}-{dat.back!.1}\"</span>\n<span class=\"w\">  </span><span class=\"bp\">.</span><span class=\"n\">trace</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">cls</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">repo</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">header</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"n\">m!</span><span class=\"s2\">\"Length: No of decls\"</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">dat</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">lth</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">nms</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\"</span><span class=\"se\">\\n</span><span class=\"s2\">length {lth}: decls {nms.size}\"</span><span class=\"w\"> </span><span class=\"bp\">++</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">nms</span><span class=\"bp\">.</span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">threshold</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"n\">trace</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">cls</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"ss\">`show_me_the_names!</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\"\"</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"bp\">.</span><span class=\"n\">joinSep</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m!</span><span class=\"s2\">\"\"</span><span class=\"bp\">::</span><span class=\"n\">nms</span><span class=\"bp\">.</span><span class=\"n\">toList</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\"{.ofConstName n}\"</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"s2\">\" \"</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\"\"</span><span class=\"o\">)</span>\n\n<span class=\"n\">run_cmd</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">threshold</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">3</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">getEnv</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mods</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"bp\">.</span><span class=\"n\">allImportedModuleNames</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">repos</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">mods</span><span class=\"bp\">.</span><span class=\"n\">foldl</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∅</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NameSet</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·.</span><span class=\"n\">insert</span><span class=\"w\"> </span><span class=\"bp\">·.</span><span class=\"n\">getRoot</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">|&gt;.</span><span class=\"n\">toArray</span><span class=\"bp\">.</span><span class=\"n\">qsort</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·.</span><span class=\"n\">toString</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"bp\">·.</span><span class=\"n\">toString</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mut</span><span class=\"w\"> </span><span class=\"n\">ls</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lengths</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">repos</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">repos</span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">reposToDat</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"bp\">.</span><span class=\"n\">constants</span><span class=\"bp\">.</span><span class=\"n\">map₁</span><span class=\"bp\">.</span><span class=\"n\">foldM</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ls</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">reposToDat</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">rgs</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">findDeclarationRanges?</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mod</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"bp\">.</span><span class=\"n\">getModuleIdxFor?</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">|&gt;.</span><span class=\"n\">getD</span><span class=\"w\"> </span><span class=\"n\">default</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">modName</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">mods</span><span class=\"o\">[</span><span class=\"n\">mod</span><span class=\"o\">]</span><span class=\"bp\">!</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rgs</span><span class=\"bp\">.</span><span class=\"n\">range</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"bp\">.</span><span class=\"n\">endPos</span><span class=\"bp\">.</span><span class=\"n\">line</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"bp\">.</span><span class=\"n\">pos</span><span class=\"bp\">.</span><span class=\"n\">line</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">      </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"n\">reposToDat</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">modName</span><span class=\"bp\">.</span><span class=\"n\">getRoot</span><span class=\"w\"> </span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">    </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"n\">reposToDat</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mut</span><span class=\"w\"> </span><span class=\"n\">msg</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[]</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">sorted</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">reposToDat</span><span class=\"bp\">.</span><span class=\"n\">lengths</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·.</span><span class=\"n\">toArray</span><span class=\"bp\">.</span><span class=\"n\">qsort</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"bp\">·.</span><span class=\"m\">1</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">repo</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">dat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">repos</span><span class=\"bp\">.</span><span class=\"n\">zip</span><span class=\"w\"> </span><span class=\"n\">sorted</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">      </span><span class=\"n\">msg</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">msg</span><span class=\"bp\">.</span><span class=\"n\">push</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">Data_toMessageData</span><span class=\"w\"> </span><span class=\"n\">repo</span><span class=\"w\"> </span><span class=\"n\">dat</span><span class=\"w\"> </span><span class=\"n\">threshold</span>\n<span class=\"w\">  </span><span class=\"n\">logInfo</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">joinSep</span><span class=\"w\"> </span><span class=\"n\">msg</span><span class=\"bp\">.</span><span class=\"n\">toList</span><span class=\"w\"> </span><span class=\"s2\">\"</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span>\n</code></pre></div>",
        "id": 528189416,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752203791
    },
    {
        "content": "<p>This one is broken down by dependency and is clickable (you can see it in interactive form in the lean server),</p>",
        "id": 528189529,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752203895
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Lengths.20of.20theorems/near/528176445\">said</a>:</p>\n<blockquote>\n<p><a href=\"/user_uploads/3121/eELJ0O8WxFx9MaInfaHzs4Sz/image.png\">The frequency data, on a log scale</a>, and the <a href=\"https://docs.google.com/spreadsheets/d/1F4VHd3g7epMuYoZOPWFekV0XzArjZ_cmRWVGEB0stMQ/edit?gid=2119182114#gid=2119182114\">sheet to compute it</a></p>\n</blockquote>\n<p>Looks pretty zipfy !</p>",
        "id": 528285341,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1752221467
    }
]