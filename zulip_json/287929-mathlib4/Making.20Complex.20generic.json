[
    {
        "content": "<p>Hello,<br>\ncurrently Complex is defined as Complex over R (<a href=\"https://github.com/leanprover-community/mathlib4/blob/master/Mathlib/Data/Complex/Basic.lean#L28\">https://github.com/leanprover-community/mathlib4/blob/master/Mathlib/Data/Complex/Basic.lean#L28</a>)<br>\nWhat are people's thought on making Complex generic? Either introduce a new type or making the current type generic. Currently, Complex is a pain to work with if you want to do computation, since e.g. Complex division is noncomputable. Having a computable Complex seems like a good idea.</p>",
        "id": 536665117,
        "sender_full_name": "Adam Nemecek",
        "timestamp": 1756406537
    },
    {
        "content": "<p>What do you mean by \"have a computable <code>Complex</code>\"? Doing you mean you want computable Gaussian integers or something?</p>",
        "id": 536666065,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1756406950
    },
    {
        "content": "<p>complex type where all operations are computable. e.g. this </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">c1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„‚</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">âŸ¨</span><span class=\"mf\">1.0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mf\">1.0</span><span class=\"bp\">âŸ©</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">c1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">c1</span>\n</code></pre></div>\n<p>fails with \"failed to compile definition, consider marking it as 'noncomputable' because it depends on 'Complex.instDivInvMonoid', which is 'noncomputable'\"</p>",
        "id": 536666319,
        "sender_full_name": "Adam Nemecek",
        "timestamp": 1756407062
    },
    {
        "content": "<p>this is because R/R is not computable</p>",
        "id": 536666350,
        "sender_full_name": "Adam Nemecek",
        "timestamp": 1756407072
    },
    {
        "content": "<p>I'm not sure how you expect division of complex numbers (or real numbers) to be computable.</p>",
        "id": 536666746,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1756407211
    },
    {
        "content": "<p>I am not. Which is why I suggest that there is a generic Complex number that can be defined over something where division is computable</p>",
        "id": 536666923,
        "sender_full_name": "Adam Nemecek",
        "timestamp": 1756407271
    },
    {
        "content": "<p>Right, but what kinds of things do you want to allow?</p>",
        "id": 536667093,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1756407342
    },
    {
        "content": "<p>computable division of Complex over number classes that allow for it</p>",
        "id": 536667184,
        "sender_full_name": "Adam Nemecek",
        "timestamp": 1756407378
    },
    {
        "content": "<p>Right, so you want things like Guassian integers. Perhaps then you'll find the discussion here relevant: <a class=\"stream-topic\" data-stream-id=\"345428\" href=\"/#narrow/channel/345428-mathlib-reviewers/topic/Quadratic.20extensions/with/536078724\">#mathlib reviewers &gt; Quadratic extensions</a></p>",
        "id": 536667258,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1756407404
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=GaussianInt#doc\">docs#GaussianInt</a> already exists</p>",
        "id": 536667297,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1756407421
    },
    {
        "content": "<p>right now, how do i complex over Q?</p>",
        "id": 536667573,
        "sender_full_name": "Adam Nemecek",
        "timestamp": 1756407514
    },
    {
        "content": "<p>You wait for the work in that other thread</p>",
        "id": 536667927,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1756407657
    },
    {
        "content": "<p>oops, that's a private stream <span aria-label=\"face palm\" class=\"emoji emoji-1f926\" role=\"img\" title=\"face palm\">:face_palm:</span></p>",
        "id": 536668634,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1756407947
    },
    {
        "content": "<p>i dont have access to view it</p>",
        "id": 536668639,
        "sender_full_name": "Adam Nemecek",
        "timestamp": 1756407949
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/27511\">#27511</a> is probably just as useful</p>",
        "id": 536670884,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1756409002
    },
    {
        "content": "<p>and here is the associated Zulip discussion: <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Z.5B.281.2Bsqrt.281.2B4k.29.29.2F2.5D/near/520523635\">#Is there code for X? &gt; Z&#91;(1+sqrt(1+4k))/2&#93; @ ðŸ’¬</a></p>",
        "id": 536678447,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1756412593
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@YaÃ«l Dillies</span> this is another argument for the computable two-field structure rather than your proposal to make noncomputable quadratic algebras.</p>",
        "id": 536683331,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1756415113
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> i think that my argument is for having a generic two-field structure which is computable or not based on the particular type argument</p>",
        "id": 536713620,
        "sender_full_name": "Adam Nemecek",
        "timestamp": 1756439335
    },
    {
        "content": "<p>but isn't that the same as \"the two-field structure is a computable construction\" i.e. \"the resulting object is as computable as the input\"?</p>",
        "id": 536741766,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1756456272
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"322937\">@Adam Nemecek</span> Currently you do this by using <code>AdjoinRoot (X ^ 2 + 1 : Polynomial R)</code>. But indeed there is a PR for this idea that makes stuff computable, as I understand: <a href=\"https://github.com/leanprover-community/mathlib4/pull/27511\">https://github.com/leanprover-community/mathlib4/pull/27511</a></p>",
        "id": 536855949,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1756498068
    },
    {
        "content": "<p>At the very least, I think <code>Complex</code> should refer to the concrete type of complex numbers, and if we want to make a generic version we should give it a different name.</p>",
        "id": 536881590,
        "sender_full_name": "Niels Voss",
        "timestamp": 1756520286
    },
    {
        "content": "<p>Having tried Lean last year, I was for fun trying to create my own Type Theory language.</p>\n<p>Learning from the lessons and mistakes from MathLib, I made sure to make my Complex type be dependent on another number type. e.g. So it would be (complex numbers over integers):</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"double-struck\">C</mi><mo stretchy=\"false\">[</mo><mi mathvariant=\"double-struck\">Z</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{C}[\\mathbb{Z}]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">C</span><span class=\"mopen\">[</span><span class=\"mord mathbb\">Z</span><span class=\"mclose\">]</span></span></span></span></span></p>\n<p>or (complex numbers over reals)</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"double-struck\">C</mi><mo stretchy=\"false\">[</mo><mi mathvariant=\"double-struck\">R</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{C}[\\mathbb{R}]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">C</span><span class=\"mopen\">[</span><span class=\"mord mathbb\">R</span><span class=\"mclose\">]</span></span></span></span></span></p>\n<p>or even (complexified complex numbers)</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"double-struck\">C</mi><mo stretchy=\"false\">[</mo><mi mathvariant=\"double-struck\">C</mi><mo stretchy=\"false\">[</mo><mi mathvariant=\"double-struck\">Q</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{C}[\\mathbb{C}[\\mathbb{Q}]]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">C</span><span class=\"mopen\">[</span><span class=\"mord mathbb\">C</span><span class=\"mopen\">[</span><span class=\"mord mathbb\">Q</span><span class=\"mclose\">]]</span></span></span></span></span></p>\n<p>But, then what I realised was that this was a bit verbose. And that as well as the generic complex type, it was convenient also to have a shorthand for writing the \"usual\" Complex with two real components just written as </p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"double-struck\">C</mi><mo>=</mo><mi mathvariant=\"double-struck\">C</mi><mo stretchy=\"false\">[</mo><mi mathvariant=\"double-struck\">R</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{C} = \\mathbb{C}[\\mathbb{R}]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">C</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">C</span><span class=\"mopen\">[</span><span class=\"mord mathbb\">R</span><span class=\"mclose\">]</span></span></span></span></span></p>\n<p>But then there is also another one which we often want to make things simpler, complex plane + point at infinity = Riemann sphere</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"double-struck\">C</mi><mo>âˆª</mo><mo stretchy=\"false\">{</mo><mi mathvariant=\"normal\">âˆž</mi><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{C} \\cup \\{\\infty\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">C</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆª</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">âˆž</span><span class=\"mclose\">}</span></span></span></span></span></p>\n<p>So which one to define as \"the\" complex numbers is up for debate.</p>\n<p>Another thing I tried was to not define Complex as a axiomatic type at all but define it as something like Complex := AlgebraicClosure( MetricCompletion( Q )). But that is even more verbose!</p>",
        "id": 536883558,
        "sender_full_name": "Mr Proof",
        "timestamp": 1756523057
    },
    {
        "content": "<p>Can you explain what you mean by \"lessons and mistakes from MathLib\"? And do you have a link to your definition of the dependent Complex type?</p>",
        "id": 536883777,
        "sender_full_name": "Niels Voss",
        "timestamp": 1756523328
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"521331\">Niels Voss</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Making.20Complex.20generic/near/536883777\">said</a>:</p>\n<blockquote>\n<p>Can you explain what you mean by \"lessons and mistakes from MathLib\"? And do you have a link to your definition of the dependent Complex type?</p>\n</blockquote>\n<p>Well, like the OP says, making Complex not a dependent type but making Quaternions dependent on a type e.g.  you can do</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"double-struck\">H</mi><mo stretchy=\"false\">[</mo><mi mathvariant=\"double-struck\">Q</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{H}[\\mathbb{Q}]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">H</span><span class=\"mopen\">[</span><span class=\"mord mathbb\">Q</span><span class=\"mclose\">]</span></span></span></span></span></p>\n<p>But Complex seems to assume the parts are real.<br>\nMaybe not a mistake but, an asymmetric design choice.</p>\n<p>And then having Gaussian integers as a separate type. Not a choice I would have made. But I respect everyone's choices.</p>\n<p>*Apologies for my non-standard notation. [..] is meant to mean \"over the\"</p>",
        "id": 536884034,
        "sender_full_name": "Mr Proof",
        "timestamp": 1756523714
    },
    {
        "content": "<p>You said you already developed a custom type theory where you made the complex type generic. Where can we find this development?</p>",
        "id": 536886003,
        "sender_full_name": "Niels Voss",
        "timestamp": 1756526652
    },
    {
        "content": "<p>tangential point: I don't see how the Riemann sphere is related to your \"complex numbers over another type\"</p>",
        "id": 536894653,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1756535924
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"521331\">Niels Voss</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Making.20Complex.20generic/near/536886003\">said</a>:</p>\n<blockquote>\n<p>You said you already developed a custom type theory where you made the complex type generic. Where can we find this development?</p>\n</blockquote>\n<p>Well, I said I \"tried\" to create my own  dependent Type Theory language. I didn't say I succeeded very well! <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span> But you can see my attempt <a href=\"https://elephantpanda.github.io/testwebsite/docs/\">here</a>. And the <a href=\"https://elephantpanda.github.io/testwebsite/docs/complex.html\">complex</a> page here. </p>\n<p>It is all in Javascript. I just made it because it helped me understand some of the basics of dependent type theory. And it gives me an appreciation of how difficult it is to get right. </p>\n<p>Plus I just wanted to see if I could format things in Latex.</p>\n<p><span class=\"user-mention\" data-user-id=\"634338\">@Michael Rothgang</span> (Yeah I was just a side point, about when we talk about Complex numbers sometimes we might include the point at infinity - probably not -, and whether that should be the default setting or not. It's a similar argument to whether natural numbers should include zero. It just a matter of convention. Sorry, it was just an irrelevant tangent. <span aria-label=\"pensive\" class=\"emoji emoji-1f614\" role=\"img\" title=\"pensive\">:pensive:</span> )</p>",
        "id": 536945382,
        "sender_full_name": "Mr Proof",
        "timestamp": 1756596479
    },
    {
        "content": "<p>I see. Though I would argue the situation about the natural numbers is different --- <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">N</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{N}_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> has better algebraic properties than <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">N</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{N}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> (it gains a neutral element). You cannot extend addition and multiplication to the Riemann sphere to make it a field. Don't get me wrong, I like the Riemann sphere, but I think the difference is far larger.<br>\nIn any case, if we want to further discuss this, we should take it elsewhere!</p>",
        "id": 536963957,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1756623248
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=QuadraticAlgebra#doc\">docs#QuadraticAlgebra</a> has now landed in mathlib!</p>",
        "id": 537992551,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757154279
    }
]