[
    {
        "content": "<p>Would it be reasonable to have:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">MulAut</span><span class=\"bp\">.</span><span class=\"n\">inv_apply</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Mul</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MulAut</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">      </span><span class=\"n\">e</span><span class=\"bp\">⁻¹</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MulAut</span><span class=\"bp\">.</span><span class=\"n\">inv_def</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>or even a <code>simp</code> tag on <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MulAut.inv_def#doc\">docs#MulAut.inv_def</a></p>",
        "id": 512320980,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1744723764
    },
    {
        "content": "<p><code>inv_apply</code> (and same for <code>mul</code>, <code>one</code>) looks good to me, under the premise that if you are applying your morphisms you no longer care about the group structure</p>",
        "id": 512321668,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744723930
    },
    {
        "content": "<p>If we make this simp we should do it globally for all the endomorphisms / automorphisms</p>",
        "id": 512321735,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744723948
    },
    {
        "content": "<p>(not only for consistency, but that's more likely to alert us if this is a bad idea after all)</p>",
        "id": 512321804,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744723967
    },
    {
        "content": "<p>i guess this could be a reasonable simp because this is in application form, rather than just a plain <code>e⁻¹ = e.symm</code>?</p>",
        "id": 512322322,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1744724101
    },
    {
        "content": "<p>i suspect tagging <code>MulAut.inv_def</code> with simp will have adverse effects though</p>",
        "id": 512322494,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1744724153
    },
    {
        "content": "<p>in particular because this is breaking the abstraction barrier between <code>(M ≃* M)</code> and <code>MulAut M</code>, whereas the applied form already has broken that barrier, so doesn't worsen it</p>",
        "id": 512322786,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1744724225
    },
    {
        "content": "<p>Well, <code>MulAut.inv_apply</code> doesn't suffice, in fact,  what I need is</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">MulAut</span><span class=\"bp\">.</span><span class=\"n\">symm_inv_apply</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Mul</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MulAut</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"bp\">⁻¹</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MulAut</span><span class=\"bp\">.</span><span class=\"n\">inv_def</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">MulEquiv</span><span class=\"bp\">.</span><span class=\"n\">symm_symm</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 512323459,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1744724395
    },
    {
        "content": "<p>(I was led to that after a mere <code>simp</code>).</p>",
        "id": 512323569,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1744724413
    },
    {
        "content": "<p>right, because you don't get to apply <code>inv_inv</code></p>",
        "id": 512323665,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1744724433
    },
    {
        "content": "<p>I think probably we want <code>(e⁻¹).symm = e</code> and <code>e.symm⁻¹ = e</code> as simp lemmas too</p>",
        "id": 512323795,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744724468
    },
    {
        "content": "<p>yes, i think that makes sense...</p>",
        "id": 512324099,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1744724537
    },
    {
        "content": "<p>weird question, but should some of these be marked with something like <code>push_cast</code>?</p>",
        "id": 512324203,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1744724563
    },
    {
        "content": "<p>(<a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MulAut.mul_apply#doc\">docs#MulAut.mul_apply</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MulAut.one_apply#doc\">docs#MulAut.one_apply</a> are already marked as simp.)</p>",
        "id": 512324957,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1744724762
    },
    {
        "content": "<p>I did that in <a href=\"https://github.com/leanprover-community/mathlib4/pull/24082\">#24082</a>. I expect that I will have to de-<code>simp</code> one things or two.</p>",
        "id": 512326404,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1744725124
    },
    {
        "content": "<p>things like <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Group/End.html#MulAut.apply_inv_self\">MulAut.apply_inv_self</a> <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 512326661,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1744725183
    },
    {
        "content": "<p><del>That one doesn't prove by <code>simp</code>, but then, the next one, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MulAut.apply_symm_self#doc\">docs#MulAut.apply_symm_self</a> does.</del></p>",
        "id": 512326959,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1744725251
    }
]