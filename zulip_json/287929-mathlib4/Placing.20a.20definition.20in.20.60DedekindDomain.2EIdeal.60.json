[
    {
        "content": "<p>Hi everyone <span aria-label=\"sunny\" class=\"emoji emoji-2600\" role=\"img\" title=\"sunny\">:sunny:</span>,</p>\n<p>I would like to know if anyone has any recommandation on where I could PR the following <a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQOBuSUwSW6ApnAN4BKcAXHACoCeY5AVAL5wDaAwhBAgawAHYBzODQC6fAJIBnACLkAJuQDW4tcqFJx0mXgjsxcAAoR0LMUJLo48jUkficGgGZOV6rTr0QAzEAOgAJcmAJVBgAeTFyAGV2AGMYKABXEBCITwB9YCgodQyU7Ao+VRShSEVgGGAIMQQmiGA1Ixw4buowBmkeAApUPsZ5IpKyskowAEp+iKiY+KTU9KzpOAB3VHJirrgkRWdyVwYAXicXdBDFMCRzKjg+rgPgRQtiEEp6S5PXELvT6gch5XJ5MBfcgHboAHgAPnAsCw4HVwApriFISC8ncHrjxBIKDAmgVPJ4ADRwQbjYpqUrlchYqFwEazYzdBJ5LAQeC/JEotF9Jo2Phc8gARypeLEBMkxNJku5vKptMmjJCXIAXnsIKywFS7DA8p5XIpQUr1uRjDg0ORoOQQD5VBptGJdPpxOFItE4glkuQ0plsuDCnSGdM8kd/ugYZVAzUIHUGk0WnZ2kZev0aEMRv01fSphU5gwDjTfK6Ap7QotfSsA0Gsjl8mH1dN9bMQtHrnA/piZdRnnAePyoJ50EA\">fact</a>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsDedekindDomain</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"w\"> </span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsDedekindDomain</span><span class=\"bp\">.</span><span class=\"n\">HeightOneSpectrum</span><span class=\"bp\">.</span><span class=\"n\">of_irreducible</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecompositionMonoid</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Irreducible</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HeightOneSpectrum</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">asIdeal</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Ideal</span><span class=\"bp\">.</span><span class=\"n\">span</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"n\">isPrime</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Ideal</span><span class=\"bp\">.</span><span class=\"n\">isPrime_of_prime</span>\n<span class=\"w\">    </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ideal</span><span class=\"bp\">.</span><span class=\"n\">prime_span_singleton_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Irreducible</span><span class=\"bp\">.</span><span class=\"n\">prime</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"o\">)]</span>\n<span class=\"w\">  </span><span class=\"n\">ne_bot</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ne_eq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">span_singleton_eq_bot</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Irreducible</span><span class=\"bp\">.</span><span class=\"n\">ne_zero</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">not_false_eq_true</span><span class=\"o\">]</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">IsDedekindDomain</span><span class=\"bp\">.</span><span class=\"n\">HeightOneSpectrum</span><span class=\"bp\">.</span><span class=\"n\">of_irreducible_asIdeal</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">DecompositionMonoid</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Irreducible</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">IsDedekindDomain</span><span class=\"bp\">.</span><span class=\"n\">HeightOneSpectrum</span><span class=\"bp\">.</span><span class=\"n\">of_irreducible</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">asIdeal</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Ideal</span><span class=\"bp\">.</span><span class=\"n\">span</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<hr>\n<p>I think this would fit well somewhere in the <code>DedekindDomain.Ideal</code> file. I was thinking that maybe close to the PID section (found at line 1320) would be a good fit? Let me know what you think!</p>\n<p>Thanks:)<br>\nXavier</p>",
        "id": 511647129,
        "sender_full_name": "Xavier Généreux",
        "timestamp": 1744376734
    },
    {
        "content": "<p>And btw <code>#find_home!</code> also suggests this file. The question is where in the file would make the most sense!</p>",
        "id": 511662492,
        "sender_full_name": "Xavier Généreux",
        "timestamp": 1744380819
    },
    {
        "content": "<p>I think it should named <code>ofIrreducible</code> since <code>HeightOneSpectrum R</code> is a <code>Type</code>.</p>",
        "id": 511778602,
        "sender_full_name": "Jz Pan",
        "timestamp": 1744435697
    },
    {
        "content": "<p>Yeah I agree</p>",
        "id": 511783135,
        "sender_full_name": "Xavier Généreux",
        "timestamp": 1744439590
    },
    {
        "content": "<p>I confess I have a math question here, and apologies if it is stupid: are there Dedekind domains that are decomposition monoids without being UFD's, so not PID's?</p>",
        "id": 511800578,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1744455461
    },
    {
        "content": "<p>I believe there aren't. See the paper of Cohn, theorem 2.3 <a href=\"https://lohar.com/researchpdf/bezout_rings_and_their_subrings.pdf\">https://lohar.com/researchpdf/bezout_rings_and_their_subrings.pdf</a></p>",
        "id": 511803006,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1744457325
    },
    {
        "content": "<p>I don't think we should have this. We should instead have <code>ofPrime</code> (that could go in <code>Mathlib.RingTheory.DedekindDomain.Ideal</code>):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsDedekindDomain</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"w\"> </span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"n\">IsDedekindDomain</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simps</span><span class=\"kd\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsDedekindDomain</span><span class=\"bp\">.</span><span class=\"n\">HeightOneSpectrum</span><span class=\"bp\">.</span><span class=\"n\">ofPrime</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Prime</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HeightOneSpectrum</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">asIdeal</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">p</span>\n<span class=\"w\">  </span><span class=\"n\">isPrime</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Ideal</span><span class=\"bp\">.</span><span class=\"n\">isPrime_of_prime</span><span class=\"w\"> </span><span class=\"n\">hp</span>\n<span class=\"w\">  </span><span class=\"n\">ne_bot</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"bp\">.</span><span class=\"n\">ne_zero</span>\n</code></pre></div>\n<p>And the construction in the OP is then</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecompositionMonoid</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Irreducible</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HeightOneSpectrum</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">.</span><span class=\"n\">ofPrime</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">span</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"bp\">.</span><span class=\"n\">prime</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 511807099,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1744460501
    },
    {
        "content": "<p>I guess a lemma doing the last part would be useful, passing from <code>Irreducible</code> to <code>Prime (span R {p})</code>.</p>",
        "id": 511809380,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1744462458
    },
    {
        "content": "<p>I think the <code>IsDedekindDomain.HeightOneSpectrum.of_irreducible_asIdeal</code> can be obtained by add a <code>@[simps]</code> to the <code>def ...</code>.</p>",
        "id": 511819638,
        "sender_full_name": "Jz Pan",
        "timestamp": 1744470848
    },
    {
        "content": "<p>Thank you all for the answers.<br>\nSee <a href=\"https://github.com/leanprover-community/mathlib4/pull/24036\">#24036</a> for the suggested lemma for <code>ofPrime</code>. I can add the corollaries for elements of <code>R</code> (like for <code>{p : R} (hp : Irreducible p)</code>) if people think this is interesting but <span class=\"user-mention\" data-user-id=\"439483\">@Andrew Yang</span> is right that it is somewhat straightforward using directly <code>ofPrime</code>.</p>",
        "id": 512060330,
        "sender_full_name": "Xavier Généreux",
        "timestamp": 1744631936
    }
]