[
    {
        "content": "<p>As part of PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/29648\">#29648</a>, I'm adding some lemmas about the topology of GL(n) and SL(n) over a topological ring. The reviewer for the PR (<span class=\"user-mention\" data-user-id=\"268315\">@Anatole Dedecker</span> ) suggested these could live in <code>Mathlib.Topology.Instances.Matrix</code>, but this has brought on a strange coercion instance problem.</p>\n<p>The problem is that the lemmas need some imports from <code>Matrix.GeneralLinearGroup.Defs</code>. Adding this import to <code>Topology.Instances.Matrix</code> means it is also transitively imported in the downstream file <code>Analysis.Normed.Algebra.MatrixExponential</code>, and the latter file will not compile with this import: we get an error</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">synthesize</span>\n<span class=\"w\">  </span><span class=\"n\">CoeT</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">ùî∏</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">ùî∏</span><span class=\"o\">)</span><span class=\"bp\">À£</span>\n<span class=\"o\">(</span><span class=\"n\">deterministic</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">timeout</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"ss\">`typeclass</span><span class=\"bp\">`</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">maximum</span><span class=\"w\"> </span><span class=\"n\">number</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">heartbeats</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">20000</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">reached</span>\n</code></pre></div>\n<p>I have no idea what this means. The problem seems to come from the following instance in <code>GeneralLinearGroup/Defs.lean</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">instance</span><span class=\"w\"> </span><span class=\"n\">instCoeFun</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CoeFun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">GL</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Is this instance somehow bad? Or is it <code>MatrixExponential</code> that's doing something strange? I'd be grateful if someone could help me out here.</p>\n<p>Tagging <span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> as the author of the matrix exponential files.</p>",
        "id": 539756376,
        "sender_full_name": "David Loeffler",
        "timestamp": 1758026052
    },
    {
        "content": "<p>Can you share a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> that gives the deterministic timeout?</p>",
        "id": 539756616,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1758026121
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">Matrix</span><span class=\"bp\">.</span><span class=\"n\">NonsingularInverse</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">Matrix</span><span class=\"bp\">.</span><span class=\"n\">SpecialLinearGroup</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">GeneralLinearGroup</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Ring</span><span class=\"bp\">.</span><span class=\"n\">Subring</span><span class=\"bp\">.</span><span class=\"n\">Units</span>\n<span class=\"c1\">--import Mathlib.LinearAlgebra.Matrix.GeneralLinearGroup.Defs</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">ùïÇ</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">ùî∏</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">ùî∏</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">ùî∏</span><span class=\"o\">)</span><span class=\"bp\">À£</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">ùî∏</span><span class=\"o\">)</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">A</span>\n</code></pre></div>\n<p>This works, but it fails if you un-comment the last import line. (The other imports are precisely the files imported by <code>GeneralLinearGroup.Defs</code>, so the problem is this file specifically.)</p>",
        "id": 539759376,
        "sender_full_name": "David Loeffler",
        "timestamp": 1758026810
    },
    {
        "content": "<p>Unification is trying really hard to fill in a metavariable of type <code>CommRing ùî∏</code>, but it only knows <code>Ring ùî∏</code>. This is an instance of the problem I describe and fix at <a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/Exponential.20blowup.20in.20unification.20with.20metavariables/with/525152073\">#lean4 &gt; Exponential blowup in unification with metavariables</a> </p>\n<p>In your example there are two instances that trigger this exponential slowdown: <code>Matrix.SpecialLinearGroup.hasCoeToGeneralLinearGroup</code> and <code>Matrix.GeneralLinearGroup.instCoeFun</code>. Turning them off locally solves the problem:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">attribute</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">-</span><span class=\"kn\">instance</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"bp\">.</span><span class=\"n\">SpecialLinearGroup</span><span class=\"bp\">.</span><span class=\"n\">hasCoeToGeneralLinearGroup</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"bp\">.</span><span class=\"n\">GeneralLinearGroup</span><span class=\"bp\">.</span><span class=\"n\">instCoeFun</span>\n</code></pre></div>",
        "id": 539764689,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1758028222
    },
    {
        "content": "<p>Ah, I see! So it is on a hopeless quest to prove that an arbitrary ring is commutative.</p>",
        "id": 539764895,
        "sender_full_name": "David Loeffler",
        "timestamp": 1758028275
    },
    {
        "content": "<p>The instance <code>Matrix.GeneralLinearGroup.instCoeFun</code> can actually be generalized to any ring (even semiring) without change. But <code>hasCoeToGeneralLinearGroup</code> is only meaningful over a commutative ring.</p>",
        "id": 539765669,
        "sender_full_name": "David Loeffler",
        "timestamp": 1758028448
    },
    {
        "content": "<p>I would guess that <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matrix.GeneralLinearGroup#doc\">docs#Matrix.GeneralLinearGroup</a> is intentionally taking a <code>CommRing</code> assumption, equivalently to the special linear group.</p>",
        "id": 539766151,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1758028555
    },
    {
        "content": "<p>Using <code>SMul</code> instead of <code>Mul</code> in your check makes it much happier.</p>",
        "id": 539766788,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1758028695
    },
    {
        "content": "<p>Separately, there are lots of <code>abbrev</code>s around there.</p>",
        "id": 539766977,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1758028740
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"479299\">@Jovan Gerbscheid</span>, could you recap your RFCs / PRs to core improving the situation with typeclass inference? Hopefully at some point someone from the FRO will notice :-)<br>\nOn my side I am still very sad with <a href=\"https://github.com/leanprover/lean4/pull/9077\">lean4#9077</a> which IMHO is a major bug but core is not really interested in fixing.</p>\n<p>Maybe issues which are major on the mathlib side, but not so much from core point of view, is something where the Mathlib Iniative could help by providing some interface with the FRO? <span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span></p>",
        "id": 539767226,
        "sender_full_name": "S√©bastien Gou√´zel",
        "timestamp": 1758028802
    },
    {
        "content": "<p>I can get it to work by </p>\n<ul>\n<li>generalizing <code>Matrix.GeneralLinearGroup.instCoeFun</code> to allow <code>Semiring</code> in place of <code>CommRing</code></li>\n<li>locally disabling <code>hasCoeToGeneralLinearGroup</code> at the relevant places. </li>\n</ul>\n<p><span class=\"user-mention\" data-user-id=\"479299\">@Jovan Gerbscheid</span> could you elaborate on why you think the <code>CommRing</code> assumption for GLn was intentional? Is it a Bad Thing to generalize it where possible? Certainly general linear groups over non-commutative rings are a thing that gets studied in some fields.</p>\n<p><span class=\"user-mention\" data-user-id=\"306577\">@Matthew Ballard</span> unfortunately the original declaration had <code>U * A * U‚Åª¬π</code>, so using <code>SMul</code> doesn't help. Are <code>abbrev</code>s a problem? Should <code>GL</code> become a <code>def</code> rather than an <code>abbrev</code> (which would come at a cost of a very considerable amount of extra boilerplate to copy over instances from <code>Units</code>)?</p>",
        "id": 539768822,
        "sender_full_name": "David Loeffler",
        "timestamp": 1758029219
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"481963\">David Loeffler</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Coercion.20instance.20problems.20with.20matrix.20exponential/near/539768822\">said</a>:</p>\n<blockquote>\n<p>Certainly general linear groups over non-commutative rings are a thing that gets studied in some fields.</p>\n</blockquote>\n<p>In that case, feel free to generalize it in a separate PR.</p>",
        "id": 539769429,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1758029376
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110050\">S√©bastien Gou√´zel</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Coercion.20instance.20problems.20with.20matrix.20exponential/near/539767226\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"479299\">Jovan Gerbscheid</span>, could you recap your RFCs / PRs to core improving the situation with typeclass inference? Hopefully at some point someone from the FRO will notice :-)<br>\nOn my side I am still very sad with <a href=\"https://github.com/leanprover/lean4/pull/9077\">lean4#9077</a> which IMHO is a major bug but core is not really interested in fixing.</p>\n<p>Maybe issues which are major on the mathlib side, but not so much from core point of view, is something where the Mathlib Iniative could help by providing some interface with the FRO? <span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span></p>\n</blockquote>\n<p>I turned off the default transparency for instance implicit arguments on a toolchain at some point but ran out of bandwidth so it could have done nothing. But it was seemingly simple.</p>",
        "id": 539769474,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1758029391
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"481963\">David Loeffler</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Coercion.20instance.20problems.20with.20matrix.20exponential/near/539768822\">said</a>:</p>\n<blockquote>\n<p>(which would come at a cost of a very considerable amount of extra boilerplate to copy over instances from <code>Units</code>)?</p>\n</blockquote>\n<p>This is could also be in scope for the Mathlib Initiative.</p>",
        "id": 539769826,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1758029476
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110050\">S√©bastien Gou√´zel</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Coercion.20instance.20problems.20with.20matrix.20exponential/near/539767226\">said</a>:</p>\n<blockquote>\n<p>@Jovan Gerbscheid, could you recap your RFCs / PRs to core improving the situation with typeclass inference?</p>\n</blockquote>\n<p>Yes, I realized now that my PR was still a draft and I hadn't made an issue, so core isn't to blame for not noticing.</p>",
        "id": 539770030,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1758029523
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306577\">Matthew Ballard</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Coercion.20instance.20problems.20with.20matrix.20exponential/near/539769474\">said</a>:</p>\n<blockquote>\n<p>I turned off the default transparency for instance implicit arguments on a toolchain at some point but ran out of bandwidth so it could have done nothing. But it was seemingly simple.</p>\n</blockquote>\n<p>Yes, to prove that <a href=\"https://github.com/leanprover/lean4/pull/9077\">lean#9077</a> can be solved, we need an experiment of this kind, showing that it fixes the problem, and that mathlib can reasonably adapt to it.</p>",
        "id": 539770628,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1758029695
    },
    {
        "content": "<p>I am not sure of the value <code>def</code>.  Structure wrappers keep searches and unification more contained. <code>abbrev</code>‚Äôs are more convenient for recycling API. <code>def</code> is less characters to type?</p>",
        "id": 539770660,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1758029704
    },
    {
        "content": "<p>That's exactly the issue in <a href=\"https://github.com/leanprover/lean4/pull/9077\">lean#9077</a>, for many users there is some expectation that <code>def</code> keeps unification contained during type class search, but as  it turns out, it does not always do this sufficiently.</p>",
        "id": 539771246,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1758029832
    },
    {
        "content": "<p>This thread has led to some fascinating-sounding discussions that I don't claim to understand, but I'm a little lost now as to how to actually solve my original problem. What should I do to fix the build failure in PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/29648\">#29648</a>? Is the fix I proposed, namely</p>\n<blockquote>\n<p>I can get it to work by</p>\n<ul>\n<li>generalizing¬†<code>Matrix.GeneralLinearGroup.instCoeFun</code>¬†to allow¬†<code>Semiring</code>¬†in place of¬†<code>CommRing</code></li>\n<li>locally disabling¬†<code>hasCoeToGeneralLinearGroup</code>¬†at the relevant places.</li>\n</ul>\n</blockquote>\n<p>acceptable?</p>",
        "id": 539772850,
        "sender_full_name": "David Loeffler",
        "timestamp": 1758030194
    },
    {
        "content": "<p>When disabling the instance locally, you could also link to the issue about this slowdown (although I haven't made this issue yet)</p>",
        "id": 539773293,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1758030295
    },
    {
        "content": "<p>The local disabling seems to have precedent in the library already. It would be nice to keep track of it as an issue in case someone else comes back to this in the future</p>",
        "id": 539773353,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1758030309
    },
    {
        "content": "<p>If the instance is bad it should probably be scoped and opened only in the files that need it</p>",
        "id": 539776791,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1758031105
    },
    {
        "content": "<p>Possibly with the notation for SpecialLinearGroup</p>",
        "id": 539776818,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1758031111
    },
    {
        "content": "<p>There is nothing wrong with the instance. The only thing is that it sometimes triggers an exponential slowness in unification that shouldn't be there in the first place</p>",
        "id": 539777166,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1758031190
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"481963\">David Loeffler</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Coercion.20instance.20problems.20with.20matrix.20exponential/near/539768822\">said</a>:</p>\n<blockquote>\n<p>I can get it to work by</p>\n</blockquote>\n<p>By doing both of these things or either of these things?</p>",
        "id": 539784357,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1758032553
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Coercion.20instance.20problems.20with.20matrix.20exponential/near/539784357\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"481963\">David Loeffler</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Coercion.20instance.20problems.20with.20matrix.20exponential/near/539768822\">said</a>:</p>\n<blockquote>\n<p>I can get it to work by</p>\n</blockquote>\n<p>By doing both of these things or either of these things?</p>\n</blockquote>\n<p>Both ‚Äì¬†there's two separate instances that are (independently) troublesome (and the nicer solution that works for the first doesn't work for the second).</p>",
        "id": 539784553,
        "sender_full_name": "David Loeffler",
        "timestamp": 1758032598
    },
    {
        "content": "<p>To be clear, it would also work to disable both instances locally. But one of them can be mathematically generalized, which just so happens to fix the performance problem.</p>",
        "id": 539784851,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1758032668
    },
    {
        "content": "<p>Ok, I've now made the issue <a href=\"https://github.com/leanprover/lean4/pull/10414\">lean#10414</a></p>",
        "id": 539795960,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1758035472
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479299\">Jovan Gerbscheid</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Coercion.20instance.20problems.20with.20matrix.20exponential/near/539795960\">said</a>:</p>\n<blockquote>\n<p>Ok, I've now made the issue <a href=\"https://github.com/leanprover/lean4/pull/10414\">lean#10414</a></p>\n</blockquote>\n<p>Thanks! I've added a note in the PR code referring to this.</p>",
        "id": 539797233,
        "sender_full_name": "David Loeffler",
        "timestamp": 1758035792
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306577\">Matthew Ballard</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Coercion.20instance.20problems.20with.20matrix.20exponential/near/539773353\">said</a>:</p>\n<blockquote>\n<p>The local disabling seems to have precedent in the library already. </p>\n</blockquote>\n<p>Precisely <a href=\"https://github.com/leanprover-community/mathlib4/blob/d19d8deec21abd7c5e3b7cbb353e995449d5de5c/Mathlib/LinearAlgebra/Matrix/GeneralLinearGroup/Defs.lean#L38\">https://github.com/leanprover-community/mathlib4/blob/d19d8deec21abd7c5e3b7cbb353e995449d5de5c/Mathlib/LinearAlgebra/Matrix/GeneralLinearGroup/Defs.lean#L38</a></p>",
        "id": 539797781,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1758035912
    },
    {
        "content": "<p>That's left from Lean3, where the coercion inserted an unwanted <code>coeFn</code> term</p>",
        "id": 539797977,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1758035954
    },
    {
        "content": "<p>Now that coercions are inlined the motivation is gone</p>",
        "id": 539798059,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1758035968
    },
    {
        "content": "<p>So is this (GeneralLinearGroup/Defs.lean#L38) just cruft that should be removed, unrelated to the issue we've been discussing here?</p>",
        "id": 539798182,
        "sender_full_name": "David Loeffler",
        "timestamp": 1758036000
    },
    {
        "content": "<p>We should at least try to remove it</p>",
        "id": 539798399,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1758036057
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/29722\">#29722</a> - let‚Äôs see if there are any unexpected problems</p>",
        "id": 539799324,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1758036305
    },
    {
        "content": "<p>Quite a few of the <code>attribute [-instance]</code> around mathlib seem to simply be removable...</p>",
        "id": 539799997,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1758036491
    },
    {
        "content": "<p>Looks like the \"bench-after-CI\" label on <a href=\"https://github.com/leanprover-community/mathlib4/pull/29722\">#29722</a> hasn't caught the attention of the benchmark bot</p>",
        "id": 539807372,
        "sender_full_name": "David Loeffler",
        "timestamp": 1758038431
    },
    {
        "content": "<p>I hit the same thing in <a href=\"https://github.com/leanprover-community/mathlib4/pull/29478\">#29478</a> . I'll adopt the fix here</p>",
        "id": 539807439,
        "sender_full_name": "Lawrence Wu (llllvvuu)",
        "timestamp": 1758038448
    },
    {
        "content": "<p>I think that, unfortunately, the <code>bench-after-CI</code> label needs to be present <em>before</em> the build workflow starts.</p>",
        "id": 539811259,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1758039530
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Coercion.20instance.20problems.20with.20matrix.20exponential/near/539811259\">said</a>:</p>\n<blockquote>\n<p>I think that, unfortunately, the <code>bench-after-CI</code> label needs to be present <em>before</em> the build workflow starts.</p>\n</blockquote>\n<p>Ah, that was supposed to be fixed in <a href=\"https://github.com/leanprover-community/mathlib4/pull/29392\">#29392</a> but I just realized I missed something there. </p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/29726\">#29726</a> should fix this for real.</p>",
        "id": 539820145,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1758042719
    },
    {
        "content": "<p>I thought that I remember that there had been some fix, but I was not sure.  Thanks for chasing it up: let's see how it works!</p>",
        "id": 539822504,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1758043586
    }
]