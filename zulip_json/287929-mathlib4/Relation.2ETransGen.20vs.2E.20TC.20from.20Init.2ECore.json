[
    {
        "content": "<p>I only just realised that there are two definitions of the transitive closure of relations: <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=TC#doc\">docs#TC</a> in <code>Init.Core</code> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Relation.TransGen#doc\">docs#Relation.TransGen</a> in <code>Mathlib.Logic.Relation</code>. It seems the latter is what I should use if I want to also get Lemmas about it, ans relate it to <code>ReflTransGen</code> which as no equivalent in <code>Init.Core</code>?<br>\nI also noticed that TC is defined with a <code>trans</code> case that combines two <code>TC</code> steps, whereas <code>TransGen</code> is defined with a <code>tail</code> case that combines a <code>TransGen</code> step and a single <code>r</code> step.</p>\n<p>But I feel like they should be equivalent? Did I miss the theorem that says so?</p>",
        "id": 448941824,
        "sender_full_name": "Malvin Gattinger",
        "timestamp": 1720038018
    },
    {
        "content": "<p>I'm away from my computer for a bit, but: </p>\n<ul>\n<li>A note near <code>TransGen</code> about <code>TC</code> would be helpful. </li>\n<li>A theorem relating them would be good.</li>\n<li>Investigating how TC is used in Lean would be helpful. Perhaps we can move it lower? Perhaps it is replaceable by upstreaming <code>TransGen</code> itself? This doesn't seem super high priority, but if someone wanted to look into it I'd be interested.</li>\n</ul>",
        "id": 448956835,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1720043887
    },
    {
        "content": "<p>IMO we should remove <code>TC</code> if possible</p>",
        "id": 448964603,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1720047295
    },
    {
        "content": "<p>IMHO, <code>TC</code> is a hardly guessable name.</p>",
        "id": 448970964,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1720050787
    },
    {
        "content": "<p>Both <code>TransGen</code> and <code>TransClosure</code> (if we want to have closure in the name) are better.</p>",
        "id": 448971005,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1720050825
    },
    {
        "content": "<p>Here is a proof.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Logic</span><span class=\"bp\">.</span><span class=\"n\">Relation</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Relation</span><span class=\"bp\">.</span><span class=\"n\">TransGen_iff_TC</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Relation</span><span class=\"bp\">.</span><span class=\"n\">TransGen</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">TC</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">tgen</span>\n<span class=\"w\">    </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">tgen</span>\n<span class=\"w\">    </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">single</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">a_c</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">TC</span><span class=\"bp\">.</span><span class=\"n\">base</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">a_c</span>\n<span class=\"w\">    </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">tail</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">b_c</span><span class=\"w\"> </span><span class=\"n\">IH</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">TC</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">IH</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">TC</span><span class=\"bp\">.</span><span class=\"n\">base</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">b_c</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">tc</span>\n<span class=\"w\">    </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">tc</span>\n<span class=\"w\">    </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">base</span><span class=\"w\"> </span><span class=\"n\">a_b</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Relation</span><span class=\"bp\">.</span><span class=\"n\">TransGen</span><span class=\"bp\">.</span><span class=\"n\">single</span><span class=\"w\"> </span><span class=\"n\">a_b</span>\n<span class=\"w\">    </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">IH_x_y</span><span class=\"w\"> </span><span class=\"n\">IH_y_z</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Relation</span><span class=\"bp\">.</span><span class=\"n\">transitive_transGen</span><span class=\"w\"> </span><span class=\"n\">IH_x_y</span><span class=\"w\"> </span><span class=\"n\">IH_y_z</span>\n</code></pre></div>",
        "id": 449024384,
        "sender_full_name": "Malvin Gattinger",
        "timestamp": 1720079157
    },
    {
        "content": "<p>The string <code>TC</code> (with word boundaries) only appears in comments in mathlib, and refers to TypeClass.</p>",
        "id": 449025619,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1720079466
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/pull/4760\">lean#4760</a></p>",
        "id": 451808151,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1721148649
    },
    {
        "content": "<p>Ah, I understand this means the old <code>TC</code> will be gone, and <code>Relation.TransGen</code> will then be provided by Lean instead of Mathlib (once it has moved to a Lean version including this PR)? So any third project using <code>Relation.TransGen</code>should just continue to work? Cool!</p>",
        "id": 453037543,
        "sender_full_name": "Malvin Gattinger",
        "timestamp": 1721594324
    },
    {
        "content": "<p>I think a small detail in the documentation needs to be adjusted for this change: <a href=\"https://github.com/leanprover/lean4/issues/6899\">https://github.com/leanprover/lean4/issues/6899</a> - I tried to make a PR to the lean repo, but it's my first time, hope I did it correctly.</p>",
        "id": 497162889,
        "sender_full_name": "Malvin Gattinger",
        "timestamp": 1738414692
    }
]