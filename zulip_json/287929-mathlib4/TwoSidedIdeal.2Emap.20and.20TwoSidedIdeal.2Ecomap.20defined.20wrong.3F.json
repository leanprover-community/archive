[
    {
        "content": "<p>I've just learnt that we shouldn't use <code>FunLike</code> in definitions, does that mean our definition of <code>TwoSidedIdeal.map</code>and <code>TwoSidedIdeal.comap</code> is wrong?</p>",
        "id": 572226490,
        "sender_full_name": "Edison Xie",
        "timestamp": 1770317687
    },
    {
        "content": "<p>what's our convention about using <code>FunLike</code> and actual homs?</p>",
        "id": 572226543,
        "sender_full_name": "Edison Xie",
        "timestamp": 1770317707
    },
    {
        "content": "<p>Btw I've just found out <code>Ideal.map</code> and <code>Ideal.comap</code> also uses <code>FunLike</code>, so is it the other way around that we should use <code>FunLike</code> for defs?</p>",
        "id": 572226737,
        "sender_full_name": "Edison Xie",
        "timestamp": 1770317767
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span>  <span class=\"user-mention\" data-user-id=\"938806\">@Andrew</span>  <span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span></p>",
        "id": 572226796,
        "sender_full_name": "Edison Xie",
        "timestamp": 1770317785
    },
    {
        "content": "<p>I think we're mid-pivot here towards <em>not</em> using FunLike in <code>def</code>s</p>",
        "id": 572226911,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1770317817
    },
    {
        "content": "<p>so does that mean we need to refactor all of the defs I've mentioned above?</p>",
        "id": 572227221,
        "sender_full_name": "Edison Xie",
        "timestamp": 1770317900
    },
    {
        "content": "<p>apparently <code>Submonoid.comap</code> and <code>Submonoid.map</code> also uses <code>FunLike</code> but <code>Subring.map</code> and <code>Submodule.map</code> uses actual homs :-(</p>",
        "id": 572228076,
        "sender_full_name": "Edison Xie",
        "timestamp": 1770318099
    },
    {
        "content": "<p>so I just did some experiments and if I changed the definition of <code>TwoSidedIdeal.comap</code> from taking <code>FunLike</code> to taking <code>→ₙ+*</code> and suddenly all the lemma involving actual ringhoms fails and the coercion from <code>RingHom</code> to <code>NonUnitalRingHom</code> doesn't fire <span aria-label=\"smiling face with tear\" class=\"emoji emoji-1f972\" role=\"img\" title=\"smiling face with tear\">:smiling_face_with_tear:</span>  Is there a fix for this? <span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span></p>",
        "id": 572230146,
        "sender_full_name": "Edison Xie",
        "timestamp": 1770318786
    },
    {
        "content": "<p>Probably there is a fix. Not sure what it is based on your description</p>",
        "id": 572231170,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1770319170
    },
    {
        "content": "<p>Perhaps we should first change <a href=\"http://Submonoid.map/comap\">Submonoid.map/comap</a> before changing everything else at once</p>",
        "id": 572231564,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1770319313
    },
    {
        "content": "<p>Looking over Edison's shoulder, the problem seemed to be that with the refactor for <code>Ideal.map</code> and <code>TwoSidedIdeal.map</code> he had <code>f : A -&gt;+* B</code> and when using it to push forward and pull back two-sided ideals he could not use f directly and had to write <code>f.toNonUnitalRingHom</code> everywhere.</p>",
        "id": 572260226,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1770330571
    },
    {
        "content": "<p>Does adding a <code>Coe</code> instance fix that?</p>",
        "id": 572261886,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1770331309
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/TwoSidedIdeal.2Emap.20and.20TwoSidedIdeal.2Ecomap.20defined.20wrong.3F/near/572261886\">said</a>:</p>\n<blockquote>\n<p>Does adding a <code>Coe</code> instance fix that?</p>\n</blockquote>\n<p>I just tried and it still gives me the same error</p>",
        "id": 572270745,
        "sender_full_name": "Edison Xie",
        "timestamp": 1770336131
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Application</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">The</span><span class=\"w\"> </span><span class=\"n\">argument</span>\n<span class=\"w\">  </span><span class=\"n\">f</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">→+*</span><span class=\"w\"> </span><span class=\"n\">S</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">→ₙ+*</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">13</span>\n<span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">application</span>\n<span class=\"w\">  </span><span class=\"n\">comap</span><span class=\"w\"> </span><span class=\"n\">f</span>\n</code></pre></div>",
        "id": 572270769,
        "sender_full_name": "Edison Xie",
        "timestamp": 1770336146
    },
    {
        "content": "<p>oh it's this problem again</p>",
        "id": 572272303,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1770337037
    },
    {
        "content": "<p>the coercion isn't found because you have metavariables</p>",
        "id": 572272340,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1770337065
    },
    {
        "content": "<p>I have no idea what unification hints are but can this be solved with unification hints?</p>",
        "id": 572319355,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1770367009
    },
    {
        "content": "<p>see <a href=\"https://github.com/leanprover/lean4/pull/7440\">lean4#7440</a></p>",
        "id": 572351662,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1770376925
    },
    {
        "content": "<p>So does that mean currently the definition has to stay what they were until we fix that issue? <span aria-label=\"smiling face with tear\" class=\"emoji emoji-1f972\" role=\"img\" title=\"smiling face with tear\">:smiling_face_with_tear:</span></p>",
        "id": 572370324,
        "sender_full_name": "Edison Xie",
        "timestamp": 1770382796
    },
    {
        "content": "<p>I think it's ok to write <code>f.toNonUnitalRingHom</code> or <code>(f : R →ₙ+* S)</code> to make things happy</p>",
        "id": 572454813,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1770408016
    },
    {
        "content": "<p>It does feel like a regression though. Imagine the PR: change the definition to take a non unital ring hom, add lots of type annotations which weren't needed before, looks like you're going in the wrong direction :-/</p>",
        "id": 572479304,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1770420995
    }
]