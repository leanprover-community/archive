[
    {
        "content": "<p>How should <code>simproc</code>s be named? For a simproc which matches <code>foo (bar _)</code>, should it be named:</p>\n<ol>\n<li><code>reduceFooBar</code>, to match builtin simprocs, and the fact that this generates a <code>def</code>?</li>\n<li><code>foo_bar</code>, so that the end use of <code>simp</code> can think of it as just another lemma, and so that we can use the more flexible <code>lemma</code>-naming rules?</li>\n<li>Something else?</li>\n</ol>",
        "id": 502050785,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740577637
    },
    {
        "content": "<p>(cc <span class=\"user-mention\" data-user-id=\"552388\">@Vasilii Nesterov</span> for <a href=\"https://github.com/leanprover-community/mathlib4/pull/22273#discussion_r1970074129\">https://github.com/leanprover-community/mathlib4/pull/22273#discussion_r1970074129</a>)</p>",
        "id": 502050979,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740577680
    },
    {
        "content": "<p>I am in favor of using <code>lemma</code>-naming rules, because simprocs are designed to be used like lemmas. This is what I do in <a href=\"https://github.com/leanprover-community/mathlib4/pull/22039\">#22039</a></p>",
        "id": 502051228,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1740577726
    },
    {
        "content": "<p>Yes, this is my opinion too, but:</p>",
        "id": 502051329,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740577747
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> |- Lean.Meta.Simp.Simproc</p>",
        "id": 502051393,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740577760
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Lean/Meta/Tactic/Simp/Types.html#Lean.Meta.Simp.Methods.post\">Lean.Meta.Simp.Methods.post</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Lean/Meta/Tactic/Simp/Types.html#Lean.Meta.Simp.Methods.pre\">Lean.Meta.Simp.Methods.pre</a>, and <a href=\"https://loogle.lean-lang.org/?q=%7C-%20Lean.Meta.Simp.Simproc\">83 more</a></p>",
        "id": 502051397,
        "sender_full_name": "loogle",
        "timestamp": 1740577761
    },
    {
        "content": "<p>suggests that it is not what has been done so far</p>",
        "id": 502051455,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740577774
    },
    {
        "content": "<p>None of these are mathlib's, though.</p>",
        "id": 502051581,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1740577803
    },
    {
        "content": "<p>Well okay, but do we not want to align the naming convention as far as possible?</p>",
        "id": 502051809,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1740577879
    },
    {
        "content": "<p>I think divergence here is confusing though core has some internal divergence already in <code>bv_decide</code> land which may have some rules in place already?</p>",
        "id": 502051856,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1740577897
    },
    {
        "content": "<p>The simprocs in <code>bv_decide</code> have names inspired by their respective friends in Bitwuzla so they shouldn't be taken as a naming convention.</p>",
        "id": 502052075,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1740577960
    },
    {
        "content": "<p>So concretely, for simprocs that match</p>\n<ul>\n<li><code>Finset.Icc (ofNat _) (ofNat _)</code></li>\n<li><code>∃ x, _ ∧ x = y ∧ _</code></li>\n<li><code>(of _  : Matrix (Fin _) (Fin _) _) * (of _ : Matrix (Fin _) (Fin _) _)</code></li>\n</ul>\n<p>which of the following styles should we choose as names?</p>",
        "id": 502159124,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740610290
    },
    {
        "content": "<p>My opinion is that it should be <code>reduceFooBar</code> following the conventions about <code>simproc</code>s from core and the general convention about naming <code>def</code>s. They are used like lemmas, but still different from them, and I think it's nice to be able to visually distinguish used lemmas and simprocs after <code>simp?</code>.</p>",
        "id": 502159251,
        "sender_full_name": "Vasilii Nesterov",
        "timestamp": 1740610346
    },
    {
        "content": "<p>/poll For the above three examples, which style of name should we use?</p>\n<ul>\n<li>Finset.reduceIccOfNatOfNat, reduceExistsAndEq, Matrix.reduceOfMulOf</li>\n<li>Finset.icc_ofNat_ofNat, exists_and_eq, Matrix.of_mul_of</li>\n</ul>",
        "id": 502159278,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740610362
    },
    {
        "content": "<p>(edit: <code>icc</code> should obviously be <code>Icc</code>, please excuse the typo)</p>\n<p><span class=\"user-mention silent\" data-user-id=\"552388\">Vasilii Nesterov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Naming.20conventions.20for.20simprocs/near/502159251\">said</a>:</p>\n<blockquote>\n<p>and I think it's nice to be able to visually distinguish used lemmas from simprocs after <code>simp?</code>.</p>\n</blockquote>\n<p>I agree, but I think it's also nice to have the extra naming expressivity that <code>_</code> gives you; <code>OfNatOfNat</code> has fewer separators available than <code>ofNat_ofNat</code>.</p>",
        "id": 502159396,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740610425
    },
    {
        "content": "<p>Visual markers could still be achieved by prefixing with <code>reduce_</code> or <code>s!_</code> or some other unusual token</p>",
        "id": 502159585,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740610512
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Naming.20conventions.20for.20simprocs/near/502159585\">said</a>:</p>\n<blockquote>\n<p>Visual markers could still be achieved by prefixing with <code>reduce_</code> or <code>s!_</code> or some other unusual token</p>\n</blockquote>\n<p>I do like <code>reduce_&lt;def_convention&gt;</code>: could that be an option?</p>",
        "id": 502160078,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740610736
    },
    {
        "content": "<p>Unlike other recent polls, this one does let you add more options :)</p>",
        "id": 502160170,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740610766
    },
    {
        "content": "<p><code>reduce.&lt;def_convention&gt;</code> and <code>reduce!&lt;def_convention&gt;</code> are similar options</p>",
        "id": 502160269,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740610796
    },
    {
        "content": "<p>I added an option, but would be happy with any of the remaining ones that you suggested that have <code>reduce&lt;something&gt;def_convention</code>.</p>",
        "id": 502160582,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1740610873
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Naming.20conventions.20for.20simprocs/near/502159396\">said</a>:</p>\n<blockquote>\n<p>I agree, but I think it's also nice to have the extra naming expressivity that <code>_</code> gives you; <code>OfNatOfNat</code> has fewer separators available than <code>ofNat_ofNat</code>.</p>\n</blockquote>\n<p>My point here is that simprocs are actually defs, and naming them as theorems may be confusing.</p>",
        "id": 502161997,
        "sender_full_name": "Vasilii Nesterov",
        "timestamp": 1740611362
    },
    {
        "content": "<p>But they are never actually used as defs by the end user, in the same way that the end user never cares what the name of the def is that implements the <code>norm_num</code> tactic or the <code>+</code> elaborator.</p>",
        "id": 502163796,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740612237
    },
    {
        "content": "<p>Could someone post an RFC proposing to rename the simprocs implemented in Lean? I <em>think</em> it would be plausible to just change these, and I agree it would be less confusing.</p>",
        "id": 502183228,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1740623099
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> , are you suggesting renaming all the simprocs in response to how the poll concludes above, or just that the <code>bv</code> ones are misnamed and the <code>reduceIte</code> convention is already the FRO-approved naming?</p>",
        "id": 502323788,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740672821
    },
    {
        "content": "<p>Since this poll has few participants, should we say \"authors choice\" for now to get the simprocs merged, and clean up the naming later?</p>",
        "id": 502461122,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740699144
    },
    {
        "content": "<p>Sorry, I hadn't seen the poll, I had assumed that the snake case option would win: i.e. I was proposing an RFC to rename the Lean simprocs. But I'm also very happy to just punt on this one, it doesn't seem very high priority.</p>",
        "id": 502467204,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1740702537
    },
    {
        "content": "<p>There was some previous discussion on this here: <a href=\"https://github.com/leanprover/lean4/pull/5167#issuecomment-2309512097\">https://github.com/leanprover/lean4/pull/5167#issuecomment-2309512097</a></p>",
        "id": 502571934,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1740747348
    }
]