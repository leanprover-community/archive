[
    {
        "content": "<p>For those of you (maybe <span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span>, <span class=\"user-mention\" data-user-id=\"548935\">@Thomas Murrills</span>  or <span class=\"user-mention\" data-user-id=\"634338\">@Michael Rothgang</span> ?) who have experience writing syntax linters, a trivial one to write would be a linter to help us adhere to the naming conventions. Of course, we could have something sophisticated, but the most basic version would just do this:</p>\n<ol>\n<li>\n<p>Is this an <code>inductive</code>, <code>structure</code> or <code>class</code> (yes, I realize the latter two are just special cases of the former, so potentially you only need to deal with <code>inductive</code>, I don't know)? Does it start with an upper case letter and contain no <code>_</code>? If not, warn the user: </p>\n<blockquote>\n<p>The naming conventions dictate that types (i.e., terms of <code>Sort _</code>, <code>Type _</code> or <code>Prop</code>) are named using <code>UpperCamelCase</code>, so the name should start with an upper case letter and contain no underscores.</p>\n</blockquote>\n</li>\n<li>\n<p>Is this a <code>def</code>? If so, check whether it is a type or not. If it is, the proceed as in (1). If not, check whether the name contains any underscores and starts with a lowercase letter. If it doesn't, warn the user:</p>\n<blockquote>\n<p>The naming conventions dictate that definitions of things that are not themselves types are named using <code>lowerCamelCase</code>, so the name should start with a lower case letter and contain no underscores.</p>\n</blockquote>\n</li>\n</ol>",
        "id": 564571875,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1766093892
    },
    {
        "content": "<p>(For something sophisticated, I'm still hoping someone will pick up the work started here: <a href=\"#narrow/channel/270676-lean4/topic/automatic.20spelling.20generation.20.26.20comparison/near/505760384\">#lean4 &gt; automatic spelling generation &amp; comparison @ üí¨</a>)</p>",
        "id": 564573191,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1766094493
    },
    {
        "content": "<p>The biggest problem with that I think is that we still haven't even decided (at least, not in a way that is reflected in the naming conventions, but I think more than that) upon the naming convention regarding dot notation, scoped infix notation, etc. I received literally no feedback (in the form of <span aria-label=\"thumbs up\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"thumbs up\">:thumbs_up:</span>  or <span aria-label=\"thumbs down\" class=\"emoji emoji-1f44e\" role=\"img\" title=\"thumbs down\">:thumbs_down:</span>) on the proposal I had in this regard several weeks ago. There is some concern that my proposal would cause a great many deprecations within <code>CategoryTheory</code>, so perhaps it's not the right thing, but no one else has proposed a concrete alternative (to my knowledge)</p>",
        "id": 564575065,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1766095393
    },
    {
        "content": "<p>I haven't looked too closely at the code there, but certainly an important step before turning that into a linter will be building some basic tools in Lean to compare types to names. I hope we'd then be able to easily answer questions like \"with this proposed rule, how many violations are there in core / batteries / mathlib?\"</p>",
        "id": 564577757,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1766096634
    },
    {
        "content": "<p>Even the basic linter suggested above sounds useful and not too difficult to write. I may give this a try, but no guarantees when I'll find the time. If I haven't made a comment to that effect, feel free to go ahead yourself!</p>",
        "id": 564578595,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1766096982
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/naming.20convention.20linter/near/564578595\">said</a>:</p>\n<blockquote>\n<p>Even the basic linter suggested above sounds useful and not too difficult to write.</p>\n</blockquote>\n<p>Hence the reason I suggested it. <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 564579813,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1766097539
    },
    {
        "content": "<p>Oh, I wasn't aware we were supposed to give feedback. Just gave your proposal a thumbs up.</p>",
        "id": 564581309,
        "sender_full_name": "Violeta Hern√°ndez",
        "timestamp": 1766098322
    },
    {
        "content": "<p>I've been thinking lately about what it would look like to have a \"declaration manipulation\" infrastructure, because parts of this on the implementation side are currently a bit inconvenient (or subtly tricky) for only mundane reasons (and would be trivial with the right infrastructure). It would be nice to have a \"declaration linter\" setup which would subsume linters like <code>unusedDecidableInType</code>, this linter, and other linters, and provide them with the information necessary to act on all user-written decls in performant ways.</p>\n<p>(That last bit about performance is part of the motivation here, too; robustly detecting and associating new declarations with elaboration info can be a bit expensive.)</p>\n<p>I understand that this proposal is intended specifically to be doable immediately <em>without</em> deeper considerations like this, but doing it immediately (in an inevitably somewhat bespoke, nonreusable manner) is another small bit of technical debt. Maybe we want to take on that technical debt if the value is great enough! :) But either way, I think that for long-term maintainability (especially since this will not be the only linter of this sort) it would be great to head in the infrastructure direction, even if we start off minimally. :)</p>",
        "id": 564581608,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1766098497
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"548935\">Thomas Murrills</span> <a href=\"#narrow/channel/287929-mathlib4/topic/naming.20convention.20linter/near/564581608\">said</a>:</p>\n<blockquote>\n<p>I understand that this proposal is intended specifically to be doable immediately <em>without</em> deeper considerations like this, but doing it immediately (in an inevitably somewhat bespoke, nonreusable manner) is another small bit of technical debt.</p>\n</blockquote>\n<p>Technical debt? I'm not convinced. Not a good use of time if something is in the pipeline? Maybe.</p>\n<p>It's not technical debt because nothing depends on it. You just rip it out when you have something better with which to replace it or when it doesn't perform the way you want.</p>\n<p>Indeed, the point of my suggestion was that I thought it could probably be implemented in an afternoon by someone with the requisite knowledge, and we could reap the benefits immediately at low cost (i.e., no CI performance hits, etc.). This occurred to me because I was reviewing a PR in which I had to specify this to the author, whereas this tool could have done it for me! <span aria-label=\"smiley\" class=\"emoji emoji-1f603\" role=\"img\" title=\"smiley\">:smiley:</span></p>",
        "id": 564582487,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1766098950
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/naming.20convention.20linter/near/564582487\">said</a>:</p>\n<blockquote>\n<p>It's not technical debt because nothing depends on it. You just rip it out when you have something better with which to replace it or when it doesn't perform the way you want.</p>\n</blockquote>\n<p>I don't think this is an exhaustive definition of technical debt. Giving ourselves another bespoke metaprogram to maintain is part of the form that this particular form of technical debt takes. :) Also, that \"just\" in \"You just rip it out\" is load-bearing--refactoring something in terms of new infrastructure when it becomes available can indeed sometimes be trivial, but can often (ime, especially in metaprogramming) be plagued by incompatible design decisions making it nontrivial to sort out what parts remain and what stay. So this form of technical debt is the thing that is paid in the future refactoring effort.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/naming.20convention.20linter/near/564582487\">said</a>:</p>\n<blockquote>\n<p>we could reap the benefits immediately at low [immediate] cost (i.e., no CI performance hits, etc.)</p>\n</blockquote>\n<p>The net value here might be a reason to take on that debt! :)</p>",
        "id": 564583588,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1766099375
    },
    {
        "content": "<p>(I am experimenting right now to see if the costs are not too bad in this case. <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span>)</p>",
        "id": 564583670,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1766099425
    },
    {
        "content": "<p>Just to advocate my point (because I do note that you're already attempting this):</p>\n<ol>\n<li>Maintenance burden on a <em>small</em> metaprogram is generally minimal.</li>\n<li>Rip it out means you <em>don't</em> refactor it or try to reuse the ideas, because something more sophisticated would do it completely differently. In this way, you pay a <em>one-time</em> development cost, but don't pay more in the future (modulo the already-stated minor maintenance cost). This is why I claim it is not technical debt. </li>\n</ol>\n<p>If I'm wrong about how small the metaprogram is, then there's a different story here.</p>",
        "id": 564591691,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1766103328
    },
    {
        "content": "<ol>\n<li>Yes, but it does quickly add up. :) This isn't an argument for somehow pretending the cost is bigger than it is or anything; it's just an argument for being aware of the global situation! That is, it is indeed fine to add a little maintenance cost globally, as long as you don't add a ton of little maintenance costs locally and therefore a big one globally. So that's what's informing my general inclination here, but it's certainly not a black-and-white rule of any sort.</li>\n<li>Okay, but how do you make sure that that's what actually winds up happening? :) One way is simply to plan, and then document the plan; that would probably be enough. A failure mode if we didn't do so could look like: we add a small metaprogram, with vague undocumented intent to rip it out later; we don't get around to the more general thing, and now with the base version in place, it's only a small cost to extend it further, so we decide there's no harm in that; perhaps this repeats; now it is not so clear that the handwaved infrastructure <em>is</em> more sophisticated once it starts to be developed, and perhaps the scope of the new thing has crept, so it does things slightly differently than the new infrastructure would. So, now we have to assess that switching to the new infrastructure preserves behavior, or make decisions about the behavior changing... Again, this is just a worst-case scenario to ward off, not something we should imagine always happening! But my thinking is we may as well try to avoid it if it's reasonable to do so--i.e. as long as doing so doesn't come with its own untenable costs (such as indefinite delay). :)</li>\n</ol>",
        "id": 564599920,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1766107694
    },
    {
        "content": "<p>And re: how small the metaprogram actually is: dealing with the many variations of declaration syntax can be pretty thorny, and in general, associating elaboration info with the declaration syntax and actual resulting decls can be tricky (and sometimes cursed). But I'm wondering if the limited scope here means we can get away with pretty much just handling the syntax, which might be briefly gnarly, but after that, possibly not too bad...</p>",
        "id": 564600443,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1766108002
    },
    {
        "content": "<p>I am pretty scared about the creeping maintenance cost of linters. Despite generally being a \"perfect is the enemy of good\" sort of person, I want to back up Thomas' concerns here. The meta code for linters brings a real cost.</p>",
        "id": 564637531,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1766131170
    },
    {
        "content": "<p>By the way, Mathlib already contains over 400 <code>def</code>initions that contain an underscore in their name, regardless of whether they are correctly capitalised for being or not a type.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">Elab</span><span class=\"w\"> </span><span class=\"n\">Command</span>\n\n<span class=\"n\">run_meta</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">getEnv</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">csts</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"bp\">.</span><span class=\"n\">constants</span><span class=\"bp\">.</span><span class=\"n\">map‚ÇÅ</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mut</span><span class=\"w\"> </span><span class=\"n\">nms</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[]</span>\n<span class=\"w\">  </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">nm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">cinfo</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">csts</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"c1\">-- skip non-definitions</span>\n<span class=\"w\">    </span><span class=\"n\">unless</span><span class=\"w\"> </span><span class=\"n\">cinfo</span><span class=\"bp\">.</span><span class=\"n\">isDefinition</span><span class=\"w\"> </span><span class=\"k\">do</span><span class=\"w\"> </span><span class=\"n\">continue</span>\n<span class=\"w\">    </span><span class=\"c1\">---- skip internal details</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">nm</span><span class=\"bp\">.</span><span class=\"n\">isInternalDetail</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"n\">continue</span>\n<span class=\"w\">    </span><span class=\"c1\">-- skip instances</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">isInstance</span><span class=\"w\"> </span><span class=\"n\">nm</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"n\">continue</span>\n<span class=\"w\">    </span><span class=\"c1\">-- skip parsers and delaborators</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">cinfo</span><span class=\"bp\">.</span><span class=\"n\">value?</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">comps</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"bp\">.</span><span class=\"n\">getAppFnArgs</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"n\">components</span>\n<span class=\"w\">      </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">comps</span><span class=\"bp\">.</span><span class=\"n\">contains</span><span class=\"w\"> </span><span class=\"ss\">`ParserDescr</span><span class=\"w\"> </span><span class=\"bp\">||</span><span class=\"w\"> </span><span class=\"n\">comps</span><span class=\"bp\">.</span><span class=\"n\">contains</span><span class=\"w\"> </span><span class=\"ss\">`Delaborator</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"n\">continue</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">nm</span><span class=\"bp\">.</span><span class=\"n\">components</span><span class=\"bp\">.</span><span class=\"n\">getLast!</span><span class=\"bp\">.</span><span class=\"n\">toString</span><span class=\"bp\">.</span><span class=\"n\">contains</span><span class=\"w\"> </span><span class=\"bp\">'_'</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">      </span><span class=\"c1\">-- skip declarations that are not in mathlib</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mod</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">findModuleOf?</span><span class=\"w\"> </span><span class=\"n\">nm</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"ss\">`Mathlib</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">mod</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">¬∑.</span><span class=\"n\">getRoot</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">continue</span>\n<span class=\"w\">      </span><span class=\"n\">nms</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">nms</span><span class=\"bp\">.</span><span class=\"n\">binInsert</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">¬∑.</span><span class=\"n\">toString</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"bp\">¬∑.</span><span class=\"n\">toString</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">nm</span>\n<span class=\"w\">  </span><span class=\"n\">logInfo</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\"</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span><span class=\"bp\">.</span><span class=\"n\">joinSep</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span>\n<span class=\"w\">    </span><span class=\"n\">m!</span><span class=\"s2\">\"{nms.size} definitions contain an underscore in their last segment\"</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"s2\">\"\"</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">nms</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m!</span><span class=\"s2\">\"{.ofConstName ¬∑}\"</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">toList</span>\n</code></pre></div>",
        "id": 564728553,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1766159845
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/naming.20convention.20linter/near/564575065\">said</a>:</p>\n<blockquote>\n<p>but no one else has proposed a concrete alternative (to my knowledge)</p>\n</blockquote>\n<p>The alternative I proposed in the other thread, and a couple of others have done before me (<a href=\"#narrow/channel/113488-general/topic/.23naming.20and.20dot.20notation/near/247242201\">for example here</a>), was for the naming convention to match what the pretty printer does. I won't repeat all the arguments in detail in favour of it here, but it avoids many of the issues with your proposal, eg <code>fst</code> becoming prefix, CategoryTheory being entirely deprecated, numerous exceptions being introduced to the convention, and <code>ContinuousLinearMap.comp</code> lemmas no longer matching their <code>LinearMap</code> counterparts.</p>",
        "id": 564751752,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1766167402
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/33103\">#33103</a> renames five misnamed definitions</p>",
        "id": 564762399,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1766171950
    },
    {
        "content": "<p>And <a href=\"https://github.com/leanprover-community/mathlib4/pull/33103/commits/b03e1094c7e3e3111c585a56ff4fba5f4ea40d99\">https://github.com/leanprover-community/mathlib4/pull/33103/commits/b03e1094c7e3e3111c585a56ff4fba5f4ea40d99</a> exposes an interesting bug in <code>alias</code>' interaction with <code>noncomputable</code>: I get an error</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">compile</span><span class=\"w\"> </span><span class=\"n\">definition</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">compiler</span><span class=\"w\"> </span><span class=\"n\">IR</span><span class=\"w\"> </span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"ss\">`fintype_of_finiteDimensional</span><span class=\"bp\">`.</span><span class=\"w\"> </span><span class=\"n\">Error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">depends</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">declaration</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">IsLocalFrameOn</span><span class=\"bp\">.</span><span class=\"n\">fintypeOfFiniteDimensional'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">which</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">executable</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">consider</span><span class=\"w\"> </span><span class=\"n\">marking</span><span class=\"w\"> </span><span class=\"n\">definition</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"kn\">noncomputable</span><span class=\"bp\">'</span>\n</code></pre></div>",
        "id": 564762494,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1766171989
    },
    {
        "content": "<p>Marking the definiting preceding it with <code>noncomputable</code> explicitly solves it (which is otherwise not necessary, as we're in a noncomputable section).</p>",
        "id": 564762758,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1766172088
    },
    {
        "content": "<p>The list generated by the above contains 34 definitions <code>Foo.Simps.symm_apply</code>, which are tagged with the \"custom simps projection\" library note. I consider these false positives.</p>",
        "id": 564763284,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1766172333
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span>, sorry, I meant a more official proposal, officially branded as such. I should have been more clear. I would like to see it as a more complete proposal. For example, how does it deal with scoped notations? What happens if we change the way something pretty prints (e.g., with <code>pp_nodot</code> or whatever it is now)?</p>",
        "id": 564763919,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1766172626
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/naming.20convention.20linter/near/564762758\">said</a>:</p>\n<blockquote>\n<p>Marking the definiting preceding it with <code>noncomputable</code> explicitly solves it (which is otherwise not necessary, as we're in a noncomputable section).</p>\n</blockquote>\n<p>This shows that there is an issue...</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"c1\">-- adds to `noncomputableExt`, among others</span>\n<span class=\"n\">whatsnew</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">X'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">section</span>\n\n<span class=\"c1\">-- only adds to the `declRangeExt`</span>\n<span class=\"n\">whatsnew</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 564766854,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1766173959
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/34440\">#34440</a> adds a very basic check: it complains about declarations (in the source) which have an uppercase name component. Surely, some of these are false positives, but a number of them looks quite suspicious. For instance:</p>\n<ul>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=logMahlerMeasure_eq_log_MahlerMeasure#doc\">docs#logMahlerMeasure_eq_log_MahlerMeasure</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=mk_iUnion_Ordinal_le_of_le#doc\">docs#mk_iUnion_Ordinal_le_of_le</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=differentiableAt_Gamma#doc\">docs#differentiableAt_Gamma</a> and friends (but wait for <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/Gamma.20capitalization/with/570089122\">#mathlib4 &gt; Gamma capitalization</a> to converge first!)</li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FiniteField.primitiveChar_to_Complex#doc\">docs#FiniteField.primitiveChar_to_Complex</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FiniteField.primitiveChar_to_Complex_isPrimitive#doc\">docs#FiniteField.primitiveChar_to_Complex_isPrimitive</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=sum_PrimePow_eq_sum_sum#doc\">docs#sum_PrimePow_eq_sum_sum</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=not_IntegrableOn_Ici_inv#doc\">docs#not_IntegrableOn_Ici_inv</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=not_IntegrableOn_Ioi_inv#doc\">docs#not_IntegrableOn_Ioi_inv</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=measurePreserving_quotientGroup_mk_of_QuotientMeasureEqMeasurePreimage#doc\">docs#measurePreserving_quotientGroup_mk_of_QuotientMeasureEqMeasurePreimage</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsFundamentalDomain.QuotientMeasureEqMeasurePreimage_HaarMeasure#doc\">docs#IsFundamentalDomain.QuotientMeasureEqMeasurePreimage_HaarMeasure</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ext_of_forall_lintegral_eq_of_IsFiniteMeasure#doc\">docs#ext_of_forall_lintegral_eq_of_IsFiniteMeasure</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=isUltrahomogeneous_iff_IsExtensionPair#doc\">docs#isUltrahomogeneous_iff_IsExtensionPair</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=valuation_eq_LaurentSeries_valuation#doc\">docs#valuation_eq_LaurentSeries_valuation</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=norm_Integral_le_one#doc\">docs#norm_Integral_le_one</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=meromorphicTrailingCoeffAt_of_not_MeromorphicAt#doc\">docs#meromorphicTrailingCoeffAt_of_not_MeromorphicAt</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=to_Module_monoidAlgebra_map_aux#doc\">docs#to_Module_monoidAlgebra_map_aux</a></li>\n</ul>\n<p>Help with fixing them is very welcome!</p>",
        "id": 570093015,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1769434552
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/21359473455/job/61474794820?pr=34440\">This CI run</a> will have more results.</p>",
        "id": 570093062,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1769434562
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598052\">@Jeremy Tan</span> <span class=\"user-mention\" data-user-id=\"767479\">@Harald Husum</span> If you're looking for a task to help at, taking a declaration from this list (or several in the same file) and proposing a rename could be helpful.</p>",
        "id": 570093728,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1769434722
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/34452\">#34452</a> fixes the ordinal one</p>",
        "id": 570103746,
        "sender_full_name": "Violeta Hern√°ndez",
        "timestamp": 1769437152
    },
    {
        "content": "<p>I don't think any of these are false positives.</p>",
        "id": 570107737,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1769438061
    },
    {
        "content": "<p>And <a href=\"https://github.com/leanprover-community/mathlib4/pull/34454\">#34454</a> fixes the Mahler measure one</p>",
        "id": 570108836,
        "sender_full_name": "Violeta Hern√°ndez",
        "timestamp": 1769438315
    },
    {
        "content": "<p>The CI log has some warnings which arguably are linter false positives. And a lot of true positives.</p>",
        "id": 570111507,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1769438871
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/34483\">#34483</a> fixes three names in <code>Moments/SubGaussian.lean</code></p>",
        "id": 570309774,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1769517661
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/34440\">#34440</a> should now be ready for review: I converted it to an environment linter and added all current violations as exceptions. There are about 660 of them; most appear to be true positives. (If you spot a false pattern that should be allowed as an exception, let me know; this is easy to add.)</p>",
        "id": 570576782,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1769611428
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/34519\">#34519</a> is a new linter for definitions whose names contain underscores: at the moment, there are 1000 exceptions (added to <code>nolints.json</code>). PRs fixing violations are very welcome; hints for avoiding some more false positives also.</p>",
        "id": 570578664,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1769611842
    },
    {
        "content": "<p>(deleted) I see this is already discussed in the PR and the nolints.json does not yet reflect the new rules.</p>",
        "id": 570595933,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1769615420
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 570596621,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1769615573
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 570596889,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1769615640
    },
    {
        "content": "<p>There are new 550 exceptions for the linter in <a href=\"https://github.com/leanprover-community/mathlib4/pull/34519\">#34519</a> - much better!</p>",
        "id": 570617527,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1769620531
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/35055\">#35055</a> fixes another misnamed declaration</p>",
        "id": 572891662,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1770672964
    },
    {
        "content": "<p>It would make me rather sad if the Gamma function, or the congruence subgroups (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">Œì</mi><mn>0</mn></msub><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\Gamma_0(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\">Œì</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> etc), were to be lowercased. We should not prioritize \"consistency with rules mathlib has made for itself\" over \"consistency  with widespread standard conventions in real-world mathematics\".</p>",
        "id": 573886773,
        "sender_full_name": "David Loeffler",
        "timestamp": 1771066791
    },
    {
        "content": "<p>But we're not using <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Œì</mi></mrow><annotation encoding=\"application/x-tex\">\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Œì</span></span></span></span> in either case</p>",
        "id": 573887003,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1771066937
    },
    {
        "content": "<p>I'm sure the naming convention can always be extended with exceptions which can be reflected by any linter, if there is the desire for one.</p>\n<p>I think it's reasonable that <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Real.Gamma#doc\">docs#Real.Gamma</a> falls into the same exception as e.g. <code>Icc</code> <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span> (or would at least require a larger Zulip discussion if there would be any intend to lowercase it)</p>",
        "id": 573888599,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1771068256
    },
    {
        "content": "<p>I'm fine with making an explicit exception, if there is consensus!</p>",
        "id": 573893683,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1771072365
    }
]