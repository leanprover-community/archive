[
    {
        "content": "<p>Now that the last entry (<a href=\"https://github.com/leanprover-community/mathlib4/pull/25744\">#25744</a>) in the \"joins of categories\" series have been merged, I don’t think there is much benefit of having <code>WithTerminal</code> and <code>WithInitial</code> as separate constructions: they are joins of <code>C</code> with <code>Discrete PUnit</code>.<br>\nAlmost all constructions for <code>WithTerminal</code> (except the identification between functors out of joins with suitable comma categories) are available as <code>Join</code> construction, so I would like to suggest redefining <code>WithTerminal</code> (and the relevant objects) as an abbrev for <code>C ⋆ Discrete PUnit.{1}</code>. Any objections?</p>",
        "id": 525205545,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1750587777
    },
    {
        "content": "<p>How does that interact with replacing <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Limits.WidePullbackShape#doc\">docs#CategoryTheory.Limits.WidePullbackShape</a> with <code>WithTerminal</code>?</p>",
        "id": 525206256,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1750588953
    },
    {
        "content": "<p>Do you have a wip PR doing this?</p>\n<p>I don’t see it being much harder. Joins have nice universal properties to construct and characterize up to iso functors out of them, there’s an induction principle for maps, and <code>WithTerminal.lift</code> (arguably the only way one should define a functor from a <code>WithTerminal</code>) should remain the same.</p>\n<p>I was thinking of also doing </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">match_pattern</span><span class=\"kd\">]</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">star</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTerminal</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Join</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"w\"> </span><span class=\"bp\">⟨.</span><span class=\"n\">unit</span><span class=\"bp\">⟩</span>\n<span class=\"kd\">@[</span><span class=\"n\">match_pattern</span><span class=\"kd\">]</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTerminal</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Join</span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"w\"> </span><span class=\"n\">c</span>\n</code></pre></div>\n<p>so that match statement on objects can literally remain the same.</p>\n<p>So tl;dr I don’t think this would have much interaction/negative impact.</p>",
        "id": 525206486,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1750589355
    },
    {
        "content": "<p>(For match on morphisms, they’d be almost the same but aesop has slight trouble using the induction principle for maps, so I feel it’s better anyway in contsructions to go through the provided \"universal properties\" constructors rather than direct constructions).</p>",
        "id": 525206542,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1750589444
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"286014\">Robin Carlier</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Refactoring.20.60WithTerminal.60/near/525206486\">said</a>:</p>\n<blockquote>\n<p>Do you have a wip PR doing this?</p>\n</blockquote>\n<p>No, I was waiting on <span class=\"user-mention\" data-user-id=\"894382\">@Moisés Herradón Cueto</span>'s work to hit mathlib fully before starting such a refactor</p>",
        "id": 525207609,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1750590907
    },
    {
        "content": "<p>I agree that both Robin's and Yaël's refactors are good ideas here, and that they can (and should) coexist.</p>",
        "id": 525211205,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1750596214
    }
]