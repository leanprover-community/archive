[
    {
        "content": "<p>I understand why we don't make <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Fintype.ofFinite#doc\">docs#Fintype.ofFinite</a> an instance by default, as it makes <code>Fintype</code> noncomputable.  But perhaps it would be safe to make such an instance after one opens <code>Classical</code>?  I found it annoying that I could not write down <code>∑ x, f x</code> when the type <code>X</code> of <code>x</code> had only a finite instance <code>[Finite X]</code> and not a Fintype instance <code>[Fintype X]</code>; having typeclass inference supply this when working in a classical setting in which I do not care about computation would be convenient.</p>",
        "id": 528154839,
        "sender_full_name": "Terence Tao",
        "timestamp": 1752179494
    },
    {
        "content": "<p>If this happens, it should be a low priority instance like how <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Classical.propDecidable#doc\">docs#Classical.propDecidable</a> is <code>(priority := low)</code>.</p>",
        "id": 528155658,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752179857
    },
    {
        "content": "<p>This is a priori a bad idea as it would let you write lemmas that are syntactically under general, but actually this is exactly the situation <code>Decidable</code> already enjoys. At any rate, it should be lower priority.</p>",
        "id": 528155727,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1752179896
    },
    {
        "content": "<p>On the other hand it's in general quite annoying when you have to randomly add decidable instances in situations where you are never going to compute anything, I'm finding this situation in group homology right now and it's difficult to explain to mathematicians</p>",
        "id": 528160435,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1752182286
    },
    {
        "content": "<p>But then on the other hand we want a sum to be computable when it's on a fintype so that we can easily reduce a sum on a concrete type like <code>Fin 37</code>, I think?</p>",
        "id": 528177087,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752192746
    },
    {
        "content": "<p>This is looking just like the situation with <code>Decidable</code> to me</p>",
        "id": 528177477,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752193131
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"657719\">Terence Tao</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Could.20Fintype.2EofFinite.20be.20made.20an.20instance.20inside.20Classical.3F/near/528154839\">said</a>:</p>\n<blockquote>\n<p>But perhaps it would be safe to make such an instance after one opens <code>Classical</code>?</p>\n</blockquote>\n<p>I think there's no reason not to do this. I've suggested adding it to the <code>classical</code> tactic, but an obstruction now is that this is a core Lean tactic.</p>\n<p>However, we shouldn't ever make <code>Fintype.ofFinite</code> a global instance. This would poison the computability of <code>Fintype</code>, whose raison d'être is to be computable. This should be some pressure to make things more <code>Finite</code> (I'd like a future where sums all use <code>Finite</code> and there's an easy way to reflect sums to <code>Finset.sum</code> to compute them when needed.)</p>",
        "id": 528404659,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752267118
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Could.20Fintype.2EofFinite.20be.20made.20an.20instance.20inside.20Classical.3F/near/528404659\">said</a>:</p>\n<blockquote>\n<p>I think there's no reason not to do this. I've suggested adding it to the <code>classical</code> tactic, but an obstruction now is that this is a core Lean tactic.</p>\n</blockquote>\n<p>I guess <a href=\"https://github.com/leanprover/lean4/pull/7948\">lean4#7948</a> would resolve this, if I could get it to build.</p>\n<p>Is the problem that there is no <code>builtin_macro_rules</code>?</p>",
        "id": 528405660,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1752267620
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Could.20Fintype.2EofFinite.20be.20made.20an.20instance.20inside.20Classical.3F/near/528404659\">said</a>:</p>\n<blockquote>\n<p>I'd like a future where sums all use <code>Finite</code> and there's an easy way to reflect sums to <code>Finset.sum</code> to compute them when needed.)</p>\n</blockquote>\n<p>What scares me most about this is that everything implemented in terms of such summations (<a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=dotProduct#doc\">docs#dotProduct</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matrix.instRing#doc\">docs#Matrix.instRing</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=DirectSum.toAddMonoid#doc\">docs#DirectSum.toAddMonoid</a>, etc) has to somehow opt into this reflection too, and the boilerplate to do this is surely far greater than the cost of <code>Finite.toFinite</code> inside proofs</p>",
        "id": 528405933,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1752267765
    },
    {
        "content": "<p>Yeah, that's a valid concern. I think some research is needed here, it's not a 'let's \"just\" do this' situation.</p>",
        "id": 528407683,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752268799
    },
    {
        "content": "<p>I think we could \"just do this\" for the titular suggestion though</p>",
        "id": 528408058,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1752269024
    },
    {
        "content": "<p>Do you think you could adopt <a href=\"https://github.com/leanprover/lean4/pull/7948\">lean4#7948</a>? I assume there's some bootstrapping / <code>builtin_</code> thing I'm missing.</p>",
        "id": 528408105,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1752269048
    },
    {
        "content": "<p>is this something that <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=finsum#doc\">docs#finsum</a> was supposed to help with?</p>",
        "id": 528424071,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1752284611
    }
]