[
    {
        "content": "<p>In the following example, <code>⋂₀</code> seems to sometimes get confused about whether it's the <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Set.sInter#doc\">docs#Set.sInter</a> or <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Class.sInter#doc\">docs#Class.sInter</a> operator.</p>\n<p>What's particularly weird is that this seems to only be a problem when inside <code>=</code>; it elaborates just fine with <code>Eq</code> or directly:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- imported to create ambiguity; all the examples below want the `Set` version</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">SetTheory</span><span class=\"bp\">.</span><span class=\"n\">ZFC</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"c1\">-- works as a top-level term</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⋂₀</span><span class=\"w\"> </span><span class=\"n\">setOf</span><span class=\"w\"> </span><span class=\"n\">P</span>\n\n<span class=\"c1\">-- does not work in a equality</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsFoo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⋂₀</span><span class=\"w\"> </span><span class=\"n\">setOf</span><span class=\"w\"> </span><span class=\"n\">P</span>\n\n<span class=\"c1\">-- unless we avoid using notation!</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsFoo2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Eq</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⋂₀</span><span class=\"w\"> </span><span class=\"n\">setOf</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 483696113,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1732195815
    },
    {
        "content": "<p>Should <code>Class.sInter</code> be scoped to avoid this issue for users of <code>import Mathlib</code> who don't care about ZFC?</p>",
        "id": 483697135,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1732196090
    },
    {
        "content": "<p>Or is there some way to fix this so that the ambiguity never arises?</p>",
        "id": 483697171,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1732196101
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Ambiguous.20.E2.8B.82.E2.82.80.20notation.20.28ZFC.29.20and.20binrel.20elaborators/near/483697135\">said</a>:</p>\n<blockquote>\n<p>Should <code>Class.sInter</code> be scoped to avoid this issue for users of <code>import Mathlib</code> who don't care about ZFC?</p>\n</blockquote>\n<p>This is a problem even for users who care about ZFC, since it also clashes with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ZFSet.sInter#doc\">docs#ZFSet.sInter</a></p>",
        "id": 483820613,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732239511
    }
]