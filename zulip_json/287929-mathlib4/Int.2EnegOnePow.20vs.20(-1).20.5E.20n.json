[
    {
        "content": "<p>Do we have guidelines for using <code>Int.negOnePow n</code> vs <code>(-1) ^ n</code>? CC: <span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> <a href=\"https://en.wikipedia.org/wiki/XY_problem\">#xy</a>: which one should be used in <a href=\"https://github.com/leanprover-community/mathlib4/pull/33972\">#33972</a>?</p>",
        "id": 575337739,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1771863489
    },
    {
        "content": "<p>What benefits does one have over the other? I imagine <code>Int.negOnePow</code> should work under much looser typeclass hypotheses, while <code>(-1)^n</code> comes with all the preexisting API for exponentiation.</p>",
        "id": 575379522,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1771874144
    },
    {
        "content": "<p>Maybe the rule should be that <code>negOnePow n</code> simps to <code>(-1)^n</code> over a group?</p>",
        "id": 575379602,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1771874174
    },
    {
        "content": "<p>I personally prefer (-1)^n when n is Nat, and Int.negOnePow when n is Int. (-1)^n is often easier to use, because e.g. ring tactic can handle it</p>",
        "id": 575379640,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1771874189
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Int.negOnePow#doc\">docs#Int.negOnePow</a></p>",
        "id": 575379846,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1771874259
    },
    {
        "content": "<p>(I have <a href=\"https://github.com/leanprover-community/mathlib4/pull/33143\">#33143</a> that shows my preference)</p>",
        "id": 575379874,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1771874268
    },
    {
        "content": "<p>Weiyi and Violeta; do you mean you prefer <code>(-1 : ℤˣ) ^ n</code> or <code>(-1 : R) ^ n</code>?</p>",
        "id": 575380844,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1771874624
    },
    {
        "content": "<p>I prefer the latter whenever it type-checks (unless the whole expression is in Z^x)</p>",
        "id": 575381462,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1771874833
    },
    {
        "content": "<p>I think I'd be inclined towards the former? But I don't have a strong preference here.</p>",
        "id": 575382987,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1771875379
    },
    {
        "content": "<p>My totally uninformed take is that as a mathematician, I immediately understand what <code>(-1) ^ n</code> means, but parsing <code>Int.negOnePow n</code> or <code>n.negOnePow</code> takes a few seconds to process.</p>",
        "id": 575384095,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1771875783
    },
    {
        "content": "<p>Let's wait for Johan. I don't see why <code>Int.negOnePow</code> is better than <code>(-1 : ℤˣ) ^ n</code>.</p>",
        "id": 575384173,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1771875819
    },
    {
        "content": "<p>I think the idea of <code>Int.negOnePow</code> was to standardize on <code>(-1 : ℤˣ) ^ n</code> instead of <code>(-1 : R) ^ n</code></p>",
        "id": 575384519,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1771875938
    },
    {
        "content": "<p>I would use <code>(-1 : R) ^ n</code> for coercion (whenever it's defined).</p>",
        "id": 575384830,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1771876044
    },
    {
        "content": "<p>By \"for coercion\" you mean \"so as to avoid a coercion\"?</p>",
        "id": 575384929,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1771876077
    },
    {
        "content": "<p>I mean, instead of a coercion of <code>Units Int</code> to <code>Int</code> or other ring/field.</p>",
        "id": 575385023,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1771876103
    },
    {
        "content": "<p>Sorry for my late response. I don't have a strong opinion on one or the other.<br>\nIf I had one in the past, I should have documented it in the docstring on <code>Int.negOnePow</code>.</p>",
        "id": 575446851,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1771905610
    },
    {
        "content": "<p>Perhaps the discussion on the original pr that added it has some context?</p>",
        "id": 575448182,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1771906555
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/6720\">#6720</a></p>",
        "id": 575454473,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1771910245
    },
    {
        "content": "<p>As far as I can remember, I used <code>Int.negOnePow</code> in order to multiply certain morphisms in preadditive categories by signs as part of the formalization of homological algebra. There may have been issues with missing API regarding <code>SMul ℤˣ M</code> instances obtained from <code>SMul ℤ M</code>, but I do not remember the details. I would not mind if someone experimented making <code>Int.negOnePow</code> an abbrev (or removing it), while keeping certain lemmas (which may be generalized to other rings).</p>",
        "id": 575549601,
        "sender_full_name": "Joël Riou",
        "timestamp": 1771941879
    }
]