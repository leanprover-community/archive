[
    {
        "content": "<p>I'm using this neovim plugin: <a href=\"https://github.com/Julian/lean.nvim\">https://github.com/Julian/lean.nvim</a></p>\n<p>I'm noticing that when I have <code>import Mathlib</code> in a file, neovim gets really bogged down. I think it is recompiling Mathlib every time, and I'm not sure why it's doing that since compiling the same project locally with Mathlib already compiled on the system doesn't seem to be this slow. Anything I can try?</p>",
        "id": 486735166,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733634002
    },
    {
        "content": "<p>Can you close all lean files, <code>killall lean</code> (OS-dependent, means killing all lean processes), <code>lake build</code> the project, then open the file again?</p>",
        "id": 486735732,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733634266
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20import.20performance.20in.20neovim/near/486735732\">said</a>:</p>\n<blockquote>\n<p>Can you close all lean files, <code>killall lean</code> (OS-dependent, means killing all lean processes), <code>lake build</code> the project, then open the file again?</p>\n</blockquote>\n<p>looks like nvim still wants to do something with the <code>import Mathlib</code> line that takes a long time and results in displaying \"Processing file...\" in the output pane in the editor</p>",
        "id": 486735949,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733634474
    },
    {
        "content": "<p>also when I recompile I get a bunch of warnings from the mathlib code taht aren't in my code, is that normal?</p>",
        "id": 486735997,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733634491
    },
    {
        "content": "<p>What warnings?</p>",
        "id": 486736163,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733634671
    },
    {
        "content": "<p>Does \"long time\" mean \"tens of seconds\", \"minutes\", or \"tens of minutes\"?</p>",
        "id": 486736196,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733634722
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20import.20performance.20in.20neovim/near/486736196\">said</a>:</p>\n<blockquote>\n<p>Does \"long time\" mean \"tens of seconds\", \"minutes\", or \"tens of minutes\"?</p>\n</blockquote>\n<p>minutes</p>",
        "id": 486736236,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733634745
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20import.20performance.20in.20neovim/near/486736163\">said</a>:</p>\n<blockquote>\n<p>What warnings?</p>\n</blockquote>\n<p>pages of stuff like:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/././</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">NormNum</span><span class=\"bp\">/</span><span class=\"n\">BigOperators</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">101</span><span class=\"o\">:</span><span class=\"mi\">6</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Mathlib.Meta.List.range_succ_eq_map'</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">string</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">please</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"bp\">.</span>\n<span class=\"n\">Declarations</span><span class=\"w\"> </span><span class=\"n\">whose</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"n\">ends</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">`'`</span><span class=\"w\"> </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">contain</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">explanation</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">presence</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">`'`</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">their</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">string</span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">may</span><span class=\"w\"> </span><span class=\"n\">consist</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">discussion</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">difference</span><span class=\"w\"> </span><span class=\"n\">relative</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">unprimed</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">explanation</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">why</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">better</span><span class=\"w\"> </span><span class=\"n\">naming</span><span class=\"w\"> </span><span class=\"n\">scheme</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">possible</span><span class=\"bp\">.</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">docPrime</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/././</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">NormNum</span><span class=\"bp\">/</span><span class=\"n\">BigOperators</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">176</span><span class=\"o\">:</span><span class=\"mi\">6</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Mathlib.Meta.Multiset.range_zero'</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">string</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">please</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"bp\">.</span>\n<span class=\"n\">Declarations</span><span class=\"w\"> </span><span class=\"n\">whose</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"n\">ends</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">`'`</span><span class=\"w\"> </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">contain</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">explanation</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">presence</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">`'`</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">their</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">string</span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">may</span><span class=\"w\"> </span><span class=\"n\">consist</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">discussion</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">difference</span><span class=\"w\"> </span><span class=\"n\">relative</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">unprimed</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">explanation</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">why</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">better</span><span class=\"w\"> </span><span class=\"n\">naming</span><span class=\"w\"> </span><span class=\"n\">scheme</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">possible</span><span class=\"bp\">.</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">docPrime</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/././</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">NormNum</span><span class=\"bp\">/</span><span class=\"n\">BigOperators</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">179</span><span class=\"o\">:</span><span class=\"mi\">6</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Mathlib.Meta.Multiset.range_succ'</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">string</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">please</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"bp\">.</span>\n<span class=\"n\">Declarations</span><span class=\"w\"> </span><span class=\"n\">whose</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"n\">ends</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">`'`</span><span class=\"w\"> </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">contain</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">explanation</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">presence</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">`'`</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">their</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">string</span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">may</span><span class=\"w\"> </span><span class=\"n\">consist</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">discussion</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">difference</span><span class=\"w\"> </span><span class=\"n\">relative</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">unprimed</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">explanation</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">why</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">better</span><span class=\"w\"> </span><span class=\"n\">naming</span><span class=\"w\"> </span><span class=\"n\">scheme</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">possible</span><span class=\"bp\">.</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">docPrime</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/././</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">NormNum</span><span class=\"bp\">/</span><span class=\"n\">BigOperators</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">245</span><span class=\"o\">:</span><span class=\"mi\">6</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Mathlib.Meta.Finset.range_zero'</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">string</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">please</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"bp\">.</span>\n<span class=\"n\">Declarations</span><span class=\"w\"> </span><span class=\"n\">whose</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"n\">ends</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">`'`</span><span class=\"w\"> </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">contain</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">explanation</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">presence</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">`'`</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">their</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">string</span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">may</span><span class=\"w\"> </span><span class=\"n\">consist</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">discussion</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">difference</span><span class=\"w\"> </span><span class=\"n\">relative</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">unprimed</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">explanation</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">why</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">better</span><span class=\"w\"> </span><span class=\"n\">naming</span><span class=\"w\"> </span><span class=\"n\">scheme</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">possible</span><span class=\"bp\">.</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">docPrime</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/././</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">NormNum</span><span class=\"bp\">/</span><span class=\"n\">BigOperators</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">248</span><span class=\"o\">:</span><span class=\"mi\">6</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Mathlib.Meta.Finset.range_succ'</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">string</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">please</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"bp\">.</span>\n<span class=\"n\">Declarations</span><span class=\"w\"> </span><span class=\"n\">whose</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"n\">ends</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">`'`</span><span class=\"w\"> </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">contain</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">explanation</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">presence</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">`'`</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">their</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">string</span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">may</span><span class=\"w\"> </span><span class=\"n\">consist</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">discussion</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">difference</span><span class=\"w\"> </span><span class=\"n\">relative</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">unprimed</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">explanation</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">why</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">better</span><span class=\"w\"> </span><span class=\"n\">naming</span><span class=\"w\"> </span><span class=\"n\">scheme</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">possible</span><span class=\"bp\">.</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">docPrime</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">⚠</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">5585</span><span class=\"bp\">/</span><span class=\"mi\">11444</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Replayed</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">NormNum</span><span class=\"bp\">.</span><span class=\"n\">LegendreSymbol</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/././</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">NormNum</span><span class=\"bp\">/</span><span class=\"n\">LegendreSymbol</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">162</span><span class=\"o\">:</span><span class=\"mi\">8</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Mathlib.Meta.NormNum.jacobiSymNat.qr₁'</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">string</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">please</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"bp\">.</span>\n<span class=\"n\">Declarations</span><span class=\"w\"> </span><span class=\"n\">whose</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"n\">ends</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">`'`</span><span class=\"w\"> </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">contain</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">explanation</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">presence</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">`'`</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">their</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">string</span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">may</span><span class=\"w\"> </span><span class=\"n\">consist</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">discussion</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">difference</span><span class=\"w\"> </span><span class=\"n\">relative</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">unprimed</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">explanation</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">why</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">better</span><span class=\"w\"> </span><span class=\"n\">naming</span><span class=\"w\"> </span><span class=\"n\">scheme</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">possible</span><span class=\"bp\">.</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">docPrime</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">⚠</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">5623</span><span class=\"bp\">/</span><span class=\"mi\">11444</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Replayed</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">LinearPMap</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/././</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Topology</span><span class=\"bp\">/</span><span class=\"n\">Algebra</span><span class=\"bp\">/</span><span class=\"n\">Module</span><span class=\"bp\">/</span><span class=\"n\">LinearPMap</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">97</span><span class=\"o\">:</span><span class=\"mi\">8</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`LinearPMap.closure_def'</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">string</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">please</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"bp\">.</span>\n<span class=\"n\">Declarations</span><span class=\"w\"> </span><span class=\"n\">whose</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"n\">ends</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">`'`</span><span class=\"w\"> </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">contain</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">explanation</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">presence</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">`'`</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">their</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">string</span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">may</span><span class=\"w\"> </span><span class=\"n\">consist</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">discussion</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">difference</span><span class=\"w\"> </span><span class=\"n\">relative</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">unprimed</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">explanation</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">why</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">better</span><span class=\"w\"> </span><span class=\"n\">naming</span><span class=\"w\"> </span><span class=\"n\">scheme</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">possible</span><span class=\"bp\">.</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">docPrime</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">⚠</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">5645</span><span class=\"bp\">/</span><span class=\"mi\">11444</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Replayed</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"n\">Profinite</span><span class=\"bp\">.</span><span class=\"n\">Nobeling</span>\n</code></pre></div>",
        "id": 486736259,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733634797
    },
    {
        "content": "<p>Why do you have 11K files to compile?</p>",
        "id": 486736330,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733634875
    },
    {
        "content": "<p>Is your project that big?</p>",
        "id": 486736335,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733634885
    },
    {
        "content": "<p>no I would guess that I installed mathlib incorrectly, my project is like six files</p>",
        "id": 486736354,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733634903
    },
    {
        "content": "<p>Mathlib is &lt;6K files.</p>",
        "id": 486736365,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733634917
    },
    {
        "content": "<p>mathlib + batteries?</p>",
        "id": 486736372,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733634926
    },
    {
        "content": "<p>I have no idea what that number is supposed to be, or even that it indicated files</p>",
        "id": 486736381,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733634939
    },
    {
        "content": "<p>If I run <code>lake build</code> in Mathlib, then it shows &lt;6K files.</p>",
        "id": 486736386,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733634944
    },
    {
        "content": "<p>I also have batteries in this project</p>",
        "id": 486736395,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733634957
    },
    {
        "content": "<p>What's your lakefile?</p>",
        "id": 486736447,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733634979
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"aoc\"</span>\n<span class=\"n\">version</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"0.1.0\"</span>\n<span class=\"n\">defaultTargets</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"s2\">\"aoc\"</span><span class=\"o\">]</span>\n\n<span class=\"o\">[[</span><span class=\"n\">lean_lib</span><span class=\"o\">]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"Aoc\"</span>\n\n<span class=\"o\">[[</span><span class=\"n\">lean_exe</span><span class=\"o\">]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"aoc\"</span>\n<span class=\"n\">root</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"Main\"</span>\n\n<span class=\"o\">[[</span><span class=\"n\">require</span><span class=\"o\">]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"batteries\"</span>\n<span class=\"n\">scope</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"leanprover-community\"</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"main\"</span>\n\n<span class=\"o\">[[</span><span class=\"n\">require</span><span class=\"o\">]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"mathlib\"</span>\n<span class=\"n\">scope</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"leanprover-community\"</span>\n</code></pre></div>",
        "id": 486736455,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733634990
    },
    {
        "content": "<p><code>Mathlib</code> already depends on <code>batteries</code>, so no need to add batteries as another dependency.</p>",
        "id": 486736499,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733635054
    },
    {
        "content": "<p>I'm gonna try <code>lake clean</code> and rebuilding</p>",
        "id": 486736500,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733635057
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20import.20performance.20in.20neovim/near/486736499\">said</a>:</p>\n<blockquote>\n<p><code>Mathlib</code> already depends on <code>batteries</code>, so no need to add batteries as another dependency.</p>\n</blockquote>\n<p>huh so does explicitly adding it mean it double-compiles?</p>",
        "id": 486736508,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733635072
    },
    {
        "content": "<p>I'm not sure what happens in this case. I hope, it doesn't try to recompile Mathlib against your version of batteries.</p>",
        "id": 486736649,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733635109
    },
    {
        "content": "<p>Do you <code>import Mathlib</code> in a file that has executable code?</p>",
        "id": 486736696,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733635197
    },
    {
        "content": "<p>If yes, then it tries to <strong>compile</strong> the whole Mathlib.</p>",
        "id": 486736750,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733635211
    },
    {
        "content": "<p>hm, so should I avoid that?</p>",
        "id": 486736759,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733635222
    },
    {
        "content": "<p>And this can explain the huge number (most of the files are built, then compiled).</p>",
        "id": 486736769,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733635232
    },
    {
        "content": "<p>I thought I had to use <code>import Mathlib</code> in the file in order to use it</p>",
        "id": 486736775,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733635235
    },
    {
        "content": "<p>You should <code>import Mathlib.Some.File</code> for Mathlib files that you actually need.</p>",
        "id": 486736797,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733635260
    },
    {
        "content": "<p>The file with the binary should have minimal dependencies.</p>",
        "id": 486736816,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733635277
    },
    {
        "content": "<p>often I'm importing something because I want to <code>#eval</code> it in a file and see what it does</p>",
        "id": 486736839,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733635311
    },
    {
        "content": "<p>and I don't know exactly what path to import</p>",
        "id": 486736846,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733635319
    },
    {
        "content": "<p>Then you can <code>lake exe aoc</code> so that all of Mathlib gets compiled.</p>",
        "id": 486736904,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733635357
    },
    {
        "content": "<p>About warnings: it looks like some of our \"nolints\" don't work well for downstream projects. <span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span>  wrote this linter.</p>",
        "id": 486737002,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733635449
    },
    {
        "content": "<p>UPD: no, I don't think that it should compile (not build) all of Mathlib on <code>import Mathlib</code>, so my previous advice is probably useless.</p>",
        "id": 486737036,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733635498
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span> is the author of the nvim plugin. Julian, what do you think is happening here?</p>",
        "id": 486737139,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733635584
    },
    {
        "content": "<p>ok I just removed the separate batteries specification in the file and ran <code>lake update</code> and am rebuilding. I still see 11450 files so I guess that is batteries + mathlib</p>",
        "id": 486737201,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733635678
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"785542\">Greg Shuflin</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20import.20performance.20in.20neovim/near/486736839\">said</a>:</p>\n<blockquote>\n<p>often I'm importing something because I want to <code>#eval</code> it in a file and see what it does</p>\n</blockquote>\n<p>You don't need to compile it to <code>#eval</code> it</p>",
        "id": 486737289,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1733635768
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"690858\">Daniel Weber</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20import.20performance.20in.20neovim/near/486737289\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"785542\">Greg Shuflin</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20import.20performance.20in.20neovim/near/486736839\">said</a>:</p>\n<blockquote>\n<p>often I'm importing something because I want to <code>#eval</code> it in a file and see what it does</p>\n</blockquote>\n<p>You don't need to compile it to <code>#eval</code> it</p>\n</blockquote>\n<p>I'm just typing <code>#eval &lt;some function from Mathlib&gt;</code> into my nvim window, I'm not telling it to compile anything explicitly</p>",
        "id": 486737363,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733635812
    },
    {
        "content": "<p>but yeah I've definitely noticed nvim getting sluggish when it's compiling in the background</p>",
        "id": 486737374,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733635829
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"785542\">Greg Shuflin</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20import.20performance.20in.20neovim/near/486736846\">said</a>:</p>\n<blockquote>\n<p>and I don't know exactly what path to import</p>\n</blockquote>\n<p>You can <code>import Mathlib</code> then use <code>#min_imports</code></p>",
        "id": 486744640,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1733642991
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20import.20performance.20in.20neovim/near/486744640\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"785542\">Greg Shuflin</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20import.20performance.20in.20neovim/near/486736846\">said</a>:</p>\n<blockquote>\n<p>and I don't know exactly what path to import</p>\n</blockquote>\n<p>You can <code>import Mathlib</code> then use <code>#min_imports</code></p>\n</blockquote>\n<p>what is <code>#min_imports</code>?</p>",
        "id": 486749799,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733647551
    },
    {
        "content": "<p>Try it <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span></p>",
        "id": 486750297,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1733647994
    },
    {
        "content": "<p>where in the documentation can I find it? I am not sure what effect I shoudl expect frrom just typing it randomly into source code</p>",
        "id": 486750326,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733648033
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">factorial_pos</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">factorial</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">exact?</span>\n\n<span class=\"bp\">#</span><span class=\"n\">min_imports</span>\n</code></pre></div>",
        "id": 486750380,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1733648047
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"785542\">Greg Shuflin</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20import.20performance.20in.20neovim/near/486750326\">said</a>:</p>\n<blockquote>\n<p>where in the documentation can I find it? I am not sure what effect I shoudl expect frrom just typing it randomly into source code</p>\n</blockquote>\n<p><code>unexpected token '#'; expected command</code></p>",
        "id": 486750882,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733648514
    },
    {
        "content": "<p>Have you tried my above code snippet?</p>",
        "id": 486750938,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1733648532
    },
    {
        "content": "<p>There is a button in the top right of the code snippet. Try clicking on it</p>",
        "id": 486750990,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1733648587
    },
    {
        "content": "<p>sure that works in the lean playground, and doesn't work in my code.</p>",
        "id": 486751022,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733648638
    },
    {
        "content": "<p>I'm not sure what the rules are for when you can use <code>#min_imports</code>, or what it should be doing</p>",
        "id": 486751083,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733648665
    },
    {
        "content": "<p>is it documented?</p>",
        "id": 486751091,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733648676
    },
    {
        "content": "<p>Yes, like anything in Lean you can Ctrl + click on it to see where it is defined</p>",
        "id": 486751288,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1733648849
    },
    {
        "content": "<p>in what program?</p>",
        "id": 486751312,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733648877
    },
    {
        "content": "<p>In vscode it certainly works. I don't know about emacs and neovim but hopefully they have analogous keybindings</p>",
        "id": 486751431,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1733648977
    },
    {
        "content": "<p>I will tell you what import you need, since I don't know how to jump to definition in neovim. Try <code>import Mathlib.Tactic.Common</code></p>",
        "id": 486751666,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1733649178
    },
    {
        "content": "<p>Isn't the problem here nothing to do with neovim or imports but simply that the Lakefile shouldn't be mentioning batteries?</p>",
        "id": 486755261,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1733652292
    },
    {
        "content": "<p>I am flying today and tomorrow so I'm not sure how closely I'll be able to read the thread, but yeah I'm a bit confused about the neovim-specific bit. Has the lakefile been fixed, what does it look like now?</p>",
        "id": 486761904,
        "sender_full_name": "Julian Berman",
        "timestamp": 1733657570
    },
    {
        "content": "<p>OK I see you said you removed it.</p>",
        "id": 486762239,
        "sender_full_name": "Julian Berman",
        "timestamp": 1733657844
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"785542\">Greg Shuflin</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20import.20performance.20in.20neovim/near/486735949\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20import.20performance.20in.20neovim/near/486735732\">said</a>:</p>\n<blockquote>\n<p>Can you close all lean files, <code>killall lean</code> (OS-dependent, means killing all lean processes), <code>lake build</code> the project, then open the file again?</p>\n</blockquote>\n<p>looks like nvim still wants to do something with the <code>import Mathlib</code> line that takes a long time and results in displaying \"Processing file...\" in the output pane in the editor</p>\n</blockquote>\n<p>So is this the issue? When you say \"takes a long time\" and displays that processing message -- I see you said \"minutes\" to how long that is -- <code>import Mathlib</code> is \"expected\" to take on the order of a minute or two to run depending on your machine (in any project at this point). Is that what you're seeing?</p>",
        "id": 486762355,
        "sender_full_name": "Julian Berman",
        "timestamp": 1733657946
    },
    {
        "content": "<p>You've run <code>lake exe cache get</code> right? Can you reproduce the slowness on the command line?</p>",
        "id": 486764869,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1733659952
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20import.20performance.20in.20neovim/near/486764869\">said</a>:</p>\n<blockquote>\n<p>You've run <code>lake exe cache get</code> right? Can you reproduce the slowness on the command line?</p>\n</blockquote>\n<p>so I have typed that command, but I am not sure if it actually ran as intended. I think what I originally did was add the lines to my lakefile.toml that involved importing Mathlib, and then ran <code>lake exe cache get</code>, ran into some error message that said I should run <code>lake update</code>, and then ran that, and that seemed to take a long time. but I forget exactly what things I tried at this point. I should say that I am pretty new to lean and dont' have a great intuitive sense of what commands do what or should do what but might be buggy</p>",
        "id": 486814619,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733702077
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20import.20performance.20in.20neovim/near/486755261\">said</a>:</p>\n<blockquote>\n<p>Isn't the problem here nothing to do with neovim or imports but simply that the Lakefile shouldn't be mentioning batteries?</p>\n</blockquote>\n<p>I originally had both <code>batteries</code> and <code>mathlib</code> as separate <code>[[require]]</code> lines in my <code>lakefile.toml</code>, I didn't realize that only mathlib was necessary until this thread I think</p>",
        "id": 486814658,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733702134
    },
    {
        "content": "<p>anyway, it looks like the behavior I'm seeing now is that if I open up a new file in my lake project in neovim, and type <code>import Mathlib</code> into it, I'm seeing <code>processing file...</code> in the evaluation pane for a few seconds (less than 10), and then the pane is capable of e.g. giving answers to <code>#eval</code> lines</p>",
        "id": 486814829,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733702298
    },
    {
        "content": "<p>That sounds like everything is working then for now to me</p>",
        "id": 486905025,
        "sender_full_name": "Julian Berman",
        "timestamp": 1733728741
    },
    {
        "content": "<p>Right?</p>",
        "id": 486905134,
        "sender_full_name": "Julian Berman",
        "timestamp": 1733728745
    },
    {
        "content": "<p>I think so</p>",
        "id": 486905779,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1733728769
    },
    {
        "content": "<p>Great!</p>",
        "id": 486906382,
        "sender_full_name": "Julian Berman",
        "timestamp": 1733728789
    },
    {
        "content": "<p>Complain if anything seems improvable (in neovim or otherwise)!</p>",
        "id": 486907256,
        "sender_full_name": "Julian Berman",
        "timestamp": 1733728821
    }
]