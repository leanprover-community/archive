[
    {
        "content": "<p>Currently, mathlib contains the statement <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Algebra/Subalgebra/Lattice.html#Algebra.mem_adjoin_of_mem\">Algebra.mem_adjoin_of_mem</a>, which says that <code>x ∈ adjoin R s</code> if <code>x ∈ s</code> for a subset <code>s</code> of an <code>R</code>-algebra <code>A</code>. There does not seem to be an analogous statement for the similar setting of Intermediate Fields. The proof there is not hard, but would it make sense to add this as an API lemma (and possibly tag it with aesop as done for <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Algebra/Subalgebra/Lattice.html#Algebra.mem_adjoin_of_mem\">Algebra.mem_adjoin_of_mem</a>)? At least it would make some of my proofs a bit cleaner.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">adjoin</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">mem_adjoin_of_mem</span><span class=\"w\"> </span><span class=\"n\">h</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">IntermediateField</span><span class=\"bp\">.</span><span class=\"n\">mem_adjoin_of_mem</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">IntermediateField</span><span class=\"bp\">.</span><span class=\"n\">adjoin</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">IntermediateField</span><span class=\"bp\">.</span><span class=\"n\">algebra_adjoin_le_adjoin</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">mem_adjoin_of_mem</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>",
        "id": 564456318,
        "sender_full_name": "Dion Leijnse",
        "timestamp": 1766063705
    },
    {
        "content": "<p>This is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IntermediateField.subset_adjoin#doc\">docs#IntermediateField.subset_adjoin</a></p>",
        "id": 564456759,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1766063826
    },
    {
        "content": "<p>Although arguably we could add an applied version for discoverability.</p>",
        "id": 564457209,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1766063960
    },
    {
        "content": "<p>Thanks, that also works. But I do agree that maybe adding the result for discoverability could help (at least then I could have found it with <code>exact?</code>).</p>",
        "id": 564459931,
        "sender_full_name": "Dion Leijnse",
        "timestamp": 1766064722
    },
    {
        "content": "<p>I added all these <code>mem_adjoin_of_mem</code> lemmas for the purpose of making <code>aesop</code> more efficient. Please feel free to add missing ones, and please <code>aesop</code> tag them the same way.</p>\n<p>More generally I am working on a refactor to unify all substructure closure operators. Once that is merged, all of these operations will have the same API.</p>",
        "id": 564493394,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1766072497
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/25963\">#25963</a> - uniform API for substructures</p>",
        "id": 564502230,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1766074501
    },
    {
        "content": "<p>I'm making a PR for this now, but I see that <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Algebra/Subalgebra/Lattice.html#Algebra.subset_adjoin\">Algebra.subset_adjoin</a> has the tag <code>@[simp, aesop safe 20 (rule_sets := [SetLike])]</code> which <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/FieldTheory/IntermediateField/Adjoin/Defs.html#IntermediateField.subset_adjoin\">IntermediateField.subset_adjoin</a> does not have. Do you think it's worth adding this also to <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/FieldTheory/IntermediateField/Adjoin/Defs.html#IntermediateField.subset_adjoin\">IntermediateField.subset_adjoin</a>?</p>",
        "id": 564764536,
        "sender_full_name": "Dion Leijnse",
        "timestamp": 1766172862
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"779251\">Dion Leijnse</span> <a href=\"#narrow/channel/287929-mathlib4/topic/IntermediateField.20mem_adjoin_of_mem/near/564764536\">said</a>:</p>\n<blockquote>\n<p>I'm making a PR for this now, but I see that <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Algebra/Subalgebra/Lattice.html#Algebra.subset_adjoin\">Algebra.subset_adjoin</a> has the tag <code>@[simp, aesop safe 20 (rule_sets := [SetLike])]</code> which <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/FieldTheory/IntermediateField/Adjoin/Defs.html#IntermediateField.subset_adjoin\">IntermediateField.subset_adjoin</a> does not have. Do you think it's worth adding this also to <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/FieldTheory/IntermediateField/Adjoin/Defs.html#IntermediateField.subset_adjoin\">IntermediateField.subset_adjoin</a>?</p>\n</blockquote>\n<p>Yeah, please make the APIs consistent if able. If you look at eg <code>Subgroup.closure</code> or <code>Subring.closure</code> you'll see they have the same theorems and attributes.</p>",
        "id": 564779121,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1766180469
    },
    {
        "content": "<p>I've made a PR for this: <a href=\"https://github.com/leanprover-community/mathlib4/pull/33122\">#33122</a></p>",
        "id": 564816383,
        "sender_full_name": "Dion Leijnse",
        "timestamp": 1766223844
    }
]