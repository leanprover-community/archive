[
    {
        "content": "<p>Hi!</p>\n<p>I was building mathlib, and I've recently learned that the build shouldn't take few hours, thanks to the cache. The cache got somehow broken on my machine. The steps from \"Downloading cached build files\" section of readme fixed it for me. The readme does even mention \"(Skipping this step means the next step will be very slow.)\".<br>\nMy problem was that I just assumed that a few hours for such a big project is considered fast.<br>\nI might be just the single case that had this problem, so maybe there's no need to change anything. But I would like to propose changing the readme. Maybe something like this?</p>\n<ul>\n<li>To obtain precompiled <code>olean</code> files, run <code>lake exe cache get</code>.</li>\n<li>To build <code>mathlib4</code> run <code>lake build</code>. (This should take just a few minutes on unmodified mathlib. If it tries to compile every file it means cache isn't working.)</li>\n</ul>",
        "id": 536964324,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1756623691
    },
    {
        "content": "<p>Good point; I like making this more specific.</p>",
        "id": 536965118,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1756624671
    },
    {
        "content": "<p>One complication is that \"very fast\" and \"very slow\" depend a lot on my computer. (The computers in CI (i.e., which produce the cache) build all of mathlib is 30, 45 minutes, for example.)</p>",
        "id": 536965148,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1756624724
    },
    {
        "content": "<p>Describing the successful case is exactly what I would do also.</p>",
        "id": 536965203,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1756624809
    },
    {
        "content": "<p>Maybe you can shorten \"a few minutes\" to \"a minute a most\"? I don't know if people consider 10 minutes still \"a few\".</p>",
        "id": 536965219,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1756624843
    },
    {
        "content": "<p>\"This shouldn't take longer than a minute\" then?</p>",
        "id": 536965253,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1756624887
    },
    {
        "content": "<p>Though, it might take a longer than a minute if you're on slow HDD maybe?</p>",
        "id": 536965299,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1756624950
    },
    {
        "content": "<p>The decompressing step alone usually takes a couple of minutes for me</p>",
        "id": 536995756,
        "sender_full_name": "Ben Eltschig",
        "timestamp": 1756660787
    },
    {
        "content": "<p>Do you have a huge <code>~/.cache/mathlib</code> directory and if so does deleting it help? The decompressing step can take a while if your drive has slow read/write speed</p>",
        "id": 537026299,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1756695919
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"646363\">Ben Eltschig</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Improve.20readme.20about.20cache/near/536995756\">said</a>:</p>\n<blockquote>\n<p>The decompressing step alone usually takes a couple of minutes for me</p>\n</blockquote>\n<p>Ah, but the \"This shouldn't take longer than a minute\" refers to <code>lake build</code> on unmodified mathlib, not <code>lake exe cache get</code>. Yeah for me it can take longer than a minute too.</p>",
        "id": 537027252,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1756696989
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"870257\">MrQubo</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Improve.20readme.20about.20cache/near/537027252\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"646363\">Ben Eltschig</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Improve.20readme.20about.20cache/near/536995756\">said</a>:</p>\n<blockquote>\n<p>The decompressing step alone usually takes a couple of minutes for me</p>\n</blockquote>\n<p>Ah, but the \"This shouldn't take longer than a minute\" refers to <code>lake build</code> on unmodified mathlib, not <code>lake exe cache get</code>. Yeah for me it can take longer than a minute too.</p>\n</blockquote>\n<p>Right, sorry - I misread that somehow.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Improve.20readme.20about.20cache/near/537026299\">said</a>:</p>\n<blockquote>\n<p>Do you have a huge <code>~/.cache/mathlib</code> directory and if so does deleting it help? The decompressing step can take a while if your drive has slow read/write speed</p>\n</blockquote>\n<p>About 10 gigabytes apparently. I would be surprised if deleting that helps with decompression speed, but I guess it's still good to know that that folder is there to free some space from time to time. Thanks <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 537027495,
        "sender_full_name": "Ben Eltschig",
        "timestamp": 1756697252
    }
]