[
    {
        "content": "<p>Currently, a few places in mathlib need <code>set_option maxSynthPendingDepth 2 in</code> (otherwise, some instances are not found). Some time ago, there was a discussion whether it could be worth it setting this as a global setting in mathlib, if the performance penalty is not too bad. Does someone know how I could test this change over all mathlib?</p>",
        "id": 499579408,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1739479271
    },
    {
        "content": "<p>(I mention this because <a href=\"https://github.com/leanprover-community/mathlib4/pull/20691\">#20691</a> removes an ad hoc instance, at the price of adding this incantation at three places. I think it's good, but it would be even better if the incantation was not needed at all...)</p>",
        "id": 499579582,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1739479337
    },
    {
        "content": "<p>Do we know which instance synthesis problems this option is helping with specifically?</p>",
        "id": 499580169,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739479542
    },
    {
        "content": "<p>I think it's always related to putting norms on spaces of continuous linear maps or continuous multilinear maps.</p>",
        "id": 499675575,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1739523040
    },
    {
        "content": "<p>You can put this option in the lakefile and then rebuild.</p>",
        "id": 499677329,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1739523502
    },
    {
        "content": "<p>I tried this at some point, and from memory there were failures, so I didn't even get to the point of measuring performance.</p>",
        "id": 499677455,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1739523540
    },
    {
        "content": "<p>One reason I'm wondering is that when I added the feature where all parent classes yield instances (it used to be only a subset of them), some tests contributed by Kevin Buzzard stopped needing a higher maxSynthPendingDepth.</p>\n<p>Currently Mathlib's parent class orders are not consistent. Potentially, if we take more care with making sure parent classes are in consistent orders, we might stop seeing failures. I don't have any theory to support this though. It would just be nice if somehow more tweaks to class parent handling would magically have a positive effect.</p>",
        "id": 499822760,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1739565268
    },
    {
        "content": "<p>I'm currently testing, in <a href=\"https://github.com/leanprover-community/mathlib4/pull/21887\">#21887</a>. For now, I've seen one failure (where simp became more powerful, applying a lemma it could not apply before), and issues in the infamous JacobiZariski (where I had to unfold the definition of delta to help Lean -- why is this monstrous definition not an <code>irreducible_def</code>, by the way?)</p>",
        "id": 499828640,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1739566743
    },
    {
        "content": "<p>Everything builds, with minor changes. Instructions count goes up by 0.24%, some files get worse, some files get better. Given that this removes a weird behavior, which is hard to understand or debug when it creates problems, I think we should merge this unless someone has a better solution.</p>",
        "id": 499898724,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1739611659
    },
    {
        "content": "<p>I think it's going to be confusing having the web editor with a different value for this setting than mathlib</p>",
        "id": 499911926,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1739624035
    },
    {
        "content": "<p>Should we push for the default in core to change at the same time?</p>",
        "id": 499911972,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1739624056
    },
    {
        "content": "<p>I agree it would be better to have the same change in core, but I'm not sure it would be welcome (<span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> , what do you think?). Otherwise, it would be just like autoimplicits. Is there a way to make the web editor pick up mathlib settings?</p>",
        "id": 499917065,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1739628622
    },
    {
        "content": "<p>We can edit the \"mathlib\" web editor settings at <a href=\"https://github.com/leanprover-community/lean4web/blob/main/Projects/mathlib-demo/lakefile.toml\">https://github.com/leanprover-community/lean4web/blob/main/Projects/mathlib-demo/lakefile.toml</a></p>",
        "id": 499925059,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1739634720
    },
    {
        "content": "<p>But remember that \"mathlib\" is the default setting for the web editor, so I'm not sure changes there would be welcome either.</p>",
        "id": 499925114,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1739634743
    },
    {
        "content": "<p>Yes, if Mathlib is happy, I'm happy to change the default in core.</p>",
        "id": 499967972,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1739670303
    },
    {
        "content": "<p>I've done some experiments with other values for <code>maxSynthPending</code>, as recommended by <span class=\"user-mention\" data-user-id=\"306577\">@Matthew Ballard</span>, and the result is interesting: for small values like 3 or 5, everything works just like for 2. But for a large value (I tried 50), I get just 3 failures throughout mathlib (see <a href=\"https://github.com/leanprover-community/mathlib4/pull/22035\">#22035</a>). I wonder if these failures are the symptom of bad instances somewhere, but I can't find the trace settings to investigate what is going on (and I don't really understand what pending instances are).</p>",
        "id": 501296676,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1740254309
    },
    {
        "content": "<p>We're at the triage meeting and have been sidetracked by this issue because it comes up in <a href=\"https://github.com/leanprover-community/mathlib4/pull/20691\">#20691</a> . The reason that setting the pending depth to 50 causes a random timeout in <code>RingTheory.Valuation.ValuationSubring</code> is that typeclass inference gets into some kind of nested loop, where it wants to prove decidability of <code>x1 ≤ x2</code> in a linear order but in order to do this it needs to prove decidability of <code>x1 ≤ x2</code> and if the pending depth is large then it just keeps going. As the pending depth increases, the time taken to process the instance <code>le_total_ideal</code> takes longer and longer, and for pending depth over 28 this leads to a timeout. Here's the trace for the loop:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>[] [0.863126] ✅️ apply @instDecidableLe_mathlib to DecidableRel fun x1 x2 ↦ x1 ≤ x2 ▼\n[tryResolve] [0.862980] ✅️ Decidable ((fun x1 x2 ↦ x1 ≤ x2) a b) ≟ Decidable (a ≤ b) ▼\n[isDefEq] [0.862380] ✅️ Decidable ((fun x1 x2 ↦ x1 ≤ x2) a b) =?= Decidable (?m.114929 a b ≤ ?m.114930 a b) ▼\n[] [0.862364] ✅️ (fun x1 x2 ↦ x1 ≤ x2) a b =?= ?m.114929 a b ≤ ?m.114930 a b ▼\n[] [0.862355] ✅️ a ≤ b =?= ?m.114929 a b ≤ ?m.114930 a b ▼\n[synthInstance] [0.861936] ✅️ Ideal ↥A → Ideal ↥A → LinearOrder (Ideal ↥A) ▼\n[] [0.000062] new goal Ideal ↥A → Ideal ↥A → LinearOrder (Ideal ↥A) ▶\n[] [0.001501] ✅️ apply ValuationRing.instLinearOrderIdealOfDecidableRelLe to Ideal ↥A → Ideal ↥A → LinearOrder (Ideal ↥A) ▶\n[] [0.000324] ✅️ apply @ValuationRing.toPreValuationRing to PreValuationRing ↥A ▶\n[] [0.010446] ✅️ apply @instValuationRingSubtypeMem to ValuationRing ↥A ▶\n[resume] [0.000017] propagating ValuationRing ↥A to subgoal ValuationRing ↥A of PreValuationRing ↥A ▶\n[resume] [0.000079] propagating PreValuationRing ↥A to subgoal PreValuationRing ↥A of Ideal ↥A → Ideal ↥A → LinearOrder (Ideal ↥A) ▶\n[resume] [0.000184] propagating Ideal ↥A → Ideal ↥A → PreValuationRing ↥A to subgoal Ideal ↥A → Ideal ↥A → PreValuationRing ↥A of Ideal ↥A → Ideal ↥A → LinearOrder (Ideal ↥A) ▶\n[] [0.000953] ❌️ apply @Ord.instDecidableRelLe to DecidableRel fun x1 x2 ↦ x1 ≤ x2 ▶\n[] [0.000799] ❌️ apply @instDecidableRelLe to DecidableRel fun x1 x2 ↦ x1 ≤ x2 ▶\n[] [0.823767] ✅️ apply @instDecidableLe_mathlib to DecidableRel fun x1 x2 ↦ x1 ≤ x2 ▼\n</code></pre></div>\n<p>(and away we go again)</p>",
        "id": 501497416,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740391844
    },
    {
        "content": "<p>Mathematically Lean wants to know why ideals in a valuation subring are linearly ordered (this is true mathematically) and it runs into this in mathlib:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableRel</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LinearOrder</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">decidableEqOfDecidableLE</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">decidableLTOfDecidableLE</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">Lattice</span><span class=\"bp\">.</span><span class=\"n\">toLinearOrder</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>and it's the decidability which seems to throw it into a loop.</p>",
        "id": 501498630,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740392181
    },
    {
        "content": "<p>Why is that a <code>have</code> and not a <code>let</code>?</p>",
        "id": 501499966,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1740392570
    },
    {
        "content": "<p>That's an interesting question!</p>\n<p>Another question which I've never been clear about is: why do we have <a href=\"https://github.com/leanprover-community/mathlib4/blob/8c8ef3cd84a9471f1477a9ba4c3a5667a25e32a3/Mathlib/Order/Defs/LinearOrder.lean#L57-L62\">all this decidable stuff</a> in the definition of a linear order anyway?</p>",
        "id": 501501295,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740392910
    },
    {
        "content": "<p>in words (and abstracting a bit), the loop is \"I need to find <code>DecidableRel (. &lt;= .)</code> for some type <code>A</code>. this means, for any <code>I</code> and <code>J</code>, i need to be able to decide <code>I &lt;= J</code>. I can do that if there is <code>LinearOrder A</code>. There is an instance saying that there is <code>LinearOrder A</code> if there is <code>DecidableRel (. &lt;= .)</code>\" This is a non-trivial loop, because for every loop, the context grows by two variables, namely <code>I</code> and <code>J</code>.</p>",
        "id": 501501301,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1740392911
    },
    {
        "content": "<p>Unfortunately changing the <code>have</code>s to <code>letI</code>s doesn't stop the timeout at pending depth 50. Isn't this a loop in the typeclass system? If decidableRel <code>≤</code> then LinearOrder, but if LinearOrder then decidableRel <code>≤</code> (i.e. what Edward said)</p>",
        "id": 501501903,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740393079
    },
    {
        "content": "<p>Why not go fully classical here, and just have</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LinearOrder</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">classical</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Lattice</span><span class=\"bp\">.</span><span class=\"n\">toLinearOrder</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 501502239,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1740393173
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/287929-mathlib4/topic/set_option.20maxSynthPendingDepth.202/near/501501295\">said</a>:</p>\n<blockquote>\n<p>That's an interesting question!</p>\n<p>Another question which I've never been clear about is: why do we have <a href=\"https://github.com/leanprover-community/mathlib4/blob/8c8ef3cd84a9471f1477a9ba4c3a5667a25e32a3/Mathlib/Order/Defs/LinearOrder.lean#L57-L62\">all this decidable stuff</a> in the definition of a linear order anyway?</p>\n</blockquote>\n<p>I think it's because <code>Ord.compare</code> would imply that they are decidable anyway?</p>",
        "id": 501502606,
        "sender_full_name": "Chris Wong",
        "timestamp": 1740393259
    },
    {
        "content": "<p>I see that many lemmas throughout mathlib assume <code>[DecidableEq (Ideal T)]</code>. If there are some concrete implementations of this decidability for specific rings, then my suggestion above to go fully classical is bad, as it will create diamonds. If this is never used to compute, though, maybe we could even register a global instance <code>DecidableEq (Ideal T)</code> as the classical instance, and then there would be no diamond as the two instances would agree (they would both be the classical one).</p>",
        "id": 501504958,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1740393603
    },
    {
        "content": "<p>The second failure in <a href=\"https://github.com/leanprover-community/mathlib4/pull/22035\">#22035</a> is of a completely different nature. Letting the pending depth be huge allows Lean to do the following thing:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">                    </span><span class=\"o\">[</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">isDefEq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mf\">0.011209</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">✅️</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span><span class=\"w\"> </span><span class=\"bp\">⇑?</span><span class=\"n\">l12</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑?</span><span class=\"n\">l23</span><span class=\"w\"> </span><span class=\"bp\">=?=</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span><span class=\"w\"> </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)))</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"bp\">▶</span>\n<span class=\"w\">                    </span><span class=\"o\">[</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">isDefEq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mf\">0.016898</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">✅️</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span><span class=\"w\"> </span><span class=\"bp\">⇑?</span><span class=\"n\">l12</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑?</span><span class=\"n\">l23</span><span class=\"w\"> </span><span class=\"bp\">=?=</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">))))</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">))))</span><span class=\"w\"> </span><span class=\"bp\">▶</span>\n<span class=\"w\">                    </span><span class=\"o\">[</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">isDefEq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mf\">0.023949</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">✅️</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span><span class=\"w\"> </span><span class=\"bp\">⇑?</span><span class=\"n\">l12</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑?</span><span class=\"n\">l23</span><span class=\"w\"> </span><span class=\"bp\">=?=</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                              </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)))))</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                              </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)))))</span><span class=\"w\"> </span><span class=\"bp\">▶</span>\n<span class=\"w\">                    </span><span class=\"o\">[</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">isDefEq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mf\">0.032511</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">✅️</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span><span class=\"w\"> </span><span class=\"bp\">⇑?</span><span class=\"n\">l12</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑?</span><span class=\"n\">l23</span><span class=\"w\"> </span><span class=\"bp\">=?=</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                              </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                  </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">))))))</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                              </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                  </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">))))))</span><span class=\"w\"> </span><span class=\"bp\">▶</span>\n<span class=\"w\">                    </span><span class=\"o\">[</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">isDefEq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mf\">0.042677</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">✅️</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span><span class=\"w\"> </span><span class=\"bp\">⇑?</span><span class=\"n\">l12</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑?</span><span class=\"n\">l23</span><span class=\"w\"> </span><span class=\"bp\">=?=</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                              </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                  </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                    </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)))))))</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                              </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                  </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                    </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)))))))</span><span class=\"w\"> </span><span class=\"bp\">▶</span>\n<span class=\"w\">                    </span><span class=\"o\">[</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">isDefEq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mf\">0.054752</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">✅️</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span><span class=\"w\"> </span><span class=\"bp\">⇑?</span><span class=\"n\">l12</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑?</span><span class=\"n\">l23</span><span class=\"w\"> </span><span class=\"bp\">=?=</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                              </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                  </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                    </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                      </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">))))))))</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                              </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                  </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                    </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                      </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">))))))))</span><span class=\"w\"> </span><span class=\"bp\">▶</span>\n<span class=\"w\">                    </span><span class=\"o\">[</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">isDefEq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mf\">0.067871</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">✅️</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span><span class=\"w\"> </span><span class=\"bp\">⇑?</span><span class=\"n\">l12</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑?</span><span class=\"n\">l23</span><span class=\"w\"> </span><span class=\"bp\">=?=</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                              </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                  </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                    </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                      </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                        </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)))))))))</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                              </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                  </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                    </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                      </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                        </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)))))))))</span><span class=\"w\"> </span><span class=\"bp\">▶</span>\n<span class=\"w\">                    </span><span class=\"o\">[</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">isDefEq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mf\">0.083441</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">✅️</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span><span class=\"w\"> </span><span class=\"bp\">⇑?</span><span class=\"n\">l12</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑?</span><span class=\"n\">l23</span><span class=\"w\"> </span><span class=\"bp\">=?=</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                              </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                  </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                    </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                      </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                        </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                          </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">))))))))))</span>\n<span class=\"w\">                          </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                              </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                  </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                    </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                      </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                        </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">                                          </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">))))))))))</span><span class=\"w\"> </span><span class=\"bp\">▶</span>\n<span class=\"bp\">...</span>\n</code></pre></div>\n<p>and this seems to stop only when we get to the pending depth, whereupon Lean bails and then has to prove</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"n\">AddCommGroup</span>\n<span class=\"w\">    </span><span class=\"o\">(((((((((((((((((((((</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">                        </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">                      </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">                    </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">                  </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">                </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">              </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">            </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">          </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">M</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 501507766,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740394159
    },
    {
        "content": "<p>So this second timeout is caused by <code>aesop</code> trying to solve the following goal</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span>\n<span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span>\n<span class=\"n\">inst</span><span class=\"bp\">✝²</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span>\n<span class=\"n\">inst</span><span class=\"bp\">✝¹</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"n\">inst</span><span class=\"bp\">✝</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"n\">iff_exact</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">N1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inst</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">N1</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inst_1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">N1</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">N2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inst_2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">N2</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">inst_3</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">N2</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">N3</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inst_4</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">N3</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inst_5</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">N3</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l12</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">N1</span><span class=\"w\"> </span><span class=\"bp\">→ₗ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">N2</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">l23</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">N2</span><span class=\"w\"> </span><span class=\"bp\">→ₗ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">N3</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span><span class=\"w\"> </span><span class=\"bp\">⇑</span><span class=\"n\">l12</span><span class=\"w\"> </span><span class=\"bp\">⇑</span><span class=\"n\">l23</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span><span class=\"w\"> </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">l12</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">l23</span><span class=\"o\">)</span>\n<span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">⦃</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"n\">N'</span><span class=\"w\"> </span><span class=\"n\">N''</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)⦄</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inst</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inst_1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">N'</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inst_2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">N''</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">inst_3</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inst_4</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">N'</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inst_5</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">N''</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">⦃</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">→ₗ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">N'</span><span class=\"o\">⦄</span><span class=\"w\"> </span><span class=\"o\">⦃</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">N'</span><span class=\"w\"> </span><span class=\"bp\">→ₗ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">N''</span><span class=\"o\">⦄,</span>\n<span class=\"w\">  </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span><span class=\"w\"> </span><span class=\"bp\">⇑</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">⇑</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Exact</span><span class=\"w\"> </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⇑</span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">rTensor</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>and trying to use <code>iff_exact</code> (in the \"forward direction\", i.e. \"make the goal more complicated\") to solve the goal.</p>",
        "id": 501508898,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740394486
    },
    {
        "content": "<p>this is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Module.FaithfullyFlat.iff_exact_iff_rTensor_exact#doc\">docs#Module.FaithfullyFlat.iff_exact_iff_rTensor_exact</a> in <code>RingTheory/Flat/FaithfullyFlat/Basic.lean</code></p>\n<p>Basically if MaxSynthPendingDepth is 50 then Lean will keep tensoring with M 50 times, it seems.</p>",
        "id": 501509054,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740394525
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110050\">Sébastien Gouëzel</span> <a href=\"#narrow/channel/287929-mathlib4/topic/set_option.20maxSynthPendingDepth.202/near/501502239\">said</a>:</p>\n<blockquote>\n<p>Why not go fully classical here, and just have</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LinearOrder</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">classical</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Lattice</span><span class=\"bp\">.</span><span class=\"n\">toLinearOrder</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>This change in the instance fixes the synthpendingdepth problem: the proof now compiles instantly even on depth 50. I'll open a new discussion for the decidable equality on ideals issue so it doesn't derail this one. (edit: discussion <a href=\"#narrow/channel/287929-mathlib4/topic/decidable.20equality.20on.20ideals\">here</a> )</p>",
        "id": 501513322,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740395669
    },
    {
        "content": "<p>As a middle ground, I think setting <code>maxSynthPendingDepth = 3</code> looks reasonable: it avoids the above monstrosities, but it's large enough for all mathematics we have already seen in mathlib (in fact, 2 would be enough) and should be future-proof tanks to the little margin (3 instead of 2). This is done in <a href=\"https://github.com/leanprover-community/mathlib4/pull/22012\">#22012</a>.</p>",
        "id": 501515615,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1740396266
    },
    {
        "content": "<p>Should the default value be changed in core instead? I think <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> indicated something along those lines...</p>",
        "id": 501627111,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1740424104
    },
    {
        "content": "<p>Understanding these things would be much easier if there was a report on the changes to particular instance synthesis problems to complement the existing benchmarking. </p>\n<p>A low tech way would be to make a big file/folder with a curated list of problems</p>",
        "id": 501633762,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1740426326
    },
    {
        "content": "<p>Yes, <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> said core would be ok with changing the value there. But if we change it first in mathlib, it will simplify a bit the core/mathlib dance, I think.</p>",
        "id": 501633994,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1740426410
    },
    {
        "content": "<p>I think if you want a core change you will have to build on of <code>nightly_testing</code>.</p>",
        "id": 501647392,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1740430870
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/287929-mathlib4/topic/set_option.20maxSynthPendingDepth.202/near/501508898\">said</a>:</p>\n<blockquote>\n<p>So this second timeout is caused by <code>aesop</code> </p>\n</blockquote>\n<p>Why is <code>aesop</code> being used here to begin with? Replacing with </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">iff_exact</span><span class=\"w\"> </span><span class=\"bp\">..|&gt;.</span><span class=\"mi\">1</span>\n</code></pre></div>\n<p>seems ok.</p>",
        "id": 501647742,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1740431001
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=instIsCommutativeOfIsCyclicSubtypeMemSubgroup#doc\">docs#instIsCommutativeOfIsCyclicSubtypeMemSubgroup</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsSimpleGroup.isCyclic#doc\">docs#IsSimpleGroup.isCyclic</a> are a similarly problematic pair when trying synthesize a commutative group structure on a subgroup.</p>",
        "id": 501656369,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1740434219
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/287929-mathlib4/topic/set_option.20maxSynthPendingDepth.202/near/501501295\">said</a>:</p>\n<blockquote>\n<p>That's an interesting question!</p>\n<p>Another question which I've never been clear about is: why do we have <a href=\"https://github.com/leanprover-community/mathlib4/blob/8c8ef3cd84a9471f1477a9ba4c3a5667a25e32a3/Mathlib/Order/Defs/LinearOrder.lean#L57-L62\">all this decidable stuff</a> in the definition of a linear order anyway?</p>\n</blockquote>\n<p>Long ago we had separate <code>linear_order</code> and <code>decidable_linear_order</code> type classes, but the distinction was considered unhelpful so they were merged.</p>",
        "id": 501694539,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740449159
    },
    {
        "content": "<p>Can we just make <code>LinearOrder</code> fully classical?!</p>",
        "id": 501698020,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1740450784
    },
    {
        "content": "<p>What would be the new way to spell out a linear order with decidable ordering? That's something I care about in e.g. my ordinal notations project</p>",
        "id": 501721478,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1740464542
    },
    {
        "content": "<p>I guess we have to understand whether \"fully classical\" means \"just drop the DecidableLE and DecidableEq fields\" (which was how I interpreted it) or \"drop the fields and then furthermore globally inhabit them with classical instances\" (which sounds like a bad idea because I should think that there are plenty of constructive instances of &lt;= in mathlib). Going fully classical by just dropping the fields might mean throwing in a bunch of <code>DecidableLE</code> assumptions throughout mathlib but we already have this with e.g. finsets.</p>",
        "id": 501735939,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740470929
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/22326\">#22326</a> removes the problematic <code>aesop</code> call.</p>",
        "id": 502055273,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1740578803
    },
    {
        "content": "<p>Bumping the question: do we have a design proposal for un-deciding <code>LinearOrder</code>?</p>",
        "id": 502056859,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1740579223
    },
    {
        "content": "<p><a href=\"#narrow/channel/116395-maths/topic/decidable.20linear.20order/near/213721802\">Here's the original proposal</a> that led to the status quo</p>",
        "id": 502058490,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740579631
    },
    {
        "content": "<p>Personally I think the status quo is fine</p>",
        "id": 502058517,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740579636
    },
    {
        "content": "<p>Thanks for the link Eric. It appears one interpretation of the proposal above also came up then: just remove the <code>Decidable</code> fields.</p>",
        "id": 502059603,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1740579923
    },
    {
        "content": "<p>Back to  the <code>maxSynthPendingDepth</code> question, should we merge <a href=\"https://github.com/leanprover-community/mathlib4/pull/22012\">#22012</a> (which sets it to 3) now, or wait until it's done in core first? <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span></p>",
        "id": 502869202,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1740928104
    },
    {
        "content": "<p>Are we happy with the slow-down this produces?</p>",
        "id": 502907527,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1740955269
    },
    {
        "content": "<p>If so, then yes, let's merge this first.</p>",
        "id": 502907530,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1740955274
    },
    {
        "content": "<p>I think the slowdown is worth the lack of headache. There have been a number of times where I've been beating my head against a wall trying to figure out why something doesn't work, only to finally figure out I needed to increase the <code>synthPendingDepth</code>. I know <span class=\"user-mention\" data-user-id=\"311453\">@Frédéric Dupuis</span> has also experienced this.</p>",
        "id": 502908834,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1740956253
    },
    {
        "content": "<p>Will this be in the next Lean release, or do we need to wait a month? If the later, I think we should change the default in the web editor as well</p>",
        "id": 502912279,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740958967
    },
    {
        "content": "<p>Probably not. We're hoping to cut <code>v4.18.0-rc1</code> from the nightly that comes out in about 6 hours.</p>",
        "id": 502918979,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1740963822
    },
    {
        "content": "<p>We've decided not to change the default until we have a minimisation of a realistic appearance of the need for <code>maxSynthPendingDepth 2</code> from Mathlib, that we can install in the test suite. Currently the only test is <a href=\"https://github.com/leanprover/lean4/blob/master/tests/lean/run/3313.lean\">https://github.com/leanprover/lean4/blob/master/tests/lean/run/3313.lean</a>, which no longer requires maxSynthPendingDepth at all.</p>\n<p>I won't have time to prepare this minimisation in the short-term, but if anyone would like to that would be super helpful!</p>",
        "id": 502931460,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1740972068
    }
]