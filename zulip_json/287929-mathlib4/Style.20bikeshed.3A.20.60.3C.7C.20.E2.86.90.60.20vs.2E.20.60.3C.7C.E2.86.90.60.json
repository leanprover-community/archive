[
    {
        "content": "<p>Currently, the style guidelines imply we ought to put spaces around infix notation, and indeed the prevailing style for the combo in the title is <code>&lt;| ←</code>.</p>\n<p>But—despite that!—I'd like to discuss a possible carve out in the style guidelines in favor of <code>&lt;|←</code>. I think it adds a good amount of readability in meta code and other programming in monads. Compare e.g.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">whnf</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">instantiateMVars</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">inferType</span><span class=\"w\"> </span><span class=\"n\">e</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">whnf</span><span class=\"w\"> </span><span class=\"bp\">&lt;|←</span><span class=\"w\"> </span><span class=\"n\">instantiateMVars</span><span class=\"w\"> </span><span class=\"bp\">&lt;|←</span><span class=\"w\"> </span><span class=\"n\">inferType</span><span class=\"w\"> </span><span class=\"n\">e</span>\n</code></pre></div>\n<p><code>&lt;|←</code> becomes a sort of intuitive idiom for \"monadic function application\", saving on the number of discrete \"tokens\" your eye parses, while still being interpretable—especially in fonts that ligature <code>&lt;|</code> into a triangle, which I imagine many programmers use.<br>\n<a href=\"/user_uploads/3121/1thkOZuftgI75-6mpO9VCJ3G/image.png\">E.g.</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/1thkOZuftgI75-6mpO9VCJ3G/image.png\" title=\"E.g.\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1282x204\" src=\"/user_uploads/thumbnail/3121/1thkOZuftgI75-6mpO9VCJ3G/image.png/840x560.webp\"></a></div><p>When a lot of code like this is on the page, I find pushing <code>&lt;|</code> and <code>←</code> together helps me focus on the more salient terms in between the interstitial notation instead of the notation itself.</p>\n<p>But, I've used <code>&lt;|←</code> consistently for a while, so maybe I just like it because I'm used to it! :) Is it really more readable, or is it \"just me\"?</p>",
        "id": 544867672,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1760497317
    },
    {
        "content": "<p>Isn't this just <a href=\"https://leanprover-community.github.io/mathlib4_docs/Init/Control/Basic.html#%C2%ABterm_=%3C%3C_%C2%BB\"><code>=&lt;&lt;</code></a>?</p>",
        "id": 544868299,
        "sender_full_name": "suhr",
        "timestamp": 1760497906
    },
    {
        "content": "<p>Maybe, but I believe we stylistically try to avoid monadic notations like that when possible in Mathlib in favor of simpler <code>do</code>-block notation.</p>",
        "id": 544868423,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1760498055
    },
    {
        "content": "<p>Actually, is that written down anywhere? If not, should it be? <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span> I certainly feel it's the style, but I'm not sure it's stated anywhere. (Sometimes I see <code>&lt;$&gt;</code>, but very rarely <code>&gt;&gt;=</code>, its reversed variant, or other similar monadic notation.) EDIT: See <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/Style.20RFC.3A.20prefer.20do.20notation.20in.20monadic.20code/with/545014585\">#mathlib4 &gt; Style RFC: prefer do notation in monadic code</a></p>",
        "id": 544868534,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1760498164
    },
    {
        "content": "<p>I think this is too bike-sheddy. For me it makes zero difference either way.</p>",
        "id": 544877574,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1760504808
    },
    {
        "content": "<p>Hmm, that might be a genuine difference in experience between us. It really does have some effect on how my eyes move over the screen/how easily my brain parses code, and it’s frequent enough in the code I look at for me to care; I swear I’m not just bikeshedding for bikeshedding’s sake! :)</p>\n<p>(At the same time, I really don’t know how widely shared my experience here is. It might not be widely shared at all! And I recognize it’s pretty niche in absolute terms.)</p>",
        "id": 544881046,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1760507258
    },
    {
        "content": "<p>I have a personal preference for <code>&lt;| ← foo</code> mostly because I think of <code>←</code> as being attached to <code>foo</code> as opposed to <code>&lt;|</code>. But I don't think we need to make any guidelines and I agree with:</p>\n<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Style.20bikeshed.3A.20.60.3C.7C.20.E2.86.90.60.20vs.2E.20.60.3C.7C.E2.86.90.60/near/544877574\">said</a>:</p>\n<blockquote>\n<p>I think this is too bike-sheddy. For me it makes zero difference either way.</p>\n</blockquote>",
        "id": 544948465,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1760529363
    },
    {
        "content": "<p>does anyone have a list of monadic notations?</p>",
        "id": 544981263,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760537878
    },
    {
        "content": "<p>A lot of it (but not all!) mimics Haskell’s ascii art, and I’m sure you can find a useful list from the Haskell side</p>",
        "id": 544984902,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1760538678
    },
    {
        "content": "<p>I believe the full list is: <code>&lt;$&gt;, &lt;&amp;&gt;, &lt;*, &lt;*&gt;, *&gt;, &lt;|&gt;, &gt;&gt;=, =&lt;&lt;, &gt;=&gt;, &lt;=&lt;, &gt;&gt;, &lt;&amp;&amp;&gt;, &lt;||&gt;</code></p>",
        "id": 544993673,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1760540716
    },
    {
        "content": "<p>and what do they do?</p>",
        "id": 545002594,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760543024
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Style.20bikeshed.3A.20.60.3C.7C.20.E2.86.90.60.20vs.2E.20.60.3C.7C.E2.86.90.60/near/545002594\">said</a>:</p>\n<blockquote>\n<p>and what do they do?</p>\n</blockquote>\n<p>functor map <code>&lt;$&gt;</code>, map but with the argument order swapped <code>&lt;&amp;&gt;</code>, seqleft (seq left with right, but throw away left result and keep right result) <code>&lt;*</code>, applicative seq <code>&lt;*&gt;</code>, seqright (seq left with right, but throw away right result and keep left result) <code>*&gt;</code>, alternative orelse <code>&lt;|&gt;</code>, monadic bind <code>&gt;&gt;=</code>, bind but with the argument order swapped <code>=&lt;&lt;</code>, kleisli composition <code>&gt;=&gt;</code>, kleisli composition with the argument order swapped <code>&lt;=&lt;</code>, \"and then\" operation (monadically run left and then right, keeping right result and discarding left) <code>&gt;&gt;</code>, monadic and (Boolean and but monadic) <code>&lt;&amp;&amp;&gt;</code>, monadic or (Boolean or but monadic) <code>&lt;||&gt;</code></p>",
        "id": 545004952,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760543686
    }
]