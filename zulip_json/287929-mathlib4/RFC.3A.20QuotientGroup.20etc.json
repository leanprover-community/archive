[
    {
        "content": "<p>What do you think about the following refactor?</p>\n<ul>\n<li>drop <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=HasQuotient#doc\">docs#HasQuotient</a></li>\n<li>instead, introduce notations <code>α ⧸* M</code> and <code>α ⧸+ M</code> (or similar) for quotients by multiplicative and additive actions</li>\n</ul>\n<p>This will change the definition from left cosets to right cosets, but they're propeq for a normal subgroup.</p>",
        "id": 457420426,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723136083
    },
    {
        "content": "<p>Or should we adjust notation to use left cosets by default to preserve defeq?</p>",
        "id": 457420699,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723136191
    },
    {
        "content": "<p>do i understand correctly that the motivation for this is to change from left to right cosets? or is there some other reason?</p>",
        "id": 457420952,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723136298
    },
    {
        "content": "<p>because i don't see the problem with using left cosets</p>",
        "id": 457420994,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723136318
    },
    {
        "content": "<p>My main reason is to make equality of <code>G ⧸ H</code> to the quotient by <code>orbitRel</code> more visible.</p>",
        "id": 457421176,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723136386
    },
    {
        "content": "<p>(i.e., not hidden behind multiple semireducible defs)</p>",
        "id": 457421298,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723136412
    },
    {
        "content": "<p>See <a href=\"https://github.com/leanprover-community/mathlib4/pull/15483\">#15483</a> for one source of motivation. Also, we have to force Lean to use the defeq when we apply generic lemmas about quotient by an action to group quotient in measure theory.</p>",
        "id": 457421664,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723136501
    },
    {
        "content": "<p>The only reason why I suggest right cosets is that they are given by <code>orbitsRel H G</code>, without <code>H.op</code>.</p>",
        "id": 457421886,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723136547
    },
    {
        "content": "<p>But this usage may disagree with literature, then we should use the action of the opposite (sub)group.</p>",
        "id": 457422286,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723136666
    },
    {
        "content": "<p>/me is away for a few hours.</p>",
        "id": 457422313,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723136674
    },
    {
        "content": "<p>i think making a definition for quotients by an action is a good idea. i don't know if it will be able to completely replace the current quotients, but it can be a decent idea to try.</p>",
        "id": 457422823,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723136825
    },
    {
        "content": "<p>quotients by actions (i think) would allow for another way to talk about primitive and transitive group actions.</p>",
        "id": 457423353,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723136957
    },
    {
        "content": "<p>on the other hand, i don't know if it's a common pattern but it does make it so you can't talk about quotients by non-canonical <code>MulAction G G</code>...</p>",
        "id": 457424214,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723137173
    },
    {
        "content": "<p>perhaps you really want quotients by the action map <code>G -&gt;* (A ≃ A)</code></p>",
        "id": 457424405,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723137240
    },
    {
        "content": "<p>so the instances don't overlap</p>",
        "id": 457424501,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723137259
    },
    {
        "content": "<p>We use type tags for non-canonical actions. E.g., <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ConjAct#doc\">docs#ConjAct</a></p>",
        "id": 457431071,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723139027
    },
    {
        "content": "<p>It would be nice if someone who actually used both left and right cosets in their research comments on pros/cons of different approaches here. I <strong>saw</strong> these in a paper (e.g., in the definition of an infranilmanifold), but never actually used them.</p>",
        "id": 457433166,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723139536
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/stream/287929-mathlib4/topic/RFC.3A.20QuotientGroup.20etc/near/457423353\">said</a>:</p>\n<blockquote>\n<p>quotients by actions (i think) would allow for another way to talk about primitive and transitive group actions.</p>\n</blockquote>\n<p>I think group quotients are <em>already</em> implemented as quotients by actions?</p>",
        "id": 457466080,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723147521
    },
    {
        "content": "<p>Yes but this defeq is hidden behind a semireducible definition or two.</p>",
        "id": 457466254,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723147562
    },
    {
        "content": "<p>Yes, this was more disputing my reading of Edward's claim that this unlocks new things mathematically.</p>",
        "id": 457466533,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723147633
    },
    {
        "content": "<p>Right now group quotients are defined as the quotient by the opposite action, right? At the time that was certainly done to avoid a behavior change, but I agree that removing the opposite would be a handy unification if it turns out not to matter.</p>",
        "id": 457466950,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723147722
    },
    {
        "content": "<p>looking at it now, indeed it seems i was mistaken, except that it requires the action to be upon itself, rather than a different type.</p>",
        "id": 457467274,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723147786
    },
    {
        "content": "<p>Quotient groups were rewritten this way by <span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span> in <a href=\"https://github.com/leanprover-community/mathlib/pull/15045\">!3#15045</a> based on this discussion: <a class=\"stream-topic\" data-stream-id=\"116395\" href=\"/#narrow/stream/116395-maths/topic/two.20different.20quotients.20by.20subgroup\">#maths &gt; two different quotients by subgroup</a></p>",
        "id": 457467403,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723147807
    },
    {
        "content": "<p>What about</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">HasQuotient</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">outParam</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">quotientRel</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Setoid</span><span class=\"w\"> </span><span class=\"n\">A</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">HasQuotient</span><span class=\"bp\">.</span><span class=\"n\">Quotient</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">outParam</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">HasQuotient</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Quotient</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">HasQuotient</span><span class=\"bp\">.</span><span class=\"n\">quotientRel</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>instead? Does this solve any problems?</p>",
        "id": 457467726,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1723147872
    },
    {
        "content": "<p>All quotients we have are either the quotient by a multiplicative group action (1 instance) or the quotient by an additive group action (4 instances).</p>",
        "id": 457468497,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723148041
    },
    {
        "content": "<p>i think the idea is to drop <code>HasQuotient</code> and rather define something like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- not sure about outparams here yet</span>\n<span class=\"kd\">@[</span><span class=\"n\">to_additive</span><span class=\"kd\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">MulActionQuotient</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MulAction</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Quotient</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MulAction</span><span class=\"bp\">.</span><span class=\"n\">orbitRel</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 457469130,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723148220
    },
    {
        "content": "<p>or at least, that's what what i'd expect</p>",
        "id": 457469193,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723148241
    },
    {
        "content": "<p>and then do some notation tricks</p>",
        "id": 457469679,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723148393
    },
    {
        "content": "<p>General observation: I've found the principle of preserving covariance of actions even at the expense of possibly introducing inversion to be a useful thing</p>",
        "id": 457473001,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1723149336
    },
    {
        "content": "<p>What does it mean in this context?</p>",
        "id": 457473239,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723149393
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"684366\">@Edward van de Meent</span> We already have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MulAction.orbitRel.Quotient#doc\">docs#MulAction.orbitRel.Quotient</a> (which is reducible).</p>",
        "id": 457473634,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723149502
    },
    {
        "content": "<p>is that <em>not</em> what you're referring to then?</p>",
        "id": 457474053,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723149617
    },
    {
        "content": "<p>I suggest that we remove a semireducible def or two on the way from <code>G ⧸ H</code> to this type. With the most natural way, this will change the definition from left cosets to right cosets, but we can avoid this, if we want to.</p>",
        "id": 457474500,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723149727
    },
    {
        "content": "<p>A related issue is dealing with all the different <code>mk</code> functions for going from the ambient type to the quotient; I think the approach using <code>Setoid</code> as a type class is frowned upon, but writing a new mk function for each quotient (which we currently do) feels a bit like writing a new coeFn function for each hom</p>",
        "id": 457474835,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723149826
    },
    {
        "content": "<p>Currently, <code>G ⧸ H</code> is definitionally equal to the quotient by the action of <code>H.op</code> but sometimes Lean fails to see through this definitional equality, because it doesn't unfold some of the definitions on the way.</p>",
        "id": 457475130,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723149890
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> I think that we should migrate to <code>Quot r</code> and <code>[IsEquivalence r]</code> but I'm too lazy to implement this.</p>",
        "id": 457475319,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723149939
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/287929-mathlib4/topic/RFC.3A.20QuotientGroup.20etc/near/457475319\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> I think that we should migrate to <code>Quot r</code> and <code>[IsEquivalence r]</code> but I'm too lazy to implement this.</p>\n</blockquote>\n<p>That sounds like one of quite a few sensible design choices; it might be worth enumerating more of them (on a wiki page?) before attempting any refactor.</p>",
        "id": 457476653,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723150284
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/287929-mathlib4/topic/RFC.3A.20QuotientGroup.20etc/near/457475130\">said</a>:</p>\n<blockquote>\n<p>Currently, <code>G ⧸ H</code> is definitionally equal to the quotient by the action of <code>H.op</code> but sometimes Lean fails to see through this definitional equality, because it doesn't unfold some of the definitions on the way.</p>\n</blockquote>\n<p>What specifically are those definitions?</p>",
        "id": 457476810,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723150328
    },
    {
        "content": "<p>One of them is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=QuotientGroup.leftRel#doc\">docs#QuotientGroup.leftRel</a></p>",
        "id": 457510137,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723151531
    },
    {
        "content": "<p>Also, I don't know which defs around <code>HasQuotient</code> get unfolded and which aren't.</p>",
        "id": 457510260,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723151588
    },
    {
        "content": "<p>Should we reduce the use of <code>(· ≈ ·)</code> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Setoid.r#doc\">docs#Setoid.r</a> in favor of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Setoid.Rel#doc\">docs#Setoid.Rel</a> or even make <code>Setoid</code> a <code>FunLike</code>?</p>",
        "id": 458407804,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1723153139
    },
    {
        "content": "<p>Currently <code>Quotient</code> APIs usually use <code>(· ≈ ·)</code> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Setoid.r#doc\">docs#Setoid.r</a>, which is annoying to use.</p>",
        "id": 458408270,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1723153379
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/287929-mathlib4/topic/RFC.3A.20QuotientGroup.20etc/near/457421176\">said</a>:</p>\n<blockquote>\n<p>My main reason is to make equality of <code>G ⧸ H</code> to the quotient by <code>orbitRel</code> more visible.</p>\n</blockquote>\n<p>It can be done after some further improvements to <a href=\"https://github.com/leanprover-community/mathlib4/pull/15586\">#15586</a>, but there is a significant slowdown.</p>",
        "id": 459327124,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1723165590
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"455791\">Yuyang Zhao</span> <a href=\"#narrow/stream/287929-mathlib4/topic/RFC.3A.20QuotientGroup.20etc/near/458407804\">said</a>:</p>\n<blockquote>\n<p>Should we reduce the use of <code>(· ≈ ·)</code> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Setoid.r#doc\">docs#Setoid.r</a> in favor of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Setoid.Rel#doc\">docs#Setoid.Rel</a></p>\n</blockquote>\n<p>I think we're somewhat stuck here because <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Setoid.r#doc\">docs#Setoid.r</a> is in core yet <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Setoid.Rel#doc\">docs#Setoid.Rel</a> is in mathlib. So we might need a Lean RFC to tidy this up</p>",
        "id": 459327440,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723165807
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 459327454,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723165821
    },
    {
        "content": "<p>I think ultimately it comes down to disagreement about whether <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Setoid#doc\">docs#Setoid</a> should be a class or a structure</p>",
        "id": 459327625,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723165924
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"455791\">Yuyang Zhao</span> <a href=\"#narrow/stream/287929-mathlib4/topic/RFC.3A.20QuotientGroup.20etc/near/459327124\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/287929-mathlib4/topic/RFC.3A.20QuotientGroup.20etc/near/457421176\">said</a>:</p>\n<blockquote>\n<p>My main reason is to make equality of <code>G ⧸ H</code> to the quotient by <code>orbitRel</code> more visible.</p>\n</blockquote>\n<p>It can be done after some further improvements to <a href=\"https://github.com/leanprover-community/mathlib4/pull/15586\">#15586</a>, but there is a significant slowdown.</p>\n</blockquote>\n<p>Do you understand why does it make things slower?</p>",
        "id": 459330284,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723167185
    },
    {
        "content": "<p>It got better after adding <code>Ideal.instHasQuotient</code> back. The rest might be because simp can use lemmas about <code>Quotient</code> now.</p>",
        "id": 459334963,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1723168820
    },
    {
        "content": "<blockquote>\n<p>The rest might be because simp can use lemmas about <code>Quotient</code> now.</p>\n</blockquote>\n<p>Will it be better if we make <code>MulAction.orbitRel.Quotient</code> semireducible, then reducibly unfold to it?</p>",
        "id": 459336520,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723169886
    },
    {
        "content": "<p>(then we should rename it to <code>MulAction.Orbits</code>)</p>",
        "id": 459336548,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723169916
    },
    {
        "content": "<p>I tried to use quotients and orbitRel about two weeks ago, and I also found the current API lacking. So I'm in favour of Yury's proposal.</p>",
        "id": 460017506,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1723447951
    },
    {
        "content": "<p>I won't have time to <del>implement</del>start implementing it until next weekend.</p>",
        "id": 460081493,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723468862
    },
    {
        "content": "<p>Should <code>G ⧸ H</code> remain the quotient by the right action, or should we make it the quotient by the left action, with an explicit <code>op</code> somewhere required to use the right action?</p>",
        "id": 460081826,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723468981
    },
    {
        "content": "<p>Maybe worth a poll?</p>",
        "id": 460090042,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1723471647
    },
    {
        "content": "<p>/poll Should <code>G ⧸ H</code> remain the quotient by the right action?<br>\n<code>G ⧸ H</code> becomes the quotient by the left action; more generally, <code>X ⧸ G</code> is the quotient of <code>X</code> by the action of <code>G</code><br>\n<code>G ⧸ H</code> remains the quotient by the right action</p>",
        "id": 460090532,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723471816
    },
    {
        "content": "<p>I like the first approach, because it generalizes to <code>X ⧸ G</code>, and one can deal with right action by using <code>MulOpposite</code> or <code>Subgroup.op</code>.</p>",
        "id": 460091048,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723471976
    },
    {
        "content": "<p>Or use inversion on the action group.</p>",
        "id": 460093597,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1723472781
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span> Could you please explain why leaving <code>G ⧸ H</code> is a better choice? I guess, you have some reason I don't see.</p>",
        "id": 460112164,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723478747
    },
    {
        "content": "<p>I added one more option, tagging all who already voted <span class=\"user-mention\" data-user-id=\"684366\">@Edward van de Meent</span> <span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> <span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> <span class=\"user-mention\" data-user-id=\"713393\">@Matthew Ballard</span> <span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span></p>",
        "id": 460113731,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723479079
    },
    {
        "content": "<p>/poll Should we continue using the same notation for multiplicative and additive quotients?<br>\nContinue using <code>⧸</code> or <code>⧹</code> for both<br>\nUse different notation for multiplicative and additive quotients</p>",
        "id": 460114253,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723479205
    },
    {
        "content": "<p>If we can use <code>⧸</code> or <code>⧹</code> for both, that would be great. But I fear that diamonds will force us to disambiguate at some point</p>",
        "id": 460120647,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1723481092
    },
    {
        "content": "<p>I think we can choose the notation independently of the underlying <code>Expr</code></p>",
        "id": 460121051,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723481262
    },
    {
        "content": "<p>I don't think we have any situations where <code>T / S</code> is ambiguously additive or multiplicative?</p>",
        "id": 460121160,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723481302
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/287929-mathlib4/topic/RFC.3A.20QuotientGroup.20etc/near/460112164\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110050\">Sébastien Gouëzel</span> Could you please explain why leaving <code>G ⧸ H</code> is a better choice? I guess, you have some reason I don't see.</p>\n</blockquote>\n<p>It's just because, in usual mathematics, <code>G / H</code> is the quotient on the right, and <code>H \\ G</code> is the quotient on the left. So I'd rather write <code>H \\ G</code> for the quotient, i.e., I am on board with option 3.</p>",
        "id": 460125156,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1723482345
    },
    {
        "content": "<p>Re the first poll: I'm not at lean for the next week but I just want to make sure I'm understanding this. Are lots of people voting for \"make G/H not mean {gH : g in H} and thus deviate from the mathematical literature\"? I would be strongly against deviations from the literature. There should be a natural left action of G on G/H, that's exactly why H is written on the right. If you want right cosets the notation is H\\G and if you want double cosets HgK the notation is H\\G/K. Sorry if I've misunderstood, I have patchy reception and no computer</p>",
        "id": 462060086,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1723540231
    },
    {
        "content": "<p>I'm the lucky owner of an elementary group theory textbook [1] that uses right cosets by default. It writes the function name to the right of the argument for function application (at least when the author remembers!) and writes compositions \"backwards\" accordingly too. <strong>However</strong>, it does use the notation <code>G/H</code> for the quotient group (defined in terms of (right) cosets).<br>\n<a href=\"/user_uploads/3121/MVQnJHe_HCjAI5er0K8sPkAm/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/MVQnJHe_HCjAI5er0K8sPkAm/image.png\" title=\"image.png\"><img data-original-dimensions=\"775x124\" src=\"/user_uploads/thumbnail/3121/MVQnJHe_HCjAI5er0K8sPkAm/image.png/840x560.webp\"></a></div><p>I like the book, and there are advantages to those choices, but it's idiosyncratic. It's much more common in recent books to use left cosets by default, and that's what newcomers will expect. I think the combination of writing functions on the left (which I assume we're not changing!?) and using right cosets would be particularly odd in informal mathematics: we would have <code>(N&sigma;)&tau; = N(&tau;&compfn;&sigma;)</code> when &sigma;,&tau; &isin; G are permutations and N &vltri; G, so we'd probably have to start defining <code>&sigma; * &tau; := &tau; &compfn; &sigma;</code>. Not wrong or impossible, but confusing.</p>\n<p>[1] Groups and Geometry, Peter M. Neumann, Gabrielle A. Stoy, and Edward C. Thompson</p>",
        "id": 462080280,
        "sender_full_name": "Richard Copley",
        "timestamp": 1723546386
    },
    {
        "content": "<p>We will not write <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">Na</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\">a</span></span></span></span> anyway. This would be a rather bad abstraction barrier breaking.</p>",
        "id": 462085441,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1723547986
    },
    {
        "content": "<p>Currently left cosets, which are not the same type as elements of the quotient, are written <code>g • (H : Set G)</code>, and there is no notation for right cosets. (Unless this has changed in the past few weeks.)</p>",
        "id": 462085877,
        "sender_full_name": "Richard Copley",
        "timestamp": 1723548135
    },
    {
        "content": "<p>The notation is <code>(H : Set G) &lt;• g</code>  and has been there for a few months already</p>",
        "id": 462086471,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1723548260
    },
    {
        "content": "<p>See <a href=\"https://tqft.net/mathlib4files/Algebra/Group/Action/Opposite\">file#Algebra/Group/Action/Opposite</a></p>",
        "id": 462086582,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1723548286
    },
    {
        "content": "<p>The PR was <a href=\"https://github.com/leanprover-community/mathlib4/pull/8909\">#8909</a>, merged in December 2023</p>",
        "id": 462086858,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1723548386
    },
    {
        "content": "<p>But this isn't a notation for the projection to the quotient, right? So this is not the discussion topic?</p>",
        "id": 462089230,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1723549215
    },
    {
        "content": "<p>Quite. I did say \"in informal mathematics\". In the current notation, where the quotient <code>G ⧸ H</code> is by the right action (that is, informally: the elements of the quotient are left cosets), we have</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">GroupTheory</span><span class=\"bp\">.</span><span class=\"n\">QuotientGroup</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Perm</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">H</span><span class=\"bp\">.</span><span class=\"n\">Normal</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Perm</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Perm</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">⧸</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Perm</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">⧸</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Perm</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">⧸</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>I was suggesting that this, corresponding to [edit: fixed] <code>(Hσ)τ = H(στ)</code>, might be what a newcomer naturally expects, and that changing it would lead to confusion.</p>",
        "id": 462095806,
        "sender_full_name": "Richard Copley",
        "timestamp": 1723550807
    },
    {
        "content": "<p>Following the discussion, I removed my vote from option 1, leaving at option 3.</p>",
        "id": 462108496,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723554167
    },
    {
        "content": "<p>Does using the <code>QuotLike</code> API in <a href=\"https://github.com/leanprover-community/mathlib4/pull/16421\">#16421</a> help with this? I think it's almost ready, but would require a massive refactoring in Mathlib to migrate to it.</p>",
        "id": 467739866,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1725520050
    },
    {
        "content": "<p>I think that these 2 changes are orthogonal.</p>",
        "id": 467740164,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1725520164
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/287929-mathlib4/topic/RFC.3A.20QuotientGroup.20etc/near/457421176\">said</a>:</p>\n<blockquote>\n<p>My main reason is to make equality of <code>G ⧸ H</code> to the quotient by <code>orbitRel</code> more visible.</p>\n</blockquote>\n<p>Ah sorry, I meant to make the relation more visible.</p>",
        "id": 467741163,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1725520433
    },
    {
        "content": "<p>Do you mean generalizing relevant theories from \"defeq to the quotient\" to <code>QuotLike</code>?</p>",
        "id": 467747919,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1725522095
    },
    {
        "content": "<p>Do you expect to have instances of <code>QuotLike</code> other than <code>Quotient</code>/<code>Quot</code>?</p>",
        "id": 467748143,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1725522149
    },
    {
        "content": "<p><code>QuotLike</code> APIs specify the type of quotient and the relation using typeclasses. I think most of the definitions based on <code>Quot</code> / <code>Quotient</code> in Mathlib should have a <code>QuotLike</code> instance. This would avoid duplication of APIs and problems caused by directly using the <code>Quotient</code> API.</p>",
        "id": 467753957,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1725523636
    },
    {
        "content": "<p>This also surely comes up in group theory, right? Eg the first isomorphism theorem could be made into a <code>QuotLike</code> instance</p>",
        "id": 467754283,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1725523707
    },
    {
        "content": "<p>We can definitely have <code>QuotLike (range φ) G (leftRel (ker φ))</code> if we need</p>",
        "id": 467764164,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1725525421
    },
    {
        "content": "<p>I feel that <a href=\"https://github.com/leanprover-community/mathlib4/pull/16421\">#16421</a> is ready. Some of the naming may need to be discussed. For example, <code>⟦·⟧</code> is currently called <code>mkQ</code> in names. This distinguishes it from other <code>.mk</code>s and makes it possible to write the quotient map as <code>mkQ</code> <code>mkQ'</code> <code>mkQ_ h</code>. But this will also require changing the old lemma names.</p>",
        "id": 473246429,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1727476678
    }
]