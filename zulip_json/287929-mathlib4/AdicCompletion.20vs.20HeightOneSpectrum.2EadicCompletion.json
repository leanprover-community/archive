[
    {
        "content": "<p>In mathlib we have two things called \"adic completion\": <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AdicCompletion#doc\">docs#AdicCompletion</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsDedekindDomain.HeightOneSpectrum.adicCompletion#doc\">docs#IsDedekindDomain.HeightOneSpectrum.adicCompletion</a>. I seem to understand that those are mathematically different objects, but I haven't been able to assert this by reading the docs. Could we please</p>\n<ol>\n<li>Clarify whether those are mathematically different or not (and indicate so in the docs!).</li>\n<li>If not, unify them.</li>\n<li>If so, move <code>AdicCompletion</code> to a namespace.</li>\n</ol>",
        "id": 486755569,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1733652546
    },
    {
        "content": "<p>Context is that I was working on <a href=\"https://github.com/ImperialCollegeLondon/FLT/pull/230\">FLT#230</a> and accidentally generalised the wrong <code>Algebra</code> instance</p>",
        "id": 486755599,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1733652592
    },
    {
        "content": "<p>(nothing bad, to be clear, I just need to redo the same thing a second time to actually close <a href=\"https://github.com/ImperialCollegeLondon/FLT/pull/230\">FLT#230</a>)</p>",
        "id": 486755669,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1733652627
    },
    {
        "content": "<p>They are closely related, but neither is quite a special case of the other. </p>\n<p>The relation is that if <code>R</code>, <code>K</code>, <code>v</code> are as in <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsDedekindDomain.HeightOneSpectrum.adicCompletion#doc\">docs#IsDedekindDomain.HeightOneSpectrum.adicCompletion</a>, the ring <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsDedekindDomain.HeightOneSpectrum.adicCompletionIntegers#doc\">docs#IsDedekindDomain.HeightOneSpectrum.adicCompletionIntegers</a> (i.e. the subring of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsDedekindDomain.HeightOneSpectrum.adicCompletion#doc\">docs#IsDedekindDomain.HeightOneSpectrum.adicCompletion</a> consisting of stuff with valuation ≤ 1), <em>is</em> canonically isomorphic to the <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AdicCompletion#doc\">docs#AdicCompletion</a> of <code>R</code>, as a module over itself, wrt the prime ideal <code>I</code> corresponding to the place <code>v</code>.</p>",
        "id": 486764098,
        "sender_full_name": "David Loeffler",
        "timestamp": 1733659331
    },
    {
        "content": "<p>It probably wouldn’t hurt to move <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AdicCompletion#doc\">docs#AdicCompletion</a> to the <code>Ideal</code> namespace.</p>",
        "id": 486772848,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1733666953
    },
    {
        "content": "<p>This is really a consequence of imprecise naming in informal math. We say that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">Q</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.975em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> is the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>-adic completion of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8556em;vertical-align:-0.1667em;\"></span><span class=\"mord mathbb\">Q</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">Z</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\Z_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.975em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> is the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>-adic (or <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(p)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span></span></span></span>-adic) completion of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Z</mi></mrow><annotation encoding=\"application/x-tex\">\\Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">Z</span></span></span></span>. But the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(p)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span></span></span></span>-adic completion of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8556em;vertical-align:-0.1667em;\"></span><span class=\"mord mathbb\">Q</span></span></span></span> is the trivial ring :-/</p>",
        "id": 486773148,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1733667204
    },
    {
        "content": "<p>Note that <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Padic#doc\">docs#Padic</a> is defined neither via <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsDedekindDomain.HeightOneSpectrum.adicCompletion#doc\">docs#IsDedekindDomain.HeightOneSpectrum.adicCompletion</a> nor via <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AdicCompletion#doc\">docs#AdicCompletion</a> but via <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CauSeq.Completion.Cauchy#doc\">docs#CauSeq.Completion.Cauchy</a>.</p>",
        "id": 486773830,
        "sender_full_name": "Christian Merten",
        "timestamp": 1733667771
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"481963\">David Loeffler</span> <a href=\"#narrow/channel/287929-mathlib4/topic/AdicCompletion.20vs.20HeightOneSpectrum.2EadicCompletion/near/486764098\">said</a>:</p>\n<blockquote>\n<p>The relation is that if <code>R</code>, <code>K</code>, <code>v</code> are as [...]</p>\n</blockquote>\n<p>Ah great! I was confused why <code>AdicCompletion K (span {v})</code> wasn't literally the same as <code>v.adicCompletion K</code>. The answer is that one is the fraction field of the other</p>",
        "id": 486777152,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1733670454
    },
    {
        "content": "<p>And as David and Adam explain, you even need <code>R</code> instead of <code>K</code> in the first expr. So yeah, it's confusing.</p>",
        "id": 486941608,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1733735444
    },
    {
        "content": "<p>So one is the adic completion of a ring and the other is the adic completion of a field. Maybe we could call them <code>RingAdicCompletion</code> and <code>FieldAdicCompletion</code>? It's not much longer and clearly disambiguates them</p>",
        "id": 486946257,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1733736762
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"648495\">Christian Merten</span> <a href=\"#narrow/channel/287929-mathlib4/topic/AdicCompletion.20vs.20HeightOneSpectrum.2EadicCompletion/near/486773830\">said</a>:</p>\n<blockquote>\n<p>Note that <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Padic#doc\">docs#Padic</a> is defined neither via <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsDedekindDomain.HeightOneSpectrum.adicCompletion#doc\">docs#IsDedekindDomain.HeightOneSpectrum.adicCompletion</a> nor via <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AdicCompletion#doc\">docs#AdicCompletion</a> but via <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CauSeq.Completion.Cauchy#doc\">docs#CauSeq.Completion.Cauchy</a>.</p>\n</blockquote>\n<p>Note that in our work with <span class=\"user-mention\" data-user-id=\"406490\">@María Inés de Frutos Fernández</span> we <a href=\"https://github.com/mariainesdff/LocalClassFieldTheory/blob/2b0994f595ab9d2daaef0bfbc04c6d1368f60df5/LocalClassFieldTheory/PadicCompare.lean#L275\">prove</a> that they are isomorphic.</p>",
        "id": 488148395,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1733937449
    },
    {
        "content": "<p>Concerning the whole discussion, I think that one point to keep in mind is that the <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/AdicCompletion/Basic.html#AdicCompletion\">AdicCompletion</a> can be defined basically with no assumption on the ring, whereas <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsDedekindDomain.HeightOneSpectrum.adicCompletion#doc\">IsDedekindDomain.HeightOneSpectrum.adicCompletion</a> only makes sense for Dedekind Domains. I think that given the applications it makes sense to treat adic completions of Dedekind Domains with a preferred eye (there will be more API in that setting) and using only namespaces to distinguish this special case might be misleading. I guess this is what motivated <span class=\"user-mention\" data-user-id=\"406490\">@María Inés de Frutos Fernández</span> in the first place, but I let here intervene here.</p>",
        "id": 488149492,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1733937841
    },
    {
        "content": "<p>Concerning the Ring <em>vs</em> Field confusion, I agree it is not great but one advantage of the current design (for Dedekind domains) is that it <em>forces</em> one to work with the completion of the field, and to look at the integers as the unit ball, that is isomorphic but not <code>defeq</code> to the completion of the Dedekind domain. If we have both definitions, both things would appear somewhat randomly and I believe that the library would soon become a mess.</p>",
        "id": 488149642,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1733937876
    }
]