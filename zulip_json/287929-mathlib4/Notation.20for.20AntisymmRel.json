[
    {
        "content": "<p>I opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/19554\">#19554</a> to define <code>⋚</code> as notation for <code>AntisymmRel (· ≤ ·)</code> (<code>a ≤ b ∧ b ≤ a</code>). There was considerable pushback to this, mostly because of the possibility that this symbol could be misread as a \"comparability\" relation (<code>a ≤ b ∨ b ≤ a</code>). I then brought up an idea from the Xena Discord to use <code>≗</code> (read as order-equivalent), but the PR stalled.</p>",
        "id": 485545682,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733115238
    },
    {
        "content": "<p>I think we do in fact need some notation for this, even if it's just a local notation. Otherwise writing API becomes quite painful (and there is in fact API to be written, see <a href=\"https://github.com/leanprover-community/mathlib4/pull/19571\">#19571</a>). But there seems to be no existing notation in the literature. So, here's a poll to decide what we can do:</p>",
        "id": 485545829,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733115353
    },
    {
        "content": "<p>/poll AntisymmRel (· ≤ ·)<br>\n⋚<br>\n≗<br>\ndon't use notation</p>",
        "id": 485545892,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733115402
    },
    {
        "content": "<p>(you can add more choices)</p>",
        "id": 485545903,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733115417
    },
    {
        "content": "<p>My point from before is that making up new notation might help on the \"painful to write\" aspect, but it is actively harmful on the \"painful to read\" aspect, which is more important.</p>",
        "id": 485746638,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1733196957
    },
    {
        "content": "<p>Yeah, my counter to that is that <code>AntisymmRel (· ≤ ·) a b</code> is no less cryptic and no more legible before you read the docs, and after that point any custom notation becomes easier to read.</p>",
        "id": 486617544,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733533319
    },
    {
        "content": "<p>I find it a lot less cryptic.</p>",
        "id": 486618602,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1733534177
    },
    {
        "content": "<p>The spelled out version is much easier to read as it tells you that at least it has something to do with antisymmetry, whereas the notation tells you very little, especially because it's nonstandard and it doesn't have any existing counterpart in the library.</p>",
        "id": 486621040,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733536068
    },
    {
        "content": "<p>On top of that, upon reading it in the source on GitHub, I wouldn't have to go figure out what the name of the declaration is.</p>",
        "id": 486621135,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733536144
    },
    {
        "content": "<p>an alternative slightly-more-documenting notation is <code>a ≤∧≥ b</code></p>",
        "id": 486625658,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1733540075
    },
    {
        "content": "<p>Really like that one</p>",
        "id": 486625682,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733540104
    },
    {
        "content": "<p>I've updated <a href=\"https://github.com/leanprover-community/mathlib4/pull/19554\">#19554</a> to use <code>≤∧≥</code>.</p>",
        "id": 486763430,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733658851
    },
    {
        "content": "<p>At least to me this seems self-documenting enough. As for the declaration name not being clear... I don't see how this is an issue unique to this notation. The name <code>AntisymmRel</code> should still appear in most of the theorem names anyways.</p>",
        "id": 486763619,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733659007
    },
    {
        "content": "<p>I would really like to emphasize that \"don't use notation\" implies \"type out the 19-character sequence <code>AntisymmRel (· ≤ ·)</code> every single time you want to talk about order-equivalent elements in preorders\". If we're providing support for <code>Preorder</code> to begin with then I don't think actually talking about them should be so painful.</p>",
        "id": 486763798,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733659158
    },
    {
        "content": "<p>Still opposed to notation for this. :-)</p>",
        "id": 486990144,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1733749450
    },
    {
        "content": "<p>I think it is also worth clarifying whether this is about local or global notation</p>",
        "id": 486993345,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1733750339
    },
    {
        "content": "<p>I'm against a global notation but indifferent about local notation here</p>",
        "id": 486993491,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1733750378
    },
    {
        "content": "<p>As long as we mean <code>local</code> and not <code>scoped</code>, then I suppose it doesn't bother me.</p>",
        "id": 487014815,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733755855
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"459227\">@Violeta Hernández</span> note that in C⋆-algebras, both <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=spectrum#doc\">docs#spectrum</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=quasispectrum#doc\">docs#quasispectrum</a> are used <em>all the time</em>, but so far I only ever introduce local notation for them. Admittedly, the first is short, but <code>quasispectrum</code> is close to the length of <code>AntisymmRel (· ≤ ·)</code></p>",
        "id": 487015375,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733756008
    },
    {
        "content": "<p>I can agree with having only local notation. Ultimately my main use case is <code>PGame</code> and there I can just use the setoid notation instead.</p>",
        "id": 487058100,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733765847
    },
    {
        "content": "<p><span aria-label=\"confused\" class=\"emoji emoji-1f615\" role=\"img\" title=\"confused\">:confused:</span> Then why do you even need local notation? I just looked at <a href=\"https://github.com/leanprover-community/mathlib4/pull/19571\">#19571</a> and it's only 100 lines or so that would be affected here.</p>",
        "id": 487060092,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733766440
    },
    {
        "content": "<p>Compare that to, for example <a href=\"https://tqft.net/mathlib4files/Mathlib/Analysis/CStarAlgebra/ContinuousFunctionalCalculus/NonUnital\">file#Mathlib/Analysis/CStarAlgebra/ContinuousFunctionalCalculus/NonUnital</a>, where I use the <code>σₙ</code> local notation for <code>quasispectrum</code> <em>literally</em> 100 times (and that's just one file).</p>",
        "id": 487060651,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733766613
    },
    {
        "content": "<p>Above<br>\n<span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Notation.20for.20AntisymmRel/near/485545829\">said</a>:</p>\n<blockquote>\n<p>I think we do in fact need some notation for this, even if it's just a local notation. Otherwise writing API becomes quite painful</p>\n</blockquote>\n<p>you make it sound like this is especially burdensome, but I think it's simply not.</p>",
        "id": 487060913,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733766693
    },
    {
        "content": "<p>I do think these are slightly different situations. We generally don't have notation for functions, whereas we do often have very concise notation for relations (think <code>=</code>, <code>&lt;</code>, and so on).</p>",
        "id": 487062444,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733767109
    },
    {
        "content": "<p>I also don't think notation would be limited to the 100 lines of my PR. I expect that the <code>AntisymmRel</code> will grow as Mathlib defines more concrete preorders</p>",
        "id": 487063027,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733767251
    },
    {
        "content": "<p>But maybe we'll get there when we get there</p>",
        "id": 487063052,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733767257
    },
    {
        "content": "<p>I could counter with <code>+</code>, <code>-</code>, <code>/</code>, <code>⁻¹</code>, <code>•</code> etc to prove your claim wrong. Also note that we don't have notation for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Relation.TransGen#doc\">docs#Relation.TransGen</a> and friends. It's exactly this situation where we define one relation from another where we often don't have notation.</p>",
        "id": 487063422,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733767353
    },
    {
        "content": "<p>(<a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=NumberField.RingOfintegers#doc\">docs#NumberField.RingOfintegers</a> is an example of a function with <em>prefix</em> notation, as opposed to infix or postfix)</p>",
        "id": 487064028,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733767519
    },
    {
        "content": "<p>Eh, fine. We can stay notationless for the time being then.</p>",
        "id": 487075009,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733770823
    },
    {
        "content": "<p>I imagine this discussion also implies we shouldn't have any notation for the future incomparability relation <code>IncompRel</code> either</p>",
        "id": 487075184,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733770870
    },
    {
        "content": "<p>I have an alternate proposal</p>",
        "id": 488029789,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733901218
    },
    {
        "content": "<p>Do we really need <code>AntisymmRel</code> for arbitrary relations?</p>",
        "id": 488029830,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733901237
    },
    {
        "content": "<p>Being able to just write <code>AntisymmRel a b</code> would be a pretty major improvement over <code>AntisymmRel (· ≤ ·) a b</code></p>",
        "id": 488029956,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1733901292
    },
    {
        "content": "<p>Yes, I will for sure. In C⋆-algebras there are multiple orderings which come up a lot. There's the usual <code>a ≤ b</code> if <code>b - a = star x * x</code> for some <code>x</code>, but there's also Cuntz subequivalence and (what is related) Murray-von Neumann equivalence of projections. Both of these are built from certain preorders via <code>AntisymmRel</code>.</p>",
        "id": 488146684,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733936884
    },
    {
        "content": "<p>These generic operations on relations should all take the specific relation as an argument. (e.g., imagine if <code>Relation.TransGen</code> only acted on <code>≤</code>, then you wouldn't even be able to state <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=lt_iff_transGen_covBy#doc\">docs#lt_iff_transGen_covBy</a>).</p>",
        "id": 488147146,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733937020
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Notation.20for.20AntisymmRel/near/487063027\">said</a>:</p>\n<blockquote>\n<p>I also don't think notation would be limited to the 100 lines of my PR. I expect that the <code>AntisymmRel</code> will grow as Mathlib defines more concrete preorders</p>\n</blockquote>\n<p>Violeta, I suggest we revisit this topic if and when this situation comes to pass. As for the current PR, it really doesn't seem burdensome. If you write 500 lines of necessary <code>AntisymmRel</code> API, then introduce some local notation. After you write 1000, consider some scoped notation. These aren't hard and fast limits, just some guidelines I would use to consider when some notation might be helpful, especially when it seems there isn't an existing consensus that the notation is favorable.</p>",
        "id": 488148405,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733937453
    },
    {
        "content": "<p>I think this is also an instance of a general pattern: Don't prematurely generalize. Wait until you actually need it, because if you try to do it in advance there is even odds that the anticipated use will never happen, and even if it does there are good chances that you will end up needing a different generalization than you prepared. The use cases have to be in the present or very near future, such that you have not just an idea but actual code in the pipeline that benefits from it, enough to counterbalance the cost of changes and additional complexity for readers and library users.</p>",
        "id": 488148911,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1733937629
    },
    {
        "content": "<p>Also, remember that library code is not optimized for you the writer, it is optimized for future users of the library (including you tomorrow). That's why readability is much more important than writability. When doing the cost benefit analysis of things like this you have to take care to not let the writer's bias come out too much and put yourself in the reader's shoes.</p>",
        "id": 488149452,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1733937827
    }
]