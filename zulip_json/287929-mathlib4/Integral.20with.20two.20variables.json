[
    {
        "content": "<p>I believe this is not common, but how can I solve an integral with two variables? Specifically:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∫</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">∫</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 501982496,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1740556674
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Integrable</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∫</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">∫</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Measure</span><span class=\"bp\">.</span><span class=\"n\">volume_eq_prod</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">integral_prod</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>I added an integrability hypothesis for <code>f</code>.<br>\nTo write the proof, I knew I wanted to rewrite the integral over a product space, so something like <code>integral_prod</code>. That lemma did not work directly because the volume over the product is not written as a product of volumes, so I found <code>Measure.volume_eq_prod</code> to rewrite it in that form.<br>\nIt's a bit tricky because the <code>volume</code> measures that I am rewriting are invisible in the integrals.</p>",
        "id": 501983913,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1740557245
    },
    {
        "content": "<p>I don't think we have a specialized lemma like <code>integral_prod</code> for the case of <code>volume</code>.</p>",
        "id": 501984167,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1740557338
    },
    {
        "content": "<p>But I believe the equality holds even without the assumption <code>Integrable f</code>. Can you somehow remove that assumption, or is that necessary?</p>",
        "id": 501984208,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1740557359
    },
    {
        "content": "<p>Without the integrability hypothesis the right hand side is zero by definition of our integral. Can we find a function such that the left hand side is non-zero, because it's integrable in one coordinate for some values of the other coordinate?</p>",
        "id": 501984511,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1740557477
    },
    {
        "content": "<p>I don't think so. If <code>f</code> is not integrable, then won't both sides be zero?</p>",
        "id": 501984870,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1740557610
    },
    {
        "content": "<p>Take <code>f (x, y)</code> equal to 1 if <code>x &lt; 0</code> or <code>x &gt; 1</code> and to some nonnegative <code>g y</code> otherwise, with <code>∫ y, g y = 1</code>. Then for a given <code>x</code>, the integral <code>∫ y, f (x, y)</code> is 0 outside of [0,1] because it's not integrable, and 1 inside of [0,1]. So it's the indicator of [0,1]. We then integrate over <code>x</code> and get 1.</p>",
        "id": 501985653,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1740557911
    },
    {
        "content": "<p>I don't understand. Is <code>∫ (x : ℝ) (y : ℝ)</code> equivalent to <code>∫ (x : ℝ), ∫ (y : ℝ)</code>?</p>",
        "id": 501986022,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1740558057
    },
    {
        "content": "<p>yes it is</p>",
        "id": 501986054,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1740558066
    },
    {
        "content": "<p>Oh.</p>",
        "id": 501986073,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1740558073
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∫</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">∫</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">∫</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 501986217,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1740558123
    },
    {
        "content": "<p>Thanks a lot. I hope I knew that earlier..</p>",
        "id": 501986340,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1740558175
    },
    {
        "content": "<p>(that's the first thing I checked in your example, because I actually did not know that we could write it with only one integral sign).</p>",
        "id": 501986348,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1740558176
    }
]