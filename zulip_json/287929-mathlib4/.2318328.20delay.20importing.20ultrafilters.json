[
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/18328\">#18328</a> attempts to delay importing ultrafilters. It does result in a fairly substantial import reduction (by requiring less order theory before we can do the basics of topology), so I'm quite tempted by it.</p>\n<p>However at present the PR has three sorries, resulting from proofs that previously went via ultrafilters (while not mentioning them in the statement).</p>\n<p>Would any filterologists be interested in either</p>\n<ul>\n<li>trying to repair the three sorries on that branch</li>\n<li>realising those three statements aren't need until later anyway, and moving them to a later file where ultrafilters are available anyway</li>\n<li>telling me that this is ill-conceived to begin with?</li>\n</ul>",
        "id": 479250185,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730113949
    },
    {
        "content": "<p>I am very confident that none of these proofs need ultrafilters. However I‚Äôm curious to understand why ultrafilters cost so much. What do they import that filter do not import? Zorn-related suff?</p>",
        "id": 479264520,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1730118748
    },
    {
        "content": "<p>If Zorn is costly then maybe <em>this</em> should change instead of changing topology.</p>",
        "id": 479264582,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1730118769
    },
    {
        "content": "<p>Zorn is quite easy to prove with few dependencies other than the things in the statement itself</p>",
        "id": 479264693,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1730118809
    },
    {
        "content": "<p>Yes, this is how it should be, hence my remark/question.</p>",
        "id": 479264764,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1730118835
    },
    {
        "content": "<p>The first sorry is to show (the existing theorem)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">protected</span><span class=\"w\"> </span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"bp\">.</span><span class=\"n\">NeBot</span><span class=\"bp\">.</span><span class=\"n\">le_pure_iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">NeBot</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>Here's a proof of it:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">ssubset_iff_subset_and_exists</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚äÇ</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚äÜ</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àâ</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">calc</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚äÇ</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚äÜ</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚äÇ</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">subset_of_ssubset</span>\n<span class=\"w\">    </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚äÜ</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àâ</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">ssubset_iff_of_subset</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"bp\">.</span><span class=\"n\">lt_iff_le_and_exists</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚àâ</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">ssubset_iff_subset_and_exists</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"bp\">.</span><span class=\"n\">isAtom_pure</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsAtom</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">And</span><span class=\"bp\">.</span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">NeBot</span><span class=\"bp\">.</span><span class=\"n\">ne'</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">by_contra!</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">.</span><span class=\"n\">NeBot</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">this</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Filter</span><span class=\"bp\">.</span><span class=\"n\">lt_iff_le_and_exists</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hb</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">hb</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hs</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hs'</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hb</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">compl_not_mem</span><span class=\"w\"> </span><span class=\"n\">hs</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">hs'</span><span class=\"o\">))</span>\n\n<span class=\"kn\">protected</span><span class=\"w\"> </span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"bp\">.</span><span class=\"n\">NeBot</span><span class=\"bp\">.</span><span class=\"n\">le_pure_iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">NeBot</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsAtom</span><span class=\"bp\">.</span><span class=\"n\">le_iff_eq</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"bp\">.</span><span class=\"n\">isAtom_pure</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">ne'</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">isOpen_singleton_iff_punctured_nhds</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsOpen</span><span class=\"w\"> </span><span class=\"o\">({</span><span class=\"n\">x</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">ùìù</span><span class=\"o\">[</span><span class=\"bp\">‚â†</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‚ä•</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">isOpen_singleton_iff_nhds_eq_pure</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">nhdsWithin</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">mem_iff_inf_principal_compl</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">le_pure_iff</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">nhds_neBot</span><span class=\"bp\">.</span><span class=\"n\">le_pure_iff</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>(This requires importing <code>import Mathlib.Order.Atoms</code>). I'm sure that the first four lemmas don't belong in this file, but the third one relates atoms in a poset to a specific filter. But atoms in the poset of filters are really the same thing as ultrafilters, which is why the ultrafilter things are useful (but not necessary) to have here. So it seems to me that the ultrafilter file should be split, with one part being about the order theory / atomic properties of ultrafilters (which shouldn't even require Zorn) and the other part containing whatever the heavy imports are?</p>\n<p>Similarly the second sorry can be done like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">IsAtom</span><span class=\"bp\">.</span><span class=\"n\">inf_neBot_iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsAtom</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">NeBot</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚äì</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">‚ü®</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">le_of_inf_eq</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">le_iff_eq</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">ne'</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">inf_le_left</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">neBot_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">]</span><span class=\"bp\">‚ü©</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">clusterPt_iff_lift'_closure'</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">ClusterPt</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">F</span><span class=\"bp\">.</span><span class=\"n\">lift'</span><span class=\"w\"> </span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"bp\">‚äì</span><span class=\"w\"> </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">NeBot</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">clusterPt_iff_lift'_closure</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">inf_comm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"bp\">.</span><span class=\"n\">isAtom_pure</span><span class=\"bp\">.</span><span class=\"n\">inf_neBot_iff</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>and it looks like the third one works in the same way as the first. The pattern here is that I'm just using IsAtom instead of Ultrafilter...</p>",
        "id": 479268800,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1730120083
    },
    {
        "content": "<p>You can also simply prove them without anything. I‚Äôm doing it.</p>",
        "id": 479270841,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1730120673
    },
    {
        "content": "<p>I pushed to <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span>‚Äôs branch which is now sorry-free.</p>",
        "id": 479271833,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1730120973
    },
    {
        "content": "<p>But I still think that ultrafilters should not be costly.</p>",
        "id": 479271870,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1730120989
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/287929-mathlib4/topic/.2318328.20delay.20importing.20ultrafilters/near/479250185\">said</a>:</p>\n<blockquote>\n<p>However at present the PR has three sorries, resulting from proofs that previously went via ultrafilters (while not mentioning them in the statement).</p>\n</blockquote>\n<p>Also, it feels a bit cheating to say that lemmas mentioning <code>pure</code> do not mention ultrafilters.</p>",
        "id": 479272123,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1730121062
    },
    {
        "content": "<p>My proofs are not golfed, the point is only to confirm they can be written without any extra import.</p>",
        "id": 479272398,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1730121144
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span> <a href=\"#narrow/channel/287929-mathlib4/topic/.2318328.20delay.20importing.20ultrafilters/near/479271833\">said</a>:</p>\n<blockquote>\n<p>I pushed to <span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span>‚Äôs branch which is now sorry-free.</p>\n</blockquote>\n<p>Ah this is indeed much nicer than my approach - I didn't realise that the minimality properties were only being used in special cases where a direct proof of them works! Very clean</p>",
        "id": 479272446,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1730121162
    },
    {
        "content": "<p>Note: this time devoted to Mathlib maintenance is courtesy of my grading duty structured procrastination.  Now I should go back to grading.</p>",
        "id": 479272705,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1730121242
    },
    {
        "content": "<p>I think that the main lesson we learn from this is that we should give Patrick more grading duties.</p>",
        "id": 479272992,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1730121326
    },
    {
        "content": "<p>Could someone take a look at <a href=\"https://github.com/leanprover-community/mathlib4/pull/18328\">#18328</a>? I think we can merge this, and then <em>separately</em> think about why ultrafilters are currently unnecessarily costly.</p>",
        "id": 479986357,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730428297
    },
    {
        "content": "<p>If someone would like to strip down ultrafilters themselves, here is the output of </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">graph</span><span class=\"w\"> </span><span class=\"c1\">--to Mathlib.Topology.Defs.Filter --from Mathlib.Data.List.Basic defs_filter.pdf</span>\n</code></pre></div>\n<p><a href=\"/user_uploads/3121/MqDSioZ-nPQfJ1Cb7X19LOU3/defs_filter.png\">defs_filter.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/MqDSioZ-nPQfJ1Cb7X19LOU3/defs_filter.png\" title=\"defs_filter.png\"><img data-original-dimensions=\"2901x2459\" src=\"/user_uploads/thumbnail/3121/MqDSioZ-nPQfJ1Cb7X19LOU3/defs_filter.png/840x560.webp\"></a></div><p>As usual, grey nodes are things imported by <code>Mathlib.Topology.Defs.Filter</code>, but not actually needed.</p>",
        "id": 479986530,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730428441
    },
    {
        "content": "<p>Essentially the answer is: the whole theory of finiteness is imported into <code>Mathlib.Order.Filter.Basic</code>.</p>",
        "id": 479986638,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730428519
    },
    {
        "content": "<p>On this graph it looks like ultrafilter add only a small cost to filters, right?</p>",
        "id": 480213535,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1730549560
    },
    {
        "content": "<p>And probably we could have a <code>Ultrafilter.Defs</code> with an even smaller added cost.</p>",
        "id": 480213564,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1730549583
    },
    {
        "content": "<p>But I agree merging <a href=\"https://github.com/leanprover-community/mathlib4/pull/18328\">#18328</a> was a sensible move.</p>",
        "id": 480213583,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1730549602
    },
    {
        "content": "<p>For anyone reading this thread, Bhavik and I are <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span></p>",
        "id": 480220858,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1730555423
    },
    {
        "content": "<p>I think that we should move the definition of <code>Ultrafilter</code> to <code>Filter/Defs</code>.</p>",
        "id": 480220994,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1730555540
    }
]