[
    {
        "content": "<p>In order to reduce the need for Lean to unfold definitions to find a <code>One</code> instance for <code>LpSpace</code>s in the <code>p=infty</code> versus <code>IsFiniteMeasure</code> case, we introduce in <a href=\"https://github.com/leanprover-community/mathlib4/pull/30030\">this PR</a> the class</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">MemLp</span><span class=\"bp\">.</span><span class=\"n\">Const</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ENorm</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"bp\">∞</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">μ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">eLpNorm_const_lt_top'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hc</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"n\">c</span><span class=\"bp\">‖ₑ</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">∞</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">eLpNorm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">μ</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"bp\">∞</span>\n</code></pre></div>\n<p>Would it be better for the field in this class to just be the disjunction <code>p = ∞ ∨ IsFiniteMeasure μ</code> to allow for case splits in proofs?</p>\n<p>See also the thread <a href=\"#narrow/channel/287929-mathlib4/topic/Lp.20constant.20function.20issue/with/537563137\">here.</a></p>",
        "id": 542843297,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1759446063
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> do you have an opinion here? I guess one reason to maybe not do the disjunction is that, at least with the current definition of <code>eLpNorm</code>, the value is finite when <code>p := 0</code> too. So if we use the class as listed above we could also have a <code>MemLp.Const</code> instance when <code>p := 0</code>.</p>",
        "id": 543647428,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1759888407
    },
    {
        "content": "<p>If the motivation is to make proofs easier we should just have a theorem that concludes the <code>Or</code></p>",
        "id": 543700219,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1759915779
    },
    {
        "content": "<p>I don't think we should change the generality just to make proofs easier, the justification needs to be stronger for that.</p>",
        "id": 543700409,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1759915841
    },
    {
        "content": "<p>Why do we need <code>ε</code>, not just <code>α</code>? Do you want to have an instance in the case <code>ε</code> is a subsingleton?</p>",
        "id": 543722843,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1759922963
    },
    {
        "content": "<p>Otherwise it looks like everything depends on the norm of <code>c</code> only, so you can assume that <code>c</code> is a real number.</p>",
        "id": 543722932,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1759922997
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"214703\">@Yury G. Kudryashov</span>  It seems <span class=\"user-mention\" data-user-id=\"197836\">@Jireh Loreaux</span>  is on board with what you said above, but I don't yet understand your point. Would you mind elaborating a bit?</p>",
        "id": 543942844,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1760011945
    },
    {
        "content": "<p>If you define</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">MemLp</span><span class=\"bp\">.</span><span class=\"n\">Const</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"bp\">∞</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">μ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">eLpNorm_const_lt_top'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">eLpNorm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">μ</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"bp\">∞</span>\n</code></pre></div>\n<p>then it will imply your <code>MemLp.Const</code> for all <code>\\eps</code>.</p>",
        "id": 543943138,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1760012019
    }
]