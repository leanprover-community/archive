[
    {
        "content": "<p>I see a number of lemmas (e.g. <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ContinuousMap.continuous#doc\">docs#ContinuousMap.continuous</a>) that are marked as deprecated in the docstring itself but not using <code>@[deprecated]</code>. Could somebody shed some light on this please? From git blame, let me ping <span class=\"user-mention\" data-user-id=\"214703\">@Yury G. Kudryashov</span></p>",
        "id": 546464998,
        "sender_full_name": "Winston Yin (尹維晨)",
        "timestamp": 1761141392
    },
    {
        "content": "<p>I'm still not sure whether I'm supposed to use them or not</p>",
        "id": 546467052,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1761141907
    },
    {
        "content": "<p>We should migrate from these lemmas to <code>ContinuousMapClass</code> lemmas some day.</p>",
        "id": 546467382,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1761141997
    },
    {
        "content": "<p>If this is a todo for the future, would you kindly document the plan in the docs, so someone else can also pick it up?</p>",
        "id": 546467681,
        "sender_full_name": "Winston Yin (尹維晨)",
        "timestamp": 1761142058
    },
    {
        "content": "<p>The plan is to migrate Mathlib to lemmas like <code>map_continuous</code>, then officially deprecate these lemmas using <code>@[deprecated]</code>.</p>",
        "id": 546467872,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1761142105
    },
    {
        "content": "<p>Let me try to do it now.</p>",
        "id": 546472468,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1761143186
    },
    {
        "content": "<p>I've started <a href=\"https://github.com/leanprover-community/mathlib4/pull/30790\">#30790</a>. I'm not sure about <code>congr_fun</code>/<code>congr_arg</code>: we have them for some bundled homs, but not for other.</p>",
        "id": 546481429,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1761145273
    },
    {
        "content": "<p>So, I've started with <code>ContinuousMap.continuous</code>. It's used in many files. I've migrated some of them, I'll continue tonight after hours.</p>",
        "id": 546481602,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1761145306
    },
    {
        "content": "<p>Thank you, Yury</p>",
        "id": 546541614,
        "sender_full_name": "Winston Yin (尹維晨)",
        "timestamp": 1761163471
    },
    {
        "content": "<p>Wait, why are we deprecating <code>ContinuousMap.continuous</code>? I will very much miss the ability to use projection notation in continuity proofs; I don't suppose we could make it an alias of some kind instead?</p>",
        "id": 546591563,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1761196417
    },
    {
        "content": "<p>I have no opinions one way or another. I started the thread just to resolve the doc comments stating these lemmas are deprecated.</p>",
        "id": 547090014,
        "sender_full_name": "Winston Yin (尹維晨)",
        "timestamp": 1761436923
    },
    {
        "content": "<p>We deprecated, then removed, lemmas like <code>AddMonoidHom.map_add</code>. Why continuity is any different?</p>",
        "id": 547090841,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1761437719
    },
    {
        "content": "<p>well <code>map_add</code> is an existing alternative lemma to use but <code>continuous</code> is not</p>",
        "id": 547091144,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1761438066
    },
    {
        "content": "<p>it doesn't exist</p>",
        "id": 547091149,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1761438077
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=map_continuous#doc\">docs#map_continuous</a></p>",
        "id": 547091465,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1761438607
    },
    {
        "content": "<p>Sorry, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ContinuousMapClass.map_continuous#doc\">docs#ContinuousMapClass.map_continuous</a> (exported to the root NS)</p>",
        "id": 547091491,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1761438656
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Deprecated.20ContinuousMap.20lemmas/near/547090841\">said</a>:</p>\n<blockquote>\n<p>We deprecated, then removed, lemmas like <code>AddMonoidHom.map_add</code>. Why continuity is any different?</p>\n</blockquote>\n<p>There is evidence that this was a mistake because <code>map_add</code> is much costlier in typeclass search than <code>AddMonoidHom.map_add</code> was</p>",
        "id": 547110677,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1761464311
    },
    {
        "content": "<p>hm<br>\nwhat is the solution to the resulting duplicated API?</p>",
        "id": 547125418,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1761480355
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Deprecated.20ContinuousMap.20lemmas/near/547110677\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Deprecated.20ContinuousMap.20lemmas/near/547090841\">said</a>:</p>\n<blockquote>\n<p>We deprecated, then removed, lemmas like <code>AddMonoidHom.map_add</code>. Why continuity is any different?</p>\n</blockquote>\n<p>There is evidence that this was a mistake because <code>map_add</code> is much costlier in typeclass search than <code>AddMonoidHom.map_add</code> was</p>\n</blockquote>\n<p>What do you suggest? Drop all of <code>*HomClass</code>es and go back to <code>*Hom.map_add</code> etc? Something else?</p>",
        "id": 547149931,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1761502520
    },
    {
        "content": "<p>For now, I'm going to cherry-pick parts of my PR that make sense no matter what we decide to do with these lemmas, and postpone the rest.</p>",
        "id": 547150694,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1761503343
    },
    {
        "content": "<p>I think it doesn't hurt to keep both?</p>",
        "id": 547157370,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1761510255
    },
    {
        "content": "<p>(I am talking about <code>*Hom.map_add</code>. I don't have enough experience with <code>ContinuousMapClass</code> to have an opinion here)</p>",
        "id": 547157403,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1761510286
    },
    {
        "content": "<p>So, the suggestion is to keep both of them, use <code>_root_.map_*</code> in <code>simp</code> lemmas but allow usage of <code>*Hom.map_*</code> in manual <code>rw</code>/<code>simp only</code>/<code>apply</code>?</p>",
        "id": 547167922,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1761522150
    }
]