[
    {
        "content": "<p>Currently the definition of Absolutely Convex in Mathlib is a little unexpected:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">AbsConvex</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Balanced</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">Convex</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">s</span>\n</code></pre></div>\n<p>At the time this definition was formulated, Mathlib's definition of <code>Convex</code> required the scalars to be an <code>OrderedSemiring</code> whereas the definition of <code>Balanced</code> required the scalars to be a <code>SeminormedRing</code>. Mathlib didn't  have a concept of a semi-normed ordered ring, so a set was defined as <code>AbsConvex</code> if it is balanced over a <code>SeminormedRing</code> <code>ùïú</code> and convex over <code>‚Ñù</code>.</p>\n<p>Recently the requirements for the definition of <code>Convex</code> have been relaxed (<a href=\"https://github.com/leanprover-community/mathlib4/pull/24392\">#24392</a>, <a href=\"https://github.com/leanprover-community/mathlib4/pull/20595\">#20595</a>) so it is now possible to use a single scalar ring in common with the literature.</p>\n<p>I've opened a PR to make this change (<a href=\"https://github.com/leanprover-community/mathlib4/pull/29342\">#29342</a>) but <span class=\"user-mention\" data-user-id=\"197836\">@Jireh Loreaux</span> has suggested that it should be discussed here first, in particular the partial order on the complex numbers <a href=\"https://github.com/leanprover-community/mathlib4/pull/29342/files#diff-ba50cd1f8d6dfb5d017128c6e40f79de27adf53ce8c572d22bef36ff7a777795R85\">https://github.com/leanprover-community/mathlib4/pull/29342/files#diff-ba50cd1f8d6dfb5d017128c6e40f79de27adf53ce8c572d22bef36ff7a777795R85</a></p>\n<p>Previous discussion:</p>\n<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/17029#discussion_r1782249323\">https://github.com/leanprover-community/mathlib4/pull/17029#discussion_r1782249323</a></li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/26345#discussion_r2287535746\">https://github.com/leanprover-community/mathlib4/pull/26345#discussion_r2287535746</a></li>\n</ul>\n<p>Thanks,</p>\n<p>Christopher</p>",
        "id": 543406523,
        "sender_full_name": "Christopher Hoskin",
        "timestamp": 1759784184
    },
    {
        "content": "<p>Are there any opinions on this or alternative suggestions on how to proceed please? <span class=\"user-mention\" data-user-id=\"387244\">@Ya√´l Dillies</span> <span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> <span class=\"user-mention\" data-user-id=\"300245\">@Filippo A. E. Nuccio</span> <span class=\"user-mention\" data-user-id=\"412682\">@Moritz Doll</span> <span class=\"user-mention\" data-user-id=\"462733\">@Jon Bannon</span> <span class=\"user-mention\" data-user-id=\"268315\">@Anatole Dedecker</span> <span class=\"user-mention\" data-user-id=\"477483\">@Monica Omar</span> (list of people who have been kind enough to comment on related PRs). Thanks.</p>",
        "id": 544094341,
        "sender_full_name": "Christopher Hoskin",
        "timestamp": 1760077192
    },
    {
        "content": "<p>I am sorry, I had completely overseen your first message. I'll try to have a look, but as a start I do not understand why <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsOrderedRing#doc\">docs#IsOrderedRing</a> is not <code>IsOrderedSemiring</code>.</p>",
        "id": 544097880,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1760079068
    },
    {
        "content": "<p>Oh, that's just the same reason as to why <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Module#doc\">docs#Module</a> is not called <code>Semimodule</code>: when a typeclass covers several use cases, we do not necessarily name it after the most general one, but after the most common one.</p>",
        "id": 544098067,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760079181
    },
    {
        "content": "<p>Well, but this is highly misleading I find. Since we put some effort in the library to keep Semiring and Ring separated (unlike Semimodule, that appears much less), I would expect a different treatement. Or is it a <em>general</em> agreement to avoid <code>Is</code>+ <code>Semi</code> altogether?</p>",
        "id": 544098266,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1760079292
    },
    {
        "content": "<p>Filippo, I am sympathetic to your argument, but this is a different discussion to the one Christopher is trying to have</p>",
        "id": 544098430,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760079366
    },
    {
        "content": "<p>Yes, good point. My apologies. I'll try to look at the PR and might resurrect this point elsewhere. Thanks for the alert <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 544098470,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1760079388
    },
    {
        "content": "<p>I have thought about this a bit a while ago, and I seem to remember that it was important that the two scalar rings could be different. I do not think it matters further than being able to set one of them to <code>\\R</code> and the other one to <code>\\C</code> (or similarly <code>\\Q</code> and <code>\\Q(i)</code>), so if you're willing to talk about the order on <code>\\C</code>/<code>\\Q(i)</code>, then I see no downside to your refactor.</p>",
        "id": 544098572,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760079433
    },
    {
        "content": "<p>Do people in fact care about <code>\\Q</code>-absolutely convex sets?</p>",
        "id": 544098703,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760079491
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Ya√´l Dillies</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Redefining.20.60AbsConvex.60.20to.20use.20a.20single.20ring.20of.20scalars/near/544098572\">said</a>:</p>\n<blockquote>\n<p>I have thought about this a bit a while ago, and I seem to remember that it was important that the two scalar rings could be different.</p>\n</blockquote>\n<p>The other possibility would be to make the definition something like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ùïú‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">ùïú‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SeminormedRing</span><span class=\"w\"> </span><span class=\"n\">ùïú‚ÇÅ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SMul</span><span class=\"w\"> </span><span class=\"n\">ùïú‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SMul</span><span class=\"w\"> </span><span class=\"n\">ùïú‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Semiring</span><span class=\"w\"> </span><span class=\"n\">ùïú‚ÇÇ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">PartialOrder</span><span class=\"w\"> </span><span class=\"n\">ùïú‚ÇÇ</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span>\n<span class=\"sd\">/-- A set is absolutely convex if it is balanced and convex. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">AbsConvex</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Balanced</span><span class=\"w\"> </span><span class=\"n\">ùïú‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">Convex</span><span class=\"w\"> </span><span class=\"n\">ùïú‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">s</span>\n</code></pre></div>\n<p><span class=\"user-mention silent\" data-user-id=\"387244\">Ya√´l Dillies</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Redefining.20.60AbsConvex.60.20to.20use.20a.20single.20ring.20of.20scalars/near/544098572\">said</a>:</p>\n<blockquote>\n<p>I do not think it matters further than being able to set one of them to <code>\\R</code> and the other one to <code>\\C</code></p>\n</blockquote>\n<p>I introduced <code>convex_RCLike_iff_convex_real</code> in <a href=\"https://github.com/leanprover-community/mathlib4/pull/29248\">#29248</a> to move between the real and complex case.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"387244\">Ya√´l Dillies</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Redefining.20.60AbsConvex.60.20to.20use.20a.20single.20ring.20of.20scalars/near/544098572\">said</a>:</p>\n<blockquote>\n<p>(or similarly <code>\\Q</code> and <code>\\Q(i)</code>)</p>\n</blockquote>\n<p>I occasionally find myself wondering how much of <code>RCLike</code> actually holds for any quadratic alternative real division algebra (i.e. <code>‚Ñù</code>, <code>‚ÑÇ</code>, <code>‚Ñö</code> and <code>ùïÜ</code>) - but I haven't given that any serious thought.</p>",
        "id": 544102299,
        "sender_full_name": "Christopher Hoskin",
        "timestamp": 1760081017
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"373192\">Christopher Hoskin</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Redefining.20.60AbsConvex.60.20to.20use.20a.20single.20ring.20of.20scalars/near/544102299\">said</a>:</p>\n<blockquote>\n<p>The other possibility would be to make the definition something like this:</p>\n</blockquote>\n<p>Yes, but at this point are you saving much over just using <code>Balanced ùïú‚ÇÅ s ‚àß Convex ùïú‚ÇÇ s</code>?</p>",
        "id": 544102451,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760081071
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"373192\">Christopher Hoskin</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Redefining.20.60AbsConvex.60.20to.20use.20a.20single.20ring.20of.20scalars/near/543406523\">said</a>:</p>\n<blockquote>\n<p>At the time this definition was formulated, Mathlib's definition of <code>Convex</code> required the scalars to be an <code>OrderedSemiring</code> whereas the definition of <code>Balanced</code> required the scalars to be a <code>SeminormedRing</code>. Mathlib didn't have a concept of a semi-normed ordered ring, so a set was defined as <code>AbsConvex</code> if it is balanced over a <code>SeminormedRing</code> <code>ùïú</code> and convex over <code>‚Ñù</code>.</p>\n</blockquote>\n<p>This was just guesswork on my part, so there may have been other reasons for defining it this way.</p>",
        "id": 544102506,
        "sender_full_name": "Christopher Hoskin",
        "timestamp": 1760081093
    },
    {
        "content": "<p>For what is worth, there is a crucial user of convexity for vector spaces over nonarchimedean fields, and there quadratic extensions are galore. That being said, the current definition of convex, even with this refactor, does not align with the one used in that context .</p>",
        "id": 544103687,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1760081554
    },
    {
        "content": "<p>Kaup and Upmeier, Jordan algebras and Symmetric Siegel Domains in Banach Spaces, Math. Z. 157, 179-200 (1977) define complex extreme points (and by extension complex convexity) using scalars in the unit ball of <code>‚ÑÇ</code> rather than the positive unit ball.</p>",
        "id": 544107664,
        "sender_full_name": "Christopher Hoskin",
        "timestamp": 1760082935
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"373192\">@Christopher Hoskin</span> do you have a usecase in mind?</p>",
        "id": 544121426,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760087543
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Ya√´l Dillies</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Redefining.20.60AbsConvex.60.20to.20use.20a.20single.20ring.20of.20scalars/near/544098572\">said</a>:</p>\n<blockquote>\n<p>one of them to <code>\\R</code> and the other one to <code>\\C</code></p>\n</blockquote>\n<p><del>but isn't the C-unit disc in C the same as the R-unit disc in C?</del></p>",
        "id": 544121576,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760087595
    },
    {
        "content": "<p>oh, never mind, they are different</p>",
        "id": 544121683,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760087629
    },
    {
        "content": "<p>do you remember why you needed that?</p>",
        "id": 544121747,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760087659
    },
    {
        "content": "<p>am i right in thinking that they‚Äôre equivalent definitions? a ùïú-balanced set is ùïú-convex iff it‚Äôs ‚Ñù-convex?</p>",
        "id": 544138425,
        "sender_full_name": "Monica Omar",
        "timestamp": 1760093158
    },
    {
        "content": "<p>what does 0&lt;x&lt;1 mean if x is complex?</p>",
        "id": 544138596,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760093212
    },
    {
        "content": "<p>right, but we‚Äôre weakening the definition to a seminormed ring /bbk, not R or C</p>",
        "id": 544140629,
        "sender_full_name": "Monica Omar",
        "timestamp": 1760093838
    },
    {
        "content": "<p>ignore me. this refactor looks fine to me</p>",
        "id": 544140809,
        "sender_full_name": "Monica Omar",
        "timestamp": 1760093905
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Redefining.20.60AbsConvex.60.20to.20use.20a.20single.20ring.20of.20scalars/near/544138596\">said</a>:</p>\n<blockquote>\n<p>what does 0&lt;x&lt;1 mean if x is complex?</p>\n</blockquote>\n<p>According to mathlib it means terms of this type:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">ComplexOrder</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">}</span>\n</code></pre></div>",
        "id": 544141796,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1760094194
    },
    {
        "content": "<p>They are precisely the real numbers <code>0 &lt; x &lt; 1</code>, see <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Complex.lt_def#doc\">docs#Complex.lt_def</a> and the aforementionned <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=convex_RCLike_iff_convex_real#doc\">docs#convex_RCLike_iff_convex_real</a></p>",
        "id": 544143055,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1760094626
    },
    {
        "content": "<p>lol I thought kenny's question was rhetorical</p>",
        "id": 544143547,
        "sender_full_name": "Monica Omar",
        "timestamp": 1760094803
    },
    {
        "content": "<p>Ah, maybe it was, but I guess answering it doesn't hurt x)</p>",
        "id": 544143916,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1760094935
    },
    {
        "content": "<p>I think I'm in favor of this refactor. Anything that means that we don't have to work with both a real and a complex structure is good, and mathematically it shouldn't change anything (unless people care about this definition for other rings, but I can't really see that happening)</p>",
        "id": 544145323,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1760095432
    }
]