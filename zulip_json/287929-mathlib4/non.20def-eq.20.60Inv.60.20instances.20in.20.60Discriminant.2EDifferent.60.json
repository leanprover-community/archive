[
    {
        "content": "<p>Would someone be interested in investigating an issue in <code>Mathlib.NumberTheory.NumberField.Discriminant.Different</code>, where there appear to be non def-eq <code>Inv</code> instances around?</p>\n<p>In particular, in <code>theorem linearDisjoint_of_isGalois_isCoprime_discr</code>, if we change <code>linarith [abs_discr_gt_two this]</code>to <code>grind [abs_discr_gt_two this]</code> then we get the error:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">while</span><span class=\"w\"> </span><span class=\"n\">initializing</span><span class=\"w\"> </span><span class=\"ss\">`grind</span><span class=\"w\"> </span><span class=\"n\">ring</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">operators</span><span class=\"o\">:</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"ss\">`Inv.inv</span><span class=\"bp\">`</span>\n<span class=\"w\">  </span><span class=\"n\">InvMemClass</span><span class=\"bp\">.</span><span class=\"n\">inv</span>\n<span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">definitionally</span><span class=\"w\"> </span><span class=\"n\">equal</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">one</span>\n<span class=\"w\">  </span><span class=\"n\">Field</span><span class=\"bp\">.</span><span class=\"n\">toGrindField</span><span class=\"bp\">.</span><span class=\"n\">toInv</span>\n<span class=\"n\">when</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"n\">reducible</span><span class=\"w\"> </span><span class=\"n\">definitions</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">instances</span><span class=\"w\"> </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">reduced</span>\n</code></pre></div>\n<p>(Perhaps <span class=\"user-mention\" data-user-id=\"439483\">@Andrew Yang</span>, who is the author of this file? But help from anyone investigating this would be appreciated.)</p>",
        "id": 563093303,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1765419126
    },
    {
        "content": "<p>Here is a more minimised example:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">FieldTheory</span><span class=\"bp\">.</span><span class=\"n\">IntermediateField</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IntermediateField</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Field</span><span class=\"bp\">.</span><span class=\"n\">toGrindField</span><span class=\"bp\">.</span><span class=\"n\">toInv</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Inv</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">InvMemClass</span><span class=\"bp\">.</span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">delta</span><span class=\"w\"> </span><span class=\"n\">InvMemClass</span><span class=\"bp\">.</span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"c1\">-- fails without this</span>\n<span class=\"w\">  </span><span class=\"n\">with_reducible_and_instances</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>They are not equal under instance reducibility, but when I unfolded an instance it then became so.</p>",
        "id": 563094234,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1765420084
    },
    {
        "content": "<p>Fixed in <a href=\"https://github.com/leanprover-community/mathlib4/pull/32711\">https://github.com/leanprover-community/mathlib4/pull/32711</a></p>",
        "id": 563097359,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1765422713
    }
]