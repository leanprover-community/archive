[
    {
        "content": "<p>Is there a way to run (all?) the linters locally?  All I currently run locally is <code>./scripts/lint-style.py &lt;filename&gt;</code> and wondering if there is something else I can run to better test against linting errors before pushing to github?</p>",
        "id": 401240842,
        "sender_full_name": "Newell Jensen",
        "timestamp": 1699565765
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">lake</span> <span class=\"n\">exe</span> <span class=\"n\">runMathlibLinter</span>\n</code></pre></div>",
        "id": 401240984,
        "sender_full_name": "David Renshaw",
        "timestamp": 1699565850
    },
    {
        "content": "<p>you can run it on individual files</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">lake</span> <span class=\"n\">exe</span> <span class=\"n\">runMathlibLinter</span>  <span class=\"n\">Mathlib.Algebra.Order.SMul</span>\n</code></pre></div>",
        "id": 401241141,
        "sender_full_name": "David Renshaw",
        "timestamp": 1699565921
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243791\">David Renshaw</span> <a href=\"#narrow/stream/287929-mathlib4/topic/run.20linters.20locally/near/401241141\">said</a>:</p>\n<blockquote>\n<p>you can run it on individual files</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">lake</span> <span class=\"n\">exe</span> <span class=\"n\">runMathlibLinter</span>  <span class=\"n\">Mathlib.Algebra.Order.SMul</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Perfect thanks!</p>",
        "id": 401241200,
        "sender_full_name": "Newell Jensen",
        "timestamp": 1699565963
    },
    {
        "content": "<p>Hmmm, this doesn't catch the linting error I get from the CI build.</p>",
        "id": 401241621,
        "sender_full_name": "Newell Jensen",
        "timestamp": 1699566172
    },
    {
        "content": "<p>Which error?</p>",
        "id": 401251326,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1699571147
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"127136\">Alex J. Best</span> <a href=\"#narrow/stream/287929-mathlib4/topic/run.20linters.20locally/near/401251326\">said</a>:</p>\n<blockquote>\n<p>Which error?</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/6817820957/job/18542139285?pr=8223\">https://github.com/leanprover-community/mathlib4/actions/runs/6817820957/job/18542139285?pr=8223</a></p>",
        "id": 401253741,
        "sender_full_name": "Newell Jensen",
        "timestamp": 1699572785
    },
    {
        "content": "<p>Hmm, that should definitely show up when the linter runs locally on that file, weird</p>",
        "id": 401258832,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1699575841
    },
    {
        "content": "<p>Okay, the issue was I needed to run <code>lake build</code> before running the linter to get it to work properly.</p>",
        "id": 401438279,
        "sender_full_name": "Newell Jensen",
        "timestamp": 1699650712
    },
    {
        "content": "<p>I wish this info on how to run CI locally is included in how-to documents on contributing to mathlib4. Or does it? I never seen one until I searched this thread</p>",
        "id": 453076493,
        "sender_full_name": "Jineon Baek",
        "timestamp": 1721622464
    },
    {
        "content": "<p>I agree it would be useful - and a PR adding it would be welcome!</p>",
        "id": 453128227,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1721641086
    },
    {
        "content": "<p>That said: right now, running all mathlib linters is kind of slow (10 minutes on CI, easily 20 on my computer): there is a linter about all lemmas marked with the <code>@[simp]</code> attribute having the right shape - and this linter is necessarily global, and takes a while.</p>",
        "id": 453128546,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1721641171
    },
    {
        "content": "<p>I never run these linters locally, but rely on CI to catch these. There is no expectation that you do so.</p>",
        "id": 453128673,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1721641202
    },
    {
        "content": "<p>Another option: you can put <code>#lint</code> at the end of your file, and it will tell you about all linters for the file you're editing. That's usually good enough!</p>",
        "id": 453128849,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1721641243
    },
    {
        "content": "<p>Let me also add: after a small change (which I intend to PR soon), you will be able to run <code>lake lint filename</code> instead, and can also select individual linters. No need to memorise <code>runLinter</code>.</p>",
        "id": 453129244,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1721641329
    }
]