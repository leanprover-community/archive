[
    {
        "content": "<p>The current <a href=\"https://leanprover-community.github.io/contribute/style.html#anonymous-functions\">style guide</a> says:</p>\n<blockquote>\n<p>The Lean default for this is <code>fun x =&gt; x * x</code>, but the <code>‚Ü¶</code> arrow (inserted with <code>\\mapsto</code>) is also valid. In mathlib the pretty printer displays <code>‚Ü¶</code>, and we slightly prefer this in the source as well.</p>\n</blockquote>\n<p>Should we switch to <code>‚Ü¶</code> globally across mathlib? This is recently raised on Zulip <a class=\"message-link\" href=\"/#narrow/channel/287929-mathlib4/topic/linter.20requests/near/533494296\">#mathlib4 &gt; linter requests @ üí¨</a> and <span class=\"user-mention\" data-user-id=\"634338\">@Michael Rothgang</span> volunteered to write a linter for it, and I can volunteer for the PR that replaces <code>=&gt;</code> with <code>‚Ü¶</code> (there are a few occurences in the style guidelines also). We'll need to modify the wording of this guidline too. </p>\n<p>The problem with allowing both is that when you add something to an old file which uses <code>=&gt;</code>, you would be tempted to conform to the convention and keep using the less preferred <code>=&gt;</code> spelling, or otherwise switch the whole file to the mathlib style <code>‚Ü¶</code> (which increases the review burden). This <a href=\"https://github.com/leanprover-community/mathlib4/pull/28500#discussion_r2280422160\">happened in #28500</a> which is the motivation of this post.</p>\n<p><strong>Update</strong>: after <a href=\"#narrow/channel/287929-mathlib4/topic/Switch.20to.20.E2.86.A6.20.28.5Cmapsto.29.20globally/near/534975200\">discussions</a> in this thread, I proclaim that \"everywhere\" in the vote below should mean Mathlib/, Archive/ and Counterexamples/, but exclude meta-oriented directories and files Tactic/, Testing/, Util/, Lean/, Init.lean, and Tactic.lean under Mathlib/, as shown in <a href=\"#narrow/channel/287929-mathlib4/topic/Switch.20to.20.E2.86.A6.20.28.5Cmapsto.29.20globally/near/535040379\">the replacement script</a>. See <a href=\"https://github.com/leanprover-community/mathlib4/pull/28622\">#28622</a> and <a href=\"https://github.com/leanprover-community/mathlib4/pull/28626\">#28626</a> for PRs that do the replacements.</p>",
        "id": 534945155,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1755521435
    },
    {
        "content": "<p>/poll You opinion<br>\nUse ‚Ü¶ everywhere<br>\nUse =&gt; everywhere<br>\nAllow both</p>",
        "id": 534945295,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1755521482
    },
    {
        "content": "<p>As a reminder, a regex replacement won't work as there are plenty of bits of lean grammar that while analogous to functions, do not support this syntax</p>",
        "id": 534945967,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755521710
    },
    {
        "content": "<p><code>induction</code>, <code>case</code>, <code>match</code> are some keywords to pay attention to (where replacement may not be possible). My plan is to ask Claude to write a script for replacements, compile after replacements, report any error to Claude for it to generate a new script, and iterate. Hopefully after a few iterations only a few manual replacements are necessary. (Maybe there will be false negative which the linter would hopefully help catch.)</p>",
        "id": 534946913,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1755522019
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"224323\">Junyan Xu</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Switch.20to.20.E2.86.A6.20.28.5Cmapsto.29.20globally/near/534945155\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>In mathlib the pretty printer displays <code>‚Ü¶</code></p>\n</blockquote>\n</blockquote>\n<p>this is actually not true:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- ‚ä¢ (fun x =&gt; x) 3 = 4</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 534947741,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755522233
    },
    {
        "content": "<p>I think we should change the pretty printer to display <code>‚Ü¶</code></p>",
        "id": 534947779,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755522245
    },
    {
        "content": "<p>Weird, I'm definitely seeing <code>‚Ü¶</code> most of the time; this is a random file GroupTheory/Perm/Centralizer.lean that happens to be open in my editor.<br>\n<a href=\"/user_uploads/3121/HtvzTmnzrNuNQnrUInAnKeT3/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/HtvzTmnzrNuNQnrUInAnKeT3/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"384x77\" src=\"/user_uploads/thumbnail/3121/HtvzTmnzrNuNQnrUInAnKeT3/image.png/840x560.webp\"></a></div>",
        "id": 534948119,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1755522350
    },
    {
        "content": "<p>have you tried copying it and seeing what it actually outputs?</p>",
        "id": 534948209,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755522382
    },
    {
        "content": "<p>What do you mean? This is a screenshot of the infoview (of the goal).</p>",
        "id": 534948374,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1755522440
    },
    {
        "content": "<p>The problem with allowing both <code>‚Ü¶</code> and <code>=&gt;</code> is that when you add something to an old file which uses <code>=&gt;</code>, you would be tempted to conform to the convention and keep using the less preferred <code>=&gt;</code> spelling, or otherwise switch the whole file to the mathlib style <code>‚Ü¶</code> (which increases the review burden). This <a href=\"https://github.com/leanprover-community/mathlib4/pull/28500#discussion_r2280422160\">happened in #28500</a> which is the motivation of this post.<br>\n(Also added to the OP)</p>",
        "id": 534948473,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1755522475
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Switch.20to.20.E2.86.A6.20.28.5Cmapsto.29.20globally/near/534947779\">said</a>:</p>\n<blockquote>\n<p>I think we should change the pretty printer to display <code>‚Ü¶</code></p>\n</blockquote>\n<p>The pretty printer does display <code>‚Ü¶</code>, but only when the file you're in is in the <code>Mathlib</code> folder</p>",
        "id": 534948581,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755522516
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Switch.20to.20.E2.86.A6.20.28.5Cmapsto.29.20globally/near/534947741\">said</a>:</p>\n<blockquote>\n<p>this is actually not true:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- ‚ä¢ (fun x =&gt; x) 3 = 4</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>I think you are confusing \"in mathlib\" with \"in the web editor\"</p>",
        "id": 534950003,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755522944
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Switch.20to.20.E2.86.A6.20.28.5Cmapsto.29.20globally/near/534948581\">said</a>:</p>\n<blockquote>\n<p>The pretty printer does display <code>‚Ü¶</code>, but only when the file you're in is in the <code>Mathlib</code> folder</p>\n</blockquote>\n<p>More accurately, \"only when you are in a project that records this desire in the lakefile\"</p>",
        "id": 534950163,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755522995
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Switch.20to.20.E2.86.A6.20.28.5Cmapsto.29.20globally/near/534950003\">said</a>:</p>\n<blockquote>\n<p>I think you are confusing \"in mathlib\" with \"in the web editor\"</p>\n</blockquote>\n<p>good point, but I use the web editor a lot too</p>",
        "id": 534951015,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755523234
    },
    {
        "content": "<p>The web editor should fix the lakefile then<br>\n<span class=\"user-mention silent\" data-user-id=\"110043\">Gabriel Ebner</span> <a href=\"#narrow/channel/287929-mathlib4/topic/.3D.3E.20notation/near/319657140\">said</a>:</p>\n<blockquote>\n<p>Yes, it should be enough to add the <code>pp.unicodeFun</code> option to the lakefile now.</p>\n</blockquote>",
        "id": 534951553,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1755523396
    },
    {
        "content": "<p>Previous discussion: <a href=\"#narrow/channel/287929-mathlib4/topic/.3D.3E.20notation/near/310378186\">#mathlib4 &gt; =&gt; notation @ üí¨</a></p>",
        "id": 534952373,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755523634
    },
    {
        "content": "<p>Most discussions there were before the <code>‚Ü¶</code> notation was implemented and <a href=\"#narrow/channel/287929-mathlib4/topic/.3D.3E.20notation/near/311254479\">merged</a>. Here I'm not proposing introducing any new syntax, but simply doing some replacements (and adding a linter so you don't have to / no longer can make a choice which one to use).</p>",
        "id": 534963362,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1755527153
    },
    {
        "content": "<p>What exactly <em>is</em> the advantage of <code>=&gt;</code> vs <code>‚Ü¶</code>?</p>",
        "id": 534963788,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755527288
    },
    {
        "content": "<p>The advantage of <code>=&gt;</code> is that it's faster to type than <code>‚Ü¶</code>. And there are cases where <code>‚Ü¶</code> doesn't work, so in general it's safer to just type <code>=&gt;</code> without thinking about it. And I've personally gotten used to always writing <code>=&gt;</code>, probably because of all the metaprogramming I've been doing.</p>",
        "id": 534965862,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1755527931
    },
    {
        "content": "<p><code>\" \"</code> is faster to type than <code>/-- -/</code> but we still <a href=\"https://github.com/leanprover-community/mathlib4/pull/28066/files\">switched</a> to the latter ...<br>\n(BTW you only need to type <code>\\map </code> for <code>‚Ü¶ </code>, no Shift key involved)</p>",
        "id": 534967160,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1755528356
    },
    {
        "content": "<p>Purely by aesthetics, I would use <code>‚Ü¶</code> in ‚Äúmath‚Äù files and <code>=&gt;</code> in ‚Äúprogramming‚Äù files (metaprogramming, infrastructure), maybe determined by folder. I‚Äôm not sure what this would feel like in practice.</p>",
        "id": 534967911,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1755528580
    },
    {
        "content": "<p>(By the way, I‚Äôve been recently test-driving some lean code that edits source throughout mathlib in a syntax-aware way‚Äîoverlapping with Mario‚Äôs refactor infrastructure, but with a different implementation‚Äîwithout going through Claude. If we do switch to a different syntax, free to ping me if you‚Äôd like to avoid Claude + manual iterations.  :) )</p>",
        "id": 534968090,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1755528637
    },
    {
        "content": "<p>I agree that <code>‚Ü¶</code> belongs in mathematical expressions, the kinds of expressions that a mathematician might write on paper. But in metaprogramming, and maybe even in proofs, e.g. proving <code>p ‚Üí p</code> using <code>fun x =&gt; x</code>, it's not clear to me that <code>‚Ü¶</code> is better.</p>",
        "id": 534968410,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1755528746
    },
    {
        "content": "<p>I presume we don't have a reliable way to automatically differentiate between \"math\" and \"programming\" types? Differentiating by folder would be a bit unsatisfactory given that math files often have snippets of meta code, and meta files often prove some lemmas.</p>",
        "id": 534969365,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1755529059
    },
    {
        "content": "<p>One point in favor of mirroring familiar mathematical expressions in math files is making mathlib source code feel more approachable for mathematicians. In (meta)programming I agree that it‚Äôs unnecessary.</p>\n<p>If that‚Äôs the motivation, then one reason to differentiate by folder could be to differentiate by ‚Äúwhat mathematicians are likely to be looking at.‚Äù</p>\n<p>(Alternatively, I wonder if the upcoming <code>meta</code> keyword could provide a different criterion? Though I fear that would be too complex; one advantage of going by folder is that it‚Äôs simple and predictable. Of course, even simpler is ‚Äújust use one thing‚Äù or ‚Äújust allow both‚Äù‚Ä¶ :) )</p>",
        "id": 534970086,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1755529258
    },
    {
        "content": "<p>As a first approximation we can single out some folders as meta and not touch them. Within Mathlib/ I see Tactic/, Testing/, Util/, Init.lean, and Tactic.lean. Anything else?</p>",
        "id": 534975200,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1755530859
    },
    {
        "content": "<p><code>Lean</code>, right?</p>",
        "id": 534976576,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1755531307
    },
    {
        "content": "<p>Probably Lean/, Mathport/, and Std/ as well, I‚Äôd say (though for slightly different reasons than because they‚Äôre metaprogramming per se)</p>",
        "id": 534976697,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1755531345
    },
    {
        "content": "<p>Wait, Mathport only has an .md, and Std has exactly one file?</p>",
        "id": 534976854,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1755531391
    },
    {
        "content": "<p>So I suppose those are edge cases. <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span></p>",
        "id": 534976994,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1755531426
    },
    {
        "content": "<p>It looks appropriate to me to replace the single =&gt; in Std/Data/HashMap.lean ...</p>",
        "id": 534977182,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1755531489
    },
    {
        "content": "<p>Ah, a <em>nontrivial</em> edge case! The best kind‚Ä¶</p>",
        "id": 534977395,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1755531565
    },
    {
        "content": "<p>Btw, my thoughts for Std were that its contents ‚Äúbelong somewhere else‚Äù and might be upstreamed‚Äîhence it might not make sense to impose this particular Mathlib style constraint.</p>",
        "id": 534978329,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1755531869
    },
    {
        "content": "<p>As far as I'm aware, <code>Mathlib.Std.Data.HashMap</code> is completely redundant (we have <code>Std.HashMap.map</code> even with quite a few lemmas about it)</p>",
        "id": 535009621,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1755545335
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479299\">Jovan Gerbscheid</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Switch.20to.20.E2.86.A6.20.28.5Cmapsto.29.20globally/near/534965862\">said</a>:</p>\n<blockquote>\n<p>The advantage of <code>=&gt;</code> is that it's faster to type than <code>‚Ü¶</code>. And there are cases where <code>‚Ü¶</code> doesn't work, so in general it's safer to just type <code>=&gt;</code> without thinking about it. And I've personally gotten used to always writing <code>=&gt;</code>, probably because of all the metaprogramming I've been doing.</p>\n</blockquote>\n<p>It is faster only if your computer is misconfigured. It certainly isn‚Äôt for me.</p>",
        "id": 535017655,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1755548924
    },
    {
        "content": "<p>I need one more key press to type <code>=&gt;</code> (3 vs 2).</p>",
        "id": 535017786,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1755548985
    },
    {
        "content": "<p>How do you type <code>‚Ü¶</code> in 2 keypresses? <span aria-label=\"eyes\" class=\"emoji emoji-1f440\" role=\"img\" title=\"eyes\">:eyes:</span></p>",
        "id": 535018004,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1755549077
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"873547\">Robin Arnez</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Switch.20to.20.E2.86.A6.20.28.5Cmapsto.29.20globally/near/535009621\">said</a>:</p>\n<blockquote>\n<p>As far as I'm aware, <code>Mathlib.Std.Data.HashMap</code> is completely redundant (we have <code>Std.HashMap.map</code> even with quite a few lemmas about it)</p>\n</blockquote>\n<p>Can we deprecate it? <a href=\"https://github.com/leanprover-community/mathlib4/pull/28611\">#28611</a> <del>(draft)</del></p>",
        "id": 535018642,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1755549379
    },
    {
        "content": "<p>Yes I don't think there's any reason not to</p>",
        "id": 535019541,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1755549832
    },
    {
        "content": "<p>Since there's now majority support I commissioned Claude Sonnet 4 to write the script. After some <a href=\"https://claude.ai/share/5b5c0421-4730-4656-859b-7db3a67670ec\">iterations</a> to clarify the exact requirements, the following code (produced during our <a href=\"https://claude.ai/share/570f157c-56ca-4a5c-b266-45b2d058ae47\">second conversation</a>) works except in a <a href=\"https://github.com/leanprover-community/mathlib4/pull/28622/commits/e8b473e0709cb90c202376c74e2d4ff33e9e7456\">single occasion</a>, where the one-character reduction from <code>=&gt;</code> to <code>‚Ü¶</code> breaks the indentation of a <code>by</code> block:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">find</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">\\</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"s2\">\"./Tactic/*\"</span><span class=\"w\"> </span><span class=\"bp\">\\</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"s2\">\"./Testing/*\"</span><span class=\"w\"> </span><span class=\"bp\">\\</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"s2\">\"./Util/*\"</span><span class=\"w\"> </span><span class=\"bp\">\\</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"s2\">\"./Lean/*\"</span><span class=\"w\"> </span><span class=\"bp\">\\</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"s2\">\"Init.lean\"</span><span class=\"w\"> </span><span class=\"bp\">\\</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"s2\">\"Tactic.lean\"</span><span class=\"w\"> </span><span class=\"bp\">\\</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"n\">exec</span><span class=\"w\"> </span><span class=\"n\">perl</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"mi\">0777</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">pe</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">s</span><span class=\"bp\">/</span><span class=\"o\">(</span><span class=\"bp\">?&lt;!</span><span class=\"o\">[</span><span class=\"n\">a</span><span class=\"bp\">-</span><span class=\"n\">zA</span><span class=\"bp\">-</span><span class=\"n\">Z_</span><span class=\"o\">])(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">?</span><span class=\"o\">:(</span><span class=\"bp\">?!=&gt;|‚Ü¶|\\|</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"o\">)</span><span class=\"bp\">*?</span><span class=\"o\">)</span><span class=\"bp\">=&gt;/\\</span><span class=\"mi\">1</span><span class=\"bp\">‚Ü¶/</span><span class=\"n\">gs'</span><span class=\"w\"> </span><span class=\"o\">{}</span><span class=\"w\"> </span><span class=\"bp\">\\;</span>\n</code></pre></div>\n<p>What it does is basically</p>\n<blockquote>\n<p>for all files in the current directory or recursive subdirectories, for each occurrence of <code>fun</code> (completely lowercase) followed by some characters (including linebreaks), look for the first <code>=&gt;</code> or <code>‚Ü¶</code> or <code>|</code> that appears afterwards, and if it is <code>=&gt;</code>, replace it with <code>‚Ü¶</code>. I also want you to exclude the following directories and files: Tactic/, Testing/, Util/, Lean/, Init.lean, and Tactic.lean</p>\n</blockquote>\n<p>and \"don't match <code>fun</code> that are immediately preceded by a letter (upper or lowercase) or <code>_</code>\"</p>\n<p>and the result is <a href=\"https://github.com/leanprover-community/mathlib4/pull/28622\">#28622</a> which now builds! <span aria-label=\"octopus\" class=\"emoji emoji-1f419\" role=\"img\" title=\"octopus\">:octopus:</span><br>\n(and <a href=\"https://github.com/leanprover-community/mathlib4/pull/28626\">#28626</a> for Archive &amp; Counterexamples)</p>",
        "id": 535040379,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1755564825
    },
    {
        "content": "<p>I don't think that poll above counts as majority support. I think that counts as general disagreement. :-)</p>",
        "id": 535043508,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1755568069
    },
    {
        "content": "<p>Note that 4-5 people voted for two options. Is this \"accept all options you're fine with\" or \"pick only your preferred one\"?</p>",
        "id": 535066904,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1755587242
    },
    {
        "content": "<p>I voted for =&gt; and \\mapsto because I‚Äôm fine with either but not both</p>",
        "id": 535086586,
        "sender_full_name": "David Ang",
        "timestamp": 1755594919
    },
    {
        "content": "<p>I voted for \\mapsto and both because I prefer the first but I don't feel like \"prohibiting\" anything.</p>",
        "id": 535089298,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1755595928
    },
    {
        "content": "<p>So at the moment there are 48 votes from 41 people and 24 of them are supportive. I guess that counts as majority support? I've now also clarified the scope of \"everywhere\" in the OP and people might want to recast their votes. :-)</p>",
        "id": 535096074,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1755598315
    },
    {
        "content": "<p>If you are used to writing <code>=&gt;</code> the above script should do a decent job converting your code to \"mathlib style\" :-)</p>",
        "id": 535096462,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1755598479
    },
    {
        "content": "<p>We don't exactly make changes based on majority rule. The poll above suggests there's still a lot of division, and many still support allowing both. So I don't see a strong reason to disallow one option or the other at the moment.</p>",
        "id": 535229503,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755657623
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"548935\">Thomas Murrills</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Switch.20to.20.E2.86.A6.20.28.5Cmapsto.29.20globally/near/535018004\">said</a>:</p>\n<blockquote>\n<p>How do you type <code>‚Ü¶</code> in 2 keypresses? <span aria-label=\"eyes\" class=\"emoji emoji-1f440\" role=\"img\" title=\"eyes\">:eyes:</span></p>\n</blockquote>\n<p>I recommend that you start using Plover. It's underrated and is very useful when writing Lean code.</p>",
        "id": 535295337,
        "sender_full_name": "(deleted)",
        "timestamp": 1755690257
    },
    {
        "content": "<p>I recommend configuring the compose key (or WinCompose on Windows).</p>",
        "id": 535297376,
        "sender_full_name": "suhr",
        "timestamp": 1755690994
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"548935\">Thomas Murrills</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Switch.20to.20.E2.86.A6.20.28.5Cmapsto.29.20globally/near/535018004\">said</a>:</p>\n<blockquote>\n<p>How do you type <code>‚Ü¶</code> in 2 keypresses? <span aria-label=\"eyes\" class=\"emoji emoji-1f440\" role=\"img\" title=\"eyes\">:eyes:</span></p>\n</blockquote>\n<p>I‚Äôm sorry I dropped the conversation, I‚Äôm travelling (I‚Äôm currently in China). I use <a href=\"https://github.com/OneDeadKey/kalamine\">https://github.com/OneDeadKey/kalamine</a> to tweak my keyboard layout. My base layout is <a href=\"https://qwerty-lafayette.org/\">QwertyLafayette</a> which has plenty of room on its typography layer (the green letters on the main picture, you access them after pressing the red star key which a special deadkey). I put ‚Ü¶ on the R key. So I tap what would be the ; key on a US qwerty and then I tap r. Of course I have many more useful Lean symbols configured using Compose but they require some more keypresses (but not more than what you could need using the VSCode or Neovim Lean abbreviations, and the compose key works in every software).</p>",
        "id": 535311221,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1755695561
    },
    {
        "content": "<p>In any case, there are many ways to type this ‚Ü¶, including using the editor extensions that you need anyway. So beginners can type it with not more work than the other unicode symbols we use all the time in Lean. And serious users who want to type it more efficiently have lots of options.</p>",
        "id": 535311711,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1755695726
    },
    {
        "content": "<p>Of course Patrick's answer is the master way to go. A more humble tweak is to add the following lines</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"nt\">\"lean4.input.customTranslations\"</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"p\">{</span>\n<span class=\"w\">         </span><span class=\"nt\">\"ma\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"‚Ü¶\"</span><span class=\"p\">},</span>\n</code></pre></div>\n<p>to your .json file, that will add the shortcut <code>ma</code> for the symbol (but this makes it <em>three</em> keystrokes, including the \\). You can also use \"m\" but this will override the default value and will oblige you to type <code>\\mu</code> to obtain Œº .</p>",
        "id": 535316799,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1755697267
    },
    {
        "content": "<p>If we strongly believe that's useful we should add it to the defaults rather than telling users to add it</p>",
        "id": 535318928,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755697917
    },
    {
        "content": "<p><code>\\ma</code> currently turns into <code>‚ôÇ</code>...</p>",
        "id": 535319694,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1755698157
    },
    {
        "content": "<p>mars?</p>",
        "id": 535321342,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755698569
    },
    {
        "content": "<p>If <code>\\m</code> and <code>\\ma</code> would both give <code>‚Ü¶</code>, that would be great!</p>\n<p>(And I don't really like the idea of telling people to use some special keyboard software, or even to add something to some magic json file, because in practice the vast majority of users simply isn't going to do this)</p>",
        "id": 535321794,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1755698691
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"300245\">Filippo A. E. Nuccio</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Switch.20to.20.E2.86.A6.20.28.5Cmapsto.29.20globally/near/535316799\">said</a>:</p>\n<blockquote>\n<p>You can also use \"m\" but this will override the default value and will oblige you to type <code>\\mu</code> to obtain Œº .</p>\n</blockquote>\n<p>By the way, on a MacBook you can use Option + M to type ¬µ</p>",
        "id": 535363161,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1755711972
    },
    {
        "content": "<p>Yes, we definitely need to fix <code>\\ma</code> becoming mars instead of ‚Ü¶, independently of any other discussion about this symbol.</p>",
        "id": 535417797,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1755743518
    },
    {
        "content": "<p>I guess the issue is that mars is shorter than mapsto, so ma is seen as closer to mars than mapsto. I‚Äôm sure <span class=\"user-mention\" data-user-id=\"221921\">@Marc Huisinga</span> will save us anyway.</p>",
        "id": 535417867,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1755743570
    },
    {
        "content": "<p>Happy to accept a PR that changes these abbreviations to something more fitting for Mathlib.</p>",
        "id": 535446926,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1755762051
    },
    {
        "content": "<p>Here's the PR: <a href=\"https://github.com/leanprover/vscode-lean4/pull/667\">https://github.com/leanprover/vscode-lean4/pull/667</a></p>",
        "id": 541798419,
        "sender_full_name": "Vasilii Nesterov",
        "timestamp": 1758972666
    }
]