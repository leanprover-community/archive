[
    {
        "content": "<p>This was a fact I wanted recently for something else, and I would like to make (as a very very short) PR to Mathlib, but I don't have a good idea of where to put it.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- The factorial function is primitive recursive. -/</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Primrec</span><span class=\"bp\">.</span><span class=\"n\">factorial</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Primrec</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">factorial</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">list_foldl</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">σ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">p</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">list_range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">prod_range_add_one_eq_factorial</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">foldl_map</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">prod_eq_foldl</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">prod_toFinset</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">nodup_range</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">toFinset_range</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">comp₂</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">right</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">nat_mul</span><span class=\"bp\">.</span><span class=\"n\">comp₂</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">succ</span><span class=\"bp\">.</span><span class=\"n\">comp₂</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>There's no file that imports both <code>Nat.factorial</code> and <code>Primrec</code>, as far as I can tell. It would feel silly for the file on factorial to import Primrec to have this fact, as would the other way. It would feel even sillier to add a new file just for this one fact.</p>\n<p>I thought I'd ask a maintainer which of those three silly things would be best. (Or maybe something else)</p>",
        "id": 567190242,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1767978428
    },
    {
        "content": "<p>I think putting it in primrec is reasonable (or rather, least unreasonable)</p>",
        "id": 567192793,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1767979224
    },
    {
        "content": "<p>A new file would be fine too</p>",
        "id": 567235445,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1767982247
    },
    {
        "content": "<p>The primrec file is already huge. Let's maybe try not to add to it even further.</p>",
        "id": 567311215,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1768042908
    },
    {
        "content": "<p>In fact it's so huge, it triggers the file size linter. We should split it regardless of whether we want to add to it.</p>",
        "id": 567362809,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1768102196
    },
    {
        "content": "<p>Here is a candidate PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/33835\">#33835</a></p>",
        "id": 567364074,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1768104253
    },
    {
        "content": "<p>I added this fact and several other nat functions in this PR: <a href=\"https://github.com/leanprover-community/mathlib4/pull/33864\">#33864</a></p>",
        "id": 567441639,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1768193586
    },
    {
        "content": "<p>oh wow, I didn't realize it was literally the largest file in Mathlib right now. Ha</p>",
        "id": 567441779,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1768193655
    },
    {
        "content": "<p>My PR was merged, so you might have to fix a conflict, sorry!</p>",
        "id": 567489806,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1768213452
    },
    {
        "content": "<p>should be okay now. (And thanks, Bolton!)</p>",
        "id": 567650666,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1768255101
    }
]