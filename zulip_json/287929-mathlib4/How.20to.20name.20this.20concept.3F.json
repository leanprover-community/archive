[
    {
        "content": "<p>So I've made this PR (<a href=\"https://github.com/leanprover-community/mathlib4/pull/26308\">#26308</a>) and reviewer suggested that I ask here for the name that's the best for the concept. I have chosen <code>normalized</code>, but maybe the community has better options etc.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">RCLike</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"c\">/-</span><span class=\"cm\">!</span>\n<span class=\"cm\"># Normalized vector</span>\n<span class=\"cm\">Function that calculates unit length vector from a vector</span>\n<span class=\"cm\">(if the given vector is nonzero vector) or returns zero vector</span>\n<span class=\"cm\">(if the given vector is zero vector).</span>\n<span class=\"cm\">-/</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span>\n\n<span class=\"sd\">/-- The normalized vector from a given vector. `normalized 0 = 0`, otherwise it is</span>\n<span class=\"sd\">the corresponding unit length vector. -/</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">normalized</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"n\">x</span><span class=\"bp\">‖⁻¹</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>\n<p>Thank you <span aria-label=\"heart\" class=\"emoji emoji-2764\" role=\"img\" title=\"heart\">:heart:</span></p>",
        "id": 531704537,
        "sender_full_name": "Ilmārs Cīrulis",
        "timestamp": 1753825567
    },
    {
        "content": "<p><code>normalize</code> is what some other languages use.</p>\n<p>Lean seems to use imperative instead of past tense for operations (e.g. <code>add</code> instead of <code>added</code> or <code>addedTo</code>), or sometimes a noun (<code>closure</code>).</p>",
        "id": 531706310,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1753826378
    },
    {
        "content": "<p>One of the few libraries I found that used <code>normalized</code> is Eigen (for C++), where <code>v.normalize()</code> is for in-place modification and <code>v.normalized()</code> returns a new normalized vector.</p>",
        "id": 531706854,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1753826633
    },
    {
        "content": "<p>Yes, now that you have said that, <code>normalize</code> seems to be better. <span aria-label=\"thumbs up\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"thumbs up\">:thumbs_up:</span></p>",
        "id": 531707566,
        "sender_full_name": "Ilmārs Cīrulis",
        "timestamp": 1753826994
    },
    {
        "content": "<p>I changed the name to <code>normalize</code> for now, but now CI fails with this error:<br>\n<a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/16609624307/job/46989795171?pr=26308#step:33:23\">https://github.com/leanprover-community/mathlib4/actions/runs/16609624307/job/46989795171?pr=26308#step:33:23</a></p>\n<blockquote>\n<p>Error: error: Mathlib.lean:1:0: import Mathlib.Analysis.NormedSpace.Normalize failed, environment already contains 'normalize' from Mathlib.Algebra.GCDMonoid.Basic</p>\n</blockquote>\n<p>What does that exactly mean? And what's the best way to fix it?</p>",
        "id": 531716946,
        "sender_full_name": "Ilmārs Cīrulis",
        "timestamp": 1753832169
    },
    {
        "content": "<p>it means you have a name conflict with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=normalize#doc\">docs#normalize</a></p>",
        "id": 531717042,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753832223
    },
    {
        "content": "<p>could we reuse that instead?</p>",
        "id": 531717149,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753832299
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"658873\">@Ilmārs Cīrulis</span>, I'm very sure we already have this somewhere, but I can't find it. Most relevant declaration I could find is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=norm_smul_inv_norm#doc\">docs#norm_smul_inv_norm</a></p>",
        "id": 531763405,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1753858784
    },
    {
        "content": "<p>Really? I was fairly certain we <em>didn't</em> have it.</p>",
        "id": 531787273,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1753865927
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/287929-mathlib4/topic/How.20to.20name.20this.20concept.3F/near/531717149\">said</a>:</p>\n<blockquote>\n<p>could we reuse that instead?</p>\n</blockquote>\n<p>That looks too complex for me to understand, at least for now. <span aria-label=\"sweat\" class=\"emoji emoji-1f613\" role=\"img\" title=\"sweat\">:sweat:</span></p>",
        "id": 531901485,
        "sender_full_name": "Ilmārs Cīrulis",
        "timestamp": 1753899100
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> no, we can't use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=normalize#doc\">docs#normalize</a> because you would need a monoid structure on your vector space.</p>",
        "id": 532123964,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1753980729
    },
    {
        "content": "<p>Maybe you can generalize <code>normalize</code>?</p>",
        "id": 532126463,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753981503
    },
    {
        "content": "<p>Maybe there's some notion of a normalization module that could be compatible (using V as a module over the semiring R&gt;=0), but it seems to me that these two concepts just happen to use the same word.</p>\n<p>Generalizing it to a <code>normalize</code> typeclass doesn't seem good either. For example, the complex numbers C are a module over both R and C. Normalizing in the R vector space sense means to scale the complex number to the unit circle using a positive real. However, C as a NormalizationMonoid (as a module over itself) normalizes everything to 1 (and it must do so, since everything except for 0 is a unit).</p>\n<p>Is there some namespace solution here? I doubt that <code>normalize</code> for normalization monoids should be the only <code>normalize</code> in all of mathlib.</p>",
        "id": 532155369,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1753991193
    },
    {
        "content": "<p>So, no solution for this problem? <span aria-label=\"melting face\" class=\"emoji emoji-1fae0\" role=\"img\" title=\"melting face\">:melting_face:</span></p>\n<p>Ok, will try to think of some other name.</p>",
        "id": 534779992,
        "sender_full_name": "Ilmārs Cīrulis",
        "timestamp": 1755371692
    },
    {
        "content": "<p><code>NormedSpace.normalize</code> perhaps?</p>",
        "id": 534783915,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755377470
    },
    {
        "content": "<p>Renamed it such way, but this change failed in <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/17023561643/job/48256998571?pr=26308#logs\">Post-Build Step (fork)</a> CI step. At least <code>Build</code> and <code>Lint Style</code> was success, that's more than previously.</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/17023561643/job/48256998571?pr=26308#step:6:4057\">Error: Process completed with exit code 3.</a> <span aria-label=\"looking\" class=\"emoji emoji-1f440\" role=\"img\" title=\"looking\">:looking:</span></p>",
        "id": 534837474,
        "sender_full_name": "Ilmārs Cīrulis",
        "timestamp": 1755453233
    },
    {
        "content": "<p>That should hopefully go away if you merge the master branch into your PR branch.</p>",
        "id": 534838757,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1755454692
    },
    {
        "content": "<p>Okay, I tried to do that, now let's wait and see if that helps. Thank you!</p>",
        "id": 534845933,
        "sender_full_name": "Ilmārs Cīrulis",
        "timestamp": 1755463587
    },
    {
        "content": "<p><span aria-label=\"partying face\" class=\"emoji emoji-1f973\" role=\"img\" title=\"partying face\">:partying_face:</span>  It worked.</p>",
        "id": 534846571,
        "sender_full_name": "Ilmārs Cīrulis",
        "timestamp": 1755464366
    }
]