[
    {
        "content": "<p>I've always been a bit puzzled about what to make of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Ordinal.pred#doc\">docs#Ordinal.pred</a>. To me it seems like a definition that can obviously be generalized, except that there's no obvious target for generalization, and maybe we don't even need it anyways?</p>",
        "id": 499092172,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1739305403
    },
    {
        "content": "<p>To get some obvious ideas out of the way:</p>\n<ul>\n<li>This can't be turned into a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PredOrder#doc\">docs#PredOrder</a> instance, since it doesn't satisfy <code>min_of_le_pred</code> (<code>pred ω = ω</code> but <code>¬ IsMin ω</code>)</li>\n<li>In general <code>pred x ≠ x - 1</code> (e.g. <code>pred (ω + 1) = ω</code> but <code>(ω + 1) - 1 = ω + 1</code> because ordinal subtraction is right subtraction)</li>\n</ul>",
        "id": 499092786,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1739305667
    },
    {
        "content": "<p><code>Ordinal.pred</code> satisfies a pretty nice property: it forms a Galois connection with <code>Order.succ</code>. That is, <code>pred a ≤ b ↔ a ≤ succ b</code>.</p>",
        "id": 499092966,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1739305745
    },
    {
        "content": "<p>And in fact, this property generalizes to the analogous function defined on any linear order without a maximum:</p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>Proof</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib.Order.SuccPred.Limit</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Order</span>\n\n<span class=\"kd\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearOrder</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SuccOrder</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kd\">noncomputable</span><span class=\"w\"> </span><span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">pred'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">isSuccPrelimitRecOn</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kd\">theorem</span><span class=\"w\"> </span><span class=\"n\">pred'_succ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NoMaxOrder</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">pred'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">isSuccPrelimitRecOn_succ</span><span class=\"w\"> </span><span class=\"bp\">..</span>\n\n<span class=\"kd\">theorem</span><span class=\"w\"> </span><span class=\"n\">pred'_of_isSuccPrelimit</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsSuccPrelimit</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">pred'</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">isSuccPrelimitRecOn_of_isSuccPrelimit</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"n\">_</span>\n\n<span class=\"kd\">theorem</span><span class=\"w\"> </span><span class=\"n\">pred'_succ_gc</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NoMaxOrder</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">GaloisConnection</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">pred'</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span>\n<span class=\"w\">  </span><span class=\"n\">obtain</span><span class=\"w\"> </span><span class=\"o\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">⟩</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Order.mem_range_succ_or_isSuccPrelimit</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">pred'_of_isSuccPrelimit</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx.le_succ_iff</span><span class=\"o\">]</span>\n</code></pre></div>\n</div></div>",
        "id": 499094665,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1739306515
    },
    {
        "content": "<p>So this shows (in my opinion) that there's at least some mathematical value in this definition. Perhaps that warrants giving it a proper name and some API?</p>",
        "id": 499094923,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1739306634
    },
    {
        "content": "<p>On the other hand, <code>Ordinal.pred</code> is almost completely unused. It only ever appears in the definition of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Ordinal.log#doc\">docs#Ordinal.log</a>, where it could easily be inlined or removed.</p>",
        "id": 499095342,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1739306795
    },
    {
        "content": "<p>So I'm stuck on what should be done.</p>",
        "id": 499095396,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1739306819
    },
    {
        "content": "<p>(if we do want to keep <code>Ordinal.pred</code>, I opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/21751\">#21751</a> cleaning up its API)</p>",
        "id": 499106030,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1739311284
    },
    {
        "content": "<p>I would not eagerly generalize a rarely used definition, just for the sake of generalization, if you have no application for it (and unifying with <code>Nat.pred</code> is not a good enough reason, since that will be defined in Lean Core anyway). If there are compelling other places we already want it, we could generalize it.</p>",
        "id": 499211321,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1739360508
    },
    {
        "content": "<p>I have to agree. I guess the thing that really irks me is that there's no reason for <code>pred</code> not to be defined for other structures like cardinals. But if you actually follow that line of thought there's little reason for it to be defined on ordinals either.</p>",
        "id": 499315704,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1739389625
    }
]