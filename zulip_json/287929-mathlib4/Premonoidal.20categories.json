[
    {
        "content": "<p>Hello everyone!</p>\n<p>I'm formalizing some programming language theory in Lean as a continuation of my paper: <a href=\"https://arxiv.org/abs/2411.09347\">arXiv:2411.09347</a>. In my work, I make extensive use of <strong>(symmetric) premonoidal categories</strong>, which generalize monoidal categories by removing the sliding condition.</p>\n<p>Unfortunately, this means I can't use Mathlib's <code>MonoidalCategory</code> class directly, so I had to implement a workaround: a somewhat unusual variant in <a href=\"https://github.com/imbrem/discretion\">discretion</a>, with typical usage in <a href=\"https://github.com/imbrem/refined-ssa\">refined-ssa</a>. This implementation is really just a hack to work around Mathlibâ€™s current design, so Iâ€™m not proposing it for merging. However, Iâ€™d like to discuss how we might improve Mathlibâ€™s category hierarchy to better support premonoidal categories.</p>\n<p>Currently, we have:</p>\n<ul>\n<li><code>MonoidalCategoryStruct</code>: Defines tensor products and associators/unitors.</li>\n<li><code>MonoidalCategory</code>: Ensures that <code>MonoidalCategoryStruct</code> forms a valid monoidal category.</li>\n</ul>\n<p>I propose adding two intermediate structures:</p>\n<ol>\n<li><strong><code>BinoidalCategory</code></strong>: Ensures that left/right whiskering is functorial and defines <code>tensorHom</code> as their composition.</li>\n<li><strong><code>PremonoidalCategory</code></strong>: Like <code>MonoidalCategory</code>, but omitting <code>tensorHom</code> composition and requiring associators/unitors to be <strong>central</strong>.</li>\n</ol>\n<p><code>MonoidalCategory</code> would then remain as before, with the extra structure from <code>PremonoidalCategory</code> handled via default members.</p>\n<p>Some of the main things we can do with this are:</p>\n<ul>\n<li><strong>Monoidal coherence extends to premonoidal categories</strong>, which Iâ€™ve already proved in <code>discretion</code>.</li>\n<li><strong><code>BraidedCategory</code> can depend on <code>PremonoidalCategory</code></strong> instead of <code>MonoidalCategory</code>, and arguably should just depend on <code>MonoidalCategoryStruct</code>.</li>\n<li><strong>The Kleisli category of a monoidal category is naturally premonoidal</strong>, giving a broad class of models for free.</li>\n</ul>\n<p>If this is too much, we could drop <code>BinoidalCategory</code> and introduce just <code>PremonoidalCategory</code>, but I find <code>BinoidalCategory</code> useful and aligned with the literature.</p>\n<p>Would you be open to a pull request introducing these changes? It seems like a moderate refactor, so Iâ€™d likely need guidance from maintainers.</p>\n<p>Thanks for your time, and apologies for the long post!</p>\n<p>Jad</p>\n<p>EDIT: removed distributive categories from the title as I left them out of this proposal since they complicate things</p>",
        "id": 495386468,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737585569
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"438192\">@Yuma Mizuno</span> <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span></p>",
        "id": 495425308,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1737608967
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"461231\">@Jad Ghalayini</span>  I was not familiar with those concepts, but I think it's good to have a premonoidal category in mathlib.</p>\n<p>While I cannot accurately estimate the required work, this may not be too much as many definitions and theorems about monoidal categories have already been written in terms of whiskering. You may find it helpful to see the formalization of bicategories (<a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Bicategory#doc\">docs#CategoryTheory.Bicategory</a>) where the horizontal composition (analogous to tensorHom) is not yet implemented.</p>",
        "id": 495472376,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1737628964
    },
    {
        "content": "<p>I am not completely sure I understand the exact axioms. Currently, the lemmas that are related to <code>tensor_comp</code> are <code>whiskerLeft_comp</code>, <code>comp_whiskerRight</code> and <code>whisker_exchange</code>. Is it <code>whisker_exchange</code> which does not hold in your context? <br>\nIn terms of design, my only concern is that when defining a new monoidal category structure, most users should not have to know about the intermediate classes. If <code>MonoidalCategory</code> extends <code>BinoidalCategory</code>, and <code>BinoidalCategory</code> extends <code>MonoidalCategoryStruct</code>, I think it would be ok, but I am not sure that <code>MonoidalCategory</code> should extend <code>PremonoidalCategory</code>.<br>\n(In <a href=\"https://github.com/leanprover-community/mathlib4/pull/12728\">#12728</a>, with <span class=\"user-mention\" data-user-id=\"519559\">@Dagur Asgeirsson</span> , we constructed the monoidal category structure on a localized category. In order to show the pentagon (and triangle) axioms, we need to use some lemmas most of which are consequences of the axioms from <code>BinoidalCategory</code>. If this class was available, the proof would be slightly more direct .)</p>",
        "id": 495497928,
        "sender_full_name": "JoÃ«l Riou",
        "timestamp": 1737638800
    },
    {
        "content": "<p>I already have an idea (hopefully) how to implement this, since I've implemented it along with coherence in <code>discretion</code>. So I should just get along with the PR, then? I'm thinking of doing exactly what <span class=\"user-mention\" data-user-id=\"459699\">@JoÃ«l Riou</span> said and making the hierarchy<br>\n<code>MonoidalCategory</code> extends <code>PremonoidalCategory</code> extends <code>BinoidalCategory</code> extends <code>MonoidalCategoryStruct</code>;<br>\nthis is slightly ugly since a binoidal category in the literature does not require associator/unitor isomorphisms to exist, so future refactoring might be to shunt those higher in the hierarchy, but that's just perfectionism imo</p>",
        "id": 495513761,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737642970
    },
    {
        "content": "<p>Also, that's exactly right, it's <code>whisker_exchange</code> which is invalid, which follows from <code>tensor_comp</code>. The idea is to add <code>whiskerLeft_comp</code> and <code>whiskerRight_comp</code> as members and remove <code>tensor_comp</code>, this follows from the definition of a premonoidal category where âŠ— is individually a functor in the left and right elements but is _not_ (necessarily) a bifunctor. Bifunctoriality is then recovered by adding <code>tensor_comp</code> or <code>whisker_exchange</code>, which in this setting are equivalent; doing the former is probably easier since it should minimize changes to existing <code>MonoidalCategory</code> instances (since <code>whiskerLeft_comp</code> and <code>whiskerLeft_comp</code> can easily be derived from <code>tensor_comp</code>)</p>",
        "id": 495514421,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737643128
    },
    {
        "content": "<p>I think you may proceed with the PR. (I only have a doubt about whether <code>MonoidalCategory</code> should extend <code>PremonoidalCagegory</code>: if you find a way to make things so that no changes are required in downstream definitions, this would be fine though.)</p>",
        "id": 495519141,
        "sender_full_name": "JoÃ«l Riou",
        "timestamp": 1737644390
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"461231\">@Jad Ghalayini</span> If you are interested in generalizing the coherence tactic to <code>PremonoidalCategory</code> setting but stack at some points, feel free to ask me. I found your codes for <code>Central</code> instances around <a href=\"https://github.com/imbrem/discretion/blob/a90ccae04fe1bae94ab38005f71bc1a217526a18/Discretion/Premonoidal/Category.lean#L447\">https://github.com/imbrem/discretion/blob/a90ccae04fe1bae94ab38005f71bc1a217526a18/Discretion/Premonoidal/Category.lean#L447</a> may be enough to implement the tactic, but you will need to write several lines of codes to handle these instances in meta setting.</p>",
        "id": 495527580,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1737646551
    },
    {
        "content": "<p>Hello! I'm working on the PR and am mildly stuck: so I'm trying to get <code>whiskerLeft_comp</code> and <code>comp_whiskerRight</code> to be filled in by default for <code>MonoidalCategory</code> instances as follows:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">MonoidalCategory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ğ’</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">PremonoidalCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/--</span>\n<span class=\"sd\">  Composition of tensor products is tensor product of compositions:</span>\n<span class=\"sd\">  `(fâ‚ âŠ— gâ‚) âˆ˜ (fâ‚‚ âŠ— gâ‚‚) = (fâ‚ âˆ˜ fâ‚‚) âŠ— (gâ‚ âŠ— gâ‚‚)`</span>\n<span class=\"sd\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">tensor_comp</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Zâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Zâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gâ‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Zâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Zâ‚‚</span><span class=\"o\">),</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">gâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">gâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">gâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"n\">whiskerLeft_comp</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">whiskerLeft_comp_ofTensorHom</span><span class=\"w\"> </span><span class=\"n\">tensorHom_def</span><span class=\"w\"> </span><span class=\"n\">id_whiskerRight</span><span class=\"w\"> </span><span class=\"n\">tensor_comp</span>\n<span class=\"w\">  </span><span class=\"n\">comp_whiskerRight</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">comp_whiskerRight_ofTensorHom</span><span class=\"w\"> </span><span class=\"n\">tensorHom_def</span><span class=\"w\"> </span><span class=\"n\">whiskerLeft_id</span><span class=\"w\"> </span><span class=\"n\">tensor_comp</span>\n</code></pre></div>\n<p>Unfortunately... this doesn't work. It's a very minor change to fix all uses by just switching to an alternative constructor for <code>MonoidalCategory</code>, but... there _must_ be a better way? How can we synthesize this nicely?</p>",
        "id": 495587053,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737667043
    },
    {
        "content": "<p>I'm a bit confused. <code>PremonoidalCategory</code> doesn't have <code>tensorHom</code>, right?</p>",
        "id": 495587898,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1737667404
    },
    {
        "content": "<p>To make my life a (lot) easier I left it in</p>",
        "id": 495587928,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737667426
    },
    {
        "content": "<p>It makes sense for it to be defined as $f \\otimes A ; B \\otimes g$</p>",
        "id": 495588012,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737667452
    },
    {
        "content": "<p>And its useful because for central morphisms it behaves just like it does for monoidal categories</p>",
        "id": 495588039,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737667468
    },
    {
        "content": "<p>(indeed it is standard notation to write central morphisms with tensors and everything else with ltimes/rtimes)</p>",
        "id": 495588071,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737667486
    },
    {
        "content": "<p>Let me just show you what I've got:</p>",
        "id": 495588090,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737667498
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">BinoidalCategory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ğ’</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">MonoidalCategoryStruct</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"c1\">-- NOTE: this is easily derivable from the others...</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- Tensor product of identity maps is the identity: `(ğŸ™ Xâ‚ âŠ— ğŸ™ Xâ‚‚) = ğŸ™ (Xâ‚ âŠ— Xâ‚‚)` -/</span>\n<span class=\"w\">  </span><span class=\"n\">tensor_id</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"n\">tensorHom_def</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span><span class=\"cm\"> Left whiskering of the identity is the identity: `X â— ğŸ™ Y = ğŸ™ (X âŠ— Y)` -/</span>\n<span class=\"w\">  </span><span class=\"n\">whiskerLeft_id</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span><span class=\"cm\"> Right whiskering of the identity is the identity `ğŸ™ X â–· Y = ğŸ™ (X âŠ— Y)` -/</span>\n<span class=\"w\">  </span><span class=\"n\">id_whiskerRight</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span><span class=\"cm\"> Left whiskering respects composition -/</span>\n<span class=\"w\">  </span><span class=\"n\">whiskerLeft_comp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span><span class=\"cm\"> Right whiskering respects composition -/</span>\n<span class=\"w\">  </span><span class=\"n\">comp_whiskerRight</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">PremonoidalCategory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ğ’</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">BinoidalCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- Naturality of the associator isomorphism: `(fâ‚ âŠ— fâ‚‚) âŠ— fâ‚ƒ â‰ƒ fâ‚ âŠ— (fâ‚‚ âŠ— fâ‚ƒ)` -/</span>\n<span class=\"w\">  </span><span class=\"n\">associator_naturality</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚ƒ</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚ƒ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚ƒ</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"o\">),</span>\n<span class=\"w\">      </span><span class=\"o\">((</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚ƒ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚ƒ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚ƒ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"sd\">/--</span>\n<span class=\"sd\">  Naturality of the left unitor, commutativity of `ğŸ™_ C âŠ— X âŸ¶ ğŸ™_ C âŠ— Y âŸ¶ Y` and `ğŸ™_ C âŠ— X âŸ¶ X âŸ¶ Y`</span>\n<span class=\"sd\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">leftUnitor_naturality</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»_</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"sd\">/--</span>\n<span class=\"sd\">  Naturality of the right unitor: commutativity of `X âŠ— ğŸ™_ C âŸ¶ Y âŠ— ğŸ™_ C âŸ¶ Y` and `X âŠ— ğŸ™_ C âŸ¶ X âŸ¶ Y`</span>\n<span class=\"sd\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">rightUnitor_naturality</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ï_</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ï_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"sd\">/--</span>\n<span class=\"sd\">  The pentagon identity relating the isomorphism between `X âŠ— (Y âŠ— (Z âŠ— W))` and `((X âŠ— Y) âŠ— Z) âŠ— W`</span>\n<span class=\"sd\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">pentagon</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"sd\">/--</span>\n<span class=\"sd\">  The identity relating the isomorphisms between `X âŠ— (ğŸ™_ C âŠ— Y)`, `(X âŠ— ğŸ™_ C) âŠ— Y` and `X âŠ— Y`</span>\n<span class=\"sd\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">triangle</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ğŸ™</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»_</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ï_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"bp\">...</span>\n</code></pre></div>",
        "id": 495588160,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737667528
    },
    {
        "content": "<p>So we add <code>whiskerLeft_comp and comp_whiskerRight</code> and remove <code>tensor_comp</code>, which implies both of those</p>",
        "id": 495588201,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737667549
    },
    {
        "content": "<p>What we're basically saying is that - âŠ— A and A âŠ— - are functors, but - âŠ— - is not _necessarily_ a functor</p>",
        "id": 495588319,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737667591
    },
    {
        "content": "<p>Anyways the issue is it is not filling in the default fields <code>whiskerLeft_comp</code> and <code>comp_whiskerRight</code> so I need to add them in manually in about 5 places; it's not too big a change but it's moderately ugly</p>",
        "id": 495588427,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737667644
    },
    {
        "content": "<p>Simplest possible method is just to do that and then everything works</p>",
        "id": 495588448,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737667656
    },
    {
        "content": "<p>Making <code>coherence</code> work shouldn't be _too_ hard after that</p>",
        "id": 495588468,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737667671
    },
    {
        "content": "<p>Since all you need to do is swap out everything <code>Monoidal</code> for <code>Premonoidal</code></p>",
        "id": 495588555,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737667700
    },
    {
        "content": "<p>I've also considered removing <code>tensor_id</code> since its easily derivable from the other members of <code>BinoidalCategory</code></p>",
        "id": 495588943,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737667855
    },
    {
        "content": "<p>I see. What I thought was not to include <code>tensorHom</code> in the definition, as in the bicategory definition (<a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Bicategory#doc\">docs#CategoryTheory.Bicategory</a>). You can state <code>tensor_comp</code> as the theorem instead of an axiom. This allows you to extract <code>whisker_exchange</code> relation.</p>",
        "id": 495589492,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1737668083
    },
    {
        "content": "<p>One question. Do the f_{1,2,3} in the naturality of associators have to be central?</p>",
        "id": 495589626,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1737668134
    },
    {
        "content": "<p>I think this complicates things a lot; also it now means we need to do even more work fixing usages of MonoidalCategory, whereas now we just need to prove the whiskering lemmas</p>",
        "id": 495589635,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668137
    },
    {
        "content": "<p>No, but I just realized that I forgot to make the associators themselves central, d'uh...</p>",
        "id": 495589741,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668168
    },
    {
        "content": "<p>Which _also_ follows from tensor_comp, which makes _everything_ central</p>",
        "id": 495589768,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668180
    },
    {
        "content": "<p>Now that's a bit more irritating</p>",
        "id": 495589786,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668189
    },
    {
        "content": "<p>My current solution is to do something like <a href=\"http://LawfulMonad.mk\">LawfulMonad.mk</a>', in which I have an alternative constructor for MonoidalCategory which acts exactly like the old constructor and fills in all the defaults</p>",
        "id": 495589843,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668221
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"461231\">Jad Ghalayini</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Premonoidal.20categories/near/495589741\">said</a>:</p>\n<blockquote>\n<p>No, but I just realized that I forgot to make the associators themselves central, d'uh...</p>\n</blockquote>\n<p>Note I did this in <code>discretion</code> just forgot to port it over</p>",
        "id": 495589915,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668258
    },
    {
        "content": "<p>What I wish is that there was a cleaner way to define default elements in child classes for parents</p>",
        "id": 495590081,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668329
    },
    {
        "content": "<p>Do you know you can redeclare parent fields when defining a child class? This gives you the opportunity to set a default value</p>",
        "id": 495590335,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1737668438
    },
    {
        "content": "<p>I did redeclare those fields, and it's not working!</p>",
        "id": 495590359,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668453
    },
    {
        "content": "<p>See, I wrote this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">MonoidalCategory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ğ’</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">PremonoidalCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/--</span>\n<span class=\"sd\">  Composition of tensor products is tensor product of compositions:</span>\n<span class=\"sd\">  `(fâ‚ âŠ— gâ‚) âˆ˜ (fâ‚‚ âŠ— gâ‚‚) = (fâ‚ âˆ˜ fâ‚‚) âŠ— (gâ‚ âŠ— gâ‚‚)`</span>\n<span class=\"sd\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">tensor_comp</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Zâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Zâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gâ‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Zâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Zâ‚‚</span><span class=\"o\">),</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">gâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">gâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">gâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"n\">whiskerLeft_comp</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">whiskerLeft_comp_ofTensorHom</span><span class=\"w\"> </span><span class=\"n\">tensorHom_def</span><span class=\"w\"> </span><span class=\"n\">id_whiskerRight</span><span class=\"w\"> </span><span class=\"n\">tensor_comp</span>\n<span class=\"w\">  </span><span class=\"n\">comp_whiskerRight</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">comp_whiskerRight_ofTensorHom</span><span class=\"w\"> </span><span class=\"n\">tensorHom_def</span><span class=\"w\"> </span><span class=\"n\">whiskerLeft_id</span><span class=\"w\"> </span><span class=\"n\">tensor_comp</span>\n</code></pre></div>",
        "id": 495590408,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668475
    },
    {
        "content": "<p>whiskerLeft_comp and comp_whiskerRight being child fields</p>",
        "id": 495590420,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668486
    },
    {
        "content": "<p>But for example this code for the Drinfield center fails to synthesize (runs out of heartbeats) without the sorries</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonoidalCategory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Center</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">tensorObj</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">tensorObj</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span>\n<span class=\"w\">  </span><span class=\"n\">tensorHom</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">tensorHom</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span>\n<span class=\"w\">  </span><span class=\"n\">tensorHom_def</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">intros</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">ext</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">tensorHom_def</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">whiskerLeft</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">whiskerLeft</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">f</span>\n<span class=\"w\">  </span><span class=\"n\">whiskerRight</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">whiskerRight</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">Y</span>\n<span class=\"w\">  </span><span class=\"n\">tensorUnit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">tensorUnit</span>\n<span class=\"w\">  </span><span class=\"n\">associator</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">associator</span>\n<span class=\"w\">  </span><span class=\"n\">leftUnitor</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">leftUnitor</span>\n<span class=\"w\">  </span><span class=\"n\">rightUnitor</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rightUnitor</span>\n<span class=\"w\">  </span><span class=\"n\">whiskerLeft_comp</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">comp_whiskerRight</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 495590546,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668526
    },
    {
        "content": "<p>So my current approach is just to replace this with <code>MonoidalCategory.mk'</code>, which of course makes the syntax a bit uglier since now all these things become named args with lambdas (thankfully can still use aesop cat as a default tactic)</p>",
        "id": 495590628,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668573
    },
    {
        "content": "<p>Thing is only 4 things fail this way so it's not too irritating a change to just get it over with</p>",
        "id": 495590694,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668602
    },
    {
        "content": "<p>The alternative is to copy <code>Discretion</code> and have <code>IsPremonoidal</code> and <code>IsMonoidal</code> typeclasses</p>",
        "id": 495590804,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668646
    },
    {
        "content": "<p>This would solve the problem since <code>PremonoidalCategory</code> and <code>MonoidalCategory</code> can just inherit from the appropriate typeclasses, and we can have an instance deriving <code>IsPremonoidal</code> from <code>IsMonoidal</code></p>",
        "id": 495590869,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668681
    },
    {
        "content": "<p>Why not keep <code>MonoidalCategory</code> as it is, and only introduce <code>IsBinoidal</code> and <code>IsPremonoidal</code>?</p>",
        "id": 495591023,
        "sender_full_name": "JoÃ«l Riou",
        "timestamp": 1737668752
    },
    {
        "content": "<p>That's what I do in <code>discretion</code></p>",
        "id": 495591083,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668766
    },
    {
        "content": "<p>This is ugly because it makes premonoidal categories into a second-class citizen, imo</p>",
        "id": 495591104,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668779
    },
    {
        "content": "<p>Since now you write [Category C] [MonoidalCategoryStruct C] [IsPremonoidal C] everywhere</p>",
        "id": 495591139,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668794
    },
    {
        "content": "<p>Of course, we could have a utility class [PremonoidalCategory C] which inherits from MonoidalCategoryStruct C and IsPremonoidal C and use that...</p>",
        "id": 495591173,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668822
    },
    {
        "content": "<p>Also when you're actually doing these proofs you often want to do it in stages, e.g. first prove your category is binoidal, then use that to prove your category is premonoidal, etc</p>",
        "id": 495591303,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668882
    },
    {
        "content": "<p>Currently, we mostly have only <code>MonoidalCategory</code>, and turning this into <code>[MonoidalCategoryStruct C]</code> and <code>[IsMonoidal C]</code> everywhere would be strictly more ugly...</p>",
        "id": 495591482,
        "sender_full_name": "JoÃ«l Riou",
        "timestamp": 1737668957
    },
    {
        "content": "<p>No I specifically want to avoid this by having PremonoidalCategory C be a subclass of MonoidalCategory C</p>",
        "id": 495591526,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737668982
    },
    {
        "content": "<p>This also lets you prove a premonoidal category is monoidal by showing everything is central, which is nice</p>",
        "id": 495591560,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737669000
    },
    {
        "content": "<p>There is one nice alternative I've experimented with in <code>discretion</code> quite a bit, but I have no idea why it doesn't seem to be used a lot in Mathlib which makes me fear there's something horribly wrong with it</p>",
        "id": 495591662,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737669026
    },
    {
        "content": "<p>That is: have a structure class (so MonoidalCategoryStruct)</p>",
        "id": 495591691,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737669039
    },
    {
        "content": "<p>A bunch of prop classes on it (IsPremonoidal, IsMonoidal, etc.)</p>",
        "id": 495591712,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737669051
    },
    {
        "content": "<p>and then define MonoidalCategory to inherit from IsMonoidal and MCS, PremonoidalCategory from IsPremonoidal and MCS, etc</p>",
        "id": 495591774,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737669088
    },
    {
        "content": "<p>The you can add an instance so that any MCS which is IsMonoidal is automatically a MonoidalCategory</p>",
        "id": 495591808,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737669110
    },
    {
        "content": "<p>I think I'm overcomplicating it and should just go with the custom constructor for now, I just wish there was nicer syntax/the default fields worked because then I wouldn't need the custom constructor and everything would be fine!</p>",
        "id": 495592219,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737669288
    },
    {
        "content": "<p>I do wonder why this is not working though:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">MonoidalCategory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ğ’</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">PremonoidalCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/--</span>\n<span class=\"sd\">  Composition of tensor products is tensor product of compositions:</span>\n<span class=\"sd\">  `(fâ‚ âŠ— gâ‚) âˆ˜ (fâ‚‚ âŠ— gâ‚‚) = (fâ‚ âˆ˜ fâ‚‚) âŠ— (gâ‚ âŠ— gâ‚‚)`</span>\n<span class=\"sd\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">tensor_comp</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Zâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Zâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gâ‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Zâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Zâ‚‚</span><span class=\"o\">),</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">gâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">gâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">gâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"n\">whiskerLeft_comp</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">whiskerLeft_comp_ofTensorHom</span><span class=\"w\"> </span><span class=\"n\">tensorHom_def</span><span class=\"w\"> </span><span class=\"n\">id_whiskerRight</span><span class=\"w\"> </span><span class=\"n\">tensor_comp</span>\n<span class=\"w\">  </span><span class=\"n\">comp_whiskerRight</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">comp_whiskerRight_ofTensorHom</span><span class=\"w\"> </span><span class=\"n\">tensorHom_def</span><span class=\"w\"> </span><span class=\"n\">whiskerLeft_id</span><span class=\"w\"> </span><span class=\"n\">tensor_comp</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">MonoidalCategory</span><span class=\"bp\">.</span><span class=\"n\">mk'</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ğ’</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MonoidalCategoryStruct</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">tensorHom_def</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"o\">{</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"o\">),</span>\n<span class=\"w\">      </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop_cat</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">tensor_comp</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Zâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Zâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gâ‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Zâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Zâ‚‚</span><span class=\"o\">),</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">gâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">gâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">gâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop_cat</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">whiskerLeft_id</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop_cat</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">id_whiskerRight</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop_cat</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">associator_naturality</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚ƒ</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚ƒ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚ƒ</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"o\">),</span>\n<span class=\"w\">      </span><span class=\"o\">((</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚ƒ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚ƒ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚ƒ</span><span class=\"o\">))</span>\n<span class=\"w\">      </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop_cat</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">leftUnitor_naturality</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»_</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">rightUnitor_naturality</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ï_</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ï_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">pentagon</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">triangle</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ğŸ™</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»_</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ï_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonoidalCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">tensorHom_def</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">tensorHom_def</span>\n<span class=\"w\">  </span><span class=\"n\">tensor_comp</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">tensor_comp</span>\n<span class=\"w\">  </span><span class=\"n\">whiskerLeft_id</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">whiskerLeft_id</span>\n<span class=\"w\">  </span><span class=\"n\">id_whiskerRight</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">id_whiskerRight</span>\n<span class=\"w\">  </span><span class=\"n\">associator_naturality</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">associator_naturality</span>\n<span class=\"w\">  </span><span class=\"n\">leftUnitor_naturality</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">leftUnitor_naturality</span>\n<span class=\"w\">  </span><span class=\"n\">rightUnitor_naturality</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rightUnitor_naturality</span>\n<span class=\"w\">  </span><span class=\"n\">pentagon</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">pentagon</span>\n<span class=\"w\">  </span><span class=\"n\">triangle</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">triangle</span>\n</code></pre></div>\n<p>fails with \"could not synthesize default value for field 'whiskerLeft_comp' of 'CategoryTheory.BinoidalCategory' using tactics\" rather than just using the default value I gave it</p>",
        "id": 495594785,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737670427
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"461231\">Jad Ghalayini</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Premonoidal.20categories/near/495589741\">said</a>:</p>\n<blockquote>\n<p>No, but I just realized that I forgot to make the associators themselves central, d'uh...</p>\n</blockquote>\n<p>Sorry for going back to my previous question. There is another possible definition of <code>tensorHom</code> (<code>rtimes</code> in <code>discretion</code>). Does the <code>rtimes</code> version <code>associator_naturality_rtimes</code> hold as well? I think that should be the case, but I can't be sure right now.</p>",
        "id": 495596283,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1737671205
    },
    {
        "content": "<p>Also, all possible mix verseions of the two.</p>",
        "id": 495596378,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1737671243
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"438192\">Yuma Mizuno</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Premonoidal.20categories/near/495596283\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"461231\">Jad Ghalayini</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Premonoidal.20categories/near/495589741\">said</a>:</p>\n<blockquote>\n<p>No, but I just realized that I forgot to make the associators themselves central, d'uh...</p>\n</blockquote>\n<p>Sorry for going back to my previous question. There is another possible definition of <code>tensorHom</code> (<code>rtimes</code> in <code>discretion</code>). Does the <code>rtimes</code> version <code>associator_naturality_rtimes</code> hold as well? I think that should be the case, but I can't be sure right now.</p>\n</blockquote>\n<p>Yes, I'm using ltimes since that's what you guys currently use</p>",
        "id": 495596394,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737671252
    },
    {
        "content": "<p>Note that you can prove the rtimes version from the ltimes version of naturality and vice versa</p>",
        "id": 495596419,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737671266
    },
    {
        "content": "<p>In discretion we only assume the ltimes version and prove the rtimes version as a theorem</p>",
        "id": 495596472,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737671283
    },
    {
        "content": "<p>Can I see the proofs?</p>",
        "id": 495596576,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1737671337
    },
    {
        "content": "<p>So in <code>discretion</code> we define premonoidal categories as follows:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">IsBinoidal</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MonoidalCategoryStruct</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">tensorHom_def</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"n\">whiskerLeft_id</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"n\">id_whiskerRight</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"n\">whiskerLeft_comp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"n\">whiskerRight_comp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop_cat</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">IsPremonoidal</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MonoidalCategoryStruct</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">IsBinoidal</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">associator_central</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"n\">Monoidal</span><span class=\"bp\">.</span><span class=\"n\">Central</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"n\">leftUnitor_central</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"n\">Monoidal</span><span class=\"bp\">.</span><span class=\"n\">Central</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"n\">rightUnitor_central</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"n\">Monoidal</span><span class=\"bp\">.</span><span class=\"n\">Central</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ï_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- Naturality of the associator isomorphism: `(fâ‚ âŠ— fâ‚‚) âŠ— fâ‚ƒ â‰ƒ fâ‚ âŠ— (fâ‚‚ âŠ— fâ‚ƒ)` -/</span>\n<span class=\"w\">  </span><span class=\"n\">associator_naturality</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚ƒ</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚ƒ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚ƒ</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"o\">),</span>\n<span class=\"w\">      </span><span class=\"o\">((</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚ƒ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚ƒ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚ƒ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"sd\">/--</span>\n<span class=\"sd\">  Naturality of the left unitor, commutativity of `ğŸ™_ C âŠ— X âŸ¶ ğŸ™_ C âŠ— Y âŸ¶ Y` and `ğŸ™_ C âŠ— X âŸ¶ X âŸ¶ Y`</span>\n<span class=\"sd\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">leftUnitor_naturality</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»_</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"sd\">/--</span>\n<span class=\"sd\">  Naturality of the right unitor: commutativity of `X âŠ— ğŸ™_ C âŸ¶ Y âŠ— ğŸ™_ C âŸ¶ Y` and `X âŠ— ğŸ™_ C âŸ¶ X âŸ¶ Y`</span>\n<span class=\"sd\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">rightUnitor_naturality</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ï_</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ï_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"sd\">/--</span>\n<span class=\"sd\">  The pentagon identity relating the isomorphism between `X âŠ— (Y âŠ— (Z âŠ— W))` and `((X âŠ— Y) âŠ— Z) âŠ— W`</span>\n<span class=\"sd\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">pentagon</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"sd\">/--</span>\n<span class=\"sd\">  The identity relating the isomorphisms between `X âŠ— (ğŸ™_ C âŠ— Y)`, `(X âŠ— ğŸ™_ C) âŠ— Y` and `X âŠ— Y`</span>\n<span class=\"sd\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">triangle</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ğŸ™</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»_</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ï_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n</code></pre></div>\n<p>Note we assume that <code>âŠ— = â‹‰</code> by <code>tensorHom_def</code></p>",
        "id": 495596819,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737671425
    },
    {
        "content": "<p>It's trivial to prove left/middle/right versions from this as follows:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">associator_naturality</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚ƒ</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚ƒ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚ƒ</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"o\">((</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚ƒ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚ƒ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚ƒ</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">IsPremonoidal</span><span class=\"bp\">.</span><span class=\"n\">associator_naturality</span><span class=\"w\"> </span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"n\">fâ‚ƒ</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">reassoc</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">associator_naturality_right</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">X'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X'</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">associator_naturality</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">tensorHom_def</span><span class=\"o\">]</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">reassoc</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">associator_naturality_middle</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y'</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">associator_naturality</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">tensorHom_def</span><span class=\"o\">]</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">reassoc</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">associator_naturality_left</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Z'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z'</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">associator_naturality</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">tensorHom_def</span><span class=\"o\">]</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">reassoc</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">associator_inv_naturality</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚ƒ</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚ƒ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚ƒ</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚ƒ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚ƒ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚ƒ</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cancel_mono</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚ƒ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">associator_naturality</span><span class=\"o\">])</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">reassoc</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">associator_inv_naturality_right</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">X'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X'</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">associator_inv_naturality</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">tensorHom_def</span><span class=\"o\">]</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">reassoc</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">associator_inv_naturality_middle</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y'</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">associator_inv_naturality</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">tensorHom_def</span><span class=\"o\">]</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">reassoc</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">associator_inv_naturality_left</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Z'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z'</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">associator_inv_naturality</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">tensorHom_def</span><span class=\"o\">]</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">reassoc</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">leftUnitor_naturality</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"mi\">ğŸ™</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»_</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">IsPremonoidal</span><span class=\"bp\">.</span><span class=\"n\">leftUnitor_naturality</span><span class=\"w\"> </span><span class=\"n\">f</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">reassoc</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">leftUnitor_inv_naturality</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»_</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"bp\">_</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cancel_mono</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»_</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mp</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">leftUnitor_naturality</span><span class=\"o\">]</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">reassoc</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">rightUnitor_naturality</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ï_</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ï_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">IsPremonoidal</span><span class=\"bp\">.</span><span class=\"n\">rightUnitor_naturality</span><span class=\"w\"> </span><span class=\"n\">f</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">reassoc</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">rightUnitor_inv_naturality</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ï_</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ï_</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cancel_mono</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ï_</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mp</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">rightUnitor_naturality</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 495596946,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737671476
    },
    {
        "content": "<p>I didn't bother writing versions for rtimes, but you can see that e.g. for associators if I wanted to do naturality for</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo>â‹Š</mo><mo stretchy=\"false\">(</mo><mi>g</mi><mo>â‹Š</mo><mi>h</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f \\rtimes (g \\rtimes h)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin amsrm\">â‹Š</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin amsrm\">â‹Š</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>I'd rewrite it to</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo>âˆ’</mo><mo>âŠ²</mo><mo stretchy=\"false\">(</mo><mo>âˆ’</mo><mo>âŠ²</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">;</mo><mo>âˆ’</mo><mo>âŠ²</mo><mo stretchy=\"false\">(</mo><mi>g</mi><mo>âŠ³</mo><mo>âˆ’</mo><mo stretchy=\"false\">)</mo><mo separator=\"true\">;</mo><mi>f</mi><mo>âŠ³</mo><mo>âˆ’</mo></mrow><annotation encoding=\"application/x-tex\">- \\lhd (- \\lhd h) ; - \\lhd (g \\rhd -) ; f \\rhd -</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin amsrm\">âŠ²</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin amsrm\">âŠ²</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin amsrm\">âŠ²</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin amsrm\">âŠ³</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mclose\">)</span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin amsrm\">âŠ³</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">âˆ’</span></span></span></span></span></p>\n<p>and apply right, middle, left naturality lemmas to get</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo>âˆ’</mo><mo>âŠ²</mo><mi>h</mi><mo separator=\"true\">;</mo><mo stretchy=\"false\">(</mo><mo>âˆ’</mo><mo>âŠ³</mo><mi>g</mi><mo stretchy=\"false\">)</mo><mo>âŠ²</mo><mo>âˆ’</mo><mo separator=\"true\">;</mo><mo stretchy=\"false\">(</mo><mi>f</mi><mo>âŠ³</mo><mo>âˆ’</mo><mo stretchy=\"false\">)</mo><mo>âŠ³</mo><mo>âˆ’</mo></mrow><annotation encoding=\"application/x-tex\">- \\lhd h ; (- \\rhd g) \\lhd - ; (f \\rhd -) \\rhd -</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin amsrm\">âŠ²</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin amsrm\">âŠ³</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin amsrm\">âŠ²</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin amsrm\">âŠ³</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin amsrm\">âŠ³</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">âˆ’</span></span></span></span></span></p>\n<p>I can do the same for any permutation of f, g, h</p>",
        "id": 495597237,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737671580
    },
    {
        "content": "<p>In fact, premonoidal categories are usually defined with separate naturality squares for the left, right, and middle; I'm just being lazy and noting that you can instead equivalently just write a single square with ltimes and derive these, and you just happen to get the same thing originally in <code>MonoidalCategory</code></p>",
        "id": 495597588,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737671711
    },
    {
        "content": "<p>I see, thanks!</p>",
        "id": 495597632,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1737671732
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"461231\">Jad Ghalayini</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Premonoidal.20categories/near/495588071\">said</a>:</p>\n<blockquote>\n<p>(indeed it is standard notation to write central morphisms with tensors and everything else with ltimes/rtimes)</p>\n</blockquote>\n<p>I actually prefer this convension, which is less confusing for me.</p>",
        "id": 495598142,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1737671927
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"438192\">Yuma Mizuno</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Premonoidal.20categories/near/495598142\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"461231\">Jad Ghalayini</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Premonoidal.20categories/near/495588071\">said</a>:</p>\n<blockquote>\n<p>(indeed it is standard notation to write central morphisms with tensors and everything else with ltimes/rtimes)</p>\n</blockquote>\n<p>I actually prefer this convension, which is less confusing for me.</p>\n</blockquote>\n<p>As in, writing central morphisms with tensors? I agree; all other use of tensors in <code>discretion</code> is for backwards compatibility purposes with mathlib's monoidal stuff</p>",
        "id": 495598257,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737671976
    },
    {
        "content": "<p>Also, I'm currently experimenting with a design like this to deal with the default member problem. Would such dirty hacks be acceptable as a pure implementation detail, assuming the rest of mathlib can use <code>MonoidalCategory</code> with exactly the same API as before?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ğ’</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MonoidalCategoryStruct</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">TensorHomDef</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">tensorHom_def</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop_cat</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">WhiskeringId</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span><span class=\"cm\"> Left whiskering of the identity is the identity: `X â— ğŸ™ Y = ğŸ™ (X âŠ— Y)` -/</span>\n<span class=\"w\">  </span><span class=\"n\">whiskerLeft_id</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span><span class=\"cm\"> Right whiskering of the identity is the identity `ğŸ™ X â–· Y = ğŸ™ (X âŠ— Y)` -/</span>\n<span class=\"w\">  </span><span class=\"n\">id_whiskerRight</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">WhiskeringComp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span><span class=\"cm\"> Left whiskering respects composition -/</span>\n<span class=\"w\">  </span><span class=\"n\">whiskerLeft_comp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span><span class=\"cm\"> Right whiskering respects composition -/</span>\n<span class=\"w\">  </span><span class=\"n\">comp_whiskerRight</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">TensorFunctorial</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- Tensor product of identity maps is the identity: `(ğŸ™ Xâ‚ âŠ— ğŸ™ Xâ‚‚) = ğŸ™ (Xâ‚ âŠ— Xâ‚‚)` -/</span>\n<span class=\"w\">  </span><span class=\"n\">tensor_id</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n<span class=\"w\">  </span><span class=\"sd\">/--</span>\n<span class=\"sd\">  Composition of tensor products is tensor product of compositions:</span>\n<span class=\"sd\">  `(fâ‚ âŠ— gâ‚) âˆ˜ (fâ‚‚ âŠ— gâ‚‚) = (fâ‚ âˆ˜ fâ‚‚) âŠ— (gâ‚ âŠ— gâ‚‚)`</span>\n<span class=\"sd\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">tensor_comp</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Zâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"n\">Zâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gâ‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Zâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Zâ‚‚</span><span class=\"o\">),</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">gâ‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚‚</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"n\">gâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">fâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰«</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">gâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop_cat</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">WhiskeringId</span><span class=\"bp\">.</span><span class=\"n\">id_tensorHom</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TensorHomDef</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">WhiskeringId</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Yâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Yâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">â—</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TensorHomDef</span><span class=\"bp\">.</span><span class=\"n\">tensorHom_def</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">id_whiskerRight</span><span class=\"o\">]</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">WhiskeringId</span><span class=\"bp\">.</span><span class=\"n\">tensorHom_id</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TensorHomDef</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">WhiskeringId</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Xâ‚</span><span class=\"w\"> </span><span class=\"bp\">âŸ¶</span><span class=\"w\"> </span><span class=\"n\">Xâ‚‚</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">âŠ—</span><span class=\"w\"> </span><span class=\"mi\">ğŸ™</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â–·</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TensorHomDef</span><span class=\"bp\">.</span><span class=\"n\">tensorHom_def</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">whiskerLeft_id</span><span class=\"o\">]</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">TensorFunctorial</span><span class=\"bp\">.</span><span class=\"n\">instWhiskeringComp</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">TensorHomDef</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TensorFunctorial</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">WhiskeringId</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WhiskeringComp</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">whiskerLeft_comp</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">intros</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">&lt;-</span><span class=\"n\">WhiskeringId</span><span class=\"bp\">.</span><span class=\"n\">id_tensorHom</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">&lt;-</span><span class=\"n\">tensor_comp</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">comp_whiskerRight</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">intros</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">&lt;-</span><span class=\"n\">WhiskeringId</span><span class=\"bp\">.</span><span class=\"n\">tensorHom_id</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">&lt;-</span><span class=\"n\">tensor_comp</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 495599249,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737672436
    },
    {
        "content": "<p>Note that now the WhiskeringComp fields are automatically generated by typeclass inference</p>",
        "id": 495599337,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737672475
    },
    {
        "content": "<p>I'm taking inspiration from how <code>Lattice</code> and friends work; the idea would be to have <code>BinoidalCategory</code> extend <code>WhiskeringId, WhiskeringComp</code>, and <code>TensorHomDef</code> while <code>MonoidalCategory</code> would extend <code>TensorFunctorial</code></p>",
        "id": 495599464,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737672522
    },
    {
        "content": "<p><code>TensorFunctorial</code> would also by typeclass inference render everything central, and hence it would be easy to infer the associators are central by e.g. just <code>infer_instance</code></p>",
        "id": 495599516,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737672548
    },
    {
        "content": "<p>In general I'd like to separate out the tensor structure (whiskering, homs, etc) from the monoidal structure (associators) but that can be a separate PR, again, most users would see no difference except that you can theoretically structure your proofs a bit more cleanly by using the fact that your category is binoidal before even constructing associators</p>",
        "id": 495599697,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737672651
    },
    {
        "content": "<p>This is however only really useful for my use-case where (in the repo <a href=\"https://github.com/imbrem/debruijn-ssa\">https://github.com/imbrem/debruijn-ssa</a>) I construct a premonoidal category by quotienting syntax and defining associators/unitors/etc is Very Hard (TM), with the binoidal structure maybe useful to prove e.g. the associator is an isomorphism</p>",
        "id": 495599786,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737672716
    },
    {
        "content": "<p>I've been facing some issues with default members, which have been moved to <a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/Issues.20with.20default.20parameters\">#lean4 &gt; Issues with default parameters</a> . My current best-effort solution is just to fill in the default parameters for all uses of <code>MonoidalCategory</code> now, since when/if that issue is fixed we can remove them. Other options include:</p>\n<ul>\n<li>Leaving them in</li>\n<li>Weird typeclass hack I've been experimenting with to avoid this problem, but it messes with the <code>monoidal</code> tactic</li>\n</ul>",
        "id": 495755324,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737737612
    },
    {
        "content": "<p>I would like to suggest using <code>whisker_exchange</code> rather than <code>tensor_comp</code> as an axiom for <code>MonoidalCategory</code> minus <code>PremonoidalCategory</code>. Adding a redundant condition is aesthetically unappealing (in my personal view) and may increase the work when proving the condition in practice.</p>\n<p>We can define an additional constructor for <code>MonoidalCategory</code> that includes <code>tensor_comp</code> as an axiom, written solely in terms of <code>tensorHom</code> rather than whiskerings. Several monoidal category instances in the current downstream files could likely be given by this constructor.</p>",
        "id": 495866876,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1737808129
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"438192\">@Yuma Mizuno</span> I could do that, but that would require changing all existing instances of <code>MonoidalCategory</code> to use the new constructor. On the other hand, it would unblock us from <a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/Issues.20with.20default.20parameters\">#lean4 &gt; Issues with default parameters</a> , and the other solution I was considering is kind of ugly. Would doing this be acceptable, that is, changing every</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonoidalCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">tensor_comp</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>to</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">instance</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonoidalCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">MonoidalCategory.mk'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">tensor_comp</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 495972504,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737902436
    },
    {
        "content": "<p>If so I can probably get a PR ready Soon (TM) (I was really gunning for yesterday but I used the whole day on it and I have to give a presentation tomorrow rip)</p>",
        "id": 495972535,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737902463
    },
    {
        "content": "<p>Also w.r.t. your note about work it turns out the automation is much better at proving things like <code>tensor_comp</code> than it is at proving things like <code>whiskerLeft_comp</code>, let alone <code>whisker_exchange</code>. This actually makes sense when you consider the current <code>simp</code>-normal forms favored, and I don't plan to change that since most math people will be using monoidal categories, and PL users such as myself will need weird simplifications anyways</p>",
        "id": 495972668,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737902572
    },
    {
        "content": "<p>(At least, so my intuition tells me from work on <code>discretion</code>)</p>",
        "id": 495972680,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737902586
    },
    {
        "content": "<p>If the lean4 issue has a chance to be solved in a near future, I would prefer we wait for the fix, unless there are other particular reasons to proceed very fast.</p>",
        "id": 495977633,
        "sender_full_name": "JoÃ«l Riou",
        "timestamp": 1737906689
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"461231\">Jad Ghalayini</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Premonoidal.20categories/near/495972504\">said</a>:</p>\n<blockquote>\n<p>Would doing this be acceptable, that is, changing every</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonoidalCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">tensor_comp</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>to</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">instance</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonoidalCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">MonoidalCategory.mk'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">tensor_comp</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">)</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>In my opinion, this kind of change is acceptable. The default constructor has some syntactic privileges, but other than that I think the change is not large.</p>",
        "id": 495978937,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1737907600
    },
    {
        "content": "<p>Perhaps the syntax could be improved by defining a structure that contains the arguments of the additional constructor?</p>",
        "id": 495978972,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1737907635
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"459699\">@JoÃ«l Riou</span> if we go with the <code>whisker_exchange</code> design then things look the same whether or not we have the fix, hence my suggestion to just go ahead. On the other hand, with <code>tensor_comp</code>, things are indeed a _lot_ cleaner with the fix.</p>",
        "id": 496011962,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1737934100
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"461231\">Jad Ghalayini</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Premonoidal.20categories/near/495972668\">said</a>:</p>\n<blockquote>\n<p>Also w.r.t. your note about work it turns out the automation is much better at proving things like <code>tensor_comp</code> than it is at proving things like <code>whiskerLeft_comp</code>, let alone <code>whisker_exchange</code>.</p>\n</blockquote>\n<p>I find this observation interesting since  it contradicts my intuition. I would like to know more about this.</p>\n<p>One note: It is \"intentional\" that the simp automation does not handle <code>whisker_exchange</code>. Currently, <code>simp</code> does not determine whether right or left morphisms should come first. On the other hand, I believe the automation works well for <code>whiskerLeft_comp</code>. It just expands the expression distributively, which is a typical simp lemma in algebraic theories.</p>",
        "id": 496056265,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1737964849
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"438192\">@Yuma Mizuno</span> so I finally found some time to work on this again, and I'm nearly finished what will hopefully be a decent PR</p>",
        "id": 497962527,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1738781772
    },
    {
        "content": "<p>I've got a question though: for stuff that's true for PremonoidalCategory, should we move it from the MonoidalCategory namespace to the PremonoidalCategory namespace and re-export it or just leave it in the MonoidalCategory namespace with a PremonoidalCategory bound?</p>",
        "id": 497962597,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1738781808
    },
    {
        "content": "<p>Going with the former so far</p>",
        "id": 497963251,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1738782039
    },
    {
        "content": "<p>One issue I'm worried about however is the notation is in MonoidalCategory, so we'd want to open that anyways...</p>",
        "id": 497968189,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1738783718
    },
    {
        "content": "<p>OK, I'm done a draft PR:<br>\n<a href=\"https://github.com/leanprover-community/mathlib4/pull/21488\">https://github.com/leanprover-community/mathlib4/pull/21488</a></p>",
        "id": 498016401,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1738805707
    },
    {
        "content": "<p>I'm stuck because this change seems to break the string diagram tool...</p>",
        "id": 498160096,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1738858735
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"438192\">@Yuma Mizuno</span> this seems to be related to the coherence tactic; mind helping me out?</p>",
        "id": 498160284,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1738858793
    },
    {
        "content": "<p>I have no idea how <code>CoherenceM</code> works</p>",
        "id": 498160316,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1738858802
    },
    {
        "content": "<p>I fixed the failing tests with type hints, should have thought of that first!</p>",
        "id": 498187108,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1738866910
    },
    {
        "content": "<p>Well, at least I hope I did, waiting for CI!</p>",
        "id": 498187171,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1738866927
    },
    {
        "content": "<p>Thanks! I can't look it in detail today, but I will sometime soon.</p>",
        "id": 498401957,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1738952702
    },
    {
        "content": "<p>Thanks a lot! I've now got the <code>monoidal_coherence</code> tactic working, and the <code>monoidal</code> tactic working _sometimes_, since premonoidal categories can't interconvert between <code>f \\rtimes g</code> and <code>f \\otimes g</code>. We'd probably want a <code>premonoidal</code> tactic that doesn't attempt such normalization, but for now we just error out if its required with a <code>can't find monoidal instance</code> and that works just fine</p>",
        "id": 498506165,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1739024590
    },
    {
        "content": "<p>Hello! I realize this PR is very big; do you think it would be worthwhile to split it into some smaller PRs which:</p>\n<ol>\n<li>Introduce the premonoidal category API</li>\n<li>Port the <code>coherence</code> tactic to use the premonoidal category API (depends on 1)</li>\n<li>Port braided + symmetric monoidal categories to use premonoidal categories (depends on 2)</li>\n<li>Add some extra lemmas unique to premonoidal categories (depends on 1)</li>\n</ol>",
        "id": 500633482,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1739966734
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"438192\">@Yuma Mizuno</span> ?</p>",
        "id": 500633501,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1739966741
    },
    {
        "content": "<p>Sorry I'm coming to this very late. I admit I am a little skeptical, and would like to see some more explanation of why premonoidal categories are a natural concept (despite working in low-dimensional category theory for many years, I had not met them).</p>\n<p>In particular, consider the following question: what if someone later wants to add the (in my mind, better justified) definition of a skew monoidal category (this is one in which the associator is not necessarily invertible). How will the development of monoidal categories look then, if it has to accomodate both? Would it still be viable?</p>",
        "id": 500634624,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1739967047
    },
    {
        "content": "<p>(I can't promise to engage at length with an answer here --- but I hope whoever is reviewing these PRs considers the question/answer!)</p>",
        "id": 500634784,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1739967107
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Premonoidal.20categories/near/500634624\">said</a>:</p>\n<blockquote>\n<p>Sorry I'm coming to this very late. I admit I am a little skeptical, and would like to see some more explanation of why premonoidal categories are a natural concept (despite working in low-dimensional category theory for many years, I had not met them).</p>\n<p>In particular, consider the following question: what if someone later wants to add the (in my mind, better justified) definition of a skew monoidal category (this is one in which the associator is not necessarily invertible). How will the development of monoidal categories look then, if it has to accomodate both? Would it still be viable?</p>\n</blockquote>\n<p>So premonoidal categories are an extremely natural concept in theoretical computer science, since they (very slightly) generalize the Kleisli category of a strong monad over a symmetric monoidal category</p>",
        "id": 500649356,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1739971466
    },
    {
        "content": "<p>I specifically need them to formalize my PhD thesis, which is about using premonoidal categories to model refinement of imperative programs in a variety of complex memory models</p>",
        "id": 500649530,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1739971524
    },
    {
        "content": "<p>I can't think of _too many_ uses in pure mathematics off the top of my head</p>",
        "id": 500649720,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1739971578
    },
    {
        "content": "<p>Skew monoidal categories would be imo no more difficult to implement than they are now, since you'd need to change <code>MonoidalCategoryStruct</code> to not make the associator an isomorphism either way</p>",
        "id": 500649814,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1739971612
    },
    {
        "content": "<p>One particularly important CS-flavored application is <a href=\"https://ncatlab.org/nlab/show/Freyd+category\">https://ncatlab.org/nlab/show/Freyd+category</a>, and in particular a lot of axiomatic domain theory, as well as modeling Lawvere theories</p>",
        "id": 500650003,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1739971676
    },
    {
        "content": "<p>Right now in my library <code>discretion</code> I've got a dirty hack where I essentially copy over the monoidal category implementation as <code>PremonoidalCategory</code>, and it's... not very pretty; I'd much rather just use it from Mathlib and not have to duplicate all that + the tactics</p>",
        "id": 500650614,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1739971848
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"461231\">Jad Ghalayini</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Premonoidal.20categories/near/500649356\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Premonoidal.20categories/near/500634624\">said</a>:</p>\n<blockquote>\n<p>Sorry I'm coming to this very late. I admit I am a little skeptical, and would like to see some more explanation of why premonoidal categories are a natural concept (despite working in low-dimensional category theory for many years, I had not met them).</p>\n<p>In particular, consider the following question: what if someone later wants to add the (in my mind, better justified) definition of a skew monoidal category (this is one in which the associator is not necessarily invertible). How will the development of monoidal categories look then, if it has to accomodate both? Would it still be viable?</p>\n</blockquote>\n<p>So premonoidal categories are an extremely natural concept in theoretical computer science, since they (very slightly) generalize the Kleisli category of a strong monad over a symmetric monoidal category</p>\n</blockquote>\n<p>My longer-term hopes would be to have a large amount of rewriting for monads over arbitrary SMCs (and in particular, for my thesis, the category of partial orders) done in terms of premonoidal categories, and then separately theorems about commutative monads and how, if a monad is commutative, its Kleisli category is in fact monoidal</p>",
        "id": 500651104,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1739971965
    },
    {
        "content": "<p>Lots of interesting things can be written as strong monads over the appropriate category, so hopefully that should open some math applications too other than the extensive theoretical CS applications (in particular, for example, the fact that the free vector space monad is commutative derives a lot of linear algebra in a slick way; on the other hand, the free module monad is not necessarily commutative, and hence induces a premonoidal rather than monoidal category)</p>",
        "id": 500651523,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1739972082
    },
    {
        "content": "<p>Based on Kim's comments, I'd like to review these changes more carefully.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"461231\">Jad Ghalayini</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Premonoidal.20categories/near/500633482\">said</a>:</p>\n<blockquote>\n<p>Hello! I realize this PR is very big; do you think it would be worthwhile to split it into some smaller PRs which:</p>\n</blockquote>\n<p>In any case, I think the split of the PR would be better in this PR process. As step zero, would it be possible to first separate the following?: Before introducing Premonoidal, rewrite the definition of monoidal in terms of whiskering and introduce the constructor <code>ofTensorHom</code>. </p>\n<p>Regarding introducing of Premonoidal category, my perspective might be based on the following my experience: I previously attempted the above \"step zero\" as a part of a refactoring of the monoidal category library (though I didn't complete it as it wasn't really necessary at the time). I believe the split of <code>whisker_exchange</code> by introducing Premonoidal category could be done without much effort during that process. While this itself doesn't demonstrate necessity of Premonoidal category definition, it might explain why I am less skepitical to it.</p>\n<p>Also, for the split of PRs, would it be possible to postpone the introduction of ltimes and rtimes operators to a later step? To be honest, I'm not yet clear about their need at this point.</p>\n<p>(I can't see mathlib this week as I'm traveling without my main PC, sorry about that.)</p>",
        "id": 500682283,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1739979997
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"438192\">Yuma Mizuno</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Premonoidal.20categories/near/500682283\">said</a>:</p>\n<blockquote>\n<p>Based on Kim's comments, I'd like to review these changes more carefully.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"461231\">Jad Ghalayini</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Premonoidal.20categories/near/500633482\">said</a>:</p>\n<blockquote>\n<p>Hello! I realize this PR is very big; do you think it would be worthwhile to split it into some smaller PRs which:</p>\n</blockquote>\n<p>In any case, I think the split of the PR would be better in this PR process. As step zero, would it be possible to first separate the following?: Before introducing Premonoidal, rewrite the definition of monoidal in terms of whiskering and introduce the constructor <code>ofTensorHom</code>. </p>\n<p>Regarding introducing of Premonoidal category, my perspective might be based on the following my experience: I previously attempted the above \"step zero\" as a part of a refactoring of the monoidal category library (though I didn't complete it as it wasn't really necessary at the time). I believe the split of <code>whisker_exchange</code> by introducing Premonoidal category could be done without much effort during that process. While this itself doesn't demonstrate necessity of Premonoidal category definition, it might explain why I am less skepitical to it.</p>\n<p>Also, for the split of PRs, would it be possible to postpone the introduction of ltimes and rtimes operators to a later step? To be honest, I'm not yet clear about their need at this point.</p>\n<p>(I can't see mathlib this week as I'm traveling without my main PC, sorry about that.)</p>\n</blockquote>\n<p>OK, that works, though I might need a bit of time as I have a paper deadline coming up</p>",
        "id": 500724658,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1739992680
    },
    {
        "content": "<p>I can leave ltimes and rtimes out, but really I just view them as syntax sugar for writing down centrality more cleanly, rather than anything fundamental (they're just an abbrev in my PR). Would it be a big add to have them as scoped notation inside <code>PremonoidalCategory</code>?</p>",
        "id": 500724797,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1739992724
    },
    {
        "content": "<p>Since <a href=\"https://github.com/leanprover/lean4/issues/6769\">https://github.com/leanprover/lean4/issues/6769</a> was just merged, do we still want to refactor the <code>MonoidalCategory</code> instances to use the <code>ofTensorHom</code> constructor or should we use default parameters?</p>",
        "id": 510652415,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1744028546
    },
    {
        "content": "<p>I've fixed the merge conflicts, just making sure everything builds (I'm away from home on a tiny laptop, so slow!) before pushing</p>",
        "id": 510652546,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1744028571
    },
    {
        "content": "<p>But if I'll need to split up the PR anyways was wondering whether I should try the default parameter approach or whether using the <code>ofTensorHom</code> constructor is strictly better</p>",
        "id": 510652703,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1744028602
    },
    {
        "content": "<p>Sorry for the inactivity, Thesis Is Hard (TM)</p>",
        "id": 510652821,
        "sender_full_name": "Jad Ghalayini",
        "timestamp": 1744028633
    },
    {
        "content": "<p>My preference is to use <code>ofTensorHom</code>, not to use <code>tensorHom</code> in <code>PremonoidalCategory</code>. My mental model of <code>tensorHom</code> is horizontally aligned morphisms in a string diagram, which I think is meaningful interpretation only in <code>MonoidalCategory</code>. So what I really expect is like</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>PremonoidalCategoryStruct\n  â€¢ left whiskering\n  â€¢ right whiskering\n\nPremonoidalCategory extends PremonoidalCategoryStruct\n  â€¢ axioms\n\nMonoidalCategoryStruct extends PremonoidalCategoryStruct\n  â€¢ tensorHom\n\nMonoidalCategory extends PremonoidalCategory, MonoidalCategoryStruct\n  â€¢ whiskering_exchange\n  â€¢ tensorHom_def\n</code></pre></div>",
        "id": 511016109,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1744142596
    },
    {
        "content": "<p>Also, I don't think it's a good idea to have a long list of exports, as it hard to maintain. How about basically having the <code>MonoidalCategory</code> namespace even if theorems hold in Premonoidal categories?</p>",
        "id": 511016662,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1744142767
    },
    {
        "content": "<p>We have the RingHom namespace even though stuff applies to semirings</p>",
        "id": 511022736,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744145179
    }
]