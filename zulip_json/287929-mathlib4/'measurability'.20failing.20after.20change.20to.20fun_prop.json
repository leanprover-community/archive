[
    {
        "content": "<p>I'm trying to merge master into <a href=\"https://github.com/leanprover-community/mathlib4/pull/26923\">#26923</a>. I've run into an issue where a call to <code>measurability</code> is not working anymore, and using git bisect I narrowed it down to this specific commit:</p>\n<p><code>refactor: use `fun_prop` in `measurability` (#30511)</code></p>\n<p>I'm having trouble understanding it enough to <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> it. I found I can fix the error by applying <code>apply Measurable.sup</code> manually, but the commit message of <a href=\"https://github.com/leanprover-community/mathlib4/pull/30511\">#30511</a> makes me think that this error was not expected from the change in the first place. I know a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> would be better, but perhaps the diff of the <code>aesop</code> trace outputs below will let someone understand what is going on? Green is the working version before <a href=\"https://github.com/leanprover-community/mathlib4/pull/30511\">#30511</a>, in red is after <a href=\"https://github.com/leanprover-community/mathlib4/pull/30511\">#30511</a>. It seems that before   <a href=\"https://github.com/leanprover-community/mathlib4/pull/30511\">#30511</a>, there was this <code>[aesop] ✅️ &lt;norm unfold&gt;</code> step that was removed. Is that expected?</p>\n<div class=\"codehilite\" data-code-language=\"Diff\"><pre><span></span><code><span class=\"gh\">diff -u --label \\#\\&lt;buffer\\ \\*diags-Pointwise.lean\\&lt;mathlib-butterley\\&gt;\\*\\&gt; --label \\#\\&lt;buffer\\ \\*diags-Pointwise.lean\\&lt;before-modules-debug\\&gt;\\*\\&gt; /tmp/buffer-content-NHt1Eb /tmp/buffer-content-nO8xIp</span>\n<span class=\"gd\">--- #&lt;buffer *diags-Pointwise.lean&lt;mathlib-butterley&gt;*&gt;</span>\n<span class=\"gi\">+++ #&lt;buffer *diags-Pointwise.lean&lt;before-modules-debug&gt;*&gt;</span>\n<span class=\"gu\">@@ -48,7 +48,7 @@</span>\n<span class=\"w\"> </span>      ⊢ Measurable ((partialSups (birkhoffSum f φ ∘ Nat.succ)) n ⊔ birkhoffSum f φ (n + 1 + 1))\n<span class=\"w\"> </span>  [aesop] Metadata\n<span class=\"w\"> </span>    [aesop] ID: 1\n<span class=\"gd\">-    [aesop] Pre-normalisation goal (_uniq.8202):</span>\n<span class=\"gi\">+    [aesop] Pre-normalisation goal (_uniq.66127):</span>\n<span class=\"w\"> </span>      [aesop] α : Type u_1\n<span class=\"w\"> </span>          inst : MeasurableSpace α\n<span class=\"w\"> </span>          f : α → α\n<span class=\"gu\">@@ -74,7 +74,7 @@</span>\n<span class=\"w\"> </span>      [aesop]\n<span class=\"w\"> </span>    [aesop] Unsafe rule queue: &lt;not selected&gt;\n<span class=\"w\"> </span>    [aesop] Failed rules: &lt;none&gt;\n<span class=\"gd\">-[aesop] ❌️ (G1) [100.0000%] ⋯ ⊢ Measurable ((partialSups (birkhoffSum f φ ∘ Nat.succ)) n ⊔ birkhoffSum f φ (n + 1 + 1))</span>\n<span class=\"gi\">+[aesop] ✅️ (G1) [100.0000%] ⋯ ⊢ Measurable ((partialSups (birkhoffSum f φ ∘ Nat.succ)) n ⊔ birkhoffSum f φ (n + 1 + 1))</span>\n<span class=\"w\"> </span>  [aesop] Initial goal:\n<span class=\"w\"> </span>        α : Type u_1\n<span class=\"w\"> </span>        inst : MeasurableSpace α\n<span class=\"gu\">@@ -88,6 +88,32 @@</span>\n<span class=\"w\"> </span>  [aesop] ✅️ Normalisation\n<span class=\"w\"> </span>    [aesop] ❌️ norm|tactic|global|Aesop.BuiltinRules.intros\n<span class=\"w\"> </span>      [aesop] nothing to introduce\n<span class=\"gi\">+    [aesop] ✅️ &lt;norm unfold&gt;</span>\n<span class=\"gi\">+      [aesop] α : Type u_1</span>\n<span class=\"gi\">+          inst : MeasurableSpace α</span>\n<span class=\"gi\">+          f : α → α</span>\n<span class=\"gi\">+          hf : Measurable f</span>\n<span class=\"gi\">+          φ : α → ℝ</span>\n<span class=\"gi\">+          hφ : Measurable φ</span>\n<span class=\"gi\">+          n : ℕ</span>\n<span class=\"gi\">+          a : Measurable ((birkhoffMax f φ) n)</span>\n<span class=\"gi\">+          ⊢ Measurable ((partialSups fun x ↦ birkhoffSum f φ x.succ) n ⊔ birkhoffSum f φ (n + 1 + 1))</span>\n<span class=\"gi\">+    [aesop] ❌️ norm|tactic|global|Aesop.BuiltinRules.intros</span>\n<span class=\"gi\">+      [aesop] nothing to introduce</span>\n<span class=\"gi\">+    [aesop] ❌️ &lt;norm unfold&gt;</span>\n<span class=\"gi\">+      [aesop] nothing to unfold</span>\n<span class=\"gi\">+    [aesop] ✅️ &lt;norm simp&gt;</span>\n<span class=\"gi\">+      [aesop] α : Type u_1</span>\n<span class=\"gi\">+          inst : MeasurableSpace α</span>\n<span class=\"gi\">+          f : α → α</span>\n<span class=\"gi\">+          hf : Measurable f</span>\n<span class=\"gi\">+          φ : α → ℝ</span>\n<span class=\"gi\">+          hφ : Measurable φ</span>\n<span class=\"gi\">+          n : ℕ</span>\n<span class=\"gi\">+          a : Measurable ((birkhoffMax f φ) n)</span>\n<span class=\"gi\">+          ⊢ Measurable ((partialSups fun x ↦ birkhoffSum f φ (x + 1)) n ⊔ birkhoffSum f φ (n + 1 + 1))</span>\n<span class=\"gi\">+    [aesop] ❌️ norm|tactic|global|Aesop.BuiltinRules.intros</span>\n<span class=\"gi\">+      [aesop] nothing to introduce</span>\n<span class=\"w\"> </span>    [aesop] ❌️ &lt;norm unfold&gt;\n<span class=\"w\"> </span>      [aesop] nothing to unfold\n<span class=\"w\"> </span>    [aesop] ❌️ &lt;norm simp&gt;\n<span class=\"gu\">@@ -101,8 +127,8 @@</span>\n<span class=\"w\"> </span>        hφ : Measurable φ\n<span class=\"w\"> </span>        n : ℕ\n<span class=\"w\"> </span>        a : Measurable ((birkhoffMax f φ) n)\n<span class=\"gd\">-        ⊢ Measurable ((partialSups (birkhoffSum f φ ∘ Nat.succ)) n ⊔ birkhoffSum f φ (n + 1 + 1))</span>\n<span class=\"gd\">-  [aesop] ❌️ Safe rules</span>\n<span class=\"gi\">+        ⊢ Measurable ((partialSups fun x ↦ birkhoffSum f φ (x + 1)) n ⊔ birkhoffSum f φ (n + 1 + 1))</span>\n<span class=\"gi\">+  [aesop] ✅️ Safe rules</span>\n<span class=\"w\"> </span>    [aesop] ❌️ safe|tactic|global|Aesop.BuiltinRules.assumption\n<span class=\"w\"> </span>      [aesop] Tactic `Aesop.BuiltinRules.assumption` failed: no matching assumption found\n</code></pre></div>",
        "id": 562768679,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1765305611
    },
    {
        "content": "<p>There is more to the <code>aesop</code> trace outputs, I truncated the diff to this first change because afterwards they both diverge considerably</p>",
        "id": 562770516,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1765306083
    },
    {
        "content": "<p>It is possible that <code>fun_prop</code> is slightly weaker than <code>aesop</code> in some cases when working with complicated functions.<br>\nIn <a href=\"https://github.com/leanprover-community/mathlib4/pull/30511\">#30511</a> there was also <a href=\"https://github.com/leanprover-community/mathlib4/pull/30511/files#r2465212501\">a lemma</a> that couldn't be tagged with <code>fun_prop</code> (that was formerly tagged with <code>measurability</code>).</p>\n<p>Can you try to use <code>aesop?</code> on the working version of your proof and just port that expanded proof to the latest <code>master</code> version? Hopefully that won't break. Then afterwards you can try to see which parts of the expanded proof can be automated by <code>fun_prop</code> (and potentially extract a MWE if <code>fun_prop</code> cannot do something that it should do - but maybe it's just a matter of tagging an extra lemma with <code>@[fun_prop]</code>).</p>",
        "id": 562771638,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1765306394
    },
    {
        "content": "<p>I can fix it, but I was trying to figure out what went wrong in the first place. Since in <a href=\"https://github.com/leanprover-community/mathlib4/pull/30511\">#30511</a> it seems that no proofs had to be fixed <span aria-label=\"confusion\" class=\"emoji emoji-1fae4\" role=\"img\" title=\"confusion\">:confusion:</span> </p>\n<p>I will try to find a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a></p>",
        "id": 562775784,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1765307480
    },
    {
        "content": "<p>Here is the full aesop trace diff for completeness </p>\n<p><a href=\"/user_uploads/3121/Ibf2wbr6jnJAzqgpf377-uQ0/aesop-diff.diff\">aesop-diff.diff</a></p>",
        "id": 562778719,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1765308303
    },
    {
        "content": "<p>The change was definitely not intended to be backwards compatible in all cases, just in most cases (which happens to include all Mathlib-proofs).<br>\nIt's probably more fruitful to answer the question \"how can we ensure that <code>fun_prop</code>(/<code>measurability</code>) can solve your goal on master\" than it is to answer \"what exactly is different now compared to what <code>aesop</code> used to do\" (though an answer to the second question can lead to an answer of the first one).</p>",
        "id": 562784352,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1765309843
    },
    {
        "content": "<p>Here is the <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measurable</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Measurable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">⊔</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">f</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measurable</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">measurability</span>\n</code></pre></div>\n<p>this works before <a href=\"https://github.com/leanprover-community/mathlib4/pull/30511\">#30511</a>, but doesn't afterwards.</p>",
        "id": 562786429,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1765310472
    },
    {
        "content": "<p>Can you add imports/variables etc to your <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a>?</p>",
        "id": 562786530,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1765310501
    },
    {
        "content": "<p>sorry, this example is not right.</p>",
        "id": 562787142,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1765310693
    },
    {
        "content": "<p>It might point at a weakness of <code>fun_prop</code> compared to <code>measurability</code>. This fails:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measurable</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Measurable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">⊔</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">f</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measurable</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">fun_prop</span>\n</code></pre></div>",
        "id": 562787459,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1765310804
    },
    {
        "content": "<p>Yes! that was what I found, so I thought that was the issue, but there is something more because <code>measurability</code> with <code>fun_prop</code> still works in this case</p>",
        "id": 562787881,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1765310939
    },
    {
        "content": "<p>I'm not sure if we want <code>fun_prop</code> to unfold let-definitions. Tactics like <code>simp</code> used to do that by default, but now also require explicit prompting to be unfolded.</p>",
        "id": 562787994,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1765310979
    },
    {
        "content": "<p>Is this important in your use case? Is it easy to rewrite your proof now that you know where the problem lies? It's a bit of an anti-pattern to use <code>let</code>, but also keep using the original definition (though in some cases that might be unavoidable)</p>",
        "id": 562788722,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1765311187
    },
    {
        "content": "<p>For example, this just avoids talking about <code>f</code> altogether (though that might not be as easily applicable in your example):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measurable</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Measurable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">⊔</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"c1\">-- `set` is like `let` that also replaces `f` with `s` everywhere</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measurable</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">fun_prop</span>\n</code></pre></div>",
        "id": 562789032,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1765311288
    },
    {
        "content": "<p>It's not, actually, debugging this made me realize the proper fix to the previous code in <a href=\"https://github.com/leanprover-community/mathlib4/pull/26923\">#26923</a>. Instead of</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">measurability</span><span class=\"kd\">]</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">birkhoffMax_measurable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measurable</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hφ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measurable</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measurable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">birkhoffMax</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">birkhoffMax</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">measurability</span>\n</code></pre></div>\n<p>it should have unfolded the definition before the induction:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">measurability</span><span class=\"kd\">]</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">birkhoffMax_measurable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measurable</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hφ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measurable</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measurable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">birkhoffMax</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">birkhoffMax</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">measurability</span>\n</code></pre></div>",
        "id": 562789251,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1765311345
    },
    {
        "content": "<p>That's where the problem appeared, because in the induction hypothesis, <code>birkhoffMax</code> was not unfolded (so <code>fun_prop</code> was not being able to use it)</p>",
        "id": 562789875,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1765311505
    }
]