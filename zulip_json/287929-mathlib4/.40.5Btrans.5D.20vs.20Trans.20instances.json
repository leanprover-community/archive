[
    {
        "content": "<p>In light of<br>\n<span class=\"user-mention silent\" data-user-id=\"479299\">Jovan Gerbscheid</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Order.20dual.20tactic/near/513589618\">said</a>:</p>\n<blockquote>\n<p>But first I have <a href=\"https://github.com/leanprover-community/mathlib4/pull/24277\">#24277</a> to remove some <code>@[trans]</code> annotations.</p>\n</blockquote>\n<p>should we deprecate the <code>@[trans]</code> attribute from Batteries? Or should it be rewritten to generate the <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Trans#doc\">docs#Trans</a> instance automatically, and remain the preferred spelling?</p>",
        "id": 519625088,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1747837172
    },
    {
        "content": "<p>To be clear, currently <code>@[trans]</code> is only used by the <code>trans</code> tactic. the <code>Trans</code> type class is used more widely, like in the <code>calc</code> tactic, but it's also used by the <code>trans</code> tactic. This makes <code>@[trans]</code> in principle irrelevant. It would be nicer if we had just one backend (being the <code>Trans</code> type class).</p>",
        "id": 519634483,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1747839346
    },
    {
        "content": "<p>I assume we have a lemma tagged @[trans] somewhere that uses Trans?</p>",
        "id": 519640495,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1747840716
    },
    {
        "content": "<p>No, the <code>trans</code> tactic has built-in support for the lemmas <code>Trans.simple</code>, <code>Trans.trans</code> and <code>HEq.trans</code></p>",
        "id": 519642223,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1747841172
    },
    {
        "content": "<p>If we can make <code>@[trans]</code> generate a <code>Trans</code> instance, that sounds sensible</p>",
        "id": 519679482,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1747853140
    },
    {
        "content": "<p>The <code>trans</code> tactic has a special feature where it supports relations that have implicit arguments between or after the two explicit arguments. But I don't know if this is actually used (or how well it works)</p>",
        "id": 519680430,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1747853465
    },
    {
        "content": "<p>That should mean it works for MulEquiv?</p>",
        "id": 519681173,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1747853753
    },
    {
        "content": "<p>That's the idea, but it doesn't seem to work when I try it:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">â‰ƒ*</span><span class=\"w\"> </span><span class=\"n\">Rat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span>\n<span class=\"cm\">  transitivity lemmas only apply to binary relations and non-dependent arrows, not</span>\n<span class=\"cm\">  â„• â‰ƒ* â„š</span>\n<span class=\"cm\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">Int</span>\n</code></pre></div>",
        "id": 519690320,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1747857041
    },
    {
        "content": "<p>Anyways, for both <code>trans</code> and <code>calc</code> we want to be able to work more generally than just relations that take the two arguments in order, because:</p>\n<ul>\n<li><code>âˆˆ</code> has its arguments swapped</li>\n<li><code>â‰ƒ*</code> has the extra <code>[Mul M]</code> arguments</li>\n</ul>\n<p>I think both can be solved using the <code>HTrans</code> type class suggested by <span class=\"user-mention\" data-user-id=\"214703\">@Yury G. Kudryashov</span> in <a href=\"https://github.com/leanprover/lean4/pull/2217\">lean#2217</a>.</p>",
        "id": 519691689,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1747857570
    },
    {
        "content": "<p>Re calc and relations, we have the P-low <a href=\"https://github.com/leanprover/lean4/pull/2217\">lean#2217</a></p>",
        "id": 519693724,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1747858293
    },
    {
        "content": "<p>That's the issue I linked to :)</p>",
        "id": 519697964,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1747860007
    },
    {
        "content": "<p>Another kind of relation that would make sense to use in <code>calc</code> is the negation of another relation:</p>\n<ul>\n<li><code>a âˆ‰ A âŠƒ B</code> proves <code>a âˆ‰ B</code></li>\n<li><code>x â‰¥ y â‰® z</code> proves <code>x â‰® z</code></li>\n</ul>\n<p>Would it also be useful for <code>gcongr</code> and the future <code>grw</code> tactic to be able to deal with relations that aren't directly of the form <code>r a b</code>?</p>",
        "id": 520907102,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1748442559
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479299\">Jovan Gerbscheid</span> <a href=\"#narrow/channel/287929-mathlib4/topic/.40.5Btrans.5D.20vs.20Trans.20instances/near/520907102\">said</a>:</p>\n<blockquote>\n<ul>\n<li><code>a âˆ‰ A âŠƒ B</code> proves <code>a âˆ‰ B</code></li>\n<li><code>x â‰¥ y â‰® z</code> proves <code>x â‰® z</code></li>\n</ul>\n</blockquote>\n<p>Personally, I don't want to see that. It's hard to read if the chain has any nontrivial length, because you have to find the <em>one</em> negation in the middle of an otherwise lengthy calculation instead of just looking at the ends.</p>",
        "id": 520916855,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1748445035
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479299\">Jovan Gerbscheid</span> <a href=\"#narrow/channel/287929-mathlib4/topic/.40.5Btrans.5D.20vs.20Trans.20instances/near/520907102\">said</a>:</p>\n<blockquote>\n<p>Would it also be useful for <code>gcongr</code> and the future <code>grw</code> tactic to be able to deal with relations that aren't directly of the form <code>r a b</code></p>\n</blockquote>\n<p>I think it depends on what you mean here. <code>gcongr</code> is built this way for performance reasons. I outlined a modest extension of <code>gcongr</code> which would solve some goals that are not quite of that form <a href=\"#narrow/channel/113488-general/topic/.22Missing.20Tactics.22.20list/near/516741394\">#general &gt; \"Missing Tactics\" list @ ðŸ’¬</a></p>",
        "id": 520917120,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1748445121
    },
    {
        "content": "<p>In that example, you're using the relation <code>a â‰¤ b</code>, which is of the form <code>r a b</code>. I meant situations like <code>a â‰ƒ* b</code> where there are extra type class assumptions. (or <code>âˆˆ</code>, which has swapped arguments).</p>",
        "id": 520919216,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1748445763
    }
]