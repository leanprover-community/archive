[
    {
        "content": "<p>Mathlib has <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PontryaginDual#doc\">docs#PontryaginDual</a> , the dual of a topological abelian (multiplicative) group, defined as the <code>ContinuousMonoidHom</code>s to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=circle#doc\">docs#circle</a>. But Tate's thesis is full of additive Pontryagin duals and the file hasn't been to_additivised. </p>\n<p>There are several definitions of additive Pontryagin dual of <code>A</code> which spring to mind. Firstly we could definite as <code>Additive (PontryaginDual (Multiplicative A))</code> which looks like a nightmare. Secondly we could define <code>ContinuousAddChar</code> and still use <code>circle</code>. But probably the most sensible approach (do others agree?) is to just use <code>ContinuousAddMonoidHom</code>s to an additive version of <code>circle</code>, which will either be <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"double-struck\">Z</mi></mrow><annotation encoding=\"application/x-tex\">\\R/\\Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mord\">/</span><span class=\"mord mathbb\">Z</span></span></span></span> or <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi><mi mathvariant=\"normal\">/</mi><mn>2</mn><mi>π</mi><mi>i</mi><mi mathvariant=\"double-struck\">Z</mi></mrow><annotation encoding=\"application/x-tex\">\\R/2\\pi i\\Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mord\">/2</span><span class=\"mord mathnormal\">πi</span><span class=\"mord mathbb\">Z</span></span></span></span> (this is a design decision which might need some thought, I'm not sure). I'm hoping that with this choice, <code>to_additive</code> will leap into action and will keep the multiplicative and additive theory of Pontryagin duals aligned. But right now <code>AddCircle (1 : \\R)</code> is defined as a quotient, whereas <code>circle</code> is defined as a submonoid of the complexes. Is this going to be an issue with <code>to_additive</code>?</p>",
        "id": 449045413,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1720085785
    },
    {
        "content": "<p>Yes, this is going to be an issue.</p>",
        "id": 449046285,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1720086103
    },
    {
        "content": "<p>Multiplicative and additive definitions should at least have the same number of arguments, and ideally also in the same order. <code>circle</code> and <code>AddCircle</code> do not satisfy this. They also have very different types.</p>",
        "id": 449046567,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1720086182
    },
    {
        "content": "<p>Can we made some definition <code>addCircle</code> which will solve this problem?</p>",
        "id": 449047015,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1720086367
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AddCircle#doc\">docs#AddCircle</a> looks like something we can multiplicativize, i.e. define <code>MulCircle</code> and make <code>AddCircle</code> the additive version of it. If we then move to always use <code>MulCircle</code>/<code>AddCircle</code> (and not <code>circle</code>) we can keep the additive and multiplicative developments parallel.</p>",
        "id": 449047081,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1720086405
    },
    {
        "content": "<p>Though that doesn't help once you instantiate <code>AddCircle</code> to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"double-struck\">Z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}/\\mathbb{Z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mord\">/</span><span class=\"mord mathbb\">Z</span></span></span></span>...</p>",
        "id": 449047176,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1720086454
    },
    {
        "content": "<p>We can also try to define <code>AddPontryaginDual</code> using <code>AddCircle</code>, and then manually prove a bunch of parallel lemmas about <code>AddPontryaginDual</code> and <code>PontryaginDual</code>, and align them with <code>@[to_additive]</code>. In that case, <code>to_additive</code> will be able to translate everything afterwards that doesn't use the definition of <code>PontryaginDual</code> (and it will break badly on everything that does).</p>",
        "id": 449047756,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1720086670
    },
    {
        "content": "<p>But that probably doesn't work: you want to keep using that it is defined as <code>ContinuousMonoidHom</code>... Maybe we can try to push the opaqueness one level deeper: define <code>NewMulCircle</code> and <code>NewAddCircle</code>, both types without arguments, prove some parallel API about them, and then let <code>to_additive</code> translate anything that doesn't unfold those types...<br>\nProbably still not ideal, but maybe workable?</p>",
        "id": 449048262,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1720086857
    },
    {
        "content": "<p>I mentioned these ideas to the student (<span class=\"user-mention\" data-user-id=\"681667\">@Dawid Lipinski</span> ) and he pointed out that he wants to use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Fourier.fourierIntegral#doc\">docs#Fourier.fourierIntegral</a> which has <code>AddChar</code> embedded in it :-/ I'm now wondering if we just can't avoid a bunch of boilerplate here.</p>",
        "id": 449838992,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1720436967
    },
    {
        "content": "<p>I think we have to have <code>circle</code> as-is for complex analysis, by the way.</p>",
        "id": 449849433,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1720440512
    },
    {
        "content": "<p>I wonder if a useful approach here might be not to work relative to a concrete object such as <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AddCircle#doc\">docs#AddCircle</a> or <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=circle#doc\">docs#circle</a> but to any object with the right properties.</p>",
        "id": 449953571,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1720464442
    },
    {
        "content": "<p>The circle is the unique 1-dimensional connected, compact, commutative, Lie group. We don't want to bring calculus in here so we can't use this characterisation but surely there is a convenient non-analytical characterisation.</p>",
        "id": 449954174,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1720464637
    },
    {
        "content": "<p>The idea then would be to define:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PontryaginDual'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Monoid</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">CommGroup</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalGroup</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">CompactSpace</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ConnectedSpace</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"c\">/-</span><span class=\"cm\"> what else: how to we say 1-dimensional? -/</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">ContinuousMonoidHom</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">C</span>\n</code></pre></div>",
        "id": 449954223,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1720464666
    },
    {
        "content": "<p>Sadly I had only a minute so I must now run but I will try to write more tomorrow evening if I have time.</p>",
        "id": 449954313,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1720464702
    },
    {
        "content": "<p>What would be the advantage of writing <code>PontryaginDual' G circle</code> over <code>ContinuousMonoidHom G circle</code>? In theory we could just toadditivize <code>ContinuousMonoidHom</code> and state everything in terms of <code>ContinuousMonoidHom</code> with the typeclass assumptions that you're describing.</p>",
        "id": 450065135,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1720502326
    }
]