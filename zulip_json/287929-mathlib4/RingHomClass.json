[
    {
        "content": "<p>Should <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/Localization/AtPrime/Basic.html#Localization.localRingHom\">Localization.localRingHom</a> take a RingHomClass?</p>",
        "id": 553398298,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762180967
    },
    {
        "content": "<p>no</p>",
        "id": 553400269,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762181461
    },
    {
        "content": "<p>and <code>Ideal.comap</code> should not take a <code>RingHomClass</code></p>",
        "id": 553400382,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762181486
    },
    {
        "content": "<p>it should take a plain <code>RingHom</code></p>",
        "id": 553400439,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762181499
    },
    {
        "content": "<p>but you could comap a RingEquiv</p>",
        "id": 553400482,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762181510
    },
    {
        "content": "<p>and then you need a lemma <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Ideal.comap_coe#doc\">docs#Ideal.comap_coe</a></p>",
        "id": 553400815,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762181580
    },
    {
        "content": "<p>and you need to use it backwards <del>sometimes</del> often</p>",
        "id": 553400908,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762181603
    },
    {
        "content": "<p>but you would need to coerce it a lof of times</p>",
        "id": 553401273,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762181697
    },
    {
        "content": "<p>I can't seem to find the corresponding lemma for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Ideal.map#doc\">docs#Ideal.map</a></p>",
        "id": 553401296,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762181703
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/Ideal/Maps.html#Ideal.map_coe\">Ideal.map_coe</a></p>",
        "id": 553401373,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762181721
    },
    {
        "content": "<p>and we have stuff like <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Ideal.map_comap_of_equiv#doc\">docs#Ideal.map_comap_of_equiv</a></p>",
        "id": 553401516,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762181753
    },
    {
        "content": "<p>it's stated for the coe on the one side and not coe on the other side</p>",
        "id": 553401607,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762181772
    },
    {
        "content": "<p>it's probably better to be consistent and have it all coe all the time</p>",
        "id": 553401700,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762181796
    },
    {
        "content": "<p>I see we haven't picked a simpNF too</p>",
        "id": 553401733,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762181804
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/RingHomClass/near/553401373\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/Ideal/Maps.html#Ideal.map_coe\">Ideal.map_coe</a></p>\n</blockquote>\n<p>that's stated for a <code>RingHomClass</code> what if I don't have a <code>RingHomClass</code></p>",
        "id": 553401989,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762181865
    },
    {
        "content": "<p>I don't understand</p>",
        "id": 553402335,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762181942
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Semiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Ideal</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">I</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">castAddMonoidHom</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">castRingHom</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- is there a better way</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 553403060,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762182083
    },
    {
        "content": "<p>oh, I didn't know <a href=\"http://Ideal.map\">Ideal.map</a> takes FunLike...</p>",
        "id": 553403222,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762182124
    },
    {
        "content": "<p>perhaps it should only take RingHomClass?</p>",
        "id": 553403271,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762182136
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> back me up here</p>",
        "id": 553404273,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762182312
    },
    {
        "content": "<p>The rule of thumb is that definitions shouldn't take <code>*HomClass</code>. We don't want <code>ker f</code> and <code>ker f.toRingHom</code> to be different things.</p>",
        "id": 553404987,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1762182466
    },
    {
        "content": "<p>by that do you include Prop?</p>",
        "id": 553405181,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762182511
    },
    {
        "content": "<p>such as <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/Finiteness/Defs.html#RingHom.Finite\">RingHom.Finite</a> (which currently takes <code>RingHom</code>)</p>",
        "id": 553405313,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762182542
    },
    {
        "content": "<p>For example <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsLocalHom#doc\">docs#IsLocalHom</a> is bad, as <code>IsLocalHom f</code> and <code>IsLocalHom f.toRingHom</code> isn't even defeq.</p>",
        "id": 553405465,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1762182580
    },
    {
        "content": "<p>what should it take then?</p>",
        "id": 553405622,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762182615
    },
    {
        "content": "<p>a plain function?</p>",
        "id": 553405834,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762182664
    },
    {
        "content": "<p>what's the weakest context this is interesting in?</p>",
        "id": 553405934,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762182689
    },
    {
        "content": "<p>maybe a monoid hom?</p>",
        "id": 553405952,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762182694
    },
    {
        "content": "<p>I thought functions are bad</p>",
        "id": 553405966,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762182698
    },
    {
        "content": "<p>yeah, but it's \"intended\" to be used with ring homs</p>",
        "id": 553406015,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762182709
    },
    {
        "content": "<p>Probably a plain function in this case. See <a href=\"https://github.com/leanprover-community/mathlib4/pull/24965\">#24965</a></p>",
        "id": 553406028,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1762182713
    },
    {
        "content": "<p>I thought functions are difficult to unify</p>",
        "id": 553406158,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762182745
    },
    {
        "content": "<p>what does that mean?</p>",
        "id": 553406197,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762182759
    },
    {
        "content": "<p>are you talking about higher order unification?</p>",
        "id": 553406226,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762182770
    },
    {
        "content": "<p>I'm talking about how we moved away from <code>IsRingHom f</code></p>",
        "id": 553406271,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762182784
    },
    {
        "content": "<p>oh that's for when you're applying them in lemmas</p>",
        "id": 553406356,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762182810
    },
    {
        "content": "<p>are there lemmas that work for <code>IsLocalHom f</code> even if <code>f</code> is a plain function?</p>",
        "id": 553406483,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762182840
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Group/Units/Hom.html#isUnit_of_map_unit\">isUnit_of_map_unit</a>, basically the one in its definition</p>",
        "id": 553406556,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762182857
    },
    {
        "content": "<p>so only one</p>",
        "id": 553406603,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762182867
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Group/Units/Hom.html#isUnit_map_iff\">isUnit_map_iff</a></p>",
        "id": 553406677,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762182880
    },
    {
        "content": "<p>then that one lemma might have trouble unifying</p>",
        "id": 553406695,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762182884
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Group/Irreducible/Lemmas.html#Irreducible.of_map\">Irreducible.of_map</a></p>",
        "id": 553406745,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762182897
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/RingHomClass/near/553406677\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Group/Units/Hom.html#isUnit_map_iff\">isUnit_map_iff</a></p>\n</blockquote>\n<p><code>MonoidHomClass</code> not plain function</p>",
        "id": 553406778,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762182903
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/RingHomClass/near/553406745\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Group/Irreducible/Lemmas.html#Irreducible.of_map\">Irreducible.of_map</a></p>\n</blockquote>\n<p>(same as above) <code>MonoidHomClass</code></p>",
        "id": 553406878,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762182925
    },
    {
        "content": "<p>I'm starting to think it should take a <code>MonoidHom</code></p>",
        "id": 553406972,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762182948
    },
    {
        "content": "<p>but do they not suffer from the same problem?</p>",
        "id": 553406983,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762182950
    },
    {
        "content": "<p>I still think it should take RingHom</p>",
        "id": 553407061,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762182967
    },
    {
        "content": "<p>at the cost of some lemmas not being in the \"maximum generality\"</p>",
        "id": 553407135,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762182986
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/RingHomClass/near/553406983\">said</a>:</p>\n<blockquote>\n<p>but do they not suffer from the same problem?</p>\n</blockquote>\n<p>well it's a <code>MonoidHomClass</code> therefore not a plain function, so no, it doesn't have the same problem</p>",
        "id": 553407200,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762183001
    },
    {
        "content": "<p>the problem only applies to plain functions given as <code>fun x =&gt; ...</code></p>",
        "id": 553407336,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762183030
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/287929-mathlib4/topic/RingHomClass/near/553407200\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/RingHomClass/near/553406983\">said</a>:</p>\n<blockquote>\n<p>but do they not suffer from the same problem?</p>\n</blockquote>\n<p>well it's a <code>MonoidHomClass</code> therefore not a plain function, so no, it doesn't have the same problem</p>\n</blockquote>\n<p>if you use <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Group/Irreducible/Lemmas.html#Irreducible.of_map\">Irreducible.of_map</a> and you try to prove <code>x</code> is irreducible, then you apply this lemma, then Lean has to solve <code>Irreducible (?f x)</code></p>",
        "id": 553407406,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762183044
    },
    {
        "content": "<p>no, Lean has to solve <code>Irreducible (DFunLike.coe ?f x)</code></p>",
        "id": 553407517,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762183065
    },
    {
        "content": "<p>aha! ok that makes sense</p>",
        "id": 553407565,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762183079
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Algebra/Equiv.html#AlgEquiv.ofBijective\">AlgEquiv.ofBijective</a> takes <code>A₁ →ₐ[R] A₂</code> while <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Ring/Equiv.html#RingEquiv.ofBijective\">RingEquiv.ofBijective</a> takes <code>NonUnitalRingHomClass F R S</code>; which one is correct?</p>",
        "id": 553430273,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762188196
    },
    {
        "content": "<p><code>AlgEquiv.ofBijective</code> is correct</p>",
        "id": 553430396,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762188236
    },
    {
        "content": "<p>since you're making data</p>",
        "id": 553430478,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762188265
    },
    {
        "content": "<p>but I would say that this is a case where you don't need to be concerned about equality / lemma since for this case you probably just want the equiv? as in you just use this as auxiliary</p>",
        "id": 553430805,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762188359
    },
    {
        "content": "<p>I would argue that the non-API results that show up in the search above are actually wrong</p>",
        "id": 553431378,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762188524
    },
    {
        "content": "<p><code>.ofBijective</code> is not meant to be any simp NF</p>",
        "id": 553431412,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762188533
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/RingHomClass/near/553430805\">said</a>:</p>\n<blockquote>\n<p>but I would say that this is a case where you don't need to be concerned about equality / lemma since for this case you probably just want the equiv? as in you just use this as auxiliary</p>\n</blockquote>\n<p>what do you mean by this?</p>",
        "id": 553432130,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762188744
    },
    {
        "content": "<p>it is not simp NF, so it does not matter that you have two ways of writing like .ofBijective f vs. .ofBijective \\u f</p>",
        "id": 553432330,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762188799
    },
    {
        "content": "<p>its use is to construct new equivs, and then those new equivs are the simpNFs</p>",
        "id": 553432429,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762188828
    },
    {
        "content": "<p>you still run into the problem of <code>.ofBijective f ⋯</code> and <code>.ofBijective f.toRingHom ⋯</code> being different</p>",
        "id": 553432597,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762188882
    },
    {
        "content": "<p>that is fine, because neither is simpNF</p>",
        "id": 553432731,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762188923
    },
    {
        "content": "<p>but you will still sometimes have to convert between them</p>",
        "id": 553432802,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762188945
    },
    {
        "content": "<p>lemme put more pseudocode to make my point clearer:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AlgHom</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">fooEquiv1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RingEquiv</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofBijective</span><span class=\"w\"> </span><span class=\"n\">foo</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">fooEquiv2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RingEquiv</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofBijective</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">\\</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>in this code, fooEquiv1 and fooEquiv2 might not be defeq (i suspect they could be), but that's fine because the simpNF of <code>fooEquiv[12] x</code> is actually <code>foo x</code></p>",
        "id": 553432897,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762188970
    },
    {
        "content": "<p>I don't see the lemma that lets me do this</p>",
        "id": 553432905,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762188971
    },
    {
        "content": "<p>and I argue that this is the only intended use case of .ofBijective</p>",
        "id": 553433183,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762189051
    },
    {
        "content": "<p>I have an example for you too</p>",
        "id": 553433277,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762189081
    },
    {
        "content": "<p>I guess making it take just a <code>NonUnitalRingHom</code> doesn't really solve this problem but</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RingHom</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">fooAlgHom</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AlgHom</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"n\">toRingHom_fooAlgHom</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">fooRingEquiv</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RingEquiv</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofBijective</span><span class=\"w\"> </span><span class=\"n\">fooAlgHom</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo_bar</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Bar</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"bp\">...</span>\n<span class=\"w\">  </span><span class=\"c1\">-- goal is something complicated containing `fooAlgHom (fooRingEquiv.symm x)`</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">fooRingEquiv</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"c1\">-- goal now contains `foo ((RingEquiv.ofBijective fooAlgHom ...).symm x)`</span>\n<span class=\"w\">  </span><span class=\"c1\">-- which doesn't simplify</span>\n</code></pre></div>",
        "id": 553434865,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762189435
    },
    {
        "content": "<p>you've done something wrong as soon as you see ofBijective in the goal</p>",
        "id": 553435130,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762189517
    },
    {
        "content": "<p>what's wrong with unfolding your definitions while you prove theorems about them</p>",
        "id": 553435267,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762189556
    },
    {
        "content": "<p>why would you need to unfold fooRingEquiv?</p>\n<ol>\n<li>\"I need to use the fact that it's a ring equiv\": it's a ring equiv already</li>\n<li>\"I need to simplify its application\": that's given by <code>foo x</code></li>\n</ol>",
        "id": 553435437,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762189606
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/RingHomClass/near/553435437\">said</a>:</p>\n<blockquote>\n<ol start=\"2\">\n<li>\"I need to simplify its application\": that's given by <code>foo x</code></li>\n</ol>\n</blockquote>\n<p>I don't understand what you mean?</p>",
        "id": 553435526,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762189637
    },
    {
        "content": "<p>the simpNF of <code>fooRingEquiv x</code> is <code>foo x</code>, and any property you need can be derived there</p>",
        "id": 553435604,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762189661
    },
    {
        "content": "<p>it's symm</p>",
        "id": 553435619,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762189667
    },
    {
        "content": "<p><code>fooRingEquiv.symm x</code> is the simpNF, you gain nothing by unfolding it into ofBijective, because you can't write down its inverse anyway</p>",
        "id": 553435717,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762189697
    },
    {
        "content": "<p>I guess with the <code>ofBijective</code> constructors they would reduce to <code>Equiv.ofBijective</code></p>",
        "id": 553435745,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762189705
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/RingHomClass/near/553435717\">said</a>:</p>\n<blockquote>\n<p><code>fooRingEquiv.symm x</code> is the simpNF, you gain nothing by unfolding it into ofBijective, because you can't write down its inverse anyway</p>\n</blockquote>\n<p>want to cancel it with a <code>foo</code></p>",
        "id": 553435785,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762189720
    },
    {
        "content": "<p>I guess this example is a bit contrived</p>",
        "id": 553435863,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762189750
    },
    {
        "content": "<p>we need the API that it cancels with <code>foo</code> then...</p>",
        "id": 553435872,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762189752
    },
    {
        "content": "<p>but the idea is there</p>",
        "id": 553435892,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762189761
    },
    {
        "content": "<p>which again goes back to the hom_lemmas proposal</p>",
        "id": 553435893,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762189761
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/RingHomClass/near/553435872\">said</a>:</p>\n<blockquote>\n<p>we need the API that it cancels with <code>foo</code> then...</p>\n</blockquote>\n<p>and if you want to apply functions to it, that's another proposal that has been discussed (similar to reassoc)</p>",
        "id": 553435958,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762189784
    },
    {
        "content": "<p>ofBijective is never part of the (end result of the) API</p>",
        "id": 553436101,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762189830
    },
    {
        "content": "<p>I don't want to come up with another more complicated example that addresses all your points</p>",
        "id": 553436322,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762189902
    },
    {
        "content": "<p>what's the benefit you're getting from making it take a <code>FunLike</code>?</p>",
        "id": 553436481,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762189956
    },
    {
        "content": "<p>hmm, good point</p>",
        "id": 553436600,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762189994
    },
    {
        "content": "<p>yeah there's no need to take anything in a higher hierarchy because at that point you would just use a higher ofBijective</p>",
        "id": 553436650,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762190017
    },
    {
        "content": "<p>so, we need to fix:</p>\n<ul>\n<li>RingHom.ker</li>\n<li><code>Ideal.map</code></li>\n<li>Ideal.comap</li>\n<li>RingEquiv.ofHomInv</li>\n<li>Ideal.mapHom</li>\n<li>Ideal.orderEmbeddingOfSurjective</li>\n<li>Ideal.relIsoOfBijective</li>\n<li>Ideal.giMapComap</li>\n<li>Ideal.relIsoOfSurjective</li>\n<li>DirectLimit.Ring.of ?</li>\n<li>DirectLimit.Ring.lift ?</li>\n<li>RatFunc.mapRingHom</li>\n</ul>",
        "id": 553438549,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762190594
    },
    {
        "content": "<p>is this only the <code>RingHom</code>s?</p>",
        "id": 553439033,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762190727
    },
    {
        "content": "<p>for example, I don't see <code>LinearMap.ker</code> on here</p>",
        "id": 553439182,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762190764
    },
    {
        "content": "<p>it's not all, i only did RingHomClass</p>",
        "id": 553439227,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762190778
    },
    {
        "content": "<p><a href=\"https://loogle.lean-lang.org/?q=RingHom.codRestrict\">https://loogle.lean-lang.org/?q=RingHom.codRestrict</a></p>\n<p>RingHom.codRestrict <span aria-label=\"clipboard\" class=\"emoji emoji-1f4cb\" role=\"img\" title=\"clipboard\">:clipboard:</span> Mathlib.Algebra.Ring.Subsemiring.Basic<br>\n{R : Type u} {S : Type v} [NonAssocSemiring R] [NonAssocSemiring S] {σS : Type u_2} [SetLike σS S] [SubsemiringClass σS S] (f : R →+* S) (s : σS) (h : ∀ (x : R), f x ∈ s) : R →+* ↥s</p>\n<p>Should this take Subsemiring instead of class?</p>",
        "id": 554345121,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762528151
    },
    {
        "content": "<p>Also, should we consider this a consensus that with definitions we prefer e.g. RingHom over e.g. RingHomClass? And then we can reference this consensus in future PR's?</p>",
        "id": 554367382,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762533800
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110064\">@Kenny Lau</span> and <span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> : I at some point promised this to you: <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/Mathlib.27s.20morphism.20hierarchy/with/554384548\">#mathlib4 &gt; Mathlib's morphism hierarchy</a></p>",
        "id": 554384861,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1762538429
    }
]