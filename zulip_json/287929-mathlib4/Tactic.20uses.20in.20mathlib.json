[
    {
        "content": "<p>I wrote a script to count the number of tactic uses in Mathlib.</p>\n<p>Script:</p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"c1\"># Put me in a folder inside mathlib.</span>\n<span class=\"c1\"># Hard-coded tactic list in tactics.txt generated with:</span>\n<span class=\"sd\">\"\"\"</span>\n<span class=\"sd\">import Mathlib</span>\n\n<span class=\"sd\">#help tactic</span>\n<span class=\"sd\">\"\"\"</span>\n\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">re</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">os</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">sys</span>\n\n<span class=\"n\">tacticRegex</span> <span class=\"o\">=</span> <span class=\"s2\">\"(?&lt;= )[a-zA-Z0-9_]+['!?₁₂]*(?= |</span><span class=\"se\">\\n</span><span class=\"s2\">)\"</span>\n\n<span class=\"n\">tactics</span> <span class=\"o\">=</span> <span class=\"nb\">dict</span><span class=\"p\">()</span>\n<span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s2\">\"tactics.txt\"</span><span class=\"p\">,</span> <span class=\"s2\">\"r\"</span><span class=\"p\">,</span> <span class=\"n\">encoding</span><span class=\"o\">=</span><span class=\"s2\">\"UTF-8\"</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">auto</span><span class=\"p\">:</span>\n    <span class=\"k\">for</span> <span class=\"n\">line</span> <span class=\"ow\">in</span> <span class=\"n\">auto</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">split</span><span class=\"p\">(</span><span class=\"s2\">\"</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span><span class=\"p\">):</span>\n        <span class=\"n\">tactics</span><span class=\"p\">[</span><span class=\"n\">line</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">process</span><span class=\"p\">(</span><span class=\"n\">filename</span><span class=\"p\">,</span> <span class=\"n\">file</span><span class=\"p\">):</span>\n    <span class=\"k\">for</span> <span class=\"n\">potential</span> <span class=\"ow\">in</span> <span class=\"n\">re</span><span class=\"o\">.</span><span class=\"n\">findall</span><span class=\"p\">(</span><span class=\"n\">tacticRegex</span><span class=\"p\">,</span> <span class=\"n\">file</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"n\">potential</span> <span class=\"ow\">in</span> <span class=\"n\">tactics</span><span class=\"p\">:</span>\n            <span class=\"n\">tactics</span><span class=\"p\">[</span><span class=\"n\">potential</span><span class=\"p\">]</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n\n<span class=\"n\">fileCount</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n<span class=\"k\">for</span> <span class=\"n\">root</span><span class=\"p\">,</span> <span class=\"n\">dirs</span><span class=\"p\">,</span> <span class=\"n\">files</span> <span class=\"ow\">in</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">walk</span><span class=\"p\">(</span><span class=\"s1\">'../Mathlib'</span><span class=\"p\">):</span>\n    <span class=\"k\">for</span> <span class=\"n\">file</span> <span class=\"ow\">in</span> <span class=\"n\">files</span><span class=\"p\">:</span>\n        <span class=\"n\">filename</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">root</span><span class=\"p\">,</span> <span class=\"n\">file</span><span class=\"p\">)</span>\n        <span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"n\">filename</span><span class=\"p\">,</span> <span class=\"s2\">\"r\"</span><span class=\"p\">,</span> <span class=\"n\">encoding</span><span class=\"o\">=</span><span class=\"s2\">\"UTF-8\"</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">auto</span><span class=\"p\">:</span>\n            <span class=\"n\">fileCount</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n            <span class=\"k\">if</span> <span class=\"n\">fileCount</span> <span class=\"o\">%</span> <span class=\"mi\">100</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">stdout</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">(</span><span class=\"s2\">\"</span><span class=\"se\">\\r</span><span class=\"si\">%d</span><span class=\"s2\"> files processed.\"</span><span class=\"o\">%</span><span class=\"n\">fileCount</span><span class=\"p\">)</span>\n                <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">stdout</span><span class=\"o\">.</span><span class=\"n\">flush</span><span class=\"p\">()</span>\n            <span class=\"n\">process</span><span class=\"p\">(</span><span class=\"n\">filename</span><span class=\"p\">,</span> <span class=\"n\">auto</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">())</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"</span><span class=\"se\">\\r</span><span class=\"si\">%d</span><span class=\"s2\"> files processed.\"</span> <span class=\"o\">%</span> <span class=\"n\">fileCount</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Number of recognised tactics: </span><span class=\"si\">%d</span><span class=\"s2\">\"</span><span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">tactics</span><span class=\"o\">.</span><span class=\"n\">keys</span><span class=\"p\">()))</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"</span><span class=\"si\">%d</span><span class=\"s2\"> tactic calls processed.\"</span> <span class=\"o\">%</span> <span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">tactics</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">tactics</span><span class=\"p\">))</span>\n<span class=\"nb\">print</span><span class=\"p\">()</span>\n\n<span class=\"n\">keys</span> <span class=\"o\">=</span> <span class=\"nb\">sorted</span><span class=\"p\">(</span><span class=\"n\">tactics</span><span class=\"o\">.</span><span class=\"n\">keys</span><span class=\"p\">(),</span> <span class=\"n\">key</span><span class=\"o\">=</span><span class=\"k\">lambda</span> <span class=\"n\">i</span><span class=\"p\">:</span><span class=\"n\">tactics</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">],</span> <span class=\"n\">reverse</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n<span class=\"k\">for</span> <span class=\"n\">t</span> <span class=\"ow\">in</span> <span class=\"n\">keys</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"</span><span class=\"si\">%d</span><span class=\"s2\">: </span><span class=\"si\">%s</span><span class=\"s2\">\"</span><span class=\"o\">%</span><span class=\"p\">(</span><span class=\"n\">tactics</span><span class=\"p\">[</span><span class=\"n\">t</span><span class=\"p\">],</span><span class=\"n\">t</span><span class=\"p\">))</span>\n</code></pre></div>",
        "id": 528397307,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752262907
    },
    {
        "content": "<p>Full output:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>6616 files processed.\nNumber of recognised tactics: 475\n511237 tactic calls processed.\n\n73107: rw\n57481: simp\n46826: exact\n33592: have\n30528: rfl\n20869: refine\n17766: apply\n16243: let\n13406: obtain\n13133: simpa\n12929: intro\n10718: ext\n7851: set\n7847: rintro\n7839: rcases\n7377: simp_rw\n5124: dsimp\n4976: use\n4719: cases\n4340: ring\n4334: rwa\n4186: by_cases\n3817: convert\n3758: else\n3553: induction\n3511: constructor\n3291: show\n3015: suffices\n2946: group\n2781: calc\n2697: congr\n2688: change\n2598: left\n2574: classical\n2398: order\n2368: right\n2313: haveI\n2126: case\n2090: lift\n2045: infer_instance\n2031: letI\n2000: open\n1862: match\n1646: filter_upwards\n1632: replace\n1597: first\n1364: funext\n1322: exists\n1311: module\n1254: split_ifs\n1181: subst\n1073: aesop\n1026: gcongr\n938: unfold\n934: trivial\n872: assumption\n858: choose\n847: simp_all\n817: contrapose!\n816: bound\n811: erw\n787: ext1\n786: intros\n766: omega\n757: monoidal\n736: aesop_cat\n680: linarith\n653: symm\n645: induction'\n631: norm_cast\n589: exacts\n577: swap\n575: positivity\n553: by_contra\n553: specialize\n547: trans\n536: norm_num\n499: all_goals\n493: conv_rhs\n466: split\n457: try\n447: field_simp\n444: find\n438: conv_lhs\n393: says\n389: clear\n387: nth_rw\n382: fun_prop\n364: tauto\n348: trace\n342: continuity\n332: abel\n331: next\n327: tfae_have\n326: decide\n325: conv\n320: revert\n319: absurd\n314: delta\n311: by_contra!\n308: contradiction\n296: generalize\n293: push_neg\n285: nontriviality\n284: slice_lhs\n279: linear_combination\n266: apply_fun\n262: congr!\n254: push_cast\n226: rewrite\n216: injection\n215: wlog\n214: forward\n204: ring_nf\n203: mono\n196: fin_cases\n196: ring1\n194: bicategory\n193: exact_mod_cast\n181: subsingleton\n177: reduce\n160: done\n156: slice_rhs\n144: repeat\n139: rel\n132: exfalso\n129: iterate\n125: hint\n124: introv\n116: grind\n114: rename\n112: simp?\n110: finiteness\n106: on_goal\n101: choose!\n101: measurability\n92: inhabit\n92: valid\n91: fapply\n90: nth_rewrite\n87: borelize\n85: apply_rules\n82: solve\n80: elementwise\n78: fail\n75: nlinarith\n74: contrapose\n70: tfae_finish\n68: convert_to\n64: sorry\n63: ac_rfl\n62: rotate_left\n61: algebraize\n60: rename_i\n58: skip\n56: clear_value\n55: coherence\n55: repeat'\n52: solve_by_elim\n51: any_goals\n50: fconstructor\n50: subst_vars\n45: rsuffices\n44: generalize_proofs\n43: congrm\n42: whnf\n41: unreachable!\n39: norm_num1\n38: simp!\n36: mfld_set_tac\n35: transitivity\n34: substs\n33: nofun\n33: peel\n33: rw_mod_cast\n31: admit\n30: stop\n29: set_option\n27: match_scalars\n26: clear!\n25: cc\n25: focus\n24: abel_nf\n24: monoidal_coherence\n24: recover\n24: zify\n23: assumption_mod_cast\n21: with_unfolding_all\n20: refine'\n20: with_reducible_and_instances\n19: clean\n19: subst_hom_lift\n18: injections\n18: with_reducible\n17: dbg_trace\n16: frac_tac\n14: interval_cases\n14: try?\n13: beta_reduce\n13: rcongr\n12: noncomm_ring\n12: qify\n11: casesm\n11: nomatch\n11: pick_goal\n10: case'\n10: existsi\n10: unfold_projs\n10: unit_interval\n9: algebraize_only\n9: compute_degree\n9: compute_degree!\n9: ghost_fun_tac\n9: ghost_simp\n9: init_ring\n9: map_fun_tac\n9: polyrith\n9: rify\n9: try_this\n8: apply_assumption\n8: assumption'\n8: ghost_calc\n8: isBoundedDefault\n8: itauto\n8: linear_combination'\n8: observe\n8: tauto_set\n7: aesop?\n7: fin_omega\n7: move_mul\n7: pgame_wf_tac\n7: ring!\n7: witt_truncateFun_tac\n6: bicategory_coherence\n6: cases'\n6: extract_goal\n6: guard_hyp\n5: abel1\n5: decreasing_tactic\n5: grewrite\n5: grw\n5: pi_lower_bound\n5: pi_upper_bound\n5: simp_wf\n5: simpa?\n5: smul_tac\n5: to_encard_tac\n5: triv\n5: use!\n4: apply_mod_cast\n4: decreasing_trivial\n4: reduce_mod_char\n3: aesop_graph\n3: arith_mult\n3: as_aux_lemma\n3: cancel_denoms\n3: compareOfLessAndEq_rfl\n3: fail_if_success\n3: infer_param\n3: mem_tac_aux\n3: move_add\n3: mv_bisim\n3: plausible\n3: refold_let\n3: rename'\n3: split_ands\n3: unfold_let\n2: abel1!\n2: ac_change\n2: and_intros\n2: aux_group₂\n2: bitwise_assoc_tac\n2: cfc_tac\n2: discrete_cases\n2: eta_expand\n2: fail_if_no_progress\n2: get_elem_tactic\n2: itauto!\n2: mem_tac\n2: monoidal_simps\n2: move_oper\n2: pure_coherence\n2: refine_lift\n2: rename_bvar\n2: rfl_cat\n2: ring1!\n2: ring_nf!\n2: run_tac\n2: set!\n2: simp_all!\n2: simp_intro\n2: sorry_if_sorry\n2: whisker_simps\n1: aesop_cat?\n1: aesop_mat\n1: apply_gmonoid_gnpowRec_succ_tac\n1: apply_gmonoid_gnpowRec_zero_tac\n1: aux_group₁\n1: cases_type\n1: change?\n1: check_compositions\n1: clear_aux_decl\n1: constructorm\n1: conv'\n1: exact?\n1: fun_induction\n1: have'\n1: have?\n1: lift_lets\n1: mod_cases\n1: norm_cast0\n1: reduce_mod_char!\n1: repeat1\n1: restrict_tac\n1: ring1_nf\n1: rotate_right\n1: show_term\n1: simp_all?\n1: simpa!\n1: sleep\n1: sleep_heartbeats\n1: specialize_all\n1: success_if_fail_with_msg\n1: swap_var\n1: use_finite_instance\n0: abel!\n0: abel_nf!\n0: ac_nf\n0: ac_nf0\n0: aesop_cat_nonterminal\n0: aesop_graph?\n0: aesop_graph_nonterminal\n0: aesop_unfold\n0: apply?\n0: apply_ext_theorem\n0: apply_rewrite\n0: apply_rfl\n0: apply_rw\n0: arith_mult?\n0: array_get_dec\n0: array_mem_dec\n0: attempt_all\n0: bddDefault\n0: bicategory_nf\n0: bv_check\n0: bv_decide\n0: bv_decide?\n0: bv_normalize\n0: bv_omega\n0: calc?\n0: cases_first_enat\n0: cases_type!\n0: casesm!\n0: cfc_cont_tac\n0: cfc_zero_tac\n0: clean_wf\n0: clear_\n0: congrm?\n0: continuity?\n0: conv?\n0: count_heartbeats\n0: decreasing_trivial_pre_omega\n0: decreasing_with\n0: dsimp!\n0: dsimp?\n0: dsimp?!\n0: eapply\n0: econstructor\n0: elementwise!\n0: enat_to_nat\n0: eq_refl\n0: erw?\n0: eta_reduce\n0: eta_struct\n0: expose_names\n0: extract_lets\n0: false_or_by_contra\n0: field_simp_discharge\n0: finiteness?\n0: finiteness_nonterminal\n0: forward?\n0: fun_cases\n0: gcongr?\n0: gcongr_discharger\n0: generalize'\n0: get_elem_tactic_extensible\n0: get_elem_tactic_trivial\n0: grind?\n0: guard_expr\n0: guard_goal_nums\n0: guard_hyp_nums\n0: guard_target\n0: have!?\n0: have?!\n0: let'\n0: let_to_have\n0: liftable_prefixes\n0: linarith!\n0: linear_combination2\n0: map_tacs\n0: massumption\n0: match_target\n0: mcases\n0: mclear\n0: mconstructor\n0: mdup\n0: measurability!\n0: measurability!?\n0: measurability?\n0: mexact\n0: mexfalso\n0: mexists\n0: mframe\n0: mhave\n0: mintro\n0: mleft\n0: monicity\n0: monicity!\n0: monoidal_nf\n0: mpure\n0: mpure_intro\n0: mrefine\n0: mreplace\n0: mrevert\n0: mright\n0: mspec\n0: mspec_no_bind\n0: mspec_no_simp\n0: mspecialize\n0: mspecialize_pure\n0: mstart\n0: mstop\n0: mvcgen\n0: mvcgen_no_trivial\n0: mvcgen_step\n0: native_decide\n0: nlinarith!\n0: nth_grewrite\n0: nth_grw\n0: observe?\n0: pnat_positivity\n0: pnat_to_nat\n0: refine_lift'\n0: repeat1'\n0: restrict_tac?\n0: rfl'\n0: ring1_nf!\n0: rw?\n0: rw??\n0: rw_search\n0: saturate\n0: saturate?\n0: simp?!\n0: simp_all?!\n0: simp_all_arith\n0: simp_all_arith!\n0: simp_arith\n0: simp_arith!\n0: simpa?!\n0: sizeOf_list_dec\n0: squeeze_scope\n0: subst_eqs\n0: suggest_premises\n0: symm_saturate\n0: toFinite_tac\n0: trace_state\n0: try_suggestions\n0: type_check\n0: unfold?\n0: unhygienic\n0: uniqueDiffWithinAt_Ici_Iic_univ\n0: use_discharger\n0: volume_tac\n0: wait_for_unblock_async\n0: with_panel_widgets\n</code></pre></div>",
        "id": 528397355,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752262938
    },
    {
        "content": "<p>First 30:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>73107: rw\n57481: simp\n46826: exact\n33592: have\n30528: rfl\n20869: refine\n17766: apply\n16243: let\n13406: obtain\n13133: simpa\n12929: intro\n10718: ext\n7851: set\n7847: rintro\n7839: rcases\n7377: simp_rw\n5124: dsimp\n4976: use\n4719: cases\n4340: ring\n4334: rwa\n4186: by_cases\n3817: convert\n3758: else\n3553: induction\n3511: constructor\n3291: show\n3015: suffices\n2946: group\n2781: calc\n</code></pre></div>",
        "id": 528397427,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752262986
    },
    {
        "content": "<p>there's a use of <code>sleep</code> in mathlib??</p>",
        "id": 528398334,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752263571
    },
    {
        "content": "<p>or are you including tests or something?</p>",
        "id": 528398346,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752263580
    },
    {
        "content": "<p>Are we really still using <code>continuity</code> that much?! We need to fix that.</p>",
        "id": 528398739,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1752263802
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Tactic.20uses.20in.20mathlib/near/528398346\">said</a>:</p>\n<blockquote>\n<p>or are you including tests or something?</p>\n</blockquote>\n<p>I included all files in <code>Mathlib</code></p>",
        "id": 528398825,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752263854
    },
    {
        "content": "<p>I'm pretty sure there's no 31 <code>admit</code>s in Mathlib itself</p>",
        "id": 528400847,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1752264913
    },
    {
        "content": "<p>test files?</p>",
        "id": 528401038,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752265033
    },
    {
        "content": "<p>also, how is there more <code>else</code> than <code>if</code>?</p>",
        "id": 528401057,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752265049
    },
    {
        "content": "<p>I'm grepping for <code>sleep</code></p>",
        "id": 528401086,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752265066
    },
    {
        "content": "<p>Q: <br>\n<span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Tactic.20uses.20in.20mathlib/near/528401057\">said</a>:</p>\n<blockquote>\n<p>also, how is there more <code>else</code> than <code>if</code>?</p>\n</blockquote>\n<p>A: because there's no <code>if</code> tactic</p>",
        "id": 528401202,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752265141
    },
    {
        "content": "<p>is there an <code>else</code> tactic???</p>",
        "id": 528401371,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752265229
    },
    {
        "content": "<p>I thought there is an <code>if</code>-<code>then</code>-<code>else</code> tactic</p>",
        "id": 528401395,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752265240
    },
    {
        "content": "<p>it's not a very rigid script, i just searched for the words surrounded by spaces <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span></p>",
        "id": 528401552,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752265326
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Tactic.20uses.20in.20mathlib/near/528401395\">said</a>:</p>\n<blockquote>\n<p>I thought there is an <code>if</code>-<code>then</code>-<code>else</code> tactic</p>\n</blockquote>\n<p>yea, i think that's sorta the point... it's just that the <code>#help tactic</code> command shows its name as <code>else</code></p>",
        "id": 528401576,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752265341
    },
    {
        "content": "<p>If you inspect the output of <code>#help tactic</code>, you may instead grep for the actual names of the tactics.  This will not be as precise as using some metaprogramming, but will probably be pretty close.</p>",
        "id": 528401639,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752265379
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Tactic.20uses.20in.20mathlib/near/528401552\">said</a>:</p>\n<blockquote>\n<p>it's not a very rigid script, i just searched for the words surrounded by spaces <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span></p>\n</blockquote>\n<p>I though you were at least using Lean to do it, but I scroll up to the top of this thread and I see python</p>",
        "id": 528401775,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752265457
    },
    {
        "content": "<p>I think that the deprecatedSyntax linter already extracts (most?) SyntaxNodeKinds from every syntax node.  If you make that linter print it out, then you can grep the output and you'll get very precise information on tactic use.</p>",
        "id": 528402515,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752265858
    },
    {
        "content": "<p>Figuring out what tactics are used is (very slightly) tricky, since they usually do not leave an explicit mark in the declaration that makes it to makes it to the environment, this is why using a linter is useful: it sees the syntax trees of (almost) all the commands in every file.</p>",
        "id": 528402703,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752265948
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110064\">@Kenny Lau</span> you can do this in lean and get a more accurate answer. Right now you're counting comments etc</p>",
        "id": 528406755,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1752268236
    },
    {
        "content": "<p>Yes, this probably explains the \"continuity\". I bet there are many false positives there.</p>",
        "id": 528406973,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1752268340
    },
    {
        "content": "<p>That regex would also fail to recognize e.g. <code>rw[h]</code> or <code>simp+decide</code>, or the <code>simp</code> in <code>first |simp | trivial</code>, or the <code>positivity</code> in <code>exact someThm (by positivity)</code>, or the <code>volume_tac</code> in <code>(h : ... := by volume_tac)</code>. All five are valid Lean, but I think probably only the last two are stylistically permissible within Mathlib...</p>",
        "id": 528424376,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1752285023
    },
    {
        "content": "<p>Am I correct when guessing that this does count autoparams? Pretty sure the category theory library would make <code>aesop_cat</code> one of the first tactic if autoparams were accounted for.</p>",
        "id": 528439240,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1752305148
    },
    {
        "content": "<p>To find out about autoparams, you would probably have to traverse the <code>InfoTree</code>s.  Maybe having a global statistic of <code>SyntaxNodeKind</code>s across mathlib would be interesting.</p>",
        "id": 528445628,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752312675
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Tactic.20uses.20in.20mathlib/near/528406973\">said</a>:</p>\n<blockquote>\n<p>Yes, this probably explains the \"continuity\". I bet there are many false positives there.</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/27035\">#27035</a></p>",
        "id": 528469664,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1752337717
    },
    {
        "content": "<p><code>cfc_tac</code> is currently defined as</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">cfcTac</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"s2\">\"cfc_tac\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span>\n<span class=\"kn\">macro_rules</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">cfc_tac</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span>\n<span class=\"w\">         </span><span class=\"n\">try</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">first</span><span class=\"w\"> </span><span class=\"bp\">|</span>\n<span class=\"w\">              </span><span class=\"n\">assumption</span><span class=\"w\"> </span><span class=\"bp\">|</span>\n<span class=\"w\">              </span><span class=\"n\">infer_instance</span><span class=\"w\"> </span><span class=\"bp\">|</span>\n<span class=\"w\">              </span><span class=\"n\">aesop</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rule_sets</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">$</span><span class=\"o\">(</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">mkIdent</span><span class=\"w\"> </span><span class=\"ss\">`CStarAlgebra</span><span class=\"o\">):</span><span class=\"n\">ident</span><span class=\"o\">])))</span>\n</code></pre></div>\n<p>It tries <code>assumption</code>, then <code>infer_instance</code>, and finally <code>aesop</code>.</p>\n<p>From local experiments, it seems that the <code>infer_instance</code> branch is often the main bottleneck in this sequence. As a simple experiment, I changed the order so that <code>aesop</code> is tried before <code>infer_instance</code>. With this modification, the compilation time of <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/CStarAlgebra/ContinuousFunctionalCalculus/Unital.html\"><code>Unital.lean</code></a> was reduced by a factor of several on my machine.</p>\n<p>I have not yet done a systematic benchmark, but the improvement is quite noticeable in practice. It would be interesting to know whether this reordering is considered reasonable, or whether there are known pitfalls with trying <code>aesop</code> before <code>infer_instance</code> in this context.</p>",
        "id": 575959946,
        "sender_full_name": "Kei TSUKAMOTO",
        "timestamp": 1772094551
    }
]