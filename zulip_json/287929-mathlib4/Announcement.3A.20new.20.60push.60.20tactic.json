[
    {
        "content": "<p>The <code>push</code> and <code>pull</code> tactics were recently merged into Mathlib. They are a generalization of <code>push_neg</code>, so now <code>push_neg</code> is a macro for <code>push Not</code>. The <code>push</code> tactic is extensible, so we need to tag a bunch of lemmas with <code>@[push]</code> in order to start using it. This includes tags to extend <code>push_neg</code>. I made <a href=\"https://github.com/leanprover-community/mathlib4/pull/29000\">#29000</a> to add a bunch of these tags, but it got a bit large, so I'm splitting it into several PRs to make it easier to review. Would someone like to review them?</p>",
        "id": 541888014,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1759061859
    },
    {
        "content": "<p>Annotations for <code>Real.log</code>: <a href=\"https://github.com/leanprover-community/mathlib4/pull/30039\">#30039</a></p>",
        "id": 541888031,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1759061879
    },
    {
        "content": "<p>Annotations for <code>fun</code>: <a href=\"https://github.com/leanprover-community/mathlib4/pull/30038\">#30038</a></p>",
        "id": 541888044,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1759061893
    },
    {
        "content": "<p>Annotations for membership in <code>Set</code>, <code>Finset</code> and <code>Multiset</code>: <a href=\"https://github.com/leanprover-community/mathlib4/pull/30042\">#30042</a></p>",
        "id": 541888077,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1759061918
    },
    {
        "content": "<p>Annotations for <code>push_neg</code> for <code>Empty</code>/<code>Subsingleton</code>/<code>Finite</code>/<code>Countable</code>: <a href=\"https://github.com/leanprover-community/mathlib4/pull/30051\">#30051</a></p>",
        "id": 541888136,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1759061964
    },
    {
        "content": "<p>When working on these PRs, I would have liked the following features:</p>\n<ul>\n<li>If the goal is <code>IsEmpty A</code> or <code>Subsingleton A</code>, it would be nice to be able to use <code>by_contra!</code> with an <code>rintro</code> pattern.</li>\n<li><code>absurd</code> should have an <code>absurd!</code> version that calls <code>push_neg</code></li>\n<li><code>by_cases</code> should have a <code>by_cases!</code> version that calls <code>push_neg</code> on the second sub-goal</li>\n<li><code>by_contra</code> and <code>by_contra!</code> behave differently when no argument is given. One of them introduces a hypothesis <code>this</code>, and the other gives an inaccessible name. Should it always be <code>this</code>?</li>\n<li>When the goal is <code>X ⊆ Y</code>, I would like a version of <code>intro</code> that automatically calls <code>push _ ∈ _</code> on the new goal, so that if the goal is for example <code>{x | P x} ⊆ {x | Q x}</code>, I want it to give <code>P x → Q x</code>. Maybe it should be called <code>mem_intro</code> or <code>intro_mem</code>?</li>\n</ul>\n<p>Do you agree with these suggestions?</p>",
        "id": 541889091,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1759062893
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479299\">Jovan Gerbscheid</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Announcement.3A.20new.20.60push.60.20tactic/near/541888014\">said</a>:</p>\n<blockquote>\n<p>now <code>push_neg</code> is not a macro for <code>push Not</code></p>\n</blockquote>\n<p>Typo?</p>",
        "id": 541889393,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1759063200
    },
    {
        "content": "<p>Did you made sure to keep everything that teachers use? Originally <code>push_neg</code> was a pure teaching tactic.</p>",
        "id": 541893441,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1759066957
    },
    {
        "content": "<p>And verbose Lean currently has the awful <a href=\"https://github.com/PatrickMassot/verbose-lean4/blob/bd3b236511d9a8929791f20f775e98a9ef81697c/Verbose/Tactics/Common.lean#L563-L625\">https://github.com/PatrickMassot/verbose-lean4/blob/bd3b236511d9a8929791f20f775e98a9ef81697c/Verbose/Tactics/Common.lean#L563-L625</a></p>",
        "id": 541893482,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1759067001
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110031\">@Patrick Massot</span> Yes, the option <code>push_neg.use_distrib</code> is still supported. The only behaviour that has changed is that it looks through reducible constants better:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">axiom</span><span class=\"w\"> </span><span class=\"n\">Bar</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">Bar</span>\n\n<span class=\"bp\">#</span><span class=\"n\">push_neg</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"c1\">-- Bar</span>\n</code></pre></div>",
        "id": 541895213,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1759068656
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"479299\">@Jovan Gerbscheid</span> <br>\nI would suggest that <code>by_cases!</code> just calls <code>push_neg</code> on <em>both</em> goals; sometimes it is convenient for one reason or another to put the negated version first. It would also be nice to turn <code> ¬ Set.Nonempty</code> into <code>= ∅</code>; bonus points if it also supposes <code>rcases</code> patterns so you can immediately case on the equality, but that might be beyond the scope of <code>push</code></p>",
        "id": 541927227,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1759104767
    },
    {
        "content": "<p>otherwise, yes, those all look good to me</p>",
        "id": 541927241,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1759104784
    },
    {
        "content": "<p>If you want to get the negated version first, for example <code>by_cases! h : ¬ p</code>, then in the first goal we get <code>h : ¬ p</code>, and in the second goal <code>h : p</code>. The tactic doesn't actually need to <code>push_neg</code> in the first goal, only in the second goal. Also, I think it might be more readable to write <code>by_cases h : p; swap</code>.</p>\n<p>Before my work, <code>push_neg</code> did already turn <code>¬ Set.Nonempty</code> into <code>= ∅</code>. But I will add tags for e.g. the same rule for <code>Finset</code>.</p>\n<p>I agree it would be nice to support <code>rcases</code> patterns in <code>by_cases!</code> (and <code>by_cases</code>), but I'm not sure what the syntax should be, given that the same variable name refers to two different introduced variables. Maybe we can have syntax <code>by_cases! (rfl | h) : a = ∅</code>.</p>",
        "id": 542093905,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1759165328
    },
    {
        "content": "<p>Here's my PR for <code>by_cases!</code>: <a href=\"https://github.com/leanprover-community/mathlib4/pull/30073\">#30073</a></p>",
        "id": 542093959,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1759165345
    },
    {
        "content": "<p>I've now split the tactic implementation of <code>by_cases!</code> into a separate PR: <a href=\"https://github.com/leanprover-community/mathlib4/pull/30730\">#30730</a></p>",
        "id": 546065813,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1760985680
    }
]