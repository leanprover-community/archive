[
    {
        "content": "<p><code>#α</code> in the <code>Cardinal</code> scope is notation for <code>Cardinal.mk α</code>. People in the past have found it confusing that this is the constructor for <code>Cardinal</code>, hence don't usually reach for the name <code>mk</code>. What do people think of renaming <code>mk</code> to <code>card</code> or something similar?</p>",
        "id": 481662919,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1731314463
    },
    {
        "content": "<p>This is wanting I've wanted to do for a while, but <span class=\"user-mention\" data-user-id=\"214703\">@Yury G. Kudryashov</span> is blocking my smaller scope PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/18808\">#18808</a> on it</p>",
        "id": 481663024,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1731314500
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"459227\">@Violeta Hernández</span> says</p>\n<blockquote>\n<p>The fact that <code>#α</code> is precisely the constructor of <code>Cardinal</code> applied to <code>α</code> is not really intuitive unless you're aware of it. I'd also prefer that we simply rename these theorems to use <code>card</code>.</p>\n</blockquote>\n<p>To clarify, <code>cardinal_mk</code> in lemma names would have to be changed to <code>cardinalCard</code>, not merely <code>card</code> because it is ambiguous with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Fintype.card#doc\">docs#Fintype.card</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finset.card#doc\">docs#Finset.card</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FinEnum.card#doc\">docs#FinEnum.card</a></p>",
        "id": 481663320,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1731314605
    },
    {
        "content": "<p>So <code>Cardinal.card</code> or <code>_root_.card</code>?</p>",
        "id": 481663404,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1731314634
    },
    {
        "content": "<p>As explained just above, <code>_root_.card</code> would be disastrous for ambiguity. <code>_root_.ccard</code>/<code>_root_.cCard</code>/<code>_root_.cardC</code> would be nice but I'm not sure we can name a constructor of a structure outside its namespace?</p>",
        "id": 481663566,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1731314694
    },
    {
        "content": "<p>It would have to be an alias</p>",
        "id": 481664544,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1731315036
    },
    {
        "content": "<p>I find <code>cardinalCard</code> quite duplicaty</p>",
        "id": 481664610,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1731315060
    },
    {
        "content": "<p>But that's my only objection</p>",
        "id": 481664658,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1731315076
    },
    {
        "content": "<p>Another option would be a <code>HasCard</code> typeclass providing a global <code>card</code>, instantiated as <code>HasCard (Type u) Cardinal.{u}</code> and <code>HasCard (Finset X) Nat</code> etc; though perhaps this makes it too easy to accidentally truncate with Nat.card...</p>",
        "id": 481674274,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731318039
    },
    {
        "content": "<p>I've already thought of this typeclass and the issue is that it would make <code>#{x | p x}</code> not elaborate as<code>Finset.filter Finset.univ fun x =&gt; p x</code> anymore, which I would find very sad.</p>",
        "id": 481679754,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1731319660
    },
    {
        "content": "<p>Following <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.card#doc\">docs#Nat.card</a> this should be <code>Cardinal.card</code>, but there is a duplication there</p>",
        "id": 481689014,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1731322387
    },
    {
        "content": "<p>I don't think using <code>card</code> is ambiguous with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Fintype.card#doc\">docs#Fintype.card</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finset.card#doc\">docs#Finset.card</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FinEnum.card#doc\">docs#FinEnum.card</a> if it's in the <code>Cardinal</code> namespace</p>",
        "id": 481689306,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1731322486
    },
    {
        "content": "<p>About blocking <a href=\"https://github.com/leanprover-community/mathlib4/pull/18808\">#18808</a>: I assumed (possibly, incorrectly) that <span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> 's comment blocks it. If Eric is OK with merging <a href=\"https://github.com/leanprover-community/mathlib4/pull/18808\">#18808</a> now and deciding about another rename later, then I'm OK too.</p>",
        "id": 481805270,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731357517
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Cardinal.2Emk/near/481674274\">said</a>:</p>\n<blockquote>\n<p>Another option would be a <code>HasCard</code> typeclass providing a global <code>card</code>, instantiated as <code>HasCard (Type u) Cardinal.{u}</code> and <code>HasCard (Finset X) Nat</code> etc; though perhaps this makes it too easy to accidentally truncate with Nat.card...</p>\n</blockquote>\n<p>This feels like the cleanest solution to me, and then <code>#</code> can be notation for <code>card</code> in both cases. Note that instances <code>HasCard (Multiset X) Nat</code> and maybe <code>HasCard (List X) Nat</code> could also make sense, though perhaps that's getting ahead of ourselves.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Cardinal.2Emk/near/481679754\">said</a>:</p>\n<blockquote>\n<p>I've already thought of this typeclass and the issue is that it would make <code>#{x | p x}</code> not elaborate as<code>Finset.filter Finset.univ fun x =&gt; p x</code> anymore, which I would find very sad.</p>\n</blockquote>\n<p>What would it elaborate as instead?</p>",
        "id": 481808979,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1731359124
    },
    {
        "content": "<p>What about <code>Cardinal.mk</code> vs <code>Nat.card</code> vs <code>ENat.card</code> for a <code>Type</code>?</p>",
        "id": 481809658,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731359417
    },
    {
        "content": "<p>That's the current status quo, isn't it?</p>",
        "id": 481809703,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1731359438
    },
    {
        "content": "<p>How do you suggest to make it work with <code>HasCard</code>?</p>",
        "id": 481809738,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731359459
    },
    {
        "content": "<p>Oh, I misunderstood your question.</p>",
        "id": 481809761,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1731359470
    },
    {
        "content": "<p>Sorry, I should've formulated it better.</p>",
        "id": 481809786,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731359486
    },
    {
        "content": "<p>Yeah, I don't think we could have notation for all three at once</p>",
        "id": 481809792,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1731359488
    },
    {
        "content": "<p>Unless we want to do stuff like #ₙ and #ₑ</p>",
        "id": 481809855,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1731359518
    },
    {
        "content": "<p>We can have <code>#</code> with different indices for different \"types\" of cardinalities.</p>",
        "id": 481809907,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731359524
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Cardinal.2Emk/near/481679754\">said</a>:</p>\n<blockquote>\n<p>I've already thought of this typeclass and the issue is that it would make <code>#{x | p x}</code> not elaborate as<code>Finset.filter Finset.univ fun x =&gt; p x</code> anymore, which I would find very sad.</p>\n</blockquote>\n<p>It already doesn't?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">Cardinal</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Prime</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"c1\">-- Cardinal</span>\n</code></pre></div>",
        "id": 481809911,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731359526
    },
    {
        "content": "<p>Though interestingly <code>#check #{x | Nat.Prime (x : Fin 6)}</code> hits the ambiguity between the notations</p>",
        "id": 481810002,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731359578
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Cardinal.2Emk/near/481809907\">said</a>:</p>\n<blockquote>\n<p>We can have <code>#</code> with different indices for different \"types\" of cardinalities.</p>\n</blockquote>\n<p>Actually that's not a bad idea at all, and it's compatible with the <code>HasCard</code> idea, I think.</p>",
        "id": 481810036,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1731359595
    },
    {
        "content": "<p>What should be the index for \"<code>Finset</code>/<code>Fintype</code>\"?</p>",
        "id": 481810071,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731359620
    },
    {
        "content": "<p>So you mean <code>#ₙ</code>?</p>",
        "id": 481810083,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731359624
    },
    {
        "content": "<p>I think that <code>#ₙ</code> should mean <code>Nat.card</code> or <code>Set.ncard</code>.</p>",
        "id": 481810163,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731359649
    },
    {
        "content": "<p>I'd propose <code>#ₙx</code> means <code>@HasCard.card _ Nat x</code> and <code>#x</code> means <code>@HasCard.card _ Cardinal x</code></p>",
        "id": 481810221,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731359676
    },
    {
        "content": "<p>How do you tell <code>Fintype.card</code> from <code>Nat.card</code>?</p>",
        "id": 481810282,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731359708
    },
    {
        "content": "<p>Ugh, I forgot <code>Nat.card</code> acted on types</p>",
        "id": 481810326,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731359731
    },
    {
        "content": "<p>Maybe <code>#!</code>, since it's like the <code>get!</code> of the array world?</p>",
        "id": 481810347,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731359743
    },
    {
        "content": "<p>Or an index <code>f</code> for Finite, like the <code>n</code> could be Nat?</p>",
        "id": 481810465,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1731359792
    },
    {
        "content": "<p>Note that you can have <code>HasCard</code> on <code>Finset</code>s but not on <code>Type</code>s.</p>",
        "id": 481810466,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731359792
    },
    {
        "content": "<p>My perhaps controversial suggestion is that <code>Fintype.card</code> should be explicitly specified, as a way to signal that you do in fact have a <code>Fintype</code> instance.</p>",
        "id": 481810559,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1731359833
    },
    {
        "content": "<p>Because the signature is <code>Fintype.card (α) [Fintype α] : Nat</code>, not <code>Type* → Nat</code>.</p>",
        "id": 481810571,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731359839
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Cardinal.2Emk/near/481805270\">said</a>:</p>\n<blockquote>\n<p>About blocking <a href=\"https://github.com/leanprover-community/mathlib4/pull/18808\">#18808</a>: I assumed (possibly, incorrectly) that <span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> 's comment blocks it. If Eric is OK with merging <a href=\"https://github.com/leanprover-community/mathlib4/pull/18808\">#18808</a> now and deciding about another rename later, then I'm OK too.</p>\n</blockquote>\n<p>My intent was not to block, only to make sure we were aware of the possibility of having to pay the cost of two sequential renames. Just renaming the constructor would have been easy enough, if we want to do it.</p>",
        "id": 481810573,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731359839
    },
    {
        "content": "<p><code>Nat.card</code> seems more useful in general</p>",
        "id": 481810575,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1731359842
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Cardinal.2Emk/near/481810571\">said</a>:</p>\n<blockquote>\n<p>Because the signature is <code>Fintype.card (α) [Fintype α] : Nat</code>, not <code>Type* → Nat</code>.</p>\n</blockquote>\n<p>I think this means I retract my proposal</p>",
        "id": 481810698,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731359888
    },
    {
        "content": "<p>I think that we can introduce notation like <code>#ₙ</code>, <code>#</code>, <code>#ₑ</code> for different cardinalities without introducing typeclasses.</p>",
        "id": 481810893,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731359990
    },
    {
        "content": "<p>That doesn't help with the naming question that started this thread though</p>",
        "id": 481810979,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731360014
    },
    {
        "content": "<p>Anyway, different cardinalities have different assumptions for the same lemmas.</p>",
        "id": 481810983,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731360017
    },
    {
        "content": "<p>/me is away for ~40min</p>",
        "id": 481811064,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731360052
    },
    {
        "content": "<p>What's the way we currently handle <code>Nat.card</code> and <code>Fintype.card</code> in theorem names?</p>",
        "id": 481811273,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1731360138
    },
    {
        "content": "<p>AFAICT, there is no system. Many lemmas are formulated for 1 of them only. We have <code>ncard</code> and <code>encard</code> for <code>Set.ncard</code> and <code>Set.encard</code> though.</p>",
        "id": 481816238,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731362370
    },
    {
        "content": "<p>I think it makes sense not to be redundant with <code>Fintype.card</code> and <code>Nat.card</code>, but clearly <code>Cardinal.mk</code> is a different situation.</p>",
        "id": 481816758,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1731362602
    },
    {
        "content": "<p>I fear <code>cardinalMk</code> might actually be our best choice</p>",
        "id": 481816954,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1731362691
    },
    {
        "content": "<p>Unless we want to use something like <code>ccard</code> (cardinal cardinality)</p>",
        "id": 481817242,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1731362800
    },
    {
        "content": "<p>Would the following behavior make sense? It could be implemented as a custom elaborator. For <code>#s</code>:</p>\n<ul>\n<li>If <code>s</code> can elaborate as a <code>Finset</code>, use <code>Finset.card</code></li>\n<li>Otherwise, if it can elaborate as a <code>Set</code>, if the excepted type is <code>ENat</code> use <code>Set.encard</code>, otherwise use <code>Set.ncard</code></li>\n<li>Otherwise, elaborate it as a <code>Type _</code> (fail if this fails). Now try to synthesize a <code>Fintype</code> instance for it. If that succeeds, use <code>Fintype.card</code>.</li>\n<li>Otherwise, if the excepted type is <code>Cardinal</code> use <code>Cardinal.mk</code></li>\n<li>Otherwise use <code>Nat.card</code></li>\n</ul>",
        "id": 481856962,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1731382195
    },
    {
        "content": "<p>I think that this will make the code less readable.</p>",
        "id": 481857115,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731382259
    },
    {
        "content": "<p>I would prefer to have different notation for different functions.</p>",
        "id": 481857292,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1731382357
    }
]