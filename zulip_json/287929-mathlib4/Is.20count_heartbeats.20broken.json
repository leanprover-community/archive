[
    {
        "content": "<p>I have an impression that <code>#count_heartbeats in</code> is broken on <code>master</code>, probably because Lean now elaborates theorems in threads. I don't have a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> at the moment, but</p>\n<ul>\n<li>replacing <code>aesop</code> with a term proof didn't change the reported number;</li>\n<li>when I add <code>#count_heartbeats</code> to some definitions, the \"unused arguments\" linter starts complaining sometimes.</li>\n</ul>",
        "id": 512244598,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744701624
    },
    {
        "content": "<p><code>#count_heartbeats</code> is definitely broken <a href=\"https://github.com/leanprover-community/mathlib4/pull/23905\">#23905</a>, as it says in your title, but in your question you're asking about <code>#count_heartbeats in</code>.</p>",
        "id": 512245266,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744701852
    },
    {
        "content": "<p>I think that the function used by both of them is broken.</p>",
        "id": 512245397,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744701907
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"bp\">#</span><span class=\"n\">count_heartbeats</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"c1\">-- 71</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n\n<span class=\"bp\">#</span><span class=\"n\">count_heartbeats</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"c1\">-- 108</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">aesop</span>\n\n<span class=\"bp\">#</span><span class=\"n\">count_heartbeats</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"c1\">-- 81</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">tauto</span>\n</code></pre></div>\n<p>I can't reproduce what you're seeing (I used <code>#count_heartbeats in</code> a lot over the weekend)</p>",
        "id": 512246995,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744702329
    },
    {
        "content": "<p>I had a term mode proof with <code>by _</code> here and there. Sorry, I'm going to bed now. I'll try to make a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> tomorrow</p>",
        "id": 512247260,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744702392
    }
]