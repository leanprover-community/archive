[
    {
        "content": "<p>So question for reviewers that are looking for golfs. How do you review PR's? Do you check the branch out and try golfing ideas? Or do you copy paste the declaration that you want to golf?</p>\n<p>Because my current workflow of copy-pasting seems cumbersome. I didn't yet find a good, frictionless workflow.</p>",
        "id": 563540316,
        "sender_full_name": "metakuntyyy",
        "timestamp": 1765564844
    },
    {
        "content": "<p><code>gh pr checkout 12345</code> followed by <code>lake exe cache get</code> (or the equivalent VS code extension commandâ€”\"get cache for current imports\" is also useful if you don't want the whole cache) is my go-to for interacting with the declarations in a PR, golfing or not. :)</p>",
        "id": 563541525,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1765565362
    },
    {
        "content": "<p>In my opinion the best golfs are those that either (a) greatly decrease compilation time without sacrificing readability or (b) decrease the number of times lemmas are called explicitly (replacing calls to lemmas with calls to tactics). If you're getting into golfing then please don't just assume that because you've shaved 5 characters of a proof that this represents progress! Making a proof a bit shorter because <code>rfl</code> happens to work two lines from the end but takes 10 seconds to compile is definitely a step backwards, for example :-)</p>",
        "id": 563551273,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765569378
    },
    {
        "content": "<p>Does anyone have a different workflow that they use or are most/all of you using gh-cli to checkout foreign branches? I'm not really using gh-cli and instead use git-ssh to push/pull. Before the fork based workflow one could just check out the branch directly.</p>",
        "id": 563553157,
        "sender_full_name": "metakuntyyy",
        "timestamp": 1765570035
    },
    {
        "content": "<p>You don't need <code>gh-cli</code> to pull from PR branches. I do</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">fetch</span><span class=\"w\"> </span><span class=\"n\">origin</span><span class=\"w\"> </span><span class=\"n\">pull</span><span class=\"bp\">/</span><span class=\"mi\">12345</span><span class=\"bp\">/</span><span class=\"n\">head</span><span class=\"o\">:</span><span class=\"n\">pr12345</span>\n</code></pre></div>",
        "id": 563553361,
        "sender_full_name": "David Renshaw",
        "timestamp": 1765570109
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"243791\">@David Renshaw</span> Do I even need to pull? Wouldn't a detached checkout origin/pull/12345 work as well?</p>",
        "id": 563553613,
        "sender_full_name": "metakuntyyy",
        "timestamp": 1765570227
    },
    {
        "content": "<p>I think the PR refs don't get fetched by default.</p>",
        "id": 563553721,
        "sender_full_name": "David Renshaw",
        "timestamp": 1765570271
    },
    {
        "content": "<p>I guess I have to add a second origin to the main repo right?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">remote</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">v</span>\n<span class=\"n\">origin</span><span class=\"w\">  </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">metakunt</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"bp\">.</span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fetch</span><span class=\"o\">)</span>\n<span class=\"n\">origin</span><span class=\"w\">  </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">metakunt</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"bp\">.</span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">push</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>I get this </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">fetch</span><span class=\"w\"> </span><span class=\"n\">origin</span><span class=\"w\"> </span><span class=\"n\">pull</span><span class=\"bp\">/</span><span class=\"mi\">32811</span><span class=\"bp\">/</span><span class=\"n\">head</span><span class=\"o\">:</span><span class=\"n\">test</span>\n<span class=\"n\">fatal</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">couldn't</span><span class=\"w\"> </span><span class=\"n\">find</span><span class=\"w\"> </span><span class=\"n\">remote</span><span class=\"w\"> </span><span class=\"n\">ref</span><span class=\"w\"> </span><span class=\"n\">pull</span><span class=\"bp\">/</span><span class=\"mi\">32811</span><span class=\"bp\">/</span><span class=\"n\">head</span>\n</code></pre></div>",
        "id": 563555348,
        "sender_full_name": "metakuntyyy",
        "timestamp": 1765571051
    },
    {
        "content": "<p>Yup, add a remote that points to the main repo. I call that remote <code>upstream</code> on my machines.</p>",
        "id": 563555680,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1765571194
    },
    {
        "content": "<p>Ah, yeah it works, although I was a bit more unoriginal with my name orig.</p>\n<p>I tried checking it out, it works but unfortunately I couldn't figure out how to do a detached checkout.</p>",
        "id": 563556132,
        "sender_full_name": "metakuntyyy",
        "timestamp": 1765571392
    },
    {
        "content": "<p>Nvm it is git switch FETCH_HEAD after the fetch.</p>",
        "id": 563557271,
        "sender_full_name": "metakuntyyy",
        "timestamp": 1765571839
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"725717\">metakuntyyy</span> <a href=\"#narrow/channel/287929-mathlib4/topic/What's.20your.20workflow.20to.20review.20Mathlib.20PR's/near/563553157\">said</a>:</p>\n<blockquote>\n<p>Does anyone have a different workflow that they use or are most/all of you using gh-cli to checkout foreign branches?</p>\n</blockquote>\n<p>I'm doing the same awkward copy-paste you mentioned, though I'll for big PRs I'd use gh-cli.<br>\nThe GitHub CLI is useful to have regardless, I'm using it to keep track of PRs using <code>gh api graphql</code>, e.g.</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"nb\">echo</span><span class=\"w\"> </span><span class=\"s1\">'{\"query\":\"{ search(type: ISSUE, first: 100, query: \\\"repo:leanprover-community/mathlib4 is:pr author:@me\\\") { nodes { ... on PullRequest { number state title } } } }\"}'</span><span class=\"w\"> </span><span class=\"p\">|</span><span class=\"w\"> </span>gh<span class=\"w\"> </span>api<span class=\"w\"> </span>graphql<span class=\"w\"> </span>--input<span class=\"w\"> </span>-\n</code></pre></div>",
        "id": 563565890,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1765575722
    },
    {
        "content": "<p>Very nice.</p>\n<p>I tried the git fetch orig... and it worked, but lake exe cache get tries to pull from my repository instead of the authors. Do I have to configure that as well, because rebuilding takes a lot of time?</p>",
        "id": 563566465,
        "sender_full_name": "metakuntyyy",
        "timestamp": 1765575983
    },
    {
        "content": "<p><code>lake exe cache get</code> definitely works out of the box with <code>gh</code>.</p>",
        "id": 563571928,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765579067
    },
    {
        "content": "<p>I see, I'll try it tomorrow.</p>",
        "id": 563572087,
        "sender_full_name": "metakuntyyy",
        "timestamp": 1765579167
    },
    {
        "content": "<p>Is there any tutorial on this workflow available? nws if not, I can read this thread carefully and try to understand what to do</p>",
        "id": 563578251,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1765584184
    },
    {
        "content": "<p>Part 2 here: <a href=\"https://leanprover-community.github.io/contribute/git.html\">https://leanprover-community.github.io/contribute/git.html</a></p>",
        "id": 563578423,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1765584326
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"400289\">Artie Khovanov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/What's.20your.20workflow.20to.20review.20Mathlib.20PR's/near/563578251\">said</a>:</p>\n<blockquote>\n<p>Is there any tutorial on this workflow available? nws if not, I can read this thread carefully and try to understand what to do</p>\n</blockquote>\n<p>Press the <code>Code</code> button on the top-right of a PR, copy the command, and run it on your local clone of Mathlib<br>\n<a href=\"/user_uploads/3121/l8J_j0WZJUMEQFsTJtIdx378/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/l8J_j0WZJUMEQFsTJtIdx378/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"842x638\" src=\"/user_uploads/thumbnail/3121/l8J_j0WZJUMEQFsTJtIdx378/image.png/840x560.webp\"></a></div><p>after it finishes, run <code>lake exe cache get</code>, and you're done</p>",
        "id": 563579026,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1765584848
    },
    {
        "content": "<p>and here's the link to install the GitHub CLI if you don't have it: <a href=\"https://cli.github.com/\">https://cli.github.com/</a></p>",
        "id": 563579079,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1765584897
    },
    {
        "content": "<p>(I prefer installing with <code>winget install -e --id GitHub.cli</code> on Windows and <code>brew install gh</code> on macOS, depends on whether you like package managers)</p>",
        "id": 563579303,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1765585115
    }
]