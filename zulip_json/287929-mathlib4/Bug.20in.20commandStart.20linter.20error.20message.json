[
    {
        "content": "<p>I found an example where the commandStart linter's error is misleading: in the following example, the error should be \"remove a space\", but it's \"remove a line break\".</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Init</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">style</span><span class=\"bp\">.</span><span class=\"n\">commandStart</span><span class=\"w\"> </span><span class=\"n\">true</span>\n\n<span class=\"c1\">-- note: space after the \"in \"; the diagnostics are a bit misleading</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">warning: remove line break in the source</span>\n\n<span class=\"sd\">This part of the code</span>\n<span class=\"sd\">  'in ⏎</span>\n<span class=\"sd\">-- TODO:'</span>\n<span class=\"sd\">should be written as</span>\n<span class=\"sd\">  'in</span>\n<span class=\"sd\">-- TODO:'</span>\n\n<span class=\"sd\">note: this linter can be disabled with `set_option linter.style.commandStart false`</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"c1\">-- TODO: add longer docs!</span>\n<span class=\"c1\">-- extendLocally: takes trivialisation e as parameter, and a basis b of F</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">warning: remove line break in the source</span>\n\n<span class=\"sd\">This part of the code</span>\n<span class=\"sd\">  'in ⏎</span>\n<span class=\"sd\">def'</span>\n<span class=\"sd\">should be written as</span>\n<span class=\"sd\">  'in</span>\n<span class=\"sd\">def bar'</span>\n\n<span class=\"sd\">note: this linter can be disabled with `set_option linter.style.commandStart false`</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>",
        "id": 526997878,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1751549570
    },
    {
        "content": "<p>CC <span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span></p>",
        "id": 526997899,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1751549575
    },
    {
        "content": "<p>It is true that this is misleading, but it also seems true that removing the line break <em>could</em> be what is wanted here, right?</p>",
        "id": 526998897,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1751549865
    },
    {
        "content": "<p>That is, the code below should also be allowed, I think:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"c1\">-- TODO: remove this</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>",
        "id": 526999169,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1751549937
    },
    {
        "content": "<p>In this particular case (<code>open Classical in</code>) I would say it's not wanted. This might be different for other syntax.</p>",
        "id": 526999194,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1751549942
    },
    {
        "content": "<p>So, I would leave this as \"the linter suggests a valid way of complying, there may be other ways that are also compliant and may be better on a case-by-case basis\".</p>",
        "id": 526999388,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1751549993
    },
    {
        "content": "<p>Does this seem like a reasonable summary?</p>",
        "id": 526999452,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1751550007
    }
]