[
    {
        "content": "<p>Should we add the definitions for negative (semi-)definite matrices? It's defined in <a href=\"https://en.wikipedia.org/wiki/Definite_matrix\">wikipedia</a>.<br>\nI'm hesitant since it's literally just the negative of a positive (semi-)definite matrix (as in, <code>x</code> is negative (semi-)definite iff <code>-x</code> is positive (semi-)definite).</p>",
        "id": 535269158,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755680377
    },
    {
        "content": "<p>I think in the past <span class=\"user-mention\" data-user-id=\"197836\">@Jireh Loreaux</span> and I discussed replacing <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PosSemidef#doc\">docs#PosSemidef</a> with <code>0 \\le A</code> via a <code>StarOrderedRing</code> instance</p>",
        "id": 535289533,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755688009
    },
    {
        "content": "<p>that would be less general than <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matrix.PosSemidef#doc\">docs#Matrix.PosSemidef</a> right now though</p>",
        "id": 535290110,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755688221
    },
    {
        "content": "<p>what we can do is add a partial order and <code>StarOrderedRing</code> instance now via <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matrix.PosSemidef#doc\">docs#Matrix.PosSemidef</a> (for real and complex)</p>",
        "id": 535290230,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755688268
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"477483\">Monica Omar</span> <a href=\"#narrow/channel/287929-mathlib4/topic/negative.20.28semi-.29definite.20matrices/near/535290110\">said</a>:</p>\n<blockquote>\n<p>that would be less general than <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matrix.PosSemidef#doc\">docs#Matrix.PosSemidef</a> right now though</p>\n</blockquote>\n<p>How so?</p>",
        "id": 535290810,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755688502
    },
    {
        "content": "<p>I can't find the old thread, but my naive proposal is</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LE</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">le</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">IsHermitian</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">star</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚¨ù·µ•</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">*·µ•</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">star</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚¨ù·µ•</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">*·µ•</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>though obviously the <code>M - N</code> is problematic for semirings</p>",
        "id": 535291419,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755688716
    },
    {
        "content": "<p>It would define a <code>LE</code> but not a partial order for general *-rings</p>",
        "id": 535291539,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755688767
    },
    {
        "content": "<p>But for <code>StarOrderedRing R</code> would it result in <code>StarOrderedRing (Matrix n n R)</code>?</p>",
        "id": 535291628,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755688802
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/negative.20.28semi-.29definite.20matrices/near/535291419\">said</a>:</p>\n<blockquote>\n<p>I can't find the old thread</p>\n</blockquote>\n<p><a href=\"#narrow/channel/287929-mathlib4/topic/Conflicting.20.60.E2.89.A4.60.20and.20.60.3C.60/near/512123692\">#mathlib4 &gt; Conflicting &#96;‚â§&#96; and &#96;&lt;&#96; @ üí¨</a></p>",
        "id": 535291699,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755688831
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/negative.20.28semi-.29definite.20matrices/near/535291628\">said</a>:</p>\n<blockquote>\n<p>But for <code>StarOrderedRing R</code> would it result in <code>StarOrderedRing (Matrix n n R)</code>?</p>\n</blockquote>\n<p>I think we'd need a C*-algebra or some sort of norm structure to turn <code>Matrix n n R</code> into a <code>StarOrderedRing</code> (as far as I know, correct me if i'm wrong)</p>",
        "id": 535292251,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755689018
    },
    {
        "content": "<p>^ in which case we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CStarMatrix.instStarOrderedRing#doc\">docs#CStarMatrix.instStarOrderedRing</a></p>",
        "id": 535292349,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755689059
    },
    {
        "content": "<ol>\n<li>No, we should not define negative semidefinite matrices too.</li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CStarMatrix.instStarOrderedRing#doc\">docs#CStarMatrix.instStarOrderedRing</a> is just defined using the spectral order, but that's suboptimal in the long run.</li>\n<li>We should provide the instance Eric mentions, at least for <code>RCLike</code> entries.</li>\n<li>You can provide a <code>StarOrderedRing</code> instance on that, even without invoking the C‚ãÜ-norm. There's two ways to do this: via the pre-existing square root machinery, or using the continuous functional calculus for hermitian matrices (which we have thanks to <span class=\"user-mention\" data-user-id=\"462733\">@Jon Bannon</span>).</li>\n<li>At some point, I did this in a branch, but maybe only locally. Let me look for it later today.</li>\n</ol>",
        "id": 535315133,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755696758
    },
    {
        "content": "<p>Indeed, I claimed to have built that instance before: <a class=\"message-link\" href=\"/#narrow/channel/144837-PR-reviews/topic/.238809.20positive.20semidef.20matrices/near/408087994\">#PR reviews &gt; #8809 positive semidef matrices @ üí¨</a></p>",
        "id": 535315453,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755696866
    },
    {
        "content": "<p>do you mean adding an instance <code>StarOrderedRing (Matrix n n ùïú)</code>?</p>",
        "id": 535315949,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755696998
    },
    {
        "content": "<p>oh right, that's <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CStarMatrix#doc\">docs#CStarMatrix</a></p>",
        "id": 535316134,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755697055
    },
    {
        "content": "<p>Yes, I meant one for <code>Matrix</code>.</p>",
        "id": 535316170,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755697068
    },
    {
        "content": "<p>I think using the pre-existing square root machinery would be fairly straightforward:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">Matrix</span><span class=\"bp\">.</span><span class=\"n\">PosDef</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Matrix</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">RCLike</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">ComplexOrder</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PartialOrder</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">le</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">PosSemidef</span>\n<span class=\"w\">  </span><span class=\"n\">le_refl</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">sub_self</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">zero</span>\n<span class=\"w\">  </span><span class=\"n\">le_trans</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span>\n<span class=\"w\">  </span><span class=\"n\">le_antisymm</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">sub_eq_zero</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">toLin'</span><span class=\"bp\">.</span><span class=\"n\">injective</span><span class=\"bp\">.</span><span class=\"n\">eq_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">ext_iff</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">toLin'_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">zero_mulVec</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span><span class=\"bp\">.</span><span class=\"n\">dotProduct_mulVec_zero_iff</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÅ</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">neg_sub</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"bp\">.</span><span class=\"n\">neg_mulVec</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">dotProduct_neg</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">le_neg</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">neg_zero</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">this</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">le_antisymm</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h‚ÇÇ</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">le_def</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">PosSemidef</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Iff</span><span class=\"bp\">.</span><span class=\"n\">rfl</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">nonneg_iff_posSemidef</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">PosSemidef</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">le_def</span><span class=\"o\">]</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">StarOrderedRing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">of_le_iff</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">hab</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hs</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_‚ü©</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">simp_rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">sub_eq_iff_eq_add'</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">posSemidef_iff_eq_conjTranspose_mul_self</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"n\">hab</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">simp_rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">le_def</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">posSemidef_iff_eq_conjTranspose_mul_self</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sub_eq_iff_eq_add'</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">‚ü®_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hs</span><span class=\"bp\">‚ü©</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Matrix</span>\n</code></pre></div>",
        "id": 535316275,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755697107
    },
    {
        "content": "<p>Yes, but my preference would be to obliterate <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matrix.PosSemidef.sqrt#doc\">docs#Matrix.PosSemidef.sqrt</a> in favor of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CFC.sqrt#doc\">docs#CFC.sqrt</a>.</p>",
        "id": 535316600,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755697210
    },
    {
        "content": "<p>should be fairly straightforward to deprecate <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matrix.PosSemidef.sqrt#doc\">docs#Matrix.PosSemidef.sqrt</a> and use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matrix.IsHermitian.cfc#doc\">docs#Matrix.IsHermitian.cfc</a> instead</p>",
        "id": 535317219,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755697390
    },
    {
        "content": "<p>The only minor trick is that you have to work with the <code>‚Ñù</code> functional calculus to get the <code>StarOrderedRing</code> instance, instead of the <code>‚Ñù‚â•0</code> one (so you don't have access to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CFC.sqrt#doc\">docs#CFC.sqrt</a> directly. Nevertheless, you can still use <code>cfc Real.sqrt A</code> and show that it is positive semidefinite.</p>",
        "id": 535317265,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755697404
    },
    {
        "content": "<p>Aha, that's a footgun, albeit a necessary one. You never want to touch <code>Matrix.IsHermitian.cfc</code> (okay, fine, almost never).</p>",
        "id": 535317507,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755697469
    },
    {
        "content": "<p>lol okay! I just read the documentation saying to use the generic API instead</p>",
        "id": 535317740,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755697533
    },
    {
        "content": "<p>so should I work on this? deprecate <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matrix.PosSemidef.sqrt#doc\">docs#Matrix.PosSemidef.sqrt</a> and use the continuous functional calculus instead?</p>",
        "id": 535317878,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755697585
    },
    {
        "content": "<p>Let's make sure there's buy-in from others first, so I'm not just dictating things.</p>",
        "id": 535318414,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755697754
    },
    {
        "content": "<p>how heavy would you say the imports would be on <code>Matrix/PosDef</code> if we import <code>Matrix/HermitianFunctionalCalculus</code>?</p>",
        "id": 535319472,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755698092
    },
    {
        "content": "<p>there's only 3 files importing <code>Matrix/PosDef</code> so shouldn't be a big deal actually</p>",
        "id": 535319940,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755698231
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/negative.20.28semi-.29definite.20matrices/near/535318414\">said</a>:</p>\n<blockquote>\n<p>Let's make sure there's buy-in from others first, so I'm not just dictating things.</p>\n</blockquote>\n<p>I agree with the plan, for what it's worth!</p>",
        "id": 535321237,
        "sender_full_name": "Fr√©d√©ric Dupuis",
        "timestamp": 1755698541
    },
    {
        "content": "<p>I think we could PR the above without first deciding what to do about sqrt?</p>",
        "id": 535321476,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755698604
    },
    {
        "content": "<p>I don't see why not, since I don't think the proof would change after changing sqrt (right?)</p>",
        "id": 535321915,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755698722
    },
    {
        "content": "<p>Is positive semidefinite-ness really not a partial order on matrices of integers?</p>",
        "id": 535322223,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755698805
    },
    {
        "content": "<p>should be fine, just coerce it as a matrix of real numbers?</p>",
        "id": 535325794,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755699792
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"477483\">Monica Omar</span> <a href=\"#narrow/channel/287929-mathlib4/topic/negative.20.28semi-.29definite.20matrices/near/535325794\">said</a>:</p>\n<blockquote>\n<p>should be fine, just coerce it as a matrix of real numbers?</p>\n</blockquote>\n<p>I don't think it would make sense if you don't coerce it? For example, <code>[[1,1],[1,2]]</code> is positive as a real matrix. But it has non-integer eigenvalues. So I don't know. I think I'm overthinking it now.</p>",
        "id": 535335188,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755702369
    },
    {
        "content": "<p>Monica, it's not that simple since over <code>‚Ñ§</code> your semi-definiteness condition is weaker than positive semidefiniteness of the corresponding matrix over <code>‚Ñù</code> (since you only consider vectors with integer entries). What <em>is</em> true is that if the <code>‚Ñù</code> matrix is positive semidefinite, then so is the <code>‚Ñ§</code> matrix.</p>\n<p>I think it would be possible to prove that positive semidefiniteness still induces a partial order, but I think you would need to go through <code>QuadraticMap.polar</code> (or some inline recreation of it) to show that for a positive semidefinite matrix <code>A</code> over <code>‚Ñ§</code> with <code>A ‚â§ 0</code>, the off-diagonal entries are zero.</p>\n<p>In any case, I claim that it's irrelevant because this order on <code>Matrix n n ‚Ñ§</code> is not \"natural\" because it <em>doesn't</em> satisfy <code>StarOrderedRing</code> (because <code>[[1,1],[1,1]]</code> is positive semidefinite but cannot be written as a sum of squares of matrices).</p>",
        "id": 535343091,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755704532
    },
    {
        "content": "<p>So we should only put the order on <code>RCLike</code>-valued matrices.</p>",
        "id": 535343144,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755704549
    },
    {
        "content": "<p>(possibly scoped)</p>",
        "id": 535343171,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755704557
    },
    {
        "content": "<p>I see, I see</p>",
        "id": 535343968,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755704803
    },
    {
        "content": "<p>should we PR the above star ordered ring instance (scoped to <code>MatrixOrder</code> or something?) for now before deciding whether to move forward with changing the matrix sqrt to use cfc?</p>",
        "id": 535344787,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755705022
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/negative.20.28semi-.29definite.20matrices/near/535343091\">said</a>:</p>\n<blockquote>\n<p>In any case, I claim that it's irrelevant because this order on <code>Matrix n n ‚Ñ§</code> is not \"natural\"</p>\n</blockquote>\n<p>Could it not be said that this means PosSemidef is also not natural?</p>",
        "id": 535345163,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755705127
    },
    {
        "content": "<p>My point with <code>Matrix.PosSemidef.sqrt</code> is not that we should replace its definition with <code>CFC.sqrt</code>, but that we should remove it entirely. For that reason, I think Eric's comment:<br>\n<span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/negative.20.28semi-.29definite.20matrices/near/535321476\">said</a>:</p>\n<blockquote>\n<p>I think we could PR the above without first deciding what to do about sqrt?</p>\n</blockquote>\n<p>doesn't make any sense because we would be adding more things which depend on something that will be ripped out anyway.</p>",
        "id": 535345203,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755705143
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/negative.20.28semi-.29definite.20matrices/near/535345163\">said</a>:</p>\n<blockquote>\n<p>Could it not be said that this means PosSemidef is also not natural?</p>\n</blockquote>\n<p>I think <code>PosSemidef</code> on <code>‚Ñ§</code> is <em>probably</em> pointless, but <span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span>, but it's not doing so much harm to have a definition lying around unused in certain contexts. It's much worse to have an <em>instance</em> which could be (surprisingly!) available that is useless.</p>",
        "id": 535345502,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755705251
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"477483\">Monica Omar</span> <a href=\"#narrow/channel/287929-mathlib4/topic/negative.20.28semi-.29definite.20matrices/near/535317878\">said</a>:</p>\n<blockquote>\n<p>so should I work on this? deprecate <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matrix.PosSemidef.sqrt#doc\">docs#Matrix.PosSemidef.sqrt</a> and use the continuous functional calculus instead?</p>\n</blockquote>\n<p>I'll give it a few days to see if there's any objections with removing <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matrix.PosSemidef.sqrt#doc\">docs#Matrix.PosSemidef.sqrt</a>, before I work on it then</p>",
        "id": 535346288,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755705502
    },
    {
        "content": "<p>To me, defining <code>LE</code> on integer matrices even though they don't form a star-ordered ring doesn't sound any worse than defining subtraction on nat even though it doesn't form an additive group</p>",
        "id": 535372358,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755715921
    },
    {
        "content": "<p>I think as long as the LE is defined such that <code>A &lt;= B \\iff (A.map Int.cast) &lt;=  (B.map Int.cast)</code> then the instance is not surprising</p>",
        "id": 535372429,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755715959
    },
    {
        "content": "<p>yeah, that's fair</p>",
        "id": 535384536,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755721317
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/negative.20.28semi-.29definite.20matrices/near/535372429\">said</a>:</p>\n<blockquote>\n<p>I think as long as the LE is defined such that <code>A &lt;= B \\iff (A.map Int.cast) &lt;=  (B.map Int.cast)</code> then the instance is not surprising</p>\n</blockquote>\n<p>so something like this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">RCLike</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LE</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">‚ü®</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">PosSemidef</span><span class=\"bp\">‚ü©</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">instLE'</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LE</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">‚ü®</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">‚ü©</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LE</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">‚Ñ§</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">instLE'</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">Int</span><span class=\"bp\">.</span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">‚Ñ§</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">@</span><span class=\"n\">Int</span><span class=\"bp\">.</span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"bp\">.</span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Iff</span><span class=\"bp\">.</span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 535384924,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755721510
    },
    {
        "content": "<p>I don't think that instance works since you can't infer <code>ùïú</code></p>",
        "id": 535385964,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755721984
    },
    {
        "content": "<p>oh what it works that was surprising</p>",
        "id": 535386164,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755722081
    },
    {
        "content": "<p>but you get diamonds when it infers the wrong <code>ùïú</code></p>",
        "id": 535386197,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755722094
    },
    {
        "content": "<p>change it to the reals or complex then perhaps?</p>",
        "id": 535386464,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755722217
    },
    {
        "content": "<p>There is probably more code to take from <a href=\"https://github.com/Timeroot/Lean-QuantumInfo/blob/main/QuantumInfo/ForMathlib/Matrix.lean\">https://github.com/Timeroot/Lean-QuantumInfo/blob/main/QuantumInfo/ForMathlib/Matrix.lean</a> if you would like</p>",
        "id": 535387165,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1755722565
    },
    {
        "content": "<p>I think most of that is already in <code>Mathlib</code> or are PR-ed (like the kronecker product ones)<br>\nfrom skimming the code, I think we only don't have the <code>StarOrderedRing</code> stuff (and related stuff like the partial order etc)</p>",
        "id": 535387782,
        "sender_full_name": "Monica Omar",
        "timestamp": 1755722891
    },
    {
        "content": "<p>I guess I don't know about other PRs, but I think almost none of that is currently in Mathlib<br>\n(e.g. no hits on loogle for <code>_ ‚Ä¢ _, Matrix.PosSemidef</code>, <code>Matrix.trace, Matrix.PosSemidef</code>, <code>Matrix.PosDef, Matrix.submatrix</code> .. there's a lot of lexical gaps!)<br>\nbut yes I mostly meant the <code>section partialOrder</code> as relevant to this discussion <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 535388377,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1755723182
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/negative.20.28semi-.29definite.20matrices/near/535372358\">said</a>:</p>\n<blockquote>\n<p>To me, defining <code>LE</code> on integer matrices even though they don't form a star-ordered ring doesn't sound any worse than defining subtraction on nat even though it doesn't form an additive group</p>\n</blockquote>\n<p>I disagree here. There's at least a <em>reason</em> to define <code>-</code> on <code>‚Ñï</code> (which is that <code>‚Ñï</code> is ubiquitous and having all the basic operations is important). In contrast, I don't see any real reason to define a partial order on <code>Matrix n n ‚Ñ§</code>. Why do we need it?</p>",
        "id": 535393640,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755726061
    },
    {
        "content": "<p>The main benefit would be that we can drop PosSemidef entirely and use <code>0 ‚â§ M</code> notation</p>",
        "id": 535401314,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755730471
    },
    {
        "content": "<p>Eric, when do you <em>ever</em> want to talk about positive semidefiniteness of a matrix with integer entries (regardless of which notation you use)?</p>",
        "id": 535416968,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755742809
    },
    {
        "content": "<p>The Fourier expansion of a degree g Siegel modular form is a sum over positive semidefinite integral binary quadratic forms in g variables, which is almost symmetric positive semidefinite gxg matrices with integer entries, except that half-integers are allowed off the diagonal.</p>",
        "id": 535544411,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1755795621
    },
    {
        "content": "<p>So they are terms of <code>A : Matrix g g ‚Ñ§[1/2]</code> (I don't know what the Mathlib notation is for that) satisfying <code>PosSemidef A</code> according to the definition above? Would you like to be able to phrase the latter as <code>0 ‚â§ A</code>?</p>",
        "id": 535549017,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755797440
    },
    {
        "content": "<p>Usually people just sum over all binary quadratic forms and then occasionally remark that the coefficient is zero unless the binary quadratic form is positive semidefinite. This is really a theory about quadratic forms not matrices, it's not Z[1/2] it's Z/2 for example</p>",
        "id": 535550542,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1755798027
    },
    {
        "content": "<p>My question is mainly: despite this being an interesting example of positive semidefinite matrices over things other than <code>‚Ñù</code> or <code>‚ÑÇ</code> occuring in practice, you still never really want to discuss it in the language of positive semidefinite matrices, correct?</p>",
        "id": 535550976,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1755798205
    },
    {
        "content": "<p>I think that formally I would rather discuss it in the language of positive semidefinite binary quadratic forms, because it seems to me to be a bit of a mess talking about positive semidefinite matrices whose diagonal entries are integers and whose off-diagonal entries are half-integers.</p>",
        "id": 535559522,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1755801774
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/negative.20.28semi-.29definite.20matrices/near/535345203\">said</a>:</p>\n<blockquote>\n<p>My point with <code>Matrix.PosSemidef.sqrt</code> is not that we should replace its definition with <code>CFC.sqrt</code>, but that we should remove it entirely. For that reason, I think Eric's comment:<br>\n<span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/negative.20.28semi-.29definite.20matrices/near/535321476\">said</a>:</p>\n<blockquote>\n<p>I think we could PR the above without first deciding what to do about sqrt?</p>\n</blockquote>\n<p>doesn't make any sense because we would be adding more things which depend on something that will be ripped out anyway.</p>\n</blockquote>\n<p>I'm a bit confused. Are we just literally wanting to remove the definition <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matrix.PosSemidef.sqrt#doc\">docs#Matrix.PosSemidef.sqrt</a> or are we wanting to do more? Because, in order to use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CFC.sqrt_sq#doc\">docs#CFC.sqrt_sq</a> for example, we'd need <code>PartialOrder</code> and <code>StarOrderedRing</code>.<br>\nSo, I'm not sure how we're supposed to remove results like <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matrix.PosSemidef.sqrt_sq#doc\">docs#Matrix.PosSemidef.sqrt_sq</a> if they're used to show <code>PartialOrder</code> and <code>StarOrderedRing</code> on matrices.<br>\nAll I've done so far is remove the definition <code>PosSemidef.sqrt</code> and use <code>cfc Real.sqrt _</code> instead in the results.</p>",
        "id": 540658775,
        "sender_full_name": "Monica Omar",
        "timestamp": 1758462128
    },
    {
        "content": "<p>I can detail this later today or tomorrow.</p>",
        "id": 540660394,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1758463863
    },
    {
        "content": "<p>It can surely be cleaned up, but adding this gives you access to the continuous functional calculus for nonnegative elements (and hence <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CFC.sqrt#doc\">docs#CFC.sqrt</a>).</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">CStarAlgebra</span><span class=\"bp\">.</span><span class=\"n\">ContinuousFunctionalCalculus</span><span class=\"bp\">.</span><span class=\"n\">Instances</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">Matrix</span><span class=\"bp\">.</span><span class=\"n\">HermitianFunctionalCalculus</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">Matrix</span><span class=\"bp\">.</span><span class=\"n\">PosDef</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">RCLike</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">]</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Matrix</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">ComplexOrder</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PartialOrder</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">le</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">PosSemidef</span>\n<span class=\"w\">  </span><span class=\"n\">le_refl</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sub_self</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"n\">PosSemidef</span><span class=\"bp\">.</span><span class=\"n\">zero</span>\n<span class=\"w\">  </span><span class=\"n\">le_trans</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">sub_add_sub_cancel</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÅ</span>\n<span class=\"w\">  </span><span class=\"n\">le_antisymm</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">neg_sub</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">trace_nonneg</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span><span class=\"bp\">.</span><span class=\"n\">trace_nonneg</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">trace_neg</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">neg_nonneg</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">foo</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trace</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">le_antisymm</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"n\">bar</span>\n<span class=\"w\">    </span><span class=\"n\">classical</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">sub_eq_zero</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span><span class=\"bp\">.</span><span class=\"n\">isHermitian</span><span class=\"bp\">.</span><span class=\"n\">eigenvalues_eq_zero_iff</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h‚ÇÇ</span><span class=\"bp\">.</span><span class=\"n\">isHermitian</span><span class=\"bp\">.</span><span class=\"n\">trace_eq_sum_eigenvalues</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">RCLike</span><span class=\"bp\">.</span><span class=\"n\">ofReal_sum</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">this</span>\n<span class=\"w\">    </span><span class=\"n\">norm_cast</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">this</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">univ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">sum_const_zero</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">eq_comm</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">sum_eq_sum_iff_of_le</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span><span class=\"bp\">.</span><span class=\"n\">eigenvalues_nonneg</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">this</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">|&gt;.</span><span class=\"n\">symm</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">le_iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">PosSemidef</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Iff</span><span class=\"bp\">.</span><span class=\"n\">rfl</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">nonneg_iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"bp\">.</span><span class=\"n\">PosSemidef</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">le_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sub_zero</span><span class=\"o\">]</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsOrderedAddMonoid</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">add_le_add_left</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rwa</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">le_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">add_sub_add_left_eq_sub</span><span class=\"o\">]</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NonnegSpectrumClass</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">quasispectrum_nonneg_of_nonneg</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">hA</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">classical</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">quasispectrum_eq_spectrum_union_zero</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">union_singleton</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">mem_insert_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">forall_eq_or_imp</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">le_refl</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">true_and</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">nonneg_iff</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hA</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hA</span><span class=\"bp\">.</span><span class=\"n\">isHermitian</span><span class=\"bp\">.</span><span class=\"n\">spectrum_real_eq_range_eigenvalues</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">rintro</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hA</span><span class=\"bp\">.</span><span class=\"n\">eigenvalues_nonneg</span><span class=\"w\"> </span><span class=\"n\">x</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">StarOrderedRing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">.</span><span class=\"n\">of_nonneg_iff'</span><span class=\"w\"> </span><span class=\"n\">add_le_add_left</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">constructor</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">hA</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">QuasispectrumRestricts</span><span class=\"bp\">.</span><span class=\"n\">nnreal_of_nonneg</span><span class=\"w\"> </span><span class=\"n\">hA</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">nonneg_iff</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hA</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hA'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsSelfAdjoint</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hA</span><span class=\"bp\">.</span><span class=\"n\">isHermitian</span>\n<span class=\"w\">      </span><span class=\"n\">classical</span>\n<span class=\"w\">      </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">X</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hX</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">        </span><span class=\"n\">CFC</span><span class=\"bp\">.</span><span class=\"n\">exists_sqrt_of_isSelfAdjoint_of_quasispectrumRestricts</span><span class=\"w\"> </span><span class=\"n\">hA'</span><span class=\"w\"> </span><span class=\"n\">this</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">X</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hX</span><span class=\"bp\">.</span><span class=\"n\">star_eq</span><span class=\"o\">]</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">rintro</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">A</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">nonneg_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">star_eq_conjTranspose</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">posSemidef_conjTranspose_mul_self</span><span class=\"w\"> </span><span class=\"n\">A</span>\n</code></pre></div>",
        "id": 540888300,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1758572094
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/29896\">#29896</a><br>\nI move a lot of results around, so there's a lot of noise</p>",
        "id": 540899313,
        "sender_full_name": "Monica Omar",
        "timestamp": 1758577462
    },
    {
        "content": "<p>Did this partial order on matrices make it into Mathlib?<br>\nI can prove that a positive semidefinite matrix (or a positive map) has a square root in the matrix context but how to do so in the CStarAlgebra context?</p>",
        "id": 569642261,
        "sender_full_name": "Bj√∏rn Kjos-Hanssen",
        "timestamp": 1769149054
    },
    {
        "content": "<p>Yes, it's available within the <code>MatrixOrder</code> scope.</p>",
        "id": 569718126,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1769175838
    },
    {
        "content": "<p>Just use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CFC.sqrt#doc\">docs#CFC.sqrt</a>. It is nonnegative <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CFC.sqrt_nonneg#doc\">docs#CFC.sqrt_nonneg</a>, and it is the unique nonnegative square root <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CFC.sqrt_eq_iff#doc\">docs#CFC.sqrt_eq_iff</a>.</p>",
        "id": 569718432,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1769175923
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"197836\">@Jireh Loreaux</span> (Not sure how someone would discover <code>MatrixOrder</code> independently though, it doesn't even show up in the Mathlib docs search bar.)</p>",
        "id": 569782770,
        "sender_full_name": "Bj√∏rn Kjos-Hanssen",
        "timestamp": 1769193629
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 569789578,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1769196534
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span>  ‚ä¢ PartialOrder (Matrix _ _ _)</p>",
        "id": 569789652,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1769196565
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Matrix/Order.html#Matrix.instPartialOrder\">Matrix.instPartialOrder</a></p>",
        "id": 569789655,
        "sender_full_name": "loogle",
        "timestamp": 1769196566
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"347475\">@Bj√∏rn Kjos-Hanssen</span> That's how I would. If you see that it's not an <code>instance</code> (although I'm not sure why it's marked <code>abbrev</code>), you can know that it's not a globally available instance. If you click the \"source\" button, then you'll see:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">scoped</span><span class=\"o\">[</span><span class=\"n\">MatrixOrder</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">attribute</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"kn\">instance</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"bp\">.</span><span class=\"n\">instPartialOrder</span>\n</code></pre></div>\n<p>However, I'll admit that it should be present in the docstring in the form of a comment, like: \"This is available as an instance in the scope <code>MatrixOrder</code>.\"</p>",
        "id": 569790056,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1769196743
    },
    {
        "content": "<p>Note, that if you want the <code>StarOrderedRing</code> instance, that's available too: <span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> StarOrderedRing (Matrix _ _ _)</p>",
        "id": 569790130,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1769196780
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Matrix/Order.html#Matrix.instStarOrderedRing\">Matrix.instStarOrderedRing</a></p>",
        "id": 569790132,
        "sender_full_name": "loogle",
        "timestamp": 1769196781
    },
    {
        "content": "<blockquote>\n<p>\"This is available as an instance in the scope¬†<code>MatrixOrder</code>.\"</p>\n</blockquote>\n<p>This is in the module documentation. I guess it's not a bad idea to also add it for the definitions <code>instPartialOrder</code> and the star order (maybe the same for <code>ComplexOrder</code>)</p>",
        "id": 569791525,
        "sender_full_name": "Monica Omar",
        "timestamp": 1769197430
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> ¬†¬†‚ä¢ PartialOrder (Matrix _ _ _)</p>",
        "id": 569792183,
        "sender_full_name": "Bj√∏rn Kjos-Hanssen",
        "timestamp": 1769197727
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Matrix/Order.html#Matrix.instPartialOrder\">Matrix.instPartialOrder</a></p>",
        "id": 569792189,
        "sender_full_name": "loogle",
        "timestamp": 1769197728
    },
    {
        "content": "<p>(Why does <span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> not work in messages with myself...)</p>",
        "id": 569792310,
        "sender_full_name": "Bj√∏rn Kjos-Hanssen",
        "timestamp": 1769197768
    },
    {
        "content": "<p><span aria-label=\"exclamation\" class=\"emoji emoji-2757\" role=\"img\" title=\"exclamation\">:exclamation:</span> &lt;input&gt;:1:9: expected end of input</p>",
        "id": 569792312,
        "sender_full_name": "loogle",
        "timestamp": 1769197769
    },
    {
        "content": "<p>Because the bot doesn't have access to your DMs.</p>",
        "id": 569793670,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1769198275
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"347475\">Bj√∏rn Kjos-Hanssen</span> <a href=\"#narrow/channel/287929-mathlib4/topic/negative.20.28semi-.29definite.20matrices/near/569792310\">said</a>:</p>\n<blockquote>\n<p>(Why does <span class=\"user-mention silent\" data-user-id=\"644391\">loogle</span> not work in messages with myself...)</p>\n</blockquote>\n<p>because it is not part of the conversation with yourself. instead, you should try direct messages to the bot.</p>",
        "id": 569794709,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1769198718
    },
    {
        "content": "<p>those have worked for me in the past</p>",
        "id": 569794739,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1769198733
    }
]