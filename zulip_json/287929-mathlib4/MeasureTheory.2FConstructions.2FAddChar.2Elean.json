[
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AddChar.instMeasurableSpace#doc\">docs#AddChar.instMeasurableSpace</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AddChar.instDiscreteMeasurableSpace#doc\">docs#AddChar.instDiscreteMeasurableSpace</a> take only an <code>AddMonoid</code> assumption on <code>A</code>.  However, the module docs claims</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">endows</span><span class=\"w\"> </span><span class=\"ss\">`AddChar</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">discrete</span><span class=\"w\"> </span><span class=\"n\">measurable</span><span class=\"w\"> </span><span class=\"n\">space</span><span class=\"w\"> </span><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">whenever</span><span class=\"w\"> </span><span class=\"ss\">`A</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"ss\">`M</span><span class=\"bp\">`</span>\n<span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">themselves</span><span class=\"w\"> </span><span class=\"n\">discrete</span><span class=\"w\"> </span><span class=\"n\">measurable</span><span class=\"w\"> </span><span class=\"n\">spaces</span><span class=\"bp\">.</span>\n</code></pre></div>\n<p>and the variables</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DiscreteMeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DiscreteMeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>present in the file, do not actually make it into the definition.  I suspect that something is off here, right?</p>\n<p>I'll ping <span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> as author of the file, but I have not investigated who actually introduced this.</p>",
        "id": 479884521,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730383186
    },
    {
        "content": "<p>Indeed that's an accident</p>",
        "id": 479888417,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730384205
    },
    {
        "content": "<p>I noticed thanks to the linter that warned me of unused <code>variable</code>s and when I saw the file I thought \"here is a bug that I will have to fix\", but now it seems that this is a bug for you!  <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 479888606,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730384281
    },
    {
        "content": "<p>I am not sure how to proceed, though, since I do not think that <code>include</code> works with the \"old\" <code>variable</code> inclusion mechanism that <code>instance</code>s use.</p>",
        "id": 479888903,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730384379
    },
    {
        "content": "<p>I think they can just be moved to the statements?</p>",
        "id": 479889125,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730384440
    },
    {
        "content": "<p>Ok, does this look alright?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">AddChar</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddMonoid</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Monoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">instMeasurableSpace</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DiscreteMeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DiscreteMeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">AddChar</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⊤</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">instDiscreteMeasurableSpace</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DiscreteMeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DiscreteMeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">DiscreteMeasurableSpace</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">AddChar</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">trivial</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">AddChar</span>\n</code></pre></div>",
        "id": 479889547,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730384562
    },
    {
        "content": "<p>(I also checked that the linter does not complain about unused variables and hovers show that all variables are now included in the declarations.)</p>",
        "id": 479889709,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730384610
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/18494\">#18494</a></p>",
        "id": 479890146,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730384751
    }
]