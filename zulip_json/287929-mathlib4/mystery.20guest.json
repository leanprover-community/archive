[
    {
        "content": "<p>I have a file with</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">instENatCanonicallyOrderedCommSemiring</span>\n<span class=\"c1\">-- instENatCanonicallyOrderedCommSemiring : CanonicallyOrderedCommSemiring ℕ∞</span>\n</code></pre></div>\n<p>but I can not jump to definition on <code>instENatCanonicallyOrderedCommSemiring</code> and I can also not find that declaration by grepping for it... what's going on?</p>",
        "id": 479820367,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1730360744
    },
    {
        "content": "<p>It's from <a href=\"https://github.com/leanprover-community/mathlib4/blob/2959869cae3984b89b9038d57e2b3865a23c59a1/Mathlib/Data/ENat/Basic.lean#L27\">https://github.com/leanprover-community/mathlib4/blob/2959869cae3984b89b9038d57e2b3865a23c59a1/Mathlib/Data/ENat/Basic.lean#L27</a></p>",
        "id": 479820621,
        "sender_full_name": "Markus Himmel",
        "timestamp": 1730360851
    },
    {
        "content": "<p>Aah! Thanks</p>",
        "id": 479820710,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1730360883
    },
    {
        "content": "<ol>\n<li>How did you find it?</li>\n<li>Should jump to definition jump to that line?</li>\n</ol>",
        "id": 479820748,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1730360901
    },
    {
        "content": "<ol start=\"3\">\n<li>Should it be listed in the docs?</li>\n</ol>",
        "id": 479820796,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1730360922
    },
    {
        "content": "<ol>\n<li>I put <code>instENatCanonicallyOrderedCommSemiring</code> into Loogle, which sent me to <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Data/ENat/Basic.html#instENatCanonicallyOrderedCommSemiring\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Data/ENat/Basic.html#instENatCanonicallyOrderedCommSemiring</a> which doesn't show it on the page (I have had this before with <code>deriving ... for ...</code>), so I looked at the source of the file.</li>\n<li>I think it would be good to report this to lean4</li>\n<li>I think it would be good to report this to doc-gen</li>\n</ol>",
        "id": 479821143,
        "sender_full_name": "Markus Himmel",
        "timestamp": 1730361121
    },
    {
        "content": "<p>This should be fixed in <a href=\"https://github.com/leanprover/lean4/pull/5899\">lean4#5899</a></p>",
        "id": 479832612,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1730365639
    },
    {
        "content": "<p>There are still a number of instances from deriving handlers that are missing declaration range information, so be sure to report further issues like this!</p>",
        "id": 479832944,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1730365741
    },
    {
        "content": "<p>I am not sure if these count as missing declaration ranges, but <code>notation</code> does not produce a <code>selectionRange</code>, while, for instance, <code>syntax</code> does.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Command</span>\n\n<span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"s2\">\"NN\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"NNstx\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">info: termNN</span>\n<span class=\"sd\">(⟨1, 0⟩, ⟨1, 0⟩)</span>\n<span class=\"sd\">(⟨3, 0⟩, ⟨3, 20⟩)</span>\n<span class=\"sd\">---</span>\n<span class=\"sd\">info: termNNstx</span>\n<span class=\"sd\">(⟨5, 0⟩, ⟨5, 6⟩)</span>\n<span class=\"sd\">(⟨5, 0⟩, ⟨5, 21⟩)</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"n\">run_cmd</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">nms</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"ss\">`termNN</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"ss\">`termNNstx</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">nm</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">nms</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">rgs</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">findDeclarationRanges?</span><span class=\"w\"> </span><span class=\"n\">nm</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">getD</span><span class=\"w\"> </span><span class=\"n\">default</span>\n<span class=\"w\">    </span><span class=\"n\">logInfo</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\"{nm}</span><span class=\"se\">\\n\\</span>\n<span class=\"s2\">              {(rgs.selectionRange.pos, rgs.selectionRange.endPos)}</span><span class=\"se\">\\n\\</span>\n<span class=\"s2\">              {(rgs.range.pos, rgs.range.endPos)}\"</span>\n</code></pre></div>\n<p>I would have guessed that <code>notation</code> would also assign <code>notation</code> as the <code>selectionRange</code> for <code>NN</code>, analogously to what <code>syntax</code> does.</p>",
        "id": 480349138,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730678804
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span>, I guess....</p>",
        "id": 480369768,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1730697846
    }
]