[
    {
        "content": "<p>What is the status of the unused argument linter in mathlib? I just reviewed a PR in which there was a plain unused argument (I mean, an obvious one, like <code>(hJ_card : #J ≤ a ^ n)</code> in the lemma statement, that did not show up at all in the proof), and no linter complaint.</p>",
        "id": 544981749,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1760537979
    },
    {
        "content": "<p>are you sure it isn't accidentally used by grind or something?</p>",
        "id": 544982647,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760538180
    },
    {
        "content": "<p>They should be enabled (They = both the style and the environment linter). I think that Kenny is right, and maybe <code>rw at *</code>, <code>simp [*]</code> or <code>grind</code> used it to simplify something (or simplified something in the hypothesis), even though it didn't <em>really</em> get used.</p>",
        "id": 544983067,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1760538286
    },
    {
        "content": "<p>or maybe it got generalized in an <code>induction</code> call, for example</p>",
        "id": 544983779,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760538431
    },
    {
        "content": "<p>You're probably right that it must be used implicitly somewhere. I can't see where, though (no <code>grind</code>, no <code>induction</code>, no <code>*</code>). You can have a look at <a href=\"https://github.com/DavidLedvinka/mathlib4/blob/6633b19fc80192dc25c645c92ba624596de16b60/Mathlib/Topology/EMetricSpace/PairReduction.lean#L356\">https://github.com/DavidLedvinka/mathlib4/blob/6633b19fc80192dc25c645c92ba624596de16b60/Mathlib/Topology/EMetricSpace/PairReduction.lean#L356</a></p>",
        "id": 544984432,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1760538581
    },
    {
        "content": "<p>definitely probably the <code>wlog</code></p>",
        "id": 544986252,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760538981
    },
    {
        "content": "<p>try <code>obtain rfl | hJ := J.eq_empty_or_nonempty</code> instead</p>",
        "id": 544986820,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760539101
    },
    {
        "content": "<p>Nope. Using</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"n\">rcases</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">eq_empty_or_nonempty</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">hJ</span>\n</code></pre></div>\n<p>the linter doesn't complain.</p>",
        "id": 544987213,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1760539195
    },
    {
        "content": "<p>The <code>rfl</code> in the pattern <code>rfl | hJ</code> substitutes away <code>#J</code> everywhere, including in hypothesis <code>hJ_card</code>, so it is \"used\".</p>",
        "id": 544993377,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1760540637
    },
    {
        "content": "<p>It was the <code>wlog</code>; replacing the first two lines with the following activates the linter</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"n\">hJ</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">hJ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"bp\">.</span><span class=\"n\">eq_empty_or_nonempty</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hJ</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 544993605,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1760540696
    },
    {
        "content": "<p>It would be nice to improve the linter and catch these cases. <br>\nMaybe it's possible to recognize that the hypothesis <code>hJ_card</code> before executing <code>obtain rfl | hJ</code> and the hypothesis <code>hJ_card</code> after the tactic are \"the same\" hypothesis, and since the latter is never used, the former is also never used. <br>\nThis sounds hard, but if we can do this, we might be able to do the same for <code>rw at hJ_card</code>, <code>induction ... generalizing hJ_card</code> etc.</p>",
        "id": 544994318,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1760540875
    }
]