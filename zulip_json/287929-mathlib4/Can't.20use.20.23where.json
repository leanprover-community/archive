[
    {
        "content": "<p>What happened to <code>#where</code>? We seem to not be able to use it in mathlib anymore</p>",
        "id": 453889626,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1721897362
    },
    {
        "content": "<p>It's working fine for me in this random file I have open...oh, in the filter game, which is on 4.7 (because lean4game is on 4.7). It was in <code>Std.Tactic.Where</code>back then.</p>",
        "id": 453891581,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1721897834
    },
    {
        "content": "<p>Uh oh, maybe <code>#where</code> fell victim to <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span>'s import reduction?</p>",
        "id": 453891895,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1721897904
    },
    {
        "content": "<p>could we maybe upstream tactics like this to batteries?</p>",
        "id": 453945920,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1721913203
    },
    {
        "content": "<p>This works:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">Where</span>\n\n<span class=\"bp\">#</span><span class=\"kn\">where</span>\n</code></pre></div>\n<p>so the upstreaming seems to have happened already.</p>",
        "id": 453946424,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1721913317
    },
    {
        "content": "<p>But then I think that it is only imported in <code>Mathlib/Mathport/Syntax.lean</code>.</p>",
        "id": 453946744,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1721913381
    },
    {
        "content": "<p>It's been there the whole time (it <a href=\"https://github.com/leanprover-community/batteries/pull/147\">started in Std</a>). It must have just lost its import in Mathlib.Tactic.Common somehow.</p>",
        "id": 454021409,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1721931504
    },
    {
        "content": "<p>Huh, it's never been imported in Mathlib.Tactic.Common. Maybe there was a stray <code>import Std</code> somewhere in mathlib that was cleaned up?</p>",
        "id": 454023036,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1721931782
    },
    {
        "content": "<p>Yeah, I believe Kim precisely cleaned this up recently</p>",
        "id": 454025233,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1721932186
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15139\">#15139</a></p>",
        "id": 454025733,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1721932328
    },
    {
        "content": "<p>On a related note, I haven't been able to use <code>conv?</code> for a while now. Was it also the victim of that import reduction?</p>",
        "id": 454035295,
        "sender_full_name": "Frédéric Dupuis",
        "timestamp": 1721935541
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"311453\">@Frédéric Dupuis</span> It's imported in <code>Mathlib.Tactic.Common</code> (see <code>import Mathlib.Tactic.Widget.Conv</code>), so I'm not sure why you can't use <code>conv?</code>, unless you're working in some very low level files.</p>",
        "id": 454035877,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1721935696
    },
    {
        "content": "<p>On current mathlib master:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">Widget</span><span class=\"bp\">.</span><span class=\"n\">Conv</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">conv?</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>I get the error <code>Error: The requested module 'blob:vscode-webview://176jrrsir8dt89g7e8g7qg35rpp6otm44id6t93mjif424eb3aen/efada8ef-24d7-4352-a41b-d1d17181cb08' does not provide an export named 'useRpcSession'</code> in red in the Lean infoview and <code>conv?</code> doesn't do anything.</p>",
        "id": 454037017,
        "sender_full_name": "Frédéric Dupuis",
        "timestamp": 1721936116
    },
    {
        "content": "<p>I don't get any errors with that script on <code>cc495260156b40dcbd55b947c047061e15344000</code> which is a commit from today. It's also fine on the lean 4 playground.</p>",
        "id": 454045976,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1721938464
    },
    {
        "content": "<p>Very strange. I've been getting this error on the two computers that I use regularly for some time now.</p>",
        "id": 454050281,
        "sender_full_name": "Frédéric Dupuis",
        "timestamp": 1721939760
    },
    {
        "content": "<p>The above MWE was on commit <code>63341a2ea2f7c99ff4315e13c763dca1bfd13d7d</code>, so only <br>\ntwo commits newer than Kevin's.</p>",
        "id": 454050976,
        "sender_full_name": "Frédéric Dupuis",
        "timestamp": 1721940117
    },
    {
        "content": "<p>Maybe if you delete your .lake folder and get a fresh cache it'll magically start working?</p>",
        "id": 454054080,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1721941553
    },
    {
        "content": "<p>yeah <code>conv?</code> is working fine for me with that code above on <code>63341a2ea2f7c99ff4315e13c763dca1bfd13d7d</code>, I can shift click, all looks normal.</p>",
        "id": 454055368,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1721942109
    },
    {
        "content": "<p>Deleting <code>.lake</code> doesn't do anything. The problem appears to be system-wide, I get it in every project I have and every copy of mathlib.</p>",
        "id": 454068068,
        "sender_full_name": "Frédéric Dupuis",
        "timestamp": 1721949018
    },
    {
        "content": "<p>What's your vscode version?</p>",
        "id": 454155529,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1721964085
    },
    {
        "content": "<p>Here's what I got from Help -&gt; About:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Version</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.91</span><span class=\"bp\">.</span><span class=\"m\">0</span>\n<span class=\"n\">Commit</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ea1445cc7016315d0f5728f8e8b12a45dc0a7286</span>\n<span class=\"n\">Date</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2024</span><span class=\"bp\">-</span><span class=\"mi\">07</span><span class=\"bp\">-</span><span class=\"mi\">03</span><span class=\"n\">T20</span><span class=\"o\">:</span><span class=\"mi\">40</span><span class=\"o\">:</span><span class=\"mf\">42.797</span><span class=\"n\">Z</span>\n<span class=\"n\">Electron</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">29.4</span><span class=\"bp\">.</span><span class=\"m\">3</span>\n<span class=\"n\">ElectronBuildId</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">undefined</span>\n<span class=\"n\">Chromium</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">122.0</span><span class=\"bp\">.</span><span class=\"m\">6261</span><span class=\"bp\">.</span><span class=\"m\">156</span>\n<span class=\"n\">Node</span><span class=\"bp\">.</span><span class=\"n\">js</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">20.9</span><span class=\"bp\">.</span><span class=\"m\">0</span>\n<span class=\"n\">V8</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">12.2</span><span class=\"bp\">.</span><span class=\"m\">281</span><span class=\"bp\">.</span><span class=\"m\">27</span><span class=\"bp\">-</span><span class=\"n\">electron</span><span class=\"bp\">.</span><span class=\"m\">0</span>\n<span class=\"n\">OS</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Linux</span><span class=\"w\"> </span><span class=\"n\">x64</span><span class=\"w\"> </span><span class=\"mf\">6.6</span><span class=\"bp\">.</span><span class=\"m\">38</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">-</span><span class=\"n\">lts</span>\n</code></pre></div>",
        "id": 454161484,
        "sender_full_name": "Frédéric Dupuis",
        "timestamp": 1721966267
    },
    {
        "content": "<p>I'm getting the same error message.  It seems to appear only when I place the cursor inside a <code>calc</code> proof.  <span class=\"user-mention\" data-user-id=\"311453\">@Frédéric Dupuis</span> did you ever figure out why this occurs and/or resolve it?</p>",
        "id": 464899574,
        "sender_full_name": "William DeMeo",
        "timestamp": 1724532089
    },
    {
        "content": "<p>No, I never figured it out, and it's still happening right now on mathlib from yesterday.</p>",
        "id": 464922903,
        "sender_full_name": "Frédéric Dupuis",
        "timestamp": 1724551274
    },
    {
        "content": "<p>OK, I just did figure out: I was using an absolutely antiquated version of the VSCode extension (v0.0.125), despite the fact that \"Auto update\" was supposedly on.</p>",
        "id": 465059555,
        "sender_full_name": "Frédéric Dupuis",
        "timestamp": 1724635144
    },
    {
        "content": "<p>So does that mean everything works as expected?</p>\n<p>I didn't quite get from <span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span>'s <a href=\"#narrow/stream/287929-mathlib4/topic/.23where.20broken/near/464490084\">message here</a> whether we messed up something when making the changes to the lakefile about the mathlib-only linters or if it's all fine.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/287929-mathlib4/topic/.23where.20broken/near/464490084\">said</a>:</p>\n<blockquote>\n<p>This looks kind of wrong... are we sure the lakefile is set up correctly?<br>\n[...]<br>\nApparently, weak options are handled by putting things in the <code>Options</code> struct which are not known to be options, meaning that code which handles options now has to be aware of this and deal with undefined options. My point above is that even after doing so, the results suggest that either lean is incorrectly setting the <code>Options</code> struct, or mathlib's lakefile is misconfigured, because I don't think there are supposed to be options literally containing <code>weak.*</code> in them, that's supposed to be a syntax just for the command line parser AFAIK</p>\n</blockquote>",
        "id": 465186792,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1724679074
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 465369934,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1724747961
    }
]