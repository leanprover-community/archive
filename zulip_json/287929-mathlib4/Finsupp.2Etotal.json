[
    {
        "content": "<p>Returning to MIL writing, I need to explain <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finsupp.total#doc\">docs#Finsupp.total</a>. But I have no clue why we need to suffer with all those explicit arguments. I understand that a fully unapplied <code>Finsupp.total</code> is fully ambiguous, and I understand we want a linear map so a partially applied one makes sense. But why are the indexing type <code>α</code> and the module type <code>M</code> explicit? Why not keeping only the ring <code>R</code> explicit?</p>",
        "id": 465749408,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724847862
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"238446\">@Anne Baanen</span>, do you know about this?</p>",
        "id": 465749575,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724847888
    },
    {
        "content": "<p>I suspect this is legacy from an old Lean 3 version where failing to fill in all the arguments would block the search for a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CoeFun#doc\">docs#CoeFun</a> instance. Nowadays I don't see why we can't leave everything implicit and use <code>(R := _)</code> notation if we do need to supply them.</p>",
        "id": 465762646,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1724850719
    },
    {
        "content": "<p>I think having <code>R</code> implicit is a bit too much. There is no way we can partially apply it without providing <code>R</code>.</p>",
        "id": 465763339,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724850830
    },
    {
        "content": "<p>I agree that R should be explicit and the rest implicit</p>",
        "id": 465763663,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1724850881
    },
    {
        "content": "<p>I will work on refactoring this.</p>",
        "id": 465772065,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724852563
    },
    {
        "content": "<p>I’m done. I opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/16221\">#16221</a>. It touches only 29 files, which is less than what I expected. I think even lines that got longer are now more readable.</p>",
        "id": 465803289,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724860470
    },
    {
        "content": "<p>Next I would like to bikeshed a bit the name of this function. I have no idea where this names comes from, and I think it is pretty hard to guess. Is there any downside to renaming it <code>linear_combination</code> (besides the clash with tactic name)?</p>",
        "id": 465804077,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724860741
    },
    {
        "content": "<p>or <code>Finsupp.linear_combination</code></p>",
        "id": 465804143,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724860762
    },
    {
        "content": "<p><code>Finsupp.linearCombination</code> would be the <a href=\"https://leanprover-community.github.io/contribute/naming.html\">#naming</a>-approved spelling</p>",
        "id": 465807799,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1724861834
    },
    {
        "content": "<p>Yes, good point.</p>",
        "id": 465808237,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724861968
    },
    {
        "content": "<p>That sounds better than <code>total</code> to me, though my (controversial?) take here is that <code>Finsupp.total R v v'</code> (with the second argument present) should not be the simp-normal form and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finsupp.total_apply#doc\">docs#Finsupp.total_apply</a> should be <code>simp</code>.</p>",
        "id": 465808820,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1724862143
    },
    {
        "content": "<p>That’s yet another question, right?</p>",
        "id": 465809008,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724862225
    },
    {
        "content": "<p>Yes, and so I would be happy to merge a rename / deprecation in the meantime</p>",
        "id": 465809134,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1724862265
    },
    {
        "content": "<p>I’ll wait a bit for more comments about the renaming (and wait for bors to merge the binder PR of course).</p>",
        "id": 465809215,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724862309
    },
    {
        "content": "<p>I need to go anyway.</p>",
        "id": 465809239,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724862318
    },
    {
        "content": "<p>For reference, we already have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finset.affineCombination#doc\">docs#Finset.affineCombination</a></p>",
        "id": 465809373,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1724862366
    },
    {
        "content": "<p>I would also vote for <code>Finsupp.linearCombination</code>.</p>",
        "id": 465816042,
        "sender_full_name": "Frédéric Dupuis",
        "timestamp": 1724864877
    },
    {
        "content": "<p>It is also 1 direction of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finsupp.lift#doc\">docs#Finsupp.lift</a> fwiw</p>",
        "id": 465906594,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1724907114
    },
    {
        "content": "<p>New question: do we want to keep <code>Finsupp.linearCombination</code> protected? I’m not sure I see the point. I’m not even sure I understand why the old name was protected.</p>",
        "id": 465948466,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724921501
    },
    {
        "content": "<p>I tend to agree, especially since my convexity refactor would introduce the analogous <code>_root_.convexCombination</code></p>",
        "id": 465949544,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1724921711
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"406490\">@María Inés de Frutos Fernández</span> and I should probably revisit what we did for weight/degree of mv polynomials, because it more or less duplicates <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finsupp.total#doc\">docs#Finsupp.total</a>. However, thinking about applications to polynomials, say, I would like that something that just sums all values of the Finsupp exists, and <a href=\"http://Finsupp.total\">Finsupp.total</a> would be a reasonable name.</p>",
        "id": 465989771,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1724932031
    },
    {
        "content": "<p>Are you looking for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finsupp.sum#doc\">docs#Finsupp.sum</a> ?</p>",
        "id": 465997397,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724933685
    },
    {
        "content": "<p>I think it was <code>f.sum fun _ =&gt; id</code>?</p>",
        "id": 466014845,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1724938235
    },
    {
        "content": "<p>I just opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/16277\">#16277</a> for the renaming. I hate myself for having volunteered to do that. But the new name really feels better.</p>",
        "id": 466107225,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724963213
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Finsupp.2Etotal/near/466014845\">said</a>:</p>\n<blockquote>\n<p>I think it was <code>f.sum fun _ =&gt; id</code>?</p>\n</blockquote>\n<p>Yes it is that, but I can't find it reasonable to have to type this all the time.</p>",
        "id": 466114102,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1724966289
    },
    {
        "content": "<p>Maybe you are just missing notation?</p>",
        "id": 466115014,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1724966746
    },
    {
        "content": "<p>Yes, maybe, although I tend to prefer names to notation. (My impression is that notation can only be guessed with difficulty from the mathlib docs.)</p>",
        "id": 466115444,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1724966927
    },
    {
        "content": "<p>A very similar notion is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=DirectSum.coeAddMonoidHom#doc\">docs#DirectSum.coeAddMonoidHom</a></p>",
        "id": 466117108,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1724967706
    },
    {
        "content": "<p>... which in fact, is what in the long run I ended up using instead of <code>f.sum fun _ =&gt; id</code></p>",
        "id": 466117266,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1724967764
    }
]