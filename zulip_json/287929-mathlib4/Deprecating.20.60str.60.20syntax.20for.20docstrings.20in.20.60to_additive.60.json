[
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/28135\">#28135</a> will (eventually) deprecate <code>str</code> syntax support for additive docstrings, e.g. <code>@[to_additive \"I am an additive docstring!\"]</code>, in favor of <code>docComment</code> syntax, e.g. <code>@[to_additive /-- I am an additive docstring! -/]</code>. Note that it will not remove support for <code>str</code> syntax, but instead will issue a warning and provide a suggestion.</p>\n<p>There are two questions I'd like to ask in this thread:</p>\n<ol>\n<li>Who should <code>str</code> syntax be deprecated for? As I see it, there are three options: (a.) everyone in mathlib (b.) everyone adhering to mathlib style standards through linter options (c.) everyone</li>\n<li>When should support for <code>str</code> be removed, and seeing as the deprecation is not a declaration deprecation, how should this be recorded?</li>\n</ol>",
        "id": 533608349,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1754782953
    },
    {
        "content": "<p>I would say the answer to 1 is (c)</p>",
        "id": 533608505,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1754783146
    },
    {
        "content": "<p>Ideally with a \"try this\" to make adapting downstream easier</p>",
        "id": 533608526,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1754783169
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Deprecating.20.60str.60.20syntax.20for.20docstrings.20in.20.60to_additive.60/near/533608505\">said</a>:</p>\n<blockquote>\n<p>I would say the answer to 1 is (c)</p>\n</blockquote>\n<p>Okay—hmm, in that case, I suppose the next question is whether this warning should be (i.) controlled by <code>linter.deprecated</code> (ii.) controlled by a new option (iii.) not controlled by an option.</p>",
        "id": 533608673,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1754783364
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Deprecating.20.60str.60.20syntax.20for.20docstrings.20in.20.60to_additive.60/near/533608526\">said</a>:</p>\n<blockquote>\n<p>Ideally with a \"try this\" to make adapting downstream easier</p>\n</blockquote>\n<p>Yup—by \"provide a suggestion\", I meant \"provide a <code>Suggestion</code>\"! :)</p>",
        "id": 533608718,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1754783432
    },
    {
        "content": "<p>I think emulating the standard deprecation machinery as much as possible is the right thing to do here</p>",
        "id": 533608749,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1754783479
    },
    {
        "content": "<p>So respect the options, phrase the warning message in the same way, and log with the same tag on the message</p>",
        "id": 533608770,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1754783514
    },
    {
        "content": "<p>Arguably core (and in the meantime, mathlib) should have a helper function for that</p>",
        "id": 533608802,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1754783553
    },
    {
        "content": "<p>True; I may as well PR that helper function to mathlib first.</p>",
        "id": 533609300,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1754784128
    },
    {
        "content": "<p>Out of curiosity, what's the benefit of this?</p>",
        "id": 533615075,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754792990
    },
    {
        "content": "<p>less escaping</p>",
        "id": 533615119,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754793032
    },
    {
        "content": "<p>more clear it's a docstring since it uses the docstring syntax</p>",
        "id": 533615126,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754793041
    },
    {
        "content": "<p>gives you better syntax highlighting</p>",
        "id": 533615132,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754793050
    },
    {
        "content": "<p>Valid</p>",
        "id": 533628323,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754808862
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Deprecating.20.60str.60.20syntax.20for.20docstrings.20in.20.60to_additive.60/near/533608770\">said</a>:</p>\n<blockquote>\n<p>So respect the options, phrase the warning message in the same way, and log with the same tag on the message</p>\n</blockquote>\n<p>Aside: minor point, but I think the phrasing of current deprecation warning code actions should say \"Update to: &lt;new&gt;\" instead of \"Replace <code>&lt;old&gt;</code> with <code>&lt;new&gt;</code>\" to (1.) better communicate the fact that this is coming from a deprecation (2.) keep code actions concise. (Also, code formatting is not rendered in code action titles, and so I believe we should avoid backticks if possible. Separation-by-colon is enough, imo.)</p>",
        "id": 533664882,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1754846416
    },
    {
        "content": "<p>Also, I'm wondering: do we think the suggestion widget text should duplicate the logged message as much as possible, or not?</p>\n<p>The argument to the contrary would be that they both appear in the infoview, so duplicating them is noisy; we can instead separate their roles, and have the message be descriptive of the general issue, while the suggestion is only descriptive of the specific change necessary. E.g. the widget could simply say \"Update deprecated syntax to:\\n&lt;clickable new version&gt;\", while the logged message could say \"&lt;This kind&gt; of syntax is deprecated: use &lt;this kind&gt; of syntax instead\". (If the specific change necessary is large, this could be a more comprehensible description of the issue in a log.)</p>",
        "id": 533665480,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1754846971
    },
    {
        "content": "<p>Are there contexts where it is useful to have the intended replacement in the logged message per se? For example, are interactive suggestions available in the neovim extension?</p>",
        "id": 533665799,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1754847260
    }
]