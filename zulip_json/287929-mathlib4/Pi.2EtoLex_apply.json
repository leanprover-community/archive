[
    {
        "content": "<p>Might I ask what's going on with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Pi.toLex_apply#doc\">docs#Pi.toLex_apply</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Pi.ofLex_apply#doc\">docs#Pi.ofLex_apply</a> ? They both seem like flagrant def-eq abuse.</p>",
        "id": 542578221,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1759351088
    },
    {
        "content": "<p><del>It is defeq non-abuse I think. It means, as Lex-tagged function can still be used as a function, the function application result is the same regardless whether the tag is there</del></p>",
        "id": 542615617,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1759353943
    },
    {
        "content": "<p>(that's assuming function application for Lex tag is defined that way, which I have not found yet)</p>",
        "id": 542615900,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1759354071
    },
    {
        "content": "<p>TIL type synonym of a function / pi type will automatically expand to the underlying function for function application, which is why this is defeq.<br>\nIt makes some sense to me, but I imagine you asked this question because you expect <code>toLex f a</code> to return something other than <code>f a</code>? Like <code>toLex (f a)</code>?</p>",
        "id": 542622089,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1759356860
    },
    {
        "content": "<p>looks like defeq abuse to me</p>",
        "id": 542639248,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759368463
    },
    {
        "content": "<p>if <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lex#doc\">docs#Lex</a> was a one-field structure then it wouldn't work</p>",
        "id": 542639275,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759368485
    },
    {
        "content": "<p>I think we've set a precedent that application doesn't <em>really</em> count as defeq abuse</p>",
        "id": 542672423,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1759390489
    },
    {
        "content": "<p>See <code>Matrix</code> and <code>PiLp</code> for more examples</p>",
        "id": 542672488,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1759390513
    },
    {
        "content": "<p>I think the prevailing take is that we should ignore such abuse until we switch to one-field structures, for which WithLp already has a PR</p>",
        "id": 542672666,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1759390570
    },
    {
        "content": "<p>Shouldn't the non-abusive way to do this be to add a <code>CoeFun α → CoeFun (Lex α)</code> instance?</p>",
        "id": 542834854,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1759441241
    },
    {
        "content": "<p>That won't have any effect because it will first try regular function application before <code>CoeFun</code>. In other words, <code>Lex (_ -&gt; _)</code> can't be a function type if you want to make this work</p>",
        "id": 542835258,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1759441499
    },
    {
        "content": "<p>Ah, so once <code>Lex</code> is made into a one-element structure, that will work, right?</p>",
        "id": 542837216,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1759442712
    },
    {
        "content": "<p>Yeah, and until then there's not much we can do</p>",
        "id": 542837523,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1759442934
    }
]