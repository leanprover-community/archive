[
    {
        "content": "<p>Hi everyone,</p>\n<p>I am trying to construct an <strong>$S$-linear</strong> isomorphism between the tensor product of a direct limit and the direct limit of the tensored modules.</p>\n<p>Specifically, given:</p>\n<ul>\n<li>\n<p>A directed system of $R$-modules $M_i$ with transition maps $f_{ij} : M_i \\to M_j$.</p>\n</li>\n<li>\n<p>A commutative ring map $R \\to S$.</p>\n</li>\n<li>\n<p>The induced system of $S$-modules $M_i \\otimes_R S$ with transition maps $f_{ij} \\otimes \\text{id}_S$.</p>\n</li>\n</ul>\n<p>I have an $R$-linear isomorphism:</p>\n<p>iso_lim : (Module.DirectLimit M f) ⊗[R] S ≃ₗ[R] Module.DirectLimit (fun i ↦ M i ⊗[R] S) (fun i j h ↦ lTensor S (f h))</p>\n<p>The Problem:</p>\n<p>I need this to be an $S$-linear isomorphism (≃ₗ[S]) and I need it to target a slightly different definition of the transition maps:</p>\n<p>f_tensor : i ≤ j → M i ⊗ S →ₗ[S] M j ⊗ S</p>\n<p>defined via <a href=\"http://TensorProduct.AlgebraTensorModule.map\">TensorProduct.AlgebraTensorModule.map</a>.</p>\n<p>Even though the transition maps are extensionally equal, I am hitting a wall because:</p>\n<ol>\n<li>\n<p><code>Module.DirectLimit.lift</code> is producing $R$-linear maps when I need $S$-linear maps.</p>\n</li>\n<li>\n<p>The typeclass engine is getting stuck on metavariables when I try to use <code>LinearEquiv.ofLinear</code> to upgrade the $R$-equivalence, likely because the <code>Module S</code> instance on the <code>DirectLimit</code> depends on the specific form of the transition maps.</p>\n</li>\n</ol>\n<p>How can I best define this $S$-isomorphism such that it respects the $S$-module structure on both sides without falling into definitional hell regarding the transition maps?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- Transition maps in the goal</span>\n<span class=\"n\">f_tensor</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">→ₗ</span><span class=\"o\">[</span><span class=\"n\">S</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">TensorProduct</span><span class=\"bp\">.</span><span class=\"n\">AlgebraTensorModule</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">)</span>\n<span class=\"c1\">-- The S-module instance I am using</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">DirectLimit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">⊗</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">f_tensor</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">DirectLimit</span><span class=\"bp\">.</span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">f_tensor</span>\n</code></pre></div>",
        "id": 567644960,
        "sender_full_name": "Liran Shaul",
        "timestamp": 1768252627
    },
    {
        "content": "<p>I'm not at a computer right now but we did a bunch of relevant material in FLT (edit: but probably not exactly what you need).</p>",
        "id": 567651288,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1768255351
    }
]