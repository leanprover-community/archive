[
    {
        "content": "<p>Hi everyone,</p>\n<p>I am seeking feedback for my PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/33031\">#33031</a> opened last month, which currently formalizes the combinatorial proof of Euler’s partition identity via the Glaisher bijection between odd partitions and distinct partitions.</p>\n<p>Currently the proof of Euler’s identity in mathlib4 is through generating functions <span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span> . This has also been brought forward by <span class=\"user-mention\" data-user-id=\"873350\">@Weiyi Wang</span>  to formalize Glaisher’s theorem: the number of partitions whose parts are not divisible by <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span> is the same as the number of partitions whose parts have multiplicity <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>&lt;</mo><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">&lt; d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>.</p>\n<p>As mathlib4 does not simply accept alternative proofs, I would like to expand the PR to provide stronger results coming from Glaisher’s bijection. Indeed, the Glaisher bijection between odd partitions of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> and distinct partitions of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> can be lifted to a bijection on all partitions of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>, and this bijection is actually an involution. My proposal to expand the PR is: <br>\n(1) formalize the involution on the set of partitions of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span><br>\n(2) the involution restricts to a bijection between odd partitions and distinct partitions<br>\n(2)’ the involution restricts to a bijection between partitions whose parts are not divisible by <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>i</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span></span></span></span> and partitions whose hav multiplicity <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>&lt;</mo><msup><mn>2</mn><mi>i</mi></msup></mrow><annotation encoding=\"application/x-tex\">&lt; 2^i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span></span></span></span>. (Glaisher’s theorem for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo>=</mo><msup><mn>2</mn><mi>i</mi></msup></mrow><annotation encoding=\"application/x-tex\">d=2^i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span></span></span></span>.)<br>\n(3) the partitions fixed by the involution are the distinct odd partitions.</p>\n<p>A technical note: The current Lean code uses <code>ordProj[p] n</code>, the largest power of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span> dividing <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>. This makes generalizing from <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">p=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span> to any prime <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span> straightforward. Moving to a general <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span> (Glaisher’s Theorem) is the end goal, though it will require expansions on other libraries.</p>\n<p>Do people agree that the Glaisher involution would provide enough added value to be included in mathlib4?</p>",
        "id": 568300886,
        "sender_full_name": "Chi-Yun Hsu",
        "timestamp": 1768507275
    },
    {
        "content": "<p>I am neutral on this, as I wasn't aware the alternative proof  and its value when making the current one. The proof was more of a demonstration of using recently developed lemmas for infinite sum of power series</p>",
        "id": 568314749,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1768512572
    },
    {
        "content": "<p>Just by your post here, it looks like it can be only generalized to d = p ^ i for prime p?  How do we get this for any positive integer d?</p>",
        "id": 568343308,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1768528084
    },
    {
        "content": "<p>I guess it is hiding behind \"it will require expansions on other libraries\". I think even if people don't agree with including your complete proof of Glaisher's theorem, you can still work on upstreaming those useful intermediate lemma. And if a lot of intermediate lemma is upstreamed, perhaps the final proof will be short, which might make this a more convincing case</p>",
        "id": 568343554,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1768528283
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"873350\">@Weiyi Wang</span> Thank you for sharing your thoughts. The current code does not directly generalize to non-primes <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span> because I was using <code>ordProj[p] n</code>. The solution is to use <code>multiplicity d n</code> instead. I simply have not looked into switching equivalent lemmas between the <code>ordProj</code> and <code>multiplicity</code>. The current code focuses entirely on the proof of Euler's identity, so upstreaming intermediate lemmas to <code>multiplicity</code> (if needed) would not considerably shorten the proof either.</p>\n<p>Because Glaisher's Theorem is already formalized, my understanding is that mathlib4 only wants to accept one proof. I thinks there are merits formalizing Glaisher's bijection, so I am supporting it by results which could only be proven through the  bijection but not through generating series.</p>",
        "id": 568360693,
        "sender_full_name": "Chi-Yun Hsu",
        "timestamp": 1768541488
    },
    {
        "content": "<p>I agree that looking for results that could only be proven through the bijection is the right thing to do here - have you managed to identify any these that could be nicely done from your work?</p>",
        "id": 570808111,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1769696468
    },
    {
        "content": "<p>I think the main result which is impossible to get from generating series is that the bijection is an involution.</p>",
        "id": 571158513,
        "sender_full_name": "Chi-Yun Hsu",
        "timestamp": 1769830295
    },
    {
        "content": "<p>Are there any theorems that use the fact that it's an involution? The one you mention is a result about the bijection itself, rather than something which uses the bijection</p>",
        "id": 571210475,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1769875718
    },
    {
        "content": "<p>I think the fact that there is an involution on Partition(n) inducing the bijection between odd partitions and distinct partitions is itself interesting enough.</p>\n<p>On the other hand, if we are looking for partition identities which can be proved using the Glaisher bijection, there are</p>\n<ol>\n<li>The total number of parts in Dist(n) is the sum of 2-binary digits of the multiplicities of parts in Odd(n)</li>\n<li>The number of odd partitions consisting of odd integers from a set S is equal to the number of distinct partitions consisting of integers whose odd part is in S.</li>\n<li>The bijection implies #Odd(n) = #Dist(n), and #<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>i</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span></span></span></span>-regular partitions = #<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>i</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span></span></span></span>-distinct partitions. The fact that the bijection is an involution allows to create bijections on the intersections, eg #Odd <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>i</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span></span></span></span>-distinct partitions = Distinct <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>i</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span></span></span></span>-regular partitions. On the other hand, this can be proven by generating series too.</li>\n</ol>\n<p>The results can be a bit deliberate to make a case for Glaisher's bijection. The broader question would be whether mathlib wants to accept any bijective proofs at all. For example, Sylvester's bijection is another bijection between Odd(n) and Dist(n), which provides interesting refined identity: #odd partitions with k distinct odd parts = #distinct partitions with k consecutive sequences. Historically Sylvester's bijection came before the generating series proof, but ultimately it is pretty hard to think of identities where generating series proof does not exist.</p>",
        "id": 571829597,
        "sender_full_name": "Chi-Yun Hsu",
        "timestamp": 1770188487
    }
]