[
    {
        "content": "<p>Hi, I encountered some curiosity about the inductive principle of <code>ReflTransGen</code> when trying to prove some statement.<br>\nThere are three different inductive principles, the built-in, <code>ReflTransGen.head_induction_on</code> and <code>ReflTransGen.trans_induction_on</code>.<br>\nI would have expected the built-in principle to correspond to <code>ReflTransGen.head_induction_on</code> and I'm mostly curious why it is not, or rather, why is it not the one that is automatically generated.<br>\nTo give a concrete (nonsensical) example where the built-in principle fails, but <code>ReflTransGen.head_induction_on</code> works:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Computability</span><span class=\"bp\">.</span><span class=\"n\">Language</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">my_id</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„•</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">rtid</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„•</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"n\">â„•</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Relation</span><span class=\"bp\">.</span><span class=\"n\">ReflTransGen</span><span class=\"w\"> </span><span class=\"n\">my_id</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">rtid_then_id</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„•</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rtid</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">my_id</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- induction h  -- does not work</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">Relation</span><span class=\"bp\">.</span><span class=\"n\">ReflTransGen</span><span class=\"bp\">.</span><span class=\"n\">head_induction_on</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">head</span><span class=\"w\"> </span><span class=\"n\">hstep</span><span class=\"w\"> </span><span class=\"n\">htrans</span><span class=\"w\"> </span><span class=\"n\">hind</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 478716765,
        "sender_full_name": "Alex Loitzl ğŸ“",
        "timestamp": 1729776426
    },
    {
        "content": "<p>Okay, I've figured it out myself...<br>\n<code>ReflTransGen</code>is defined symmetrically to what I expected, i.e, it recurses on the prefix of the derivation, rather than the tail.</p>",
        "id": 478739458,
        "sender_full_name": "Alex Loitzl ğŸ“",
        "timestamp": 1729782304
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"762700\">Alex Loitzl ğŸ“</span> has marked this topic as resolved.</p>",
        "id": 478739723,
        "sender_full_name": "Notification Bot",
        "timestamp": 1729782364
    }
]