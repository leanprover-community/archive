[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span>, a bug report. When I try to follow the advice of the import diffs bot:</p>\n<blockquote>\n<p>You can run <code>scripts/import_trans_difference.sh all</code> locally to see the whole output.</p>\n</blockquote>\n<p>on a macos system, I get</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">awk</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">calling</span><span class=\"w\"> </span><span class=\"n\">undefined</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"n\">asort</span>\n<span class=\"w\"> </span><span class=\"n\">input</span><span class=\"w\"> </span><span class=\"n\">record</span><span class=\"w\"> </span><span class=\"n\">number</span><span class=\"w\"> </span><span class=\"mi\">5612</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">transImports2</span><span class=\"bp\">.</span><span class=\"n\">txt</span>\n<span class=\"w\"> </span><span class=\"n\">source</span><span class=\"w\"> </span><span class=\"n\">line</span><span class=\"w\"> </span><span class=\"n\">number</span><span class=\"w\"> </span><span class=\"mi\">24</span>\n\n\n<span class=\"bp\">&lt;</span><span class=\"n\">details</span><span class=\"bp\">&gt;&lt;</span><span class=\"n\">summary</span><span class=\"bp\">&gt;</span><span class=\"n\">Import</span><span class=\"w\"> </span><span class=\"n\">changes</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">all</span><span class=\"w\"> </span><span class=\"n\">files</span><span class=\"bp\">&lt;/</span><span class=\"n\">summary</span><span class=\"bp\">&gt;</span>\n\n<span class=\"bp\">|</span><span class=\"n\">Files</span><span class=\"bp\">|</span><span class=\"n\">Import</span><span class=\"w\"> </span><span class=\"n\">difference</span><span class=\"bp\">|</span>\n<span class=\"bp\">|-|-|</span>\n\n<span class=\"bp\">&lt;/</span><span class=\"n\">details</span><span class=\"bp\">&gt;</span>\n</code></pre></div>",
        "id": 495023784,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1737458049
    },
    {
        "content": "<p>Let me try: I only used it on Linux and it has only run on CI, as far as I know, so no MacOS testing.</p>",
        "id": 495023966,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737458120
    },
    {
        "content": "<p>Ah, I think that <code>asort</code> is an internal of <code>awk</code> that is not part of the MacOS distribution of <code>awk</code>...</p>",
        "id": 495024131,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737458176
    },
    {
        "content": "<p>I guess we better rewrite it in Lean, then. :-)</p>",
        "id": 495024265,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1737458227
    },
    {
        "content": "<p>Let me look at the script: the shell functions are <em>very</em> convenient, but maybe I can do the final processing of the data in Lean, and use sorting in Lean.</p>",
        "id": 495024459,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737458291
    },
    {
        "content": "<p>(Running that command switches branch back and forth and calls the python script that computes import differences: rewriting those in Lean would be lengthier.)</p>",
        "id": 495024619,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737458355
    },
    {
        "content": "<p>Mostly joking. Dog fooding is great, and we would probably learn useful things from it, but it takes a lot of time.</p>",
        "id": 495024710,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1737458392
    },
    {
        "content": "<p>In the meantime, is there a way to emulate a bash shell in MacOS?  I think that <code>asort</code> should be available <em>very</em> widely in non-MacOS Unix-like terminals.</p>",
        "id": 495024960,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737458470
    },
    {
        "content": "<p>According to <a href=\"https://www.gnu.org/software/gawk/manual/html_node/Array-Sorting-Functions.html\">this</a>, the <code>awk</code> call should really be a <code>gawk</code> call: maybe simply changing <code>awk</code> to <code>gawk</code> works for you?</p>",
        "id": 495025204,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737458543
    },
    {
        "content": "<p>Locally, the change <code>awk</code> --&gt; <code>gawk</code> shows no difference in output.</p>",
        "id": 495025401,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737458619
    },
    {
        "content": "<p><a href=\"https://stackoverflow.com/questions/24332942/why-awk-script-does-not-work-on-mac-os-but-works-on-linux\">This discussion</a> suggests that <code>gawk</code> is not available, but can be installed with the instructions there.</p>",
        "id": 495025745,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737458738
    },
    {
        "content": "<p>Yes, I've installed <code>gawk</code> already.</p>",
        "id": 495025763,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1737458753
    },
    {
        "content": "<p>Ok, and does changing the unique <code>awk</code> to <code>gawk</code> in the script make it work?</p>",
        "id": 495025856,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737458772
    },
    {
        "content": "<p>Yes, looks good. Thanks!</p>",
        "id": 495025904,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1737458789
    },
    {
        "content": "<p>Ok, I can PR the addition of a <code>g</code> to the script!</p>",
        "id": 495025939,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737458809
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/20909\">#20909</a></p>",
        "id": 495026348,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737458966
    }
]