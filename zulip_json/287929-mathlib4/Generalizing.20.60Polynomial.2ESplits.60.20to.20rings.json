[
    {
        "content": "<p>I'm thinking about generalizing <code>Polynomial.Splits</code> to rings. The motivation is that if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> splits in a number field <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"script\">O</mi><mi>K</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathcal O_K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, then we might want to look at the roots of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"script\">O</mi><mi>K</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathcal O_K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> and how they relate to the roots of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"script\">O</mi><mi>K</mi></msub><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"fraktur\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal O_K/\\mathfrak p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathfrak\">p</span></span></span></span>.</p>\n<p>One option would be to simply redefine <code>f.Splits</code> to be <code>(f.map i).roots.card = (f.map i).natDegree</code> (which is equivalent by <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Polynomial.splits_iff_card_roots#doc\">docs#Polynomial.splits_iff_card_roots</a>). Thoughts?</p>",
        "id": 543041067,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1759534828
    },
    {
        "content": "<p>roots requires Domain</p>",
        "id": 543041758,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759535461
    },
    {
        "content": "<p>does the polynomial 2 split in Z?</p>",
        "id": 543041889,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759535568
    },
    {
        "content": "<p>for reference <a href=\"https://github.com/leanprover-community/mathlib4/blob/3bddb2a6e79a044b9956fcee099f7e9c5e9625e8/Mathlib/Algebra/Polynomial/Splits.lean#L43-L45\">the current definition</a> is:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"bp\">→+*</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span>\n<span class=\"sd\">/-- A polynomial `Splits` iff it is zero or all of its irreducible factors have `degree` 1. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Splits</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">]},</span><span class=\"w\"> </span><span class=\"n\">Irreducible</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∣</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">degree</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>",
        "id": 543041941,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759535615
    },
    {
        "content": "<p>what if we just modify this minimally, say change <code>degree g = 1</code> to <code>degree g &lt;= 1</code>?</p>",
        "id": 543041968,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759535633
    },
    {
        "content": "<p>(over fields, irreducible polynomial cannot have degree 0)</p>",
        "id": 543042084,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759535728
    },
    {
        "content": "<p>Interesting, I'll play around with this!</p>",
        "id": 543042099,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1759535743
    },
    {
        "content": "<p>I think I regret the decision to include a homomorphism as part of the definition of splits by the way. And it could have been defined as the monoid closure of degree le 1 polynomials.</p>",
        "id": 543042873,
        "sender_full_name": "Chris Hughes",
        "timestamp": 1759536395
    },
    {
        "content": "<p>well it was <a href=\"https://github.com/leanprover-community/mathlib3/commit/8faf8df02cb740d16a006aeabe6cffca55a3d6db#diff-125a7ed572056a9ac4aa84993c9d1514aaf81e603087be018b809a5a7d4cdb5cR27\">6 years ago</a></p>",
        "id": 543043323,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759536795
    },
    {
        "content": "<p>an eternity in lean timeframe</p>",
        "id": 543043333,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759536812
    },
    {
        "content": "<p>For the time being, would it make sense to introduce a separate predicate <code>Polynomial.Factors</code> (product of polynomials of degree &lt;=1), build out some API, and then redefine splits in terms of that?</p>",
        "id": 543043364,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1759536848
    },
    {
        "content": "<p>I think Chris is saying that he wants to define it as a submonoid instead of a predicate</p>",
        "id": 543043694,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759537099
    },
    {
        "content": "<p>without necessarily saying whether it's better (and I also don't know)</p>",
        "id": 543043740,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759537123
    },
    {
        "content": "<p>There's a <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/degree.20of.20splitting.20field/near/499346014\">splitting algebra</a> for a monic polynomial over any commutative ring (the construction in <a href=\"https://arxiv.org/abs/1504.00973\">https://arxiv.org/abs/1504.00973</a> was also used to define AlgebraicClosure (see <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/FieldTheory/IsAlgClosed/AlgebraicClosure.html#AlgebraicClosure.spanCoeffs\">AlgebraicClosure.spanCoeffs</a>)). The definition suggested by Chris makes sure that the polynomial splits over the splitting algebra, so I'm in favor of it.</p>",
        "id": 543043852,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1759537225
    },
    {
        "content": "<p>if we agree to only ever talk about monic polynomials then we can also stick to the submonoid generated by X-a...</p>",
        "id": 543043970,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759537375
    },
    {
        "content": "<p>Indeed, if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mi>c</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">ac=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> you have <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mi>X</mi><mo>+</mo><mi>b</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>c</mi><mi>X</mi><mo>+</mo><mi>d</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mi>a</mi><mi>d</mi><mo>+</mo><mi>b</mi><mi>c</mi><mo stretchy=\"false\">)</mo><mi>X</mi><mo>+</mo><mi>b</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">(aX+b)(cX+d)=(ad+bc)X+bd</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">c</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">d</span></span></span></span> which we probably don't want ...</p>",
        "id": 543044140,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1759537535
    },
    {
        "content": "<p>in (Z/6Z)[X], <code>X*(X+1) = (X+3)*(X+4)</code> and <code>X = (2X+3) * (3X+2)</code></p>",
        "id": 543044360,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759537800
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"224323\">Junyan Xu</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/543044140\">said</a>:</p>\n<blockquote>\n<p>Indeed, if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mi>c</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">ac=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> you have <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mi>X</mi><mo>+</mo><mi>b</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>c</mi><mi>X</mi><mo>+</mo><mi>d</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mi>a</mi><mi>d</mi><mo>+</mo><mi>b</mi><mi>c</mi><mo stretchy=\"false\">)</mo><mi>X</mi><mo>+</mo><mi>b</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">(aX+b)(cX+d)=(ad+bc)X+bd</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">c</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">d</span></span></span></span> which we probably don't want ...</p>\n</blockquote>\n<p>What's the point being made here? I don't think this causes issues for Chris' definition?</p>",
        "id": 543044581,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1759538011
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/543043694\">said</a>:</p>\n<blockquote>\n<p>I think Chris is saying that he wants to define it as a submonoid instead of a predicate</p>\n</blockquote>\n<p>The one nice thing about a predicate is that you can use dot-notation and write <code>f.Factors</code> as opposed to <code>f  ∈ factors R</code> (or something like that).</p>",
        "id": 543044636,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1759538077
    },
    {
        "content": "<p>well without a specified behaviour (what do we want?) over rings that are not domains, it's a bit hard to judge which definition is better</p>",
        "id": 543044637,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759538077
    },
    {
        "content": "<p>But do you have an example where the irreducible divisor definition (with degree &lt;= 1) gives a different answer than the submonoid closure definition (of polynomials of degree &lt;= 1)?</p>",
        "id": 543044693,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1759538146
    },
    {
        "content": "<blockquote>\n<p>What's the point being made here?</p>\n</blockquote>\n<p>One can imagine that a quadratic polynomial can be written as a product of three factors but not two. I think in general it's safer to take the monoid generated by X-r and all constants. This would also bring it closer to the roots definition, since general linear polynomials may not have a root but monic ones (X-r) do have.</p>",
        "id": 543045238,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1759538700
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"253861\">Thomas Browning</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/543044693\">said</a>:</p>\n<blockquote>\n<p>But do you have an example where the irreducible divisor definition (with degree &lt;= 1) gives a different answer than the submonoid closure definition (of polynomials of degree &lt;= 1)?</p>\n</blockquote>\n<p>R=Z/6Z<br>\n2x = (3x^2+3x+1)*(2x)<br>\n3x^2+3x+1 is irreducible</p>",
        "id": 543045329,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759538776
    },
    {
        "content": "<p>surely we want monomials to split?</p>",
        "id": 543045473,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759538893
    },
    {
        "content": "<p>can we prove or disprove that x^n is splitting under the irreducible divisor definition (with deg &lt;= 1)?</p>",
        "id": 543045927,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759539266
    },
    {
        "content": "<p>over Z/6Z the irreducible factors of the polynomial X^n in (Z/6Z)[X] are all deg &lt;= 1</p>",
        "id": 543046167,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759539450
    },
    {
        "content": "<p>i think i have a counterexample</p>",
        "id": 543046208,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759539487
    },
    {
        "content": "<p>what is it</p>",
        "id": 543046225,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759539505
    },
    {
        "content": "<p>char p, ε^2 = 0, (x^2+ε)^p = x^(2p)</p>",
        "id": 543046288,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759539571
    },
    {
        "content": "<p>are you saying take the base ring to be (Z/pZ)[X]/(X^2)</p>",
        "id": 543046412,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759539656
    },
    {
        "content": "<p>yes</p>",
        "id": 543046427,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759539664
    },
    {
        "content": "<p>alright I'll try that</p>",
        "id": 543046438,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759539675
    },
    {
        "content": "<p>it might also work with just Z/4Z and then (x^2+2)^4 = x^8</p>",
        "id": 543046469,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759539709
    },
    {
        "content": "<p>well ^2 also works</p>",
        "id": 543046490,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759539723
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/543046288\">said</a>:</p>\n<blockquote>\n<p>char p, ε^2 = 0, (x^2+ε)^p = x^(2p)</p>\n</blockquote>\n<p>Is X^2+ε irreducible</p>",
        "id": 543046638,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759539842
    },
    {
        "content": "<p>no clue</p>",
        "id": 543046656,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759539855
    },
    {
        "content": "<p>All the intuition about irreducible polynomials comes from their main use case, which is when the ground ring is a domain. Many definitions which are equivalent in domains will be wrong over general commutative rings  (and possibly even more wrong over noncommutative rings).</p>",
        "id": 543100941,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1759595875
    },
    {
        "content": "<p>Monic factors of degree 1 correspond to the roots, so those factors of a polynomial are well defined, but it is likely that over a non domain, a polynomial may have several factorizations in monic polynomial of degree 1.</p>",
        "id": 543101092,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1759596009
    },
    {
        "content": "<p>the predicate <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Polynomial.IsRoot#doc\">docs#Polynomial.IsRoot</a> is defined in general, but <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Polynomial.roots#doc\">docs#Polynomial.roots</a> produces a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Multiset#doc\">docs#Multiset</a>, hence is forced to assume that one works over a commutative domain.</p>",
        "id": 543101218,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1759596118
    },
    {
        "content": "<p>aha, interesting, unique factorisation for monic into monic linears holds even when the domain is not UFD?</p>",
        "id": 543101229,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759596132
    },
    {
        "content": "<p>(proof: pass to fraction field)</p>",
        "id": 543101272,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759596172
    },
    {
        "content": "<p>Here's a first stab at this: <a href=\"https://github.com/leanprover-community/mathlib4/pull/30212\">#30212</a>. It has most of the API except for the connection with the existing definition in terms of irreducible factors.</p>",
        "id": 543116213,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1759611341
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"253861\">@Thomas Browning</span> thanks for the effort! \"semiring\" came up to my mind several times, but I never brought it up because I didn't see what's the point of say x+37 which has no root in Nat...</p>",
        "id": 543117245,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759612467
    },
    {
        "content": "<p>I don't really know what's the point of talking about roots in semirings</p>",
        "id": 543117251,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759612479
    },
    {
        "content": "<p>in fact polynomials over Nat \"basically\" have no roots</p>",
        "id": 543117279,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759612506
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/543117251\">said</a>:</p>\n<blockquote>\n<p>I don't really know what's the point of talking about roots in semirings</p>\n</blockquote>\n<p>Yeah, it doesn't make a ton of sense, although it is a free generalization (except for having to switch over to negatives in one or two places)?</p>",
        "id": 543117471,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1759612732
    },
    {
        "content": "<p>well if you provide the API for X-Cr then you'll be fine</p>",
        "id": 543117847,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759613239
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"253861\">@Thomas Browning</span> regarding aesop, I did the following test:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop</span>\n</code></pre></div>\n<p>so it works well enough but actually it might need more lemmas to work \"better\", which should probably be another PR</p>",
        "id": 543118352,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759613882
    },
    {
        "content": "<p>for example when R was Int, it used some other simp lemmas to convert <code>C a</code> to <code>↑a</code> so it doesn't work</p>",
        "id": 543118365,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759613907
    },
    {
        "content": "<p>and then when R is R, things like <code>X + 1</code> would also not work, so you probably need extra lemmas for <code>_one</code> and <code>_ofNat</code></p>",
        "id": 543118390,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759613937
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"253861\">@Thomas Browning</span> I have proved more theorems <span aria-label=\"melt\" class=\"emoji emoji-1fae0\" role=\"img\" title=\"melt\">:melt:</span> </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">factors_of_natDegree_eq_zero</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Semiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">]}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">natDegree</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Factors</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">natDegree_eq_zero</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">choose_spec</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">factors_X_sub_C_mul_iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">]}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">factors_X_sub_C</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"o\">)</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">hf₀</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">aesop</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">eq_prod_roots</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">leadingCoeff_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">leadingCoeff_X_sub_C</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">one_mul</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">roots_mul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mul_ne_zero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X_sub_C_ne_zero</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">hf₀</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">roots_X_sub_C</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">Multiset</span><span class=\"bp\">.</span><span class=\"n\">singleton_add</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Multiset</span><span class=\"bp\">.</span><span class=\"n\">map_cons</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Multiset</span><span class=\"bp\">.</span><span class=\"n\">prod_cons</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_left_comm</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">this</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mul_left_cancel₀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X_sub_C_ne_zero</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">aesop</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">factors_mul_iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">]}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hfg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">hf</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hg</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"n\">hg</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"n\">generalize</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"bp\">*</span>\n<span class=\"w\">  </span><span class=\"n\">generalize</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">natDegree</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">generalizing</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hf₀</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hg₀</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">natDegree_mul</span><span class=\"w\"> </span><span class=\"n\">hf₀</span><span class=\"w\"> </span><span class=\"n\">hg₀</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">add_eq_zero</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hn</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">factors_of_natDegree_eq_zero</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">factors_of_natDegree_eq_zero</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">exists_root_of_factors</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">degree_ne_of_natDegree_ne</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">dvd_iff_isRoot</span><span class=\"bp\">.</span><span class=\"n\">mpr</span><span class=\"w\"> </span><span class=\"n\">ha</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">prime_X_sub_C</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">dvd_mul</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">this</span>\n<span class=\"w\">    </span><span class=\"n\">wlog</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∣</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">hf2</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">hf2</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">mul_comm</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">hfg</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span>\n<span class=\"w\">        </span><span class=\"n\">this</span><span class=\"bp\">.</span><span class=\"n\">resolve_left</span><span class=\"w\"> </span><span class=\"n\">hf</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hf</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mul_assoc</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">subst</span><span class=\"w\"> </span><span class=\"n\">hp</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">natDegree_mul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">natDegree_X_sub_C</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">add_comm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">succ_inj</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hn</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">aesop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">factors_X_sub_C_mul_iff</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">hn</span>\n<span class=\"w\">    </span><span class=\"n\">aesop</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"bp\">.</span><span class=\"n\">of_dvd</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">]}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hg₀</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hfg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∣</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">g</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hfg</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">factors_mul_iff</span><span class=\"w\"> </span><span class=\"n\">hg₀</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"n\">hg</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"bp\">.</span><span class=\"n\">of_irreducible</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">]}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">irr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Irreducible</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">natDegree</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">by_contra</span><span class=\"w\"> </span><span class=\"n\">hn</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">hn</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">exists_root_of_factors</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">degree_ne_of_natDegree_ne</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"n\">zero_le_one</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">dvd_iff_isRoot</span><span class=\"bp\">.</span><span class=\"n\">mpr</span><span class=\"w\"> </span><span class=\"n\">ha</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">of_irreducible_mul</span><span class=\"w\"> </span><span class=\"n\">irr</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">resolve_left</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">not_isUnit_X_sub_C</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">natDegree_mul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X_sub_C_ne_zero</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"bp\">.</span><span class=\"n\">ne_zero</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">natDegree_eq_zero_of_isUnit</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n\n<span class=\"c1\">-- Counter-example for reverse direction: `2*X+1 : ℤ[X]`</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"bp\">.</span><span class=\"n\">splits</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">]}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">]},</span><span class=\"w\"> </span><span class=\"n\">Irreducible</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∣</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">degree</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">or_iff_not_imp_left</span><span class=\"bp\">.</span><span class=\"n\">mpr</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">hf0</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">hg</span><span class=\"w\"> </span><span class=\"n\">hgf</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">degree_le_of_natDegree_le</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">of_dvd</span><span class=\"w\"> </span><span class=\"n\">hf0</span><span class=\"w\"> </span><span class=\"n\">hgf</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">of_irreducible</span><span class=\"w\"> </span><span class=\"n\">hg</span>\n\n<span class=\"c1\">-- Field</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">factors_iff_splits</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">]}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Factors</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">]},</span><span class=\"w\"> </span><span class=\"n\">Irreducible</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∣</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">degree</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"bp\">·.</span><span class=\"n\">splits</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">  </span><span class=\"n\">rintro</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">aesop</span>\n<span class=\"w\">  </span><span class=\"n\">generalize</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">natDegree</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">strongRec</span><span class=\"w\"> </span><span class=\"n\">generalizing</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ind</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">irr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Irreducible</span><span class=\"w\"> </span><span class=\"n\">f</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">factors_of_degree_le_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"n\">irr</span><span class=\"w\"> </span><span class=\"n\">dvd_rfl</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">irreducible_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">not_and</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">not_forall</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">not_or</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">exists_prop</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">irr</span>\n<span class=\"w\">    </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">unit</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"w\"> </span><span class=\"n\">f</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">factors_of_isUnit</span><span class=\"w\"> </span><span class=\"n\">unit</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">huf</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hug</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">irr</span><span class=\"w\"> </span><span class=\"n\">unit</span>\n<span class=\"w\">    </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">hfg0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hfg0</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">aesop</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">hf0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hg0</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">mul_ne_zero_iff</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"n\">hfg0</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">natDegree_mul</span><span class=\"w\"> </span><span class=\"n\">hf0</span><span class=\"w\"> </span><span class=\"n\">hg0</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hn</span>\n<span class=\"w\">    </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"n\">hpf</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hpf</span><span class=\"bp\">.</span><span class=\"n\">mul_right</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"n\">hpg</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hpg</span><span class=\"bp\">.</span><span class=\"n\">mul_left</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 543125633,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759623302
    },
    {
        "content": "<p>(R is domain unless specified)</p>",
        "id": 543125647,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759623315
    },
    {
        "content": "<p>Thanks! I've also pushed a version of <code>factors_iff_splits</code> that uses <code>UniqueFactorizationMonoid</code> to avoid the induction proof (at the cost of slightly heavier imports).</p>",
        "id": 543131217,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1759631743
    },
    {
        "content": "<p>is that fine? (genuine question)</p>",
        "id": 543153315,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759660536
    },
    {
        "content": "<p>idk how low or high <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Polynomial.Splits#doc\">docs#Polynomial.Splits</a> is in the import hierarchy</p>",
        "id": 543153325,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759660552
    },
    {
        "content": "<p>i mean it also seems to be a basic fact that k[x] is ED</p>",
        "id": 543153355,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759660580
    },
    {
        "content": "<p>Yeah, it doesn't use anything beyond what Splits already uses.</p>",
        "id": 543153797,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1759661188
    },
    {
        "content": "<p>btw in the current definition of Splits (or the version in the PR) maybe we should restrict g to be monic?</p>",
        "id": 543154635,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759662401
    },
    {
        "content": "<p>never mind i thought i could prove something but i couldn't</p>",
        "id": 543155257,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759663161
    },
    {
        "content": "<p>again over (Z/2Z)[ε]/ε^2 we have (X+ε)^2 = X^2 but X doesn't divide X+ε so X is irreducible but not prime</p>",
        "id": 543155303,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759663227
    },
    {
        "content": "<p>being monic doesn't help with anything</p>",
        "id": 543155319,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759663252
    },
    {
        "content": "<p>In my honest opinion the theory is such a mess for nondomains that it is not worth to spend a lot of time thinking about it. Sure, we can generalize the definition and a couple of theorems for free but still...</p>",
        "id": 543155398,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1759663343
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span> here's a question for domains: if R is a domain and f is a monic irreducible polynomial, is f prime?</p>",
        "id": 543155450,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759663429
    },
    {
        "content": "<p>something tells me f in K[x] should still be irreducible...?</p>",
        "id": 543155506,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759663501
    },
    {
        "content": "<p>Give me 10 minutes, but my first reaction is \"no but yes for integrally closed domains\"</p>",
        "id": 543155562,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1759663549
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/543155506\">said</a>:</p>\n<blockquote>\n<p>something tells me f in K[x] should still be irreducible...?</p>\n</blockquote>\n<p>exactly, you want to use gauss lemma</p>",
        "id": 543155587,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1759663570
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/3GpKxlVuqqKabSANfS08MAcc/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/3GpKxlVuqqKabSANfS08MAcc/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1103x137\" src=\"/user_uploads/thumbnail/3121/3GpKxlVuqqKabSANfS08MAcc/image.png/840x560.webp\"></a></div><p>hmm this one needs UFD...</p>",
        "id": 543155589,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759663570
    },
    {
        "content": "<p>this is gauss lemma</p>",
        "id": 543155599,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1759663585
    },
    {
        "content": "<p>yeah but it needs UFD</p>",
        "id": 543155612,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759663593
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/543155562\">said</a>:</p>\n<blockquote>\n<p>Give me 10 minutes, but my first reaction is \"no but yes for integrally closed domains\"</p>\n</blockquote>\n<p>aha k[t^2,t^3] with X^2-t^2</p>",
        "id": 543155656,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759663635
    },
    {
        "content": "<p>let p := (X-t)t^2 = t^2X - t^3<br>\nlet q := (X+t)t^2 = t^2X + t^3<br>\nX^2-t^2 divides pq but not p or q</p>",
        "id": 543155822,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759663834
    },
    {
        "content": "<p>I think the simplest example comes from number theory (at least the easiest for me...). We need <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>  not a UFD, and the classical example is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Z</mi><mo stretchy=\"false\">[</mo><msqrt><mrow><mo>−</mo><mn>3</mn></mrow></msqrt><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Z}[\\sqrt{-3}]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1156em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">Z</span><span class=\"mopen\">[</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8656em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">−</span><span class=\"mord\">3</span></span></span><span style=\"top:-2.8256em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1744em;\"><span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>. The easiest way to see that is not a UFD is to see that it is not integrally closed (that is the real point): just take the element <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mrow><mo>−</mo><mn>1</mn><mo>+</mo><msqrt><mrow><mo>−</mo><mn>3</mn></mrow></msqrt></mrow><mn>2</mn></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{-1+\\sqrt{-3}}{2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.383em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.038em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4282em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">+</span><span class=\"mord sqrt mtight\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8712em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mtight\" style=\"padding-left:0.833em;\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">3</span></span></span><span style=\"top:-2.8312em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail mtight\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1688em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>, whose minimal polynomial is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>x</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x^2+x+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>. Now, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>x</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x^2+x+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> has no roots in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> so it is irreducible. Now, take the polynomial <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mn>4</mn></msup><mo>+</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>1</mn><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msqrt><mrow><mo>−</mo><mn>3</mn></mrow></msqrt><mi>x</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><msqrt><mrow><mo>−</mo><mn>3</mn></mrow></msqrt><mi>x</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x^4+x^2+1=(x^2+\\sqrt{-3}x - 1)(x^2-\\sqrt{-3}x - 1)=(x^2+x+1)(x^2-x+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.1744em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8656em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">−</span><span class=\"mord\">3</span></span></span><span style=\"top:-2.8256em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1744em;\"><span></span></span></span></span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.1744em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8656em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">−</span><span class=\"mord\">3</span></span></span><span style=\"top:-2.8256em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1744em;\"><span></span></span></span></span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> to show that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>x</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x^2+x+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> is not prime.</p>",
        "id": 543156593,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1759664811
    },
    {
        "content": "<p>The idea is rather simple: take <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span> in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Frac</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>R</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\operatorname{Frac}(R)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">Frac</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mclose\">)</span></span></span></span> but not <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> whose minimal polynomial <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span> has integers coefficients. Now consider the numbers <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>z</mi><mo>ˉ</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\bar z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5678em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5678em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">-z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mover accent=\"true\"><mi>z</mi><mo>ˉ</mo></mover></mrow><annotation encoding=\"application/x-tex\">-\\bar z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5678em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span></span></span></span> and the polynomial <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>+</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mover accent=\"true\"><mi>z</mi><mo>ˉ</mo></mover><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>+</mo><mover accent=\"true\"><mi>z</mi><mo>ˉ</mo></mover><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x-z)(x+z)(x-\\bar z)(x+\\bar z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5678em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5678em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>. On one hand this is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">PQ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">PQ</span></span></span></span>, where <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span> is the minimal polynomial of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">-z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span>, that is still with integers coefficients, but on the other hand it is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mn>2</mn><mi mathvariant=\"normal\">Im</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mi>z</mi><mo>−</mo><mi mathvariant=\"normal\">∣</mi><mi>z</mi><msup><mi mathvariant=\"normal\">∣</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>2</mn><mi mathvariant=\"normal\">Im</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mi>z</mi><mo>−</mo><mi mathvariant=\"normal\">∣</mi><mi>z</mi><msup><mi mathvariant=\"normal\">∣</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo><mo>∈</mo><mi>R</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">(x^2-2\\operatorname{Im}(z)z-|z|^2)(x^2+2\\operatorname{Im}(z)z-|z|^2) \\in R[x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">Im</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">Im</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span>.</p>",
        "id": 543157934,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1759666084
    },
    {
        "content": "<p>is there a non-trivial ring with ac=0 and abc=1?</p>",
        "id": 543159007,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759667232
    },
    {
        "content": "<p>Ah if you even drop commutativity then everything becomes surely a huge mess</p>",
        "id": 543159054,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1759667283
    },
    {
        "content": "<p>(I feel like there's some smart linear transformations over infinite dimension vector space that would work)</p>",
        "id": 543159083,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759667312
    },
    {
        "content": "<p>yeah ok let</p>\n<ul>\n<li>a(x0, x1, ...) = (0, x0, 0, x1, ...)</li>\n<li>b(x0, x1, ...) = (x1, x2, ...)</li>\n<li>c(x0, x1, ...) = (x0, x2, x4, ...)</li>\n</ul>\n<p>(use the reverse composition order, i.e. do a and then do b and then do c)</p>",
        "id": 543159242,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759667435
    },
    {
        "content": "<p>yes, with functions <code>ℕ → ℕ</code> is immediate (it's what you did, but just play with indexes)</p>",
        "id": 543159495,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1759667643
    },
    {
        "content": "<p>in some sense R[x] is also the \"wrong object\" to consider (like mathlib's elliptic curve over commring)</p>",
        "id": 543159872,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759667974
    },
    {
        "content": "<p>do we have the correct R&lt;x&gt;?</p>",
        "id": 543159885,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759667987
    },
    {
        "content": "<p>how does it even work? does XaX = XbX imply a=b?</p>",
        "id": 543159957,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759668060
    },
    {
        "content": "<p>What do you mean? For one variable noncommutative polynomials are just polynomials</p>",
        "id": 543159963,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1759668064
    },
    {
        "content": "<p><code>R</code> is alwyas in the center</p>",
        "id": 543159993,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1759668089
    },
    {
        "content": "<p>I mean the one where aX and Xa are different, does this have a name?</p>",
        "id": 543160003,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759668100
    },
    {
        "content": "<p>in general we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FreeAlgebra#doc\">docs#FreeAlgebra</a></p>",
        "id": 543160004,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1759668101
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/543160004\">said</a>:</p>\n<blockquote>\n<p>in general we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FreeAlgebra#doc\">docs#FreeAlgebra</a></p>\n</blockquote>\n<p><a href=\"/user_uploads/3121/ubsQEK7y7tzrgbzjxwzBjH16/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/ubsQEK7y7tzrgbzjxwzBjH16/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"198x33\" src=\"/user_uploads/thumbnail/3121/ubsQEK7y7tzrgbzjxwzBjH16/image.png/840x560.webp\"></a></div>",
        "id": 543160069,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759668138
    },
    {
        "content": "<p>maybe you want the quotient of the free ring on <code>Option R</code> by all the relations in <code>R</code></p>",
        "id": 543160081,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759668153
    },
    {
        "content": "<p>yes, because algebras are over commsemiring</p>",
        "id": 543160083,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1759668154
    },
    {
        "content": "<p>no but that would have an extra one</p>",
        "id": 543160099,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759668180
    },
    {
        "content": "<p>hmmmm</p>",
        "id": 543160101,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759668183
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/543160099\">said</a>:</p>\n<blockquote>\n<p>no but that would have an extra one</p>\n</blockquote>\n<p>it's fine we have a relation [1] = 1</p>",
        "id": 543160124,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759668204
    },
    {
        "content": "<p>your construction will work</p>",
        "id": 543160138,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759668216
    },
    {
        "content": "<p>free semiring, even</p>",
        "id": 543160151,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759668224
    },
    {
        "content": "<p>I guess</p>",
        "id": 543160152,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759668224
    },
    {
        "content": "<p>you can always take the huge free algebra over <code>ℤ</code> (generated by the variables and the elements of <code>R</code>) and quotient out by the relation on <code>R</code></p>",
        "id": 543160169,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1759668237
    },
    {
        "content": "<p>of course</p>",
        "id": 543160188,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759668251
    },
    {
        "content": "<p>indeed, i was more asking if it's in mathlib</p>",
        "id": 543160195,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759668255
    },
    {
        "content": "<p>and does it have any use</p>",
        "id": 543160208,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759668263
    },
    {
        "content": "<p>we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FreeNonUnitalNonAssocAlgebra#doc\">docs#FreeNonUnitalNonAssocAlgebra</a></p>",
        "id": 543160213,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759668270
    },
    {
        "content": "<p>I don't know if we have free extensions of a noncommutative ring</p>",
        "id": 543160288,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759668328
    },
    {
        "content": "<p>it seems like R is still in the center there (even tho R is not even commutative)</p>",
        "id": 543160309,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759668343
    },
    {
        "content": "<p>anyway, let's go back to the main context, the reason i asked that is i'm wondering whether this is true:</p>",
        "id": 543160378,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759668402
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"bp\">.</span><span class=\"n\">natDegree_le_one_of_irreducible</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Semiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">]}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Irreducible</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">natDegree</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>",
        "id": 543160387,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759668411
    },
    {
        "content": "<p>are you writing <code>R[X]</code> to mean the (semi)ring with the universal property that <code>(R[X] →+* S) ≃ ((R →+* S) × S)</code> for any (semi)ring <code>S</code></p>",
        "id": 543160696,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759668637
    },
    {
        "content": "<p>or is it just <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Polynomial#doc\">docs#Polynomial</a></p>",
        "id": 543160739,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759668672
    },
    {
        "content": "<p>I'm guessing it's just <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Polynomial#doc\">docs#Polynomial</a></p>",
        "id": 543160814,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759668753
    },
    {
        "content": "<p>yes polynomial</p>",
        "id": 543160970,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759668899
    },
    {
        "content": "<p>it's for <a href=\"https://github.com/leanprover-community/mathlib4/pull/30212\">#30212</a></p>",
        "id": 543160987,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759668913
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/543160387\">said</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"bp\">.</span><span class=\"n\">natDegree_le_one_of_irreducible</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Semiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">]}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Factors</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Irreducible</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">natDegree</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>This looks true to me at least over <code>CommRing</code>: if <code>P</code> is <code>c(x - a_1)...(x-a_n)</code> you have that <code>x-a_1</code> divides <code>P</code> and it is not a unit (see <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/Polynomial/Nilpotent.html#Polynomial.isUnit_iff_coeff_isUnit_isNilpotent\">Polynomial.isUnit_iff_coeff_isUnit_isNilpotent</a>), so <code>c(x - a_2)...(x-a_n)</code> must be a unit. This implies that <code>c</code> is nilpotent and in particular the constant term is also nilpotent so not a unit.</p>",
        "id": 543161420,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1759669414
    },
    {
        "content": "<p>yes the PR contains a proof for CommSemiring and i'm wonder if I can generalise it to Semiring</p>",
        "id": 543161521,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759669514
    },
    {
        "content": "<p>But why do you care? Where are the applications? This thread started off with something which has a clear application. Factorization isn't really a thing away from commutative domains, it's a pathological thing outside that domain (as you already know).</p>",
        "id": 543163379,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1759671449
    },
    {
        "content": "<p>yeah it's probably fine</p>",
        "id": 543163682,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759671744
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/543160003\">said</a>:</p>\n<blockquote>\n<p>I mean the one where aX and Xa are different, does this have a name?</p>\n</blockquote>\n<p>There is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SkewMonoidAlgebra#doc\">docs#SkewMonoidAlgebra</a>.</p>",
        "id": 543165433,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1759673570
    },
    {
        "content": "<p>it seems like aX = Xa there?</p>",
        "id": 543165536,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759673666
    },
    {
        "content": "<p>That should be <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mi>a</mi><mo>=</mo><mi>σ</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mi>X</mi></mrow><annotation encoding=\"application/x-tex\"> Xa = \\sigma(a) X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span>.</p>",
        "id": 543165901,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1759674052
    },
    {
        "content": "<p>The semiring structure comes very late in the file, with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SkewMonoidAlgebra.instNonUnitalSemiring#doc\">docs#SkewMonoidAlgebra.instNonUnitalSemiring</a> that involves an action of the monoid on the scalars.</p>",
        "id": 543165968,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1759674127
    },
    {
        "content": "<p>i guess that's a more useful instance (though still not \"free\")</p>",
        "id": 543166042,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759674211
    },
    {
        "content": "<p>not free enough</p>",
        "id": 543166306,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759674456
    },
    {
        "content": "<p>Then you have the free associative algebra on a set, but that's just the algebra on the word monoid of that set.</p>",
        "id": 543234989,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1759735686
    },
    {
        "content": "<p>Do we really want <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mi>x</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2x + 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> to not be split in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Z</mi><mo stretchy=\"false\">[</mo><mi>X</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Z}[X]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">Z</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">]</span></span></span></span>? I imagine having the nontrivial fact that splits in Q =&gt; splits in Z easily available would be useful, which is not true under the current definition.</p>",
        "id": 546120268,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1761004466
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"224323\">Junyan Xu</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/543045238\">said</a>:</p>\n<blockquote>\n<p>One can imagine that a quadratic polynomial can be written as a product of three factors but not two. I think in general it's safer to take the monoid generated by X-r and all constants. This would also bring it closer to the roots definition, since general linear polynomials may not have a root but monic ones (X-r) do have.</p>\n</blockquote>\n<p>I guess the motivation was the connection with having roots.</p>",
        "id": 546120939,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1761004805
    },
    {
        "content": "<p>In particular, for my ANT applications, I would prefer \"f splits/factors in this ring\" to mean \"f has roots in this ring\"</p>",
        "id": 546121008,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1761004844
    },
    {
        "content": "<p>Or another way of saying this is that there is some advantage to having a predicate that distinguishes these cases of \"roots in the ring\" vs \"roots in the field of fractions\"</p>",
        "id": 546122979,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1761006173
    },
    {
        "content": "<p>Yeah, this sounds like a place where we want to have two similar-but-slightly-distinct predicates?</p>",
        "id": 546161291,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1761031997
    },
    {
        "content": "<p>Is there an immediate use case for the \"product of degree &lt;= 1\" definition? If not, could we hold off on on introducing it until it's needed?</p>\n<p>(E.g., even if you've got a polynomial like 2x+1, if you care about it being a \"product of degree &lt;= 1\", then you probably care about it's roots in the field of fractions, so the field of fractions is probably already in the picture, and you can just say that the polynomial factors after mapping to the field of fractions).</p>",
        "id": 546167130,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1761033907
    },
    {
        "content": "<p>Here are the first couple PRs: <a href=\"https://github.com/leanprover-community/mathlib4/pull/30869\">#30869</a> and <a href=\"https://github.com/leanprover-community/mathlib4/pull/30870\">#30870</a> (mostly targeting occurrences of <code>Polynomial.Splits (RingHom.id k)</code> for now.</p>",
        "id": 547039817,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1761380966
    },
    {
        "content": "<p>I am assigning both of them to myself, but I will not have time during the weekend, so anyone should feel free to review!</p>",
        "id": 547043999,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1761385081
    },
    {
        "content": "<p>Do we really want to replace <code>Splits</code> by <code>Factors</code> <em>everywhere</em>? I agree it's sometimes better, but the \"Splits\" seems a more standard terminology.</p>",
        "id": 548245322,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1761944520
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"253861\">Thomas Browning</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/543043364\">said</a>:</p>\n<blockquote>\n<p>For the time being, would it make sense to introduce a separate predicate <code>Polynomial.Factors</code> (product of polynomials of degree &lt;=1), build out some API, and then redefine splits in terms of that?</p>\n</blockquote>\n<p>I thought it was a temporary measure</p>",
        "id": 548245760,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761944757
    },
    {
        "content": "<p>If the point is redefining <code>Splits</code> using <code>Factors</code>, what is the point of of refactoring current declaration that use <code>Splits</code> to use <code>Factors</code>?</p>",
        "id": 548245915,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1761944842
    },
    {
        "content": "<p>Yeah, this is something I'm not altogether sure about. I think at least for the instances of <code>Splits (RingHom.id F)</code>, it definitely makes sense to split over.</p>",
        "id": 548248965,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1761946696
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/548245760\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"253861\">Thomas Browning</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/543043364\">said</a>:</p>\n<blockquote>\n<p>For the time being, would it make sense to introduce a separate predicate <code>Polynomial.Factors</code> (product of polynomials of degree &lt;=1), build out some API, and then redefine splits in terms of that?</p>\n</blockquote>\n<p>I thought it was a temporary measure</p>\n</blockquote>\n<p>From this perspective (where we're trying to fix suboptimal design decisions in <code>Splits</code>), the idea would be to get rid of <code>Splits</code> entirely, and then rename <code>Factors</code> to <code>Splits</code>, I guess?</p>",
        "id": 548249080,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1761946771
    },
    {
        "content": "<p>aha, interesting</p>",
        "id": 548250162,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761947426
    },
    {
        "content": "<p>But the current approach doesn't seem sustainable, we would end up with a lot of deprecated declarations coming from the \"limbo\" period.</p>",
        "id": 548250880,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1761947911
    },
    {
        "content": "<p>It seems better to redefine splits on terms of factors, fixing the api and not touching any declaration that only uses splits</p>",
        "id": 548250972,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1761947969
    },
    {
        "content": "<p>Anyway we should think a bit before doing a lot of work</p>",
        "id": 548251052,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1761948011
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"253861\">@Thomas Browning</span> will a lot of code break if we just replace Splits right now by Factors map?</p>",
        "id": 548251075,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761948028
    },
    {
        "content": "<p>it's a bit tricky here because they don't have the same type (Splits eats a map as input)</p>",
        "id": 548251119,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761948052
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/548250972\">said</a>:</p>\n<blockquote>\n<p>It seems better to redefine splits on terms of factors, fixing the api and not touching any declaration that only uses splits</p>\n</blockquote>\n<p>Well, <code>Splits</code> is already defined in terms of <code>Factors</code> at this point.</p>",
        "id": 548251326,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1761948172
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/548251119\">said</a>:</p>\n<blockquote>\n<p>it's a bit tricky here because they don't have the same type (Splits eats a map as input)</p>\n</blockquote>\n<p>Yeah, you could try to pull off the band-aid all at once, but it would be a massive refactor where everything breaks.</p>",
        "id": 548251394,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1761948214
    },
    {
        "content": "<p>but if Splits is already defined using Factors then it wouldn't break right?</p>",
        "id": 548251476,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761948266
    },
    {
        "content": "<p>Piecemeal switching to <code>Factors</code> would be easier in this regard, but it does have this issue of deprecated definitions that Reccardo points out.</p>",
        "id": 548251477,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1761948267
    },
    {
        "content": "<p>ok, yeah, it is a lot of files:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>Mathlib.Algebra.Polynomial.Splits\nMathlib.Algebra.CubicDiscriminant\nMathlib.FieldTheory.Separable\nMathlib.RingTheory.Adjoin.Field\nMathlib.FieldTheory.SplittingField.IsSplittingField\nMathlib.FieldTheory.IntermediateField.Adjoin.Basic\nMathlib.FieldTheory.Extension\nMathlib.FieldTheory.Normal.Defs\nMathlib.FieldTheory.IsAlgClosed.Basic\nMathlib.FieldTheory.SplittingField.Construction\nMathlib.FieldTheory.IsAlgClosed.AlgebraicClosure\nMathlib.FieldTheory.Normal.Basic\nMathlib.FieldTheory.Normal.Closure\nMathlib.FieldTheory.PrimitiveElement\nMathlib.FieldTheory.Galois.Basic\nMathlib.FieldTheory.IsSepClosed\nMathlib.FieldTheory.SeparableDegree\nMathlib.RingTheory.Trace.Basic\nMathlib.RingTheory.Polynomial.Vieta\nMathlib.Topology.Algebra.Polynomial\nMathlib.FieldTheory.PolynomialGaloisGroup\n</code></pre></div>",
        "id": 548251650,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761948373
    },
    {
        "content": "<p>but from another perspective, it's \"only\" 234 declarations that need changing...</p>",
        "id": 548251677,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761948398
    },
    {
        "content": "<p>Hmm, if people are happy to review such a large diff (easily &gt; 1000 lines, I think), then this is an option...</p>",
        "id": 548252019,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1761948620
    },
    {
        "content": "<p>let's see what Riccardo thinks first</p>",
        "id": 548252125,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761948689
    },
    {
        "content": "<p>I am talking specifically about <a href=\"https://github.com/leanprover-community/mathlib4/pull/30870\">#30870</a>. For example, it modifies <code>X_pow_sub_C_splits_of_isPrimitiveRoot</code> from</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">X_pow_sub_C_splits_of_isPrimitiveRoot</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">Splits</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">RingHom</span><span class=\"bp\">.</span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>to</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">X_pow_sub_C_factors_of_isPrimitiveRoot</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">ζ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hζ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsPrimitiveRoot</span><span class=\"w\"> </span><span class=\"n\">ζ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">Factors</span>\n</code></pre></div>\n<p>And I am not sure this is good: we are creating a new declaration, <code>X_pow_sub_C_factors_of_isPrimitiveRoot</code>, that will be removed soon to get back to <code>X_pow_sub_C_splits_of_isPrimitiveRoot</code>? Then why not keeping <code>X_pow_sub_C_splits_of_isPrimitiveRoot</code>?</p>",
        "id": 548252708,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1761949096
    },
    {
        "content": "<p>But I may have misunderstood the plan.</p>",
        "id": 548252787,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1761949155
    },
    {
        "content": "<p>I see, so we should change the statement but keep the name for now?</p>",
        "id": 548252812,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761949170
    },
    {
        "content": "<p>I mean, <code>Factors</code> works better over rings, but it's equivalent over fields, so why bothering?  <code>X_pow_sub_C_factors_of_isPrimitiveRoot</code> is still about fields.</p>",
        "id": 548252937,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1761949260
    },
    {
        "content": "<p>anyway I am closing my laptop now, happy Halloween!</p>",
        "id": 548252999,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1761949313
    },
    {
        "content": "<p>The ring hom in <code>Splits</code> is really annoying and we should get rid of it regardless. And I think the easiest way to achieve this is to gradually replace it with factors.</p>",
        "id": 548254281,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1761950320
    },
    {
        "content": "<p>yes but I thought we also want to replace the name with \"Splits\" after all that</p>",
        "id": 548254349,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761950371
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/548252708\">said</a>:</p>\n<blockquote>\n<p>And I am not sure this is good: we are creating a new declaration, <code>X_pow_sub_C_factors_of_isPrimitiveRoot</code>, that will be removed soon to get back to <code>X_pow_sub_C_splits_of_isPrimitiveRoot</code>? Then why not keeping <code>X_pow_sub_C_splits_of_isPrimitiveRoot</code>?</p>\n</blockquote>\n<p>Well, if we do the shift gradually, then it wouldn't be super soon, maybe a couple months?</p>",
        "id": 548257262,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1761952520
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/548252812\">said</a>:</p>\n<blockquote>\n<p>I see, so we should change the statement but keep the name for now?</p>\n</blockquote>\n<p>It is worth considering this option since it allows for gradual replacement while avoiding the deprecation mess (the only downside being the slight mismatch between the name and statement in the short-term).</p>",
        "id": 548257871,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1761953134
    },
    {
        "content": "<p>Just to keep the ball rolling here, it seems like there are a few decisions to be made:<br>\nA) Ultimately have two predicates, one with a ring hom (<code>Splits</code>) and one without a ring hom (<code>Factors</code>).<br>\nB) Ultimately have just one predicate, without a ring hom (<code>Splits</code>, since that is the more standard name).</p>\n<p>It seems like there is consensus for <code>B</code>? Then the question would be how to achieve this refactor. Here are some options:<br>\nC) Slowly refactor mathlib (both theorem statements and theorem names) to be in terms of <code>Factors</code> instead of <code>Splits</code> until <code>Splits</code> can be deprecated. Then <code>Splits</code> is deleted and <code>Factors</code> is renamed to <code>Splits</code>. This is the approach of <a href=\"https://github.com/leanprover-community/mathlib4/pull/30870\">#30870</a>.<br>\nD) Same as <code>C</code>, but just refactor theorem statements, keeping theorem names in terms of <code>Splits</code> to avoid the need for aliases.<br>\nE) Pull off the bandaid all at once by immediately removing the ring hom from <code>Splits</code> and refactoring every subsequent usage of <code>Splits</code>.</p>\n<p>Thoughts on these options, or other suggestions?</p>",
        "id": 553659730,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1762273582
    },
    {
        "content": "<p>Personally I'm leaning towards (D) at this point since it seems least painful, but I would be happy to give (E) a shot if there's strong support and fast review.</p>",
        "id": 553660360,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1762273727
    },
    {
        "content": "<p>I think B) is much better than A).</p>\n<p>Concerning the strategy: the main problem is the ring hom, right? In the sense that we cannot just change the definition of <code>Splits</code>, we really need to change its type.</p>",
        "id": 553662415,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1762274255
    },
    {
        "content": "<p>Yes, the definition is already changed as much as it can be without changing its type.</p>",
        "id": 553662531,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1762274283
    },
    {
        "content": "<p>In D) what happens to the ring hom?</p>",
        "id": 553662913,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1762274391
    },
    {
        "content": "<p>The definition of <code>Splits</code> would remain unchanged (with the ring hom) for the time being, but every subsequent theorem would eventually be restated in terms of <code>Factors</code> (ditching the ring homs).</p>",
        "id": 553663214,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1762274470
    },
    {
        "content": "<p>(D) is just <a href=\"https://github.com/leanprover-community/mathlib4/pull/30870\">#30870</a> but without the renaming and aliases</p>",
        "id": 553663285,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1762274492
    },
    {
        "content": "<p>(The disadvantage of (D) is that in the short-term, you now have a bunch of theorems in mathlib whose name says \"splits\" but whose statement says \"factors\").</p>",
        "id": 553663673,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1762274595
    },
    {
        "content": "<p>Do you think that getting rid of the ring hom is a lot of work? I guess that 90% of the time <code>Splits</code> is used with the identity</p>",
        "id": 553663727,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1762274611
    },
    {
        "content": "<p>I have the impression that nobody likes the ring hom</p>",
        "id": 553663777,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1762274622
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/553663727\">said</a>:</p>\n<blockquote>\n<p>Do you think that getting rid of the ring hom is a lot of work? I guess that 90% of the time <code>Splits</code> is used with the identity</p>\n</blockquote>\n<p>Actually not at all</p>",
        "id": 553665179,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1762275000
    },
    {
        "content": "<p>Yeah, might only be 25%, although I think a lot of that is API for <code>Splits</code> as well as <code>Splits</code> encouraging unnecessarily relative API (i.e., <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsAlgClosed.splits_domain#doc\">docs#IsAlgClosed.splits_domain</a> shouldn't really exist, but it does since you can't just write <code>IsAlgClosed.splits.map</code>).</p>",
        "id": 553665780,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1762275166
    },
    {
        "content": "<p>Actually, here's a reason to not try to do the refactor all at once: The type difference between <code>Splits</code> and <code>Factors</code> means that they will naturally have different API, so switching over all at once would include refactoring the <code>Splits</code> API at which point the mega-PR would be a mess of new and deleted declarations. It seems simpler to develop the correct API for <code>Factors</code>, switch mathlib over from <code>Splits</code> to <code>Factors</code> using this API, and then rename <code>Factors</code> to <code>Splits</code>.</p>",
        "id": 555181069,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1762968129
    },
    {
        "content": "<p>I thought a little bit about this, and unfortunately I don't see a 100% clean way of doing things, so we have to accept a compromise. Maybe you launch a poll</p>",
        "id": 555210579,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1762977127
    },
    {
        "content": "<p>/poll What is the best way to remove the ring hom from <code>Polynomial.Splits</code>?<br>\nSlowly refactor mathlib (both theorem statements and theorem names) to be in terms of Factors instead of Splits until Splits can be deprecated. Then Splits is deleted and Factors is renamed to Splits.<br>\nSame as above, but just refactor theorem statements, keeping theorem names in terms of Splits to avoid the need for aliases.<br>\nPull off the bandaid all at once by immediately removing the ring hom from Splits and refactoring the Splits API every subsequent usage of Splits.</p>",
        "id": 555216055,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1762979107
    },
    {
        "content": "<p>I'm not sure if this is exactly what the 3rd option means, but this is what I vote for:</p>\n<ul>\n<li>\n<p>In a single PR, unfold every use of <code>Splits</code> and rename <code>Factors</code> to <code>Splits</code>. This means replacing every <code>p.Splits f</code> with <code>(p.map f).Splits</code>. Maybe this can even be done by a script.<br>\nThis keeps the theorems defeq to their previous version, and avoiding name changes is justified by the theorems still containing <code>Splits</code>.</p>\n</li>\n<li>\n<p>Refactors can come later, e.g. removing occurrences of <code>p.map (RingHom.Id)</code> introduced by the previous PR.</p>\n</li>\n</ul>",
        "id": 555221411,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1762981101
    },
    {
        "content": "<p>I'd like to avoid massive unreviewable PRs; no strong opinion on the names in the intermediate period</p>",
        "id": 555221968,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1762981314
    },
    {
        "content": "<p>The PR should be at most <code>+300/-300</code>, which I think is on the low side when it comes to mathlib based on refactors I've seen (though I'm not a reviewer, idk how hard it is)</p>",
        "id": 555222913,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1762981599
    },
    {
        "content": "<p>Well, there are over 400 usages of <code>Splits</code>, so that's at least +400/-400, not counting all the proofs that will break.</p>",
        "id": 555223596,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1762981863
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"253861\">Thomas Browning</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/555223596\">said</a>:</p>\n<blockquote>\n<p>Well, there are over 400 usages of <code>Splits</code>, so that's at least +400/-400, not counting all the proofs that will break.</p>\n</blockquote>\n<p>I counted 236 + 44 (<a href=\"https://loogle.lean-lang.org/?q=Polynomial.Splits\">https://loogle.lean-lang.org/?q=Polynomial.Splits</a> + <a href=\"https://loogle.lean-lang.org/?q=Polynomial.Factors\">https://loogle.lean-lang.org/?q=Polynomial.Factors</a>), what did I miss?</p>",
        "id": 555223714,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1762981920
    },
    {
        "content": "<p>Those are theorem statements, but proofs that mention <code>Splits</code> will need to be changed.</p>",
        "id": 555223804,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1762981957
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/553665179\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/553663727\">said</a>:</p>\n<blockquote>\n<p>Do you think that getting rid of the ring hom is a lot of work? I guess that 90% of the time <code>Splits</code> is used with the identity</p>\n</blockquote>\n<p>Actually not at all</p>\n</blockquote>\n<p>It looks to me like a lot of <code>Splits</code> usages use <code>algebraMap</code>, maybe we should have <code>aSplits K</code> similar to <code>aroots K</code> vs <code>roots</code>?</p>",
        "id": 555223846,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1762981973
    },
    {
        "content": "<p>I don't think so. Just say that the relevant polynomial splits.</p>",
        "id": 555224040,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1762982059
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"253861\">Thomas Browning</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/555223804\">said</a>:</p>\n<blockquote>\n<p>Those are theorem statements, but proofs that mention <code>Splits</code> will need to be changed.</p>\n</blockquote>\n<p>I tried deprecating <code>Splits</code> locally and got 275 warnings, will that check still miss some usages?<br>\nKeep in mind that the change from <code>p.Splits f</code> to <code>(p.map f).Factors</code> is defeq so only things that expect syntactical equality (e.g. <code>rw</code>) might break, and even those I'm not sure will since changing everything at once should change both sides in the same way when checking for syntactical equality.</p>",
        "id": 555253450,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1762998141
    },
    {
        "content": "<p>I removed the ringhom argument from <code>Splits</code> and replaced all usages of <code>Splits</code> with a script, and all of mathlib successfully builds except for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Polynomial.isSplittingField_C#doc\">docs#Polynomial.isSplittingField_C</a> for some reason.<br>\nSo I now have a <code>+252/-252</code> change that removes the ringhom, + one <code>sorry</code> I need to fix, + 78 lines that exceed 100 chars that I need to break manually.<br>\nSo presumably I'll be able to open a PR with <code>+330/-252</code> that completes the task (of course this is just a first step before refactors). Is that okay or is the long way still preferred?</p>",
        "id": 555262877,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1763006245
    },
    {
        "content": "<p>Fixed the <code>sorry</code> (the refactor made the first <code>simp</code> use <code>Algebra.algebraMap_self, map_C, RingHom.id_apply</code> instead of <code>Algebra.algebraMap_self, splits_C</code> for some reason) so now everything builds</p>",
        "id": 555264654,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1763007755
    },
    {
        "content": "<p>Final score: <code>+275/-264</code> (<a href=\"https://github.com/leanprover-community/mathlib4/compare/master...SnirBroshi:mathlib4:feature/polynomial/remove-splits-ringhom\">full diff</a>), result:</p>\n<div class=\"codehilite\" data-code-language=\"Diff\"><pre><span></span><code>def Splits (f : K[X]) : Prop :=\n<span class=\"gd\">-  Factors (f.map i)</span>\n<span class=\"gi\">+  Factors f</span>\n</code></pre></div>",
        "id": 555270007,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1763011839
    },
    {
        "content": "<p>Huh, that's not as bad as I thought. If this were merged, I guess the follow-up would be a PR delete <code>Splits</code> and renaming <code>Factors</code> to <code>Splits</code> (so that we keep the more general definition of <code>Factors</code> and the surrounding API).</p>",
        "id": 555281313,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1763018517
    },
    {
        "content": "<p>I'll add this to the poll.</p>",
        "id": 555281365,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1763018539
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"933054\">Snir Broshi</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/555270007\">said</a>:</p>\n<blockquote>\n<p>Final score: <code>+275/-264</code> (<a href=\"https://github.com/leanprover-community/mathlib4/compare/master...SnirBroshi:mathlib4:feature/polynomial/remove-splits-ringhom\">full diff</a>), result:</p>\n<p><div class=\"codehilite\" data-code-language=\"Diff\"><pre><span></span><code>def Splits (f : K[X]) : Prop :=\n<span class=\"gd\">-  Factors (f.map i)</span>\n<span class=\"gi\">+  Factors f</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Can you open a PR?</p>",
        "id": 555652282,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1763144957
    },
    {
        "content": "<p>Also, in some sense <span class=\"user-mention\" data-user-id=\"933054\">@Snir Broshi</span>'s can be done in parallel with the \"switching over from <code>\nSplits</code> to <code>Factors</code> without changing theorem names\" approach, since even after redefining <code>Splits</code>, we will still want to switch over to <code>Factors</code> API.</p>",
        "id": 555652715,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1763145113
    },
    {
        "content": "<p>So there might not actually be a need to choose between the two.</p>",
        "id": 555652812,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1763145143
    },
    {
        "content": "<p>(And the point is that <span class=\"user-mention\" data-user-id=\"933054\">@Snir Broshi</span>'s work would make the switch <code>Splits</code> to <code>Factors</code> easier).</p>",
        "id": 555653365,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1763145332
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"253861\">Thomas Browning</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Generalizing.20.60Polynomial.2ESplits.60.20to.20rings/near/555652282\">said</a>:</p>\n<blockquote>\n<p>Can you open a PR?</p>\n</blockquote>\n<p>Sure, just waited for confirmation here first, thanks<br>\nOpened <a href=\"https://github.com/leanprover-community/mathlib4/pull/31631\">#31631</a></p>",
        "id": 555657744,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1763146878
    },
    {
        "content": "<p>Once <a href=\"https://github.com/leanprover-community/mathlib4/pull/31631\">#31631</a> is merged, the question is what's the best next step. There's the slow option from the poll of slowly refactoring theorem statements to be in terms of <code>Factors</code> instead of <code>Splits</code>. But once <a href=\"https://github.com/leanprover-community/mathlib4/pull/31631\">#31631</a> is merged I think it's worth checking how bad the diff would be if we immediately rename <code>Factors</code> to <code>Splits</code> (deleting the current definition of <code>Splits</code>, but leaving the <code>Splits</code> file around temporarily for any API lemmas that aren't already covered in the <code>Factors</code> file).</p>",
        "id": 558506082,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1763664937
    },
    {
        "content": "<p>Merged <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 558519016,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1763669305
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/31878\">#31878</a> is +110/-128, which seems pretty reasonable. Reviews welcome!</p>",
        "id": 558587442,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1763707615
    },
    {
        "content": "<p>We're basically in the cleanup phase now. <a href=\"https://github.com/leanprover-community/mathlib4/pull/31915\">#31915</a> cleans up the lingering <code>Splits (p.map (RingHom.id _))</code> from <a href=\"https://github.com/leanprover-community/mathlib4/pull/31631\">#31631</a>. And after that, I think the only big thing left is to combine the existing <code>Splits.lean</code> and <code>Factors.lean</code> into a new-and-improved <code>Splits.lean</code> (mostly by deprecating the old API in <code>Splits.lean</code> in favor of the new API in <code>Factors.lean</code>).</p>",
        "id": 558759541,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1763763353
    },
    {
        "content": "<p>The first deprecation PR is <a href=\"https://github.com/leanprover-community/mathlib4/pull/32040\">#32040</a>, with at least a couple more to follow, I think.</p>",
        "id": 559004127,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1763980323
    },
    {
        "content": "<p>Here's the next one: <a href=\"https://github.com/leanprover-community/mathlib4/pull/32103\">#32103</a></p>",
        "id": 560280753,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1764119799
    },
    {
        "content": "<p>And here's the next one: <a href=\"https://github.com/leanprover-community/mathlib4/pull/32284\">#32284</a></p>",
        "id": 561060632,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1764562835
    },
    {
        "content": "<p>And another: <a href=\"https://github.com/leanprover-community/mathlib4/pull/32325\">#32325</a></p>",
        "id": 561351854,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1764664795
    },
    {
        "content": "<p>Here's another smaller one: <a href=\"https://github.com/leanprover-community/mathlib4/pull/32409\">#32409</a></p>",
        "id": 561772372,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1764806778
    },
    {
        "content": "<p>And another: <a href=\"https://github.com/leanprover-community/mathlib4/pull/32500\">#32500</a></p>",
        "id": 562389072,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765171647
    },
    {
        "content": "<p>Next one: <a href=\"https://github.com/leanprover-community/mathlib4/pull/32574\">#32574</a> (hopefully just two or three more)</p>",
        "id": 562555103,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765226756
    },
    {
        "content": "<p>And another: <a href=\"https://github.com/leanprover-community/mathlib4/pull/32752\">#32752</a> (just one or two more!)</p>",
        "id": 563280342,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765486131
    },
    {
        "content": "<p>Last batch: <a href=\"https://github.com/leanprover-community/mathlib4/pull/32818\">#32818</a></p>",
        "id": 563582740,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765588681
    },
    {
        "content": "<p>So at this point <code>Splits.lean</code> is entirely deprecated. What's the best way to wrap this up? Move the contents of <code>Factors.lean</code> back into <code>Splits.lean</code>? If so, should <code>Factors.lean</code> be left around as a deprecated module or something?</p>",
        "id": 563937804,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765837984
    },
    {
        "content": "<p>IMO move without deprecation because <code>Factors.lean</code> was very short-lived, but idk what's the policy</p>",
        "id": 563960953,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1765857133
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"253861\">@Thomas Browning</span> Whatever you think is best. Adding a deprecated module doesn't hurt, but as Snir points out it also isn't super necessary.</p>",
        "id": 563980122,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1765871109
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/32946\">#32946</a> moves the contents over with a deprecated module</p>",
        "id": 563986093,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1765873677
    },
    {
        "content": "<p>If the file was shipped in a stable release, it definitely should have a deprecation</p>",
        "id": 564021142,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1765885051
    },
    {
        "content": "<p>(And if you don't, I'll probably add one anyway)</p>",
        "id": 564021235,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1765885083
    }
]