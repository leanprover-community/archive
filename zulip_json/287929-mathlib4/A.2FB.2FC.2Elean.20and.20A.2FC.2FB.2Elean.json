[
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/116290-rss/topic/Recent.20Commits.20to.20mathlib4.3Amaster/near/481601907\">said</a>:</p>\n<blockquote>\n<p>Do we have any more pairs of files called <code>A/B/C.lean</code> and <code>A/C/B.lean</code>??</p>\n</blockquote>\n<p>I just ran a quick check, and I think the answer is \"no\".</p>",
        "id": 481657746,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1731312722
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"ch\">#!/usr/bin/env bash</span>\n\n\n<span class=\"c1\"># Find all directories</span>\n<span class=\"nv\">directories</span><span class=\"o\">=</span><span class=\"k\">$(</span>find<span class=\"w\"> </span>.<span class=\"w\"> </span>-type<span class=\"w\"> </span>d<span class=\"w\"> </span><span class=\"p\">|</span><span class=\"w\"> </span>sed<span class=\"w\"> </span><span class=\"s1\">'s|^\\./||'</span><span class=\"k\">)</span>\n\n<span class=\"c1\"># Loop through each directory</span>\n<span class=\"k\">for</span><span class=\"w\"> </span>dir<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"nv\">$directories</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"c1\"># Extract the base name of the directory</span>\n<span class=\"w\">  </span><span class=\"nv\">base_name</span><span class=\"o\">=</span><span class=\"k\">$(</span>basename<span class=\"w\"> </span><span class=\"nv\">$dir</span><span class=\"k\">)</span>\n<span class=\"w\">  </span><span class=\"c1\"># Extract the parent directory</span>\n<span class=\"w\">  </span><span class=\"nv\">parent_dir</span><span class=\"o\">=</span><span class=\"k\">$(</span>dirname<span class=\"w\"> </span><span class=\"nv\">$dir</span><span class=\"k\">)</span>\n<span class=\"w\">  </span><span class=\"c1\"># Extract the grandparent directory</span>\n<span class=\"w\">  </span><span class=\"nv\">grandparent_dir</span><span class=\"o\">=</span><span class=\"k\">$(</span>dirname<span class=\"w\"> </span><span class=\"nv\">$parent_dir</span><span class=\"k\">)</span>\n\n<span class=\"w\">  </span><span class=\"c1\"># Skip if parent_dir is '.'</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"o\">[[</span><span class=\"w\"> </span><span class=\"nv\">$parent_dir</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"s2\">\".\"</span><span class=\"w\"> </span><span class=\"o\">]]</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">    </span><span class=\"k\">continue</span>\n<span class=\"w\">  </span><span class=\"k\">fi</span>\n\n<span class=\"w\">  </span><span class=\"c1\"># Check if the directory matches the pattern */A/B</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"o\">[[</span><span class=\"w\"> </span>-d<span class=\"w\"> </span><span class=\"s2\">\"</span><span class=\"nv\">$parent_dir</span><span class=\"s2\">\"</span><span class=\"w\"> </span><span class=\"o\">&amp;&amp;</span><span class=\"w\"> </span>-d<span class=\"w\"> </span><span class=\"s2\">\"</span><span class=\"nv\">$grandparent_dir</span><span class=\"s2\">/</span><span class=\"nv\">$base_name</span><span class=\"s2\">/</span><span class=\"nv\">$parent_dir</span><span class=\"s2\">\"</span><span class=\"w\"> </span><span class=\"o\">]]</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">    </span><span class=\"nb\">echo</span><span class=\"w\"> </span><span class=\"s2\">\"Match found: </span><span class=\"nv\">$dir</span><span class=\"s2\"> and </span><span class=\"nv\">$grandparent_dir</span><span class=\"s2\">/</span><span class=\"nv\">$base_name</span><span class=\"s2\">/</span><span class=\"nv\">$parent_dir</span><span class=\"s2\">\"</span>\n<span class=\"w\">  </span><span class=\"k\">fi</span>\n<span class=\"k\">done</span>\n</code></pre></div>",
        "id": 481657842,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1731312744
    },
    {
        "content": "<p>I actually found</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">Finite</span><span class=\"bp\">/</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">Set</span><span class=\"bp\">/</span><span class=\"n\">Finite</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n\n<span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Algebra</span><span class=\"bp\">/</span><span class=\"n\">BigOperators</span><span class=\"bp\">/</span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Algebra</span><span class=\"bp\">/</span><span class=\"n\">Module</span><span class=\"bp\">/</span><span class=\"n\">BigOperators</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n\n<span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">/</span><span class=\"n\">Limits</span><span class=\"bp\">/</span><span class=\"n\">MorphismProperty</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">/</span><span class=\"n\">MorphismProperty</span><span class=\"bp\">/</span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n</code></pre></div>\n<p>plus some close calls whose \"<code>A</code>\" is not identical.</p>",
        "id": 481830871,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1731368977
    },
    {
        "content": "<p>This is the script that I used:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"k\">while</span><span class=\"w\"> </span><span class=\"nb\">read</span><span class=\"w\"> </span>-r<span class=\"w\"> </span>first<span class=\"w\"> </span>second\n<span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"nb\">printf</span><span class=\"w\"> </span><span class=\"s1\">'* %s, %s\\n'</span><span class=\"w\"> </span><span class=\"s2\">\"</span><span class=\"nv\">$first</span><span class=\"s2\">\"</span><span class=\"w\"> </span><span class=\"s2\">\"</span><span class=\"nv\">$second</span><span class=\"s2\">\"</span>\n<span class=\"w\">  </span>git<span class=\"w\"> </span>ls-files<span class=\"w\"> </span><span class=\"p\">|</span><span class=\"w\"> </span>grep<span class=\"w\"> </span><span class=\"s2\">\"\\b\\(</span><span class=\"nv\">$first</span><span class=\"s2\">/</span><span class=\"nv\">$second</span><span class=\"s2\">.lean\\|</span><span class=\"nv\">$second</span><span class=\"s2\">/</span><span class=\"nv\">$first</span><span class=\"s2\">.lean\\)\"</span>\n<span class=\"k\">done</span><span class=\"w\"> </span>&lt;<span class=\"w\"> </span>&lt;<span class=\"o\">(</span>\n<span class=\"w\">  </span>comm<span class=\"w\"> </span>-12<span class=\"w\"> </span>&lt;<span class=\"o\">(</span>\n<span class=\"w\">    </span>git<span class=\"w\"> </span>ls-files<span class=\"w\"> </span><span class=\"s1\">'*.lean'</span><span class=\"w\"> </span><span class=\"p\">|</span>\n<span class=\"w\">      </span>awk<span class=\"w\"> </span>-F<span class=\"s1\">'/'</span><span class=\"w\"> </span><span class=\"s1\">'{ gsub(/\\.lean$/, \"\"); print $(NF-1), $NF }'</span><span class=\"w\"> </span><span class=\"p\">|</span><span class=\"w\"> </span>sort<span class=\"o\">)</span><span class=\"w\"> </span>&lt;<span class=\"o\">(</span>\n<span class=\"w\">    </span>git<span class=\"w\"> </span>ls-files<span class=\"w\"> </span><span class=\"s1\">'*.lean'</span><span class=\"w\"> </span><span class=\"p\">|</span>\n<span class=\"w\">      </span>awk<span class=\"w\"> </span>-F<span class=\"s1\">'/'</span><span class=\"w\"> </span><span class=\"s1\">'{ gsub(/\\.lean$/, \"\"); print $NF, $(NF-1) }'</span><span class=\"w\"> </span><span class=\"p\">|</span><span class=\"w\"> </span>sort<span class=\"o\">))</span>\n</code></pre></div>",
        "id": 481831209,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1731369129
    },
    {
        "content": "<p>Hah! I don't know why my script failed to find them...</p>",
        "id": 481868236,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1731389802
    },
    {
        "content": "<p>Anyway, I think all three of them are probably good targets for merging.</p>",
        "id": 481868289,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1731389832
    },
    {
        "content": "<p>I think that your <code>directories</code> contains <code>A/B</code>, but not <code>C.lean</code>?  As in, I think that they really are directories and I cannot see if you then list the content of each one of them later on...</p>",
        "id": 481878293,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1731395574
    },
    {
        "content": "<p>aah, of course <span aria-label=\"man facepalming\" class=\"emoji emoji-1f926-200d-2642\" role=\"img\" title=\"man facepalming\">:man_facepalming:</span></p>",
        "id": 481884344,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1731398106
    }
]