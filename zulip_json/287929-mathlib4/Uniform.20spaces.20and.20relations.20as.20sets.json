[
    {
        "content": "<p>In <a href=\"https://github.com/leanprover-community/mathlib4/pull/23181\">#23181</a>, I am moving the material in <code>Topology.UniformSpace.Defs</code> that's purely logic to a new file <code>Topology.UniformSpace.Entourage</code>. People complained that this wasn't really about entourages, but rather about generic relations on a type <code>α</code>, considered as <code>Set (α × α)</code>.</p>",
        "id": 513176592,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1745074378
    },
    {
        "content": "<p>This made me think that actually we already had an API for relations, which is used in a few places, but not many, namely <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Rel#doc\">docs#Rel</a>. <code>Rel α β</code> is a type synonym for <code>α → β → Prop</code>. This is different to how we use relations in uniform spaces, where instead we would want something like <code>Rel α α := Set (α × α)</code>, ie <code>α × α → Prop</code>, ie uncurried.</p>",
        "id": 513177127,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1745074793
    },
    {
        "content": "<p>I don't think we want two APIs for relations (in fact until today I thought we wanted <em>none</em>), so I am hoping we can unify the uniform space-originated material with <code>Rel</code>. In the uniform space world, the uncurried approach is forced upon by <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Filter#doc\">docs#Filter</a>, and in particular <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=uniformity#doc\">docs#uniformity</a> which has type <code>Filter (α × α)</code>. In the existing uses of <code>Rel</code>, I think we could go by with using <code>Set (α × β)</code> instead of <code>α → β → Prop</code>. It's just quite a bit of churn to switch from one to the other.</p>",
        "id": 513177400,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1745074988
    },
    {
        "content": "<p>Therefore I am thinking that we should redefine <code>Rel α β := Set (α × β)</code> and give notation for the corresponding relation <code>α → β → Prop</code>, maybe something like <code>a ~[R] b</code>? Alternatively, provide a <code>FunLike (Rel α β) α (β → Prop)</code> instance.</p>",
        "id": 513177542,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1745075097
    },
    {
        "content": "<p>What do <span class=\"user-mention\" data-user-id=\"513919\">@Damien Thomine</span>, <span class=\"user-mention\" data-user-id=\"268315\">@Anatole Dedecker</span>, <span class=\"user-mention\" data-user-id=\"110031\">@Patrick Massot</span> think?</p>",
        "id": 513177553,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1745075106
    },
    {
        "content": "<p>This was discussed many times before. In the uniform space setting we really want sets in <code>α × α</code>, not <code>α → α → Prop</code>. And calling it <code>Rel</code> would not convey this. On the other hand I don’t have any use of <code>Rel</code> so you can get rid of <code>Rel</code> is you don’t like the duplication.</p>",
        "id": 513186560,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1745081356
    },
    {
        "content": "<p>I think I landed on a nice design:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Rel</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Rel</span>\n\n<span class=\"kn\">notation</span><span class=\"o\">:</span><span class=\"mi\">50</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">:</span><span class=\"mi\">50</span><span class=\"w\"> </span><span class=\"s2\">\" ~[\"</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"s2\">\"] \"</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">:</span><span class=\"mi\">50</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">R</span>\n</code></pre></div>",
        "id": 513187742,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1745082236
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Uniform.20spaces.20and.20relations.20as.20sets/near/513186560\">said</a>:</p>\n<blockquote>\n<p>calling it <code>Rel</code> would not convey this</p>\n</blockquote>\n<p>Sorry, I am calling it <code>Rel</code>, but I claim this is no worse than what we already have, namely <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=idRel#doc\">docs#idRel</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=compRel#doc\">docs#compRel</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsSymmetricRel#doc\">docs#IsSymmetricRel</a></p>",
        "id": 513187838,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1745082292
    }
]