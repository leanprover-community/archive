[
    {
        "content": "<p>Hi! In the Brownian Motion project we proved a few results about bilinear forms. In particular we consider positive semidefinite continuous bilinear forms. I want to add positive semidefinite bilinear forms to mathlib, and from my point of view the definition should be (pseudo-code):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">IsPosSemidef</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">→ₛₗ</span><span class=\"o\">[</span><span class=\"n\">I</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">→ₗ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"n\">nonneg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>\n<p>which is what I did in <a href=\"https://github.com/leanprover-community/mathlib4/pull/28162\">#28162</a>, by extending <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/LinearAlgebra/SesquilinearForm.html#LinearMap.IsSymm\">LinearMap.IsSymm</a> and <code>LinearMap.Nonneg</code> which I define in <a href=\"https://github.com/leanprover-community/mathlib4/pull/28162\">#28162</a>. But as I said in our context we are dealing with bilinear maps, so having to deal with a <code>RingHom.id</code> due to the symmetry is a bit annoying. I thought I would just write a lemma for the specific case where <code>I = RingHom.id</code>. But then I noticed that <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/LinearAlgebra/BilinearForm/Properties.html#LinearMap.BilinForm.IsSymm\">LinearMap.BilinForm.IsSymm</a> already exists, and the file is roughly a copy of the one for sesquilinear forms. I was surprised by such duplication.</p>\n<p>I ended up wondering whether duplication was fine if it allowed to deal with bilinear forms without ever having to mention sesquilinear forms. In particular, should I define positive semidefinite <strong>bilinear</strong> forms, i.e. duplicating the above definition for <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/LinearAlgebra/BilinearMap.html#LinearMap.BilinForm\">LinearMap.BilinForm</a>?</p>\n<p>I am a bit lost and I don't know which is better: duplicating definitions feels wrong, but keeping only one definition still requires duplicating some lemmas for the special case, so in the end maybe duplicating definitions is not so bad so that when dealing only with bilinear forms you don't have to worry about sesquilinear forms at all.</p>\n<p>But then there is also the issue that we want <strong>continuous</strong> bilinear forms in the project, so should I keep on duplicating and create a special definition for continuous bilinear forms as well? This feels like it would lead to too much duplication.</p>\n<p>I am sorry if the message is not clear, I have been struggling with these questions for some time now and I still cannot decide what is the right way to go.</p>",
        "id": 542720081,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1759405507
    },
    {
        "content": "<p>Unless somebody thinks it's better otherwise, I think what I will do is duplicate <code>IsPosSemidef</code> for bilinear forms as the duplicate already exists for <code>IsSymm</code>, but I won't duplicate for continuous bilinear forms and just introduce a <code>ContinuousLinearMap.toBilinForm</code>.</p>",
        "id": 543245372,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1759738694
    },
    {
        "content": "<p>It seems one might wish for a <code>BilinFormClass</code>.</p>",
        "id": 543250891,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1759740205
    },
    {
        "content": "<p>This might be the best solution for dealing with continuous bilinear forms. But it does not solve the question of bilinear forms vs sesquilinear forms.</p>",
        "id": 543252067,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1759740516
    }
]