[
    {
        "content": "<p>How do I prove this in Mathlib?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">VecNotation</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">CompletePartialOrder</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">ConditionallyCompleteLattice</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CompleteLinearOrder</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">iSup</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>(In my use case, <code>a</code> and <code>b</code> are <code>NNReal</code>s.)</p>",
        "id": 489832353,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1734552161
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=sup_eq_iSup#doc\">docs#sup_eq_iSup</a> ?</p>",
        "id": 489832835,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1734552362
    },
    {
        "content": "<p>But this has <code>Bool</code> as index type, not <code>Fin 2</code>.</p>",
        "id": 489832953,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1734552400
    },
    {
        "content": "<p>A very general trick for these kinds of situation is to use the universal property</p>",
        "id": 489833110,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734552471
    },
    {
        "content": "<p>Which universal property of what?</p>",
        "id": 489833206,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1734552492
    },
    {
        "content": "<p>(also may I complain of MWEs importing <code>Mathlib</code>? I've now been waiting for three minutes getting the entire cache)</p>",
        "id": 489833229,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734552502
    },
    {
        "content": "<p>Sorry, I was too lazy to minimize the imports. (It doesn't take long on the live web page, though.)</p>",
        "id": 489833391,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1734552566
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">VecNotation</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">ConditionallyCompleteLattice</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CompleteLinearOrder</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">iSup</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">eq_of_forall_ge_iff</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">forall_fin_two</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 489833531,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734552606
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CompleteLinearOrder</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">iSup</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">--rw [&lt;- sup_iSup_nat_succ]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">sup_comm</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">sup_eq_iSup</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">iSup_congr</span><span class=\"w\"> </span><span class=\"n\">finTwoEquiv</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">&lt;;&gt;</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">finTwoEquiv</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 489833921,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1734552777
    },
    {
        "content": "<p>But Yaël's approach clearly works too</p>",
        "id": 489834026,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1734552826
    },
    {
        "content": "<p>Would it make sense to have that in Mathlib (together with the <code>Inf</code> version)?</p>",
        "id": 489834119,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1734552851
    },
    {
        "content": "<p>(seems like there are no lemmas about <code>finTwoEquiv</code>)</p>",
        "id": 489834133,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1734552855
    },
    {
        "content": "<p>I think the better lemma to have is <code>Set.range ![a, b] = {a, b}</code>, as then you can unfold <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=iSup#doc\">docs#iSup</a> and rewrite using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=sSup_pair#doc\">docs#sSup_pair</a></p>",
        "id": 489834284,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734552917
    },
    {
        "content": "<p>I just think there are too many variants of such lemmas for them to be worth having</p>",
        "id": 489834333,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734552944
    },
    {
        "content": "<p>What we should have instead is some reflection-like handling of vector notation, so that eg <code>iSup ![a, b, c, d, e] = a ⊔ b ⊔ c ⊔ d ⊔ e</code> can be proved easily. Maybe a simproc? Maybe carefully chosen simp lemmas?</p>",
        "id": 489834649,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734553080
    },
    {
        "content": "<p>Something close to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Fin.range_cons#doc\">docs#Fin.range_cons</a> ?</p>",
        "id": 489834710,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1734553088
    },
    {
        "content": "<p>Why is <code>NNReal</code> not a <code>CompleteLinearOrder</code>?<br>\nI just noticed that I can't apply the lemma to my use case <span aria-label=\"frown\" class=\"emoji emoji-1f641\" role=\"img\" title=\"frown\">:frown:</span></p>",
        "id": 489835215,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1734553288
    },
    {
        "content": "<p>It doesn't have suprema of unbounded above sets - it is a conditionally complete linear order instead</p>",
        "id": 489835329,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1734553328
    },
    {
        "content": "<p>Because the naturals has no sup? I guess <code>ENNReal</code> will be the complete one.</p>",
        "id": 489835345,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1734553334
    },
    {
        "content": "<p>OK, so what are the necessary type class assumptions then? (Yaël's proof seems to break down for <code>NNReal</code>s.)</p>",
        "id": 489835473,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1734553386
    },
    {
        "content": "<p>Ruben's proof also breaks down. So how to prove what I actually want:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">VecNotation</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">NNReal</span><span class=\"bp\">.</span><span class=\"n\">Defs</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">NNReal</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">iSup</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 489835733,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1734553509
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">VecNotation</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">ConditionallyCompleteLattice</span><span class=\"bp\">.</span><span class=\"n\">Indexed</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ConditionallyCompleteLinearOrder</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">iSup</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">eq_of_forall_ge_iff</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ciSup_le_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">forall_fin_two</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 489835938,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1734553584
    },
    {
        "content": "<p>Somehow I think this should be easier (say, <code>simp</code> should be able to do that...).</p>",
        "id": 489836377,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1734553745
    },
    {
        "content": "<p>I guess that comes back to Yaël's suggestion further above..</p>",
        "id": 489836486,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1734553792
    },
    {
        "content": "<p><code>ConditionallyCompleteLattice</code> actually works in place of <code>ConditionallyCompleteLinearOrder</code></p>",
        "id": 489836631,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1734553835
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/287929-mathlib4/topic/max.20.3D.20iSup/near/489835938\">said</a>:</p>\n<blockquote>\n<p>[...]</p>\n</blockquote>\n<p>As stated above, using the universal property is a very versatile proof strategy <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span></p>",
        "id": 489836871,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734553942
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479359\">Michael Stoll</span> <a href=\"#narrow/channel/287929-mathlib4/topic/max.20.3D.20iSup/near/489836377\">said</a>:</p>\n<blockquote>\n<p>asier (say, <code>simp</code> should be able to do that...).</p>\n</blockquote>\n<p>I actually don't know why <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ciSup_le_iff#doc\">docs#ciSup_le_iff</a> isn't simp</p>",
        "id": 489836910,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734553964
    }
]