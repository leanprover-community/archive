[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">EquivLike</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">IsSymm</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">E₁</span><span class=\"w\"> </span><span class=\"n\">E₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">EquivLike</span><span class=\"w\"> </span><span class=\"n\">E₁</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">EquivLike</span><span class=\"w\"> </span><span class=\"n\">E₂</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">E₁</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">E₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">eq_symm_apply</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">EquivLike</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">]</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">EquivLike</span><span class=\"bp\">.</span><span class=\"n\">IsSymm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">≃+*</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">RingEquiv</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">eq_symm_apply</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">RingEquiv</span><span class=\"bp\">.</span><span class=\"n\">eq_symm_apply</span><span class=\"w\"> </span><span class=\"bp\">..</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">≃+*</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">EquivLike</span><span class=\"bp\">.</span><span class=\"n\">IsSymm</span><span class=\"bp\">.</span><span class=\"n\">eq_symm_apply</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>",
        "id": 547121856,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761476732
    },
    {
        "content": "<p>I recall earlier being told that class predicate on function is bad, but it seems to work for this example?</p>",
        "id": 547121877,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761476746
    },
    {
        "content": "<p>basically I want to make <code>xxx.symm</code> into a class so that we don't have to write a <a href=\"https://loogle.lean-lang.org/?q=%22eq_symm_apply%22\">new eq_symm_apply lemma</a> every time we define a new equivlike class</p>",
        "id": 547121923,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761476776
    },
    {
        "content": "<p>I would make <code>symm</code> an <code>outParam</code></p>",
        "id": 547122559,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1761477463
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span> since you're here do you think this is a good idea?</p>",
        "id": 547129770,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761484414
    },
    {
        "content": "<p>Honestly I am not an heavy user of <code>IsAdjoinRoot</code>, so we should see how it is used in practice.</p>",
        "id": 547129984,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1761484633
    },
    {
        "content": "<p>wait, this is a different discussion!</p>",
        "id": 547129993,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1761484648
    },
    {
        "content": "<p>wrong discussion</p>",
        "id": 547130007,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1761484657
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/EquivLike.2EIsSymm/near/547121923\">said</a>:</p>\n<blockquote>\n<p>basically I want to make <code>xxx.symm</code> into a class so that we don't have to write a <a href=\"https://loogle.lean-lang.org/?q=%22eq_symm_apply%22\">new eq_symm_apply lemma</a> every time we define a new equivlike class</p>\n</blockquote>\n<p>Can we also make zero_apply and add_apply etc a class</p>",
        "id": 547130063,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1761484726
    },
    {
        "content": "<p>though there is the conflict of pointwise multiplication and composition multiplication</p>",
        "id": 547130113,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1761484775
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/287929-mathlib4/topic/EquivLike.2EIsSymm/near/547130063\">said</a>:</p>\n<blockquote>\n<p>Can we also make zero_apply and add_apply etc a class</p>\n</blockquote>\n<p><code>ZeroApplyClass</code> <span aria-label=\"melt\" class=\"emoji emoji-1fae0\" role=\"img\" title=\"melt\">:melt:</span></p>",
        "id": 547130152,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761484808
    }
]