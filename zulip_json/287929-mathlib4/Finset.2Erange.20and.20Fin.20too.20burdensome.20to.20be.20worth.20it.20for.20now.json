[
    {
        "content": "<p>For sums in mathlib, Finset.range and Fin are constantly recommended for everything in the documentation. I understand why this is so, but it just immediately creates a development hell where everything you're trying to do requires constantly casting back and forth between (say) natural numbers and these types. And so of course, Lean has no idea what to do with anything either; \"apply?\" becomes essentially worthless.</p>\n<p>Has anyone found an efficient way to work with sums in mathlib4?</p>",
        "id": 511935702,
        "sender_full_name": "Daniel Briggs",
        "timestamp": 1744572747
    },
    {
        "content": "<p>Do you have examples of what's difficult?</p>",
        "id": 511936346,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1744573245
    },
    {
        "content": "<p>I find working with <code>Finset.range</code> and sums very pleasant, but it is true there is not much guidance for how to make it work. And this is particularly frustrating, because it works very nicely! So I echo Ruben's question, which parts are you struggling with?</p>",
        "id": 511938262,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1744574730
    },
    {
        "content": "<p>Thank you both for your swift replies. I'm working on proving that you can split off the first term of a sum right now. It's a little tough since the theorems are split across different subdirectories of mathlib, but I'm sure I'll get it soon.</p>\n<p>My eventual goal is to prove that each natural number has a unique decimal representation; I've written 150 lines of the proof of the easier half of the induction (when the previous number was not 9 mod 10) so far.</p>\n<p>Since Lean was...fairly...good at \"apply?\" recommendations when I was working with Nat, Int, Rat, or Real, I got a little lazy; for Fin and Finset.range, it just seems that there's no way around committing the names of a few dozen theorems to heart.</p>\n<p>I'll post examples of what I come up against as I work on it more.</p>",
        "id": 511939196,
        "sender_full_name": "Daniel Briggs",
        "timestamp": 1744575509
    },
    {
        "content": "<p>My first guess is that you want <code>Finset.sum_range_succ'</code> for this</p>",
        "id": 511939594,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1744575886
    },
    {
        "content": "<p>If this isn't for the exercise, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.digits#doc\">docs#Nat.digits</a> gives the decimal representation of a natural number, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.ofDigits#doc\">docs#Nat.ofDigits</a> is the reverse, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.ofDigits_digits#doc\">docs#Nat.ofDigits_digits</a> is their relationship, and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.digits_ofDigits#doc\">docs#Nat.digits_ofDigits</a> is basically that the digit representation is unique.</p>",
        "id": 511940483,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1744576723
    },
    {
        "content": "<p>Thanks!</p>",
        "id": 511940601,
        "sender_full_name": "Daniel Briggs",
        "timestamp": 1744576810
    },
    {
        "content": "<p>Alright, here's an example of a related point I'm stuck on today:</p>\n<p>The tactic fin_cases \"performs case analysis on a hypothesis of the form <code>h : A</code>, where <code>Fintype A</code> is available, or <code>h : a ∈ A</code>, where <code>A : Finset X</code>, <code>A : Multiset X</code> or <code>A : List X</code>.\" There is <em>one</em> example in the documentation of its use, followed by a few paragraphs of what used to work in mathlib3 and doesn't work anymore.</p>\n<p>I have:</p>\n<p><strong>msd</strong> : ℕ := (digits 10 x).getLast nonemp<br>\n<strong>msdlem</strong> : msd ≤ 9 ∧ 1 ≤ msd<br>\n<strong>xx</strong> : ¬msd ∈ {1, 2, 3, 4, 6, 8}<br>\n<strong>⊢</strong> msd ∈ {5, 7, 9}</p>\n<p>I'd like to use fin_cases to make this work, since cases would be an indentation headache. I've tried to do this after establishing <code>have finny : msd ∈ Finset.range 10</code> or <code>have h_msd_in_1_to_9 : msd ∈ (Finset.Icc 1 9 : Finset Nat)</code>, but I can't figure out how to go from Finset.range or Finset.Icc to Fin, and there's no relevant example in the documentation either.</p>",
        "id": 512131763,
        "sender_full_name": "Daniel Briggs",
        "timestamp": 1744650127
    },
    {
        "content": "<p>Can you make this a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> ?</p>",
        "id": 512131979,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744650192
    },
    {
        "content": "<p>Sorry, I had missed out one hypothesis. It should be there now.</p>\n<p>(There's probably a better way with set unions too, but this could become an instructive example of how to use fin_cases.)</p>",
        "id": 512132086,
        "sender_full_name": "Daniel Briggs",
        "timestamp": 1744650221
    },
    {
        "content": "<p><code>interval_cases</code> is probably the better tactic to use here.</p>",
        "id": 512133101,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1744650485
    },
    {
        "content": "<p>Thanks! Yes, interval_cases seems to be working here. And I've used it before! I just forgot about it, since I've been encountering so many things at once.</p>",
        "id": 512135354,
        "sender_full_name": "Daniel Briggs",
        "timestamp": 1744651186
    },
    {
        "content": "<p>I think loogle can most of the time do the work of <code>apply?</code> if you know what you're searching for. I haven't done many Finset.sum proofs, but a mental model I have realized is that converting all kinds of indices to Finset.Ico generally lessens headache</p>",
        "id": 512138138,
        "sender_full_name": "Sabbir Rahman",
        "timestamp": 1744652089
    }
]