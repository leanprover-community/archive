[
    {
        "content": "<p>Our Mathlib linters have become too slow. They are nice, but not at this cost.</p>\n<p>c.f. <a href=\"https://gist.github.com/kim-em/0ed296b8b1ec9353fc9ceb8d4ef86f73\">this file</a>, which is a stripped down minimization of a problem in Mathlib from <a href=\"https://github.com/leanprover/lean4/pull/6123\">lean#6123</a>.</p>\n<p>It compiles fine with no imports, or with <code>Mathlib.Init</code>. Here is the timing information:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">hyperfine</span><span class=\"w\"> </span><span class=\"s2\">\"lake env lean Mathlib/CategoryTheory/Category/Cat/6123_with_init.lean\"</span>\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">/</span><span class=\"n\">Category</span><span class=\"bp\">/</span><span class=\"n\">Cat</span><span class=\"bp\">/</span><span class=\"mf\">6123.</span><span class=\"n\">lean</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">2.683</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.011</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">2.276</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.394</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">2.668</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">2.702</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">hyperfine</span><span class=\"w\"> </span><span class=\"s2\">\"lake env lean Mathlib/CategoryTheory/Category/Cat/6123_without_init.lean\"</span>\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">/</span><span class=\"n\">Category</span><span class=\"bp\">/</span><span class=\"n\">Cat</span><span class=\"bp\">/</span><span class=\"mf\">6123.</span><span class=\"n\">lean</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.118</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.005</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.953</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.157</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.110</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.125</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n</code></pre></div>\n<p>That is, adding <code>Mathlib.Init</code> <em>more than doubles</em> the compile time. </p>\n<p>This is not good, and we need to fix it. Would anyone be interested in going through the imports of <code>Mathlib.Init</code>, and identifying which one(s) are responsible for this slow down? We can disable and/or redesign them.</p>",
        "id": 484614290,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732664481
    },
    {
        "content": "<p>Does lean provide a mechanism to measure the runtime of linters with <code>trace.profiler</code>?</p>",
        "id": 484617021,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1732666222
    },
    {
        "content": "<p>Do you know what the cause of the slowdown is? Importing time? Style linter time?  Additional elaboration time?</p>",
        "id": 484621874,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1732669581
    },
    {
        "content": "<p>My main suspects are the unusedTactic and the multiGoal linters: they search the InfoTrees and I'm always wary of this.</p>",
        "id": 484628052,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1732673820
    },
    {
        "content": "<p>I won't have time to properly investigate this for a couple days, though.</p>",
        "id": 484628130,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1732673879
    },
    {
        "content": "<p>Strangely, when I started investigating again, it is less severe: 1.126s without Init, 1.670s with. Still bad though.</p>",
        "id": 484628920,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732674398
    },
    {
        "content": "<p>Okay, here is the raw data for each individual import of <code>Mathlib.Init</code> (starting with none, then each import separately, and then all). (I've also gone through each import of Mathlib.Init and removed the import of Mathlib.Linter.Header, to avoid counting that in all of them.)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">MathlibTest</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"bp\">/</span><span class=\"n\">NoImports</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.099</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.004</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.953</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.136</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.090</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.105</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">MathlibTest</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"bp\">/</span><span class=\"n\">DocPrime</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.179</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.006</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.005</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.165</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.172</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.193</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">MathlibTest</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"bp\">/</span><span class=\"n\">GlobalAttributeIn</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.252</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.035</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.061</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.182</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.211</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.308</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">MathlibTest</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"bp\">/</span><span class=\"n\">HashCommandLinter</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.208</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.030</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.029</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.170</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.174</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.267</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">MathlibTest</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"bp\">/</span><span class=\"n\">Header</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.189</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.006</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.014</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.165</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.180</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.199</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">MathlibTest</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"bp\">/</span><span class=\"n\">Lint</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.366</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.005</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.139</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.217</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.357</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.375</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">MathlibTest</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"bp\">/</span><span class=\"n\">Multigoal</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.172</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.011</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.007</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.157</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.158</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.190</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">MathlibTest</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"bp\">/</span><span class=\"n\">OldObtain</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.178</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.016</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.005</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.162</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.166</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.212</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">MathlibTest</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"bp\">/</span><span class=\"n\">RefineLinter</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.175</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.009</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.006</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.160</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.162</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.189</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">MathlibTest</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"bp\">/</span><span class=\"n\">Style</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.175</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.007</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.006</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.160</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.161</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.187</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">MathlibTest</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"bp\">/</span><span class=\"n\">UnusedTactic</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.297</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.013</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.097</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.192</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.289</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.329</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">MathlibTest</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"bp\">/</span><span class=\"n\">Init</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.671</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.017</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.354</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.309</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.652</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.709</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n</code></pre></div>",
        "id": 484630617,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732675557
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Multigoal</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">73</span><span class=\"n\">ms</span>\n<span class=\"n\">RefineLinter</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">76</span><span class=\"n\">ms</span>\n<span class=\"n\">Style</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">76</span><span class=\"n\">ms</span>\n<span class=\"n\">OldObtain</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">79</span><span class=\"n\">ms</span>\n<span class=\"n\">DocPrime</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">80</span><span class=\"n\">ms</span>\n<span class=\"n\">Header</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">90</span><span class=\"n\">ms</span>\n<span class=\"n\">HashCommandLinter</span><span class=\"w\"> </span><span class=\"mi\">107</span><span class=\"n\">ms</span>\n<span class=\"n\">GlobalAttributeIn</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">151</span><span class=\"n\">ms</span>\n<span class=\"n\">UnusedTactic</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">197</span><span class=\"n\">ms</span>\n<span class=\"n\">Lint</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">265</span><span class=\"n\">ms</span>\n<span class=\"n\">Everything</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">572</span><span class=\"n\">ms</span>\n</code></pre></div>",
        "id": 484630813,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732675687
    },
    {
        "content": "<p>The individual contributions there add up to 1194ms, which is more than 572ms, so there is some amount of \"double counting\" still going on.</p>",
        "id": 484630904,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732675760
    },
    {
        "content": "<p>Gah, I'm an idiot, I need to re-run all this. The reason things sped up is that I moved the test files to <code>MathlibTest</code>, where many of these linters are disabled. Trying again.</p>",
        "id": 484631220,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732675997
    },
    {
        "content": "<p>I am frustrated that <a href=\"https://github.com/leanprover/lean4/pull/2756\">lean#2756</a>, allowing <code>lake build X/Y/Z.lean</code>, is not getting fixed. I'm finding myself having to generate command line that include both <code>X.Y.Z</code> and <code>X/Y/Z.lean</code> forms. Not pretty.</p>",
        "id": 484632021,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732676497
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rm</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">rf</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">InitTiming</span><span class=\"bp\">.</span><span class=\"n\">DocPrime</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.382</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.007</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.106</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.292</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.371</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.395</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rm</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">rf</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">InitTiming</span><span class=\"bp\">.</span><span class=\"n\">GlobalAttributeIn</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.387</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.005</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.104</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.303</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.378</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.396</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rm</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">rf</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">InitTiming</span><span class=\"bp\">.</span><span class=\"n\">HashCommandLinter</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.389</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.005</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.093</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.287</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.376</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.394</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rm</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">rf</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">InitTiming</span><span class=\"bp\">.</span><span class=\"n\">Header</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.299</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.046</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.075</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.269</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.267</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.387</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rm</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">rf</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">InitTiming</span><span class=\"bp\">.</span><span class=\"n\">Init</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">2.230</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.035</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.735</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.548</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">2.210</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">2.326</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rm</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">rf</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">InitTiming</span><span class=\"bp\">.</span><span class=\"n\">Lint</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.694</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.006</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.354</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.389</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.682</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.702</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rm</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">rf</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">InitTiming</span><span class=\"bp\">.</span><span class=\"n\">Multigoal</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.383</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.007</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.110</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.290</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.372</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.393</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rm</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">rf</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">InitTiming</span><span class=\"bp\">.</span><span class=\"n\">NoImports</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.217</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.051</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.009</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.176</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.169</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.282</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rm</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">rf</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">InitTiming</span><span class=\"bp\">.</span><span class=\"n\">OldObtain</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.366</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.040</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.083</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.290</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.290</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.396</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rm</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">rf</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">InitTiming</span><span class=\"bp\">.</span><span class=\"n\">RefineLinter</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.386</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.008</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.099</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.297</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.371</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.399</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rm</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">rf</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">InitTiming</span><span class=\"bp\">.</span><span class=\"n\">Style</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.386</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.007</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.100</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.291</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.378</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.398</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n\n<span class=\"n\">Benchmark</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rm</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">rf</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">InitTiming</span><span class=\"bp\">.</span><span class=\"n\">UnusedTactic</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">):</span><span class=\"w\">      </span><span class=\"mf\">1.477</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">±</span><span class=\"w\">  </span><span class=\"mf\">0.054</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">User</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.179</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">System</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.324</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"o\">):</span><span class=\"w\">    </span><span class=\"mf\">1.386</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">…</span><span class=\"w\">  </span><span class=\"mf\">1.578</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">runs</span>\n</code></pre></div>",
        "id": 484633374,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732677455
    },
    {
        "content": "<ul>\n<li><strong>Header</strong>: 82ms</li>\n<li><strong>OldObtain</strong>: 149ms</li>\n<li><strong>Multigoal</strong>: 166ms</li>\n<li><strong>DocPrime</strong>: 165ms</li>\n<li><strong>RefineLinter</strong>: 169ms</li>\n<li><strong>Style</strong>: 169ms</li>\n<li><strong>GlobalAttributeIn</strong>: 170ms</li>\n<li><strong>HashCommandLinter</strong>: 172ms</li>\n<li><strong>UnusedTactic</strong>: 260ms</li>\n<li><strong>Lint</strong>: 477ms</li>\n<li><strong>Init</strong>: 1013ms</li>\n</ul>",
        "id": 484633565,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732677596
    },
    {
        "content": "<p>You can reproduce this by running</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">InitTiming</span><span class=\"bp\">/*.</span><span class=\"n\">lean</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"k\">do</span><span class=\"w\"> </span><span class=\"n\">hyperfine</span><span class=\"w\"> </span><span class=\"s2\">\"rm -rf .lake/build/lib/Mathlib/InitTiming &amp;&amp; lake build Mathlib.InitTiming.$(basename ${f%.*})\"</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">done</span>\n</code></pre></div>\n<p>on <a href=\"https://github.com/leanprover-community/mathlib4/tree/InitTiming\">branch#InitTiming</a></p>",
        "id": 484633735,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732677711
    },
    {
        "content": "<p>Lint itself has many linters, so it is unsurprising that it is the biggest impact. Perhaps we should split it up.</p>",
        "id": 484633825,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732677757
    },
    {
        "content": "<p>The fact that so many of them are at ~170ms is a bit strange. Are they all doing the same work? Is this work shared when we run them together?</p>",
        "id": 484633872,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732677802
    },
    {
        "content": "<p>GlobalAttributeIn + HashCommandLinter: 164ms (less than either of them! but there's noise, so not to worry)</p>",
        "id": 484634049,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732677945
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/287929-mathlib4/topic/.60Mathlib.2EInit.60.20is.20too.20slow/near/484633872\">said</a>:</p>\n<blockquote>\n<p>The fact that so many of them are at ~170ms is a bit strange. Are they all doing the same work? Is this work shared when we run them together?</p>\n</blockquote>\n<p>I don't see what work could be shared - they're invoked using a simple <code>for linter in linters do</code> loop from what I can see.</p>",
        "id": 484638574,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1732681460
    },
    {
        "content": "<p>I'm not sure about the other linters, but the time the <a href=\"https://github.com/leanprover-community/mathlib4/blob/master/Mathlib/Tactic/Linter/Style.lean\"><code>Style</code> linter</a> takes is really surprising to me - it feels like the time it takes shouldn't even be measurable, it's really simple</p>",
        "id": 484638586,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1732681475
    },
    {
        "content": "<p>oh! We need to do another comparison where we just import some fragment of <code>Lean</code> itself. That is going to explain a big chunk of this.</p>",
        "id": 484638703,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732681566
    },
    {
        "content": "<p>As said before:  <code>Lint</code> is a collection of various smaller style lints (most of them stylistic). I'll make a PR moving them to the Style file.</p>",
        "id": 484661795,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1732695513
    },
    {
        "content": "<p>I'll be able to look at this further tonight (in 8-9 hours).</p>",
        "id": 484661808,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1732695518
    },
    {
        "content": "<p>It might make sense to unify some of these linters: scan the syntax once, accumulating all exceptions and then report issues only if the corresponding option is true.</p>",
        "id": 484662769,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1732695874
    },
    {
        "content": "<p>Doing something like this has been in the back of my mind for a while, but I did not do it.</p>",
        "id": 484662944,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1732695941
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/.60Mathlib.2EInit.60.20is.20too.20slow/near/484661795\">said</a>:</p>\n<blockquote>\n<p>As said before:  <code>Lint</code> is a collection of various smaller style lints (most of them stylistic). I'll make a PR moving them to the Style file.</p>\n</blockquote>\n<p>Update: <a href=\"https://github.com/leanprover-community/mathlib4/pull/19529\">#19529</a> is that PR. Quick review welcome, as this PR is inherently bit-rotty. (In fact, two previous attempts incurred merge conflicts.)</p>",
        "id": 484671951,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1732698888
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> <a href=\"#narrow/channel/287929-mathlib4/topic/.60Mathlib.2EInit.60.20is.20too.20slow/near/484662944\">said</a>:</p>\n<blockquote>\n<p>Doing something like this has been in the back of my mind for a while, but I did not do it.</p>\n</blockquote>\n<p>I have a 90-minute \"hacking time window\" tonight. I can see if I find time for this; will keep you updated.</p>",
        "id": 484672270,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1732698971
    },
    {
        "content": "<p>Here's a hacky version, doing this for five \"easy\" syntax style linters: <a href=\"https://github.com/leanprover-community/mathlib4/pull/19547\">#19547</a>.</p>",
        "id": 484774360,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1732730834
    },
    {
        "content": "<p>Do you know how to benchmark this properly? (Aside from running <code>bench!</code>, which I can do once CI has run.) As I understand it, the above methodology was still not conclusive...</p>",
        "id": 484774489,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1732730883
    },
    {
        "content": "<p>I also opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/19551\">#19551</a> to gauge the overall effect of the syntax style linters, and <a href=\"https://github.com/leanprover-community/mathlib4/pull/19552\">#19552</a> for just the multi-goal linter.<br>\nRunning <code>bench!</code> on these PRs, once CI is done, is welcome. (Or pointing me to docs if/how profiling can provide this information already. I don't know the new profiling infrastructure well enough.)</p>",
        "id": 484804314,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1732744224
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/.60Mathlib.2EInit.60.20is.20too.20slow/near/484774489\">said</a>:</p>\n<blockquote>\n<p>Do you know how to benchmark this properly? (Aside from running <code>bench!</code>, which I can do once CI has run.) As I understand it, the above methodology was still not conclusive...</p>\n</blockquote>\n<p>I do not know what \"properly\" would mean, but certainly the outcome should be that there is a noticeable effect on mathlib!  So, benchmarking the way you are doing seems a good approach.  It may be somewhat costly to have to try all linter combinations, but maybe a few benchmarks will allow to extrapolate and produce informed guesses.</p>",
        "id": 484809834,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1732747106
    },
    {
        "content": "<p><code>!bench</code> says -11% and -8.4% on \"interpretation\" metric without other significant changes.</p>",
        "id": 484819170,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1732753572
    },
    {
        "content": "<p>Summary of benchmarking results so far</p>\n<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/19547\">#19547</a> (trying to merge 5 small syntax style linters): small effect so far (-0,4% on interpretation; 250*10⁹ instructions) had little effect. This could several reasons: suboptimal implementation, the linters themselves running quickly -&gt; investigating by further benchmarking</li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/19557\">#19557</a> (disable these five linters): -9,4% on interpretation, -2500*10⁹ instructions (i.e. 1,8% of mathlib), -300s task-clock</li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/19551\">#19551</a> (disable all 7 syntax style linters): -11% on interpretation, -2900*10⁹ instructions (i.e. 2% of mathlib); -240s task-clock</li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/19552\">#19552</a> (disable the multi-goal linter): -8.5% on interpretation, -2200*10⁹ instructions (-1.55%), -240s task-clock</li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/19556\">#19556</a> (disable the unusedTactic linter): -5,9% on intepretation, 1500*10⁹ instructions (-1% overall), -135s task-clock</li>\n</ul>\n<p>Conclusion. The <code>multi-goal</code> and <code>unusedTactic</code> linters are indeed somewhat expensive. And I'll try to optimise <a href=\"https://github.com/leanprover-community/mathlib4/pull/19547\">#19547</a> further.</p>",
        "id": 484869127,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1732784389
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/.60Mathlib.2EInit.60.20is.20too.20slow/near/484617021\">said</a>:</p>\n<blockquote>\n<p>Does lean provide a mechanism to measure the runtime of linters with <code>trace.profiler</code>?</p>\n</blockquote>\n<p>I would start with <code>--profile</code>. However, at least for me the impact of adding <code>import Mathlib.Init</code> is only about 15%, <code>--profile</code> says it's mostly added importing time.</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>~/mathlib4  ➦ ec29ecebbe  lake env lean Mathlib/test.lean --profile; lake env lean Mathlib/test_no_init.lean --profile\nMathlib/test.lean:140:14: warning: declaration uses 'sorry'\nMathlib/test.lean:146:4: warning: declaration uses 'sorry'\nMathlib/test.lean:201:4: warning: declaration uses 'sorry'\nMathlib/test.lean:238:17: warning: declaration uses 'sorry'\nMathlib/test.lean:403:21: warning: unused variable `F`\nnote: this linter can be disabled with `set_option linter.unusedVariables false`\nMathlib/test.lean:403:42: warning: unused variable `j`\nnote: this linter can be disabled with `set_option linter.unusedVariables false`\nMathlib/test.lean:410:4: warning: declaration uses 'sorry'\nMathlib/test.lean:412:4: warning: declaration uses 'sorry'\nMathlib/test.lean:414:4: warning: declaration uses 'sorry'\nMathlib/test.lean:437:4: warning: declaration uses 'sorry'\nMathlib/test.lean:441:4: warning: declaration uses 'sorry'\nMathlib/test.lean:446:4: warning: declaration uses 'sorry'\nMathlib/test.lean:470:4: warning: declaration uses 'sorry'\nMathlib/test.lean:470:4: warning: declaration uses 'sorry'\nMathlib/test.lean:470:4: warning: declaration uses 'sorry'\nMathlib/test.lean:486:4: warning: declaration uses 'sorry'\nMathlib/test.lean:486:4: warning: declaration uses 'sorry'\ncumulative profiling times:\n        attribute application 2.12ms\n        compilation 166ms\n        dsimp 0.604ms\n        elaboration 213ms\n        fix level params 0.953ms\n        import 67.3ms\n        initialization 14.4ms\n        instantiate metavars 1.58ms\n        interpretation 123ms\n        linting 11.6ms\n        parsing 9.29ms\n        process pre-definitions 12.4ms\n        share common exprs 2.99ms\n        simp 27ms\n        tactic execution 42.1ms\n        type checking 57.6ms\n        typeclass inference 177ms\nMathlib/test_no_init.lean:140:14: warning: declaration uses 'sorry'\nMathlib/test_no_init.lean:146:4: warning: declaration uses 'sorry'\nMathlib/test_no_init.lean:201:4: warning: declaration uses 'sorry'\nMathlib/test_no_init.lean:238:17: warning: declaration uses 'sorry'\nMathlib/test_no_init.lean:403:21: warning: unused variable `F`\nnote: this linter can be disabled with `set_option linter.unusedVariables false`\nMathlib/test_no_init.lean:403:42: warning: unused variable `j`\nnote: this linter can be disabled with `set_option linter.unusedVariables false`\nMathlib/test_no_init.lean:410:4: warning: declaration uses 'sorry'\nMathlib/test_no_init.lean:412:4: warning: declaration uses 'sorry'\nMathlib/test_no_init.lean:414:4: warning: declaration uses 'sorry'\nMathlib/test_no_init.lean:437:4: warning: declaration uses 'sorry'\nMathlib/test_no_init.lean:441:4: warning: declaration uses 'sorry'\nMathlib/test_no_init.lean:446:4: warning: declaration uses 'sorry'\nMathlib/test_no_init.lean:470:4: warning: declaration uses 'sorry'\nMathlib/test_no_init.lean:470:4: warning: declaration uses 'sorry'\nMathlib/test_no_init.lean:470:4: warning: declaration uses 'sorry'\nMathlib/test_no_init.lean:486:4: warning: declaration uses 'sorry'\nMathlib/test_no_init.lean:486:4: warning: declaration uses 'sorry'\ncumulative profiling times:\n        attribute application 1.82ms\n        compilation 152ms\n        dsimp 0.579ms\n        elaboration 195ms\n        fix level params 0.991ms\n        import 30.5ms\n        initialization 15.3ms\n        instantiate metavars 1.43ms\n        interpretation 5.83ms\n        linting 7.15ms\n        parsing 8.72ms\n        process pre-definitions 11.4ms\n        share common exprs 2.74ms\n        simp 23.8ms\n        tactic execution 38ms\n        type checking 51.6ms\n        typeclass inference 157ms\n</code></pre></div>",
        "id": 484913318,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1732798002
    },
    {
        "content": "<p>Spoiler: here is what the file looks like with <a href=\"https://github.com/leanprover/lean4/pull/4460\">lean#4460</a>. Parallelizing the linter invocations does make the file about 7% faster than on the RC. <br>\n<a href=\"/user_uploads/3121/vaZgZq07FrIOKBxfYDxfiyi6/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/vaZgZq07FrIOKBxfYDxfiyi6/image.png\" title=\"image.png\"><img data-original-dimensions=\"1877x880\" src=\"/user_uploads/thumbnail/3121/vaZgZq07FrIOKBxfYDxfiyi6/image.png/840x560.webp\"></a></div>",
        "id": 484913883,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1732798216
    },
    {
        "content": "<p>I just pushed an update to the above summary, and to <a href=\"https://github.com/leanprover-community/mathlib4/pull/19547\">#19547</a>. Benchmarking results are now -1,1% on interpretation, still -0,4% on instructions. I'm not sure if that's worth it.</p>",
        "id": 484928387,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1732802643
    }
]