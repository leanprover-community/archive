[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> and I were discussing ordinals and cardinals recently, and he made the observation that cardinals are everywhere in mathlib because we've used them in our definition of dimension. I said that probably mathlib could have got away with a far weaker definition being valued in <code>WithTop Nat</code> and he said that although this might be true, cardinals are not going to be extracated now, so they really play quite a big role in mathlib.</p>\n<p>However we both suspected that ordinals played a far lesser role. Indeed I conjectured that ordinals would be used basically nowhere, because mathematicians use Zorn's lemma in practice rather than ordinal induction. I knew of only one proof in mathlib which used ordinal induction, namely <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/Category/Profinite/Nobeling.html#N%C3%B6beling-s-theorem\">N\\\"obeling's theorem</a> (and I'm off to Copenhagen on Thursday to examine the PhD thesis). Our conversation prompted me to look at the file, and I was fully expecting to see some <code>Import Mathlib.Ordinal</code> type thing at the top, but I was surprised not to see this. Turns out ordinals are imported in <code>Mathlib.LinearAlgebra.Dimension.Free</code> (even though they're never mentioned in that file), indeed they're even imported in <code>Mathlib.LinearAlgebra.FreeModule.Finite.Basic</code> and in <code>Mathlib.RingTheory.Finiteness.Cardinality</code> (again even though they're never mentioned). </p>\n<p>The reason they're so ubiquitous is that they're used in <code>Mathlib.SetTheory.Cardinal.Cofinality</code> -- the cofinality of a cardinal is defined to be the cofinality of the corresponding ordinal -- and cofinality of a cardinal is used to deduce various infinite pigeonhole principles which are used in various places. I wondered whether we could move the pigeonhole principles earlier and somehow avoid ordinals being imported everywhere but in 20 minutes of playing around I decided that actually they'd got really embedded. I don't think it's worth removing them -- there are only a couple of ordinal files so we wouldn't win much -- this post is really just to say \"huh, ordinals are imported all over the place, I am quite surprised\".</p>",
        "id": 503246940,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1741089113
    },
    {
        "content": "<p>I'm not surprised. Another reason that ordinals are imported is that the proof of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Cardinal.mul_eq_self#doc\">docs#Cardinal.mul_eq_self</a> uses ordinals.</p>",
        "id": 503350178,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1741117467
    },
    {
        "content": "<p>The <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/SmallObject/Basic.html\">small object argument</a> and its application to the existence of <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Abelian/GrothendieckCategory/EnoughInjectives.html\">enough injectives in Grothendieck abelian categories</a> is another significant situation where ordinals (and regular cardinals) appear in mathlib, through definitions by transfinite induction (and this is not a mathlibism: ordinals already appeared in the corresponding original papers/books by Baer, Cartan-Eilenberg and Grothendieck).</p>",
        "id": 503353121,
        "sender_full_name": "Joël Riou",
        "timestamp": 1741118464
    },
    {
        "content": "<p>There seemed to be uses of countable ordinals in measure theory as well. I remember being told by my measure theory lecturer that \"there was no formula for a general Borel set\" and then being told by a logician that the measure theory lecturer should learn about countable ordinals.</p>",
        "id": 503372287,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1741125415
    },
    {
        "content": "<p>I have a plan to redefine <code>ENat.card</code> without cardinals, but can't find time to do it.</p>",
        "id": 503401969,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1741139204
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Ordinals.20are.20everywhere/near/503401969\">said</a>:</p>\n<blockquote>\n<p>I have a plan to redefine <code>ENat.card</code> without cardinals, but can't find time to do it.</p>\n</blockquote>\n<p>Can you elaborate on the plan?</p>",
        "id": 503496714,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1741176971
    },
    {
        "content": "<p>Define <code>ENat.card (α : Sort*)</code> as <code>if Finite α then (Finite.exists_equiv_fin α).choose else \\top</code>, then prove its properties and use it w/o <code>Cardinal</code>s.</p>",
        "id": 503645798,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1741213119
    },
    {
        "content": "<p>I have a draft somewhere.</p>",
        "id": 503645820,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1741213126
    },
    {
        "content": "<p>I can have a look later tonight.</p>",
        "id": 503645839,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1741213133
    },
    {
        "content": "<p>A definition that works and has few prereqs is best, but this might be an interesting definition:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"bp\">∞</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">sSup</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"bp\">↑</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">↪</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)})</span>\n</code></pre></div>\n<p>The set in question is an order ideal too. There's some theory here about how <code>ℕ∞</code> represents order ideals of <code>ℕ</code>.</p>",
        "id": 503646404,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1741213336
    },
    {
        "content": "<p>I think that <code>ENat</code> and <code>encard</code> provide a happy median between finite and infinite cardinalities in a few places. In some places, it's even the right thing mathematically - it is the most general setting where every matrix has rank equal to that of its transpose, and also where matroid rank makes sense. </p>\n<p>But more practically, universe stuff with cardinals, the mess of  juggling <code>Finite</code>/<code>Fintype</code> assumptions,  and<code>Nat</code>-valued cardinality functions with junk values are all annoying in different places. <code>ENat</code> is the place where all of these things go away. </p>\n<p>It's surprising to me, for instance, that there is no lemma currently in mathlib stating that the <code>ENat</code>-valued cardinality of a linearly independent family of vectors is at most (some version of) the <code>ENat</code>-valued rank of their span. One has to go through cardinal lifts, <code>OrderHom.mono</code> and <code>Cardinal.toENat</code> to prove this. And PRing something like this feels a bit ad hoc without a proper <code>ENat</code>-valued rank definition.</p>",
        "id": 503669034,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1741222733
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/22615\">#22615</a> - there is an attempt at something using <span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> 's definition (WIP). It proves all the existing <code>ENat.card</code> lemmas that don't relate explicitly to cardinals.</p>",
        "id": 503677509,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1741227803
    }
]