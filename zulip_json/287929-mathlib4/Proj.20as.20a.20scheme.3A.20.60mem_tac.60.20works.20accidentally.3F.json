[
    {
        "content": "<p>I'm going through all the undocumented tactics in Mathlib and writing documentation for them, and encountered <code>mem_tac</code> (<a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AlgebraicGeometry.ProjIsoSpecTopComponent.FromSpec.tacticMem_tac#doc\">docs#AlgebraicGeometry.ProjIsoSpecTopComponent.FromSpec.tacticMem_tac</a>) and <code>mem_tac_aux</code>. But it doesn't really make sense to me, it seems broken?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- `mem_tac_aux` tries to prove goals of the form `x ‚àà ùíú i` when `x` has the form of:</span>\n<span class=\"sd\">* `y ^ n` where `i = n ‚Ä¢ j` and `y ‚àà ùíú j`.</span>\n<span class=\"sd\">* a natural number `n`.</span>\n<span class=\"sd\">-/</span>\n<span class=\"kn\">macro</span><span class=\"w\"> </span><span class=\"s2\">\"mem_tac_aux\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">  </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">first</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">pow_mem_graded</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">SetLike</span><span class=\"bp\">.</span><span class=\"n\">coe_mem</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">natCast_mem_graded</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">|</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">pow_mem_graded</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">f_deg</span><span class=\"o\">)</span>\n\n<span class=\"kn\">macro</span><span class=\"w\"> </span><span class=\"s2\">\"mem_tac\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">  </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">first</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">mem_tac_aux</span><span class=\"w\"> </span><span class=\"bp\">|</span>\n<span class=\"w\">    </span><span class=\"n\">repeat</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">all_goals</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">SetLike</span><span class=\"bp\">.</span><span class=\"n\">GradedMonoid</span><span class=\"bp\">.</span><span class=\"n\">toGradedMul</span><span class=\"bp\">.</span><span class=\"n\">mul_mem</span><span class=\"o\">))</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">mem_tac_aux</span><span class=\"o\">)</span>\n</code></pre></div>\n<p><code>SetLike.GradedMonoid.toGradedMul.mul_mem</code> does not seem to typecheck, but I suppose it's intended to be <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=GradedMul.mul_mem#doc\">docs#GradedMul.mul_mem</a> pre-applied to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SetLike.GradedMonoid#doc\">docs#SetLike.GradedMonoid</a>. But, if I want to check this by removing all the extra features, the code builds just the same with:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">macro</span><span class=\"w\"> </span><span class=\"s2\">\"mem_tac\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">mem_tac_aux</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>So should we just promote <code>mem_tac_aux</code> into <code>mem_tac</code>? Or is there a reason to have the distinction for the future?</p>",
        "id": 563193768,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1765461703
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"252627\">@Jujian Zhang</span> who wrote <code>mem_tac</code> back in the age of Mathlib 3.</p>",
        "id": 563194889,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1765461979
    },
    {
        "content": "<p>No objections so: <a href=\"https://github.com/leanprover-community/mathlib4/pull/33711\">#33711</a></p>",
        "id": 566712818,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1767784928
    }
]