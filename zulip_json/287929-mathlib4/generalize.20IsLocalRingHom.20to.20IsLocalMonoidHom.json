[
    {
        "content": "<p>Hi everyone,</p>\n<p>I am trying to add the following lemma into Mathlib.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">isUnit_map_iff'</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MulEquivClass</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n</code></pre></div>\n<p>Currently the following lemma is ready in Mathlib</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">isUnit_map_iff</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">→+*</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsLocalRingHom</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n</code></pre></div>\n<p>These two lemmas have the same result. Should we generalize an abstract structure <code>IsLocalMonoidHom</code> here? Then both <code>MulEquiv</code>, <code>IsLocalRingHom</code> will be instances for this new class. So we can state a unique theorem <code>isUnit_map_iff</code> using <code>IsLocalMonoidHom</code>. Thanks to <span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> for this suggestion.</p>",
        "id": 472651370,
        "sender_full_name": "Jiang Jiedong",
        "timestamp": 1727256414
    },
    {
        "content": "<p>I think we can just rename IsLocalRingHom and make it take a <code>MonoidHomClass</code></p>",
        "id": 472654329,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1727257388
    },
    {
        "content": "<p>I agree. Although the current definition of <code>IsLocalRingHom</code> requires semiring structures, but it only uses the monoid structure. </p>\n<p>Maybe a minor problem is that the terminology will change a lot. Since \"local ring maps\" is quite a common terminology in algebraic geometry and algebraic number theory. It would be changed to a less familiar phrase \"local monoid maps\".</p>\n<p>Maybe we can rename it to <code>IsLocalHom</code>.</p>",
        "id": 472655594,
        "sender_full_name": "Jiang Jiedong",
        "timestamp": 1727257810
    },
    {
        "content": "<p>Indeed, the problem is not a technical one, but on picking the right terminology!</p>",
        "id": 472666956,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1727261400
    },
    {
        "content": "<p>I like <code>IsLocalHom</code>.</p>",
        "id": 472681482,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1727266249
    },
    {
        "content": "<p>Local to a locale, right? <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span> That's a very ambiguous name otherwise</p>",
        "id": 472683698,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1727267010
    },
    {
        "content": "<p>I think there was already a PR to do this a while back? But I think it ran into performance issues. Let me see if I can find it.</p>",
        "id": 472745084,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1727285561
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/6045\">#6045</a></p>",
        "id": 472745428,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1727285700
    },
    {
        "content": "<p>pinging <span class=\"user-mention\" data-user-id=\"284160\">@Eric Rodriguez</span></p>",
        "id": 472745504,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1727285724
    },
    {
        "content": "<p>yeah it did at the time, and I got very little time to work on it since - I'm not sure I'd be best suited to fix these issues at the moment, I have very little mathlib time these days :(</p>",
        "id": 472785449,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1727304972
    },
    {
        "content": "<p>on the other hand I think it was certainly worth doing then on the mathematical axis and I don't see why it wouldn't be worth doing now</p>",
        "id": 472785488,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1727304998
    }
]