[
    {
        "content": "<p>I want to bring attention to a new \"feature\" of mathport (really just some shell script wrangling), oneshot execution, added in <a href=\"https://github.com/leanprover-community/mathport/pull/191\">mathport#191</a>. You can now write a lean 3 file, add some <code>#align</code>s in a lean 4 file, and run <code>make oneshot</code> and in less than a second it will do all the work to compile everything and produce a lean 4 output file. This is useful both for mathport developers testing out changes, as well as end users who want to add <code>#align</code>s and get immediate feedback in the rest of the file.</p>",
        "id": 305816645,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1666617412
    },
    {
        "content": "<p>Oh this is super helpful, thanks! I'd been doing all this manually and it was a bit tedious</p>",
        "id": 305901800,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1666640696
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span>, do you have an elan override that is making this work? I'm getting</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>% make oneshot\ncd sources/lean &amp;&amp; lean --make --recursive --ast --tlean ../../Oneshot/lean3-in\nlean: unrecognized option `--make'\nUnknown command line option\nLean (version 4.0.0-nightly-2022-10-29, commit 62ec0bfdb02e, Release)\n</code></pre></div>",
        "id": 307630548,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1667429050
    },
    {
        "content": "<p>Even if I add an override in <code>sources/lean</code>, I get:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>% make oneshot\ncd sources/lean &amp;&amp; lean --make --recursive --ast --tlean ../../Oneshot/lean3-in\n./build/bin/mathport config.oneshot.json Oneshot::main &gt;&gt; Logs/oneshot.out 2&gt; &gt;(tee -a Logs/oneshot.err &gt;&amp;2)\nporting Main\nuncaught exception: [resolveMod3] failed to resolve 'init'\nmake: *** [Outputs/src/oneshot/Oneshot/Main.lean] Error 1\n</code></pre></div>",
        "id": 307631129,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1667429390
    },
    {
        "content": "<p>I thought that this override had already been set up by mathport's default installation. <code>make lean3-predata</code> is doing the same thing</p>",
        "id": 307664366,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1667456947
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Scott Morrison</span></p>",
        "id": 307664375,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1667456953
    },
    {
        "content": "<p>Ah, I see, the makefile target for <code>lean3-predata</code> is creating that elan override, but I guess I have a checked out copy in which I've never run that target.</p>",
        "id": 307664621,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1667457078
    },
    {
        "content": "<p>oh, <code>lean3-predata</code> does an <code>elan override</code> immediately prior, I'll make the <code>oneshot</code> command do that as well</p>",
        "id": 307664623,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1667457081
    },
    {
        "content": "<p>Lake build fails if I want to run <code>oneshot</code> on a fresh clone of mathport after running <code>make predata</code> (which was successful).</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">└─$</span> <span class=\"n\">make</span> <span class=\"n\">oneshot</span>\n<span class=\"n\">cd</span> <span class=\"n\">Oneshot</span><span class=\"bp\">/</span><span class=\"n\">lean3</span><span class=\"bp\">-</span><span class=\"k\">in</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">elan</span> <span class=\"n\">override</span> <span class=\"n\">set</span> <span class=\"bp\">`</span><span class=\"n\">cat</span> <span class=\"bp\">../../</span><span class=\"n\">sources</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">leanpkg.toml</span> <span class=\"bp\">|</span> <span class=\"n\">grep</span> <span class=\"n\">lean_version</span> <span class=\"bp\">|</span> <span class=\"n\">cut</span> <span class=\"bp\">-</span><span class=\"n\">d</span> <span class=\"sc\">'\"'</span> <span class=\"bp\">-</span><span class=\"n\">f2</span><span class=\"bp\">`</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">using</span> <span class=\"n\">existing</span> <span class=\"n\">install</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">48</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">override</span> <span class=\"n\">toolchain</span> <span class=\"n\">for</span> <span class=\"bp\">'/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">moritz</span><span class=\"bp\">/</span><span class=\"n\">coding</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">/</span><span class=\"n\">Oneshot</span><span class=\"bp\">/</span><span class=\"n\">lean3</span><span class=\"bp\">-</span><span class=\"k\">in</span><span class=\"bp\">'</span> <span class=\"n\">set</span> <span class=\"n\">to</span> <span class=\"bp\">'</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">48</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">'</span>\n\n  <span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">48</span><span class=\"bp\">.</span><span class=\"mi\">0</span> <span class=\"n\">unchanged</span> <span class=\"bp\">-</span> <span class=\"n\">Lean</span> <span class=\"o\">(</span><span class=\"n\">version</span> <span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">48</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"n\">commit</span> <span class=\"mi\">283</span><span class=\"n\">f6ed8083a</span><span class=\"o\">,</span> <span class=\"n\">Release</span><span class=\"o\">)</span>\n\n<span class=\"n\">cd</span> <span class=\"n\">Oneshot</span><span class=\"bp\">/</span><span class=\"n\">lean3</span><span class=\"bp\">-</span><span class=\"k\">in</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">lean</span> <span class=\"c1\">--make --recursive --ast --tlean .</span>\n<span class=\"n\">cd</span> <span class=\"n\">Oneshot</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"k\">in</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">lake</span> <span class=\"n\">build</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">no</span> <span class=\"n\">such</span> <span class=\"n\">file</span> <span class=\"n\">or</span> <span class=\"n\">directory</span> <span class=\"o\">(</span><span class=\"n\">error</span> <span class=\"n\">code</span><span class=\"o\">:</span> <span class=\"mi\">2</span><span class=\"o\">)</span>\n  <span class=\"n\">file</span><span class=\"o\">:</span> <span class=\"bp\">./../../</span><span class=\"n\">lean_packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">lakefile.lean</span>\n<span class=\"n\">make</span><span class=\"o\">:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">Makefile</span><span class=\"o\">:</span><span class=\"mi\">127</span><span class=\"o\">:</span> <span class=\"n\">Oneshot</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"k\">in</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Oneshot.trace</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">1</span>\n</code></pre></div>",
        "id": 309143574,
        "sender_full_name": "Moritz Doll",
        "timestamp": 1668153082
    },
    {
        "content": "<p>you also need to build mathport itself (<code>make build</code> or <code>lake build</code>)</p>",
        "id": 309188076,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1668171617
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> can you (or someone else who knows how) add some step-by-step instructions for using mathport oneshot to the mathlib4 wiki? I know it was covered in the meeting last week but that audio was really hard to hear in the recording on YouTube, and it would be nice to have them written somewhere anyway.</p>",
        "id": 310712268,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1668724482
    },
    {
        "content": "<p>Hey, i'm getting this error</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>r@pc-60 ~/P/mathport <span class=\"o\">(</span>master<span class=\"o\">)</span>&gt; make oneshot\n<span class=\"nb\">cd</span> Oneshot/lean4-in <span class=\"o\">&amp;&amp;</span> lake build\nwarning: manifest out of date: <span class=\"nb\">source</span> kind <span class=\"o\">(</span>git/path<span class=\"o\">)</span> of dependency mathlib changed, use <span class=\"sb\">`</span>lake update<span class=\"sb\">`</span> to update\nwarning: manifest out of date: <span class=\"nb\">source</span> kind <span class=\"o\">(</span>git/path<span class=\"o\">)</span> of dependency std changed, use <span class=\"sb\">`</span>lake update<span class=\"sb\">`</span> to update\nwarning: manifest out of date: <span class=\"nb\">source</span> kind <span class=\"o\">(</span>git/path<span class=\"o\">)</span> of dependency Qq changed, use <span class=\"sb\">`</span>lake update<span class=\"sb\">`</span> to update\n./build/bin/mathport config.oneshot.json Oneshot::main &gt;&gt; Logs/oneshot.out <span class=\"m\">2</span>&gt; &gt;<span class=\"o\">(</span>tee -a Logs/oneshot.err &gt;<span class=\"p\">&amp;</span><span class=\"m\">2</span><span class=\"o\">)</span>\nbash: line <span class=\"m\">1</span>: Logs/oneshot.out: No such file or directory\nmake: *** <span class=\"o\">[</span>Makefile:127: Outputs/src/oneshot/Oneshot/Main.lean<span class=\"o\">]</span> Error <span class=\"m\">1</span>\n</code></pre></div>\n<p>I've done <code>lake build</code> and <code>make lean3-predata</code> beforehand. Any idea what's wrong?</p>",
        "id": 315519159,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670912478
    },
    {
        "content": "<p><code>mkdir -p Logs/</code> first should help</p>",
        "id": 315519718,
        "sender_full_name": "Reid Barton",
        "timestamp": 1670912810
    },
    {
        "content": "<p>It would get created automatically by some of the other targets, but not this one</p>",
        "id": 315519739,
        "sender_full_name": "Reid Barton",
        "timestamp": 1670912831
    },
    {
        "content": "<p>ah thanks! i did mkdir the  <code>Logs</code> at some point but I guess there were other issues at that point, and now that really is the problem/solution.</p>",
        "id": 315519935,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670912904
    },
    {
        "content": "<p>Mmh, I put <a href=\"https://github.com/leanprover-community/mathlib/blob/e64d8a5bffaef322a12ddb9240fc6c399846f683/src/combinatorics/quiver/symmetric.lean\">this file</a> in <code>main.lean</code> and nothing in the <code>Oneshot.lean</code> part and got: </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">./</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">mathport</span> <span class=\"n\">config.oneshot.json</span> <span class=\"n\">Oneshot</span><span class=\"o\">::</span><span class=\"n\">main</span> <span class=\"bp\">&gt;&gt;</span> <span class=\"n\">Logs</span><span class=\"bp\">/</span><span class=\"n\">oneshot.out</span> <span class=\"mi\">2</span><span class=\"bp\">&gt;</span> <span class=\"bp\">&gt;</span><span class=\"o\">(</span><span class=\"n\">tee</span> <span class=\"bp\">-</span><span class=\"n\">a</span> <span class=\"n\">Logs</span><span class=\"bp\">/</span><span class=\"n\">oneshot.err</span> <span class=\"bp\">&gt;&amp;</span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"n\">porting</span> <span class=\"n\">Main</span>\n<span class=\"n\">uncaught</span> <span class=\"n\">exception</span><span class=\"o\">:</span> <span class=\"o\">[</span><span class=\"n\">resolveMod3</span><span class=\"o\">]</span> <span class=\"n\">failed</span> <span class=\"n\">to</span> <span class=\"n\">resolve</span> <span class=\"bp\">'</span><span class=\"n\">combinatorics.quiver.basic'</span>\n<span class=\"n\">make</span><span class=\"o\">:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">Makefile</span><span class=\"o\">:</span><span class=\"mi\">127</span><span class=\"o\">:</span> <span class=\"n\">Outputs</span><span class=\"bp\">/</span><span class=\"n\">src</span><span class=\"bp\">/</span><span class=\"n\">oneshot</span><span class=\"bp\">/</span><span class=\"n\">Oneshot</span><span class=\"bp\">/</span><span class=\"n\">Main.lean</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">1</span>\n</code></pre></div>\n<p>Should I synchronize manually or something?</p>",
        "id": 315520447,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670913137
    },
    {
        "content": "<p>you need to get the mathlib release data if you want to import mathlib files</p>",
        "id": 315526518,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1670916500
    },
    {
        "content": "<p><code>./download-release.sh nightly-YYYY-MM-DD</code></p>",
        "id": 315526541,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1670916521
    },
    {
        "content": "<p>Thanks! how do I know which release I want?</p>",
        "id": 315526638,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670916580
    },
    {
        "content": "<p>either that or compile them yourself:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">./</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">mathport</span> <span class=\"c1\">--make config.json Mathbin::combinatorics.quiver.basic &gt;&gt; Logs/mathport.out</span>\n</code></pre></div>",
        "id": 315526741,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1670916605
    },
    {
        "content": "<p>I just get yesterday's release</p>",
        "id": 315526792,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1670916627
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathport/tags\">https://github.com/leanprover-community/mathport/tags</a></p>",
        "id": 315526900,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1670916680
    },
    {
        "content": "<p>oh, the syntax might have changed since they are now more than nightly</p>",
        "id": 315526923,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1670916694
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">r</span><span class=\"bp\">@</span><span class=\"n\">pc</span><span class=\"bp\">-</span><span class=\"mi\">60</span> <span class=\"bp\">~/</span><span class=\"n\">P</span><span class=\"bp\">/</span><span class=\"n\">mathport</span> <span class=\"o\">(</span><span class=\"n\">master</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"mi\">2</span><span class=\"o\">]</span><span class=\"bp\">&gt;</span>\n\n                                   <span class=\"bp\">./</span><span class=\"n\">download</span><span class=\"bp\">-</span><span class=\"n\">release.sh</span> <span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">12</span><span class=\"bp\">-</span><span class=\"mi\">12</span>\n\n<span class=\"bp\">+</span> <span class=\"bp\">./</span><span class=\"n\">download</span><span class=\"bp\">-</span><span class=\"n\">ported.sh</span> <span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">12</span><span class=\"bp\">-</span><span class=\"mi\">12</span>\n<span class=\"bp\">+</span> <span class=\"n\">mkdir</span> <span class=\"bp\">-</span><span class=\"n\">p</span> <span class=\"n\">Outputs</span><span class=\"bp\">/</span><span class=\"n\">oleans</span><span class=\"bp\">/</span><span class=\"n\">leanbin</span><span class=\"bp\">/</span>\n<span class=\"bp\">+</span> <span class=\"n\">pushd</span> <span class=\"n\">Outputs</span><span class=\"bp\">/</span><span class=\"n\">oleans</span><span class=\"bp\">/</span><span class=\"n\">leanbin</span><span class=\"bp\">/</span>\n<span class=\"bp\">~/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">/</span><span class=\"n\">Outputs</span><span class=\"bp\">/</span><span class=\"n\">oleans</span><span class=\"bp\">/</span><span class=\"n\">leanbin</span> <span class=\"bp\">~/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">mathport</span>\n<span class=\"bp\">+</span> <span class=\"n\">curl</span> <span class=\"bp\">-</span><span class=\"n\">L</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">/</span><span class=\"n\">releases</span><span class=\"bp\">/</span><span class=\"n\">download</span><span class=\"bp\">/</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">12</span><span class=\"bp\">-</span><span class=\"mi\">12</span><span class=\"bp\">/</span><span class=\"n\">lean3</span><span class=\"bp\">-</span><span class=\"n\">binport.tar.gz</span>\n<span class=\"bp\">+</span> <span class=\"n\">tar</span> <span class=\"n\">xz</span>\n  <span class=\"bp\">%</span> <span class=\"n\">Total</span>    <span class=\"bp\">%</span> <span class=\"n\">Received</span> <span class=\"bp\">%</span> <span class=\"n\">Xferd</span>  <span class=\"n\">Average</span> <span class=\"n\">Speed</span>   <span class=\"n\">Time</span>    <span class=\"n\">Time</span>     <span class=\"n\">Time</span>  <span class=\"n\">Current</span>\n                                 <span class=\"n\">Dload</span>  <span class=\"n\">Upload</span>   <span class=\"n\">Total</span>   <span class=\"n\">Spent</span>    <span class=\"n\">Left</span>  <span class=\"n\">Speed</span>\n<span class=\"mi\">100</span>     <span class=\"mi\">9</span>  <span class=\"mi\">100</span>     <span class=\"mi\">9</span>    <span class=\"mi\">0</span>     <span class=\"mi\">0</span>     <span class=\"mi\">45</span>      <span class=\"mi\">0</span> <span class=\"c1\">--:--:-- --:--:-- --:--:--    46</span>\n\n<span class=\"n\">gzip</span><span class=\"o\">:</span> <span class=\"n\">stdin</span><span class=\"o\">:</span> <span class=\"n\">not</span> <span class=\"k\">in</span> <span class=\"n\">gzip</span> <span class=\"n\">format</span>\n<span class=\"n\">tar</span><span class=\"o\">:</span> <span class=\"n\">Child</span> <span class=\"n\">returned</span> <span class=\"n\">status</span> <span class=\"mi\">1</span>\n<span class=\"n\">tar</span><span class=\"o\">:</span> <span class=\"n\">Error</span> <span class=\"n\">is</span> <span class=\"n\">not</span> <span class=\"n\">recoverable</span><span class=\"o\">:</span> <span class=\"n\">exiting</span> <span class=\"n\">now</span>\n</code></pre></div>",
        "id": 315527027,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670916731
    },
    {
        "content": "<p>let me see</p>",
        "id": 315527033,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670916734
    },
    {
        "content": "<p>you should pick a name that shows up on that list</p>",
        "id": 315527073,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1670916753
    },
    {
        "content": "<p>(it would be nice if <code>download-release</code> just automatically got the latest version)</p>",
        "id": 315527135,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1670916787
    },
    {
        "content": "<p>I get the same error with <code>predata-nightly-2022-12-13-01</code></p>",
        "id": 315527202,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670916814
    },
    {
        "content": "<p>OK, let me recap the process to get Oneshot running:</p>\n<ol>\n<li>\n<p>Clone <code>https://github.com/leanprover-community/mathport/</code><br>\n<code>\n   git clone https://github.com/leanprover-community/mathport/\n   </code></p>\n</li>\n<li>\n<p>get in the folder:<br>\n<code>\n   cd mathport\n   </code></p>\n</li>\n<li>\n<p>I had to install <code>cmake</code> and <code>gmp</code> <br>\n<code>\n   sudo dnf install cmake gmp gmp-devel\n   </code></p>\n</li>\n<li>\n<p>Run <code>make build</code></p>\n</li>\n<li>Run <code>make lean3-predata</code></li>\n<li>Get a mathport release with <code>./download_release $my_choice</code>.</li>\n<li>Modify the <code>Oneshot/lean3-in/main.lean</code> file to my wishes.</li>\n<li>Run <code>make oneshot</code></li>\n</ol>",
        "id": 315528001,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670917219
    },
    {
        "content": "<p>I see the URL for <code>mathlib-predata</code> is </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">/</span><span class=\"n\">releases</span><span class=\"bp\">/</span><span class=\"n\">download</span><span class=\"bp\">/</span><span class=\"n\">predata</span><span class=\"bp\">-</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">12</span><span class=\"bp\">-</span><span class=\"mi\">13</span><span class=\"bp\">-</span><span class=\"mi\">01</span><span class=\"bp\">/</span><span class=\"n\">mathlib3</span><span class=\"bp\">-</span><span class=\"n\">predata.tar.gz</span>\n</code></pre></div>\n<p>while the script tries to get</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">/</span><span class=\"n\">releases</span><span class=\"bp\">/</span><span class=\"n\">download</span><span class=\"bp\">/</span><span class=\"n\">predata</span><span class=\"bp\">-</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">12</span><span class=\"bp\">-</span><span class=\"mi\">13</span><span class=\"bp\">-</span><span class=\"mi\">01</span><span class=\"bp\">/</span><span class=\"n\">lean3</span><span class=\"bp\">-</span><span class=\"n\">binport.tar.gz</span>\n</code></pre></div>\n<p>is that what's going wrong?</p>",
        "id": 315529730,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670918070
    },
    {
        "content": "<p>No these are different things. e.g. the most recent mathport output appears to be <a href=\"https://github.com/leanprover-community/mathport/releases/tag/nightly-2022-12-13-04\">https://github.com/leanprover-community/mathport/releases/tag/nightly-2022-12-13-04</a></p>",
        "id": 315530655,
        "sender_full_name": "Reid Barton",
        "timestamp": 1670918487
    },
    {
        "content": "<p>Ah, I just chose wrong!</p>",
        "id": 315530918,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670918623
    },
    {
        "content": "<p>For <code>download_release.sh</code> I think you should use one of those version strings e.g. <code>nightly-2022-12-13-04</code> (one without <code>predata</code>).</p>",
        "id": 315530937,
        "sender_full_name": "Reid Barton",
        "timestamp": 1670918633
    },
    {
        "content": "<p>Don't know why github lists the \"releases\" in an unhelpful order</p>",
        "id": 315531110,
        "sender_full_name": "Reid Barton",
        "timestamp": 1670918701
    },
    {
        "content": "<p>how did you find the correct one to use?</p>",
        "id": 315531223,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670918756
    },
    {
        "content": "<p>because choosing <code>nightly-2022-12-13-01</code>, which I see at the top of the <code>tag</code> page, does not work</p>",
        "id": 315531305,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670918784
    },
    {
        "content": "<p>I used the \"Next\" button.</p>",
        "id": 315531358,
        "sender_full_name": "Reid Barton",
        "timestamp": 1670918814
    },
    {
        "content": "<p>Are you sure you don't see <code>predata-nightly-2022-12-13-01</code>?</p>",
        "id": 315531375,
        "sender_full_name": "Reid Barton",
        "timestamp": 1670918823
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">r</span><span class=\"bp\">@</span><span class=\"n\">pc</span><span class=\"bp\">-</span><span class=\"mi\">60</span> <span class=\"bp\">~/</span><span class=\"n\">P</span><span class=\"bp\">/</span><span class=\"n\">mathport</span> <span class=\"o\">(</span><span class=\"n\">master</span><span class=\"o\">)</span><span class=\"bp\">&gt;</span> <span class=\"n\">make</span> <span class=\"n\">oneshot</span>\n<span class=\"bp\">./</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">mathport</span> <span class=\"n\">config.oneshot.json</span> <span class=\"n\">Oneshot</span><span class=\"o\">::</span><span class=\"n\">main</span> <span class=\"bp\">&gt;&gt;</span> <span class=\"n\">Logs</span><span class=\"bp\">/</span><span class=\"n\">oneshot.out</span> <span class=\"mi\">2</span><span class=\"bp\">&gt;</span> <span class=\"bp\">&gt;</span><span class=\"o\">(</span><span class=\"n\">tee</span> <span class=\"bp\">-</span><span class=\"n\">a</span> <span class=\"n\">Logs</span><span class=\"bp\">/</span><span class=\"n\">oneshot.err</span> <span class=\"bp\">&gt;&amp;</span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"n\">porting</span> <span class=\"n\">Main</span>\n<span class=\"bp\">#</span> <span class=\"n\">output</span> <span class=\"n\">is</span> <span class=\"k\">in</span> <span class=\"n\">Outputs</span><span class=\"bp\">/</span><span class=\"n\">src</span><span class=\"bp\">/</span><span class=\"n\">oneshot</span><span class=\"bp\">/</span><span class=\"n\">Oneshot</span><span class=\"bp\">/</span><span class=\"n\">Main.lean</span>\n</code></pre></div>",
        "id": 315531399,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670918836
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110032\">Reid Barton</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Mathport.20oneshot/near/315531375\">said</a>:</p>\n<blockquote>\n<p>Are you sure you don't see <code>predata-nightly-2022-12-13-01</code>?</p>\n</blockquote>\n<p>Ah, I do, actually. I thought I just had to <strong>strip</strong> the <code>predata</code> part!</p>",
        "id": 315531524,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670918885
    },
    {
        "content": "<p>I'm not sure what you need to download specifically for Oneshot to work, but the <code>predata-</code> ones should be used with <code>download-predata.sh</code> and the others with <code>download-release.sh</code></p>",
        "id": 315531538,
        "sender_full_name": "Reid Barton",
        "timestamp": 1670918893
    },
    {
        "content": "<p>You need to download any release which is compatible with the mathlib4 version used to compile mathport</p>",
        "id": 315531606,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1670918935
    },
    {
        "content": "<p>Ahh I think github is basing the release \"date\" on the git commit of mathport itself, so it doesn't realize that newer releases (which are based on more recent versions of mathlib) are better, and should be shown on the first page</p>",
        "id": 315531773,
        "sender_full_name": "Reid Barton",
        "timestamp": 1670919002
    },
    {
        "content": "<p>incompatibilities usually manifest as an error saying that the mathport environment could not be loaded because some definition already exists</p>",
        "id": 315531776,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1670919005
    },
    {
        "content": "<p>I was just about to push a fix to download-release which uses the github API to get the releases and takes the last one, but this is yielding <code>nightly-2022-12-13-01</code> so it sounds like it is not correct</p>",
        "id": 315531885,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1670919076
    },
    {
        "content": "<p><code>predata-nightly-2022-12-13-01</code> is the most recent one of those</p>",
        "id": 315532139,
        "sender_full_name": "Reid Barton",
        "timestamp": 1670919204
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"461830\">@Rémi Bottinelli</span> Just checking, you're not doing this for the mathlib port, are you?  If you want to port a mathlib file, the mathport output is already available at <br>\n<a href=\"https://github.com/leanprover-community/mathlib3port/tree/master/Mathbin\">https://github.com/leanprover-community/mathlib3port/tree/master/Mathbin</a></p>",
        "id": 315532707,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1670919478
    },
    {
        "content": "<p>I want to port a PR that I made and that got in conflict with some port first.<br>\nBut then, that's good info: If I want to port an existing file (in master), I can just start with your link (?)</p>",
        "id": 315532890,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670919547
    },
    {
        "content": "<p>ok it's now getting <code>nightly-2022-12-13-04</code> via</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">curl</span> <span class=\"bp\">-</span><span class=\"n\">H</span> <span class=\"s2\">\"Accept: application/vnd.github+json\"</span> <span class=\"bp\">-</span><span class=\"n\">H</span> <span class=\"s2\">\"X-GitHub-Api-Version: 2022-11-28\"</span> <span class=\"bp\">\\</span>\n  <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">api.github.com</span><span class=\"bp\">/</span><span class=\"n\">repos</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">/</span><span class=\"n\">releases</span> <span class=\"bp\">\\</span>\n<span class=\"bp\">|</span> <span class=\"n\">jq</span> <span class=\"bp\">'</span><span class=\"n\">last</span><span class=\"o\">([</span><span class=\"bp\">.</span><span class=\"o\">[]</span><span class=\"bp\">.</span><span class=\"n\">tag_name</span> <span class=\"bp\">|</span> <span class=\"n\">select</span><span class=\"o\">(</span><span class=\"n\">startswith</span><span class=\"o\">(</span><span class=\"s2\">\"nightly-\"</span><span class=\"o\">))]</span> <span class=\"bp\">|</span> <span class=\"n\">sort</span> <span class=\"bp\">|</span> <span class=\"bp\">.</span><span class=\"o\">[])</span><span class=\"bp\">'</span> <span class=\"bp\">-</span><span class=\"n\">r</span>\n</code></pre></div>",
        "id": 315533047,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1670919607
    },
    {
        "content": "<p>So I can update my recap with just <code>./download_release</code> ?</p>",
        "id": 315534640,
        "sender_full_name": "Rémi Bottinelli",
        "timestamp": 1670920241
    },
    {
        "content": "<p>yes</p>",
        "id": 315536379,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1670920856
    },
    {
        "content": "<p>Can we add some instructions on how to use oneshot on the porting wiki, <a href=\"https://github.com/leanprover-community/mathlib4/wiki/Porting-wiki\">https://github.com/leanprover-community/mathlib4/wiki/Porting-wiki</a>?</p>",
        "id": 318848895,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1672574671
    },
    {
        "content": "<p>In particular, it would be great if there were a streamlined process for \"get the mathport output for a mathlib3 PR\"</p>",
        "id": 318849302,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1672574859
    },
    {
        "content": "<p>Note that I tried to improve the documentation of oneshot in <a href=\"https://github.com/leanprover-community/mathport/pull/213\">https://github.com/leanprover-community/mathport/pull/213</a> but that PR is somehow stuck because I don't understand Mario's suggestion.</p>",
        "id": 318849549,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1672574965
    },
    {
        "content": "<p>I just pushed a fix that I think addressed Mario's comment; your list was <code>1, 2, 3, 5, 6, 7, 8</code> with no 4.</p>",
        "id": 318849936,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1672575150
    },
    {
        "content": "<p>I understood the numbering thing (although I think it would have rendered correctly). But my impression was that Mario also meant something else.</p>",
        "id": 318853720,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1672577191
    },
    {
        "content": "<p>no, that's what I meant</p>",
        "id": 318906760,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1672607955
    },
    {
        "content": "<p>Failure of the day:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>mkdir -p Logs/\n./build/bin/mathport config.oneshot.json Oneshot::main &gt;&gt; Logs/oneshot.out 2&gt; &gt;(tee -a Logs/oneshot.err &gt;&amp;2)\nporting Main\nuncaught exception: failed to port Oneshot:Main with imports [Leanbin.Init.Default, Oneshot]:\nimport Leanbin.Init.Data.Nat.Lemmas failed, environment already contains 'Nat.findX' from Mathlib.Init.Data.Nat.Lemmas\nmake: *** [Makefile:134: Outputs/src/oneshot/Oneshot/Main.lean] Error 1\n</code></pre></div>",
        "id": 319234665,
        "sender_full_name": "Reid Barton",
        "timestamp": 1672764152
    },
    {
        "content": "<p>Any idea about this?</p>",
        "id": 319234755,
        "sender_full_name": "Reid Barton",
        "timestamp": 1672764176
    },
    {
        "content": "<p>My first guess is mismatched Lean/std4/etc. versions.  You need to have the same mathport commit (which fixes the dependencies) as the release.</p>",
        "id": 319256207,
        "sender_full_name": "Gabriel Ebner",
        "timestamp": 1672770865
    },
    {
        "content": "<p>omg it worked!</p>",
        "id": 319678206,
        "sender_full_name": "Reid Barton",
        "timestamp": 1672955172
    },
    {
        "content": "<p>It would be nice if it took less than 45 minutes to get a working setup</p>",
        "id": 319678234,
        "sender_full_name": "Reid Barton",
        "timestamp": 1672955182
    },
    {
        "content": "<p>... I wasn't supposed to <code>rm -rf Outputs/</code>, was I.</p>",
        "id": 319678973,
        "sender_full_name": "Reid Barton",
        "timestamp": 1672955471
    },
    {
        "content": "<p>Has anyone seen the following oneshot error before?  This is my first time trying it.</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>% make oneshot\ncd Oneshot/lean3-in &amp;&amp; elan override set `cat ../../sources/mathlib/leanpkg.toml | grep lean_version | cut -d '\"' -f2`\ncat: ../../sources/mathlib/leanpkg.toml: No such file or directory\nerror: The following required arguments were not provided:\n    &lt;toolchain&gt;\n\nUSAGE:\n    elan override set &lt;toolchain&gt;\n\nFor more information try --help\n</code></pre></div>",
        "id": 320022009,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1673139367
    },
    {
        "content": "<p>That message suggests that <code>sources/mathlib</code> doesn't exist or doesn't have a <code>leanpkg.toml</code> file</p>",
        "id": 320022525,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1673139813
    },
    {
        "content": "<p>you have to run <code>./download-release.sh</code> to get a download of mathlib3 first</p>",
        "id": 320022604,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1673139864
    },
    {
        "content": "<p>It would be great if we could setup a gitpod or something that had everything setup in a way that Just Works; but maybe there's too much configuration for that to make sense</p>",
        "id": 320022648,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1673139913
    },
    {
        "content": "<p>oh, that would be nice</p>",
        "id": 320022674,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1673139937
    },
    {
        "content": "<p>there is a lot of downloading but not a lot of (mandatory) configuration</p>",
        "id": 320022698,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1673139952
    },
    {
        "content": "<p>I don't know whether that belongs in <a href=\"https://github.com/leanprover-community/mathlib4/pull/1419\">the gitpod config for mathlib4</a>, or maybe in the mathport repo instead</p>",
        "id": 320022777,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1673140013
    },
    {
        "content": "<p>I would put it in the mathport repo</p>",
        "id": 320022812,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1673140031
    },
    {
        "content": "<p>It's possible to set up gitpod to open multiple repos in single workspace, if that's at all useful</p>",
        "id": 320022838,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1673140056
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span> Did you follow the directions at <a href=\"https://github.com/leanprover-community/mathport/tree/master/Oneshot\">https://github.com/leanprover-community/mathport/tree/master/Oneshot</a> ? We may need to make adjustments if the directions don't work</p>",
        "id": 320022844,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1673140064
    },
    {
        "content": "<p>I did follow the directions.  And this is correct:</p>\n<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Mathport.20oneshot/near/320022525\">said</a>:</p>\n<blockquote>\n<p>That message suggests that <code>sources/mathlib</code> doesn't exist or doesn't have a <code>leanpkg.toml</code> file</p>\n</blockquote>",
        "id": 320023410,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1673140557
    },
    {
        "content": "<p>Earlier I had got this:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>% ./download-release.sh\n./download-release.sh: line 11: jq: command not found\n</code></pre></div>",
        "id": 320023469,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1673140589
    },
    {
        "content": "<p>But later I tried this and it seemed to work:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>% ./download-release.sh nightly-2022-12-13-04\ngetting release nightly-2022-12-13-04\n+ ./download-ported.sh nightly-2022-12-13-04\n+ mkdir -p Outputs/oleans/leanbin/\n+ pushd Outputs/oleans/leanbin/\n[... tons more stuff ...]\n</code></pre></div>",
        "id": 320023491,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1673140625
    },
    {
        "content": "<p>aha, you don't have <code>jq</code></p>",
        "id": 320023673,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1673140775
    },
    {
        "content": "<p>are you on a debian such that you can follow the <code>sudo apt ...</code> install instructions?</p>",
        "id": 320023702,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1673140801
    },
    {
        "content": "<p>mac</p>",
        "id": 320023751,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1673140807
    },
    {
        "content": "<p>hm, we need something similar for macs</p>",
        "id": 320023768,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1673140821
    },
    {
        "content": "<p><code>brew install jq</code>?</p>",
        "id": 320023793,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1673140851
    },
    {
        "content": "<p>even if you can get the release by specifying it directly, <code>jq</code> is used later in the oneshot script so you will probably want to get it</p>",
        "id": 320023828,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1673140888
    },
    {
        "content": "<p>OK, <code>./download_release.sh</code> seems to be doing something now.  Thanks!</p>",
        "id": 320024028,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1673141051
    },
    {
        "content": "<p>Can <span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> or someone with experience record how to use oneshot for files with dependencies?  Which folder do I put the dependencies in, and what path do I use to refer to them in the <code>import foo</code> line?</p>",
        "id": 324218593,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1674875302
    },
    {
        "content": "<p>you put the lean 3 files in the <code>lean3-in</code> directory, you can refer to them like top level files</p>",
        "id": 324218667,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1674875372
    },
    {
        "content": "<p>so <code>lean3-in/foo.lean</code> is referred to in <code>lean3-in/main.lean</code> as <code>import foo</code></p>",
        "id": 324218759,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1674875419
    },
    {
        "content": "<p>(delete message about my own mistake, see next message)</p>",
        "id": 324218966,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1674875552
    },
    {
        "content": "<p>(delete message about my own mistake, see next message)</p>",
        "id": 324219820,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1674876189
    },
    {
        "content": "<p>Oh <span aria-label=\"woman facepalming\" class=\"emoji emoji-1f926-200d-2640\" role=\"img\" title=\"woman facepalming\">:woman_facepalming:</span> My oneshot version of mathlib3 is different from the mathlib3 version of the files I was trying to port, and <code>algebra/order/ring</code> no longer exists.</p>",
        "id": 324220066,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1674876387
    },
    {
        "content": "<p>After some noise about self-inflicted errors, I do still have problems.  Mathport gives me errors like</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>/Users/heathermacbeth/lean4/mathport/Oneshot/lean3-in/main.lean:1:0: error: file 'arithmetic' not found in the search path\nUse 'lean --path' to see where lean is looking, or https://leanprover-community.github.io/file-not-found.html for more\n</code></pre></div>\n<p>where here <code>arithmetic</code> is my <code>foo</code>, located at <code>lean3-in/arithmetic.lean</code>.</p>",
        "id": 324220501,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1674876772
    },
    {
        "content": "<p>The <code>lean3-in/main.lean</code> file starts</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"c\">/-</span><span class=\"cm\"> Copyright (c) Heather Macbeth, 2022.  All rights reserved. -/</span>\n\n<span class=\"kn\">import</span> <span class=\"n\">arithmetic</span>\n</code></pre></div>",
        "id": 324220568,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1674876835
    },
    {
        "content": "<p>Do I need to add <code>lean3-in</code> itself to the path?  Currently when I run <code>lean --path</code> from within the <code>lean3-in</code> directory I get the following output:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>{\n  \"is_user_leanpkg_path\": false,\n  \"leanpkg_path_file\": \"/Users/heathermacbeth/lean4/mathport/Oneshot/lean3-in/leanpkg.path\",\n  \"path\": [\n    \"/Users/heathermacbeth/.elan/toolchains/leanprover-community--lean---3.50.3/bin/../library\",\n    \"/Users/heathermacbeth/.elan/toolchains/leanprover-community--lean---3.50.3/bin/../lib/lean/library\",\n    \"/Users/heathermacbeth/lean4/mathport/Oneshot/lean3-in/../../sources/mathlib/src\"\n  ]\n}\n</code></pre></div>",
        "id": 324220879,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1674877098
    },
    {
        "content": "<p>I think you need to add <code>path .</code> to the <code>leanpkg.path</code> file</p>",
        "id": 324221043,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1674877245
    },
    {
        "content": "<p>That works!  Thank you!</p>",
        "id": 324221178,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1674877389
    },
    {
        "content": "<p>Is there a way to make <code>lake exe cache get</code> work with one-shot?</p>",
        "id": 341786120,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1678798898
    },
    {
        "content": "<p>Right now I seem to have to build the whole thing from scratch, including mathlib4</p>",
        "id": 341786190,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1678798909
    },
    {
        "content": "<p>AFAIK you should be able to use <code>lake exe cache get</code> in the mathport root, it has a normal dependency on mathlib4 so if you do that and then <code>lake build</code> it should not rebuild mathlib</p>",
        "id": 342527829,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1679050862
    },
    {
        "content": "<p>This doesn't seem to work</p>",
        "id": 344086386,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1679600707
    },
    {
        "content": "<p>At least, it starts building a bunch of Std4 and Aesop (edit: then moves on to mathport)</p>",
        "id": 344086447,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1679600726
    },
    {
        "content": "<p>Repro: </p>\n<ul>\n<li>open in gitpod (<a href=\"http://gitpod.io/#https://github.com/leanprover-community/mathport\">http://gitpod.io/#https://github.com/leanprover-community/mathport</a>)</li>\n<li>run <code>lake exe cache get</code></li>\n<li>run <code>make build</code></li>\n</ul>",
        "id": 344086493,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1679600745
    },
    {
        "content": "<p>Is it something like mathport using a different version of std4 to what mathlib4 uses?</p>",
        "id": 344088128,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1679601210
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110043\">Gabriel Ebner</span> <a href=\"#narrow/stream/270676-lean4/topic/.60lake.20exe.20cache.20get.60.20in.20projects.20depending.20on.20mathlib/near/345255409\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>it seems to rebuild mathlib4 from scratch</p>\n</blockquote>\n<p><code>Compiling</code> != <code>Building</code></p>\n</blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110043\">Gabriel Ebner</span> <a href=\"#narrow/stream/270676-lean4/topic/.60lake.20exe.20cache.20get.60.20in.20projects.20depending.20on.20mathlib/near/345255457\">said</a>:</p>\n<blockquote>\n<p>It will indeed Compile mathlib, but not Build it.  This is expected.</p>\n</blockquote>\n<p>resolves my confusion above</p>",
        "id": 345257484,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1680044350
    },
    {
        "content": "<p>My next issue is that <code>make oneshot</code> appears to build ast and tlean files for all the mathlib files consumed by the <code>oneshot/lean-3/main.lean</code></p>",
        "id": 345257564,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1680044392
    },
    {
        "content": "<p>I did run <code>./download-release.sh</code> beforehand, as in the readme; did this get a release that didn't match the mathlib3 source?</p>",
        "id": 345257737,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1680044446
    },
    {
        "content": "<p>Thought I'd have a go with oneshot again, as I'm porting 8 files manually. Following the instructions <a href=\"https://github.com/leanprover-community/mathport/blob/master/Oneshot/README.md\">here</a>. Step 5 fails for me on Ubuntu 20.04:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">~/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">projects</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">$</span> <span class=\"n\">make</span> <span class=\"n\">lean3</span><span class=\"bp\">-</span><span class=\"n\">source</span>\n<span class=\"n\">mkdir</span> <span class=\"bp\">-</span><span class=\"n\">p</span> <span class=\"n\">sources</span>\n<span class=\"k\">if</span> <span class=\"o\">[</span> <span class=\"bp\">!</span> <span class=\"bp\">-</span><span class=\"n\">d</span> <span class=\"s2\">\"sources/mathlib/.git\"</span> <span class=\"o\">]</span><span class=\"bp\">;</span> <span class=\"k\">then</span> <span class=\"bp\">\\</span>\n    <span class=\"n\">cd</span> <span class=\"n\">sources</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">git</span> <span class=\"n\">clone</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib.git</span><span class=\"bp\">;</span> <span class=\"bp\">\\</span>\n<span class=\"n\">fi</span>\n<span class=\"n\">cd</span> <span class=\"n\">sources</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">git</span> <span class=\"n\">clean</span> <span class=\"bp\">-</span><span class=\"n\">xfd</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">git</span> <span class=\"n\">fetch</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">git</span> <span class=\"n\">checkout</span> <span class=\"n\">origin</span><span class=\"bp\">/</span><span class=\"n\">master</span>\n<span class=\"n\">Removing</span> <span class=\"n\">leanpkg.path</span>\n<span class=\"n\">Removing</span> <span class=\"n\">src</span><span class=\"bp\">/</span><span class=\"n\">all.lean</span>\n<span class=\"n\">HEAD</span> <span class=\"n\">is</span> <span class=\"n\">now</span> <span class=\"n\">at</span> <span class=\"mi\">0</span><span class=\"n\">ce07501eb</span> <span class=\"n\">chore</span><span class=\"o\">(</span><span class=\"n\">linear_algebra</span><span class=\"bp\">/</span><span class=\"n\">finite_dimensional</span><span class=\"o\">):</span> <span class=\"n\">generalize</span> <span class=\"k\">from</span> <span class=\"kt\">Type</span> <span class=\"n\">to</span> <span class=\"kt\">Sort</span> <span class=\"o\">(</span><span class=\"bp\">#</span><span class=\"mi\">18723</span><span class=\"o\">)</span>\n<span class=\"n\">cd</span> <span class=\"n\">sources</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">echo</span> <span class=\"bp\">-</span><span class=\"n\">n</span> <span class=\"bp\">'</span><span class=\"n\">mathlib</span> <span class=\"n\">commit</span><span class=\"o\">:</span> <span class=\"bp\">'</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">git</span> <span class=\"n\">rev</span><span class=\"bp\">-</span><span class=\"n\">parse</span> <span class=\"n\">HEAD</span>\n<span class=\"n\">mathlib</span> <span class=\"n\">commit</span><span class=\"o\">:</span> <span class=\"mi\">0</span><span class=\"n\">ce07501ebb0dee26dde9f0805380cf68975dd24</span>\n<span class=\"n\">cd</span> <span class=\"n\">sources</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">leanpkg</span> <span class=\"n\">configure</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"bp\">./</span><span class=\"n\">scripts</span><span class=\"bp\">/</span><span class=\"n\">mk_all.sh</span>\n<span class=\"n\">configuring</span> <span class=\"n\">mathlib</span> <span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">1</span>\n<span class=\"n\">mkdir</span> <span class=\"bp\">-</span><span class=\"n\">p</span> <span class=\"n\">sources</span>\n<span class=\"k\">if</span> <span class=\"o\">[</span> <span class=\"bp\">!</span> <span class=\"bp\">-</span><span class=\"n\">d</span> <span class=\"s2\">\"sources/lean/.git\"</span> <span class=\"o\">]</span><span class=\"bp\">;</span> <span class=\"k\">then</span> <span class=\"bp\">\\</span>\n    <span class=\"n\">cd</span> <span class=\"n\">sources</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">git</span> <span class=\"n\">clone</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean.git</span><span class=\"bp\">;</span> <span class=\"bp\">\\</span>\n<span class=\"n\">fi</span>\n<span class=\"n\">cd</span> <span class=\"n\">sources</span><span class=\"bp\">/</span><span class=\"n\">lean</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">git</span> <span class=\"n\">clean</span> <span class=\"bp\">-</span><span class=\"n\">xfd</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">git</span> <span class=\"n\">checkout</span> <span class=\"bp\">`</span><span class=\"n\">cd</span> <span class=\"bp\">../</span><span class=\"n\">mathlib</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">lean</span> <span class=\"c1\">--version | sed -e \"s/.*commit \\([0-9a-f]*\\).*/\\1/\"`</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">pathspec</span> <span class=\"bp\">'</span><span class=\"mi\">855</span><span class=\"n\">e5b74e3a5'</span> <span class=\"n\">did</span> <span class=\"n\">not</span> <span class=\"k\">match</span> <span class=\"n\">any</span> <span class=\"n\">file</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span> <span class=\"n\">known</span> <span class=\"n\">to</span> <span class=\"n\">git</span>\n<span class=\"n\">make</span><span class=\"o\">:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">Makefile</span><span class=\"o\">:</span><span class=\"mi\">59</span><span class=\"o\">:</span> <span class=\"n\">lean3</span><span class=\"bp\">-</span><span class=\"n\">source</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">1</span>\n</code></pre></div>\n<p>Any advice? Thanks.</p>",
        "id": 346840553,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1680612723
    },
    {
        "content": "<p>What's in <code>sources/lean</code>?</p>",
        "id": 346841568,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1680612961
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathport/pull/231\">mathport#231</a> makes the error clearer</p>",
        "id": 346841665,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1680612971
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Mathport.20oneshot/near/346841568\">said</a>:</p>\n<blockquote>\n<p>What's in <code>sources/lean</code>?</p>\n</blockquote>\n<p>A copy of lean 3.</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">$</span> <span class=\"n\">git</span> <span class=\"n\">status</span>\n<span class=\"n\">HEAD</span> <span class=\"n\">detached</span> <span class=\"n\">at</span> <span class=\"mi\">53</span><span class=\"n\">e8520d8</span>\n<span class=\"n\">nothing</span> <span class=\"n\">to</span> <span class=\"n\">commit</span><span class=\"o\">,</span> <span class=\"n\">working</span> <span class=\"n\">tree</span> <span class=\"n\">clean</span>\n</code></pre></div>",
        "id": 346842588,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1680613177
    },
    {
        "content": "<p>It's trying to get <a href=\"https://github.com/leanprover-community/lean/commits/855e5b74e3a5\">https://github.com/leanprover-community/lean/commits/855e5b74e3a5</a>, you seem to have <a href=\"https://github.com/leanprover-community/lean/commits/53e8520d8\">https://github.com/leanprover-community/lean/commits/53e8520d8</a></p>",
        "id": 346843085,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1680613279
    },
    {
        "content": "<p>I would guess you created this mathport checkout a while ago?</p>",
        "id": 346843187,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1680613302
    },
    {
        "content": "<p>If so, just run <code>git fetch</code> in the <code>sources/lean</code> directory</p>",
        "id": 346843233,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1680613313
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Mathport.20oneshot/near/346843187\">said</a>:</p>\n<blockquote>\n<p>I would guess you created this mathport checkout a while ago?</p>\n</blockquote>\n<p>I originally cloned it months ago but I ran <code>git pull</code> in the mathport directory an hour or two ago. Did I underpull?</p>",
        "id": 346846662,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1680613989
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Mathport.20oneshot/near/346843233\">said</a>:</p>\n<blockquote>\n<p>If so, just run <code>git fetch</code> in the <code>sources/lean</code> directory</p>\n</blockquote>\n<p>This fixed it -- thanks!</p>",
        "id": 346846752,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1680614014
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathport/pull/232\">#232</a> should fix this issue</p>",
        "id": 346847050,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1680614084
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathport/pull/233\">https://github.com/leanprover-community/mathport/pull/233</a> for a typo</p>",
        "id": 346847591,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1680614218
    },
    {
        "content": "<p>I tried mathport oneshot for the first time today. I managed to get it to work, but maybe the instructions needs some updating:</p>\n<ul>\n<li><code>sudo apt install gmp</code> fails on Ubuntu 22.04 (I installed <code>libgmp-dev</code>)</li>\n<li>I ended up with an empty file <code>config.oneshot.json</code> somehow (maybe because I killed the build process to run <code>lake exe cache get</code> and then restarted the build)</li>\n<li>Add the instruction to run <code>lake exe cache get</code></li>\n<li><del>Add the instruction to run <code>make lean3-predata</code> (before that I got the error \"uncaught exception: [resolveMod3] failed to resolve 'init'\")</del> [This was probably me doing something wrong, after removing the whole directory and restarting this was not a problem]</li>\n</ul>",
        "id": 355196903,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1683043188
    },
    {
        "content": "<p>Is the <code>./download-release.sh</code> supposed to download the Lean 3 mathlib cache? If not, that should also be a step added to the instructions. If I don't do it, the oneshot is compiling all of mathlib3 for me. (Doing <code>cd sources/mathlib &amp;&amp; leanproject get-cache &amp;&amp; cd ../..</code> seems to fix this - but I got some other trouble that might be caused by this)</p>",
        "id": 355208593,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1683045931
    },
    {
        "content": "<p><code>oneshot</code> seems to recompile all of mathlib for <code>ast</code> purposes... but I don't see why this is, if everything else is as advertised then <code>oneshot</code> should have the <code>ast</code> for all of <code>mathlib</code> already, and it just needs the new file, no?</p>",
        "id": 360543701,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1684850940
    },
    {
        "content": "<p>I made this mistake myself; <a href=\"#narrow/stream/287929-mathlib4/topic/Mathport.20oneshot/near/345257484\">it's re *compile* ing mathlib, but not re-building it.</a></p>",
        "id": 360544099,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1684851023
    },
    {
        "content": "<p>if it takes as long as it's seeming to take it's still a long time</p>",
        "id": 360544255,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1684851056
    },
    {
        "content": "<p>Yeah, for reference, this gitpod instance doesn't super work - you need to keep doing \"something\" on it every hour, else it stops due to inactivity</p>",
        "id": 360562113,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1684854611
    },
    {
        "content": "<p>Presumably because it's taking &gt;1hr to do the compilation, which is... a lot for oneshot</p>",
        "id": 360562246,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1684854637
    },
    {
        "content": "<p>I guess last time I ran it, mathlib4 was half the size...</p>",
        "id": 360562376,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1684854665
    },
    {
        "content": "<p>it does not take 1hr to do the compilation. <span class=\"user-mention\" data-user-id=\"110087\">@Scott Morrison</span> and I did this recently and it was closer to 3-5min although I didn't time it</p>",
        "id": 360596300,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1684862782
    },
    {
        "content": "<p>maybe I missed some details because all I did was leave the gitpod window open on one corner</p>",
        "id": 360601126,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1684864099
    },
    {
        "content": "<p>I tried to follow the instructions as verbatim as possible</p>",
        "id": 360601167,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1684864112
    },
    {
        "content": "<p>note that the instructions are somewhat incorrect / out of date. Scott and I went through the mathport flow last week and he took some notes that I hope will make it into the docs</p>",
        "id": 360601628,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1684864233
    },
    {
        "content": "<p>I mean, if you follow the mathport instructions exactly it will still work, eventually, but there are a few missing commands which cause it to rebuild both mathlib3 and mathlib4 from scratch if you just follow the instructions</p>",
        "id": 360602112,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1684864357
    },
    {
        "content": "<p>I've written up the instructions and they are now in the README on the <code>projects_instructions</code> branch of mathport. I'm currently getting some people to exercise the instructions for me here!</p>",
        "id": 360653350,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1684882759
    },
    {
        "content": "<p>Not sure if anyone has pointed this out, but the build instructions here <a href=\"https://github.com/leanprover-community/mathport/blob/master/Oneshot/README.md\">https://github.com/leanprover-community/mathport/blob/master/Oneshot/README.md</a> don't work using the cl C++ compiler (the visual studio one). Somewhere in the make file the c++ compiler is run with -fPIC, which is supported by clang and g++ but not this one. Might be good to add a caveat about this?</p>",
        "id": 363383798,
        "sender_full_name": "Brendan Seamas Murphy",
        "timestamp": 1685827506
    },
    {
        "content": "<p>I'm trying to run it using clang now but it's defaulting to the wrong target (one where fPIC is not available). Is there a way to get <code>lake build</code> to pass a flag (target) to whatever c compiler it's using to compile FFI.c?</p>",
        "id": 363390865,
        "sender_full_name": "Brendan Seamas Murphy",
        "timestamp": 1685831792
    },
    {
        "content": "<p>???</p>",
        "id": 363391122,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1685831977
    },
    {
        "content": "<p>at no point in the mathport build process should you be dealing with C++ compiler choices</p>",
        "id": 363391138,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1685831997
    },
    {
        "content": "<p>the makefile only runs lean and lean tools (and grep, sed etc)</p>",
        "id": 363391249,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1685832047
    },
    {
        "content": "<p>There is no FFI.c file in mathport, I think there might be one in aesop</p>",
        "id": 363391312,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1685832110
    },
    {
        "content": "<p>but if you are having such problems presumably they also come up when compiling mathlib4</p>",
        "id": 363391412,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1685832156
    },
    {
        "content": "<p>I also have a problem with <code>oneshot</code>, at the <code>make lean3-source</code> step: It says</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">mkdir</span> <span class=\"bp\">-</span><span class=\"n\">p</span> <span class=\"n\">sources</span>\n<span class=\"k\">if</span> <span class=\"o\">[</span> <span class=\"bp\">!</span> <span class=\"bp\">-</span><span class=\"n\">d</span> <span class=\"s2\">\"sources/mathlib/.git\"</span> <span class=\"o\">]</span><span class=\"bp\">;</span> <span class=\"k\">then</span> <span class=\"bp\">\\</span>\n    <span class=\"n\">cd</span> <span class=\"n\">sources</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">git</span> <span class=\"n\">clone</span> <span class=\"c1\">--depth 1 https://github.com/leanprover-community/mathlib.git; \\</span>\n<span class=\"n\">fi</span>\n<span class=\"n\">cd</span> <span class=\"n\">sources</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">git</span> <span class=\"n\">clean</span> <span class=\"bp\">-</span><span class=\"n\">xfd</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">git</span> <span class=\"n\">fetch</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">git</span> <span class=\"n\">checkout</span> <span class=\"s2\">\"origin/master\"</span> <span class=\"c1\">--</span>\n<span class=\"n\">Removing</span> <span class=\"n\">archive</span><span class=\"bp\">/</span><span class=\"n\">all.lean</span>\n<span class=\"n\">Removing</span> <span class=\"n\">leanpkg.path</span>\n<span class=\"n\">Removing</span> <span class=\"n\">src</span><span class=\"bp\">/</span><span class=\"n\">all.lean</span>\n<span class=\"n\">HEAD</span> <span class=\"n\">is</span> <span class=\"n\">now</span> <span class=\"n\">at</span> <span class=\"mi\">5</span><span class=\"n\">c1efce</span> <span class=\"n\">chore</span><span class=\"o\">(</span><span class=\"bp\">*</span><span class=\"o\">):</span> <span class=\"n\">add</span> <span class=\"n\">mathlib4</span> <span class=\"n\">synchronization</span> <span class=\"n\">comments</span> <span class=\"o\">(</span><span class=\"bp\">#</span><span class=\"mi\">19151</span><span class=\"o\">)</span>\n<span class=\"n\">cd</span> <span class=\"n\">sources</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">echo</span> <span class=\"bp\">-</span><span class=\"n\">n</span> <span class=\"bp\">'</span><span class=\"n\">mathlib</span> <span class=\"n\">commit</span><span class=\"o\">:</span> <span class=\"bp\">'</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">git</span> <span class=\"n\">rev</span><span class=\"bp\">-</span><span class=\"n\">parse</span> <span class=\"n\">HEAD</span>\n<span class=\"n\">mathlib</span> <span class=\"n\">commit</span><span class=\"o\">:</span> <span class=\"mi\">5</span><span class=\"n\">c1efce12ba86d4901463f61019832f6a4b1a0d0</span>\n<span class=\"n\">cd</span> <span class=\"n\">sources</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">leanpkg</span> <span class=\"n\">configure</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"bp\">./</span><span class=\"n\">scripts</span><span class=\"bp\">/</span><span class=\"n\">mk_all.sh</span>\n<span class=\"n\">configuring</span> <span class=\"n\">mathlib</span> <span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">1</span>\n<span class=\"n\">cd</span> <span class=\"n\">sources</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">archive</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">git</span> <span class=\"n\">ls</span><span class=\"bp\">-</span><span class=\"n\">files</span> <span class=\"bp\">\\</span>\n    <span class=\"bp\">|</span> <span class=\"n\">sed</span> <span class=\"bp\">-</span><span class=\"n\">n</span> <span class=\"bp\">'/\\.</span><span class=\"n\">lean</span><span class=\"bp\">/</span> <span class=\"o\">{</span> <span class=\"n\">s</span><span class=\"bp\">=\\.</span><span class=\"n\">lean</span><span class=\"bp\">=</span> <span class=\"bp\">;</span> <span class=\"n\">s</span><span class=\"bp\">=/=».«=</span><span class=\"n\">g</span><span class=\"bp\">;</span> <span class=\"n\">s</span><span class=\"bp\">=^=</span><span class=\"kn\">import</span> <span class=\"bp\">«=</span> <span class=\"bp\">;</span> <span class=\"n\">s</span><span class=\"bp\">=»=</span> <span class=\"bp\">;</span> <span class=\"n\">p</span> <span class=\"o\">}</span><span class=\"bp\">'</span> <span class=\"bp\">&gt;</span> <span class=\"n\">all.lean</span>\n<span class=\"n\">sed</span><span class=\"o\">:</span> <span class=\"bp\">-</span><span class=\"n\">e</span> <span class=\"n\">expression</span> <span class=\"bp\">#</span><span class=\"mi\">1</span><span class=\"o\">,</span> <span class=\"n\">char</span> <span class=\"mi\">26</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">option</span> <span class=\"n\">to</span> <span class=\"bp\">`</span><span class=\"n\">s'</span>\n<span class=\"n\">make</span><span class=\"o\">:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">Makefile</span><span class=\"o\">:</span><span class=\"mi\">49</span><span class=\"o\">:</span> <span class=\"n\">mathbin</span><span class=\"bp\">-</span><span class=\"n\">source</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">1</span>\n</code></pre></div>",
        "id": 363460814,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1685872965
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span>, hmm, that is working for me. Are you possibly running on macos with the standard <code>sed</code>? That is a common problem.</p>",
        "id": 363463326,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1685873790
    },
    {
        "content": "<p>I am on Debian</p>",
        "id": 363463372,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1685873807
    },
    {
        "content": "<p>How old is your sed?</p>",
        "id": 363463542,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1685873854
    },
    {
        "content": "<p>It is version 4.9</p>",
        "id": 363464712,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1685874206
    },
    {
        "content": "<p>Same for me, interesting.</p>",
        "id": 363474954,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1685877560
    },
    {
        "content": "<p><del>Could the shell be relevant here?</del> edit: no</p>",
        "id": 363475673,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1685877809
    },
    {
        "content": "<p>I was also having that bug, it should be fixed on master</p>",
        "id": 363500741,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1685885794
    },
    {
        "content": "<p>note the line that says <code>s=\\.lean= ;</code> - in the makefile it was <code>s=\\.lean$== ;</code> but the <code>$=</code> was being treated as a variable reference and it should now be <code>$$=</code> to escape it</p>",
        "id": 363500893,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1685885848
    },
    {
        "content": "<p>Okay, I tried switching to use clang on windows subsystem for linux, but I'm still getting an error when it runs lake build. the error is at \"[1940/1940] Linking mathport\" and comes from calling leanc at some point. Here's the end snippet of the error</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">stderr</span><span class=\"o\">:</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Mathport</span><span class=\"bp\">/</span><span class=\"n\">Rename.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Init</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">Nat</span><span class=\"bp\">/</span><span class=\"n\">Notation.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Util</span><span class=\"bp\">/</span><span class=\"n\">ExtendedBinder.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Classes</span><span class=\"bp\">/</span><span class=\"n\">SetNotation.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">OpenPrivate.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">NoMatch.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">Option</span><span class=\"bp\">/</span><span class=\"n\">Init</span><span class=\"bp\">/</span><span class=\"n\">Lemmas.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">HaveI.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">Unreachable.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Linter</span><span class=\"bp\">/</span><span class=\"n\">UnreachableTactic.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Lean</span><span class=\"bp\">/</span><span class=\"n\">TagAttribute.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Lean</span><span class=\"bp\">/</span><span class=\"n\">AttributeExtra.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Linter</span><span class=\"bp\">/</span><span class=\"n\">UnnecessarySeqFocus.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Linter.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Util</span><span class=\"bp\">/</span><span class=\"n\">TermUnsafe.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">GuardExpr.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">ByCases.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">SeqFocus.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Lean</span><span class=\"bp\">/</span><span class=\"n\">Name.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Std</span><span class=\"bp\">/</span><span class=\"n\">Lean</span><span class=\"bp\">/</span><span class=\"n\">Format.o</span><span class=\"o\">:</span> <span class=\"n\">unknown</span> <span class=\"n\">file</span> <span class=\"n\">type</span>\n<span class=\"n\">ld.lld</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">too</span> <span class=\"n\">many</span> <span class=\"n\">errors</span> <span class=\"n\">emitted</span><span class=\"o\">,</span> <span class=\"n\">stopping</span> <span class=\"n\">now</span> <span class=\"o\">(</span><span class=\"n\">use</span> <span class=\"c1\">--error-limit=0 to see all errors)</span>\n<span class=\"n\">clang</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">linker</span> <span class=\"n\">command</span> <span class=\"n\">failed</span> <span class=\"k\">with</span> <span class=\"n\">exit</span> <span class=\"n\">code</span> <span class=\"mi\">1</span> <span class=\"o\">(</span><span class=\"n\">use</span> <span class=\"bp\">-</span><span class=\"n\">v</span> <span class=\"n\">to</span> <span class=\"n\">see</span> <span class=\"n\">invocation</span><span class=\"o\">)</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">external</span> <span class=\"n\">command</span> <span class=\"bp\">`/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">brendan</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly-2023-05-31/bin/leanc` exited with code 1</span>\n</code></pre></div>",
        "id": 363575316,
        "sender_full_name": "Brendan Seamas Murphy",
        "timestamp": 1685916289
    },
    {
        "content": "<p>okay, got it to build! had to install clang within wsl instead of it somehow(?) using the windows level clang (which tried to build for windows). and then I had to use lake clean first before the fix worked</p>",
        "id": 363581759,
        "sender_full_name": "Brendan Seamas Murphy",
        "timestamp": 1685921081
    },
    {
        "content": "<p>possibly the README should just say \"don't build on windows\"</p>",
        "id": 363582027,
        "sender_full_name": "Brendan Seamas Murphy",
        "timestamp": 1685921323
    },
    {
        "content": "<p>the readme is basically \"unsupported, you are on your own\" for windows, but if you made it work maybe you should contribute some docs since no one else has</p>",
        "id": 363585123,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1685924192
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Mathport.20oneshot/near/363500741\">said</a>:</p>\n<blockquote>\n<p>I was also having that bug, it should be fixed on master</p>\n</blockquote>\n<p>Sorry for the late reply. It now works for me, thanks!</p>",
        "id": 363628891,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1685949421
    },
    {
        "content": "<p>(deleted) just noise</p>",
        "id": 364626396,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1686243468
    },
    {
        "content": "<p>You know what, let me try this from scratch. Maybe I had old artifacts of some sort from when I tried <code>oneshot</code> before. (EDIT: yes, apparently, working from scratch succeeded)</p>",
        "id": 364626858,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1686243573
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Mathport.20oneshot/near/363391312\">said</a>:</p>\n<blockquote>\n<p>There is no FFI.c file in mathport, I think there might be one in aesop</p>\n</blockquote>\n<p>Just FYI, there is an <code>FFI.c </code> file in mathport.  We use it to access the heartbeat counter in Lean.</p>",
        "id": 364697289,
        "sender_full_name": "Gabriel Ebner",
        "timestamp": 1686266798
    }
]