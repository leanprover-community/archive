[
    {
        "content": "<p>At the end of last week I decided to go on a semilinearizing spree:</p>\n<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/24170\">#24170</a> (ready for review) takes care of <code>LinearAlgebra.Finsupp.Defs</code> and <code>LinearAlgebra.Finsupp.LSum</code>, which means extending the universal property to semilinear maps. I will need this for the GNS constructions associated to kernels of positive type on topological spaces, and to functions of positive type on topological groups.</li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/24208\">#24208</a> (not ready yet) takes care of <code>LinearAlgebra.BilinearMap</code> and <code>LinearAlgebra.TensorProduct.Basic</code>. This one was really painful due to the length of that second file, and I still need to duplicate some constructions between linear and semilinear to make it convenient to use. This is crucially needed for tensor products of Hilbert spaces, the Stinespring and Kasparov-Stinespring constructions (which generalize GNS), and eventually tensor products of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>C</mi><mo>‚àó</mo></msup></mrow><annotation encoding=\"application/x-tex\">C^\\ast</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6887em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">‚àó</span></span></span></span></span></span></span></span></span></span></span>-algebras.</li>\n</ul>\n<p>I have two questions regarding this process:</p>\n<ul>\n<li>how much should I accept in terms of performance drop? On <a href=\"https://github.com/leanprover-community/mathlib4/pull/24170\">#24170</a>, <code>!bench</code> reports significant changes, but I'm not sure how to interpret them, nor what I should do about them. Surely I shouldn't have a linear version of everything just for the sake of performance?</li>\n<li>More generally, I'm not sure what the guidelines are regarding \"linear specialization\" of semilinear statements. In <a href=\"https://github.com/leanprover-community/mathlib4/pull/24170\">#24170</a> I went with duplicating only thing which would make an annoying <code>RingHom.id</code> in rewrites, and that seems to work fine. <a href=\"https://github.com/leanprover-community/mathlib4/pull/24208\">#24208</a> is more tricky, because a lot of lemma which currently take an explicit ring parameter should instead take a <code>RingHom</code>. My guess is I should duplicate them to avoid all the <code>(.id R)</code> arguments?</li>\n</ul>",
        "id": 513544245,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1745309209
    },
    {
        "content": "<p>Some random pings:</p>\n<p><span class=\"user-mention\" data-user-id=\"197836\">@Jireh Loreaux</span> <span class=\"user-mention\" data-user-id=\"311453\">@Fr√©d√©ric Dupuis</span> for the applications</p>\n<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> <span class=\"user-mention\" data-user-id=\"238446\">@Anne Baanen</span> for the API design</p>\n<p><span class=\"user-mention\" data-user-id=\"306577\">@Matthew Ballard</span> <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> for performance</p>",
        "id": 513544671,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1745309336
    },
    {
        "content": "<p>By the way, we're currently enjoying <a href=\"https://imperialcollegelondon.github.io/FLT/docs/FLT/Mathlib/Algebra/Algebra/Hom.html#SemialgHom\">semialgebra homs</a>  in FLT</p>",
        "id": 513551575,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1745311435
    },
    {
        "content": "<p>Aha! This should definitely be backported to Mathlib.</p>",
        "id": 513553586,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1745312020
    },
    {
        "content": "<p>In what context do they appear?<br>\nI believe that MulActionEquiv should be there as well. But an intermediate object is interesting, with an equivalence on the acted-on side, and a surjection on the monoid side.</p>",
        "id": 513555039,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1745312434
    },
    {
        "content": "<p>I don't want to derail this thread but if that question was to me then <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>v</mi></msub><mo>‚Üí</mo><msub><mi>L</mi><mi>w</mi></msub></mrow><annotation encoding=\"application/x-tex\">K_v\\to L_w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>v</mi></msub><mo>‚Üí</mo><msub><mo>‚àè</mo><mrow><mi>w</mi><mi mathvariant=\"normal\">‚à£</mi><mi>v</mi></mrow></msub><msub><mi>L</mi><mi>w</mi></msub></mrow><annotation encoding=\"application/x-tex\">K_v\\to\\prod_{w|v}L_w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2247em;vertical-align:-0.4747em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">‚àè</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2253em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mtight\">‚à£</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4747em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi mathvariant=\"double-struck\">A</mi><mi>K</mi><mi mathvariant=\"normal\">‚àû</mi></msubsup><mo>‚Üí</mo><msubsup><mi mathvariant=\"double-struck\">A</mi><mi>L</mi><mi mathvariant=\"normal\">‚àû</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{A}_K^\\infty\\to\\mathbb{A}_L^\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9642em;vertical-align:-0.2753em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-2.4247em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">‚àû</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2753em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9642em;vertical-align:-0.2753em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-2.4247em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">L</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">‚àû</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2753em;\"><span></span></span></span></span></span></span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">A</mi><mrow><mi>K</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">‚àû</mi></mrow></msub><mo>‚Üí</mo><msub><mi mathvariant=\"double-struck\">A</mi><mrow><mi>L</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">‚àû</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{A}_{K,\\infty}\\to\\mathbb{A}_{L,\\infty}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.975em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">‚àû</span></span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.975em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">L</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">‚àû</span></span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">A</mi><mi>K</mi></msub><mo>‚Üí</mo><msub><mi mathvariant=\"double-struck\">A</mi><mi>L</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{A}_K\\to\\mathbb{A}_L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">L</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> are all ring homomorphisms extending <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>‚Üí</mo><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">K\\to L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span> (finite separable extension of fields of fractions of Dededkind domains) and it was convenient to carry around the fact that they all extended <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>‚Üí</mo><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">K\\to L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span> in this way, before we tensored up and got <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>-algebra maps <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><msub><mo>‚äó</mo><mi>K</mi></msub><msub><mi>K</mi><mi>v</mi></msub><mo>‚Üí</mo><msub><mo>‚àè</mo><mrow><mi>w</mi><mi mathvariant=\"normal\">‚à£</mi><mi>v</mi></mrow></msub><msub><mi>L</mi><mi>w</mi></msub></mrow><annotation encoding=\"application/x-tex\">L\\otimes_KK_v\\to\\prod_{w|v}L_w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"><span class=\"mbin\">‚äó</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2247em;vertical-align:-0.4747em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">‚àè</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2253em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mtight\">‚à£</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4747em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><msub><mo>‚äó</mo><mi>K</mi></msub><msub><mi mathvariant=\"double-struck\">A</mi><mi>K</mi></msub><mo>‚Üí</mo><msub><mi mathvariant=\"double-struck\">A</mi><mi>L</mi></msub></mrow><annotation encoding=\"application/x-tex\">L\\otimes_K\\mathbb{A}_K\\to\\mathbb{A}_L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"><span class=\"mbin\">‚äó</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">L</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> etc etc</p>",
        "id": 513555860,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1745312676
    },
    {
        "content": "<p>I wonder whether we should do a different generalization (to noncommutative rings) for TensorProduct simultaneously; the following would combine both generalizations, I think.<br>\nGiven an <code>R</code>-module <code>N</code>, a module <code>M</code> over two rings <code>S</code> and <code>T</code> with <code>SMulCommClass S T M</code>, a <code>U</code>-module <code>P</code>, and ring homomorphisms <code>œÉ</code> from <code>R</code> to <code>DomMulAct S</code> (same as <code>MulOpposite S</code> as a ring) and <code>œÑ</code> from <code>T</code> to <code>U</code>, we could define a tensor product <code>M ‚äó[œÉ] N</code> which inherits a <code>T</code>-module structure from <code>M</code>, and establish the adjunction <code>(M ‚äó[œÉ] N ‚Üí‚Çó[œÑ] P) ‚âÉ+ (N ‚Üí‚Çó[œÉ] M ‚Üí‚Çó[œÑ] P)</code>. Notice that the order of <code>M</code> and <code>N</code> are switched compared to <code>TensorProduct.lift.equiv</code>, but this seems unavoidable if you want the tensor product to inherit actions from the left component rather than the right component by instances.</p>",
        "id": 513737286,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1745360759
    },
    {
        "content": "<p>I've thought a bit about noncommutative tensor products at some point. One thing that I think is important (EDIT: not really important, but I think it's a good idea) is not to force anything to actually be a right module, so I would say that <code>œÉ</code> should just be allowed to not be a ring homomorphism, so that it can be both the identity and <code>MulOpposite.op</code>.</p>\n<p>Otherwise I think I agree with your proposal, but I think to actually use tensor products over noncommutative rings we will also have to solve the action inheritance issue: how do we allow the tensor product over <code>B</code> of an <code>A</code>-<code>B</code>-module and a <code>B</code>-<code>C</code>-module to come naturally with a <code>A</code>-<code>C</code>-module structure ? This happens all the time in e.g K-theory...</p>",
        "id": 516305343,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1746482758
    },
    {
        "content": "<p>If you want to have a go at your generalization feel free to do so, but I don't think I'll have time for it in the near future.</p>",
        "id": 516305490,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1746482810
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"268315\">Anatole Dedecker</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Semilinearizing/near/516305343\">said</a>:</p>\n<blockquote>\n<p>One thing that I think is important is not to force anything to actually be a right module,</p>\n</blockquote>\n<p>Can you elaborate on this? My take long ago was that we <em>do</em> want to do this, but we need to make this play better with <code>Algebra</code> to make it justifiable</p>",
        "id": 516305532,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746482827
    },
    {
        "content": "<p>Okay thinking back about this I realize that I may have confused two independent thoughts. What is bad is the naive \"inherit left actions from the left and right actions from the right\" (this comes with obvious diamonds). </p>\n<p>But this is another question. For the question of wether we should ask the left-hand-side to be a right module, I think it was rather a personal preference (\"left-right is mostly useful for humans, so we should do most things in the setting of commuting actions and leave users to choose their left and right\"), and also the fact that if we want to cover the commutative case then it's nice to allow not having an artifical right-module structure.</p>",
        "id": 516307233,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1746483556
    },
    {
        "content": "<p>Really the main point is that the ring-hom part in our semilinear setup is mostly useless, and we could use bare function as in <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MulActionHom#doc\">docs#MulActionHom</a></p>",
        "id": 516307469,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1746483668
    },
    {
        "content": "<p>Coming back to the subject of this thread: I know it's annoying to review, but could someone have a look at <a href=\"https://github.com/leanprover-community/mathlib4/pull/24170\">#24170</a> ? Thanks!</p>",
        "id": 516307750,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1746483793
    },
    {
        "content": "<blockquote>\n<p>so I would say that¬†<code>œÉ</code>¬†should just be allowed to not be a ring homomorphism, so that it can be both the identity and¬†<code>MulOpposite.op</code></p>\n</blockquote>\n<p>For a commutative ring, <code>MulOpposite.op</code> is a ring homomorphism (<a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Ring/Equiv.html#RingEquiv.toOpposite\">RingEquiv.toOpposite</a>).<br>\nTensor products over commutative and non-commutative rings would use different ring homs, but hopefully we can generalize the lemmas so they don't need to be duplicated.<br>\nIn the case of induced representation (<code>K[G] ‚äó[K[H]] V</code>, with H a subgroup of G), we can even take the ring hom to be the inclusion from K[H] into K[G] to avoid introducing a right-K[H]-module structure on K[G].</p>",
        "id": 516309445,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1746484624
    },
    {
        "content": "<p>I guess this works (took me some time to understand what you meant), but if there is such a disjunction between the commutative and noncommutative case I think I'd rather have them as separate definitions</p>",
        "id": 516459981,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1746541724
    },
    {
        "content": "<p>To be fair we may want to do this anyways, so maybe your approach is fine.</p>",
        "id": 516461663,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1746542099
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"268315\">Anatole Dedecker</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Semilinearizing/near/516459981\">said</a>:</p>\n<blockquote>\n<p>I think I'd rather have them as separate definitions</p>\n</blockquote>\n<p>That seems like an awful lot of duplication. It seems to me it would be hard to keep the API in sync.</p>",
        "id": 516462233,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1746542251
    },
    {
        "content": "<p>I agree, and I don't have a strong argument for the duplication, but I prefer to be pessimistic and assume that whatever we do will annoy sufficiently the commutative algbraists that we need to duplicate x)</p>",
        "id": 516462604,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1746542336
    },
    {
        "content": "<p>But I'd be happy if we don't need it!</p>",
        "id": 516462671,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1746542355
    },
    {
        "content": "<p>I should emphasize: I don't want to discourage anyone giving noncommutative tensor products a try. I'd be happy with anything that works, and I haven't thought about it enough to have a crystal-clear idea of what the ideal setup would be.</p>",
        "id": 516466311,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1746543249
    },
    {
        "content": "<p>I'd aim to generalize most lemmas in the file to arbitrary <code>œÉ : R ‚Üí+* R‚ÇÅ·µà·µê·µÉ</code> as in <a href=\"https://github.com/leanprover-community/mathlib4/compare/master...NoncommTensorProduct\">this commit</a> (it's just a start, the adjunction is not yet generalized, and it doesn't include the generalization in <a href=\"https://github.com/leanprover-community/mathlib4/pull/24208\">#24208</a>). I envision that the commutative part of the library will use <code>œÉ = RingEquiv.toOpposite R</code> while the noncommutative part will use <code>œÉ = RingEquiv.opOp R</code>, but the same lemmas would apply to them because they work for arbitrary <code>œÉ</code>.<br>\nI'm unfortunately busy this week and won't be able to get back to <a href=\"https://github.com/leanprover-community/mathlib4/tree/NoncommTensorProduct\">branch#NoncommTensorProduct</a> until next week.</p>",
        "id": 516544549,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1746571278
    },
    {
        "content": "<p>Why <code>DMA</code> and not <code>MOP</code>?</p>",
        "id": 516544917,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746571497
    },
    {
        "content": "<p>See this message: <a class=\"message-link\" href=\"/#narrow/channel/287929-mathlib4/topic/Semilinearizing/near/513737286\">#mathlib4 &gt; Semilinearizing @ üí¨</a> <br>\nIn the adjunction <code>(M ‚äó[œÉ] N ‚Üí‚Çó[œÑ] P) ‚âÉ+ (N ‚Üí‚Çó[œÉ] M ‚Üí‚Çó[œÑ] P)</code>, in the RHS we want a semilinear map from N to <code>M ‚Üí‚Çó[œÑ] P</code>, which <code>DomMulAct S</code> acts on (because S acts on M) but <code>MulOpposite S</code> doesn't (as an instance), so œÉ needs to be from R (which acts on N) to <code>DomMulAct S</code>.<br>\nWhen I talked about <code>RingEquiv.opOp R</code> and <code>RingEquiv.toOpposite R</code> above, I'm abusing the defeq between DomMulAct and MulOpposite (which are defeq as rings).</p>",
        "id": 516545780,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1746572067
    },
    {
        "content": "<p>Right, my objection was mainly because of the defeq abuse</p>",
        "id": 516546162,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746572332
    },
    {
        "content": "<p>It seems to me like there is an unavoidable issue here because some tensor products are of left <code>R</code>-modules and right <code>R</code>-modules where the right-sidedness of the latter action often doesn't come from any kind of \"acting on the domain\", so that it is an  <code>R·µê·µí·µñ</code> and not <code>R·µà·µê·µÉ</code> action. For example, if <code>œÉ: R ‚Üí S</code> is a ring homomorphism then base-changing <code>S ‚äó[R] M</code> would be (in the sense of the parameter <code>œÉ : R ‚Üí+* R‚ÇÅ·µà·µê·µÉ</code> proposed above) using the <code>S·µê·µí·µñ</code> action on <code>S</code> by right-multiplication and <code>œÉ: R ‚Üí S</code>, and hence use that <code>S = (S·µê·µí·µñ)·µà·µê·µÉ</code>.</p>\n<p>To avoid this one should use <code>œÉ : R ‚Üí+* R‚ÇÅ·µê·µí·µñ</code> for tensor products, but we still need <code>œÉ : R ‚Üí+* R‚ÇÅ·µà·µê·µÉ</code> for <code>N ‚Üí‚Çó[œÉ] M ‚Üí‚Çó[œÑ] P</code> to make sense. In summary, it seems like the tensor-hom adjunction over non-commutative rings intrinsically <strong>requires</strong> the line between <code>·µê·µí·µñ</code> and <code>·µà·µê·µÉ</code> to be blurred, because it really uses that the action on a morphism space inherited from the action of the domain is an action of the opposite ring.</p>\n<p>Another example of this is that although we have an example above of tensor product where the right module structure is naturally <code>·µê·µí·µñ</code>, sometimes it is <code>·µà·µê·µÉ</code> rather than <code>·µê·µí·µñ</code>. E.g., if we are considering the evaluation map <code>(A ‚Üí‚Çó[R] B) ‚äó[Module.End R A] A ‚Üí B</code> for <code>R</code>-modules <code>A</code>, <code>B</code>, then the opposite <code>Module.End R A</code>-module structure on <code>A ‚Üí‚Çó[R] B</code> is a <code>·µà·µê·µÉ</code> rather than <code>·µê·µí·µñ</code>. So again either the distinction between the two has to be erased while defining one of the tensor products, or there would have to be two kinds of tensor products for <code>·µê·µí·µñ</code> and <code>·µà·µê·µÉ</code> or something.</p>",
        "id": 524804280,
        "sender_full_name": "Raghuram",
        "timestamp": 1750297350
    },
    {
        "content": "<p>(Admittedly this is really about the non-commutative generalisation of tensor products rather than the semilinear generalisation.)</p>",
        "id": 524804335,
        "sender_full_name": "Raghuram",
        "timestamp": 1750297416
    }
]