[
    {
        "content": "<p>In <a href=\"https://github.com/leanprover-community/mathlib4/pull/23585\">#23585</a>, <span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> adds new filters <code>atMax</code> and <code>atMin</code>. What do you think about replacing the current <code>atTop</code> and <code>atBot</code> with these new filters?</p>",
        "id": 514267599,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1745552574
    },
    {
        "content": "<p>Membership in <code>atMax</code> (which may replace <code>atTop</code>) is given by</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">mem_atMax</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Preorder</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">atMax</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Ici</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Iff</span><span class=\"bp\">.</span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 514267666,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1745552623
    },
    {
        "content": "<p>For a directed order, the new filter is the same as <code>atTop</code>, so the only possible change is addition/removal of \"directed\" assumptions here and there.</p>",
        "id": 514267759,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1745552659
    },
    {
        "content": "<p>Do you mean, we should change the definition of <code>atTop</code> with this new definition, to make it work also on non-directed orders, or we should have both and swap most theorems to use <code>atMax</code> instead of <code>atTop</code>? I would be fine with the first option (dropping some directedness assumptions in some lemmas would always be good) , but not with the second (too much disruption for a too small gain).</p>",
        "id": 514297614,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1745562597
    },
    {
        "content": "<p>Is this the correct filter for things happening \"at all maximal elements\"? What's Aaron's motivation for this filter?</p>",
        "id": 514312093,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1745567936
    },
    {
        "content": "<p>My motivation is to have a useful notion of the \"limit at infinity\" in a non-directed order (for which <code>atTop = ⊥</code>). After thinking about it for a while this is the definition I came up with. So far I have proved</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NeBot</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">atMax</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">atTop_le_atMax</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">atTop</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">atMax</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">atMax_eq_atTop</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsDirected</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">atMax</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">atTop</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">pure_le_atMax</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">atMax</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">IsMax</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>\n<p>and their duals, which are in the PR.</p>",
        "id": 514354154,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1745579628
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110050\">Sébastien Gouëzel</span> <a href=\"#narrow/channel/287929-mathlib4/topic/atTop.20and.20atBot.20filters/near/514297614\">said</a>:</p>\n<blockquote>\n<p>Do you mean, we should change the definition of <code>atTop</code> with this new definition, to make it work also on non-directed orders, or we should have both and swap most theorems to use <code>atMax</code> instead of <code>atTop</code>? I would be fine with the first option (dropping some directedness assumptions in some lemmas would always be good) , but not with the second (too much disruption for a too small gain).</p>\n</blockquote>\n<p>This will drop directedness assumptions in some lemmas but add them in other lemmas. E.g., <code>tendsto_atTop</code> will require directedness with this new proof.</p>",
        "id": 514372520,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1745585340
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> Do you have any specific types with non-directed orders where you care about <code>atMax</code>, or is it a theoretical exercise?</p>",
        "id": 514372666,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1745585385
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/atTop.20and.20atBot.20filters/near/514372520\">said</a>:</p>\n<blockquote>\n<p>This will drop directedness assumptions in some lemmas but add them in other lemmas. E.g., <code>tendsto_atTop</code> will require directedness with this new proof.</p>\n</blockquote>\n<p>Then I would need a convincing example to show me that the new definition is better than the current one.</p>",
        "id": 514372849,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1745585434
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/atTop.20and.20atBot.20filters/near/514372666\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> Do you have any specific types with non-directed orders where you care about <code>atMax</code>, or is it a theoretical exercise?</p>\n</blockquote>\n<p>Mostly this is a theoretical exercise, but I recently found a place to to use this.</p>",
        "id": 514374930,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1745586005
    },
    {
        "content": "<p>Any details?</p>",
        "id": 514378996,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1745587252
    }
]