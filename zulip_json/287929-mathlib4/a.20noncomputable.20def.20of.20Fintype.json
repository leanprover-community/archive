[
    {
        "content": "<p>I found that <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/LinearAlgebra/FiniteDimensional/Defs.html#FiniteDimensional.fintypeOfFintype\">FiniteDimensional.fintypeOfFintype</a> is a <code>noncomputable def</code> of <code>Fintype</code>. My understanding is that <code>Fintype</code> should only be used in cases where it is computable in the reduction or <code>#eval</code> sense, so this definition might be bad. Should we deprecate this definition?</p>",
        "id": 478219207,
        "sender_full_name": "Yongle Hu",
        "timestamp": 1729581395
    },
    {
        "content": "<p>For example, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/LinearAlgebra/FiniteDimensional/Defs.html#FiniteDimensional.fintypeOfFintype\">FiniteDimensional.fintypeOfFintype</a> is used to prove that <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/FieldTheory/Finite/GaloisField.html#GaloisField\">GaloisField</a> is <code>Fintype</code>, but we cannot calculate the number of elements in <code>GaloisField 3 3</code> using <code>#eval</code>.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">GaloisField</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 478220440,
        "sender_full_name": "Yongle Hu",
        "timestamp": 1729581901
    },
    {
        "content": "<p>It's definitely tempting to change it to <code>Finite</code></p>",
        "id": 478224137,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1729583249
    },
    {
        "content": "<p>But I think that <code>Fintype.card (GaloisField 3 3)</code> should remain legal, and the fact it doesn't #eval is unfortunate but not a reason to disable the Fintype <em>instance</em>.</p>",
        "id": 478224355,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1729583331
    },
    {
        "content": "<p>The fact that it doesn't <code>fin_cases</code> might be?</p>",
        "id": 478225047,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1729583586
    },
    {
        "content": "<p>Why not Nat.card?</p>",
        "id": 478231498,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1729585665
    },
    {
        "content": "<p>I think it is better to replace <code>Fintype.card</code> with <code>Nat.card</code> in the theorems about <code>GaloisField</code> (for example, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/FieldTheory/Finite/GaloisField.html#GaloisField.algEquivGaloisField\">GaloisField.algEquivGaloisField</a>).</p>",
        "id": 478252621,
        "sender_full_name": "Yongle Hu",
        "timestamp": 1729592853
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/channel/287929-mathlib4/topic/a.20noncomputable.20def.20of.20Fintype/near/478225047\">said</a>:</p>\n<blockquote>\n<p>The fact that it doesn't <code>fin_cases</code> might be?</p>\n</blockquote>\n<p><code>fin_cases</code> behaves poorly with many types</p>",
        "id": 478255349,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1729593943
    },
    {
        "content": "<p>I think it makes sense turning these into theorems that prove <code>Finite</code>.</p>\n<p>At least <code>FiniteDimensional.fintypeOfFintype</code> isn't an instance. Noncomputable fintype instances are bad because they can cause things to become noncomputable. The point of <code>Fintype</code> over <code>Finite</code> is that you can (at least in theory) compute with it.</p>\n<p>I'd strongly suggested turning <a href=\"https://github.com/leanprover-community/mathlib4/blob/e7dbdb48a63351e003b88001e2371ab4f0a24243/Mathlib/FieldTheory/Finite/GaloisField.lean#L87-L89\">the noncomputable GaloisField Fintype instance</a> into a Finite one because of this. If somehow a Fintype instance is still useful, at least it should be <code>scoped</code>.</p>",
        "id": 478334284,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729618055
    },
    {
        "content": "<p>I find it is a little difficult to replace <code>Fintype.card</code> with <code>Nat.card</code> in the theorems related to <code>GaloisField</code>, because many theorems used in the proof (such as <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/FieldTheory/Finite/Basic.html#FiniteField.roots_X_pow_card_sub_X\">FiniteField.roots_X_pow_card_sub_X</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/FieldTheory/Separable.html#Polynomial.card_rootSet_eq_natDegree\">Polynomial.card_rootSet_eq_natDegree</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/LinearAlgebra/Basis/Defs.html#Module.card_fintype\">Module.card_fintype</a>) only have versions for <code>Fintype.card</code> and do not have versions for <code>Nat.card</code>.</p>",
        "id": 478413245,
        "sender_full_name": "Yongle Hu",
        "timestamp": 1729659953
    },
    {
        "content": "<p>Can you use something like <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Fintype.ofFinite#doc\">docs#Fintype.ofFinite</a> to connect up the theories? You can do things like <code>have := Fintype.ofFinite ty</code> to temporarily introduce Fintype instances.</p>",
        "id": 478413591,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729660178
    },
    {
        "content": "<p>I think I can temporarily write a private instance of <code>Fintype (GaloisField p n)</code>, and then use <code>Nat.card_eq_fintype_card</code> to relate <code>Nat.card</code> and <code>Fintype.card</code>. But I think it may be necessary to add <code>Nat.card</code> versions of those theorems in the future.</p>",
        "id": 478414254,
        "sender_full_name": "Yongle Hu",
        "timestamp": 1729660668
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/18106\">#18106</a>.</p>",
        "id": 478454125,
        "sender_full_name": "Yongle Hu",
        "timestamp": 1729676593
    }
]