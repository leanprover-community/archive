[
    {
        "content": "<p>Currently, the definition of <code>InnerProductSpace ğ•œ ğ•œ</code> is:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- A field `ğ•œ` satisfying `RCLike` is itself a `ğ•œ`-inner product space. -/</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">RCLike</span><span class=\"bp\">.</span><span class=\"n\">innerProductSpace</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">InnerProductSpace</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">inner</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">conj</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span>\n<span class=\"w\">  </span><span class=\"n\">norm_sq_eq_inner</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inner</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">conj_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">â†</span><span class=\"w\"> </span><span class=\"n\">ofReal_pow</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ofReal_re</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">conj_symm</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mul_comm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">map_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">starRingEnd_self_apply</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">add_left</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">add_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">map_add</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">smul_left</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mul_assoc</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">smul_eq_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">map_mul</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>I would like to change the <code>inner</code> field to:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"n\">inner</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">conj</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>\n<p>This is, of course, propositionally but not definitionally equal to the original. My reason for wanting this change is as follows. In Câ‹†-algebra theory, we like to consider an object called a (Hilbert) <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CStarModule#doc\">docs#CStarModule</a>. These are essentially generalizations of <code>InnerProductSpace</code> where the scalars are replaced by a Câ‹†-algebra. In the literature, we generally consider these as <em>right</em> <code>A</code>-modules (where <code>A</code> is the Câ‹†-algebra), which is why <code>CStarModule</code> is currently set up with <code>SMul Aáµáµ’áµ– E</code>. However, I realized that we will need both left and right Câ‹†-modules, which makes me want to just take a <code>SMul A E</code> hypothesis instead.</p>\n<p>Now, given any Câ‹†-algebra <code>A</code>, there is a natural <code>CStarModule A A</code> instance (with a left action) analogous to the <code>InnerProductSpace ğ•œ ğ•œ</code> instance where the <code>inner</code> field is defined as <code>inner x y := y * star x</code>. Note that because the multiplication is non-commutative, we need <code>inner</code> to be defined this way in order to get the appropriate behavior with the (pre-existing!) left action of <code>A</code> on itself (i.e., we need <code>âŸªx, a â€¢ yâŸ« = a â€¢ âŸªx, yâŸ«</code> for <code>a x y : A</code>).</p>\n<p>Herein lies the rub: <code>â„‚</code> is a Câ‹†-algebra, so it will inherit <code>CStarModule â„‚ â„‚</code> and <code>InnerProductSpace â„‚ â„‚</code> instances, which will result in a non-defeq diamond for <code>Inner â„‚ â„‚</code>.</p>\n<p>Does anyone see any problem with this? <span class=\"user-mention\" data-user-id=\"311453\">@FrÃ©dÃ©ric Dupuis</span>, <span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span>, <span class=\"user-mention\" data-user-id=\"462733\">@Jon Bannon</span></p>",
        "id": 487074289,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733770609
    },
    {
        "content": "<p>Oh, I really like the convention with the <code>star</code> on the left because it corresponds to applying the dual map corresponding to <code>x</code> to <code>y</code></p>",
        "id": 487077038,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1733771374
    },
    {
        "content": "<p>I think that's unaffected? Because that map uses <code>innerSL</code> which, for this specific type, gets redefined.</p>",
        "id": 487100872,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733779019
    },
    {
        "content": "<p>Also <span class=\"user-mention\" data-user-id=\"268315\">@Anatole Dedecker</span></p>",
        "id": 487289587,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733847154
    },
    {
        "content": "<p>This is a source of controversy in some places because the OA community generally uses <code>a * star b</code> (in Kadison-Ringrose, for example) but physics uses <code>star a * b</code>, so if you have been raised on the former, calculations with the latter can be stumbly, on paper. I've come around to <code>star a * b</code> for precisely the reason you mention, Jireh. In <code>CStarModule</code>-land, everyone uses this convention for the <code>CStarModule</code> valued inner products, which immediately puts it at odds with ordinary inner products in the trivial case where the C* algebra is the complex numbers.</p>",
        "id": 487293647,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1733848225
    },
    {
        "content": "<p>Hold on, I don't think we're talking on the same wavelength.</p>",
        "id": 487293776,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733848264
    },
    {
        "content": "<p>I don't want to define <code>âŸªx, yâŸ« := x * star y</code>, I want to define it as <code>âŸªx, yâŸ« := y * star x</code> (as opposed the to current <code>star x * y</code>). My version will still agree with that of current Mathlib propositionally (i.e., conjugate linear in the <em>first</em> variable).</p>",
        "id": 487294182,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733848359
    },
    {
        "content": "<p>Literally all I want to do is use the fact that multiplication in <code>ğ•œ</code> is commutative.</p>",
        "id": 487294412,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733848419
    },
    {
        "content": "<p>OK. So this isn't a change at all. Knee-jerk, I was taken back to several discussions with J. Martin Lindsay in which he vociferously argued for conjugate linearity in the first coordinate. The <em>only</em> problem I can see might be that some people prefer the opposite. </p>\n<p>The physicists like conjugate linearity in the first variable (in opposition to the OA traditional approach), and since in the trivial A-A C* module we typically define $\\langle a, b \\rangle = a^{*}b$ for $a,b \\in A$ and develop the whole theory around this, it seemed better to adopt that.</p>\n<p>Sorry for the noise!</p>",
        "id": 487294900,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1733848532
    },
    {
        "content": "<p>In Mathlib we've been conjugate linear in the first coordinate since ... forever? I think. But sure, that's a stance we've taken.</p>",
        "id": 487295166,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733848607
    },
    {
        "content": "<p>OK. No problem, then. I should probably have checked Mathlib before commenting...or carefully read your question.</p>",
        "id": 487295987,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1733848822
    },
    {
        "content": "<p>Is it relevant that I was intending to eventually make <code>InnerProductSpace K V</code> (or rather, its parent <code>NormedSpace K V</code>) imply both a left- and right-action by <code>K</code>?</p>",
        "id": 487296256,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733848908
    },
    {
        "content": "<p><span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span> I <em>think</em> that's fine?</p>",
        "id": 487296632,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733849003
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 487296764,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733849042
    },
    {
        "content": "<p>Oh, I guess it depends on what your definition of the right action is?</p>",
        "id": 487296884,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733849064
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/redefining.20.60Inner.60.20in.20.60InnerProductSpace.20.F0.9D.95.9C.20.F0.9D.95.9C.60/near/487294182\">said</a>:</p>\n<blockquote>\n<p>I don't want to define <code>âŸªx, yâŸ« := x * star y</code>, I want to define it as <code>âŸªx, yâŸ« := y * star x</code> (as opposed the to current <code>star x * y</code>).</p>\n</blockquote>\n<p>I completely misread this! I am now unsaddened</p>",
        "id": 487297677,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1733849273
    },
    {
        "content": "<p>(I'm glad you did too, <span class=\"user-mention\" data-user-id=\"387244\">@YaÃ«l Dillies</span> ...I feel a tiny bit less silly, now. <span aria-label=\"rolling on the floor laughing\" class=\"emoji emoji-1f923\" role=\"img\" title=\"rolling on the floor laughing\">:rolling_on_the_floor_laughing:</span> )</p>",
        "id": 487298012,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1733849368
    },
    {
        "content": "<p>So just to check, we want</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">âŸª</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">â€¢</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">âŸ«</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">â€¢</span><span class=\"w\"> </span><span class=\"bp\">âŸª</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">âŸ«</span>\n</code></pre></div>\n<p>and not the  more symmetric</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">âŸª</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">â€¢&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">âŸ«</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">â€¢&gt;</span><span class=\"w\"> </span><span class=\"bp\">âŸª</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">âŸ«</span>\n<span class=\"bp\">âŸª</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">&lt;â€¢</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">âŸ«</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">âŸª</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">âŸ«</span><span class=\"w\"> </span><span class=\"bp\">&lt;â€¢</span><span class=\"w\"> </span><span class=\"n\">a</span>\n</code></pre></div>",
        "id": 487303906,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733851146
    },
    {
        "content": "<p>(and am I right in saying we currently have the latter?)</p>",
        "id": 487303966,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733851163
    },
    {
        "content": "<p>No on both counts.</p>",
        "id": 487304032,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733851191
    },
    {
        "content": "<p>We want <code>âŸªx, a â€¢ yâŸ« = a â€¢ âŸªx, yâŸ«</code> (and we have this) and we want <code>âŸªa â€¢ x, yâŸ« = âŸªx, yâŸ« &lt;â€¢ (star a)</code>.</p>",
        "id": 487304307,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733851288
    },
    {
        "content": "<p>(and we have these currently propositionally, but not defeq)</p>",
        "id": 487304378,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733851316
    },
    {
        "content": "<p>This is all moot without generalizing <code>InnerProductSpace</code> to not need <code>IsROrC</code>, right?</p>",
        "id": 487304485,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733851341
    },
    {
        "content": "<p>??</p>",
        "id": 487304541,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733851359
    },
    {
        "content": "<p>Ah nevermind, I now understand your diamond comment, sorry</p>",
        "id": 487304551,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733851364
    },
    {
        "content": "<p>When we have a <code>CStarModule Aáµáµ’áµ– E</code> instance, then for <code>x y : E</code> and <code>a : A</code>, we'll get <code>âŸªx, y &lt;â€¢ aâŸ« = âŸªx, yâŸ« &lt;â€¢ a</code>, which is what we normally do in Câ‹†-module theory (i.e., we default to right actions instead of left actions).</p>",
        "id": 487305019,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733851538
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/redefining.20.60Inner.60.20in.20.60InnerProductSpace.20.F0.9D.95.9C.20.F0.9D.95.9C.60/near/487296256\">said</a>:</p>\n<blockquote>\n<p>Is it relevant that I was intending to eventually make <code>InnerProductSpace K V</code> (or rather, its parent <code>NormedSpace K V</code>) imply both a left- and right-action by <code>K</code>?</p>\n</blockquote>\n<p>I confused myself about this earlier. I think there is no issue here because the right-module action of a Câ‹†-algebra on itself gives us a <code>CStarModule Aáµáµ’áµ– A</code> instance which leads to an <code>Inner Aáµáµ’áµ– A</code> instance. So this doesn't conflict with anything in the case of <code>A := â„‚</code> because it's an <code>Inner</code> instance over <code>â„‚áµáµ’áµ–</code> not over <code>â„‚</code>.</p>",
        "id": 487306429,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733851969
    },
    {
        "content": "<p>Do you have any interest in one-sided <code>CStarModule</code>s, or should they also imply compatible left and right actions?</p>",
        "id": 487311727,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733853710
    },
    {
        "content": "<p>No, they will only be one-sided in general.</p>",
        "id": 487311884,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733853760
    },
    {
        "content": "<p>But I'll need to, for example, consider Câ‹†-bimodules, where I have <code>CStarModule A E</code> and <code>CStarModule Báµáµ’áµ– E</code> along with some compatibility conditions, hence I really do need left and right actions.</p>",
        "id": 487312091,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733853835
    },
    {
        "content": "<p>A bit late to the discussion, but I agree with Jireh on everything here. It's just a bit sad that <code>âŸªx, a â€¢ yâŸ« = a â€¢ âŸªx, yâŸ«</code> looks less good than in the right module setting, but that's just a fact of life.</p>",
        "id": 487353516,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1733870780
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/redefining.20.60Inner.60.20in.20.60InnerProductSpace.20.F0.9D.95.9C.20.F0.9D.95.9C.60/near/487296256\">said</a>:</p>\n<blockquote>\n<p>Is it relevant that I was intending to eventually make <code>InnerProductSpace K V</code> (or rather, its parent <code>NormedSpace K V</code>) imply both a left- and right-action by <code>K</code>?</p>\n</blockquote>\n<p>I think we should be <em>removing</em> requirements from <code>NormedSpace</code> (e.g allowing more base rings), not adding some. And indeed if we ever want to unify <code>CStarModule</code> and <code>InnerProductSpace</code> (which is not the most urgent thing, but could be nice) that could be annoying I think.</p>",
        "id": 487354297,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1733871195
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"268315\">Anatole Dedecker</span> <a href=\"#narrow/channel/287929-mathlib4/topic/redefining.20.60Inner.60.20in.20.60InnerProductSpace.20.F0.9D.95.9C.20.F0.9D.95.9C.60/near/487354297\">said</a>:</p>\n<blockquote>\n<p>I think we should be <em>removing</em> requirements from <code>NormedSpace</code> (e.g allowing more base rings), not adding some.</p>\n</blockquote>\n<p>We already have the fully-removed version, it's <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=BoundedSMul#doc\">docs#BoundedSMul</a></p>",
        "id": 487355235,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733871674
    },
    {
        "content": "<p>I went through a spree last year of replacing lots of <code>NormedSpace</code>s in theorems in mathlib with that typeclass, generalizing the ring appropriately</p>",
        "id": 487355354,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733871739
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/redefining.20.60Inner.60.20in.20.60InnerProductSpace.20.F0.9D.95.9C.20.F0.9D.95.9C.60/near/487355235\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"268315\">Anatole Dedecker</span> <a href=\"#narrow/channel/287929-mathlib4/topic/redefining.20.60Inner.60.20in.20.60InnerProductSpace.20.F0.9D.95.9C.20.F0.9D.95.9C.60/near/487354297\">said</a>:</p>\n<blockquote>\n<p>I think we should be <em>removing</em> requirements from <code>NormedSpace</code> (e.g allowing more base rings), not adding some.</p>\n</blockquote>\n<p>We already have the fully-removed version, it's <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=BoundedSMul#doc\">docs#BoundedSMul</a></p>\n</blockquote>\n<p>Ah yes, I always forget about this one, sorry. I don't remember, is there a reason not to replace <code>NormedSpace</code>? But I guess this is another subject.</p>",
        "id": 487355748,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1733871973
    },
    {
        "content": "<p>I suspect we never want to unify <code>InnerProductSpace</code> and <code>CStarModule</code></p>",
        "id": 487355769,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733871991
    },
    {
        "content": "<p>Is there an obvious reason I'm missing?</p>",
        "id": 487355881,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1733872081
    },
    {
        "content": "<p>several: </p>\n<ol>\n<li>import hierarchy</li>\n<li>Can't include <code>\\R</code></li>\n<li>Many theorems don't generalize so there isn't tons of duplication. And even the ones that do require high-powered results.</li>\n</ol>",
        "id": 487356155,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733872243
    },
    {
        "content": "<p>Even putting an instance on the product requires nontrivial CFC machinery.</p>",
        "id": 487356341,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733872338
    },
    {
        "content": "<p>I wasn't advocating for any nontrivial generalization, so I don't think the first two point are that bad (again, just for the definitions). I was mostly thinking of factorizing e.g Cauchy-Schwartz identity, but I was missing the sneaky <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CStarAlgebra.conjugate_le_norm_smul#doc\">docs#CStarAlgebra.conjugate_le_norm_smul</a> in the proof.</p>",
        "id": 487357717,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1733873174
    },
    {
        "content": "<p>Yeah, and note also that (at least for now), we don't allow <em>pre</em>-Câ‹†-modules, but we do allow for pre-inner product spaces.</p>\n<p>But what I meant with <code>â„</code> is that the <code>â„‚</code>-module structure is baked in as a parameter to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CStarModule#doc\">docs#CStarModule</a>, so it's impossible to have <code>CStarModule â„ â„</code>. This may need to change at some point, but currently we do this because it would be a royal pain otherwise, as Lean will never be able to figure out whether it should choose <code>â„</code> or <code>â„‚</code>. (Indeed, while <code>âŸªx, yâŸ«_A</code> makes reference to <code>A</code>, there is no mention of the actual scalar ring anywhere.)</p>",
        "id": 488144454,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733936238
    },
    {
        "content": "<p>Ugh... this is a super annoying change. If anyone wants to lend a hand, it's on <a href=\"https://github.com/leanprover-community/mathlib4/tree/j-loreaux%2FInnerProductSpace-swap-mul\">branch#j-loreaux/InnerProductSpace-swap-mul</a>.</p>",
        "id": 488862517,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734102793
    },
    {
        "content": "<p>I think the thing that is perhaps worst about it is that over <code>â„</code> it's really surprising (i.e., that <code>âŸªx, yâŸ«_â„ := y * x</code> definitionally for <code>x y : â„</code>). This comes up in the Fourier Transform stuff a bunch. I guess I'm not sure whether to change some of the definitions (so that they are <code>innerSL.flip</code>, which preserves the order of multiplication, or to fix the proofs).</p>\n<p>Likewise, when constructing an inner product on <code>n â†’ ğ•œ</code> from a positive definite matrix <code>M</code>, the definition <em>was</em> <code>âŸªx, yâŸ« := dotProduct (star x) (M *áµ¥ y)</code>, which is pretty natural, but I switched it to <code>dotProduct (M *áµ¥ y) (star x)</code> so that when you take the inner product corresponding to the identity you will get the same inner product definitionally as the one on <code>EuclideanSpace ğ•œ n</code>.</p>",
        "id": 488863658,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734103107
    },
    {
        "content": "<p>I confess I haven't read this thread carefully but are you saying that we will lose the fact that the following proof is true by definition if we make this change?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">RealInnerProductSpace</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âŸª</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">âŸ«</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 489011202,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1734196653
    },
    {
        "content": "<p>Yes, it will be <code>âŸªx, yâŸ« = y * x := rfl</code>.</p>",
        "id": 489012109,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1734197492
    },
    {
        "content": "<p>I finally got around to finishing this: <a href=\"https://github.com/leanprover-community/mathlib4/pull/22715\">#22715</a>. Please feel free to comment. </p>\n<p><span class=\"user-mention\" data-user-id=\"481963\">@David Loeffler</span> and <span class=\"user-mention\" data-user-id=\"387244\">@YaÃ«l Dillies</span> in particular I would like your comments on changes in this PR to areas relevant to you.</p>",
        "id": 504395944,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1741528491
    },
    {
        "content": "<p>I think Jireh has done an excellent job of making the change in a way that's minimally invasive for the existing code â€“ the vast majority the changes in Fourier theory, etc, seem to be just changing <code>inner_apply</code> to <code>inner_apply'</code>. So, if it makes life easier for C* algebra stuff, then I certainly have no objection.</p>",
        "id": 504405576,
        "sender_full_name": "David Loeffler",
        "timestamp": 1741535426
    },
    {
        "content": "<p>There's a merge conflict now. Otherwise, sounds great!</p>",
        "id": 504710104,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1741650986
    },
    {
        "content": "<p>conflict resolved.</p>",
        "id": 505446505,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1741878048
    },
    {
        "content": "<p>Probably not related to the issue I'm having but you're probably familiar with this bit of code. I've been trying to use</p>\n<p>rw [inner]</p>\n<p>to use the lemma </p>\n<p>âˆ€ (w z : â„‚), inner w z = ((starRingEnd â„‚) w * z).re</p>\n<p>but for whatever reason i'm always getting</p>\n<p>Inner.inner.{u_4, u_5} {ğ•œ : Type u_4} {E : Type u_5} [self : Inner ğ•œ E] : E â†’ E â†’ ğ•œ</p>",
        "id": 505651594,
        "sender_full_name": "George Granberry",
        "timestamp": 1741952210
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"871920\">George Granberry</span> <a href=\"#narrow/channel/287929-mathlib4/topic/redefining.20.60Inner.60.20in.20.60InnerProductSpace.20.F0.9D.95.9C.20.F0.9D.95.9C.60/near/505651594\">said</a>:</p>\n<blockquote>\n<p>Probably not related to the issue I'm having but you're probably familiar with this bit of code. I've been trying to use</p>\n<p>rw [inner]</p>\n<p>to use the lemma </p>\n<p>âˆ€ (w z : â„‚), inner w z = ((starRingEnd â„‚) w * z).re</p>\n<p>but for whatever reason i'm always getting</p>\n<p>Inner.inner.{u_4, u_5} {ğ•œ : Type u_4} {E : Type u_5} [self : Inner ğ•œ E] : E â†’ E â†’ ğ•œ</p>\n</blockquote>\n<p>That lemma is called <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Complex.inner#doc\">docs#Complex.inner</a>.</p>",
        "id": 505652685,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741952543
    },
    {
        "content": "<p>Ahhh, thanks so much <span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> !</p>",
        "id": 505654595,
        "sender_full_name": "George Granberry",
        "timestamp": 1741953083
    }
]