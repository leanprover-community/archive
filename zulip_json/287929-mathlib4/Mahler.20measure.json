[
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/26035\">#26035</a> introduces the Mahler measure of a complex polynomial and proves its multiplicativity using recent work by <span class=\"user-mention\" data-user-id=\"679664\">@Stefan Kebekus</span></p>",
        "id": 525220203,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1750607690
    },
    {
        "content": "<p>This is the first PR of hopefully many as I have the full proof of Northcott's Theorem: there are at most finitely many integer polynomials of bounded degree and Mahler measure.</p>",
        "id": 525220330,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1750607884
    },
    {
        "content": "<p>The only thing missing is Jensen's formula which has been formalized by Stefan but it's not yet in Mathlib.</p>",
        "id": 525220721,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1750608302
    },
    {
        "content": "<p>This is great news. <span aria-label=\"congratulations\" class=\"emoji emoji-3297\" role=\"img\" title=\"congratulations\">:congratulations:</span></p>",
        "id": 525257771,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1750657250
    },
    {
        "content": "<p>I am currently cleaning my code and feeding it into MathLib. Harmonic functions are next, but the Jensen formula will probably not arrive in the library until the end of summer.</p>",
        "id": 525258007,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1750657416
    },
    {
        "content": "<p>Thanks! No problem, there’s no rush! Thanks for your work!</p>",
        "id": 525273565,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1750665147
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"626233\">@Fabrizio Barroero</span> FYI: The Jensen Formula has landed in Mathlib a few minutes ago, thanks to the help of <span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span> and others. I'd be glad if you found it useful.</p>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Complex/JensenFormula.html\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Complex/JensenFormula.html</a></p>",
        "id": 542322175,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1759250299
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"679664\">Stefan Kebekus</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mahler.20measure/near/542322175\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"626233\">Fabrizio Barroero</span> FYI: The Jensen Formula has landed in Mathlib a few minutes ago, thanks to the help of <span class=\"user-mention silent\" data-user-id=\"110050\">Sébastien Gouëzel</span> and others. I'd be glad if you found it useful.</p>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Complex/JensenFormula.html\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Complex/JensenFormula.html</a></p>\n</blockquote>\n<p>That’s great news! Thanks for your work and thanks to the reviewers as well</p>",
        "id": 542324393,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1759251011
    },
    {
        "content": "<p>In <a href=\"https://github.com/leanprover-community/mathlib4/pull/30548\">#30548</a> Jensen's formula is applied to get the usual formula for the Mahler measure:<br>\nThe Mahler measure of a polynomial is the the absolute value of its leading coefficient times  the product of the absolute values of its roots lying outside the unit disk.</p>",
        "id": 544814597,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1760466913
    },
    {
        "content": "<p>Hi all! I was attempting to use the Mahler measure with integer polynomials, but it requires the coefficients be in C. This leads to a bunch of tracking of casts.</p>\n<p>I wondered if it's possible to define the Mahler measure over a smaller algebra instead?</p>",
        "id": 563846427,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1765810790
    },
    {
        "content": "<p>I don't know much about the Mahler measure, but Mathlib has more examples where an explicit ring of coefficients is added as \"bookkeeping\", exactly to avoid casts.</p>",
        "id": 563852246,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1765811905
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"626233\">@Fabrizio Barroero</span></p>",
        "id": 563871395,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1765816650
    },
    {
        "content": "<p>In <a href=\"https://github.com/leanprover-community/mathlib4/pull/31732\">#31732</a> I added Nothcott's Theorem </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">finite_mahlerMeasure_le</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">natDegree</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Int</span><span class=\"bp\">.</span><span class=\"n\">castRingHom</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">mahlerMeasure</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">}</span>\n</code></pre></div>\n<p>and I have to say it was a little painful to juggle the casts around, although not as painful as I anticipated. </p>\n<p>In any case, I suppose one could define the Mahler Measure of a polynomial with coefficient  in any subring of  C. Something like this</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommSemiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mahlerMeasure'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">mahlerMeasure</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span><span class=\"bp\">.</span><span class=\"n\">mahlerMeasure'</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mahlerMeasure'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mahlerMeasure</span><span class=\"o\">]</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span>\n</code></pre></div>\n<p>This could go at the beginning the NumberTheory/MahlerMeasure file and one can then simplify the notation of what comes after. <br>\nI don't know it this is the right way of defining it...</p>",
        "id": 563875815,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1765817732
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"474023\">Kevin Wilson</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mahler.20measure/near/563846427\">said</a>:</p>\n<blockquote>\n<p>Hi all! I was attempting to use the Mahler measure with integer polynomials, but it requires the coefficients be in C. This leads to a bunch of tracking of casts.</p>\n<p>I wondered if it's possible to define the Mahler measure over a smaller algebra instead?</p>\n</blockquote>\n<p>By the way, I would be very interested to know about your plans of using the <code>Polynomial.mahlerMeasure</code>.</p>",
        "id": 563876310,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1765817845
    },
    {
        "content": "<p>I was going about proving some results in arithmetic statistics, and as a warm up, a standard one is \"The number of reducible polynomials of height H and degree d &gt;= 3 is bounded by H^(d - 1).\" The proof is essentially \"apply Mahler measure and its relationship to height + dyadic intervals.\"</p>\n<p>So I needed Mahler measure on Z :-)</p>\n<p>I essentially setup your example, but then I ended up copy/pasting a bunch of the lemmas as they basically all hold true, and it felt a bit wasteful.</p>",
        "id": 563894988,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1765823380
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"474023\">Kevin Wilson</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mahler.20measure/near/563894988\">said</a>:</p>\n<blockquote>\n<p>I was going about proving some results in arithmetic statistics, and as a warm up, a standard one is \"The number of reducible polynomials of height H and degree d &gt;= 3 is bounded by H^(d - 1).\" The proof is essentially \"apply Mahler measure and its relationship to height + dyadic intervals.\"</p>\n<p>So I needed Mahler measure on Z :-)</p>\n<p>I essentially setup your example, but then I ended up copy/pasting a bunch of the lemmas as they basically all hold true, and it felt a bit wasteful.</p>\n</blockquote>\n<p>Nice! That seem like a good warm up!</p>",
        "id": 563895461,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1765823541
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mahler.20measure/near/563852246\">said</a>:</p>\n<blockquote>\n<p>I don't know much about the Mahler measure, but Mathlib has more examples where an explicit ring of coefficients is added as \"bookkeeping\", exactly to avoid casts.</p>\n</blockquote>\n<p>I would love an example here!</p>",
        "id": 563932903,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1765835968
    },
    {
        "content": "<p>Group cohomology is developed not for abelian groups (as is traditional in the literature) but for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>-modules, with the output cohomology groups also being <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>-modules.</p>",
        "id": 563933133,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765836055
    },
    {
        "content": "<p>For a simpler example: we have cyclotomic polynomial over any ring <code>R</code> (that is of course just the image of the polynomials over <code>ℤ</code>).</p>",
        "id": 563995582,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1765876874
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"474023\">@Kevin Wilson</span> <span aria-label=\"up\" class=\"emoji emoji-2b06\" role=\"img\" title=\"up\">:up:</span> is the kind of example I was thinking of (-;</p>",
        "id": 563999016,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1765877925
    },
    {
        "content": "<p>In this case though, the definition needs to depend on how one embeds the ring into C. Something like this also works</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommSemiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mahlerMeasure'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">→+*</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mahlerMeasure</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span><span class=\"bp\">.</span><span class=\"n\">mahlerMeasure'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Int</span><span class=\"bp\">.</span><span class=\"n\">castRingHom</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mahlerMeasure'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mahlerMeasure</span><span class=\"o\">]</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span>\n</code></pre></div>\n<p>but I think one does not gain much cause the map has to be carried around. The version above probably woks better.</p>",
        "id": 564022331,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1765885500
    },
    {
        "content": "<p>Ok, I now took some time to actually look at the definition.<br>\n<span class=\"user-mention\" data-user-id=\"474023\">@Kevin Wilson</span> what are the results here? If you have a polynomial over <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Z</mi></mrow><annotation encoding=\"application/x-tex\">\\Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">Z</span></span></span></span>, what does that say about the Mahler measure? In which ring will it live?</p>",
        "id": 564024544,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1765886346
    },
    {
        "content": "<p>Basically all of the results proven for the Mahler measure so far hold for polynomials over Z (multiplicativity, bounds, etc).</p>\n<p>The value itself is always a real number; and I can’t think of any results off the top of my head that rely on it being in a smaller ring.</p>",
        "id": 564046681,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1765893036
    },
    {
        "content": "<p>There’s sort of two cases: Z, Q, R, and C where the norms all line up and the results are basically mutatis mutandi; or some other number ring where you have to specify the norm you’re using / which embedding into C.</p>\n<p>Z, Q, R, and C are the big use cases, so from a notation standpoint it would be nice to unify them. The others probably do require carrying around the embedding/norm.</p>",
        "id": 564048545,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1765893562
    },
    {
        "content": "<p>I think <span class=\"user-mention\" data-user-id=\"626233\">@Fabrizio Barroero</span>'s first version of <code>mahlerMeasure'</code> a few posts up, using <code>algebraMap</code> looks good. If you would also like to get <code>Real</code>-valued output, then we would need to be more careful.<br>\nIs the output real-valued as soon as the coefficients of the polynomial live in (a subring of) the real numbers?</p>",
        "id": 564057249,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1765895882
    },
    {
        "content": "<p>It is always a real number.</p>",
        "id": 564058190,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1765896147
    },
    {
        "content": "<p>I should learn how to read a type signature <span aria-label=\"see no evil\" class=\"emoji emoji-1f648\" role=\"img\" title=\"see no evil\">:see_no_evil:</span> <span aria-label=\"man facepalming\" class=\"emoji emoji-1f926-200d-2642\" role=\"img\" title=\"man facepalming\">:man_facepalming:</span></p>",
        "id": 564058422,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1765896204
    },
    {
        "content": "<p>Technically, it's value lies in the splitting field of the polynomial</p>",
        "id": 564059060,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1765896362
    },
    {
        "content": "<p>I mean... in informal maths...</p>",
        "id": 564059372,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1765896445
    },
    {
        "content": "<p>Cool. Is that already a theorem in Mathlib? Seems completely non-obvious to me, with all the integrals appearing in the definition.</p>",
        "id": 564059440,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1765896461
    },
    {
        "content": "<p>It is a consequence of this</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">mahlerMeasure_eq_leadingCoeff_mul_prod_roots</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">mahlerMeasure</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">leadingCoeff</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Multiset</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"n\">a</span><span class=\"bp\">‖</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">roots</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">prod</span>\n</code></pre></div>",
        "id": 564059714,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1765896530
    },
    {
        "content": "<p>Would it make sense to take that as the definition?</p>",
        "id": 564060475,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1765896737
    },
    {
        "content": "<p>It sounds like we could take a polynomial over <code>R</code>, and an algebra <code>A</code> over <code>R</code>, and a proof that <code>p</code> splits in <code>A</code>. And then define the Mahler measure as a term of <code>A</code>.</p>\n<p>And then prove that this is invariant under algebra homomorphisms. And if you map to <code>A = Complex</code> then you end up with some integral that also computes this value.</p>",
        "id": 564061227,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1765896918
    },
    {
        "content": "<p>But maybe I'm glossing over a detail.</p>",
        "id": 564061265,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1765896928
    },
    {
        "content": "<p>In informal maths, I do consider the second one to be the definition of Maehler measure.  Probably even without the <code>p.leadingCoeff</code> factor!</p>\n<p>EDIT: the <code>leadingCoeff</code> seems to be due to the fact that I always use it for monic polynomials... <a href=\"https://en.wikipedia.org/wiki/Mahler_measure\">https://en.wikipedia.org/wiki/Mahler_measure</a></p>",
        "id": 564061403,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1765896966
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mahler.20measure/near/564060475\">said</a>:</p>\n<blockquote>\n<p>Would it make sense to take that as the definition?</p>\n</blockquote>\n<p>It sounds reasonable. Let me try to write down some definitions and lemmas...</p>",
        "id": 564062050,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1765897127
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mahler.20measure/near/564061403\">said</a>:</p>\n<blockquote>\n<p>In informal maths, I do consider the second one to be the definition of Maehler measure.  Probably even without the <code>p.leadingCoeff</code> factor!</p>\n<p>EDIT: the <code>leadingCoeff</code> seems to be due to the fact that I always use it for monic polynomials... <a href=\"https://en.wikipedia.org/wiki/Mahler_measure\">https://en.wikipedia.org/wiki/Mahler_measure</a></p>\n</blockquote>\n<p>For me too, actually. But many books adopt the definition with the integral and then use Jensen's formula to prove the formula above...<br>\nThis is the reason why I chose that approach.</p>",
        "id": 564062578,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1765897230
    },
    {
        "content": "<p>It shouldn't matter which one is the definition (that's an implementation detail), as long as we have both equalities at our disposal.</p>",
        "id": 564071216,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1765899273
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mahler.20measure/near/564061227\">said</a>:</p>\n<blockquote>\n<p>It sounds like we could take a polynomial over <code>R</code>, and an algebra <code>A</code> over <code>R</code>, and a proof that <code>p</code> splits in <code>A</code>. And then define the Mahler measure as a term of <code>A</code>.</p>\n</blockquote>\n<p>Not quite, because there is a norm and a max involved. The statement that the Mahler measure lies in the splitting field is also not completely true because of this when the coefficients are not real, e.g., the Mahler measure of <code>X - (2 + i)</code> is <code>√5</code>, which is not in ℚ(i).</p>",
        "id": 564071742,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1765899409
    },
    {
        "content": "<p>True, one needs a norm on A of course. <br>\nAnd the values are in the image of the splitting field via the norm I guess...</p>",
        "id": 564073141,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1765899710
    },
    {
        "content": "<p>For real coefficients, the result is actually in the maximal real subfield of the splitting field (because non-real roots occur in pairs, and the product of their norms is the product of the roots).</p>",
        "id": 564073624,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1765899818
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479359\">Michael Stoll</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mahler.20measure/near/564071216\">said</a>:</p>\n<blockquote>\n<p>It shouldn't matter which one is the definition (that's an implementation detail), as long as we have both equalities at our disposal.</p>\n</blockquote>\n<p>Well, I agree, unless it influences the type signature. Atm, the type is <code>Real</code>. If we want that to be a smaller ring, then one definition might be a lot more practical than another.</p>",
        "id": 564080516,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1765901428
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479359\">Michael Stoll</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mahler.20measure/near/564071742\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mahler.20measure/near/564061227\">said</a>:</p>\n<blockquote>\n<p>It sounds like we could take a polynomial over <code>R</code>, and an algebra <code>A</code> over <code>R</code>, and a proof that <code>p</code> splits in <code>A</code>. And then define the Mahler measure as a term of <code>A</code>.</p>\n</blockquote>\n<p>Not quite, because there is a norm and a max involved.</p>\n</blockquote>\n<p>Point taken.</p>",
        "id": 564080581,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1765901442
    },
    {
        "content": "<p>I am not sure we gain anything from this</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsDomain</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Norm</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mahlerMeasure'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"o\">(</span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">leadingCoeff</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Multiset</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"n\">a</span><span class=\"bp\">‖</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">aroots</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">prod</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span><span class=\"bp\">.</span><span class=\"n\">mahlerMeasure'</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mahlerMeasure'</span><span class=\"o\">]</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">mahlerMeasure'</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Int</span><span class=\"bp\">.</span><span class=\"n\">castRingHom</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">mahlerMeasure</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mahlerMeasure'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mahlerMeasure_eq_leadingCoeff_mul_prod_roots</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">aroots_def</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">leadingCoeff_map_of_injective</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">RingHom</span><span class=\"bp\">.</span><span class=\"n\">injective_int</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Int</span><span class=\"bp\">.</span><span class=\"n\">castRingHom</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">)]</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span>\n</code></pre></div>",
        "id": 564082075,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1765901830
    },
    {
        "content": "<p>So I didn't get around to figuring out the best way to set this up yet, but I did setup a PR for the height of a polynomial in <a href=\"https://github.com/leanprover-community/mathlib4/pull/33240\">#33240</a></p>\n<p>I also have a complete proof of the asymptotics of reducible polynomials which I'll break up into a few PRs :-)</p>",
        "id": 565198034,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1766514482
    },
    {
        "content": "<p>Also, out of curiosity, I have a mostly AI generated proof (read, really long and verbose and first principles) of the fact that</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">mahlerMeasure_le_sqrt_natDegree_mul_height</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">mahlerMeasure</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">natDegree</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">height</span>\n</code></pre></div>\n<p>The current implementation has</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">mahlerMeasure_le_sum_norm_coeff</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">mahlerMeasure</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">sum</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"n\">a</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>I'm not expert enough in things like how Fourier theory works in Lean to improve the proof of the sqrt bound, but I can make a PR of it if it would be useful.</p>",
        "id": 565198529,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1766514754
    },
    {
        "content": "<p>Something similar to your <code>Polynomial.height</code> is already in Mathlib under the name of <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/Polynomial/GaussNorm.html#Polynomial.gaussNorm\">Polynomial.gaussNorm</a>.</p>",
        "id": 565427118,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1766742673
    },
    {
        "content": "<p>I am very curious to see your proof of the asymptotics!</p>",
        "id": 565427253,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1766742866
    },
    {
        "content": "<p>Oh nice! I guess height is just gaussNorm with v = id and c = 1. That’s probably the best definition then and then there can be a lemma with the simpler definition suggested by Violeta</p>",
        "id": 565448353,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1766760073
    },
    {
        "content": "<p>This is entirely tangential, but why does the MahlerMeasure file define notation for <code>BoxPoly</code> rather than just making it into a def?</p>",
        "id": 565477525,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1766791653
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"626233\">Fabrizio Barroero</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mahler.20measure/near/565427118\">said</a>:</p>\n<blockquote>\n<p>Something similar to your <code>Polynomial.height</code> is already in Mathlib under the name of <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/Polynomial/GaussNorm.html#Polynomial.gaussNorm\">Polynomial.gaussNorm</a>.</p>\n</blockquote>\n<p>As for this, it might be worth mentioning the words \"height\" and \"length\" somewhere in the docstring so that future mathematicians know where to look <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 565477548,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1766791696
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mahler.20measure/near/565477548\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"626233\">Fabrizio Barroero</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mahler.20measure/near/565427118\">said</a>:</p>\n<blockquote>\n<p>Something similar to your <code>Polynomial.height</code> is already in Mathlib under the name of <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/Polynomial/GaussNorm.html#Polynomial.gaussNorm\">Polynomial.gaussNorm</a>.</p>\n</blockquote>\n<p>As for this, it might be worth mentioning the words \"height\" and \"length\" somewhere in the docstring so that future mathematicians know where to look :)</p>\n</blockquote>\n<p>Good idea! See <a href=\"https://github.com/leanprover-community/mathlib4/pull/33338\">#33338</a></p>",
        "id": 565502895,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1766831272
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mahler.20measure/near/565477525\">said</a>:</p>\n<blockquote>\n<p>This is entirely tangential, but why does the MahlerMeasure file define notation for <code>BoxPoly</code> rather than just making it into a def?</p>\n</blockquote>\n<p>What is the advantage of making it into a def?</p>",
        "id": 565502965,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1766831397
    },
    {
        "content": "<p>A notation basically means that you're inserting that whole string of symbols as is into your theorem. A def gives you some degree of encapsulation, and is generally just more idiomatic.</p>",
        "id": 565524083,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1766859363
    },
    {
        "content": "<p>Apologies for the delays. Christmas holidays :-)</p>\n<p>The asymptotics I was building rely on an identical notion to <code>BoxPoly</code> I called <code>PolyBox</code>. It will definitely be a common notion if arithmetic statistics get added to Mathlib, so worth giving it a name.</p>\n<p>As for the <code>l^p</code> norms, I was starting to define the height as the <code>gaussNorm</code> and I was having some problems figuring out how to get <code>norm</code> packaged into a <code>FunLike F A ℝ</code> along with an instance of <code>NonnegHomClass F A ℝ</code> needed by things like <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/Polynomial/GaussNorm.html#Polynomial.gaussNorm_eq_zero_iff\"><code>gaussNorm_eq_zero_iff</code></a>. I'd appreciate any pointers on that front</p>\n<p>As for renaming <code>height</code> to something else, I figure that <code>Polynomial.supNorm</code> works? If that's still confusing with the polynomial as a function, then <code>Polynomial.coeffSupNorm</code> is more explicit. (The other <code>l^p</code> norms would have similar names.)</p>",
        "id": 565598036,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1766960038
    },
    {
        "content": "<p>is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Polynomial.gaussNorm#doc\">docs#Polynomial.gaussNorm</a> another one of those bad definitions (because it takes an argument which is a generic <code>FunLike</code>)</p>",
        "id": 565598296,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1766960496
    },
    {
        "content": "<p>Is that a known antipattern? Why if so?</p>",
        "id": 565598949,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1766961597
    },
    {
        "content": "<p>see <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/Mathlib.27s.20morphism.20hierarchy/with/558812628\">#mathlib4 &gt; Mathlib's morphism hierarchy</a></p>",
        "id": 565598971,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1766961625
    },
    {
        "content": "<p>In <a href=\"https://github.com/leanprover-community/mathlib4/pull/33326\">#33326</a> you can see that the Gauss Norm works well with an AbsoluteValue.  Tomorrow I’m gonna have a look at the norm issue.</p>",
        "id": 565599973,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1766963557
    },
    {
        "content": "<p>I think the underlying issue is that the norm on a SeminormedRing isn’t a Seminorm.</p>",
        "id": 565609727,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1766979290
    },
    {
        "content": "<p>This works</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedField</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">gaussNorm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">NormedField</span><span class=\"bp\">.</span><span class=\"n\">toAbsoluteValue</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">gaussNorm_eq</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">gaussNorm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">NormedField</span><span class=\"bp\">.</span><span class=\"n\">toAbsoluteValue</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">support</span><span class=\"bp\">.</span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">support</span><span class=\"bp\">.</span><span class=\"n\">sup'</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">coeff</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">gaussNorm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">NormedField</span><span class=\"bp\">.</span><span class=\"n\">toAbsoluteValue</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 565639847,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1767001056
    },
    {
        "content": "<p>That works, <span class=\"user-mention\" data-user-id=\"626233\">@Fabrizio Barroero</span> . Thanks much!</p>\n<p>I also needed to import <code>Mathlib.Algebra.Order.Hom.Basic</code> to get some of the nonnegative instances. I don't know if there's any documentation on the morphism hierarchy anywhere and how to work with it, but it would be super helpful to newbies like me :-)</p>",
        "id": 565687069,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1767021646
    },
    {
        "content": "<p>Back to the <code>mahlerMeasure'</code> definition :-) Now that I understand a bit more about the morphism hierarchy, perhaps this is the right definition of <code>mahlerMeasure'</code> ?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Semiring</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">FunLike</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">RingHomClass</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">)</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mahlerMeasure'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mahlerMeasure</span>\n</code></pre></div>\n<p><a href=\"https://gist.github.com/khwilson/c5363c5d6e7739c9bd4c4aa0a7df99d5\">This gist</a> has some lemmas built on it. In particular, note the typeclasses on Line 28:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedRing</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">FunLike</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">RingHomClass</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">IsometryClass</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">)</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">leadingCoeff_le_mahlerMeasure'</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">‖</span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">leadingCoeff</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">mahlerMeasure'</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>This would cover the major use cases (integer, rational, and real coefficients), but if there's a desire to cover number field coefficients specifically, then I could unbundle the norm</p>",
        "id": 565789427,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1767101810
    },
    {
        "content": "<p>I think the funlike in the first definition is an anti-pattern. <code>RingHom.map</code> should (and eventually will) be changed to take a concrete <code>RingHom</code>, so definitions using it should too.</p>",
        "id": 565796025,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1767105764
    },
    {
        "content": "<p>So to check my understanding, the definition proposed is:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Semiring</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RingHom</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">)</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mahlerMeasure'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mahlerMeasure</span>\n</code></pre></div>",
        "id": 565821119,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1767120402
    },
    {
        "content": "<p>And for the _second_ definition, the suggestion is to keep the <code>FunLike</code> since here we're layering together two <code>FunLike</code> classes?</p>",
        "id": 565822783,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1767121483
    },
    {
        "content": "<p>for definitions you shouldn't use <code>FunLike</code></p>",
        "id": 565822985,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1767121605
    },
    {
        "content": "<p>for theorems it's fine probably</p>",
        "id": 565822989,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1767121610
    },
    {
        "content": "<p>Gotcha! In that case, I can put together a PR</p>",
        "id": 565827174,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1767124366
    },
    {
        "content": "<p>Here is the promised PR: <a href=\"https://github.com/leanprover-community/mathlib4/pull/33463\">https://github.com/leanprover-community/mathlib4/pull/33463</a></p>\n<p>Not sure I'm correctly utilizing the morphism hierarchy here, but I defer to <span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> and others on that front.</p>",
        "id": 565991777,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1767290298
    },
    {
        "content": "<p>I think we generally like to avoid primed names, and more so for <code>def</code>s. Also, is there no way to unify both of these definitions? Perhaps by requiring an <code>Algebra R ℂ</code> instance or something similar?</p>",
        "id": 566118513,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1767408329
    },
    {
        "content": "<p>In fact, why can't we take <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Polynomial.mahlerMeasure_eq_leadingCoeff_mul_prod_roots#doc\">docs#Polynomial.mahlerMeasure_eq_leadingCoeff_mul_prod_roots</a> as the definition of the Mahler measure? That should merge your two definitions.</p>",
        "id": 566118627,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1767408562
    },
    {
        "content": "<p>In <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Polynomial.mahlerMeasure_eq_leadingCoeff_mul_prod_roots#doc\">docs#Polynomial.mahlerMeasure_eq_leadingCoeff_mul_prod_roots</a> the norm of the leading coefficient depends on the choice of embedding</p>\n<p>AFAICT, you can:</p>\n<ul>\n<li>Require the user supply a map from the base ring to <code>Complex</code> and carry it around in the notation (essentially, make <code>mahlerMeasure'</code> the main definition). This leads to a syntactic annoyance for users, but perhaps a docstring is sufficient to elucidate? (E.g., \"This notion is most commonly used for polynomials over <code>Complex</code> or <code>Int</code>. In those cases, ...\") OR</li>\n<li>Have the current setup which makes it relatively easy for users but requires a <code>'</code> definition.</li>\n</ul>",
        "id": 566125595,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1767418240
    },
    {
        "content": "<p>Often auxillary definitions are named <code>...Aux</code> and made <code>private</code> declarations</p>",
        "id": 566125773,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1767418519
    },
    {
        "content": "<p>Making <code>mahlerMeasure'</code> the main definition seems reasonable to me. To recover the complex case you just write <code>.id</code> for the map field.</p>",
        "id": 566183531,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1767482510
    },
    {
        "content": "<p>If p is a polynomial with integer coefficients, what is the point of replacing <code>(p.map (Int.castRingHom ℂ)).mahlerMeasure</code> by <code>p.mahlerMeasure (Int.castRingHom ℂ)</code>?</p>",
        "id": 566187604,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1767487837
    },
    {
        "content": "<p>Maybe it's a mild irritant, but lemmas like <a href=\"https://github.com/leanprover-community/mathlib4/pull/33463/files#diff-cea83942c2082530d7ca119ca8b434ad91e371b35fbe6e5a48672c3675fd27c3R386\">this one</a> that package up casts I personally found useful in trying to put together the asymptotics on integer polynomials.</p>\n<p><code>(p.map (Int.castRingHom ℂ)).mahlerMeasure</code> (I think) means you need to figure out the casts; <code>p.mahlerMeasure (Int.castRingHom ℂ)</code> can package them up for the user.</p>",
        "id": 566188245,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1767488442
    },
    {
        "content": "<p>I see, but then isn't it possible to make this independent of v?<br>\n<span class=\"user-mention\" data-user-id=\"459227\">@Violeta Hernández</span> was suggesting an <code>Algebra A ℂ</code> instance above...</p>",
        "id": 566188924,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1767489430
    },
    {
        "content": "<p><code>Algebra</code> might be too weak, I don't think that would preserve the norm in the general case</p>",
        "id": 566188959,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1767489503
    },
    {
        "content": "<p>You are right. There is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=NormedAlgebra#doc\">docs#NormedAlgebra</a> but it seems to require the base ring to be a field, unfortunately.</p>",
        "id": 566189305,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1767489892
    },
    {
        "content": "<p>I did look into that possibility earlier and there were two potential problems:</p>\n<ol>\n<li>\n<p>As you note NormedAlgebra and its ilk require the base ring to be a field. I didn’t try to figure out why, but even if it’s not necessary changing that to require only a ring structure would be a big surgery.</p>\n</li>\n<li>\n<p>If you wanted to work with polynomials over a number ring, you’d need to specify which embedding into C you’re taking. I only have worked with the Mahler measure over Z so I don’t know if this would be a big inconvenience for future formalization</p>\n</li>\n</ol>",
        "id": 566192533,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1767494145
    },
    {
        "content": "<p>I see the point now and I agree. Thanks.<br>\nI still think it would be nice to keep the original definition and an alternative one for general rings that embed into C.</p>",
        "id": 566214780,
        "sender_full_name": "Fabrizio Barroero",
        "timestamp": 1767524008
    }
]