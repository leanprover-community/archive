[
    {
        "content": "<p>Hi all,</p>\n<p>I'm trying to prove <code>BddAbove S</code> for <code>S : Set Ordinal.{u}</code> using <code>Ordinal.bddAbove_iff_small</code>. This leads to proving <code>Small.{u} (Subtype S)</code>. My strategy involves showing <code>S ⊆ Iic (sSup S)</code> and then using <code>small_subset</code> with <code>Ordinal.small_Iic (sSup S)</code>.</p>\n<p>However, proving <code>x ≤ sSup S</code> using <code>le_sSup</code> fails:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">SetTheory</span><span class=\"bp\">.</span><span class=\"n\">Ordinal</span><span class=\"bp\">.</span><span class=\"n\">Arithmetic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">SetTheory</span><span class=\"bp\">.</span><span class=\"n\">Ordinal</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">universes</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Ordinal</span>\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">Ordinal_set_is_bddAbove_MWE</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Universe</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S_set</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Ordinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BddAbove</span><span class=\"w\"> </span><span class=\"n\">S_set</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ordinal</span><span class=\"bp\">.</span><span class=\"n\">bddAbove_iff_small</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"c1\">-- Goal: Small.{u} (Subtype S_set)</span>\n\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">S_is_subset_Iic_sSup</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">S_set</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">Iic</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sSup</span><span class=\"w\"> </span><span class=\"n\">S_set</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">hx_in_S</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">le_sSup</span><span class=\"w\"> </span><span class=\"n\">hx_in_S</span><span class=\"w\"> </span><span class=\"c1\">-- Fails: \"failed to synthesize CompleteSemilatticeSup.{u + 1} Ordinal.{u}\"</span>\n\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">small_Iic_sSup_inst</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Iic</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sSup</span><span class=\"w\"> </span><span class=\"n\">S_set</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">infer_instance</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">small_subset</span><span class=\"w\"> </span><span class=\"n\">S_is_subset_Iic_sSup</span>\n</code></pre></div>\n<p>The error \"failed to synthesize <code>CompleteSemilatticeSup.{u + 1} Ordinal.{u}</code>\" occurs at <code>le_sSup</code>. My <code>Mathlib.SetTheory.Ordinal.Basic</code> has <code>ConditionallyCompleteLinearOrderBot Ordinal</code>, but <code>CompleteLinearOrder Ordinal</code> (which would imply <code>CompleteSemilatticeSup</code>) doesn't seem to be effective or present in my setup for <code>le_sSup</code> to work.<br>\n<strong>Questions:</strong></p>\n<ol>\n<li>Is <code>Ordinal.{u}</code> typically a <code>CompleteLinearOrder</code> providing <code>CompleteSemilatticeSup</code> in recent Mathlib4? Which import ensures this?</li>\n<li>If not, what's the canonical way to prove <code>∀ x ∈ S, x ≤ sSup S</code> for <code>S : Set Ordinal.{u}</code> when <code>Ordinal</code> is <code>ConditionallyCompleteLinearOrderBot</code>?</li>\n</ol>\n<p>My Mathlib version is 4.20.0-rc5. Thanks!</p>",
        "id": 520325427,
        "sender_full_name": "Hunches Freeze",
        "timestamp": 1748206760
    },
    {
        "content": "<ul>\n<li>\n<p>Lean's type theory doesn't allow you to quantify over universes, so <code>u : Universe</code> is nonsense: it introduces an implicit type <code>Universe</code> and make <code>u</code> a term of the type, which is different from the <code>u</code> in <code>Ordinal.{u}</code> which come from <code>universe u</code>.</p>\n</li>\n<li>\n<p><code>Ordinal</code> isn't a <code>CompleteSemilatticeSup</code> because the supremum may not exist in the universe. It's a conditional complete linear order as you already found out, so you can use <code>le_csSup</code> but not <code>le_sSup</code>. The code compiles if you replace <code>exact le_sSup hx_in_S</code> by <code>refine le_csSup ?_ hx_in_S</code>, but I don't think you can solve the resulting sorry <code>BddAbove.{u + 1} S_set</code>.</p>\n</li>\n</ul>",
        "id": 520327159,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1748208315
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"919632\">Hunches Freeze</span> has marked this topic as resolved.</p>",
        "id": 520527974,
        "sender_full_name": "Notification Bot",
        "timestamp": 1748292470
    }
]