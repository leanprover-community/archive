[
    {
        "content": "<p>Can I stop Infoview from displaying <code>.1</code> and <code>.2</code> please?<br>\nI want to see <code>.fst</code> and <code>.snd</code> and another time <code>.left</code> and <code>.right</code> and so on.</p>",
        "id": 491490273,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1735728429
    },
    {
        "content": "<p>i’m also interested in this</p>",
        "id": 491490784,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1735728903
    },
    {
        "content": "<p>I’m not sure you can unregister a delaborator, but you can shadow it by declaring a new one later:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">PrettyPrinter</span><span class=\"w\"> </span><span class=\"n\">Delaborator</span>\n<span class=\"sd\">/-- Delaborator for `Prod.fst x` as `x.fst`. -/</span>\n<span class=\"kd\">@[</span><span class=\"n\">app_delab</span><span class=\"w\"> </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">fst</span><span class=\"kd\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">delabProdFst</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Delab</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">withOverApp</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">SubExpr</span><span class=\"bp\">.</span><span class=\"n\">withAppArg</span><span class=\"w\"> </span><span class=\"n\">delab</span>\n<span class=\"w\">  </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"bp\">$</span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.$</span><span class=\"o\">(</span><span class=\"n\">mkIdent</span><span class=\"w\"> </span><span class=\"ss\">`fst</span><span class=\"o\">))</span>\n\n<span class=\"sd\">/-- Delaborator for `Prod.snd x` as `x.snd`. -/</span>\n<span class=\"kd\">@[</span><span class=\"n\">app_delab</span><span class=\"w\"> </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">snd</span><span class=\"kd\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">delabProdSnd</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Delab</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">withOverApp</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">SubExpr</span><span class=\"bp\">.</span><span class=\"n\">withAppArg</span><span class=\"w\"> </span><span class=\"n\">delab</span>\n<span class=\"w\">  </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"bp\">$</span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.$</span><span class=\"o\">(</span><span class=\"n\">mkIdent</span><span class=\"w\"> </span><span class=\"ss\">`snd</span><span class=\"o\">))</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span>\n</code></pre></div>",
        "id": 491505678,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1735743224
    },
    {
        "content": "<p>I guess I'll redeclare all of them then.</p>",
        "id": 491597431,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1735817614
    },
    {
        "content": "<p>This topic was moved here from <a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/Infoview.20.02klzzwxh.3A0000.03.20and.20.02klzzwxh.3A0001.03\">#lean4 &gt; Infoview <code>.1</code> and <code>.2</code></a> by <span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span>.</p>",
        "id": 491810260,
        "sender_full_name": "Notification Bot",
        "timestamp": 1735937049
    },
    {
        "content": "<p>Overriding delaborators works, but it's not a great solution (it's a bit delicate) — why not make the mathlib ones be configurable with a new <code>pp</code> option?</p>\n<p>As far as I know, only <code>Prod.fst</code> and <code>Prod.snd</code> have such delaborators. Where are you seeing <code>.left</code> and <code>.right</code> print as <code>.1</code> and <code>.2</code>?</p>",
        "id": 491810502,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1735937179
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/20455\">mathlib4#20455</a></p>",
        "id": 491812672,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1735938369
    },
    {
        "content": "<p>By the way, you can disable delaborators locally for a given module.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n<span class=\"c1\">-- x.1 : ℕ</span>\n\n<span class=\"kn\">attribute</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">-</span><span class=\"n\">delab</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">delabProdFst</span><span class=\"w\"> </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">delabProdSnd</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n<span class=\"c1\">-- x.fst : ℕ</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span>\n<span class=\"c1\">-- x.snd : ℕ</span>\n</code></pre></div>",
        "id": 491812806,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1735938457
    },
    {
        "content": "<p>It would be cool if the infoview had some way to inspect which delaborator was responsible for a certain pretty-printed syntax, assuming that's a meaningful question</p>",
        "id": 491819909,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1735942984
    },
    {
        "content": "<p>That's (mostly) meaningful, and it could be recorded. Maybe the Infoview could have a debug option to enable viewing this information (if/when it exists)?</p>",
        "id": 491820511,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1735943402
    },
    {
        "content": "<p>[edit: I already have <code>pp.numericProj.prod</code> available. Thank a lot!]</p>",
        "id": 494111062,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1737023263
    }
]