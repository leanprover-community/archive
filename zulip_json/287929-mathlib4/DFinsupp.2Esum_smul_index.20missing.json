[
    {
        "content": "<p><code>DFinsupp</code> has some <code>sum_X_index</code> lemmas, like <code>Finsupp</code>, for example <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=DFinsupp.sum_add_index#doc\">docs#DFinsupp.sum_add_index</a> (compare to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finsupp.sum_add_index#doc\">docs#Finsupp.sum_add_index</a>), but the counterpart for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finsupp.sum_smul_index#doc\">docs#Finsupp.sum_smul_index</a> seems to be missing.<br>\nIs there some reason for that, or should it be added?</p>",
        "id": 440603331,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1716607323
    },
    {
        "content": "<p>My guess: the only reason is that no one needed it up until now.</p>",
        "id": 440667395,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1716674817
    },
    {
        "content": "<p>So, please PR it!</p>",
        "id": 440669084,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1716676862
    },
    {
        "content": "<p>Where should this result be placed?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">δ</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"o\">]</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">DFinsupp</span><span class=\"bp\">.</span><span class=\"n\">sum_smul_index</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">AddMonoid</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Monoid</span><span class=\"w\"> </span><span class=\"n\">δ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">DistribMulAction</span><span class=\"w\"> </span><span class=\"n\">δ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Decidable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">Π₀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">δ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">sum</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"bp\">.</span><span class=\"n\">sum</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">sum_mapRange_index</span><span class=\"w\"> </span><span class=\"n\">h0</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">info: [Mathlib.Algebra.DirectSum.Basic,</span>\n<span class=\"sd\"> Mathlib.Data.DFinsupp.Interval,</span>\n<span class=\"sd\"> Mathlib.Data.DFinsupp.Multiset,</span>\n<span class=\"sd\"> Mathlib.LinearAlgebra.DFinsupp]</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"bp\">#</span><span class=\"n\">find_home</span><span class=\"w\"> </span><span class=\"n\">DFinsupp</span><span class=\"bp\">.</span><span class=\"n\">sum_smul_index</span>\n</code></pre></div>",
        "id": 485236944,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1732979891
    },
    {
        "content": "<p>How is this pulling in <code>Mathlib.Algebra.DirectSum.Basic</code>? That seems weird.</p>",
        "id": 485746909,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1733197135
    },
    {
        "content": "<p>It works fine without the import</p>",
        "id": 485843819,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733230468
    },
    {
        "content": "<p><code>find_home</code> still suggests it after replacing the proof with <code>sorry</code>, and</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Expr</span><span class=\"bp\">.</span><span class=\"n\">getUsedConstants</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">(</span><span class=\"n\">type_of</span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">DFinsupp</span><span class=\"bp\">.</span><span class=\"n\">sum_smul_index</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"mi\">0</span><span class=\"o\">})</span>\n</code></pre></div>\n<p>doesn't mention DirectSum</p>",
        "id": 485844631,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733230659
    },
    {
        "content": "<p>It's probably because it imports both sum and smul</p>",
        "id": 485852067,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1733232531
    },
    {
        "content": "<p>Ah, I think Kim and I were confusing this with <code>min_imports</code>?</p>",
        "id": 485852442,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733232627
    },
    {
        "content": "<p>Ah, indeed. If this statement can happily live in <code>Mathlib.LinearAlgebra.DFinsupp</code> that seems the most natural out of those four.</p>",
        "id": 485965957,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1733264741
    },
    {
        "content": "<p>Arguably we should create <code>Mathlib.Algebra.BigOperators.DFinsupp</code> for parity with <code>Finsupp</code></p>",
        "id": 485966357,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733264887
    },
    {
        "content": "<p>But that could be a follow-up CL.</p>",
        "id": 485966409,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733264914
    }
]