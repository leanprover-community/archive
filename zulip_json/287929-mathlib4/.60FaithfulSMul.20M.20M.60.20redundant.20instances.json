[
    {
        "content": "<p>Given a type <code>M</code> with <code>Mul M</code>, one derives an instance <code>SMul M M</code> by <code>m • n = m * n</code>.</p>\n<p>If the operation has a (right) unital element, one finds that the smultiplication is faithful: if for <code>m₁ m₂ : M</code>, we have that when <code>∀ (a : G), m₁ • a = m₂ • a</code>, we find that <code>m₁ = m₁ * 1 = m₁ • 1 = m₂ • 1 = m₂ * 1 = m₂</code>. If instead we assume that the multiplication is right cancellative, we also find that the smultiplication is faithful by specializing our assumption with any known element (,including but not limited to <code>m₁</code> and <code>m₂</code>), and cancelling on the right.<br>\nNote that these conditions (has unit/is right cancellative) are not equivalent: to any structure with non-right-cancellative multiplication you can add a new unit, and the positive natural numbers with addition is right-cancellative without a unit.</p>\n<p>upon looking at the current state of mathlib in this context, i was surprised to find the instances <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=RightCancelMonoid.faithfulSMul#doc\">docs#RightCancelMonoid.faithfulSMul</a> (redundant as right cancellative monoids have a unit) and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsRightCancelMulZero.faithfulSMul#doc\">docs#IsRightCancelMulZero.faithfulSMul</a> (redundant as monoids with zero have a unit), which are both subsumed by <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=instFaithfulSMul#doc\">docs#instFaithfulSMul</a> (<code>MulOneClass</code>es have <code>FaithfulSMul</code>).</p>\n<ul>\n<li>Should the redundant (and non-maximally general) instances be removed?</li>\n<li>Should an instance assuming only <code>Mul</code> and <code>IsRightCancelMul</code> be added?</li>\n</ul>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>But why not unify these proofs?</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<p>the common thread of the (has a unit, or is right cancellative)/proofs is that the assumptions they make allow one to prove <code>∀ m₁ m₂ : M, ∃ m₃, (m₁ * m₃ = m₂ * m₃ → m₁ = m₂)</code>, or in words \"for every pair of elements, there is a witness such that the effect of those elements on the witness decides their equality\". This statement is classically equivalent to \"the smultiplication is faithful\", but appears to be intuitionistically stronger. I hope people will agree with me if i say it isn't sensible to make an instance which unifies the logic here.</p>\n</div></div>",
        "id": 571506305,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1770059311
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/channel/287929-mathlib4/topic/.60FaithfulSMul.20M.20M.60.20redundant.20instances/near/571506305\">said</a>:</p>\n<blockquote>\n<p>Should the redundant (and non-maximally general) instances be removed?</p>\n</blockquote>\n<p>Yes, assuming that nothing breaks when you do so. It's possible but unlikely that the instances are needed before they can be set up in the correct generality.</p>",
        "id": 571532210,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1770069137
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/34789\">#34789</a></p>",
        "id": 571791967,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1770163661
    }
]