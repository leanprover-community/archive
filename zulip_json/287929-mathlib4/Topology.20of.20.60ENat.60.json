[
    {
        "content": "<p>Hello!<br>\nI noticed that there is no topology instantiated for <code>ENat</code>. I need the order topology for a project (neighberhoods of infinity are sets which contain all big enough integers), which makes it a compact space (it's the one-point compactification of <code>Nat</code>). However one could prefer to use the discrete topology instead. My questions are:</p>\n<ol>\n<li>Is there a drawback defining one of the instance compared to defining none and always use the topology locally?</li>\n<li>If not, could I define the instance with the order topology, or should I use the topology locally?</li>\n</ol>",
        "id": 454270808,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1721990983
    },
    {
        "content": "<p>I did this for my matroid repo -  see <a href=\"https://github.com/apnelson1/Matroid/blob/main/Matroid/ForMathlib/ENatTopology.lean\">here</a>. I never got round to PRing it and it’s a few months stale, but I would love to see someone pick it up!</p>",
        "id": 454275528,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1721992730
    },
    {
        "content": "<p>(It was produced by cribbing from the equivalent file for <code>ENNReal</code>)</p>",
        "id": 454275774,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1721992809
    },
    {
        "content": "<p>To answer your question, I think the discrete topology is probably not the right choice. The order topology allows arbitrary sums of terms in <code>ENat</code> to behave correctly with <code>tsum</code>.</p>",
        "id": 454276237,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1721993019
    },
    {
        "content": "<p>Thanks for your answer!</p>\n<p><span class=\"user-mention silent\" data-user-id=\"329425\">Peter Nelson</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Topology.20of.20.60ENat.60/near/454275528\">said</a>:</p>\n<blockquote>\n<p>I did this for my matroid repo - see <a href=\"https://github.com/apnelson1/Matroid/blob/main/Matroid/ForMathlib/ENatTopology.lean\">here</a>.</p>\n</blockquote>\n<p>I only need the very basics, so your file has everything (and much more). However I don't think I will be able to deal with such a huge PR I didn't right. Would it be ok for you if I only PR the very basic results? (for now at least)</p>",
        "id": 454279613,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1721994157
    },
    {
        "content": "<p>I am pretty sure <span class=\"user-mention\" data-user-id=\"519559\">@Dagur Asgeirsson</span> must have done that.</p>",
        "id": 454283231,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1721995136
    },
    {
        "content": "<p>In fact I discovered <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=OnePoint#doc\">docs#OnePoint</a>, which has everything I want except T2 instance, which I'm adding now. It makes more sense in what I'm doing, although of course it's the same topology for <code>ENat</code>.</p>",
        "id": 454299796,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1722000885
    },
    {
        "content": "<p>T2 is certainly already there, the file <code>Mathlib.Topology.Category.LightProfinite.Sequence</code> defines the light profinite set <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">N</mi><mo>∪</mo><mo stretchy=\"false\">{</mo><mi mathvariant=\"normal\">∞</mi><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{N} \\cup \\{\\infty\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∪</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">∞</span><span class=\"mclose\">}</span></span></span></span> as the one point compactification of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">N</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{N}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">N</span></span></span></span>. <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=LightProfinite.continuous_iff_convergent#doc\">docs#LightProfinite.continuous_iff_convergent</a> proves that a function out of it is continuous iff the corresponding sequence converges to the value at <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>.</p>",
        "id": 454306705,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1722002932
    },
    {
        "content": "<p>This is also in Mathlib.Topology.Compactification.OnePoint as a matter of fact. Anyway I meant the T2 instance in the general case of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=OnePoint#doc\">docs#OnePoint</a>.</p>",
        "id": 454308885,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1722003578
    },
    {
        "content": "<p>It would make sense to move the <code>MetrizableSpace</code> instance to a different file if you are going to use <code>OnePoint \\N</code> without mentioning <code>LightProfinite</code></p>",
        "id": 454309067,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1722003610
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 454333309,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1722011287
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"329425\">Peter Nelson</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Topology.20of.20.60ENat.60/near/454275528\">said</a>:</p>\n<blockquote>\n<p>I did this for my matroid repo -  see <a href=\"https://github.com/apnelson1/Matroid/blob/main/Matroid/ForMathlib/ENatTopology.lean\">here</a>. I never got round to PRing it and it’s a few months stale, but I would love to see someone pick it up!</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span>  The proof of <a href=\"https://github.com/leanprover-community/mathlib4/pull/15344\">#15344</a> will become:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">iSup_add</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ι</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"bp\">∞</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"bp\">∞</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"bp\">⨆</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⨆</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Monotone</span><span class=\"bp\">.</span><span class=\"n\">map_iSup_of_continuousAt'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">continuousAt_id</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">continuousAt_const</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span>\n<span class=\"w\">    </span><span class=\"n\">monotone_id</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">monotone_const</span>\n</code></pre></div>\n<p>After porting this, so I suggest not going the route in <a href=\"https://github.com/leanprover-community/mathlib4/pull/15344\">#15344</a>.</p>",
        "id": 455447883,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1722448203
    },
    {
        "content": "<p>One option is to make <a href=\"https://github.com/leanprover-community/mathlib4/pull/15344\">#15344</a> depend on <a href=\"https://github.com/leanprover-community/mathlib4/pull/15380\">#15380</a>, which is a partial port of Peter's code, just enough to make the proof above work.</p>",
        "id": 455459349,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1722451754
    },
    {
        "content": "<p>Thanks, that's great!</p>",
        "id": 455460088,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722452090
    },
    {
        "content": "<p>Indeed, with  <a href=\"https://github.com/leanprover-community/mathlib4/pull/15380\">#15380</a> I don’t even strictly need <code>iSup_add</code> . Thanks! (Is it expected that the <code>continuity</code> tactic won’t solve the first goal?)</p>",
        "id": 463188488,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1723994334
    },
    {
        "content": "<p>Does <code>fun_prop</code> work?</p>",
        "id": 463202388,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1723999700
    },
    {
        "content": "<p>Indeed, <code>fun_prop</code> can solve</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"n\">ContinuousAt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⨆</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"o\">(</span><span class=\"bp\">↑</span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>It does not solve</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"n\">Monotone</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">n</span>\n</code></pre></div>\n<p>though, because </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"ss\">`Monotone</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"ss\">`fun_prop</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">goal!</span><span class=\"w\"> </span><span class=\"n\">Maybe</span><span class=\"w\"> </span><span class=\"n\">you</span><span class=\"w\"> </span><span class=\"n\">forgot</span><span class=\"w\"> </span><span class=\"n\">marking</span><span class=\"w\"> </span><span class=\"ss\">`Monotone</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"kd\">@[</span><span class=\"n\">fun_prop</span><span class=\"kd\">]</span><span class=\"bp\">`.</span>\n</code></pre></div>\n<p>Is there a reason why continuity is monotonicity isn’t a <code>fun_prop</code> goal?</p>",
        "id": 463227960,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1724009161
    },
    {
        "content": "<p>Nobody's implemented it yet</p>",
        "id": 463228962,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1724009650
    },
    {
        "content": "<p>Good reason, as usual :-)</p>",
        "id": 463228969,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1724009666
    }
]