[
    {
        "content": "<p>On a fresh clone of mathlib I get the following message.</p>\n<blockquote>\n<p>PS C:\\Users\\Mohanad\\LeanStuff&gt; git clone git@github.com:leanprover-community/mathlib4.git<br>\nCloning into 'mathlib4'...<br>\nremote: Enumerating objects: 93846, done.<br>\nremote: Counting objects: 100% (11031/11031), done.<br>\nremote: Compressing objects: 100% (1663/1663), done.<br>\nremote: Total 93846 (delta 10317), reused 9419 (delta 9366), pack-reused 82815<br>\nReceiving objects: 100% (93846/93846), 40.57 MiB | 2.53 MiB/s, done.<br>\nResolving deltas: 100% (70747/70747), done.<br>\nUpdating files: 100% (3634/3634), done.<br>\nPS C:\\Users\\Mohanad\\LeanStuff&gt; cd .\\mathlib4\\<br>\nPS C:\\Users\\Mohanad\\LeanStuff\\mathlib4&gt; lake exe cache get<br>\ninfo: cloning <a href=\"https://github.com/leanprover/std4\">https://github.com/leanprover/std4</a> to .\\lake-packages\\std<br>\ninfo: cloning <a href=\"https://github.com/gebner/quote4\">https://github.com/gebner/quote4</a> to .\\lake-packages\\Qq<br>\ninfo: cloning <a href=\"https://github.com/JLimperg/aesop\">https://github.com/JLimperg/aesop</a> to .\\lake-packages\\aesop<br>\ninfo: cloning <a href=\"https://github.com/mhuisi/lean4-cli.git\">https://github.com/mhuisi/lean4-cli.git</a> to .\\lake-packages\\Cli<br>\ninfo: cloning <a href=\"https://github.com/EdAyers/ProofWidgets4\">https://github.com/EdAyers/ProofWidgets4</a> to .\\lake-packages\\proofwidgets<br>\ninfo: Downloading proofwidgets/v0.0.11/windows-64.tar.gz<br>\ninfo: Unpacking proofwidgets/v0.0.11/windows-64.tar.gz<br>\ninfo: [1/9] Building Cache.IO<br>\ninfo: [2/9] Compiling Cache.IO<br>\ninfo: [2/9] Building Cache.Hashing<br>\ninfo: [3/9] Compiling Cache.Hashing<br>\ninfo: [3/9] Building Cache.Requests<br>\ninfo: [6/9] Compiling Cache.Requests<br>\ninfo: [6/9] Building Cache.Main<br>\ninfo: [7/9] Compiling Cache.Main<br>\ninfo: [9/9] Linking cache.exe<br>\nleantar is too old; downloading more recent version<br>\nuncaught exception: no such file or directory (error code: 2)</p>\n</blockquote>\n<p>There is no cache applied and starting vscode triggers a full rebuild.</p>",
        "id": 376569755,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689754449
    },
    {
        "content": "<p>This is on Windows 10 using Powershell terminal</p>",
        "id": 376569945,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689754499
    },
    {
        "content": "<p>this was <a href=\"https://github.com/leanprover-community/mathlib4/pull/5985\">#5985</a>, it should be fixed on master</p>",
        "id": 376571557,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689754814
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> By the way, the \"leantar is too old\" message doesn't really seem to have any purpose; unlike curl, we don't expect most people to already have leantar in their PATH</p>",
        "id": 376573220,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1689755177
    },
    {
        "content": "<p>the message will make more sense once they already have a leantar version</p>",
        "id": 376573399,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689755218
    },
    {
        "content": "<p>I think it is useful to notify that we're downloading another leantar</p>",
        "id": 376573513,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689755242
    },
    {
        "content": "<p>there is already another leantar bump on the queue, so anyone who has the new cache will be seeing the message again for leantar 0.1.4 and it won't be a lie this time</p>",
        "id": 376573792,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689755303
    },
    {
        "content": "<p>Then perhaps a simple \"downloading new version of leantar\"? The current message sounds like a warning, as exhibited by this thread's title</p>",
        "id": 376573898,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1689755333
    },
    {
        "content": "<p>how about <code>note: leantar out of date, downloading leantar 0.1.4</code></p>",
        "id": 376574206,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689755400
    },
    {
        "content": "<p>I don't see the need for the first part. It will still be inaccurate for first-time users who are most prone to confusion</p>",
        "id": 376574559,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1689755477
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/287929-mathlib4/topic/leantar.20too.20old.20.28lean.20exe.20cache.20get.20not.20working.29/near/376571557\">said</a>:</p>\n<blockquote>\n<p>this was <a href=\"https://github.com/leanprover-community/mathlib4/pull/5985\">#5985</a>, it should be fixed on master</p>\n</blockquote>\n<p>Just tried it about 2 mins ago<br>\nStill the same</p>",
        "id": 376576258,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689755841
    },
    {
        "content": "<p>What directory is it looking for?</p>",
        "id": 376576572,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689755909
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">leantar</span> <span class=\"n\">is</span> <span class=\"n\">too</span> <span class=\"n\">old</span><span class=\"bp\">;</span> <span class=\"n\">downloading</span> <span class=\"n\">more</span> <span class=\"n\">recent</span> <span class=\"n\">version</span>\n<span class=\"n\">uncaught</span> <span class=\"n\">exception</span><span class=\"o\">:</span> <span class=\"n\">no</span> <span class=\"n\">such</span> <span class=\"n\">file</span> <span class=\"n\">or</span> <span class=\"n\">directory</span> <span class=\"o\">(</span><span class=\"n\">error</span> <span class=\"n\">code</span><span class=\"o\">:</span> <span class=\"mi\">2</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 376576634,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689755921
    },
    {
        "content": "<p>option <code>--verbose</code> on lake displays no extra information</p>",
        "id": 376576779,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689755946
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>PS C:\\Users\\Mohanad\\LeanStuff\\mgrave&gt; git clone https://github.com/leanprover-community/mathlib4\nCloning into 'mathlib4'...\nremote: Enumerating objects: 93851, done.\nremote: Counting objects: 100% (11261/11261), done.\nremote: Compressing objects: 100% (1711/1711), done.\nremote: Total 93851 (delta 10524), reused 9601 (delta 9548), pack-reused 82590\nReceiving objects: 100% (93851/93851), 40.75 MiB | 3.46 MiB/s, done.\nResolving deltas: 100% (70720/70720), done.\nUpdating files: 100% (3634/3634), done.\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave&gt; cd .\\mathlib4\\\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave\\mathlib4&gt; lake exe cache get!\ninfo: cloning https://github.com/leanprover/std4 to .\\lake-packages\\std\ninfo: cloning https://github.com/gebner/quote4 to .\\lake-packages\\Qq\ninfo: cloning https://github.com/JLimperg/aesop to .\\lake-packages\\aesop\ninfo: cloning https://github.com/mhuisi/lean4-cli.git to .\\lake-packages\\Cli\ninfo: cloning https://github.com/EdAyers/ProofWidgets4 to .\\lake-packages\\proofwidgets\ninfo: Downloading proofwidgets/v0.0.11/windows-64.tar.gz\ninfo: Unpacking proofwidgets/v0.0.11/windows-64.tar.gz\ninfo: [1/9] Building Cache.IO\ninfo: [2/9] Compiling Cache.IO\ninfo: [2/9] Building Cache.Hashing\ninfo: [3/9] Compiling Cache.Hashing\ninfo: [3/9] Building Cache.Requests\ninfo: [6/9] Compiling Cache.Requests\ninfo: [6/9] Building Cache.Main\ninfo: [7/9] Compiling Cache.Main\ninfo: [9/9] Linking cache.exe\nleantar is too old; downloading more recent version\nuncaught exception: no such file or directory (error code: 2)\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave\\mathlib4&gt; lake --verbose exe cache get!\nleantar is too old; downloading more recent version\nuncaught exception: no such file or directory (error code: 2)\n</code></pre></div>",
        "id": 376576913,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689755969
    },
    {
        "content": "<p>do you have the same symptoms as reported on <a href=\"https://github.com/leanprover-community/mathlib4/pull/5984\">#5984</a>? What <code>leantar*</code> files are in the <code>$HOME/.cache/mathlib</code> directory?</p>",
        "id": 376577054,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689755996
    },
    {
        "content": "<p>it's most likely looking for <code>leantar.exe</code>, or some messed up spelling of that</p>",
        "id": 376577570,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689756099
    },
    {
        "content": "<p>The version in <code>.cache</code> is 0.1.4</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>PS C:\\Users\\Mohanad\\LeanStuff\\mgrave\\mathlib4&gt; cd .\\.cache\\\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave\\mathlib4\\.cache&gt; dir\n\n    Directory: C:\\Users\\Mohanad\\LeanStuff\\mgrave\\mathlib4\\.cache\n\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----         7/19/2023  11:37 AM         643578 leantar-0.1.4.exe.zip\n-a----         7/19/2023   5:14 AM        1540096 leantar.exe\n</code></pre></div>",
        "id": 376579473,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689756464
    },
    {
        "content": "<p>After runnig expand archive it seems to work</p>",
        "id": 376580063,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689756570
    },
    {
        "content": "<p>Not ignore that still fails</p>",
        "id": 376580175,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689756595
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>PS C:\\Users\\Mohanad\\LeanStuff\\mgrave\\mathlib4\\.cache&gt; Expand-Archive .\\leantar-0.1.4.exe.zip\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave\\mathlib4\\.cache&gt; dir\n\n\n    Directory: C:\\Users\\Mohanad\\LeanStuff\\mgrave\\mathlib4\\.cache\n\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\nd-----         7/19/2023  11:48 AM                leantar-0.1.4.exe\n-a----         7/19/2023  11:37 AM         643578 leantar-0.1.4.exe.zip\n-a----         7/19/2023   5:14 AM        1540096 leantar.exe\n\n\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave\\mathlib4\\.cache&gt; cd ..\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave\\mathlib4&gt; lake exe cache get!\nAttempting to download 3589 file(s)\nDownloaded: 3589 file(s) [attempted 3589/3589 = 100%] (100% success)\nDecompressing 3589 file(s)\nuncaught exception: input/output error (error code: 5)\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave\\mathlib4&gt;\n</code></pre></div>",
        "id": 376580325,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689756615
    },
    {
        "content": "<p>So it seems to have downloaded the files but not able to decompress them (or whatever it is supposed to do after that)</p>",
        "id": 376581564,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689756850
    },
    {
        "content": "<p>it is supposed to have created a file called <code>leantar-0.1.4.exe</code></p>",
        "id": 376582447,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689757041
    },
    {
        "content": "<p>It looks like it has copied it to <code>leantar.exe</code> without the version number</p>",
        "id": 376582567,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689757076
    },
    {
        "content": "<p>Doing the manual remaing suggested by Eagle941 seems to fix it</p>",
        "id": 376582675,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689757098
    },
    {
        "content": "<p>is the directory named <code>leantar-0.1.4.exe</code> in your second code block just due to manual unpacking?</p>",
        "id": 376582773,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689757124
    },
    {
        "content": "<p>not that was created by <code>lake exe cache get</code> <br>\nI think that is probably the mistake right?</p>",
        "id": 376583195,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689757205
    },
    {
        "content": "<p>also, it looks like you just showed the contents of <code>.cache</code>, whereas lake exe cache should be unpacking things into <code>.cache/mathlib</code>, or am I misreading?</p>",
        "id": 376583522,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689757273
    },
    {
        "content": "<p>i.e. the file is supposed to be located at <code>.cache/mathlib/leantar-0.1.4.exe</code></p>",
        "id": 376583660,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689757303
    },
    {
        "content": "<p>There is no mathlib folder inside the <code>.cache</code> folder</p>",
        "id": 376584100,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689757397
    },
    {
        "content": "<p>Why is there a <code>.cache</code> folder <em>in mathlib4/</em> to begin with?</p>",
        "id": 376584216,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1689757428
    },
    {
        "content": "<p>oh good point</p>",
        "id": 376584439,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689757463
    },
    {
        "content": "<p><code>lake exe cache</code> uses <code>$XDG_CACHE_HOME$/.cache/mathlib</code>, else <code>$HOME$/.cache/mathlib</code>, else <code>./.cache</code> for the cache directory depending on the presence of those env vars</p>",
        "id": 376584745,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689757521
    },
    {
        "content": "<p>so it sounds like <code>$HOME$</code> is not defined</p>",
        "id": 376584823,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689757537
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"497480\">@MohanadAhmed</span> is there anything at <code>C:\\Users\\Mohanad\\.cache\\mathlib</code>?</p>",
        "id": 376585200,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689757597
    },
    {
        "content": "<p>No there is no folder like that</p>",
        "id": 376585354,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689757625
    },
    {
        "content": "<p>Here is the home variable</p>",
        "id": 376585917,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689757736
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>PS C:\\Users\\Mohanad&gt; echo $HOME\nC:\\Users\\Mohanad\n</code></pre></div>",
        "id": 376585938,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689757741
    },
    {
        "content": "<p>can you open <code>Cache/IO.lean</code> and make some edits?</p>",
        "id": 376586377,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689757835
    },
    {
        "content": "<p>at the end of <code>validateLeanTar</code> add this before the final line:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code>  <span class=\"n\">println</span><span class=\"bp\">!</span> <span class=\"s2\">\"HOME: {← IO.getEnv \"</span><span class=\"n\">HOME</span><span class=\"s2\">\"}\"</span>\n  <span class=\"n\">println</span><span class=\"bp\">!</span> <span class=\"s2\">\"running: mv {(IO.CACHEDIR / s!\"</span><span class=\"n\">leantar</span><span class=\"o\">{</span><span class=\"n\">EXE</span><span class=\"o\">}</span><span class=\"s2\">\").toString} {LEANTARBIN.toString}\"</span>\n  <span class=\"k\">let</span> <span class=\"n\">_</span> <span class=\"bp\">←</span> <span class=\"n\">runCmd</span> <span class=\"s2\">\"mv\"</span> <span class=\"bp\">#</span><span class=\"o\">[(</span><span class=\"n\">IO.CACHEDIR</span> <span class=\"bp\">/</span> <span class=\"n\">s</span><span class=\"bp\">!</span><span class=\"s2\">\"leantar{EXE}\"</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toString</span><span class=\"o\">,</span> <span class=\"n\">LEANTARBIN.toString</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 376586764,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689757914
    },
    {
        "content": "<p>then delete the <code>.cache</code> directory and run <code>lake exe cache get</code></p>",
        "id": 376586976,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689757947
    },
    {
        "content": "<p>I tried the solution suggestd by Eagle941. It seems to work but only if BOTH <code>leantar.exe</code> and <code>leantar-0.1.4.exe</code> are both presentiin the cache folder</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>PS C:\\Users\\Mohanad\\LeanStuff\\mgrave2&gt; git clone https://github.com/leanprover-community/mathlib4\nCloning into 'mathlib4'...\nremote: Enumerating objects: 94405, done.                                                                                                                                                                        remote: Counting objects: 100% (14474/14474), done.                                                                                                                                                              remote: Compressing objects: 100% (2242/2242), done.                                                                                                                                                             Updating files: 100% (3634/3634), done.\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave2&gt; cd .\\mathlib4\\\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4&gt; lake exe cache get\ninfo: cloning https://github.com/leanprover/std4 to .\\lake-packages\\std\ninfo: cloning https://github.com/gebner/quote4 to .\\lake-packages\\Qq\ninfo: cloning https://github.com/JLimperg/aesop to .\\lake-packages\\aesop\ninfo: cloning https://github.com/mhuisi/lean4-cli.git to .\\lake-packages\\Cli\ninfo: cloning https://github.com/EdAyers/ProofWidgets4 to .\\lake-packages\\proofwidgets\ninfo: Downloading proofwidgets/v0.0.11/windows-64.tar.gz\ninfo: Unpacking proofwidgets/v0.0.11/windows-64.tar.gz\ninfo: [1/9] Building Cache.IO\ninfo: [3/9] Compiling Cache.Hashing\ninfo: [3/9] Building Cache.Requests\ninfo: [6/9] Compiling Cache.Requests\ninfo: [6/9] Building Cache.Main\ninfo: [7/9] Compiling Cache.Main\ninfo: [9/9] Linking cache.exe\nleantar is too old; downloading more recent version\nuncaught exception: no such file or directory (error code: 2)\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4&gt; cd .\\.cache\\\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4\\.cache&gt; dir leantar*\n\n\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----         7/19/2023  12:08 PM         643578 leantar-0.1.4.exe.zip\n-a----         7/19/2023   5:14 AM        1540096 leantar.exe\n\n\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4\\.cache&gt; Expand-Archive .\\leantar-0.1.4.exe.zip\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4\\.cache&gt; dir leantar*\n\n\n    Directory: C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4\\.cache\n\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\nd-----         7/19/2023  12:09 PM                leantar-0.1.4.exe\n-a----         7/19/2023  12:08 PM         643578 leantar-0.1.4.exe.zip\n-a----         7/19/2023   5:14 AM        1540096 leantar.exe\n\n\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4\\.cache&gt; cp .\\leantar-0.1.4.exe\\leantar-v0.1.4-x86_64-pc-windows-msvc\\leantar.exe .\\leantar.exe\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4\\.cache&gt; rm -Recurse -Force .\\leantar-0.1.4.exe\\\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4\\.cache&gt; dir leantar*\n\n\n    Directory: C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4\\.cache\n\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----         7/19/2023  12:08 PM         643578 leantar-0.1.4.exe.zip\n-a----         7/19/2023   5:14 AM        1540096 leantar.exe\n\n\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4\\.cache&gt; cp .\\leantar.exe .\\leantar-0.1.4.exe\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4\\.cache&gt; dir leantar*\n\n\n    Directory: C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4\\.cache\n\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----         7/19/2023   5:14 AM        1540096 leantar-0.1.4.exe\n-a----         7/19/2023  12:08 PM         643578 leantar-0.1.4.exe.zip\n-a----         7/19/2023   5:14 AM        1540096 leantar.exe\n\n\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4\\.cache&gt; cd ..\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4&gt; lake exe cache get\nAttempting to download 3589 file(s)\nDownloaded: 3589 file(s) [attempted 3589/3589 = 100%] (100% success)\nDecompressing 3589 file(s)\nunpacked in 5801 ms\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrave2\\mathlib4&gt;\n</code></pre></div>",
        "id": 376587210,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689757999
    },
    {
        "content": "<p>I think <code>mv leantar.exe leantar-0.1.4.exe</code> alone would be sufficient. But I'm more interested in making sure that the script that does the <code>mv</code> works so that you don't have to manually edit the file</p>",
        "id": 376587724,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689758102
    },
    {
        "content": "<p>This is just a guess but before <code>mv leantar.exe leantar-0.1.4.exe</code> is the folder with the same name <code>leantar-0.1.4.exe</code> supposed to there, <br>\nThe rename will fail silently in powershell.</p>",
        "id": 376588244,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689758209
    },
    {
        "content": "<p>Because the folder and executable file cannot share the same name</p>",
        "id": 376588333,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689758230
    },
    {
        "content": "<p>that makes sense, but the folder shouldn't be there in the first place</p>",
        "id": 376588494,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689758261
    },
    {
        "content": "<p>I think it is being created by extract-archive</p>",
        "id": 376588555,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689758275
    },
    {
        "content": "<p>in the original state before your manual edits:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">PS</span> <span class=\"n\">C</span><span class=\"o\">:</span><span class=\"bp\">\\</span><span class=\"n\">Users</span><span class=\"bp\">\\</span><span class=\"n\">Mohanad</span><span class=\"bp\">\\</span><span class=\"n\">LeanStuff</span><span class=\"bp\">\\</span><span class=\"n\">mgrave2</span><span class=\"bp\">\\</span><span class=\"n\">mathlib4</span><span class=\"bp\">\\.</span><span class=\"n\">cache</span><span class=\"bp\">&gt;</span> <span class=\"n\">dir</span> <span class=\"n\">leantar</span><span class=\"bp\">*</span>\n\n\n\n<span class=\"n\">Mode</span>                 <span class=\"n\">LastWriteTime</span>         <span class=\"n\">Length</span> <span class=\"n\">Name</span>\n<span class=\"c1\">----                 -------------         ------ ----</span>\n<span class=\"bp\">-</span><span class=\"n\">a</span><span class=\"c1\">----         7/19/2023  12:08 PM         643578 leantar-0.1.4.exe.zip</span>\n<span class=\"bp\">-</span><span class=\"n\">a</span><span class=\"c1\">----         7/19/2023   5:14 AM        1540096 leantar.exe</span>\n</code></pre></div>\n<p>you can see that there is no directory <code>leantar-0.1.4.exe</code> and also the correct executable has been unpacked as <code>leantar.exe</code> (at least, based on the length), so the only thing that is missing is to rename <code>leantar.exe</code> to <code>leantar-0.1.4.exe</code></p>",
        "id": 376589095,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689758384
    },
    {
        "content": "<p>Ah OK that was might mistake</p>",
        "id": 376589263,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689758407
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/287929-mathlib4/topic/leantar.20too.20old.20.28lean.20exe.20cache.20get.20not.20working.29/near/376586764\">said</a>:</p>\n<blockquote>\n<p>can you open <code>Cache/IO.lean</code> and make some edits?</p>\n<p>at the end of <code>validateLeanTar</code> add this before the final line (line 198):</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code>  <span class=\"n\">println</span><span class=\"bp\">!</span> <span class=\"s2\">\"HOME: {← IO.getEnv \"</span><span class=\"n\">HOME</span><span class=\"s2\">\"}\"</span>\n  <span class=\"n\">println</span><span class=\"bp\">!</span> <span class=\"s2\">\"running: mv {(IO.CACHEDIR / s!\"</span><span class=\"n\">leantar</span><span class=\"o\">{</span><span class=\"n\">EXE</span><span class=\"o\">}</span><span class=\"s2\">\").toString} {LEANTARBIN.toString}\"</span>\n  <span class=\"k\">let</span> <span class=\"n\">_</span> <span class=\"bp\">←</span> <span class=\"n\">runCmd</span> <span class=\"s2\">\"mv\"</span> <span class=\"bp\">#</span><span class=\"o\">[(</span><span class=\"n\">IO.CACHEDIR</span> <span class=\"bp\">/</span> <span class=\"n\">s</span><span class=\"bp\">!</span><span class=\"s2\">\"leantar{EXE}\"</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toString</span><span class=\"o\">,</span> <span class=\"n\">LEANTARBIN.toString</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>then delete the <code>.cache</code> directory and run <code>lake exe cache get</code></p>\n</blockquote>",
        "id": 376589428,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689758439
    },
    {
        "content": "<p>Should it look like this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">validateLeanTar</span> <span class=\"o\">:</span> <span class=\"n\">IO</span> <span class=\"n\">Unit</span> <span class=\"o\">:=</span> <span class=\"k\">do</span>\n  <span class=\"k\">if</span> <span class=\"o\">(</span><span class=\"bp\">←</span> <span class=\"n\">LEANTARBIN.pathExists</span><span class=\"o\">)</span> <span class=\"k\">then</span> <span class=\"n\">return</span>\n  <span class=\"k\">if</span> <span class=\"k\">let</span> <span class=\"n\">some</span> <span class=\"n\">version</span> <span class=\"bp\">←</span> <span class=\"n\">some</span> <span class=\"bp\">&lt;$&gt;</span> <span class=\"n\">runCmd</span> <span class=\"s2\">\"leantar\"</span> <span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"--version\"</span><span class=\"o\">]</span> <span class=\"bp\">&lt;|&gt;</span> <span class=\"n\">pure</span> <span class=\"n\">none</span> <span class=\"k\">then</span>\n    <span class=\"k\">let</span> <span class=\"s2\">\"leantar\"</span> <span class=\"o\">::</span> <span class=\"n\">v</span> <span class=\"o\">::</span> <span class=\"n\">_</span> <span class=\"o\">:=</span> <span class=\"n\">version.splitOn</span> <span class=\"s2\">\" \"</span>\n      <span class=\"bp\">|</span> <span class=\"n\">throw</span> <span class=\"bp\">$</span> <span class=\"n\">IO.userError</span> <span class=\"s2\">\"Invalidly formatted response from `leantar --version`\"</span>\n    <span class=\"k\">let</span> <span class=\"n\">some</span> <span class=\"n\">v</span> <span class=\"o\">:=</span> <span class=\"n\">parseVersion</span> <span class=\"n\">v</span> <span class=\"bp\">|</span> <span class=\"n\">throw</span> <span class=\"bp\">$</span> <span class=\"n\">IO.userError</span> <span class=\"s2\">\"Invalidly formatted version of `leantar`\"</span>\n    <span class=\"c1\">-- currently we need exactly one version of leantar, change this to reflect compatibility</span>\n    <span class=\"k\">if</span> <span class=\"n\">v</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">parseVersion</span> <span class=\"n\">LEANTARVERSION</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">get</span><span class=\"bp\">!</span> <span class=\"k\">then</span> <span class=\"n\">return</span>\n  <span class=\"k\">let</span> <span class=\"n\">win</span> <span class=\"o\">:=</span> <span class=\"n\">System.Platform.getIsWindows</span> <span class=\"o\">()</span>\n  <span class=\"k\">let</span> <span class=\"n\">target</span> <span class=\"bp\">←</span> <span class=\"k\">if</span> <span class=\"n\">win</span> <span class=\"k\">then</span>\n    <span class=\"n\">pure</span> <span class=\"s2\">\"x86_64-pc-windows-msvc\"</span>\n  <span class=\"k\">else</span>\n    <span class=\"k\">let</span> <span class=\"n\">mut</span> <span class=\"n\">arch</span> <span class=\"bp\">←</span> <span class=\"o\">(</span><span class=\"bp\">·.</span><span class=\"n\">trim</span><span class=\"o\">)</span> <span class=\"bp\">&lt;$&gt;</span> <span class=\"n\">runCmd</span> <span class=\"s2\">\"uname\"</span> <span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"-m\"</span><span class=\"o\">]</span> <span class=\"n\">false</span>\n    <span class=\"k\">if</span> <span class=\"n\">arch</span> <span class=\"bp\">=</span> <span class=\"s2\">\"arm64\"</span> <span class=\"k\">then</span> <span class=\"n\">arch</span> <span class=\"o\">:=</span> <span class=\"s2\">\"aarch64\"</span>\n    <span class=\"n\">unless</span> <span class=\"n\">arch</span> <span class=\"bp\">∈</span> <span class=\"o\">[</span><span class=\"s2\">\"x86_64\"</span><span class=\"o\">,</span> <span class=\"s2\">\"aarch64\"</span><span class=\"o\">]</span> <span class=\"k\">do</span>\n      <span class=\"n\">throw</span> <span class=\"bp\">$</span> <span class=\"n\">IO.userError</span> <span class=\"n\">s</span><span class=\"bp\">!</span><span class=\"s2\">\"unsupported architecture {arch}\"</span>\n    <span class=\"n\">pure</span> <span class=\"bp\">&lt;|</span>\n      <span class=\"k\">if</span> <span class=\"n\">System.Platform.getIsOSX</span> <span class=\"o\">()</span> <span class=\"k\">then</span> <span class=\"n\">s</span><span class=\"bp\">!</span><span class=\"s2\">\"{arch}-apple-darwin\"</span>\n      <span class=\"k\">else</span> <span class=\"n\">s</span><span class=\"bp\">!</span><span class=\"s2\">\"{arch}-unknown-linux-musl\"</span>\n  <span class=\"n\">IO.println</span> <span class=\"n\">s</span><span class=\"bp\">!</span><span class=\"s2\">\"leantar is too old; downloading more recent version\"</span>\n  <span class=\"n\">IO.FS.createDirAll</span> <span class=\"n\">IO.CACHEDIR</span>\n  <span class=\"k\">let</span> <span class=\"n\">ext</span> <span class=\"o\">:=</span> <span class=\"k\">if</span> <span class=\"n\">win</span> <span class=\"k\">then</span> <span class=\"s2\">\"zip\"</span> <span class=\"k\">else</span> <span class=\"s2\">\"tar.gz\"</span>\n  <span class=\"k\">let</span> <span class=\"n\">_</span> <span class=\"bp\">←</span> <span class=\"n\">runCmd</span> <span class=\"s2\">\"curl\"</span> <span class=\"bp\">#</span><span class=\"o\">[</span>\n    <span class=\"n\">s</span><span class=\"bp\">!</span><span class=\"s2\">\"https://github.com/digama0/leangz/releases/download/v{LEANTARVERSION}/leantar-v{LEANTARVERSION}-{target}.{ext}\"</span><span class=\"o\">,</span>\n    <span class=\"s2\">\"-L\"</span><span class=\"o\">,</span> <span class=\"s2\">\"-o\"</span><span class=\"o\">,</span> <span class=\"n\">s</span><span class=\"bp\">!</span><span class=\"s2\">\"{LEANTARBIN}.{ext}\"</span><span class=\"o\">]</span>\n  <span class=\"k\">let</span> <span class=\"n\">_</span> <span class=\"bp\">←</span> <span class=\"n\">runCmd</span> <span class=\"s2\">\"tar\"</span> <span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"-xf\"</span><span class=\"o\">,</span> <span class=\"n\">s</span><span class=\"bp\">!</span><span class=\"s2\">\"{LEANTARBIN}.{ext}\"</span><span class=\"o\">,</span>\n    <span class=\"s2\">\"-C\"</span><span class=\"o\">,</span> <span class=\"n\">IO.CACHEDIR.toString</span><span class=\"o\">,</span> <span class=\"s2\">\"--strip-components=1\"</span><span class=\"o\">]</span>\n  <span class=\"n\">println</span><span class=\"bp\">!</span> <span class=\"s2\">\"HOME: {← IO.getEnv \"</span><span class=\"n\">HOME</span><span class=\"s2\">\"}\"</span>\n  <span class=\"n\">println</span><span class=\"bp\">!</span> <span class=\"s2\">\"running: mv {(IO.CACHEDIR / s!\"</span><span class=\"n\">leantar</span><span class=\"o\">{</span><span class=\"n\">EXE</span><span class=\"o\">}</span><span class=\"s2\">\").toString} {LEANTARBIN.toString}\"</span>\n  <span class=\"k\">let</span> <span class=\"n\">_</span> <span class=\"bp\">←</span> <span class=\"n\">runCmd</span> <span class=\"s2\">\"mv\"</span> <span class=\"bp\">#</span><span class=\"o\">[(</span><span class=\"n\">IO.CACHEDIR</span> <span class=\"bp\">/</span> <span class=\"n\">s</span><span class=\"bp\">!</span><span class=\"s2\">\"leantar{EXE}\"</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toString</span><span class=\"o\">,</span> <span class=\"n\">LEANTARBIN.toString</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 376590250,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689758603
    },
    {
        "content": "<p>yes</p>",
        "id": 376590367,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689758627
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>PS C:\\Users\\Mohanad\\LeanStuff\\mgrv\\mathlib4&gt; rm -Recurse -Force .\\.cache\\\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrv\\mathlib4&gt; lake exe cache get\ninfo: [1/9] Building Cache.IO\ninfo: [2/9] Compiling Cache.IO\ninfo: [2/9] Building Cache.Hashing\ninfo: [4/9] Building Cache.Requests\ninfo: [7/9] Building Cache.Main\ninfo: [9/9] Linking cache.exe\nleantar is too old; downloading more recent version\nHOME: none\nrunning: mv .cache\\leantar.exe .cache\\leantar-0.1.4.exe\nuncaught exception: no such file or directory (error code: 2)\n</code></pre></div>",
        "id": 376591537,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689758891
    },
    {
        "content": "<p>hm, that is basically what I expected... does running <code>mv .cache\\leantar.exe .cache\\leantar-0.1.4.exe</code> manually work?</p>",
        "id": 376591824,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1689758944
    },
    {
        "content": "<p>Note that  $HOME is defined by I don't know why it is not picked up</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>PS C:\\Users\\Mohanad\\LeanStuff\\mgrv\\mathlib4&gt; rm -Recurse -Force .\\.cache\\\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrv\\mathlib4&gt; lake exe cache get\ninfo: [1/9] Building Cache.IO\ninfo: [2/9] Compiling Cache.IO\ninfo: [2/9] Building Cache.Hashing\ninfo: [4/9] Building Cache.Requests\ninfo: [7/9] Building Cache.Main\ninfo: [9/9] Linking cache.exe\nleantar is too old; downloading more recent version\nHOME: none\nrunning: mv .cache\\leantar.exe .cache\\leantar-0.1.4.exe\nuncaught exception: no such file or directory (error code: 2)\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrv\\mathlib4&gt; echo $HOME\nC:\\Users\\Mohanad\n</code></pre></div>",
        "id": 376592768,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689759129
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/287929-mathlib4/topic/leantar.20too.20old.20.28lean.20exe.20cache.20get.20not.20working.29/near/376591824\">said</a>:</p>\n<blockquote>\n<p>hm, that is basically what I expected... does running <code>mv .cache\\leantar.exe .cache\\leantar-0.1.4.exe</code> manually work?</p>\n</blockquote>\n<p>Yes it works</p>",
        "id": 376592918,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689759167
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>PS C:\\Users\\Mohanad\\LeanStuff\\mgrv\\mathlib4&gt; mv .\\.cache\\leantar.exe .\\.cache\\leantar-0.1.4.exe\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrv\\mathlib4&gt; lake exe cache get\ninfo: [1/9] Building Cache.IO\ninfo: [2/9] Compiling Cache.IO\ninfo: [2/9] Building Cache.Hashing\ninfo: [4/9] Building Cache.Requests\ninfo: [7/9] Building Cache.Main\ninfo: [9/9] Linking cache.exe\nAttempting to download 3589 file(s)\nDownloaded: 3589 file(s) [attempted 3589/3589 = 100%] (100% success)\nDecompressing 3589 file(s)\nunpacked in 5256 ms\nPS C:\\Users\\Mohanad\\LeanStuff\\mgrv\\mathlib4&gt;\n</code></pre></div>",
        "id": 376592962,
        "sender_full_name": "MohanadAhmed",
        "timestamp": 1689759177
    },
    {
        "content": "<p>I'm getting an SSL error:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">dwrensha</span><span class=\"bp\">@</span><span class=\"n\">hafnium</span><span class=\"o\">:</span><span class=\"bp\">~/</span><span class=\"n\">src</span><span class=\"bp\">/</span><span class=\"n\">math</span><span class=\"bp\">-</span><span class=\"n\">puzzles</span><span class=\"bp\">-</span><span class=\"k\">in</span><span class=\"bp\">-</span><span class=\"n\">lean4</span><span class=\"bp\">$</span> <span class=\"n\">lake</span> <span class=\"n\">exe</span> <span class=\"n\">cache</span> <span class=\"n\">get</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">Downloading</span> <span class=\"n\">proofwidgets</span><span class=\"bp\">/</span><span class=\"n\">v0.0.11</span><span class=\"bp\">/</span><span class=\"n\">linux</span><span class=\"bp\">-</span><span class=\"mi\">64</span><span class=\"bp\">.</span><span class=\"n\">tar.gz</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">&gt;</span> <span class=\"n\">curl</span> <span class=\"bp\">-</span><span class=\"n\">s</span> <span class=\"bp\">-</span><span class=\"n\">f</span> <span class=\"bp\">-</span><span class=\"n\">o</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">proofwidgets</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">linux</span><span class=\"bp\">-</span><span class=\"mi\">64</span><span class=\"bp\">.</span><span class=\"n\">tar.gz</span> <span class=\"bp\">-</span><span class=\"n\">L</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">EdAyers</span><span class=\"bp\">/</span><span class=\"n\">ProofWidgets4</span><span class=\"bp\">/</span><span class=\"n\">releases</span><span class=\"bp\">/</span><span class=\"n\">download</span><span class=\"bp\">/</span><span class=\"n\">v0.0.11</span><span class=\"bp\">/</span><span class=\"n\">linux</span><span class=\"bp\">-</span><span class=\"mi\">64</span><span class=\"bp\">.</span><span class=\"n\">tar.gz</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">external</span> <span class=\"n\">command</span> <span class=\"bp\">`</span><span class=\"n\">curl</span><span class=\"bp\">`</span> <span class=\"n\">exited</span> <span class=\"k\">with</span> <span class=\"n\">code</span> <span class=\"mi\">60</span>\n<span class=\"n\">leantar</span> <span class=\"n\">is</span> <span class=\"n\">too</span> <span class=\"n\">old</span><span class=\"bp\">;</span> <span class=\"n\">downloading</span> <span class=\"n\">more</span> <span class=\"n\">recent</span> <span class=\"n\">version</span>\n<span class=\"n\">uncaught</span> <span class=\"n\">exception</span><span class=\"o\">:</span>   <span class=\"bp\">%</span> <span class=\"n\">Total</span>    <span class=\"bp\">%</span> <span class=\"n\">Received</span> <span class=\"bp\">%</span> <span class=\"n\">Xferd</span>  <span class=\"n\">Average</span> <span class=\"n\">Speed</span>   <span class=\"n\">Time</span>    <span class=\"n\">Time</span>     <span class=\"n\">Time</span>  <span class=\"n\">Current</span>\n                                 <span class=\"n\">Dload</span>  <span class=\"n\">Upload</span>   <span class=\"n\">Total</span>   <span class=\"n\">Spent</span>    <span class=\"n\">Left</span>  <span class=\"n\">Speed</span>\n  <span class=\"mi\">0</span>     <span class=\"mi\">0</span>    <span class=\"mi\">0</span>     <span class=\"mi\">0</span>    <span class=\"mi\">0</span>     <span class=\"mi\">0</span>      <span class=\"mi\">0</span>      <span class=\"mi\">0</span> <span class=\"c1\">--:--:-- --:--:-- --:--:--     0</span>\n  <span class=\"mi\">0</span>     <span class=\"mi\">0</span>    <span class=\"mi\">0</span>     <span class=\"mi\">0</span>    <span class=\"mi\">0</span>     <span class=\"mi\">0</span>      <span class=\"mi\">0</span>      <span class=\"mi\">0</span> <span class=\"c1\">--:--:-- --:--:-- --:--:--     0</span>\n<span class=\"n\">curl</span><span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">60</span><span class=\"o\">)</span> <span class=\"n\">SSL</span><span class=\"o\">:</span> <span class=\"n\">no</span> <span class=\"n\">alternative</span> <span class=\"n\">certificate</span> <span class=\"n\">subject</span> <span class=\"n\">name</span> <span class=\"n\">matches</span> <span class=\"n\">target</span> <span class=\"n\">host</span> <span class=\"n\">name</span> <span class=\"bp\">'</span><span class=\"n\">objects.githubusercontent.com'</span>\n<span class=\"n\">More</span> <span class=\"n\">details</span> <span class=\"n\">here</span><span class=\"o\">:</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">curl.se</span><span class=\"bp\">/</span><span class=\"n\">docs</span><span class=\"bp\">/</span><span class=\"n\">sslcerts.html</span>\n\n<span class=\"n\">curl</span> <span class=\"n\">failed</span> <span class=\"n\">to</span> <span class=\"n\">verify</span> <span class=\"n\">the</span> <span class=\"n\">legitimacy</span> <span class=\"n\">of</span> <span class=\"n\">the</span> <span class=\"n\">server</span> <span class=\"n\">and</span> <span class=\"n\">therefore</span> <span class=\"n\">could</span> <span class=\"n\">not</span>\n<span class=\"n\">establish</span> <span class=\"n\">a</span> <span class=\"n\">secure</span> <span class=\"n\">connection</span> <span class=\"n\">to</span> <span class=\"n\">it.</span> <span class=\"n\">To</span> <span class=\"n\">learn</span> <span class=\"n\">more</span> <span class=\"n\">about</span> <span class=\"n\">this</span> <span class=\"n\">situation</span> <span class=\"n\">and</span>\n<span class=\"n\">how</span> <span class=\"n\">to</span> <span class=\"n\">fix</span> <span class=\"n\">it</span><span class=\"o\">,</span> <span class=\"n\">please</span> <span class=\"n\">visit</span> <span class=\"n\">the</span> <span class=\"n\">web</span> <span class=\"n\">page</span> <span class=\"n\">mentioned</span> <span class=\"n\">above.</span>\n</code></pre></div>",
        "id": 376661199,
        "sender_full_name": "David Renshaw",
        "timestamp": 1689772332
    },
    {
        "content": "<p>My curl version:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">$</span> <span class=\"n\">curl</span> <span class=\"c1\">--version</span>\n<span class=\"n\">curl</span> <span class=\"mi\">7</span><span class=\"bp\">.</span><span class=\"mi\">81</span><span class=\"bp\">.</span><span class=\"mi\">0</span> <span class=\"o\">(</span><span class=\"n\">x86_64</span><span class=\"bp\">-</span><span class=\"n\">pc</span><span class=\"bp\">-</span><span class=\"n\">linux</span><span class=\"bp\">-</span><span class=\"n\">gnu</span><span class=\"o\">)</span> <span class=\"n\">libcurl</span><span class=\"bp\">/</span><span class=\"mi\">7</span><span class=\"bp\">.</span><span class=\"mi\">81</span><span class=\"bp\">.</span><span class=\"mi\">0</span> <span class=\"n\">OpenSSL</span><span class=\"bp\">/</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">2</span> <span class=\"n\">zlib</span><span class=\"bp\">/</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">.</span><span class=\"mi\">11</span> <span class=\"n\">brotli</span><span class=\"bp\">/</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">9</span> <span class=\"n\">zstd</span><span class=\"bp\">/</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">4</span><span class=\"bp\">.</span><span class=\"mi\">8</span> <span class=\"n\">libidn2</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"bp\">.</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">2</span> <span class=\"n\">libpsl</span><span class=\"bp\">/</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">21</span><span class=\"bp\">.</span><span class=\"mi\">0</span> <span class=\"o\">(</span><span class=\"bp\">+</span><span class=\"n\">libidn2</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"bp\">.</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"n\">libssh</span><span class=\"bp\">/</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">9</span><span class=\"bp\">.</span><span class=\"mi\">6</span><span class=\"bp\">/</span><span class=\"n\">openssl</span><span class=\"bp\">/</span><span class=\"n\">zlib</span> <span class=\"n\">nghttp2</span><span class=\"bp\">/</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">43</span><span class=\"bp\">.</span><span class=\"mi\">0</span> <span class=\"n\">librtmp</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"bp\">.</span><span class=\"mi\">3</span> <span class=\"n\">OpenLDAP</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"bp\">.</span><span class=\"mi\">5</span><span class=\"bp\">.</span><span class=\"mi\">14</span>\n<span class=\"n\">Release</span><span class=\"bp\">-</span><span class=\"n\">Date</span><span class=\"o\">:</span> <span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">01</span><span class=\"bp\">-</span><span class=\"mi\">05</span>\n<span class=\"n\">Protocols</span><span class=\"o\">:</span> <span class=\"n\">dict</span> <span class=\"n\">file</span> <span class=\"n\">ftp</span> <span class=\"n\">ftps</span> <span class=\"n\">gopher</span> <span class=\"n\">gophers</span> <span class=\"n\">http</span> <span class=\"n\">https</span> <span class=\"n\">imap</span> <span class=\"n\">imaps</span> <span class=\"n\">ldap</span> <span class=\"n\">ldaps</span> <span class=\"n\">mqtt</span> <span class=\"n\">pop3</span> <span class=\"n\">pop3s</span> <span class=\"n\">rtmp</span> <span class=\"n\">rtsp</span> <span class=\"n\">scp</span> <span class=\"n\">sftp</span> <span class=\"n\">smb</span> <span class=\"n\">smbs</span> <span class=\"n\">smtp</span> <span class=\"n\">smtps</span> <span class=\"n\">telnet</span> <span class=\"n\">tftp</span>\n<span class=\"n\">Features</span><span class=\"o\">:</span> <span class=\"n\">alt</span><span class=\"bp\">-</span><span class=\"n\">svc</span> <span class=\"n\">AsynchDNS</span> <span class=\"n\">brotli</span> <span class=\"n\">GSS</span><span class=\"bp\">-</span><span class=\"n\">API</span> <span class=\"n\">HSTS</span> <span class=\"n\">HTTP2</span> <span class=\"n\">HTTPS</span><span class=\"bp\">-</span><span class=\"n\">proxy</span> <span class=\"n\">IDN</span> <span class=\"n\">IPv6</span> <span class=\"n\">Kerberos</span> <span class=\"n\">Largefile</span> <span class=\"n\">libz</span> <span class=\"n\">NTLM</span> <span class=\"n\">NTLM_WB</span> <span class=\"n\">PSL</span> <span class=\"n\">SPNEGO</span> <span class=\"n\">SSL</span> <span class=\"n\">TLS</span><span class=\"bp\">-</span><span class=\"n\">SRP</span> <span class=\"n\">UnixSockets</span> <span class=\"n\">zstd</span>\n</code></pre></div>",
        "id": 376667674,
        "sender_full_name": "David Renshaw",
        "timestamp": 1689773581
    },
    {
        "content": "<p>It works on my other computer, with curl version</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">curl</span> <span class=\"mi\">7</span><span class=\"bp\">.</span><span class=\"mi\">86</span><span class=\"bp\">.</span><span class=\"mi\">0</span> <span class=\"o\">(</span><span class=\"n\">aarch64</span><span class=\"bp\">-</span><span class=\"n\">apple</span><span class=\"bp\">-</span><span class=\"n\">darwin21.3.0</span><span class=\"o\">)</span> <span class=\"n\">libcurl</span><span class=\"bp\">/</span><span class=\"mi\">7</span><span class=\"bp\">.</span><span class=\"mi\">86</span><span class=\"bp\">.</span><span class=\"mi\">0</span> <span class=\"n\">OpenSSL</span><span class=\"bp\">/</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">7</span> <span class=\"n\">zlib</span><span class=\"bp\">/</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">.</span><span class=\"mi\">13</span> <span class=\"n\">brotli</span><span class=\"bp\">/</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">9</span> <span class=\"n\">zstd</span><span class=\"bp\">/</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">5</span><span class=\"bp\">.</span><span class=\"mi\">2</span> <span class=\"n\">libidn2</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"bp\">.</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">4</span> <span class=\"n\">libpsl</span><span class=\"bp\">/</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">21</span><span class=\"bp\">.</span><span class=\"mi\">1</span> <span class=\"o\">(</span><span class=\"bp\">+</span><span class=\"n\">libidn2</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"bp\">.</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">3</span><span class=\"o\">)</span> <span class=\"n\">nghttp2</span><span class=\"bp\">/</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">51</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">Release</span><span class=\"bp\">-</span><span class=\"n\">Date</span><span class=\"o\">:</span> <span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">10</span><span class=\"bp\">-</span><span class=\"mi\">26</span>\n<span class=\"n\">Protocols</span><span class=\"o\">:</span> <span class=\"n\">dict</span> <span class=\"n\">file</span> <span class=\"n\">ftp</span> <span class=\"n\">ftps</span> <span class=\"n\">gopher</span> <span class=\"n\">gophers</span> <span class=\"n\">http</span> <span class=\"n\">https</span> <span class=\"n\">imap</span> <span class=\"n\">imaps</span> <span class=\"n\">mqtt</span> <span class=\"n\">pop3</span> <span class=\"n\">pop3s</span> <span class=\"n\">rtsp</span> <span class=\"n\">smb</span> <span class=\"n\">smbs</span> <span class=\"n\">smtp</span> <span class=\"n\">smtps</span> <span class=\"n\">telnet</span> <span class=\"n\">tftp</span>\n<span class=\"n\">Features</span><span class=\"o\">:</span> <span class=\"n\">alt</span><span class=\"bp\">-</span><span class=\"n\">svc</span> <span class=\"n\">AsynchDNS</span> <span class=\"n\">brotli</span> <span class=\"n\">HSTS</span> <span class=\"n\">HTTP2</span> <span class=\"n\">HTTPS</span><span class=\"bp\">-</span><span class=\"n\">proxy</span> <span class=\"n\">IDN</span> <span class=\"n\">IPv6</span> <span class=\"n\">Largefile</span> <span class=\"n\">libz</span> <span class=\"n\">NTLM</span> <span class=\"n\">NTLM_WB</span> <span class=\"n\">PSL</span> <span class=\"n\">SSL</span> <span class=\"n\">threadsafe</span> <span class=\"n\">TLS</span><span class=\"bp\">-</span><span class=\"n\">SRP</span> <span class=\"n\">UnixSockets</span> <span class=\"n\">zstd</span>\n</code></pre></div>",
        "id": 376667800,
        "sender_full_name": "David Renshaw",
        "timestamp": 1689773603
    },
    {
        "content": "<p>Your <code>curl</code> dependencies are more up to date on your other computer. In particular, it uses a newer version of <code>OpenSSL</code></p>",
        "id": 376669262,
        "sender_full_name": "Arthur Paulino",
        "timestamp": 1689773873
    },
    {
        "content": "<p>OpenSSL/3.0.2 is from May 2022, and is the current version on ubuntu 22.04.</p>",
        "id": 376670687,
        "sender_full_name": "David Renshaw",
        "timestamp": 1689774081
    },
    {
        "content": "<p>Ugh. I got it to work by downgrading my system <code>curl</code> from version <code>7.81.0-1ubuntu1.11</code> to <code>7.81.0-1ubuntu1.10</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">sudo</span> <span class=\"n\">apt</span><span class=\"bp\">-</span><span class=\"n\">get</span> <span class=\"n\">install</span> <span class=\"n\">curl</span><span class=\"bp\">=</span><span class=\"mi\">7</span><span class=\"bp\">.</span><span class=\"mi\">81</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">ubuntu1.10</span> <span class=\"n\">libcurl4</span><span class=\"bp\">=</span><span class=\"mi\">7</span><span class=\"bp\">.</span><span class=\"mi\">81</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">ubuntu1.10</span>\n</code></pre></div>\n<p>So looks like my problem was independent of mathlib/lake/lean.</p>",
        "id": 376686259,
        "sender_full_name": "David Renshaw",
        "timestamp": 1689776726
    },
    {
        "content": "<p>Yeah that's a bit alarming. A bug on some <code>curl</code> release is totally out of our hands</p>",
        "id": 376687404,
        "sender_full_name": "Arthur Paulino",
        "timestamp": 1689776920
    },
    {
        "content": "<p>I'm guessing that the problem is that curl <a href=\"https://launchpad.net/ubuntu/+source/curl/7.81.0-1ubuntu1.11\">7.81.0-1ubuntu1.11</a> has a bad fix for <a href=\"https://curl.se/docs/CVE-2023-28321.html\">CVE-2023-28321</a>.</p>",
        "id": 376687544,
        "sender_full_name": "David Renshaw",
        "timestamp": 1689776947
    },
    {
        "content": "<p>What are your <code>curl</code> dependencies now?</p>",
        "id": 376687614,
        "sender_full_name": "Arthur Paulino",
        "timestamp": 1689776959
    },
    {
        "content": "<p>not sure what you're asking, but I can copy/paste a command and post the output, if you want</p>",
        "id": 376688418,
        "sender_full_name": "David Renshaw",
        "timestamp": 1689777089
    },
    {
        "content": "<p>7.81.0-1ubuntu1.11 came out on Monday, so I expect that others will soon hit this problem and a new version should fix it</p>",
        "id": 376688665,
        "sender_full_name": "David Renshaw",
        "timestamp": 1689777130
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243791\">David Renshaw</span> <a href=\"#narrow/stream/287929-mathlib4/topic/leantar.20too.20old.20.28lean.20exe.20cache.20get.20not.20working.29/near/376688418\">said</a>:</p>\n<blockquote>\n<p>not sure what you're asking, but I can copy/paste a command and post the output, if you want</p>\n</blockquote>\n<p>Just <code>curl --version</code>.<br>\nYour previous call had these:</p>\n<blockquote>\n<p>libcurl/7.81.0 OpenSSL/3.0.2 zlib/1.2.11 brotli/1.0.9 zstd/1.4.8 libidn2/2.3.2 libpsl/0.21.0 (+libidn2/2.3.2) libssh/0.9.6/openssl/zlib nghttp2/1.43.0 librtmp/2.3 OpenLDAP/2.5.14</p>\n</blockquote>",
        "id": 376689389,
        "sender_full_name": "Arthur Paulino",
        "timestamp": 1689777272
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">$</span> <span class=\"n\">curl</span> <span class=\"c1\">--version</span>\n<span class=\"n\">curl</span> <span class=\"mi\">7</span><span class=\"bp\">.</span><span class=\"mi\">81</span><span class=\"bp\">.</span><span class=\"mi\">0</span> <span class=\"o\">(</span><span class=\"n\">x86_64</span><span class=\"bp\">-</span><span class=\"n\">pc</span><span class=\"bp\">-</span><span class=\"n\">linux</span><span class=\"bp\">-</span><span class=\"n\">gnu</span><span class=\"o\">)</span> <span class=\"n\">libcurl</span><span class=\"bp\">/</span><span class=\"mi\">7</span><span class=\"bp\">.</span><span class=\"mi\">81</span><span class=\"bp\">.</span><span class=\"mi\">0</span> <span class=\"n\">OpenSSL</span><span class=\"bp\">/</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">2</span> <span class=\"n\">zlib</span><span class=\"bp\">/</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">.</span><span class=\"mi\">11</span> <span class=\"n\">brotli</span><span class=\"bp\">/</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">9</span> <span class=\"n\">zstd</span><span class=\"bp\">/</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">4</span><span class=\"bp\">.</span><span class=\"mi\">8</span> <span class=\"n\">libidn2</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"bp\">.</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">2</span> <span class=\"n\">libpsl</span><span class=\"bp\">/</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">21</span><span class=\"bp\">.</span><span class=\"mi\">0</span> <span class=\"o\">(</span><span class=\"bp\">+</span><span class=\"n\">libidn2</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"bp\">.</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"n\">libssh</span><span class=\"bp\">/</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">9</span><span class=\"bp\">.</span><span class=\"mi\">6</span><span class=\"bp\">/</span><span class=\"n\">openssl</span><span class=\"bp\">/</span><span class=\"n\">zlib</span> <span class=\"n\">nghttp2</span><span class=\"bp\">/</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">43</span><span class=\"bp\">.</span><span class=\"mi\">0</span> <span class=\"n\">librtmp</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"bp\">.</span><span class=\"mi\">3</span> <span class=\"n\">OpenLDAP</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"bp\">.</span><span class=\"mi\">5</span><span class=\"bp\">.</span><span class=\"mi\">14</span>\n<span class=\"n\">Release</span><span class=\"bp\">-</span><span class=\"n\">Date</span><span class=\"o\">:</span> <span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">01</span><span class=\"bp\">-</span><span class=\"mi\">05</span>\n<span class=\"n\">Protocols</span><span class=\"o\">:</span> <span class=\"n\">dict</span> <span class=\"n\">file</span> <span class=\"n\">ftp</span> <span class=\"n\">ftps</span> <span class=\"n\">gopher</span> <span class=\"n\">gophers</span> <span class=\"n\">http</span> <span class=\"n\">https</span> <span class=\"n\">imap</span> <span class=\"n\">imaps</span> <span class=\"n\">ldap</span> <span class=\"n\">ldaps</span> <span class=\"n\">mqtt</span> <span class=\"n\">pop3</span> <span class=\"n\">pop3s</span> <span class=\"n\">rtmp</span> <span class=\"n\">rtsp</span> <span class=\"n\">scp</span> <span class=\"n\">sftp</span> <span class=\"n\">smb</span> <span class=\"n\">smbs</span> <span class=\"n\">smtp</span> <span class=\"n\">smtps</span> <span class=\"n\">telnet</span> <span class=\"n\">tftp</span>\n<span class=\"n\">Features</span><span class=\"o\">:</span> <span class=\"n\">alt</span><span class=\"bp\">-</span><span class=\"n\">svc</span> <span class=\"n\">AsynchDNS</span> <span class=\"n\">brotli</span> <span class=\"n\">GSS</span><span class=\"bp\">-</span><span class=\"n\">API</span> <span class=\"n\">HSTS</span> <span class=\"n\">HTTP2</span> <span class=\"n\">HTTPS</span><span class=\"bp\">-</span><span class=\"n\">proxy</span> <span class=\"n\">IDN</span> <span class=\"n\">IPv6</span> <span class=\"n\">Kerberos</span> <span class=\"n\">Largefile</span> <span class=\"n\">libz</span> <span class=\"n\">NTLM</span> <span class=\"n\">NTLM_WB</span> <span class=\"n\">PSL</span> <span class=\"n\">SPNEGO</span> <span class=\"n\">SSL</span> <span class=\"n\">TLS</span><span class=\"bp\">-</span><span class=\"n\">SRP</span> <span class=\"n\">UnixSockets</span> <span class=\"n\">zstd</span>\n</code></pre></div>",
        "id": 376689759,
        "sender_full_name": "David Renshaw",
        "timestamp": 1689777336
    },
    {
        "content": "<p>aha, the bug has already been reported: <a href=\"https://bugs.launchpad.net/ubuntu/+source/curl/+bug/2028170\">https://bugs.launchpad.net/ubuntu/+source/curl/+bug/2028170</a></p>",
        "id": 376690238,
        "sender_full_name": "David Renshaw",
        "timestamp": 1689777417
    },
    {
        "content": "<p>Can someone on MacOS Arm64 (\"apple silicon\") test <a href=\"https://github.com/leanprover-community/mathlib4/pull/6430\">#6430</a>? A compilation flag that was supposed to be set on windows was instead set on macos aarch64 so those two OSs are the only ones potentially affected. <span class=\"user-mention\" data-user-id=\"497480\">@MohanadAhmed</span> helped me debug the windows issue already</p>",
        "id": 382688742,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1691424343
    },
    {
        "content": "<p>how can I check this?</p>",
        "id": 382689057,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1691424386
    },
    {
        "content": "<p>I have such a mac:)</p>",
        "id": 382689163,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1691424402
    },
    {
        "content": "<p>just check out the branch and make sure <code>lake exe cache get</code> still works</p>",
        "id": 382689185,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1691424405
    },
    {
        "content": "<p>Stuff seems to work, the output is slighly different to what I'm used to but doesn't seem worrying</p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>Output</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\"><pre><span></span><code>info: updating ./lake-packages/std to revision 7601c54efadd70b688a163f5dcc11ae0ccdf7621\ninfo: [1/9] Building Cache.IO\ninfo: [2/9] Compiling Cache.IO\ninfo: [2/9] Building Cache.Hashing\ninfo: [3/9] Compiling Cache.Hashing\ninfo: [3/9] Building Cache.Requests\ninfo: [6/9] Compiling Cache.Requests\ninfo: [6/9] Building Cache.Main\ninfo: [9/9] Linking cache\ninfo: stderr:\nld64.lld: warning: /usr/lib/system/libsystem_kernel.dylib has version 13.4.0, which is newer than target minimum of 13.0.0\nld64.lld: warning: /usr/lib/system/libsystem_platform.dylib has version 13.4.0, which is newer than target minimum of 13.0.0\nld64.lld: warning: /usr/lib/system/libsystem_pthread.dylib has version 13.4.0, which is newer than target minimum of 13.0.0\nleantar is too old; downloading more recent version\nAttempting to download 3133 file(s)\nDownloaded: 3133 file(s) [attempted 3133/3133 = 100%] (100% success)\nDecompressing 3633 file(s)\nunpacked in 3844 ms\n</code></pre></div>\n</div></div>",
        "id": 382690428,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1691424621
    },
    {
        "content": "<p>also, what does <code>ldd ~/.cache/mathlib/leantar-0.1.5</code> show?</p>",
        "id": 382690679,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1691424676
    },
    {
        "content": "<p>(I'm told <code>otool -L</code> is the equivalent in OSX)</p>",
        "id": 382691872,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1691424912
    },
    {
        "content": "<p>I have no idea what that linker warning is about, I've seen it before and it seems to be harmless</p>",
        "id": 382691958,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1691424925
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">ericr</span><span class=\"bp\">/.</span><span class=\"n\">cache</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">leantar</span><span class=\"bp\">-</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">5</span><span class=\"o\">:</span>\n    <span class=\"bp\">/</span><span class=\"n\">usr</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">libiconv.2.dylib</span> <span class=\"o\">(</span><span class=\"n\">compatibility</span> <span class=\"n\">version</span> <span class=\"mi\">7</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"n\">current</span> <span class=\"n\">version</span> <span class=\"mi\">7</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"o\">)</span>\n    <span class=\"bp\">/</span><span class=\"n\">usr</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">libSystem.B.dylib</span> <span class=\"o\">(</span><span class=\"n\">compatibility</span> <span class=\"n\">version</span> <span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"n\">current</span> <span class=\"n\">version</span> <span class=\"mi\">1319</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 382691998,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1691424931
    },
    {
        "content": "<p>hm, the road to static linking is long</p>",
        "id": 382692203,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1691424963
    },
    {
        "content": "<p>I did not actually checkout the branch. One sec...</p>",
        "id": 382692703,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1691425033
    },
    {
        "content": "<p>then again, <a href=\"https://github.com/leanprover/elan/actions/runs/5642000498/job/15281011290#step:7:11\">elan also shows those same libraries</a> for its OSX builds, so I'm going to say it's fine</p>",
        "id": 382692929,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1691425078
    },
    {
        "content": "<p>Still clean</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>info:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover/std4<span class=\"w\"> </span>to<span class=\"w\"> </span>./lake-packages/std\ninfo:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/gebner/quote4<span class=\"w\"> </span>to<span class=\"w\"> </span>./lake-packages/Qq\ninfo:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/JLimperg/aesop<span class=\"w\"> </span>to<span class=\"w\"> </span>./lake-packages/aesop\ninfo:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/mhuisi/lean4-cli.git<span class=\"w\"> </span>to<span class=\"w\"> </span>./lake-packages/Cli\ninfo:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/EdAyers/ProofWidgets4<span class=\"w\"> </span>to<span class=\"w\"> </span>./lake-packages/proofwidgets\ninfo:<span class=\"w\"> </span>Downloading<span class=\"w\"> </span>proofwidgets/v0.0.13/macOS-64.tar.gz\ninfo:<span class=\"w\"> </span>Unpacking<span class=\"w\"> </span>proofwidgets/v0.0.13/macOS-64.tar.gz\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">1</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Building<span class=\"w\"> </span>Cache.IO\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">2</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Compiling<span class=\"w\"> </span>Cache.IO\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">2</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Building<span class=\"w\"> </span>Cache.Hashing\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">3</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Compiling<span class=\"w\"> </span>Cache.Hashing\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">3</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Building<span class=\"w\"> </span>Cache.Requests\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">6</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Compiling<span class=\"w\"> </span>Cache.Requests\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">6</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Building<span class=\"w\"> </span>Cache.Main\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">7</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Compiling<span class=\"w\"> </span>Cache.Main\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">9</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Linking<span class=\"w\"> </span>cache\nAttempting<span class=\"w\"> </span>to<span class=\"w\"> </span>download<span class=\"w\"> </span><span class=\"m\">3633</span><span class=\"w\"> </span>file<span class=\"o\">(</span>s<span class=\"o\">)</span>\nDownloaded:<span class=\"w\"> </span><span class=\"m\">3633</span><span class=\"w\"> </span>file<span class=\"o\">(</span>s<span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span>attempted<span class=\"w\"> </span><span class=\"m\">3633</span>/3633<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">100</span>%<span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">100</span>%<span class=\"w\"> </span>success<span class=\"o\">)</span>\nDecompressing<span class=\"w\"> </span><span class=\"m\">3633</span><span class=\"w\"> </span>file<span class=\"o\">(</span>s<span class=\"o\">)</span>\nunpacked<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"m\">2405</span><span class=\"w\"> </span>ms\n</code></pre></div>",
        "id": 382693261,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1691425140
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306577\">@Matthew Ballard</span> did you get a <code>leantar is too old; downloading more recent version</code> message?</p>",
        "id": 382693406,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1691425170
    },
    {
        "content": "<p>No</p>",
        "id": 382693454,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1691425181
    },
    {
        "content": "<p>does <code>~/.cache/mathlib/leantar-0.1.5</code> exist?</p>",
        "id": 382693526,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1691425197
    },
    {
        "content": "<p>Steps </p>\n<ul>\n<li>remove mathlib </li>\n<li>clone a new copy</li>\n<li>checkout branch </li>\n<li><code>lake exe  cache get!</code></li>\n</ul>",
        "id": 382693824,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1691425250
    },
    {
        "content": "<p>you must have gotten the message on a previous run then</p>",
        "id": 382693942,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1691425274
    },
    {
        "content": "<p>I cloned a completely new copy</p>",
        "id": 382694026,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1691425291
    },
    {
        "content": "<p>the cache won't be cleared by those steps</p>",
        "id": 382694048,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1691425294
    },
    {
        "content": "<p>Ah ok. I see</p>",
        "id": 382696023,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1691425711
    },
    {
        "content": "<p>I did get that error on a previous run</p>",
        "id": 382696041,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1691425717
    },
    {
        "content": "<p>Do you want me to clear and rerun?</p>",
        "id": 382696403,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1691425796
    },
    {
        "content": "<p>I did and nothing changed except the <code>leantar too old</code></p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>info:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover/std4<span class=\"w\"> </span>to<span class=\"w\"> </span>./lake-packages/std\ninfo:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/gebner/quote4<span class=\"w\"> </span>to<span class=\"w\"> </span>./lake-packages/Qq\ninfo:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/JLimperg/aesop<span class=\"w\"> </span>to<span class=\"w\"> </span>./lake-packages/aesop\ninfo:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/mhuisi/lean4-cli.git<span class=\"w\"> </span>to<span class=\"w\"> </span>./lake-packages/Cli\ninfo:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/EdAyers/ProofWidgets4<span class=\"w\"> </span>to<span class=\"w\"> </span>./lake-packages/proofwidgets\ninfo:<span class=\"w\"> </span>Downloading<span class=\"w\"> </span>proofwidgets/v0.0.13/macOS-64.tar.gz\ninfo:<span class=\"w\"> </span>Unpacking<span class=\"w\"> </span>proofwidgets/v0.0.13/macOS-64.tar.gz\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">1</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Building<span class=\"w\"> </span>Cache.IO\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">2</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Compiling<span class=\"w\"> </span>Cache.IO\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">2</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Building<span class=\"w\"> </span>Cache.Hashing\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">3</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Compiling<span class=\"w\"> </span>Cache.Hashing\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">3</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Building<span class=\"w\"> </span>Cache.Requests\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">5</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Compiling<span class=\"w\"> </span>Cache.Requests\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">5</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Building<span class=\"w\"> </span>Cache.Main\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">7</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Compiling<span class=\"w\"> </span>Cache.Main\ninfo:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">9</span>/9<span class=\"o\">]</span><span class=\"w\"> </span>Linking<span class=\"w\"> </span>cache\nleantar<span class=\"w\"> </span>is<span class=\"w\"> </span>too<span class=\"w\"> </span>old<span class=\"p\">;</span><span class=\"w\"> </span>downloading<span class=\"w\"> </span>more<span class=\"w\"> </span>recent<span class=\"w\"> </span>version\nAttempting<span class=\"w\"> </span>to<span class=\"w\"> </span>download<span class=\"w\"> </span><span class=\"m\">3633</span><span class=\"w\"> </span>file<span class=\"o\">(</span>s<span class=\"o\">)</span>\nDownloaded:<span class=\"w\"> </span><span class=\"m\">3633</span><span class=\"w\"> </span>file<span class=\"o\">(</span>s<span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span>attempted<span class=\"w\"> </span><span class=\"m\">3633</span>/3633<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">100</span>%<span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">100</span>%<span class=\"w\"> </span>success<span class=\"o\">)</span>\nDecompressing<span class=\"w\"> </span><span class=\"m\">3633</span><span class=\"w\"> </span>file<span class=\"o\">(</span>s<span class=\"o\">)</span>\nunpacked<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"m\">3897</span><span class=\"w\"> </span>ms\n</code></pre></div>",
        "id": 382697401,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1691425982
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/287929-mathlib4/topic/leantar.20too.20old.20.28lean.20exe.20cache.20get.20not.20working.29/near/382692929\">said</a>:</p>\n<blockquote>\n<p>then again, <a href=\"https://github.com/leanprover/elan/actions/runs/5642000498/job/15281011290#step:7:11\">elan also shows those same libraries</a> for its OSX builds, so I'm going to say it's fine</p>\n</blockquote>\n<p>Yes, one does not simply static-link on macOS</p>",
        "id": 382699568,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1691426443
    }
]