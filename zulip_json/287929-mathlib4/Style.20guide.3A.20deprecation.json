[
    {
        "content": "<p>I'm new to contributing to mathlib and needed to deprecate a lemma in favor of one with a different name to match style. I looked in the style guide online and didn't find anything about deprecation in the style guide. I found <a href=\"#narrow/channel/287929-mathlib4/topic/how.20to.20deprecate/near/481961430\">another thread</a> asking for clarification and also <a href=\"#narrow/channel/270676-lean4/topic/.40.5Bdeprecated.5D.20requires.20a.20replacement.20or.20message.2C.20and.20since\">this thread</a> which suggested adding more info to <code>@[deprecated]</code> than what the <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Tactic/DeprecateTo.html\"><code>deprecate to</code></a>  command currently adds, but maybe this command is not what people commonly use?</p>\n<p>Anyways, it'd be nice to have a subsection in the style guide on deprecation, and though I have no idea what I'm talking about, I figured I'd write a suggestion to get the ball rolling. Please nitpick or re-write:</p>\n<h3>Deprecation</h3>\n<p>Deleting, renaming, or changing theorem definitions can cause downstreams projects that rely on these definitions to fail to compile. Any publicly exposed theorem definitions that are being changed should be gracefully transitioned by keeping the old theorem statement with a<code>@[deprecated]</code> attribute, to warn downstream projects to transition away from deprecated definitions before they are deleted. Renamed theorems can use a deprecated <code>alias</code> to the new name, while in cases where the theorem is not being replaced, the deprecated theorem definition can be marked with an attribute, like so:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">new_name</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n<span class=\"kd\">@[</span><span class=\"n\">deprecated</span><span class=\"w\"> </span><span class=\"n\">new_name</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">since</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"YYYY-MM-DD\"</span><span class=\"o\">)</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">alias</span><span class=\"w\"> </span><span class=\"n\">old_name</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">new_name</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">deprecated</span><span class=\"w\"> </span><span class=\"s2\">\"This theorem is deprecated in favor of using ... with ...\"</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">since</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"YYYY-MM-DD\"</span><span class=\"o\">)</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">example_thm</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>The <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Tactic/DeprecateTo.html\"><code>deprecate to</code></a> command can help generate alias definitions. The <code>@[deprecated]</code> attribute should always include the deprecation date, and either the new name for the theorem when it is being renamed or kept substantially the same, or a string to explain how transition away form the old definition when a new version is no longer being provided.</p>",
        "id": 504389853,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1741524076
    },
    {
        "content": "<p>Note that there are two code snippets, <code>deprecated</code> and <code>deprecated alias</code>, to help you write deprecations</p>",
        "id": 504390473,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1741524574
    },
    {
        "content": "<p>Good point, I've edited the original text to make it more explicit about what I'm showing.</p>",
        "id": 504393961,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1741527128
    },
    {
        "content": "<p>Going to ask for feedback one more time before PRing it. (I'm trying to figure out what best practices are in proposing this, so please nitpick.)</p>",
        "id": 504687029,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1741640617
    },
    {
        "content": "<p>I think the nitpicks are more easily made through the github UI, so go ahead and make the PR and link it from here</p>",
        "id": 504689348,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1741641504
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/leanprover-community.github.io/pull/604\">https://github.com/leanprover-community/leanprover-community.github.io/pull/604</a></p>",
        "id": 504689700,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1741641670
    }
]