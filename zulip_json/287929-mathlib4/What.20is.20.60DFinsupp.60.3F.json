[
    {
        "content": "<p>I'm trying to find the definition of the internal <code>DirectSum</code> for modules. This led me to <code>DFinsupp</code> and I'm trying to parse exactly what it means.</p>\n<p>The definition in mathlib is below:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">DFinsupp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Zero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">mk'</span><span class=\"w\"> </span><span class=\"bp\">::</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The underlying function of a dependent function with finite support (aka `DFinsupp`). -/</span>\n<span class=\"w\">  </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The support of a dependent function with finite support (aka `DFinsupp`). -/</span>\n<span class=\"w\">  </span><span class=\"n\">support'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Trunc</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Multiset</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>\n<p>From the vibes I'm getting, I think it says that finitely many <code>β i</code> are non-zero, but I'm confused on how <code>support'</code> enforces this. I also don't understand what <code>Trunc</code> is?</p>\n<p>And if I'm correct in the above, does that mean that a <code>DirectSum</code> of module is just an (arbitrarily large) product of modules with finite non-zero entries?</p>",
        "id": 537937983,
        "sender_full_name": "Luna",
        "timestamp": 1757102184
    },
    {
        "content": "<p>It basically says there exists a multiset, and each i is either in that (finite) multiset or maps to zero</p>",
        "id": 537939927,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1757102989
    },
    {
        "content": "<p>I have only the vaguest idea of what Trunc is, though</p>",
        "id": 537939959,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1757103006
    },
    {
        "content": "<p><a href=\"http://DFinsupp.support\">DFinsupp.support</a> (without ') probably explains more</p>",
        "id": 537940041,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1757103040
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=DFinsupp.support#doc\">docs#DFinsupp.support</a></p>",
        "id": 537940213,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1757103142
    },
    {
        "content": "<p>sorry I misremembered how the doc was structured</p>",
        "id": 537940576,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1757103328
    },
    {
        "content": "<p>The main explanation is in the header of that page</p>",
        "id": 537940608,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1757103343
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"769874\">@Luna</span>, is there something we could add to the docstring of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=DFinsupp#doc\">docs#DFinsupp</a> itself to make this more obvious? Ideally the docstring should be enough to tell you what DFinsupp <em>means</em> without you having to dig into how it's <em>implemented</em>.</p>",
        "id": 537955330,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757111349
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span>  i think a link to wikipedia would be good. When you pointed out to me to use DFinsupp,  the docs where obscur to me, but when reading the wikipedia page, it all became clear :<br>\n<a href=\"https://en.wikipedia.org/wiki/Support_(mathematics)\">https://en.wikipedia.org/wiki/Support_(mathematics)</a></p>\n<p>And in general, i think mathlib should point whenever possible to wikipedia or another math source to expand on the mathematics behind some mathlib definitions</p>",
        "id": 537963614,
        "sender_full_name": "Alfredo Moreira-Rosa",
        "timestamp": 1757119170
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/channel/287929-mathlib4/topic/What.20is.20.60DFinsupp.60.3F/near/537939959\">said</a>:</p>\n<blockquote>\n<p>I have only the vaguest idea of what Trunc is, though</p>\n</blockquote>\n<p>It's the quotient by the always true relationship</p>",
        "id": 537969580,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1757127272
    },
    {
        "content": "<p>The idea with <code>DFinsupp</code> is that it's often computationally expensive/and or requires extra decidability assumptions to compute the <em>exact</em> support of a function (e.g. the support of <code>f + g</code> might be an arbitrary subset of the union of both supports), so you instead compute some superset. What <code>Trunc</code> does is ensure that even if two finsupps have different support supersets, they remain propositionally equal.</p>",
        "id": 537969663,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1757127398
    },
    {
        "content": "<p>(My question is, what stops us from copying this design to <code>Finsupp</code>?)</p>",
        "id": 537980768,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1757141027
    },
    {
        "content": "<p>Oh right, the clever thing is that the multiset can still include elements that map to zero, but nothing outside it can map to something nonzero</p>",
        "id": 537985810,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1757147133
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/287929-mathlib4/topic/What.20is.20.60DFinsupp.60.3F/near/537980768\">said</a>:</p>\n<blockquote>\n<p>(My question is, what stops us from copying this design to <code>Finsupp</code>?)</p>\n</blockquote>\n<p>There'd be little point, we might as well just make Finsupp an abbrev for DFinsupp if we're going to use the same design</p>",
        "id": 537986337,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757147553
    },
    {
        "content": "<p>Well, what stops us from doing that?</p>",
        "id": 537986353,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1757147575
    },
    {
        "content": "<p>Is it just \"no one has wanted to do it yet\", or are there other considerations?</p>",
        "id": 537986365,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1757147585
    },
    {
        "content": "<p>It's too big a thing to do / review in one go</p>",
        "id": 537986806,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757148082
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> is working on adding some abstraction barriers which will make it easier to do piecewise</p>",
        "id": 537986850,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757148120
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/25324\">#25324</a> also works in that direction</p>",
        "id": 537986875,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757148160
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/What.20is.20.60DFinsupp.60.3F/near/537955330\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"769874\">Luna</span>, is there something we could add to the docstring of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=DFinsupp#doc\">docs#DFinsupp</a> itself to make this more obvious? Ideally the docstring should be enough to tell you what DFinsupp <em>means</em> without you having to dig into how it's <em>implemented</em>.</p>\n</blockquote>\n<p>Ah the above makes sense. I think it was just the combination of seeing <code>Trunc</code> and <code>Multiset</code> that through me for a loop.</p>\n<p>Also is there a reason why its defined with <code>Multiset</code> instead of <code>Finset</code>? Could support equally be defined like <code>support' : {s : Finset ι // ∀ i, i ∉ s → β i = 0}</code>?</p>",
        "id": 538017925,
        "sender_full_name": "Luna",
        "timestamp": 1757178854
    },
    {
        "content": "<p>Finset would require decidable equality for adding the functions</p>",
        "id": 538018081,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757179046
    },
    {
        "content": "<p>Oh ok! To compute a <code>Finset</code>, you need to remove duplicates which means that equality needs to be decidable. So the solution is to use a Multiset and just don't remove duplicates.</p>",
        "id": 538018188,
        "sender_full_name": "Luna",
        "timestamp": 1757179182
    },
    {
        "content": "<p>A tangential question, why does Mathlib care about computability? Are there efforts to create algorithms from various theorems?</p>",
        "id": 538018223,
        "sender_full_name": "Luna",
        "timestamp": 1757179217
    },
    {
        "content": "<p>Computability is a property of definitions not theorems</p>",
        "id": 538018284,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757179281
    },
    {
        "content": "<p>Or maybe I'm using the wrong word. Why is decidability important for Mathlib?</p>",
        "id": 538018322,
        "sender_full_name": "Luna",
        "timestamp": 1757179335
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"769874\">Luna</span> <a href=\"#narrow/channel/287929-mathlib4/topic/What.20is.20.60DFinsupp.60.3F/near/538018322\">said</a>:</p>\n<blockquote>\n<p>Or maybe I'm using the wrong word. Why is decidability important for Mathlib?</p>\n</blockquote>\n<p>it means you can <code>#eval</code> your definitions</p>",
        "id": 538018355,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1757179388
    },
    {
        "content": "<p>usually it also means you can <code>#reduce</code> your definitions</p>",
        "id": 538018363,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1757179403
    },
    {
        "content": "<p>It's not considered particularly important in mathlib, but sometimes it can be helpful to be able to tell the computer \"just run the algorithm\"</p>",
        "id": 538021903,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1757182986
    },
    {
        "content": "<p>Decidability is one of those things that's great when it works and a total pain point when it doesn't</p>",
        "id": 538041650,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1757206313
    },
    {
        "content": "<p>I have another related question, what is the conceptual definition of <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Data/DFinsupp/BigOperators.html#DFinsupp.sumAddHom\"><code>DFinsupp.sumAddHom</code></a>? I'm having a lot of trouble parsing/following along its definition. Can someone write out in standard mathematical notation what the function is supposed to be?</p>",
        "id": 538127688,
        "sender_full_name": "Luna",
        "timestamp": 1757304780
    },
    {
        "content": "<p>And thanks for the responses all.  <span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span>  I'm still on chapter 10 for MIL but it hasn't talked much about decidability and its uses with <code>#eval</code>. When is it used in mathlib? Off the top of my head, I'm imagining it can be used for not just knowing a matrix can be put into RREF but actually compute the entries of the matrix when its reduced to RREF?</p>",
        "id": 538128622,
        "sender_full_name": "Luna",
        "timestamp": 1757305216
    },
    {
        "content": "<p>Given a iota-indexed dfinsupp f and a iota-indexed collection of functions φ that preserve addition (i.e. g (x + y) = g x + g y), sumAddHom φ is another function that preserves addition, and sumAddHom φ f is the sum of φ i (f i) for all i in the support of f</p>",
        "id": 538149321,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1757316548
    },
    {
        "content": "<p>So if iota is {0, 1} and \\phi 0 (f 0) = 3, \\phi 1 (f 0) = 5, then sumAddHom \\phi f = 3 + 5</p>",
        "id": 538149514,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1757316626
    },
    {
        "content": "<p>I think I got that right, at least</p>",
        "id": 538149526,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1757316632
    },
    {
        "content": "<p>Ah! Ok so putting it into my own words, its doing the following:</p>\n<p>Given <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Φ</mi><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>ϕ</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><msub><mi>ϕ</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\Phi = (\\phi_0, \\phi_1, \\ldots)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Φ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mclose\">)</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">X = (x_0, x_1, \\ldots)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mclose\">)</span></span></span></span>, where <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϕ</mi><mi>i</mi></msub><mo>:</mo><msub><mi>M</mi><mi>i</mi></msub><mo>→</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">\\phi_i : M_i \\rightarrow N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> is a module homomorphism and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><msub><mi>M</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i \\in M_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> s.t. finitely many <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> are non-zero. Then <code>sumAddHom Φ X</code> is</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>ϕ</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sum_{i} \\phi_i(x_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.3277em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>And this is well-defined because there is finitely non-zero <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> (e.g. a finite support).</p>\n<p>Is that correct?</p>",
        "id": 538236277,
        "sender_full_name": "Luna",
        "timestamp": 1757340472
    },
    {
        "content": "<p>Yes that looks right. The input is additive group homs <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>M</mi><mi>i</mi></msub><mo>→</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">M_i\\to N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> for all <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> and the output is an additive group hom <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>⨁</mo><mi>i</mi></msub><msub><mi>M</mi><mi>i</mi></msub><mo>→</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">\\bigoplus_i M_i \\to N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0497em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">⨁</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> defined as the sum of the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϕ</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\phi_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> (i.e. how you said it was defined).</p>",
        "id": 538258885,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1757345740
    },
    {
        "content": "<p>I agree that the docstring is useless. Please make a PR changing it! The docstring seems to be assuming that you've read some of the docstrings above it, which IMO a docstring should never do.</p>",
        "id": 538259168,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1757345828
    },
    {
        "content": "<p>Note that using <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>⨁</mo></mrow><annotation encoding=\"application/x-tex\">\\bigoplus</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">⨁</span></span></span></span> in the docstring would be wrong, since that <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=DirectSum.toModule#doc\">docs#DirectSum.toModule</a> instead!</p>",
        "id": 538261508,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757346384
    },
    {
        "content": "<p>Bleurgh so we have two ways of saying the same thing?</p>",
        "id": 538267225,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1757347700
    },
    {
        "content": "<p>One has convolutive multiplication, the other doesn't (and should have pointwise)</p>",
        "id": 538273339,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757349319
    },
    {
        "content": "<p>DFinsupp is to DirectSum as Finsupp is to AddMonoidAlgebra</p>",
        "id": 538273439,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757349345
    }
]