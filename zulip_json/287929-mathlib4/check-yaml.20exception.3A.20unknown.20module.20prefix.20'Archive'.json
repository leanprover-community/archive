[
    {
        "content": "<p>I'm trying to run check-yaml locally, and I'm getting the following issue:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">~/</span><span class=\"n\">dev</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">check</span><span class=\"bp\">-</span><span class=\"n\">yaml</span>\n<span class=\"n\">uncaught</span><span class=\"w\"> </span><span class=\"n\">exception</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">unknown</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"kn\">prefix</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Archive'</span>\n\n<span class=\"n\">No</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Archive'</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Archive</span><span class=\"bp\">.</span><span class=\"n\">olean'</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">search</span><span class=\"w\"> </span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"n\">entries</span><span class=\"o\">:</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Cli</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">batteries</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Qq</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">aesop</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">proofwidgets</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">importGraph</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">LeanSearchClient</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">plausible</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span>\n<span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">mei</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---v4.19.0-rc2/lib/lean</span>\n<span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">mei</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---v4.19.0-rc2/lib/lean</span>\n</code></pre></div>\n<p>moreover, when I try running <code>lake exe cache get</code>, this happens:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">~/</span><span class=\"n\">dev</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get</span>\n<span class=\"n\">Expected</span><span class=\"w\"> </span><span class=\"n\">exactly</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">name</span>\n<span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"mf\">4.19</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x86_64</span><span class=\"bp\">-</span><span class=\"n\">unknown</span><span class=\"bp\">-</span><span class=\"n\">linux</span><span class=\"bp\">-</span><span class=\"n\">gnu</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">commit</span><span class=\"w\"> </span><span class=\"n\">fafd381c9059</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Release</span><span class=\"o\">)</span>\n<span class=\"n\">Miscellaneous</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"n\">h</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"c1\">--help             display this message</span>\n<span class=\"w\">      </span><span class=\"c1\">--features         display features compiler provides (eg. LLVM support)</span>\n<span class=\"o\">[</span><span class=\"n\">etcetc</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>what gives?</p>",
        "id": 510752665,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744054729
    },
    {
        "content": "<p>For the latter question: <code>lake exe...</code> not <code>lean exe...</code>.</p>",
        "id": 510752952,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744054852
    },
    {
        "content": "<p>oh, right, typo on that front &gt;.&lt;</p>",
        "id": 510753041,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744054892
    },
    {
        "content": "<p>my mental hash function of \"first letter of name + length + vague purpose\" got a collision i think</p>",
        "id": 510753151,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744054933
    },
    {
        "content": "<p>now <code>cache get</code> completes successfully and check-yaml fails just as before</p>",
        "id": 510753214,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744054963
    },
    {
        "content": "<p>For the former, I can confirm that I get the same error as you running <code>lake exe check-yaml</code> in mathlib, so perhaps that's not what you're supposed to do (I know nothing about check-yaml)</p>",
        "id": 510753216,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744054964
    },
    {
        "content": "<p>the CI gives a different error that isn't very descriptive either: <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/14317787908/job/40127784545?pr=23801\">https://github.com/leanprover-community/mathlib4/actions/runs/14317787908/job/40127784545?pr=23801</a></p>",
        "id": 510753268,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744054990
    },
    {
        "content": "<p>I guess I'll poke at the Python...</p>",
        "id": 510753537,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744055105
    },
    {
        "content": "<p>not sure where I got <code>lake exe check-yaml</code> into my mind because apparently that's not supposed to work without first having a Python script convert the yaml to json</p>",
        "id": 510753630,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744055145
    },
    {
        "content": "<p>The CI run is probably hitting <a href=\"https://github.com/leanprover-community/mathlib4/blob/abd344e43d9dffb162c7370488b86c6e8188db0b/scripts/yaml_check.py#L175\">this check</a>. I'd have to do some more digging to be sure, but I suspect that the check is there since our website can't render a YAML file with nesting &gt; 3.</p>",
        "id": 510754870,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1744055609
    },
    {
        "content": "<p>It can, <code>undergrad.yaml</code> uses that possibility</p>",
        "id": 510755122,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744055703
    },
    {
        "content": "<p>for example here:<br>\n<a href=\"/user_uploads/3121/XzjOuJgdEWdWeS7X_oQRpI1X/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/XzjOuJgdEWdWeS7X_oQRpI1X/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"978x225\" src=\"/user_uploads/thumbnail/3121/XzjOuJgdEWdWeS7X_oQRpI1X/image.png/840x560.webp\"></a></div>",
        "id": 510755235,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744055743
    },
    {
        "content": "<p>pretty sure they're rendered by the same template</p>",
        "id": 510755376,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744055780
    },
    {
        "content": "<p>the thing I want to do is have it list \"computable function ([in terms of general recursive functions], [in terms of Turing machines])\"</p>",
        "id": 510755510,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744055822
    },
    {
        "content": "<p>They're different templates: <a href=\"https://github.com/leanprover-community/leanprover-community.github.io/blob/f10b4a01962fca455236adf82db771701a54a51a/templates/mathlib-overview.html\">here's the one for the overview</a> and <a href=\"https://github.com/leanprover-community/leanprover-community.github.io/blob/f10b4a01962fca455236adf82db771701a54a51a/templates/undergrad.html\">here's the one for the undergrad page</a>.</p>",
        "id": 510755936,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1744055965
    },
    {
        "content": "<p>If you'd like to PR a corresponding change to the overview template to support what you want, I'd be happy to review it!</p>",
        "id": 510756026,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1744055991
    },
    {
        "content": "<p>WIP at <a href=\"https://github.com/leanprover-community/leanprover-community.github.io/pull/616\">https://github.com/leanprover-community/leanprover-community.github.io/pull/616</a>, any idea/hints on how to test this with the data from my mathlib PR?</p>",
        "id": 510765047,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744059226
    },
    {
        "content": "<p>gah why is it not doing CI</p>",
        "id": 510766091,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744059684
    },
    {
        "content": "<p>I don't know about that repo but for mathlib CI only functions correctly if the PR is from a branch (rather than a fork).</p>",
        "id": 510766280,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744059764
    },
    {
        "content": "<p>should I have repo access for that repo as well?</p>",
        "id": 510766372,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744059808
    },
    {
        "content": "<p>No, the website repo uses forks</p>",
        "id": 510768237,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1744060521
    },
    {
        "content": "<p>But I also don't know if many people look at it</p>",
        "id": 510768251,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1744060531
    },
    {
        "content": "<p>okay, i think i got it to build locally</p>",
        "id": 510768666,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744060683
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"123965\">Bryan Gin-ge Chen</span> <a href=\"#narrow/channel/287929-mathlib4/topic/check-yaml.20exception.3A.20unknown.20module.20prefix.20'Archive'/near/510756026\">said</a>:</p>\n<blockquote>\n<p>If you'd like to PR a corresponding change to the overview template to support what you want, I'd be happy to review it!</p>\n</blockquote>\n<p>It was a bit cumbersome due to the sluggish build process, but I managed to test my changes and they're ready for review: <a href=\"https://github.com/leanprover-community/leanprover-community.github.io/pull/616\">https://github.com/leanprover-community/leanprover-community.github.io/pull/616</a></p>",
        "id": 510801929,
        "sender_full_name": "Maja Kądziołka",
        "timestamp": 1744078536
    },
    {
        "content": "<p>Thanks! I'll try to take a look this week.</p>",
        "id": 510933102,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1744118730
    }
]