[
    {
        "content": "<p>CI is failing on some PRs and the problem is due to some call to <code>simp says</code> not producing the expected result, see for example <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/17148350485/job/48648891200?pr=27152\">here</a>. I am not sure what the correct fix is but I have been trying to collect these errors and replace the calls to <code>simp says</code> by <code>simp only</code> in a PR: <a href=\"https://github.com/leanprover-community/mathlib4/pull/28775\">#28775</a></p>",
        "id": 535671443,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1755865274
    },
    {
        "content": "<p>See Kim's comment 2 here <a class=\"message-link\" href=\"/#narrow/channel/428973-nightly-testing/topic/Mathlib.20status.20updates/near/535229602\">#nightly-testing &gt; Mathlib status updates @ ðŸ’¬</a></p>",
        "id": 535671779,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1755865404
    },
    {
        "content": "<p>These should hopefully go away if you merge <code>master</code>, which includes <a href=\"https://github.com/leanprover-community/mathlib4/pull/28764\">#28764</a> covering some of the same fixes. The one in LucasLehmer looks new though...</p>",
        "id": 535671874,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1755865434
    },
    {
        "content": "<p>Thanks for putting together this PR by the way; if there are any fixes that remain after merging <code>master</code>, I'll be happy to merge it quickly whenever you think it's ready!</p>",
        "id": 535672700,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1755865759
    },
    {
        "content": "<p>I see that the solution you used was to fix the <code>simp says</code> and not replace it by a <code>simp only</code>. Is that what I should do with the other (possible) errors?</p>",
        "id": 535672930,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1755865841
    },
    {
        "content": "<p>Good question. Let's try and fix them for now. </p>\n<p>We may end up removing all the <code>says</code> at some point, but in that case we'll still need the correct <code>simp only</code> there, I think.</p>",
        "id": 535674325,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1755866358
    },
    {
        "content": "<p>The <code>simp</code> call in LucasLehmer can just be deleted so that's an easy fix <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span></p>",
        "id": 535675324,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1755866762
    },
    {
        "content": "<p>I would check that the proof isn't getting much slower though -- there's a chance that the simp was helping Lean avoid some unfolding.</p>",
        "id": 535677256,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1755867519
    },
    {
        "content": "<p>I have checked that there is no significant timing difference with or without the <code>simp</code> call. </p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/28775\">#28775</a> is ready for review.</p>",
        "id": 535678480,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1755867981
    },
    {
        "content": "<p>If a <code>simp says</code> breaks, I think we should replace it by the fixed <code>simp says</code> and not by <code>simp only</code>: the point of <code>simp says</code> is to emphasize which lemmas are important, and which lemmas are just coming from the simpset. This is valuable information, which is lost in the <code>simp only</code>.</p>",
        "id": 535693447,
        "sender_full_name": "SÃ©bastien GouÃ«zel",
        "timestamp": 1755872416
    },
    {
        "content": "<p>Yes, <code>simp? says</code> is complicated: it preserved useful information for humans, which is great, but comes at a pretty annoying maintenance cost (in particular, failures that you can't see until CI, and quite often these failures fall on the people looking after <code>nightly-testing</code>).</p>",
        "id": 535763945,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1755901861
    },
    {
        "content": "<p>I'm seeing a bunch of <code>simp? says</code> errors in <a href=\"https://github.com/leanprover-community/mathlib4/pull/26766\">#26766</a> (after merging master).<br>\nMore specifically (see <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/17176874090/job/48733966023?pr=26766\">here</a>),</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>  Error: error: Mathlib/Algebra/Order/CauSeq/Basic.lean:440:2: Tactic `simp? [not_forall]\n     at nk` produced `simp only [gt_iff_lt, ge_iff_le, not_exists, not_and, not_forall, Classical.not_imp, not_le] at nk`,\n  but was expecting it to produce `simp only [gt_iff_lt, ge_iff_le, not_exists, not_and, not_forall, not_le] at nk`!\n\n  Error: error: Mathlib/CategoryTheory/Limits/Fubini.lean:108:18: Tactic `simp?  at this` produced `simp only [Category.id_comp, map_id, NatTrans.id_app] at this`,\n  but was expecting it to produce `simp only [Category.id_comp, Functor.map_id, NatTrans.id_app] at this`!\n\n  Error: error: Mathlib/CategoryTheory/GuitartExact/VerticalComposition.lean:131:6: Tactic `simp? [w'', Î±,\n    Î²]` produced `simp only [Functor.comp_obj, vComp'_app, Iso.trans_inv, Functor.isoWhiskerLeft_inv, Iso.symm_inv, assoc,\n      NatTrans.comp_app, Functor.id_obj, Functor.rightUnitor_inv_app, Functor.whiskerLeft_app, Functor.associator_inv_app,\n      comp_id, id_comp, vComp_app, Functor.map_comp, Equivalence.inv_fun_map, CatCommSq.vInv_iso_hom_app, Iso.trans_hom,\n      Functor.isoWhiskerLeft_hom, Iso.symm_hom, Functor.associator_hom_app, Functor.rightUnitor_hom_app,\n      Iso.hom_inv_id_app_assoc, w'', Î±, Î²]`,\n  but was expecting it to produce `simp only [Functor.comp_obj, vComp'_app, Iso.trans_inv, Functor.isoWhiskerLeft_inv, Iso.symm_inv, assoc,\n      NatTrans.comp_app, Functor.id_obj, Functor.rightUnitor_inv_app, Functor.whiskerLeft_app, Functor.associator_inv_app,\n      comp_id, id_comp, vComp_app, Functor.map_comp, Equivalence.inv_fun_map, CatCommSq.vInv_iso_hom_app, Iso.trans_hom,\n      Functor.isoWhiskerLeft_hom, Iso.symm_hom, Functor.associator_hom_app, Functor.rightUnitor_hom_app,\n      Iso.hom_inv_id_app_assoc, w'', this, Î±, Î²]`!\n\n  Error: error: Mathlib/CategoryTheory/Limits/FilteredColimitCommutesFiniteLimit.lean:83:4: Tactic `simp? [colimit_eq_iff]\n     at\n      h` produced `simp only [comp_obj, colim_obj, Î¹_colimitLimitToLimitColimit_Ï€_apply, colimit_eq_iff, curry_obj_obj_obj,\n      curry_obj_obj_map] at h`,\n  but was expecting it to produce `simp only [Functor.comp_obj, colim_obj, Î¹_colimitLimitToLimitColimit_Ï€_apply, colimit_eq_iff, curry_obj_obj_obj,\n      curry_obj_obj_map] at h`!\n</code></pre></div>\n<p>What should I do about this?</p>",
        "id": 535813492,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1755963503
    },
    {
        "content": "<p>Can you make a separate PR just fixing these? (You probably need to make an artificial change to each of these files to force a proper build, and hopefully then you can fix them.) If this path works, it seems the nicest.</p>",
        "id": 535813920,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1755963950
    },
    {
        "content": "<p>If it doesn't, we have a much bigger problem...</p>",
        "id": 535813932,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1755963959
    },
    {
        "content": "<p>I think if you put <code>set_option says.verify true</code> at the top of the file these warnings should pop up. I wish there was an easier way to fix these all at once. In <a href=\"https://github.com/leanprover-community/mathlib4/pull/28764\">#28764</a> I made a change to <code>Mathlib.Init</code> to try to force the warnings in the rest of mathlib to show up, but it didn't work... maybe I just need to do a rebuild from scratch locally with <code>CI=true</code>.</p>\n<p><strong>edit</strong>: I've started a build while I go for lunch. Hopefully I can have a PR ready later.</p>",
        "id": 535815436,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1755965639
    },
    {
        "content": "<p>I'm confused: To create the PR, I did <code>git switch master; git pull; git switch -c &lt;new branch&gt;</code>, but I then cannot find the first <code>simp? says</code> that gave an error in the relevant file (Mathlib/Algebra/Order/CauSeq/Basic.lean, line 440).</p>\n<p>My suspicion is that I might have done something wrong when I tried to merge master previously (what I did was <code>git merge upstream/master</code> and then <code>git push</code>); IIRC it looked like the CI run after that produced the same errors as the one before, which I think is suspicious.</p>",
        "id": 535816300,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1755966854
    },
    {
        "content": "<p>I guess I should have <code>pull</code>ed before <code>merge</code>ing...</p>",
        "id": 535816718,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1755967396
    },
    {
        "content": "<p>So I merged master again, and now it seems to be OK:<br>\nSorry for the noise!</p>",
        "id": 535817333,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1755968188
    }
]