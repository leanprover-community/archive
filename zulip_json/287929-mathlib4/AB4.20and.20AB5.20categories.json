[
    {
        "content": "<p>In <a href=\"https://github.com/leanprover-community/mathlib4/pull/6504\">#6504</a>, we have to decide whether to have the <code>HasCoproducts</code> assumption as a type class argument or as a field.  I guess the preference depends on whether instances will rather have a <code>HasCoproducts</code> instance that's already defined prior to a <code>AB4</code> instance? Any opinions? /cc <span class=\"user-mention\" data-user-id=\"459699\">@Joël Riou</span> <span class=\"user-mention\" data-user-id=\"260921\">@Markus Himmel</span> <span class=\"user-mention\" data-user-id=\"243562\">@Adam Topaz</span></p>",
        "id": 466268811,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1725024583
    },
    {
        "content": "<p>I would probably make this assumption a field, but this is not a strong preference.</p>",
        "id": 466272296,
        "sender_full_name": "Joël Riou",
        "timestamp": 1725025628
    },
    {
        "content": "<p>I think it should remain a mixin.</p>",
        "id": 466273523,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1725025993
    },
    {
        "content": "<p>If you do make it a field, then it would probably be better to use <code>HasColimits</code> (note that when you have cokernels, hence coequalizers, and all coproducts, that implies you have all colimits)</p>",
        "id": 466273849,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1725026092
    },
    {
        "content": "<p>But if you keep it a mixin, then just using HasCoproducts works perfectly fine</p>",
        "id": 466274040,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1725026133
    },
    {
        "content": "<p>I've generalized some of the file <code>GrothendieckAxioms.lean</code> in <a href=\"https://github.com/leanprover-community/mathlib4/pull/19200\">#19200</a>. It defines a new class <code>ABOfShape</code> and redefines <code>AB4</code> and <code>AB5</code> in terms of that. Reviews welcome</p>\n<p><span class=\"user-mention\" data-user-id=\"110789\">@Jakob von Raumer</span> <span class=\"user-mention\" data-user-id=\"607411\">@Isaac Hernando</span> <span class=\"user-mention\" data-user-id=\"587941\">@Coleton Kotch</span></p>",
        "id": 483015048,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731934662
    },
    {
        "content": "<p>How does this interact with <a href=\"https://github.com/leanprover-community/mathlib4/pull/18510\">#18510</a> by <span class=\"user-mention\" data-user-id=\"221653\">@Paul Reichert</span> ?</p>",
        "id": 483016942,
        "sender_full_name": "Joël Riou",
        "timestamp": 1731935108
    },
    {
        "content": "<p>As mentioned in <a href=\"#narrow/channel/287929-mathlib4/topic/How.20to.20define.20.60GrothendieckCategory.60/near/481753810\">https://leanprover.zulipchat.com/#narrow/channel/287929-mathlib4/topic/How.20to.20define.20.60GrothendieckCategory.60/near/481753810</a> I would be interested to hear what people think of making <code>AbOfShape</code>/<code>AB4</code>/<code>AB5</code> into <code>Prop</code>-valued typeclasses.</p>",
        "id": 483018291,
        "sender_full_name": "Markus Himmel",
        "timestamp": 1731935449
    },
    {
        "content": "<p>Regarding the interactions of our PRs, no worries! I just rehearsed the merging of mine into <span class=\"user-mention\" data-user-id=\"519559\">@Dagur Asgeirsson</span>'s and there are no substantial merge conflicts; all proofs still typecheck. Only the <code>@[stacks]</code> attributes I added cause a few easy syntactical conflicts.</p>",
        "id": 483018985,
        "sender_full_name": "Paul Reichert",
        "timestamp": 1731935632
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"260921\">Markus Himmel</span> <a href=\"#narrow/channel/287929-mathlib4/topic/AB4.20and.20AB5.20categories/near/483018291\">said</a>:</p>\n<blockquote>\n<p>As mentioned in <a href=\"#narrow/channel/287929-mathlib4/topic/How.20to.20define.20.60GrothendieckCategory.60/near/481753810\">https://leanprover.zulipchat.com/#narrow/channel/287929-mathlib4/topic/How.20to.20define.20.60GrothendieckCategory.60/near/481753810</a> I would be interested to hear what people think of making <code>AbOfShape</code>/<code>AB4</code>/<code>AB5</code> into <code>Prop</code>-valued typeclasses.</p>\n</blockquote>\n<p>Ah, I hadn't seen that thread. I agree with Joël's comment there</p>",
        "id": 483024682,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731937084
    },
    {
        "content": "<p>Oh,  I made a mistake and there actually is a small interaction of our PRs.<br>\nI have this variable declaration in <code>GrothendieckCategory.lean</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasFilteredColimits</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AB5</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Abelian</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasSeparator</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">GrothendieckCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>After merging <a href=\"https://github.com/leanprover-community/mathlib4/pull/19200\">#19200</a>, Lean complains on <code>GrothendieckCategory C</code> that it cannot synthesize an AB5 instance. The following works but is ugly:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasFilteredColimits</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AB5</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Abelian</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasSeparator</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">@</span><span class=\"n\">GrothendieckCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>I suspect this has to do with the fact that <code>AB5</code> is now just an <code>abbrev</code> and not a <code>class</code> itself.</p>",
        "id": 483027842,
        "sender_full_name": "Paul Reichert",
        "timestamp": 1731937893
    },
    {
        "content": "<p>I created a <a href=\"#narrow/channel/287929-mathlib4/topic/.60abbrev.60.20instance.20in.20plain.20sight.20not.20synthesized/near/483031196\">separate thread</a> for this phenomenon.</p>",
        "id": 483031398,
        "sender_full_name": "Paul Reichert",
        "timestamp": 1731938770
    },
    {
        "content": "<p>Does it work if you change <code>AB5</code> to</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">AB5</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasFilteredColimits</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">abOfShape</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SmallCategory</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsFiltered</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ABOfShape</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"n\">C</span>\n</code></pre></div>\n<p>?</p>",
        "id": 483036698,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731940137
    },
    {
        "content": "<p>I mean without the \"ugly\" fix</p>",
        "id": 483036800,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731940161
    },
    {
        "content": "<p>That helps, provided I add <code>`attribute [instance] AB5.abOfShape</code>, too.<br>\nActually, as discussed in <a href=\"#narrow/channel/287929-mathlib4/topic/How.20to.20define.20.60GrothendieckCategory.60/near/481753810\">https://leanprover.zulipchat.com/#narrow/channel/287929-mathlib4/topic/How.20to.20define.20.60GrothendieckCategory.60/near/481753810</a>, I either way plan to make the <code>AB5</code> instance into a field of <code>GrothendieckCategory</code>, so I guess this concrete situation is not a problem right now, but other people might stumble into similar problems. I have no idea why this happens here, I've never had the same problems with <code>HasLimits</code>.</p>",
        "id": 483039165,
        "sender_full_name": "Paul Reichert",
        "timestamp": 1731940754
    },
    {
        "content": "<p>Ok, I will change <code>AB4</code> and <code>AB5</code> etc to classes instead of abbrevs in <a href=\"https://github.com/leanprover-community/mathlib4/pull/19200\">#19200</a></p>",
        "id": 483051898,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731943656
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/19912\">#19912</a> proves AB4* for abelian groups  and <a href=\"https://github.com/leanprover-community/mathlib4/pull/19914\">#19914</a> adds a bunch of new API which results in proofs of AB5 and AB4* for categories of R-modules and condensed R-modules in <a href=\"https://github.com/leanprover-community/mathlib4/pull/19892\">#19892</a>. Reviews welcome!</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/19914\">#19914</a> slightly interferes with <a href=\"https://github.com/leanprover-community/mathlib4/pull/18510\">#18510</a> in that it proves a more general version of <code>hasExactColimitsOfShape_obj_of_equiv</code>. It's <code>hasExactColimitsOfShape_transport</code>, which takes a functor which preserves colimits of the given shape and finite limits, instead of an equivalence.</p>",
        "id": 488606968,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1734001685
    },
    {
        "content": "<p>One downside of the new emoji-bot is that I have no idea which of the PRs was merged...</p>",
        "id": 488778822,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1734073994
    },
    {
        "content": "<p>Turns out it is <a href=\"https://github.com/leanprover-community/mathlib4/pull/19912\">#19912</a> <img alt=\":merge:\" class=\"emoji\" src=\"https://avatars.zulip.com/3121/emoji/images/37577b95.png\" title=\"merge\"></p>\n<p>So the following are open. (But atm have merge conflicts or are blocked for other reasons.)</p>",
        "id": 488778961,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1734074046
    },
    {
        "content": "<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/19914\">#19914</a> adds a bunch of new API</li>\n</ul>",
        "id": 488779045,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1734074097
    },
    {
        "content": "<ul>\n<li>which results in proofs of AB5 and AB4* for categories of R-modules and condensed R-modules in <a href=\"https://github.com/leanprover-community/mathlib4/pull/19892\">#19892</a></li>\n</ul>",
        "id": 488779098,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1734074117
    },
    {
        "content": "<p>I've solved the merge conflicts</p>",
        "id": 488785381,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1734077094
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/19939\">#19939</a>: AB5 and AB4* for categories of modules now follow easily.</p>",
        "id": 488845048,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1734098011
    },
    {
        "content": "<p>The condensed version further depends on <a href=\"https://github.com/leanprover-community/mathlib4/pull/19913\">#19913</a> about colimits in sheaf categories</p>",
        "id": 488845093,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1734098027
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"519559\">Dagur Asgeirsson</span> <a href=\"#narrow/channel/287929-mathlib4/topic/AB4.20and.20AB5.20categories/near/488606968\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/19914\">#19914</a> slightly interferes with <a href=\"https://github.com/leanprover-community/mathlib4/pull/18510\">#18510</a> in that it proves a more general version of <code>hasExactColimitsOfShape_obj_of_equiv</code>. It's <code>hasExactColimitsOfShape_transport</code>, which takes a functor which preserves colimits of the given shape and finite limits, instead of an equivalence.</p>\n</blockquote>\n<p>Actually, <code>HasExactColimitsOfShape.domain_of_functor</code> (as I think it's called now) doesn't fully generalize <code>hasExactColimitsOfShape_obj_of_equiv</code> because the former requires an additional <code>HasFiniteLimits</code> instance. Would it be worth, then, to preserve the latter, perhaps giving it a name that is more consistent with the former?</p>",
        "id": 488972398,
        "sender_full_name": "Paul Reichert",
        "timestamp": 1734163031
    },
    {
        "content": "<p><del>Oh, there's also <code>Adjunction.hasColimitsOfShape_of_equivalence</code> which seems to prove exactly the same statement as my <code>hasExactColimitsOfShape_obj_of_equiv</code>,  so it's definitely redundant.</del> (Misread hasColimits for hasExactColimits)</p>",
        "id": 488972651,
        "sender_full_name": "Paul Reichert",
        "timestamp": 1734163258
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"221653\">Paul Reichert</span> <a href=\"#narrow/channel/287929-mathlib4/topic/AB4.20and.20AB5.20categories/near/488972398\">said</a>:</p>\n<blockquote>\n<p>Actually, <code>HasExactColimitsOfShape.domain_of_functor</code> (as I think it's called now) doesn't fully generalize <code>hasExactColimitsOfShape_obj_of_equiv</code> because the former requires an additional <code>HasFiniteLimits</code> instance. Would it be worth, then, to preserve the latter, perhaps giving it a name that is more consistent with the former?</p>\n</blockquote>\n<p>Ah yes, of course. It is worth having both. We have a similar situation for equivalences/functors between the shapes</p>",
        "id": 489088173,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1734273283
    }
]