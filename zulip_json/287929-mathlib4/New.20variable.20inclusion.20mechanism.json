[
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/pull/4814\">lean#4814</a> will introduce a new variable inclusion mechanism, resolving <a href=\"https://github.com/leanprover/lean4/pull/2452\">lean#2452</a>.</p>\n<p>It's going to require a big effort to adapt Mathlib to it. I'm not ready to ask for help getting this done, because we've encountered a few problems with <a href=\"https://github.com/leanprover/lean4/pull/4814\">lean#4814</a> that should be fixed first. When I'm ready, I'll definitely be asking here!</p>\n<p>In the meantime, however, there are several Mathlib PRs backporting changes to <code>master</code>, that I prepared while identifying these problems.</p>\n<p>If someone could take a look and <span aria-label=\"peace sign\" class=\"emoji emoji-270c\" role=\"img\" title=\"peace sign\">:peace_sign:</span> or <img alt=\":merge:\" class=\"emoji\" src=\"https://avatars.zulip.com/3121/emoji/images/37577b95.png\" title=\"merge\">, that would be great. There will be <em>many</em> more of these to come.</p>",
        "id": 454735316,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722234815
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15245\">#15245</a></p>",
        "id": 454735326,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722234821
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15246\">#15246</a></p>",
        "id": 454735354,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722234833
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15249\">#15249</a></p>",
        "id": 454735403,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722234843
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15255\">#15255</a></p>",
        "id": 454735416,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722234851
    },
    {
        "content": "<p>I love how it forces you to fix lines like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>(yes, we have that in mathlib :-)</p>",
        "id": 454737763,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1722235781
    },
    {
        "content": "<p>Just bringing across a <a href=\"https://github.com/leanprover/lean4/pull/4814#issuecomment-2255240852\">discussion</a> with <span class=\"user-mention\" data-user-id=\"111080\">@Floris van Doorn</span> that I think it is easier to have here, as it is to do with how we adapt Mathlib, rather than the implementation of <a href=\"https://github.com/leanprover-community/mathlib4/pull/4814\">#4814</a>.</p>\n<p>I propose that <em>during</em> the adaptation work we:</p>\n<ul>\n<li>allow using <code>include</code>, but <em>only</em> as <code>include ... in</code>, or immediately after the <code>variable</code> statement.</li>\n</ul>\n<p>I think the consensus is that in the long run we would like only have <code>include ... in</code>, and no section wide <code>include</code>.</p>\n<p>However it is going to be less work for me (and whoever is helping do this adapation) if at first we allow the <code>variable + include</code>. These can then be cleaned up in parallel afterwards, rather than getting in the way of reaching a full build of Mathlib under <a href=\"https://github.com/leanprover-community/mathlib4/pull/4814\">#4814</a>.</p>",
        "id": 454986607,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722301416
    },
    {
        "content": "<p>I think that makes sense. Hopefully we can write some automation to do that clean-up of <code>variable + include</code> after the fact.</p>",
        "id": 455009884,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722310050
    },
    {
        "content": "<p>I also agree.</p>",
        "id": 455032206,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1722317475
    },
    {
        "content": "<p>As for the automation, it looks like the kind of adaptations would be reasonably easy to achieve.  They also look similar to the adaptations that I was playing around with when removing implications between typeclass assumptions.</p>",
        "id": 455032233,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1722317499
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15310\">#15310</a></p>",
        "id": 455090365,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722334622
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15313\">#15313</a></p>",
        "id": 455095625,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722336645
    },
    {
        "content": "<p>Okay, things are looking pretty good here! If anyone would like to jump in and work on fixing problems on <a href=\"https://github.com/leanprover-community/mathlib4/tree/lean-pr-testing-4814\">branch#lean-pr-testing-4814</a>, I think we can do so.</p>",
        "id": 455095713,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722336684
    },
    {
        "content": "<p>There's only room for one person at a time, so please do claim and unclaim here!</p>",
        "id": 455095740,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722336694
    },
    {
        "content": "<p>Quoting from the <a href=\"https://github.com/leanprover/lean4/pull/4814#issuecomment-2254717421\">PR comments</a>:</p>\n<blockquote>\n<p>Re: looking at Mathlib on this PR. So far there are two classes of problems: typeclasses hypothesis being included which should not be (for which the new linter is <em>really</em> helpful), and variables which need an <code>include</code>.</p>\n<p>Fixing the first class of problems requires either adding sections to bound <code>variable [...]</code> scopes, using <code>variable ... in</code>, or reordering results.</p>\n<p>I propose that for anyone working on the Mathlib branch for this PR, we try to backport all the changes of the first form.</p>\n<p>A reasonable workflow seems to be:</p>\n<ul>\n<li>As you make changes on <code>lean-pr-testing-4814</code>, any changes that use <code>include</code> (i.e. which will not work on master), you immediately stage.</li>\n<li>But any changes for <em>excluding</em> typeclasses hypotheses you leave unstaged.</li>\n<li>At suitable intervals, make a commit of the staged changes (<code>include</code>s<code>) on </code>lean-pr-testing-4814`</li>\n<li>Then stash the remaining changes, make a new branch off master, make a PR from it, and then <del>merge that branch</del> cherry-pick that commit back to <code>lean-pr-testing-4814</code>. (See first example of such a PR at <a href=\"https://github.com/leanprover-community/mathlib4/pull/15245\">https://github.com/leanprover-community/mathlib4/pull/15245</a>.)</li>\n</ul>\n</blockquote>",
        "id": 455096063,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722336817
    },
    {
        "content": "<p>While actually working on the branch is only \"one person at the coal face\", the backporting PRs that are generated are essentially all independent, so can be reviewed in parallel / asychronously. If you make any such PRs please post them here!</p>",
        "id": 455096248,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722336880
    },
    {
        "content": "<p>i noticed that in <code>Algebra.Order.Ring.Unbundled.Basic</code>, some lemmas use a combination of <code>MulPosMono</code> and <code>PosMulMono</code>, despite not needing to... i suppose it'd be ok to fix this by \"duplicating\" (modulo switching the statement/assumption) to a <code>Right</code> or <code>PosMulMono</code> namespace or something like that?</p>",
        "id": 455143428,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722351099
    },
    {
        "content": "<p>the file is quite the mess when viewed on the branch <span aria-label=\"melting face\" class=\"emoji emoji-1fae0\" role=\"img\" title=\"melting face\">:melting_face:</span></p>",
        "id": 455143671,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722351163
    },
    {
        "content": "<p>Late here, I only got as far as seeing the file is a real mess. :-) I'd suggest trying to making relatively conservative changes. We can also flag files for a second round of cleanup by a specialist later.</p>",
        "id": 455144180,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722351313
    },
    {
        "content": "<p>in that case i guess i'll leave it be for now...</p>",
        "id": 455149355,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722352828
    },
    {
        "content": "<p>since there really isn't a simple way to fix this</p>",
        "id": 455149418,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722352850
    },
    {
        "content": "<p>Let me take a look at whittling these down on master</p>",
        "id": 455162562,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1722356491
    },
    {
        "content": "<p>i seem to have found a (third?) kind of problem which needs some special consideration:</p>\n<p>some <code>variable (h:SomeFooOrOther)</code> would be included due to use of <code>induction</code> or <code>subst</code> (or something like that), but gets removed explicitly with <code>clear</code>. This raises an error in the test branch, because <code>h</code> no longer gets included. However, you can't make a pull to mathlib removing the <code>clear</code> because that changes the signature of the lemma. </p>\n<p>example:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">useless</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"n\">clear</span><span class=\"w\"> </span><span class=\"n\">useless</span><span class=\"w\"> </span><span class=\"c1\">-- removing this makes `foo`  depend on `useless`</span>\n<span class=\"n\">subst</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">foo</span>\n</code></pre></div>\n<p>I think in this case, it is appropriate to remove the <code>clear</code> line in the test branch but not PR it to mathlib?</p>",
        "id": 455167152,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722357760
    },
    {
        "content": "<p>either that or prepend <code>try</code> and add a <code>TODO</code></p>",
        "id": 455167666,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722357934
    },
    {
        "content": "<p>or some kind of porting note</p>",
        "id": 455167834,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722357981
    },
    {
        "content": "<p>i guess i'll do the first option i suggested.</p>",
        "id": 455173526,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722359383
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15334\">#15334</a></p>",
        "id": 455204580,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1722368181
    },
    {
        "content": "<p>thanks, that's large mess taken care of for now. however, i fear my point might have been missed slightly: if you add a version of <code>pow_nonneg</code> assuming <code>MulPosMono</code> rather than <code>PosMulMono</code>, some of the following lemmas can be made to assume exactly one of these classes rather than both.</p>",
        "id": 455205923,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722368547
    },
    {
        "content": "<p>Oh, I don't think about any improvements in doing that.</p>",
        "id": 455206327,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1722368652
    },
    {
        "content": "<p>If you want to improve what is there, feel free to push there</p>",
        "id": 455206485,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1722368696
    },
    {
        "content": "<p>i think that your current branch is probably fine to go on the test-branch, as i'm not sure we want this kind of change to necessarily be merged immediately...</p>",
        "id": 455206884,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722368805
    },
    {
        "content": "<p>btw, i'm done working on <a href=\"https://github.com/leanprover-community/mathlib4/tree/lean-pr-testing-4814\">branch#lean-pr-testing-4814</a>, so feel free to test your changes on it.</p>",
        "id": 455207097,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722368874
    },
    {
        "content": "<p>btw, <a href=\"https://github.com/leanprover-community/mathlib4/pull/15332\">#15332</a> has changes i made</p>",
        "id": 455209090,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722369644
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/455167152\">said</a>:</p>\n<blockquote>\n<p>I think in this case, it is appropriate to remove the <code>clear</code> line in the test branch but not PR it to mathlib?</p>\n</blockquote>\n<p>Just confirming this is correct, and it's fine to push such changes (along with adding <code>include</code>) direct to the lean-pr-testing-4814 branch.</p>\n<p>Thanks!</p>",
        "id": 455247246,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722384662
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306577\">Matthew Ballard</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/455204580\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15334\">#15334</a></p>\n</blockquote>\n<p>I removed some unused arguments detected by the linter, and <img alt=\":merge:\" class=\"emoji\" src=\"https://avatars.zulip.com/3121/emoji/images/37577b95.png\" title=\"merge\">'d. Thanks!</p>",
        "id": 455247789,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722384989
    },
    {
        "content": "<p>... and I've cherry-picked the changes over to <a href=\"https://github.com/leanprover-community/mathlib4/tree/lean-pr-testing-4814\">branch#lean-pr-testing-4814</a></p>",
        "id": 455247906,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722385077
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/455209090\">said</a>:</p>\n<blockquote>\n<p>btw, <a href=\"https://github.com/leanprover-community/mathlib4/pull/15332\">#15332</a> has changes i made</p>\n</blockquote>\n<p>I've removed a stray comment, and <img alt=\":merge:\" class=\"emoji\" src=\"https://avatars.zulip.com/3121/emoji/images/37577b95.png\" title=\"merge\">'d. (And cherry-pick the comment removal.)</p>",
        "id": 455248252,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722385264
    },
    {
        "content": "<p>I'm <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> it now.</p>",
        "id": 455248437,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722385383
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span>, it looks like <a href=\"https://tqft.net/mathlib4files/Computability/TuringMachine\">file#Computability/TuringMachine</a> will be a little subtle to fix on <a href=\"https://github.com/leanprover-community/mathlib4/tree/lean-pr-testing-4814\">branch#lean-pr-testing-4814</a>, because of fine-grained variation in needing <code>[Inhabited]</code> and <code>[DecidableEq]</code> instances.</p>\n<p>Would you have a chance to have a look at it?</p>\n<p>(We can route around it for now, as there are not a lot of downstream dependencies. I can also do it if you don't have time, but I'm a little worried of making a mess here.)</p>",
        "id": 455251174,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722386966
    },
    {
        "content": "<p>ok, I'll take a look</p>",
        "id": 455251204,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722386993
    },
    {
        "content": "<p>(If it's possible to make changes that are backportable to master, that's great. If not, just push <code>include</code>s to the branch.)</p>",
        "id": 455251498,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722387145
    },
    {
        "content": "<p>chore: backports for <a href=\"https://github.com/leanprover/lean4/pull/4814\">leanprover/lean4#4814</a> (part 8) <a href=\"https://github.com/leanprover-community/mathlib4/pull/15349\">#15349</a></p>",
        "id": 455251528,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722387167
    },
    {
        "content": "<p>Still working (away from TuringMachine).</p>",
        "id": 455251542,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722387180
    },
    {
        "content": "<p>I won't be able to get to it right now, maybe tomorrow</p>",
        "id": 455251576,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722387200
    },
    {
        "content": "<p>chore: backports for <a href=\"https://github.com/leanprover/lean4/pull/4814\">leanprover/lean4#4814</a> (part 9) <a href=\"https://github.com/leanprover-community/mathlib4/pull/15352\">#15352</a></p>",
        "id": 455256301,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722390210
    },
    {
        "content": "<p>This one has not been cherry-picked to lean-pr-testing-4814, because there are some incoming changes on master that will cause conflicts. I'm going to try to merge nightly-testing into lean-pr-testing-4814 first.</p>",
        "id": 455256422,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722390246
    },
    {
        "content": "<p>There was a bit of an outage due to branch conflicts (long story, unavoidable, we're working on it), but <a href=\"https://github.com/leanprover-community/mathlib4/tree/lean-pr-testing-4814\">branch#lean-pr-testing-4814</a> is open for business again!</p>",
        "id": 455503400,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722467650
    },
    {
        "content": "<p>(Leave the file EditDistance/Defs, I know a good fix and will can do it next time I'm on this branch.)</p>",
        "id": 455503446,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722467677
    },
    {
        "content": "<p>Currently awaiting review is <a href=\"https://github.com/leanprover-community/mathlib4/pull/15349\">#15349</a></p>",
        "id": 455503753,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722467823
    },
    {
        "content": "<p>Okay, claiming the branch for now.</p>",
        "id": 455509881,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722470986
    },
    {
        "content": "<p>Now also awaiting review is <a href=\"https://github.com/leanprover-community/mathlib4/pull/15389\">#15389</a>.</p>",
        "id": 455521887,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722477260
    },
    {
        "content": "<p>And a short one: <a href=\"https://github.com/leanprover-community/mathlib4/pull/15390\">#15390</a></p>",
        "id": 455523650,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722477870
    },
    {
        "content": "<p>I'm now stopping on this branch if anyone would like to push it a bit further!</p>",
        "id": 455523709,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722477892
    },
    {
        "content": "<p>The current \"frontier\", i.e. the build failures reported by <code>lake --wfail build</code>, is:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">Ring</span><span class=\"bp\">.</span><span class=\"n\">Unbundled</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">RingTheory</span><span class=\"bp\">.</span><span class=\"n\">NonUnitalSubsemiring</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Ring</span><span class=\"bp\">.</span><span class=\"n\">Subsemiring</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">CompactlyGenerated</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">Filter</span><span class=\"bp\">.</span><span class=\"n\">Interval</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">NhdsSet</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">Bornology</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">BooleanGenerators</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">RingTheory</span><span class=\"bp\">.</span><span class=\"n\">HahnSeries</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Sym</span><span class=\"bp\">.</span><span class=\"n\">Card</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Combinatorics</span><span class=\"bp\">.</span><span class=\"n\">Colex</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">Sups</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Combinatorics</span><span class=\"bp\">.</span><span class=\"n\">SetFamily</span><span class=\"bp\">.</span><span class=\"n\">AhlswedeZhang</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Combinatorics</span><span class=\"bp\">.</span><span class=\"n\">SetFamily</span><span class=\"bp\">.</span><span class=\"n\">FourFunctions</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Combinatorics</span><span class=\"bp\">.</span><span class=\"n\">SimpleGraph</span><span class=\"bp\">.</span><span class=\"n\">Hamiltonian</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">EditDistance</span><span class=\"bp\">.</span><span class=\"n\">Defs</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">RingTheory</span><span class=\"bp\">.</span><span class=\"n\">Nilpotent</span><span class=\"bp\">.</span><span class=\"n\">Defs</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Sites</span><span class=\"bp\">.</span><span class=\"n\">CoversTop</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">Interval</span><span class=\"bp\">.</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">Fin</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Sites</span><span class=\"bp\">.</span><span class=\"n\">IsSheafOneHypercover</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">BigOperators</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Setoid</span><span class=\"bp\">.</span><span class=\"n\">Partition</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Combinatorics</span><span class=\"bp\">.</span><span class=\"n\">SimpleGraph</span><span class=\"bp\">.</span><span class=\"n\">Turan</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">Maps</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Preadditive</span><span class=\"bp\">.</span><span class=\"n\">AdditiveFunctor</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Sites</span><span class=\"bp\">.</span><span class=\"n\">PreservesSheafification</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Combinatorics</span><span class=\"bp\">.</span><span class=\"n\">SimpleGraph</span><span class=\"bp\">.</span><span class=\"n\">Density</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">Submodule</span><span class=\"bp\">.</span><span class=\"n\">Map</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Computability</span><span class=\"bp\">.</span><span class=\"n\">TuringMachine</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">Final</span>\n</code></pre></div>",
        "id": 455524159,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722478030
    },
    {
        "content": "<p>Another one at <a href=\"https://github.com/leanprover-community/mathlib4/pull/15394\">#15394</a></p>",
        "id": 455560189,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722492847
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"257803\">@Nicolas Rolland</span> i think Kim Morrison still has the branch claimed?</p>",
        "id": 455593309,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722502426
    },
    {
        "content": "<p>as indicated by the emote reaction?</p>",
        "id": 455593414,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722502455
    },
    {
        "content": "<p>so please only react with that emote if you claim the branch (and no-one else is claming it)</p>",
        "id": 455593637,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722502541
    },
    {
        "content": "<p>Sorry, I left it claimed accidentally, but I'm back on it now.</p>",
        "id": 455593714,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722502565
    },
    {
        "content": "<p>I'll try to be better an unclaiming, sorry. :-(</p>",
        "id": 455593747,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722502577
    },
    {
        "content": "<p>btw, i'm not sure why, but <code>Batteries.Data.List.Pairwise</code> locally (on the current version of the branch) fails to build for me? it throws </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">batteries</span><span class=\"bp\">\\.\\.\\</span><span class=\"n\">Batteries</span><span class=\"bp\">\\</span><span class=\"n\">Data</span><span class=\"bp\">\\</span><span class=\"n\">List</span><span class=\"bp\">\\</span><span class=\"n\">Pairwise</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">46</span><span class=\"o\">:</span><span class=\"mi\">6</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">unknown</span><span class=\"w\"> </span><span class=\"n\">identifier</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">pairwise_iff_getElem'</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">batteries</span><span class=\"bp\">\\.\\.\\</span><span class=\"n\">Batteries</span><span class=\"bp\">\\</span><span class=\"n\">Data</span><span class=\"bp\">\\</span><span class=\"n\">List</span><span class=\"bp\">\\</span><span class=\"n\">Pairwise</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">46</span><span class=\"o\">:</span><span class=\"mi\">6</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">rewrite'</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">equality</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">iff</span><span class=\"w\"> </span><span class=\"n\">proof</span><span class=\"w\"> </span><span class=\"n\">expected</span>\n</code></pre></div>",
        "id": 455594578,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722502812
    },
    {
        "content": "<p>What commit appears for Batteries in your <code>lake-manifest.json</code>?</p>",
        "id": 455594775,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722502866
    },
    {
        "content": "<p><code>34ce6c38752e8671d7556a30120ec6008a9a177a</code></p>",
        "id": 455594833,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722502886
    },
    {
        "content": "<p>which does seem to be current...</p>",
        "id": 455594845,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722502893
    },
    {
        "content": "<p>Looks good to me</p>",
        "id": 455594853,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722502897
    },
    {
        "content": "<p>yea, which is why i'm confused...</p>",
        "id": 455594883,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722502910
    },
    {
        "content": "<p>Try deleting <code>.lake</code>, then <code>lake exe cache get</code> again...</p>",
        "id": 455594896,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722502914
    },
    {
        "content": "<p>there appears to be zero <code>cache</code> to download?</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$<span class=\"w\"> </span>lake<span class=\"w\"> </span>exe<span class=\"w\"> </span>cache<span class=\"w\"> </span>get\ninfo:<span class=\"w\"> </span>batteries:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover-community/batteries<span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'.\\.\\.lake/packages\\batteries'</span>\ninfo:<span class=\"w\"> </span>Qq:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover-community/quote4<span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'.\\.\\.lake/packages\\Qq'</span>\ninfo:<span class=\"w\"> </span>aesop:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover-community/aesop<span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'.\\.\\.lake/packages\\aesop'</span>\ninfo:<span class=\"w\"> </span>proofwidgets:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover-community/ProofWidgets4<span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'.\\.\\.lake/packages\\proofwidgets'</span>\ninfo:<span class=\"w\"> </span>importGraph:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover-community/import-graph<span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'.\\.\\.lake/packages\\importGraph'</span>\ninfo:<span class=\"w\"> </span>Cli:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/leanprover/lean4-cli<span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'.\\.\\.lake/packages\\Cli'</span>\nAttempting<span class=\"w\"> </span>to<span class=\"w\"> </span>download<span class=\"w\"> </span><span class=\"m\">4874</span><span class=\"w\"> </span>file<span class=\"o\">(</span>s<span class=\"o\">)</span>\nDownloaded:<span class=\"w\"> </span><span class=\"m\">0</span><span class=\"w\"> </span>file<span class=\"o\">(</span>s<span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span>attempted<span class=\"w\"> </span><span class=\"m\">4874</span>/4874<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">100</span>%<span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">0</span>%<span class=\"w\"> </span>success<span class=\"o\">)</span>\nWarning:<span class=\"w\"> </span>some<span class=\"w\"> </span>files<span class=\"w\"> </span>were<span class=\"w\"> </span>not<span class=\"w\"> </span>found<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span>the<span class=\"w\"> </span>cache.\nThis<span class=\"w\"> </span>usually<span class=\"w\"> </span>means<span class=\"w\"> </span>that<span class=\"w\"> </span>your<span class=\"w\"> </span><span class=\"nb\">local</span><span class=\"w\"> </span>checkout<span class=\"w\"> </span>of<span class=\"w\"> </span>mathlib4<span class=\"w\"> </span>has<span class=\"w\"> </span>diverged<span class=\"w\"> </span>from<span class=\"w\"> </span>upstream.\nIf<span class=\"w\"> </span>you<span class=\"w\"> </span>push<span class=\"w\"> </span>your<span class=\"w\"> </span>commits<span class=\"w\"> </span>to<span class=\"w\"> </span>a<span class=\"w\"> </span>branch<span class=\"w\"> </span>of<span class=\"w\"> </span>the<span class=\"w\"> </span>mathlib4<span class=\"w\"> </span>repository,<span class=\"w\"> </span>CI<span class=\"w\"> </span>will<span class=\"w\"> </span>build<span class=\"w\"> </span>the<span class=\"w\"> </span>oleans<span class=\"w\"> </span>and<span class=\"w\"> </span>they<span class=\"w\"> </span>will<span class=\"w\"> </span>be<span class=\"w\"> </span>available<span class=\"w\"> </span>later.\nNo<span class=\"w\"> </span>cache<span class=\"w\"> </span>files<span class=\"w\"> </span>to<span class=\"w\"> </span>decompress\n</code></pre></div>",
        "id": 455595436,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722503109
    },
    {
        "content": "<p>That's strange. You haven't used <code>elan override</code> have you?</p>",
        "id": 455595494,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722503130
    },
    {
        "content": "<p>What commit are you at?</p>",
        "id": 455595527,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722503138
    },
    {
        "content": "<p>not sure, but <code>git status</code> says i'm current:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$<span class=\"w\"> </span>git<span class=\"w\"> </span>status\nOn<span class=\"w\"> </span>branch<span class=\"w\"> </span>lean-pr-testing-4814\nYour<span class=\"w\"> </span>branch<span class=\"w\"> </span>is<span class=\"w\"> </span>up<span class=\"w\"> </span>to<span class=\"w\"> </span>date<span class=\"w\"> </span>with<span class=\"w\"> </span><span class=\"s1\">'origin/lean-pr-testing-4814'</span>.\n\nnothing<span class=\"w\"> </span>to<span class=\"w\"> </span>commit,<span class=\"w\"> </span>working<span class=\"w\"> </span>tree<span class=\"w\"> </span>clean\n</code></pre></div>",
        "id": 455595669,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722503188
    },
    {
        "content": "<p>Oh!!</p>",
        "id": 455595983,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722503309
    },
    {
        "content": "<p><code>98c9ccc6ca31e085e357e9cb9b6c78ea25b834db</code></p>",
        "id": 455595990,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722503312
    },
    {
        "content": "<p><code>elan toolchain uninstall $(&lt;lean-toolchain)</code></p>",
        "id": 455596024,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722503325
    },
    {
        "content": "<p>should that fix it?</p>",
        "id": 455596070,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722503343
    },
    {
        "content": "<p>I should have announced that: we had to update <a href=\"https://github.com/leanprover-community/mathlib4/pull/4814\">#4814</a> itself for compatibility with the latest nightly-testing, and I completely forgot to announce here that anyone with the old toolchain needed to run that command.</p>",
        "id": 455596102,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722503359
    },
    {
        "content": "<p>ahhh</p>",
        "id": 455596133,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722503374
    },
    {
        "content": "<p>Then just <code>lake exe cache get</code> again. It will download the updated toolchain automatically.</p>",
        "id": 455596139,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722503377
    },
    {
        "content": "<p>Sorry about that.</p>",
        "id": 455596142,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722503379
    },
    {
        "content": "<p>thanks <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 455596152,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722503382
    },
    {
        "content": "<p>Okay, I am relinquishing the branch again!</p>",
        "id": 455596552,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722503526
    },
    {
        "content": "<p>in that case i'll continue from there</p>",
        "id": 455596597,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722503555
    },
    {
        "content": "<p>is it maybe useful to make <code>variable</code> binder updates to terms automatically include those variables? i.e. make <code>variable (M) in ...</code> automatically do <code>include M in ...</code> as well?</p>",
        "id": 455618687,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722510345
    },
    {
        "content": "<p>this seems sensible to me, could someone tell me if it's feasible?</p>",
        "id": 455619254,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722510444
    },
    {
        "content": "<p>or really any <code>variable ... in ....</code>?</p>",
        "id": 455619563,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722510493
    },
    {
        "content": "<p>not just binder updates</p>",
        "id": 455619587,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722510497
    },
    {
        "content": "<p>Interesting, yes! <span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span>, do you see a problem?</p>",
        "id": 455619989,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722510568
    },
    {
        "content": "<p>If Mathlib could really pull off never using <code>include</code>, but only using <code>include ... in</code> (we are not attempting this for now), then we'd actually be able to drop the <code>include</code> command entirely in favour of <code>variable ... in</code>.</p>",
        "id": 455620164,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722510620
    },
    {
        "content": "<p>This would be very cool!</p>\n<p>Would this create some awkwardness if you wanted to preserve a specific ordering of the hypotheses, though?</p>",
        "id": 455620569,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1722510779
    },
    {
        "content": "<p>That's a bit of a break with the usual <code>in</code> semantics (and because of that would require a custom implementation). I think I would prefer Floris' <code>include (M) in</code>, and mostly just not use <code>variable</code> binder updates.</p>",
        "id": 455621520,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1722511183
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110024\">Sebastian Ullrich</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/455621520\">said</a>:</p>\n<blockquote>\n<p>That's a bit of a break with the usual <code>in</code> semantics</p>\n</blockquote>\n<p>in the sense that you usually can replace it with wrapping it in a section?</p>",
        "id": 455621798,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722511280
    },
    {
        "content": "<p>in that case, maybe it makes sense to make a variation on the variable command which does both?</p>",
        "id": 455621957,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722511333
    },
    {
        "content": "<p>also, what are you referring to with \"Floris' <code>include (M) in</code>\"?</p>",
        "id": 455622230,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722511440
    },
    {
        "content": "<p>Just a reminder <span class=\"user-mention\" data-user-id=\"684366\">@Edward van de Meent</span> to say here if/when you're done on the branch. I think in any case it's time for me to sleep here, but I will try to work on this a bunch tomorrow!</p>",
        "id": 455641140,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722517165
    },
    {
        "content": "<p>Yup, i'm still working on it</p>",
        "id": 455641305,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722517188
    },
    {
        "content": "<p>do we have an opinion on <code>section variable ....</code> as a single line? i looked through the code style doc but i couldn't find any express opinion...</p>",
        "id": 455663957,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722522532
    },
    {
        "content": "<p>I don't think we should do it (personal opinion)</p>",
        "id": 455664883,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1722522715
    },
    {
        "content": "<p>that does make sense though... i imagine that forcing the newline makes some smart linting/searching possible, and there isn't a lot to be gained by making it a single line...</p>",
        "id": 455665298,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722522818
    },
    {
        "content": "<p>i asked because i was surprised it was accepted at all by lean, and there are <em>some</em> style rules suggesting we care about line count...</p>",
        "id": 455666325,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722523015
    },
    {
        "content": "<p>No, we care about the amount of code that goes into a single file - it's just that line count is an easy but imperfect proxy for that</p>",
        "id": 455666935,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1722523131
    },
    {
        "content": "<p>ok, i'm done for today! please have a look at <a href=\"https://github.com/leanprover-community/mathlib4/pull/15406\">#15406</a></p>",
        "id": 455685730,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722527454
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/455251174\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span>, it looks like <a href=\"https://tqft.net/mathlib4files/Computability/TuringMachine\">file#Computability/TuringMachine</a> will be a little subtle to fix on <a href=\"https://github.com/leanprover-community/mathlib4/tree/lean-pr-testing-4814\">branch#lean-pr-testing-4814</a>, because of fine-grained variation in needing <code>[Inhabited]</code> and <code>[DecidableEq]</code> instances.</p>\n<p>Would you have a chance to have a look at it?</p>\n<p>(We can route around it for now, as there are not a lot of downstream dependencies. I can also do it if you don't have time, but I'm a little worried of making a mess here.)</p>\n</blockquote>\n<p>Pushed a fix to the branch</p>",
        "id": 455781705,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722557757
    },
    {
        "content": "<p>Thanks!</p>",
        "id": 455783149,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722558072
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span>, I've backported that commit to master as <a href=\"https://github.com/leanprover-community/mathlib4/pull/15422\">#15422</a>.</p>",
        "id": 455783998,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722558250
    },
    {
        "content": "<p>I should mention that while making the modifications I didn't get the sense that it was making the code better/clearer. The combination of the unused variable linter and the unused <code>variable</code> linter means that it is not very easy to use typeclass hypotheses in variables at all anymore (more precisely, you only ever seem be able to use <code>variable</code> in cases where it would already be included, and unused variables lying around are problematic). I can't imagine what the algebraic hierarchy heavy files are dealing with...</p>",
        "id": 455785119,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722558465
    },
    {
        "content": "<p>It's mostly been better than this file. If you don't need to turn on and off particular typeclasses repeatedly it goes more smoothly.</p>",
        "id": 455785461,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722558527
    },
    {
        "content": "<p>The PRs (both open and closed) of backports are listed at <a href=\"https://github.com/leanprover-community/mathlib4/pulls?q=sort%3Aupdated-desc+is%3Apr+lean4%234814+\">https://github.com/leanprover-community/mathlib4/pulls?q=sort%3Aupdated-desc+is%3Apr+lean4%234814+</a></p>",
        "id": 455785650,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722558567
    },
    {
        "content": "<p>I <em>don't</em> need to turn on and off hypotheses in this file</p>",
        "id": 455785794,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722558597
    },
    {
        "content": "<p>We're mostly past the algebraic hierarchy files, although the PRs are a complete jumble (whatever is at the frontier of <code>lake build</code>) rather than organised by topic/directory.</p>",
        "id": 455785813,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722558601
    },
    {
        "content": "<p>the other linter made me do that</p>",
        "id": 455785860,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722558605
    },
    {
        "content": "<p>it's perfectly fine to assume all of those hypotheses for the whole file, but it causes some theorems to take unused arguments</p>",
        "id": 455786110,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722558660
    },
    {
        "content": "<p>the only way I seem to be able to satisfy both linters simultaneously is through this pedantic sectioning</p>",
        "id": 455786320,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722558719
    },
    {
        "content": "<p>Obviously there's some tradeoff here. Have a look at some of the other PRs. Frequently I've been pretty happy with the changes, especially when it forces us to avoid crazy non-localities in the variables. It's identified at least one bug with a missing Decidable instance.</p>",
        "id": 455787039,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722558924
    },
    {
        "content": "<p>I'm starting again on this branch.</p>",
        "id": 455797256,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722562061
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"684366\">@Edward van de Meent</span>, the <code>include hadd</code> you added in Mathlib/Algebra/MonoidAlgebra/Degree.lean causes problems: <code>supDegree_prod_le</code> immediately below still has its own copy of <code>hadd</code>, and this cause all sorts of duplication of the arguments.</p>",
        "id": 455801472,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722564535
    },
    {
        "content": "<p>I'm fixing this now.</p>",
        "id": 455801489,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722564540
    },
    {
        "content": "<blockquote>\n<p>In Mathlib we are striving towards using <code>variable {v}</code> and <code>include v</code> <em>only</em> using <code>in</code> (i.e. <code>variable {v}</code> or <code>include v</code> is banned, you should solely use <code>variable {v} in</code> and <code>include v in</code>).</p>\n</blockquote>\n<p>Wait, does this mean you would have to specify all your variables for every theorem in a section again? Because yes, having to do that in the bits of Mathlib where every theorem requires layers upon layers of typeclasses just to state seems ... extremely unfortunate, at least.</p>",
        "id": 455805563,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722566229
    },
    {
        "content": "<p>Or is the idea that you would <code>include</code> something in explicit or implicit binders, and all necessary instance-implicits would get pulled in?</p>",
        "id": 455806307,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722566564
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"359992\">@Robert Maxton</span>, take a look at some of the PRs above. Typeclasses get pulled in automatically (indeed, even more eagerly than currently.)</p>",
        "id": 455806361,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722566611
    },
    {
        "content": "<p>or the desciption at <a href=\"https://github.com/leanprover/lean4/pull/4814\">lean#4814</a> is pretty helpful explaining the new algorithm.</p>",
        "id": 455806427,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722566648
    },
    {
        "content": "<p>Ahh, okay. That makes more sense. I've been going mostly off the documentation rather than the code itself</p>",
        "id": 455806429,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722566650
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/455806427\">said</a>:</p>\n<blockquote>\n<p>or the desciption at <a href=\"https://github.com/leanprover/lean4/pull/4814\">lean#4814</a> is pretty helpful explaining the new algorithm.</p>\n</blockquote>\n<p>that also helps, thanks</p>",
        "id": 455806441,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722566664
    },
    {
        "content": "<p>Sorry, I'm not sure I understand why <code>variable {v}</code> without the <code>in</code> is even problematic</p>",
        "id": 455809353,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1722567939
    },
    {
        "content": "<p>I think that's a topic for another thread, in any case. (And I mostly agree.)</p>",
        "id": 455809497,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722567980
    },
    {
        "content": "<p>Another one, fairly large this time: <a href=\"https://github.com/leanprover-community/mathlib4/pull/15427\">#15427</a></p>",
        "id": 455810618,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722568313
    },
    {
        "content": "<p>As we get closer to the end of some corners of Mathlib, I may ask some specific file authors if they are able to help out on files, as Mario did for <code>TuringMachine</code> (thanks!). These will be files that are particularly awkward to adapt, so if you do look at this, please remember mostly it goes more smoothly. :-)</p>",
        "id": 455810981,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722568435
    },
    {
        "content": "<p>Summary of where we're at (absolutely no compulsion if I ping you, just I'll leave these parts til later!):</p>",
        "id": 455812984,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722569260
    },
    {
        "content": "<ul>\n<li>variables in TuringMachine.lean <a href=\"https://github.com/leanprover-community/mathlib4/pull/15422\">#15422</a> has a CI failure (Perhaps <span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> could take a look, and move the fix to lean-pr-testing-4814 if needed?)</li>\n</ul>",
        "id": 455812985,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722569261
    },
    {
        "content": "<ul>\n<li>Waiting for review:</li>\n</ul>",
        "id": 455812994,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722569269
    },
    {
        "content": "<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/15396\">#15396</a></li>\n</ul>",
        "id": 455813002,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722569275
    },
    {
        "content": "<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/15397\">#15397</a></li>\n</ul>",
        "id": 455813062,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722569292
    },
    {
        "content": "<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/15406\">#15406</a></li>\n</ul>",
        "id": 455813072,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722569305
    },
    {
        "content": "<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/15427\">#15427</a></li>\n</ul>",
        "id": 455813094,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722569313
    },
    {
        "content": "<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/15246\">#15246</a> is failing CI; I can get to it but if someone wants to jump in, great!</li>\n</ul>",
        "id": 455813106,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722569324
    },
    {
        "content": "<ul>\n<li><span class=\"user-mention\" data-user-id=\"459699\">@Joël Riou</span>, perhaps you might be interested in:<ul>\n<li>Mathlib.CategoryTheory.Abelian.ProjectiveResolution</li>\n<li>Mathlib.CategoryTheory.Triangulated.Subcategory</li>\n<li>Mathlib.Algebra.Homology.HomologySequenceLemmas</li>\n<li>Mathlib.Algebra.Homology.HomotopyCofiber</li>\n</ul>\n</li>\n</ul>",
        "id": 455813130,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722569349
    },
    {
        "content": "<ul>\n<li><span class=\"user-mention\" data-user-id=\"197836\">@Jireh Loreaux</span> perhaps you could look at<ul>\n<li>Mathlib.Algebra.Algebra.NonUnitalSubalgebra</li>\n<li>Mathlib.Algebra.Star.NonUnitalSubalgebra</li>\n</ul>\n</li>\n</ul>",
        "id": 455813135,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722569358
    },
    {
        "content": "<ul>\n<li>Algebraic geometers (<span class=\"user-mention\" data-user-id=\"519559\">@Dagur Asgeirsson</span>, <span class=\"user-mention\" data-user-id=\"439483\">@Andrew Yang</span>, <span class=\"user-mention\" data-user-id=\"459699\">@Joël Riou</span>?) could look at<ul>\n<li>Mathlib.CategoryTheory.Sites.Coherent.ReflectsPrecoherent</li>\n<li>Mathlib.CategoryTheory.Sites.Coherent.ReflectsPreregular</li>\n<li>Mathlib.CategoryTheory.Sites.DenseSubsite</li>\n<li>Mathlib.CategoryTheory.Sites.LocallyInjective</li>\n</ul>\n</li>\n</ul>",
        "id": 455813141,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722569365
    },
    {
        "content": "<ul>\n<li>Otherwise, most of the \"frontier\" of broken stuff is in Algebra/RingTheory/Topology, and I'll continue working here.</li>\n</ul>",
        "id": 455813147,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722569373
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/455813130\">said</a>:</p>\n<blockquote>\n<ul>\n<li>Mathlib.CategoryTheory.Abelian.ProjectiveResolution</li>\n<li>Mathlib.CategoryTheory.Homology.HomotopyCofiber</li>\n<li>Mathlib.CategoryTheory.Triangulated.Subcategory</li>\n</ul>\n</blockquote>\n<p>In principle, these 3 files are fixed.</p>",
        "id": 455819549,
        "sender_full_name": "Joël Riou",
        "timestamp": 1722571616
    },
    {
        "content": "<p>Another backporting PR: <a href=\"https://github.com/leanprover-community/mathlib4/pull/15429\">#15429</a></p>",
        "id": 455826662,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722573311
    },
    {
        "content": "<p>I will try to look early tomorrow morning, but no promises. We're about to go out of town.</p>",
        "id": 455830252,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722574723
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/455826662\">said</a>:</p>\n<blockquote>\n<p>Another backporting PR: <a href=\"https://github.com/leanprover-community/mathlib4/pull/15429\">#15429</a></p>\n</blockquote>\n<p>Failing CI</p>",
        "id": 455838811,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1722578277
    },
    {
        "content": "<p>Thanks, sorry, a few are. I'm still going on the main branch, and will circle back to fix the PRs. If you want to push fixes, please feel free. :-)</p>",
        "id": 455839094,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722578330
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"459699\">@Joël Riou</span>, something is still wrong with:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Homology</span><span class=\"bp\">.</span><span class=\"n\">Embedding</span><span class=\"bp\">.</span><span class=\"n\">IsSupported</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Homology</span><span class=\"bp\">.</span><span class=\"n\">HomotopyCofiber</span>\n</code></pre></div>\n<p>would you be able to take a look at these?</p>",
        "id": 455841097,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722579251
    },
    {
        "content": "<p>I've finished on the main branch for now if anyone would like to take over. I'll fix up all my broken backport PRs in an hour or two.</p>",
        "id": 455841143,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722579289
    },
    {
        "content": "<p>I pushed some fixes to the backport PRs</p>",
        "id": 455842876,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1722580221
    },
    {
        "content": "<p>Thanks!</p>",
        "id": 455843746,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722580581
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/455841097\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"459699\">Joël Riou</span>, something is still wrong with:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Homology</span><span class=\"bp\">.</span><span class=\"n\">Embedding</span><span class=\"bp\">.</span><span class=\"n\">IsSupported</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Homology</span><span class=\"bp\">.</span><span class=\"n\">HomotopyCofiber</span>\n</code></pre></div>\n<p>would you be able to take a look at these?</p>\n</blockquote>\n<p>These are fixed now.</p>",
        "id": 455845006,
        "sender_full_name": "Joël Riou",
        "timestamp": 1722580985
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/455813141\">said</a>:</p>\n<blockquote>\n<ul>\n<li>Mathlib.CategoryTheory.Sites.Coherent.ReflectsPrecoherent</li>\n<li>Mathlib.CategoryTheory.Sites.Coherent.ReflectsPreregular</li>\n<li>Mathlib.CategoryTheory.Sites.DenseSubsite</li>\n<li>Mathlib.CategoryTheory.Sites.LocallyInjective</li>\n</ul>\n</blockquote>\n<p>I think I've fixed them. What's the proccess then? Should I push to the branch directly?</p>",
        "id": 455853679,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1722583238
    },
    {
        "content": "<p>Yes, you can push to the branch directly.</p>",
        "id": 455853910,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722583351
    },
    {
        "content": "<p>If you didn't need to also use <code>include</code>, then we can backport to <code>master</code> as well.</p>",
        "id": 455853942,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722583366
    },
    {
        "content": "<p>(And if you did need to use <code>include</code>, then I'll backport after Mathlib moves to v4.11 in the next few days: it will contain a temporary noop <code>include</code>.)</p>",
        "id": 455854023,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722583409
    },
    {
        "content": "<p>No I had to use include here and there.</p>",
        "id": 455854165,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1722583462
    },
    {
        "content": "<p>We have a number of open PRs backporting changes. It would be great to get some eyes on these and have them in, as there are going to be many more!</p>",
        "id": 456415565,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722821979
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15429\">#15429</a></p>",
        "id": 456415567,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722821980
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15434\">#15434</a></p>",
        "id": 456415574,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722821996
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15431\">#15431</a></p>",
        "id": 456415622,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722822003
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15429\">#15429</a></p>",
        "id": 456415634,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722822010
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15422\">#15422</a></p>",
        "id": 456415745,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722822113
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15246\">#15246</a></p>",
        "id": 456416019,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722822310
    },
    {
        "content": "<p>I'm resuming work on <a href=\"https://github.com/leanprover-community/mathlib4/tree/lean-pr-testing-4814\">branch#lean-pr-testing-4814</a></p>",
        "id": 456427688,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722827309
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15510\">#15510</a></p>",
        "id": 456434624,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722831503
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span> or <span class=\"user-mention\" data-user-id=\"111080\">@Floris van Doorn</span> could I get your opinion about what to do with the nicely commented <code>variable</code> block at the top of <a href=\"https://tqft.net/mathlib4files/Geometry/Manifold/ContMDiff/Defs\">file#Geometry/Manifold/ContMDiff/Defs</a>?</p>",
        "id": 456491570,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722850624
    },
    {
        "content": "<p>It begins</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c\">/-</span><span class=\"cm\">! ### Definition of smooth functions between manifolds -/</span>\n\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">𝕜</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NontriviallyNormedField</span><span class=\"w\"> </span><span class=\"n\">𝕜</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"c1\">-- declare a smooth manifold `M` over the pair `(E, H)`.</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">NormedAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedSpace</span><span class=\"w\"> </span><span class=\"n\">𝕜</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ModelWithCorners</span><span class=\"w\"> </span><span class=\"n\">𝕜</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ChartedSpace</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">SmoothManifoldWithCorners</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"c1\">-- declare a smooth manifold `M'` over the pair `(E', H')`.</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">E'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">NormedAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">E'</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedSpace</span><span class=\"w\"> </span><span class=\"n\">𝕜</span><span class=\"w\"> </span><span class=\"n\">E'</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">H'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">H'</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">I'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ModelWithCorners</span><span class=\"w\"> </span><span class=\"n\">𝕜</span><span class=\"w\"> </span><span class=\"n\">E'</span><span class=\"w\"> </span><span class=\"n\">H'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">M'</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ChartedSpace</span><span class=\"w\"> </span><span class=\"n\">H'</span><span class=\"w\"> </span><span class=\"n\">M'</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">SmoothManifoldWithCorners</span><span class=\"w\"> </span><span class=\"n\">I'</span><span class=\"w\"> </span><span class=\"n\">M'</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>However I need to remove <code>[SmoothManifoldWithCorners I M]</code> and <code>[SmoothManifoldWithCorners I' M']</code> for an initial segment of the file.</p>",
        "id": 456491652,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722850652
    },
    {
        "content": "<p>Anywhere else I would just remove them, and add them again when needed later, but since you've gone to the effort to document that variables command, I'm hoping you'll be able to take a look and find a way to do it and preserve the nice documentation!</p>",
        "id": 456491849,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722850696
    },
    {
        "content": "<p>(This is on <a href=\"https://github.com/leanprover-community/mathlib4/tree/lean-pr-testing-4814\">branch#lean-pr-testing-4814</a>)</p>",
        "id": 456493088,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722850993
    },
    {
        "content": "<p>I'm done for a while if anyone would like to have a go on this branch. :-) We're getting there, about 80% of the way through mathlib now.</p>",
        "id": 456538091,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722862695
    },
    {
        "content": "<p>Resuming...</p>",
        "id": 456752980,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722913310
    },
    {
        "content": "<p>Stopping for a while:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Success</span><span class=\"w\"> </span><span class=\"bp\">✔</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">4481</span>\n<span class=\"n\">Warning</span><span class=\"w\"> </span><span class=\"bp\">⚠</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">18</span>\n<span class=\"n\">Error</span><span class=\"w\">   </span><span class=\"bp\">✖</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">12</span>\n</code></pre></div>",
        "id": 456781202,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722926968
    },
    {
        "content": "<p>where do you get those numbers from?</p>",
        "id": 456782325,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722927450
    },
    {
        "content": "<p>i'll have a go at it</p>",
        "id": 456783008,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722927736
    },
    {
        "content": "<p>ah, i imagine it'll be useful if <code>#where</code> also shows which variables are <code>include</code>-ed...</p>",
        "id": 456797735,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722933117
    },
    {
        "content": "<p>also, today i learnt that <code>instance</code>s use <code>def</code> regardless of if the class is a <code>Prop</code> or not, resulting in <code>include</code> not mattering for those</p>",
        "id": 456798683,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722933476
    },
    {
        "content": "<p>I'm working on <code>Geometry.Manifold.ContMDiff.Defs</code> and others</p>",
        "id": 456805302,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722935637
    },
    {
        "content": "<p>????</p>",
        "id": 456805435,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722935659
    },
    {
        "content": "<p>i have the branch claimed though?</p>",
        "id": 456805609,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722935697
    },
    {
        "content": "<p>I'm still waiting for Floris</p>",
        "id": 456806961,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722936159
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598052\">@Jeremy Tan</span> Edward has the branch claimed. Please wait your turn.</p>",
        "id": 456820496,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722940707
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"598052\">Jeremy Tan</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/456782325\">said</a>:</p>\n<blockquote>\n<p>where do you get those numbers from?</p>\n</blockquote>\n<p>The numbers come from my <a href=\"https://gist.github.com/semorrison/3cd94425e1942645b21f4d040dea13d3\"><code>count-errors</code></a> script and </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"c1\">--verbose build | count-errors</span>\n</code></pre></div>",
        "id": 456823265,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722941830
    },
    {
        "content": "<p>Another useful script I have is <a href=\"https://gist.github.com/semorrison/c56734c4c1b447438852468362ee3497\"><code>open-errors</code></a>, which you then use as <code>open-errors lake build</code>, to get all files with errors or warnings opened in VSCode.</p>",
        "id": 456823578,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722941955
    },
    {
        "content": "<p>Oh, oops <span class=\"user-mention\" data-user-id=\"684366\">@Edward van de Meent</span>, I have local fixes to LinearAlgebra/Matrix/PosDef.lean and AlgebraGeometry/Morphisms/Basic.lean that I forgot to commit. I just pushed PosDef after merging, and will make a backport for Morphisms/Basic</p>",
        "id": 456834245,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722944847
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15543\">#15543</a> (and pushed to the branch)</p>",
        "id": 456834907,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722944947
    },
    {
        "content": "<p>i think it'd be good for an expert to look at <code>Mathlib/Analysis/CstarAlgebra/ContinuousFunctionalCalculus/Unital.lean</code>... i can fix it on the branch, but it is hard to backport because the <code>cfc_tac</code> and <code>cfc_cont_tac</code> seem prone to breaking by rearranging <code>variable</code>s and <code>theorem</code>s...</p>",
        "id": 456835857,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722945171
    },
    {
        "content": "<p>i suppose for now it might be sufficient to just push to the branch and be done with it...</p>",
        "id": 456836941,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722945494
    },
    {
        "content": "<p>there seems to be a problem with importing a file using the <code>suppress_compilation</code> tactic? the error says <code>failed to read file '.\\.\\.lake\\build\\lib\\Mathlib\\CategoryTheory\\Abelian\\ProjectiveResolution.olean', invalid header</code></p>",
        "id": 456841347,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722946545
    },
    {
        "content": "<p>commenting out <code>suppress_compilation</code> in the file fixes it...</p>",
        "id": 456841462,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722946579
    },
    {
        "content": "<p>still maybe someone should look into why this happens.</p>",
        "id": 456841495,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722946594
    },
    {
        "content": "<p>This may mean that you have an older version of the PR toolchain than the cache, try deleting it</p>",
        "id": 456841503,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1722946599
    },
    {
        "content": "<p>By changing the file, you made sure it's not using the cached version anymore</p>",
        "id": 456841683,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1722946644
    },
    {
        "content": "<p>curious</p>",
        "id": 456841766,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722946661
    },
    {
        "content": "<p>It only happens on PR branches as otherwise Lean releases are immutable</p>",
        "id": 456842372,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1722946771
    },
    {
        "content": "<p>let's see if that fixes it...</p>",
        "id": 456842439,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722946795
    },
    {
        "content": "<p>I can take a look at the cfc stuff now, if the branch is available. Please @ me as soon as it is and I will deal with all cfc-related stuff. I imagine it may be hard for others to deal with because of all the autoparams and some still broken things with fun_prop.</p>",
        "id": 456852646,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722949730
    },
    {
        "content": "<p>It's <a href=\"https://github.com/leanprover-community/mathlib4/tree/lean-pr-testing-4814\">branch#lean-pr-testing-4814</a> , correct?</p>",
        "id": 456853125,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722949867
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"684366\">@Edward van de Meent</span> do you still have this branch claimed? I wasn't quite sure from the last few messages from you.</p>",
        "id": 456853415,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722949941
    },
    {
        "content": "<p>yes, i'm still working on it.</p>",
        "id": 456853470,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722949957
    },
    {
        "content": "<p>ok i'm done, <a href=\"https://github.com/leanprover-community/mathlib4/pull/15549\">#15549</a> is a small backport. <span class=\"user-mention\" data-user-id=\"197836\">@Jireh Loreaux</span> the branch is free</p>",
        "id": 456860597,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722951914
    },
    {
        "content": "<p>Okay, I will start here in a minute.</p>",
        "id": 456860679,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722951940
    },
    {
        "content": "<p>so under what circumstances do we backport changes exactly?</p>",
        "id": 456884459,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722957747
    },
    {
        "content": "<p>i think the general idea is when the changes also work with the current version of lean...<br>\ni.e. when you have to add <code>include</code>, you don't backport, but changes adding <code>sections</code> or moving around theorems can be backported....</p>",
        "id": 456884922,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722957852
    },
    {
        "content": "<p>Probably other people can work on this branch too right now if they are not working in the <code>CstarAlgebra</code> folder.</p>",
        "id": 456888186,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722958724
    },
    {
        "content": "<p>I guess I'll update here as I work on new files, and I'm okay if people want to work on parallel here, as long as we claim separate files.</p>",
        "id": 456888762,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722958917
    },
    {
        "content": "<p>currently, I'm moving on to <code>Mathlib.Algebra.Algebra.NonUnitalSubalgebra</code></p>",
        "id": 456888867,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722958944
    },
    {
        "content": "<p>Pushing commits to the following files:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">On</span><span class=\"w\"> </span><span class=\"n\">branch</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">pr</span><span class=\"bp\">-</span><span class=\"n\">testing</span><span class=\"bp\">-</span><span class=\"mi\">4814</span>\n<span class=\"n\">Your</span><span class=\"w\"> </span><span class=\"n\">branch</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">up</span><span class=\"bp\">-</span><span class=\"n\">to</span><span class=\"bp\">-</span><span class=\"n\">date</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">origin</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">pr</span><span class=\"bp\">-</span><span class=\"n\">testing</span><span class=\"bp\">-</span><span class=\"mi\">4814</span><span class=\"bp\">'.</span>\n\n<span class=\"n\">Changes</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">committed</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"s2\">\"git restore --staged &lt;file&gt;...\"</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">unstage</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">modified</span><span class=\"o\">:</span><span class=\"w\">   </span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Algebra</span><span class=\"bp\">/</span><span class=\"n\">Algebra</span><span class=\"bp\">/</span><span class=\"n\">NonUnitalSubalgebra</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">    </span><span class=\"n\">modified</span><span class=\"o\">:</span><span class=\"w\">   </span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Algebra</span><span class=\"bp\">/</span><span class=\"n\">DirectSum</span><span class=\"bp\">/</span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">    </span><span class=\"n\">modified</span><span class=\"o\">:</span><span class=\"w\">   </span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Geometry</span><span class=\"bp\">/</span><span class=\"n\">Manifold</span><span class=\"bp\">/</span><span class=\"n\">ContMDiff</span><span class=\"bp\">/</span><span class=\"n\">Defs</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">    </span><span class=\"n\">modified</span><span class=\"o\">:</span><span class=\"w\">   </span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">MeasureTheory</span><span class=\"bp\">/</span><span class=\"n\">Measure</span><span class=\"bp\">/</span><span class=\"n\">Regular</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n</code></pre></div>",
        "id": 456894357,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722960333
    },
    {
        "content": "<p>can you indicate which files you plan to pursue now?</p>",
        "id": 456894879,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722960478
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598052\">@Jeremy Tan</span></p>",
        "id": 456894934,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722960483
    },
    {
        "content": "<p><code>Algebra.DirectLimit</code>, for a start</p>",
        "id": 456895197,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722960551
    },
    {
        "content": "<p>I'm now working on <code>Algebra.Star.NonUnitalSubalgebra</code></p>",
        "id": 456904267,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722962670
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/456491570\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110050\">Sébastien Gouëzel</span> or <span class=\"user-mention silent\" data-user-id=\"111080\">Floris van Doorn</span> could I get your opinion about what to do with the nicely commented <code>variable</code> block at the top of <a href=\"https://tqft.net/mathlib4files/Geometry/Manifold/ContMDiff/Defs\">file#Geometry/Manifold/ContMDiff/Defs</a>?</p>\n</blockquote>\n<p>Feel free to just move those variables lower and replace \"smooth manifold\" by \"charted space\" in the comments</p>",
        "id": 456905755,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1722962944
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/456904267\">said</a>:</p>\n<blockquote>\n<p>I'm now working on <code>Algebra.Star.NonUnitalSubalgebra</code></p>\n</blockquote>\n<p>done and pushed</p>",
        "id": 456916605,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722966002
    },
    {
        "content": "<p>In case anyone felt I still had claim on the branch, consider it relinquished for now.</p>",
        "id": 456916889,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722966121
    },
    {
        "content": "<p>I have the changes to <code>Algebra.DirectLimit</code>. <span class=\"user-mention\" data-user-id=\"598052\">@Jeremy Tan</span> if I don't hear from you within 30-60 minutes, i'll just push them.</p>",
        "id": 456938510,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722972580
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"111080\">Floris van Doorn</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/456905755\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/456491570\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110050\">Sébastien Gouëzel</span> or <span class=\"user-mention silent\" data-user-id=\"111080\">Floris van Doorn</span> could I get your opinion about what to do with the nicely commented <code>variable</code> block at the top of <a href=\"https://tqft.net/mathlib4files/Geometry/Manifold/ContMDiff/Defs\">file#Geometry/Manifold/ContMDiff/Defs</a>?</p>\n</blockquote>\n<p>Feel free to just move those variables lower and replace \"smooth manifold\" by \"charted space\" in the comments</p>\n</blockquote>\n<p>It looks like Jeremy has tackled this file in the meantime. <span class=\"user-mention\" data-user-id=\"598052\">@Jeremy Tan</span>, were your changes compatible with this suggestion from Floris?</p>",
        "id": 456970276,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722983703
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"684366\">@Edward van de Meent</span>, <span class=\"user-mention\" data-user-id=\"598052\">@Jeremy Tan</span>, <span class=\"user-mention\" data-user-id=\"197836\">@Jireh Loreaux</span> for your work overnight. We're now at</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Success</span><span class=\"w\"> </span><span class=\"bp\">✔</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">4521</span>\n<span class=\"n\">Warning</span><span class=\"w\"> </span><span class=\"bp\">⚠</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">19</span>\n<span class=\"n\">Error</span><span class=\"w\">   </span><span class=\"bp\">✖</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">9</span>\n</code></pre></div>\n<p>(with a target of about 4880).</p>",
        "id": 456971921,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722984608
    },
    {
        "content": "<p>I'll claim the branch again, although if anyone would like it I have lots of broken backporting PRs I can switch to!</p>",
        "id": 456976077,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722987304
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/456970276\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"598052\">Jeremy Tan</span>, were your changes compatible with this suggestion from Floris?</p>\n</blockquote>\n<p>Yes (I had to go to bed)</p>",
        "id": 456982880,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722992396
    },
    {
        "content": "<p>Which files are you working on <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span>?</p>",
        "id": 456985801,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722994673
    },
    {
        "content": "<p>Currently I am cleaning up existing open PRs, so if you would like to take the main branch, that would be great!</p>",
        "id": 456985872,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722994714
    },
    {
        "content": "<p>Note that I've just merged <code>nightly-testing</code> back into it</p>",
        "id": 456985889,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722994724
    },
    {
        "content": "<p>I think the merge went well, but there may be some breakages.</p>",
        "id": 456985905,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722994736
    },
    {
        "content": "<p>In that case I've fixed up <code>Order.Filter.AtTopBot</code> – sure I'll take the main branch <code>...-testing-4814</code></p>",
        "id": 456985964,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722994787
    },
    {
        "content": "<p>Oh, I just fixed that.</p>",
        "id": 456986002,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722994802
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15574\">#15574</a></p>",
        "id": 456986026,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722994809
    },
    {
        "content": "<p>Resuming on <code>Analysis.BoxIntegral.Partition.Filter</code></p>",
        "id": 456988039,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722995539
    },
    {
        "content": "<p>I have the fix for <code>Mathlib.MeasureTheory.Integral.Marginal</code> (found the problem in a backport PR)</p>",
        "id": 456988061,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722995578
    },
    {
        "content": "<p>huh? is that a prerequisite to the file I just mentioned?</p>",
        "id": 456988124,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722995618
    },
    {
        "content": "<p>(locally building my file while the cache is regenerated)</p>",
        "id": 456988143,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722995637
    },
    {
        "content": "<p>I doubt it, as <code>Marginal</code> had errors so you shouldn't have seen anything downstream of it.</p>",
        "id": 456988230,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722995672
    },
    {
        "content": "<p>Okay, I've fixed all the <a href=\"https://github.com/leanprover-community/mathlib4/pulls?q=is%3Aopen+is%3Apr+backports+-label%3AWIP\">outstanding backport PRs</a>, I think, and would like to return to the main branch.</p>",
        "id": 456996008,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722998801
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598052\">@Jeremy Tan</span> assuming I avoid <code>Partition.Filter</code>, is that okay?</p>",
        "id": 456996033,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722998823
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/456996033\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"598052\">Jeremy Tan</span> assuming I avoid <code>Partition.Filter</code>, is that okay?</p>\n</blockquote>\n<p>I already fixed it in <a href=\"https://github.com/leanprover-community/mathlib4/commit/6f26b1701dd6f958a850594817a0d8e66ce305a5\">https://github.com/leanprover-community/mathlib4/commit/6f26b1701dd6f958a850594817a0d8e66ce305a5</a></p>",
        "id": 456996922,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722999410
    },
    {
        "content": "<p>In fact there probably isn't anything more to fix there</p>",
        "id": 456996946,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722999431
    },
    {
        "content": "<p>two more have been pushed. I'm just waiting for my local build to show problem files for me, fixing the earliest ones one at a time</p>",
        "id": 456997105,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722999562
    },
    {
        "content": "<p>Okay, that will definitely result in contention. :-)</p>",
        "id": 456997259,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722999625
    },
    {
        "content": "<p>Are you making backports for changes that will work on <code>master</code>?</p>",
        "id": 456997278,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722999636
    },
    {
        "content": "<p>no, not making backports</p>",
        "id": 456997290,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722999646
    },
    {
        "content": "<p>Please do!</p>",
        "id": 456997298,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722999651
    },
    {
        "content": "<p>All these changes need review.</p>",
        "id": 456997313,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722999661
    },
    {
        "content": "<p>Perhaps you could pause on making further progress, and review your recent commits to see what could be made into PRs to <code>master</code>?</p>",
        "id": 456997336,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722999686
    },
    {
        "content": "<p>I'm hoping that we can get to the point that the only diff between master and lean-pr-testing-4814 are adding <code>include</code> and removing <code>clear</code>.</p>",
        "id": 456997378,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722999718
    },
    {
        "content": "<p>Otherwise it is going to be a nightmare to review.</p>",
        "id": 456997434,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722999726
    },
    {
        "content": "<p>I'll make backporting PRs for the stuff I changed tomorrow.</p>",
        "id": 456997809,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722999991
    },
    {
        "content": "<p>Will be putting my stuff into <a href=\"https://github.com/leanprover-community/mathlib4/pull/15577\">#15577</a></p>",
        "id": 457005226,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723003673
    },
    {
        "content": "<p>All right, all my contributions to the testing branch should now be in <a href=\"https://github.com/leanprover-community/mathlib4/pull/15577\">#15577</a></p>",
        "id": 457015946,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723009368
    },
    {
        "content": "<p>As of latest push to the testing branch</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Success</span><span class=\"w\"> </span><span class=\"bp\">✔</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">4577</span>\n<span class=\"n\">Warning</span><span class=\"w\"> </span><span class=\"bp\">⚠</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">20</span>\n<span class=\"n\">Error</span><span class=\"w\">   </span><span class=\"bp\">✖</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">12</span>\n</code></pre></div>",
        "id": 457038478,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723016987
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598052\">@Jeremy Tan</span> are you still working on the branch? i'd like to push some style fixes from one of the backport PRs...</p>",
        "id": 457061921,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723022682
    },
    {
        "content": "<p>no</p>",
        "id": 457062183,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723022767
    },
    {
        "content": "<p>ok, i pushed the fix. the branch should be free now.</p>",
        "id": 457062497,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723022876
    },
    {
        "content": "<p>In <a href=\"https://github.com/leanprover-community/mathlib4/pull/15577\">#15577</a> <span class=\"user-mention\" data-user-id=\"598052\">@Jeremy Tan</span> has (admirably) given newly introduced <code>section</code>s to control the scope of variables descriptive names.</p>\n<p>However I'd like to make sure these names are predictable and uniform to the extent possible.</p>\n<p>Examples in <a href=\"https://github.com/leanprover-community/mathlib4/pull/15577\">#15577</a> are:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">section</span><span class=\"w\"> </span><span class=\"n\">RAA</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsScalarTower</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SMulCommClass</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>for which I'd suggest the best available name is actually <code>IsScalarTower</code><br>\nand in a different file</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">section</span><span class=\"w\"> </span><span class=\"n\">DecEqIota</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>which I'd suggest is <code>DecidableEq</code>.</p>\n<p>Ideally these section names would actually refer the main <code>def</code> enclosed, but when that isn't available or doesn't make sense, I think just the \"main\" typeclass name that is being turned on and off is the next best thing.</p>",
        "id": 457064023,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723023350
    },
    {
        "content": "<p>Opinions on this welcome.</p>",
        "id": 457064130,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723023377
    },
    {
        "content": "<p>we do already have sections <code>Module</code>, <code>Ring</code>, <code>Group</code>, etc... so continuing that naming scheme does seem sensible</p>",
        "id": 457064386,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723023469
    },
    {
        "content": "<p>however, there <em>is</em> a limit to this scheme, in that there may be multiple possible <code>[IsScalarTower _ _ _]</code> to be introduced. In such a case simply using <code>IsScalarTower</code> as a section name is not completely unambiguous... but it's better than nothing.</p>",
        "id": 457065639,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723023814
    },
    {
        "content": "<p>What you're offering as the \"next best thing\" is my usual section naming practice</p>",
        "id": 457079649,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1723028506
    },
    {
        "content": "<p>i think it hardly happens that a section to is dedicated to a single main result, rather than it being dedicated to consequences of the same assumptions/context</p>",
        "id": 457080141,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723028679
    },
    {
        "content": "<p>although that might be my inexperience with mathlib speaking</p>",
        "id": 457080210,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723028705
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> done</p>",
        "id": 457098456,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723034298
    },
    {
        "content": "<p>FWIW I would always shy away from using section names which could be namespaces, because when you see <code>End Module</code> you don't know whether this is the end of a section or a namespace. But now you seem to be able to see which section you're in in VS Code at the top of the pane, so maybe I'll change my habits.</p>",
        "id": 457119840,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1723039763
    },
    {
        "content": "<p>Oops, forgot to claim the branch, I'm working on it now. It is feeling like the downhill run to the end now!!</p>",
        "id": 457251599,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723087017
    },
    {
        "content": "<p>Thanks very much to <span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span> for reviewing of all the open PRs overnight!</p>",
        "id": 457251632,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723087039
    },
    {
        "content": "<p>We are definitely getting closer now:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Geometry</span><span class=\"bp\">.</span><span class=\"n\">Manifold</span><span class=\"bp\">.</span><span class=\"n\">VectorBundle</span><span class=\"bp\">.</span><span class=\"n\">FiberwiseLinear</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Geometry</span><span class=\"bp\">.</span><span class=\"n\">Manifold</span><span class=\"bp\">.</span><span class=\"n\">VectorBundle</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">NormedSpace</span><span class=\"bp\">.</span><span class=\"n\">PiTensorProduct</span><span class=\"bp\">.</span><span class=\"n\">InjectiveSeminorm</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Geometry</span><span class=\"bp\">.</span><span class=\"n\">Manifold</span><span class=\"bp\">.</span><span class=\"n\">MFDeriv</span><span class=\"bp\">.</span><span class=\"n\">UniqueDifferential</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Geometry</span><span class=\"bp\">.</span><span class=\"n\">Manifold</span><span class=\"bp\">.</span><span class=\"n\">ContMDiffMFDeriv</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Geometry</span><span class=\"bp\">.</span><span class=\"n\">Manifold</span><span class=\"bp\">.</span><span class=\"n\">LocalDiffeomorph</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Geometry</span><span class=\"bp\">.</span><span class=\"n\">Manifold</span><span class=\"bp\">.</span><span class=\"n\">PoincareConjecture</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Geometry</span><span class=\"bp\">.</span><span class=\"n\">Manifold</span><span class=\"bp\">.</span><span class=\"n\">VectorBundle</span><span class=\"bp\">.</span><span class=\"n\">SmoothSection</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">Integral</span><span class=\"bp\">.</span><span class=\"n\">IntervalAverage</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Probability</span><span class=\"bp\">.</span><span class=\"n\">Kernel</span><span class=\"bp\">.</span><span class=\"n\">CondDistrib</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Probability</span><span class=\"bp\">.</span><span class=\"n\">Kernel</span><span class=\"bp\">.</span><span class=\"n\">Condexp</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">BoundedVariation</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">BoxIntegral</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">Integral</span><span class=\"bp\">.</span><span class=\"n\">FundThmCalculus</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Lie</span><span class=\"bp\">.</span><span class=\"n\">Weights</span><span class=\"bp\">.</span><span class=\"n\">RootSystem</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Convolution</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n<span class=\"n\">Success</span><span class=\"w\"> </span><span class=\"bp\">✔</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">4738</span>\n<span class=\"n\">Warning</span><span class=\"w\"> </span><span class=\"bp\">⚠</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">9</span>\n<span class=\"n\">Error</span><span class=\"w\">   </span><span class=\"bp\">✖</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">7</span>\n</code></pre></div>",
        "id": 457274424,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723096765
    },
    {
        "content": "<p>Very close to the end, and I'm stopping for a while.</p>\n<p>There are some <a href=\"https://github.com/leanprover-community/mathlib4/pulls?q=sort%3Aupdated-desc+is%3Apr+is%3Aopen+backports+-label%3AWIP\">open PRs</a> that could do with a review.</p>\n<p>Currently remaining:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">CStarAlgebra</span><span class=\"bp\">.</span><span class=\"n\">ContinuousFunctionalCalculus</span><span class=\"bp\">.</span><span class=\"n\">Unique</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Geometry</span><span class=\"bp\">.</span><span class=\"n\">Manifold</span><span class=\"bp\">.</span><span class=\"n\">BumpFunction</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Geometry</span><span class=\"bp\">.</span><span class=\"n\">Manifold</span><span class=\"bp\">.</span><span class=\"n\">PartitionOfUnity</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">FunctionalSpaces</span><span class=\"bp\">.</span><span class=\"n\">SobolevInequality</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">NumberTheory</span><span class=\"bp\">.</span><span class=\"n\">NumberField</span><span class=\"bp\">.</span><span class=\"n\">Embeddings</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Fourier</span><span class=\"bp\">.</span><span class=\"n\">FourierTransformDeriv</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">CStarAlgebra</span><span class=\"bp\">.</span><span class=\"n\">ContinuousFunctionalCalculus</span><span class=\"bp\">.</span><span class=\"n\">Order</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n<span class=\"n\">Success</span><span class=\"w\"> </span><span class=\"bp\">✔</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">4859</span>\n<span class=\"n\">Warning</span><span class=\"w\"> </span><span class=\"bp\">⚠</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">5</span>\n<span class=\"n\">Error</span><span class=\"w\">   </span><span class=\"bp\">✖</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n</code></pre></div>\n<p>and then another ~20 files hiding behind those errors.</p>",
        "id": 457292963,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723103466
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> I've got mathlib, Archive and Counterexamples all building without warnings</p>",
        "id": 457319039,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723110309
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15612\">#15612</a> is the backport PR for my recent slate of changes</p>",
        "id": 457326183,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723111996
    },
    {
        "content": "<p>Just pushing some linting changes now!</p>",
        "id": 457329830,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723112649
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/457119840\">said</a>:</p>\n<blockquote>\n<p>FWIW I would always shy away from using section names which could be namespaces, because when you see <code>End Module</code> you don't know whether this is the end of a section or a namespace. But now you seem to be able to see which section you're in in VS Code at the top of the pane, so maybe I'll change my habits.</p>\n</blockquote>\n<p>Is this an argument that section names should be <code>namedLike_theorems</code> not <code>NamedLikeNamespaces</code>?</p>",
        "id": 457331422,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723112980
    },
    {
        "content": "<p>Very minor, but: newline between <code>section</code> and <code>variable</code>, or no newline? I think no newline, but there is variation here.</p>",
        "id": 457331722,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723113041
    },
    {
        "content": "<p>It looks like we are ready! It is now a pretty gigantic diff on <a href=\"https://github.com/leanprover-community/mathlib4/tree/lean-pr-testing-4814\">branch#lean-pr-testing-4814</a>. I am considering the possibility that we release <a href=\"https://github.com/leanprover/lean4/pull/4814\">lean#4814</a> as part of a <code>v4.11.0-rc2</code> (there is independently demand for this), and then move Mathlib up to this promptly.</p>\n<p>This would avoid us carrying around this enormous diff on <code>nightly-testing</code> for the rest of the month.</p>\n<p>Please voice any objections here!</p>",
        "id": 457332834,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723113327
    },
    {
        "content": "<p>(This would also allow proceeding with work on <code>byAsSorry</code> without overlapping diffs...)</p>",
        "id": 457332923,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723113359
    },
    {
        "content": "<p>it could be possible some back-portable changes might have slipped in, maybe it's good to make a last check?</p>",
        "id": 457333030,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723113395
    },
    {
        "content": "<p>Yes, if anyone wants to inspect the <code>lean-pr-testing-4814...master</code> diff for more backports that would be great.</p>",
        "id": 457333103,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723113424
    },
    {
        "content": "<p>Also important is that we get review of the remaining five open backporting PRs: <a href=\"https://github.com/leanprover-community/mathlib4/pulls?q=sort%3Aupdated-desc+is%3Apr+is%3Aopen+backports+-label%3AWIP\">https://github.com/leanprover-community/mathlib4/pulls?q=sort%3Aupdated-desc+is%3Apr+is%3Aopen+backports+-label%3AWIP</a></p>",
        "id": 457333160,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723113444
    },
    {
        "content": "<p>What about the mathlib tests, which are still failing?</p>",
        "id": 457333376,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723113538
    },
    {
        "content": "<p>I'll take a look.</p>",
        "id": 457333460,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723113573
    },
    {
        "content": "<p>I'm running <code>make lint</code> locally, I expect that will have failures too.</p>",
        "id": 457333475,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723113583
    },
    {
        "content": "<p>Oh, the test failures are minor, they are just differences in messages...</p>",
        "id": 457333564,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723113622
    },
    {
        "content": "<p>It doesn't really feel like a release candidate change, but also in favour of not carrying massive diffs on nightly testing</p>",
        "id": 457333650,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1723113651
    },
    {
        "content": "<p>i am seeing some <code>failed to infer instance</code> errors in the (CI) tests though...</p>",
        "id": 457333657,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723113654
    },
    {
        "content": "<p>We finally have a new nightly, I'll go get that working and rebase <a href=\"https://github.com/leanprover/lean4/pull/4814\">lean#4814</a></p>",
        "id": 457333665,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723113656
    },
    {
        "content": "<p>(Noting that <code>rc2</code> is going to happen anyway, so it's a question of whether to include this, not whether this warrants it by itself.)</p>",
        "id": 457333741,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723113688
    },
    {
        "content": "<p>Does anyone know how to do the following git magic reliably:</p>\n<p>Make a PR to master, containing the relative diff of <code>lean-pr-testing-4814</code> to <code>nightly-testing</code>?</p>",
        "id": 457334190,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723113869
    },
    {
        "content": "<p>not reliably, no... but maybe something like this would work: new branch on <code>nightly-testing</code>, squash merge <code>lean-pr-testing-4814</code> onto that branch, then cherry pick the merge commit onto a new branch of master, and fix any conflicts</p>",
        "id": 457334876,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723114073
    },
    {
        "content": "<p>alternatively, you could try a <code>rebase -i master</code> on the new branch from <code>nightly-testing</code> (rather than a cherry pick), but there might be too many commits in-between <code>nightly-testing</code> and <code>master</code> to easily isolate the merge-commit</p>",
        "id": 457335749,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723114227
    },
    {
        "content": "<p><code>nightly-testing</code> was just recently reset to <code>master</code>, so that might actually work</p>",
        "id": 457335911,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723114258
    },
    {
        "content": "<p>i'm confused.</p>\n<p>the test file <code>dfinsupp_notation</code> is currently failing on the branch, due to an added section in <code>Data.DFinsupp.Basic</code> which results in the order of parameters of <code>DFinsupp.update</code> changing. in principle the fix for this (slightly amending the elaborator for the notation) could be backported.</p>\n<p>however the current version of master doesn't seem to include this added section causing it all. Worse, looking at <code>git blame</code> for the line, it was added in the commit \"chore: backports for <a href=\"https://github.com/leanprover/lean4/pull/4814\">leanprover/lean4#4814</a> (part 9)\" <code>2dba55c</code>, however when i look at the corresponding PR(s! <a href=\"https://github.com/leanprover-community/mathlib4/pull/15389\">#15389</a> and <a href=\"https://github.com/leanprover-community/mathlib4/pull/15352\">#15352</a>), this change appears to not be included... what's going on? <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span></p>",
        "id": 457371504,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723123728
    },
    {
        "content": "<p>looking into it a bit more, it seems that it originally was included in <a href=\"https://github.com/leanprover-community/mathlib4/pull/15389\">#15389</a> but the changes were reverted (possibly due to this exact test failing?)</p>",
        "id": 457371931,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723123853
    },
    {
        "content": "<p>for what it's worth, the change in order of parameters of <code>DFinsupp.update</code> makes it line up with <code>Finsupp.update</code>, and the way to fix the test is a one-line change.</p>",
        "id": 457372428,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723123997
    },
    {
        "content": "<p>I might be able to backport a few changes, as I didn't get around to it yesterday.</p>",
        "id": 457372847,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1723124132
    },
    {
        "content": "<p>What (part #?) are we on now for backports?</p>",
        "id": 457373302,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1723124257
    },
    {
        "content": "<p>from a quick search through the PRs, it seems the next one should be # 38?</p>",
        "id": 457373471,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723124314
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15618\">#15618</a></p>",
        "id": 457373839,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1723124430
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/457372428\">said</a>:</p>\n<blockquote>\n<p>for what it's worth, the change in order of parameters of <code>DFinsupp.update</code> makes it line up with <code>Finsupp.update</code>, and the way to fix the test is a one-line change.</p>\n</blockquote>\n<p>Thanks <span class=\"user-mention\" data-user-id=\"684366\">@Edward van de Meent</span> for diagnosing this. I've changed the elaborator on lean-pr-testing-4814.</p>",
        "id": 459363890,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723178302
    },
    {
        "content": "<p>and backported as <a href=\"https://github.com/leanprover-community/mathlib4/pull/15636\">#15636</a></p>",
        "id": 459364394,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723178475
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"346070\">@Tomas Skrivan</span>, would you be able to take a look at <code>test/fun_prop_dev.lean</code> on <a href=\"https://github.com/leanprover-community/mathlib4/tree/lean-pr-testing-4814\">branch#lean-pr-testing-4814</a>? It is (thoroughly) failing, and is currently the last problem on this branch.</p>\n<p>(If you wanted to add whatever documentation you think would have resulted in me not bothering you about this file, that would independently be nice too. :-)</p>",
        "id": 459371077,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723180277
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/457331422\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/457119840\">said</a>:</p>\n<blockquote>\n<p>FWIW I would always shy away from using section names which could be namespaces, because when you see <code>End Module</code> you don't know whether this is the end of a section or a namespace. But now you seem to be able to see which section you're in in VS Code at the top of the pane, so maybe I'll change my habits.</p>\n</blockquote>\n<p>Is this an argument that section names should be <code>namedLike_theorems</code> not <code>NamedLikeNamespaces</code>?</p>\n</blockquote>\n<p>I actually like to have sections <code>«named like phrases»</code></p>",
        "id": 459384751,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1723185645
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/459371077\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"346070\">Tomas Skrivan</span>, would you be able to take a look at <code>test/fun_prop_dev.lean</code> on <a href=\"https://github.com/leanprover-community/mathlib4/tree/lean-pr-testing-4814\">branch#lean-pr-testing-4814</a>? It is (thoroughly) failing, and is currently the last problem on this branch.</p>\n<p>(If you wanted to add whatever documentation you think would have resulted in me not bothering you about this file, that would independently be nice too. :-)</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15650\">#15650</a> fixed </p>\n<p>Not sure what kind of comment would help. On top of the file it says</p>\n<blockquote>\n<p>This file is designed for development of fun_prop and does not depend on most of mathlib. It defines<br>\ntwo function properties <code>Con</code> and <code>Lin</code> which roughly correspond to <code>Continuity</code> and <code>IsLinearMap</code>.</p>\n</blockquote>\n<p>The file is doing exactly that. It postulates <code>Con</code> and <code>Lin</code> and postulates all the basic theorems that continuity and linearity satisfies. After that there is a huge laundry list(in no particular order) of functions that <code>fun_prop</code> should be able to prove continuity or linearity of. I'm happy to improve on the file description if you have an idea what would help you to understand it.</p>",
        "id": 459502908,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1723216633
    },
    {
        "content": "<p>i think there might be confusion about it being a file for <em>developement</em>... the tactic is seemingly finished, so why is there a developement file around?</p>",
        "id": 459504539,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723216956
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/459504539\">said</a>:</p>\n<blockquote>\n<p>i think there might be confusion about it being a file for <em>developement</em>... the tactic is seemingly finished, so why is there a developement file around?</p>\n</blockquote>\n<p>It is absolutely invaluable for testing, bug fixing and adding new features. Waiting for a rebuild of a big portion of mathlib every time I modify the tactic during development is completely unfeasible.</p>",
        "id": 459508243,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1723217807
    },
    {
        "content": "<p>but then how is it different from the <code>test/fun_prop.lean</code>?</p>",
        "id": 459509015,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723218086
    },
    {
        "content": "<p>I think Tomas just explained that.</p>",
        "id": 459509132,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1723218123
    },
    {
        "content": "<p>ah, like so</p>",
        "id": 459509218,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723218155
    },
    {
        "content": "<p><code>test/fun_prop.lean</code> tests <em>Mathlib</em> usage, but the development file is used for quickly testing the tactic without building Mathlib.</p>",
        "id": 459509236,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1723218163
    },
    {
        "content": "<p>i didn't notice that the other test files imported Mathlib stuff</p>",
        "id": 459509310,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723218189
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"346070\">@Tomas Skrivan</span>. CI is failing on <a href=\"https://github.com/leanprover-community/mathlib4/pull/15650\">#15650</a>, could you take a look?</p>",
        "id": 459688755,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723292405
    },
    {
        "content": "<p>But now it is failing on <code>/test/DeriveToExpr.lean</code> not on <code>fun_prop</code> test file</p>",
        "id": 459689837,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1723292805
    },
    {
        "content": "<p>Oh! I didn't see that it was a PR to lean-pr-testing-4814, I assumed it was a backport change to master</p>",
        "id": 459689944,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723292861
    },
    {
        "content": "<p>Okay, I can take it from there. Since we're moving this stuff to nightly-testing I may just close that PR and merge directly there.</p>",
        "id": 459690064,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723292899
    },
    {
        "content": "<p>Now that this has completely landed there, we should clarify the library standards with regards to use of <code>include</code>s. So I am revivifying this topic.</p>",
        "id": 463718215,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1724164081
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/287929-mathlib4/topic/New.20variable.20inclusion.20mechanism/near/454986607\">said</a>:</p>\n<blockquote>\n<p>I think the consensus is that in the long run we would like only have <code>include ... in</code>, and no section wide <code>include</code>.</p>\n</blockquote>",
        "id": 463718584,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1724164196
    }
]