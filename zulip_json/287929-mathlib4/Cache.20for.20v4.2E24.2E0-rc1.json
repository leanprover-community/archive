[
    {
        "content": "<p>Is <code>.olean</code>s for Mathlib v4.24.0-rc1 cached? Why my <code>cache</code> does not download cache of mathlib successfully?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Current</span><span class=\"w\"> </span><span class=\"n\">branch</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HEAD</span>\n<span class=\"n\">Using</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cloudflare</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">origin</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span>\n<span class=\"n\">Attempting</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">download</span><span class=\"w\"> </span><span class=\"mi\">6972</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"w\"> </span><span class=\"n\">cache</span>\n<span class=\"n\">Downloaded</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">attempted</span><span class=\"w\"> </span><span class=\"mi\">6972</span><span class=\"bp\">/</span><span class=\"mi\">6972</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">100</span><span class=\"bp\">%</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">88</span><span class=\"w\"> </span><span class=\"n\">KB</span><span class=\"bp\">/</span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"n\">Warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">files</span><span class=\"w\"> </span><span class=\"n\">were</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">found</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"bp\">.</span>\n<span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">usually</span><span class=\"w\"> </span><span class=\"n\">means</span><span class=\"w\"> </span><span class=\"n\">that</span><span class=\"w\"> </span><span class=\"n\">your</span><span class=\"w\"> </span><span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"n\">checkout</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">mathlib4</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">diverged</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">upstream</span><span class=\"bp\">.</span>\n<span class=\"n\">If</span><span class=\"w\"> </span><span class=\"n\">you</span><span class=\"w\"> </span><span class=\"n\">push</span><span class=\"w\"> </span><span class=\"n\">your</span><span class=\"w\"> </span><span class=\"n\">commits</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">branch</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">mathlib4</span><span class=\"w\"> </span><span class=\"n\">repository</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">CI</span><span class=\"w\"> </span><span class=\"n\">will</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">oleans</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">they</span><span class=\"w\"> </span><span class=\"n\">will</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">available</span><span class=\"w\"> </span><span class=\"n\">later</span><span class=\"bp\">.</span>\n<span class=\"n\">Alternatively</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">you</span><span class=\"w\"> </span><span class=\"n\">already</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">pushed</span><span class=\"w\"> </span><span class=\"n\">your</span><span class=\"w\"> </span><span class=\"n\">commits</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">branch</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">may</span><span class=\"w\"> </span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">CI</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">part</span><span class=\"bp\">-</span><span class=\"n\">way</span><span class=\"w\"> </span><span class=\"n\">through</span><span class=\"w\"> </span><span class=\"n\">building</span><span class=\"bp\">.</span>\n<span class=\"n\">Decompressing</span><span class=\"w\"> </span><span class=\"mi\">227</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span>\n<span class=\"n\">Unpacked</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"mi\">21</span><span class=\"w\"> </span><span class=\"n\">ms</span>\n<span class=\"n\">Completed</span><span class=\"w\"> </span><span class=\"n\">successfully!</span>\n</code></pre></div>",
        "id": 541939802,
        "sender_full_name": "Kitsune Kiriha",
        "timestamp": 1759117369
    },
    {
        "content": "<p>What is the output of <code>git status</code>?</p>",
        "id": 541995221,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1759140849
    },
    {
        "content": "<p>$ git status</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Not</span><span class=\"w\"> </span><span class=\"n\">currently</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">any</span><span class=\"w\"> </span><span class=\"n\">branch</span><span class=\"bp\">.</span>\n<span class=\"n\">nothing</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">commit</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">working</span><span class=\"w\"> </span><span class=\"n\">tree</span><span class=\"w\"> </span><span class=\"n\">clean</span>\n</code></pre></div>\n<p>$ git tag -l</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">24</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n</code></pre></div>\n<p>$ git log</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">commit</span><span class=\"w\"> </span><span class=\"n\">eed770a434957369c6262aa3fb1d6426419016d4</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">grafted</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">HEAD</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">tag</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">24</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span><span class=\"o\">)</span>\n<span class=\"n\">Author</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Kim</span><span class=\"w\"> </span><span class=\"n\">Morrison</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"mi\">477956</span><span class=\"bp\">+</span><span class=\"n\">kim</span><span class=\"bp\">-</span><span class=\"n\">em</span><span class=\"bp\">@</span><span class=\"n\">users</span><span class=\"bp\">.</span><span class=\"n\">noreply</span><span class=\"bp\">.</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">&gt;</span>\n<span class=\"n\">Date</span><span class=\"o\">:</span><span class=\"w\">   </span><span class=\"n\">Mon</span><span class=\"w\"> </span><span class=\"n\">Sep</span><span class=\"w\"> </span><span class=\"mi\">15</span><span class=\"w\"> </span><span class=\"mi\">12</span><span class=\"o\">:</span><span class=\"mi\">54</span><span class=\"o\">:</span><span class=\"mi\">32</span><span class=\"w\"> </span><span class=\"mi\">2025</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"mi\">0000</span>\n\n<span class=\"w\">    </span><span class=\"n\">chore</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">bump</span><span class=\"w\"> </span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">24</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">#</span><span class=\"mi\">29671</span><span class=\"o\">)</span>\n\n\n\n<span class=\"w\">    </span><span class=\"n\">Co</span><span class=\"bp\">-</span><span class=\"n\">authored</span><span class=\"bp\">-</span><span class=\"k\">by</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">mathlib4</span><span class=\"bp\">-</span><span class=\"n\">bot</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"n\">github</span><span class=\"bp\">-</span><span class=\"n\">mathlib4</span><span class=\"bp\">-</span><span class=\"n\">bot</span><span class=\"bp\">@</span><span class=\"n\">leanprover</span><span class=\"bp\">.</span><span class=\"n\">zulipchat</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">Co</span><span class=\"bp\">-</span><span class=\"n\">authored</span><span class=\"bp\">-</span><span class=\"k\">by</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">bot</span><span class=\"bp\">-</span><span class=\"n\">assistant</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"mi\">97194829</span><span class=\"bp\">+</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">bot</span><span class=\"bp\">-</span><span class=\"n\">assistant</span><span class=\"bp\">@</span><span class=\"n\">users</span><span class=\"bp\">.</span><span class=\"n\">noreply</span><span class=\"bp\">.</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">&gt;</span>\n</code></pre></div>",
        "id": 542008921,
        "sender_full_name": "Kitsune Kiriha",
        "timestamp": 1759144596
    },
    {
        "content": "<p>I did <code>git checkout v4.24.0-rc1</code> and tried <code>lake exe cache get</code> but unfortunately I already had all the oleans from that commit locally, so it succeeded but with this message:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>Current branch: HEAD\nUsing cache (Azure) from origin: kbuzzard/mathlib4\nNo files to download\nNo files to download\nDecompressing 7199 file(s)\nUnpacked in 38273 ms\nCompleted successfully!\n</code></pre></div>",
        "id": 542017654,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1759147043
    },
    {
        "content": "<p>It seems you already have cached locally, could you clean the <code>.lake</code> folder and try again?<br>\n(Another: Your source seems to be <code>kbuzzard/mathlib4</code>, while mine is <code>leanprover-community/mathlib4</code>)<br>\n(Both <code>Azure</code> and <code>Cloudflare</code> fails)</p>",
        "id": 542019145,
        "sender_full_name": "Kitsune Kiriha",
        "timestamp": 1759147388
    },
    {
        "content": "<p>Solved. It seems one of the dependency of mathlib4 have the wrong revision. I manually fixed through the <code>lake-manifest.json</code> file.</p>",
        "id": 542027411,
        "sender_full_name": "Kitsune Kiriha",
        "timestamp": 1759149585
    }
]