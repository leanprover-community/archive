[
    {
        "content": "<p>As an exercise to get familiar with working with presented groups/free groups in Lean I defined the isomorphism between the dihedral group(s) and their group presentation. PresentedGroups are defined using two quotients (one in the definition of PresentedGroup, and one inherited from FreeGroup), and this can lead to some senseless duplication, for example in my definition I mostly use <code>a</code>/<code>b</code> to reference the two generators in the presented group, <code>fa</code>/<code>fb</code> for the free group representation, and in <code>myOp</code> I need to define a function on the letters of the FreeGroup. Example snippets pulled from the code:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">DihedralGroup</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">freeGroup</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"bp\">⊕</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"o\">)</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">fa</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">freeGroup</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"o\">())</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">fb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">freeGroup</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"o\">())</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">freeGroup</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">fa</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">fb</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fa</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">fb</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">dihedralPresentation</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">PresentedGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">dihedralPresentation</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"o\">())</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">dihedralPresentation</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"o\">())</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">myOp</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"bp\">⊕</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">DihedralGroup</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">sr</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">sr</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>\n<p>This seems pretty unnecessary since in all 3 cases I am referring to the same generator. Is there an obvious pattern that I'm missing, or should there perhaps be coercions here? Going from α → (FreeGroup α) and α → (@PresentedGroup α β) is easy to implement but I could see it being error prone if you're working with multiple presentations with the same number/types of generators.</p>",
        "id": 507880568,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1742852074
    },
    {
        "content": "<p>I think your choice of <code>Unit ⊕ Unit</code> is making it a lot worse than it could be. Why not</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">gens</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">B</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">gens</span>\n</code></pre></div>\n<p>and then use <code>A</code> instead of <code>.inl ()</code>?</p>",
        "id": 507956077,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1742891345
    },
    {
        "content": "<p>Then you can’t really avoid the fact there are three types here, the generating type, the free group and your group. Note there is also <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PresentedGroup.mk#doc\">docs#PresentedGroup.mk</a> which is a group morphism from the free group to the presented group. So you could have <code>abbrev a {n : ℕ} : dihedralPresentation n := .mk (rels n) fa</code> (and <code>rels n</code> can probably be implicit here since the expected type is known).</p>",
        "id": 507956787,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1742891558
    },
    {
        "content": "<p>Thanks Patrick, the use of the inductive is definitely better than the Sum. It also makes the rest of the conversions less painful to use since sprinkling <code>.of a</code> is also not as ugly as what I had before.</p>",
        "id": 508091243,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1742925074
    }
]