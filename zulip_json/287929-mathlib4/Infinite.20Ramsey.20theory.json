[
    {
        "content": "<p>I was looking into trying to prove some facts about well quasi ordering (namely that if a relation is Well Quasi Ordered then a set based version of the relation is Well quasi ordered) and I noticed I had to assume that my relation was a preorder even though I believe this is not necessary for the proof.</p>\n<p>I wanted to use the fact that every sequence within a WQO (well quasi order) has  a monotone subsequence, which I also think does not need a preorder property, </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">WellQuasiOrdered</span><span class=\"bp\">.</span><span class=\"n\">exists_monotone_subseq</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsPreorder</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WellQuasiOrdered</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">↪</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span>\n</code></pre></div>\n<p>if I remove the assumption then theorem ends up breaking because it relies on </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- This is the infinitary Erdős–Szekeres theorem, and an important lemma in the usual proof of</span>\n<span class=\"sd\">Bolzano-Weierstrass for `ℝ`. -/</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">exists_increasing_or_nonincreasing_subseq</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsTrans</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">↪</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>Which directly uses <code>IsTrans α r</code> in the proof.</p>\n<p>This shouldn't be necessary as you should be able to colour the edges between each pair of Numbers based on whether the relation is true for them, and then use the Infinite Ramsey theorem to get an infinite clique of increasing or non-increasing numbers.</p>\n<p>Now it looks like someone has used Lean (possibly not lean 4) to prove a version of this here <a href=\"https://github.com/b-mehta/combinatorics/blob/extras/src/inf_ramsey.lean\">https://github.com/b-mehta/combinatorics/blob/extras/src/inf_ramsey.lean</a> , so I'm wondering if there's a reason this has been left out of MathLib itself?\\</p>\n<p>Now it looks like there was a discussion of this earlier this year here <a class=\"stream-topic\" data-stream-id=\"113489\" href=\"/#narrow/channel/113489-new-members/topic/Is.20the.20infinitary.20Ramsey.20theorem.20in.20mathlib.3F/with/531926879\">#new members &gt; Is the infinitary Ramsey theorem in mathlib?</a>  but it doesn't look like any of the referenced PRs have been merged</p>",
        "id": 565344096,
        "sender_full_name": "Leo Shine",
        "timestamp": 1766643314
    },
    {
        "content": "<p>For uses in my automata theory project, I proved Ramsey's theorem for infinite graphs in Lean4:<br>\n<a href=\"https://github.com/ctchou/AutomataTheory/blob/main/AutomataTheory/Mathlib/InfGraphRamsey.lean\">https://github.com/ctchou/AutomataTheory/blob/main/AutomataTheory/Mathlib/InfGraphRamsey.lean</a><br>\nwhich should suffice for your purpose.</p>",
        "id": 565345074,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1766644394
    },
    {
        "content": "<p>I have an updated version of that code for Lean 4, which I can post later in the week, which gives a short proof of the infinite Ramsey theorem for hypergraphs. But I agree that the theorem you quote should be true without transitivity. The linked Lean 3 code wasn't ported or updated because it uses a weird recursion principle which mathlib at the time didn't want, and with the benefit of (several) years of hindsight, is not the right way of proving it.</p>",
        "id": 565375063,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1766673586
    },
    {
        "content": "<p>Ive been working on incorporating ramsey theory in my own transform theory work - ill keep an eye on this. Thanks for the heads up</p>",
        "id": 565377486,
        "sender_full_name": "Zachary Mullaghy",
        "timestamp": 1766675918
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span>  Just wondering if your code will be available soon.  Thanks in advance!</p>",
        "id": 568507228,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1768591221
    }
]