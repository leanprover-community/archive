[
    {
        "content": "<p>TIL that we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=toNat#doc\">docs#toNat</a> that is</p>\n<ul>\n<li>in the root namespace</li>\n<li>abuses defeq between <code>Set X</code> and <code>X -&gt; Prop</code> in all lemmas.</li>\n</ul>\n<p>What should I do about it?</p>",
        "id": 575925933,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1772078229
    },
    {
        "content": "<p>The defeq fix is easy, right?</p>",
        "id": 575927019,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1772078865
    },
    {
        "content": "<p>I can fix it to operate on predicates, or I can change all the lemmas to use <code>fun x =&gt; x \\in s</code></p>",
        "id": 575927092,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1772078906
    },
    {
        "content": "<p>I don't know which one makes more sense in this context.</p>",
        "id": 575927122,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1772078920
    },
    {
        "content": "<p>Are there defeq abuses in the callers, or just the implementation?</p>",
        "id": 575928453,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1772079769
    },
    {
        "content": "<p>To me</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">toNat</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">Encodable</span><span class=\"bp\">.</span><span class=\"n\">decode</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">|&gt;.</span><span class=\"n\">getD</span><span class=\"w\"> </span><span class=\"n\">default</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⁻¹'</span><span class=\"w\"> </span><span class=\"n\">s</span>\n</code></pre></div>\n<p>is the obvious correction</p>",
        "id": 575928640,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1772079888
    },
    {
        "content": "<p>The next several lemmas abuse defeq because they feed sets to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ManyOneReducible#doc\">docs#ManyOneReducible</a></p>",
        "id": 575931050,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1772081090
    },
    {
        "content": "<p>The file is authored by <span class=\"user-mention\" data-user-id=\"110187\">@Minchao Wu</span> and <span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> and IMHO lacks a useful module docstring.</p>",
        "id": 575931280,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1772081212
    },
    {
        "content": "<p>BTW, all the docs talk about sets. Should I redefine <code>ManyOneReducible</code> to take sets instead?</p>",
        "id": 575931329,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1772081240
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> Should I change <code>toNat</code> and <code>ManyOneReducible</code> to deal with predicates or sets? Also, what would be good less generic name for <code>toNat</code> or a good namespace for it?</p>",
        "id": 576402112,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1772266178
    }
]