[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">by_contra!</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Hovering over <code>by_contra!</code> just shows \"this : ¬?m.45\".<br>\nReplacing by <code>by_contra</code> and hovering gives the more extensive</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>¬?m.45\n\nA hole (or placeholder term), which stands for an unknown term that is expected to be inferred based on context. For example, in @id _ Nat.zero, the _ must be the type of Nat.zero, which is Nat.\n\nThe way this works is that holes create fresh metavariables. The elaborator is allowed to assign terms to metavariables while it is checking definitional equalities. This is often known as unification.\n\nNormally, all holes must be solved for. However, there are a few contexts where this is not necessary:\n\n    In match patterns, holes are catch-all patterns.\n    In some tactics, such as refine' and apply, unsolved-for placeholders become new goals.\n</code></pre></div>\n<p>but which is also not really helpful when you want to know details on <code>by_contra</code>...</p>\n<p>(I was trying to see if I can get <code>by_contra!</code> to use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=not_and_or#doc\">docs#not_and_or</a> in place of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=not_and#doc\">docs#not_and</a> in a situation where the goal is a conjunction.)</p>",
        "id": 512334655,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1744726941
    },
    {
        "content": "<p>If you name the variable, you get the doc-string as a hover, which is probably what you were looking for.</p>",
        "id": 512336470,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1744727401
    },
    {
        "content": "<p>I do not know why you do not get the doc-string when the identifier is missing, though.</p>",
        "id": 512336611,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1744727427
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/blob/e7b8f4e11d911bd1ac37d7735441c1ae2ad41004/Mathlib/Tactic/ByContra.lean#L44\">This line</a> is to blame</p>",
        "id": 512338117,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744727783
    },
    {
        "content": "<p>But if you name the variable, you still get a garbage hover if you hover over that variable</p>",
        "id": 512338595,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744727896
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Hover.20on.20by_contra!.20is.20not.20helpful/near/512338117\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/blob/e7b8f4e11d911bd1ac37d7735441c1ae2ad41004/Mathlib/Tactic/ByContra.lean#L44\">This line</a> is to blame</p>\n</blockquote>\n<p>Why is this?</p>",
        "id": 512339514,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1744728128
    },
    {
        "content": "<p>It says \"use <code>this</code> as the name, but pretend it came from <code>by_contra!</code>\"</p>",
        "id": 512339601,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744728153
    },
    {
        "content": "<p>And so if you hover over <code>by_contra!</code>, you see what you'd see if you hovered over <code>this</code> in <code>by_contra! this</code></p>",
        "id": 512339706,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744728181
    },
    {
        "content": "<p>Which, separately, is also broken</p>",
        "id": 512339754,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744728193
    },
    {
        "content": "<p>Ah, I see is the <code>mkIdentFrom</code> that messes the hover?</p>",
        "id": 512340649,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1744728385
    },
    {
        "content": "<p>Indeed, replacing that line with</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">by_contra!</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"o\">(</span><span class=\"n\">mkIdent</span><span class=\"w\"> </span><span class=\"ss\">`this</span><span class=\"o\">):</span><span class=\"n\">ident</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"o\">[:</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">ty</span><span class=\"o\">]</span><span class=\"bp\">?</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>makes the hover over <code>by_contra!</code> show the <code>by_contra!</code> doc-string.</p>",
        "id": 512341688,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1744728603
    },
    {
        "content": "<p>Not providing a hover for the <code>this</code> binder is consistent with <code>suffices</code></p>",
        "id": 512347284,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744729837
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/24087\">#24087</a></p>",
        "id": 512351031,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1744730684
    }
]