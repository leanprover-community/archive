[
    {
        "content": "<p>The built-in search functionality of the mathlib docs has become unusably slow. Yesterday I could search, e.g. \"Polynomial\", and it would give results instantly. Now it takes more than 1 minute to return any results.</p>\n<p>Are others having this issue too?</p>",
        "id": 517996897,
        "sender_full_name": "Pontus Sundqvist",
        "timestamp": 1747209941
    },
    {
        "content": "<p>Could you be more specific about which search functionality you are referring to?</p>",
        "id": 517997198,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1747210019
    },
    {
        "content": "<p>The top right search bar in the web docs, which brings you to <a href=\"https://leanprover-community.github.io/mathlib4_docs/search.html?q=polynomial\">this page</a>.</p>",
        "id": 517997556,
        "sender_full_name": "Pontus Sundqvist",
        "timestamp": 1747210117
    },
    {
        "content": "<p>Testing with it more, it's just the first search that is slow. Subsequent searches on the same page are faster, so if I just keep one tab open for searching in the toolbar and open results in new tabs then I can work around the problem.</p>",
        "id": 518001082,
        "sender_full_name": "Pontus Sundqvist",
        "timestamp": 1747211150
    },
    {
        "content": "<p>Ah, this is known - the first search needs to download a lot of data</p>",
        "id": 518001446,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1747211236
    },
    {
        "content": "<p>But it used to be cached, right? I used to be able to 1. open mathlib, 2. search for a theorem, 3. click on the theorem, 4. search for a new theorem, 5. click on that theorem, etc.</p>\n<p>But now I can't do that, because when I click on a theorem, it has to redownload the data.</p>",
        "id": 518002261,
        "sender_full_name": "Pontus Sundqvist",
        "timestamp": 1747211445
    },
    {
        "content": "<p>Maybe GitHub no longer supports our hack of caching with a fake bmp extension</p>",
        "id": 518009292,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1747213351
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/AItkyDWx8xxqJrpcfmprlwR-/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/AItkyDWx8xxqJrpcfmprlwR-/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"820x171\" src=\"/user_uploads/thumbnail/3121/AItkyDWx8xxqJrpcfmprlwR-/image.png/840x560.webp\"></a></div><p>it pretty clear loads the data from cache for me.</p>\n<p><span class=\"user-mention\" data-user-id=\"247136\">@Pontus Sundqvist</span> can you provide more details? What's your OS? What's your Browser (Version)? What is the exact click flow you are using? How do you know its the declaration data that is not being cached?</p>",
        "id": 518015188,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1747214906
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Online.20search.20broken/near/518009292\">said</a>:</p>\n<blockquote>\n<p>Maybe GitHub no longer supports our hack of caching with a fake bmp extension</p>\n</blockquote>\n<p>Also the hack is to use compression with a fake bmp extension, not caching isn't it?</p>",
        "id": 518016036,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1747215134
    },
    {
        "content": "<p>I can no longer reproduce the problem, it seems to have magically fixed itself <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 518023777,
        "sender_full_name": "Pontus Sundqvist",
        "timestamp": 1747217245
    },
    {
        "content": "<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"247136\">Pontus Sundqvist</span> can you provide more details? What's your OS? What's your Browser (Version)? What is the exact click flow you are using? How do you know its the declaration data that is not being cached?</p>\n</blockquote>\n<p>For future reference in case this problem appears again, my OS is Ubuntu 20.04, browser is Firefox 135.0. My click flow was to open the mathlib web docs, click the upper right search box, write \"Polynomial\" and notice that no suggestions appeared, click on \"Search\", get navigated to empty search results, wait for 1 minute, then results appeared.</p>\n<p>I don't actually know if it was because of the cache, because I didn't open the browser developer tools.</p>",
        "id": 518026021,
        "sender_full_name": "Pontus Sundqvist",
        "timestamp": 1747217945
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"247136\">Pontus Sundqvist</span> has marked this topic as resolved.</p>",
        "id": 518082731,
        "sender_full_name": "Notification Bot",
        "timestamp": 1747233037
    },
    {
        "content": "<p>Seems the network problem. That data, when compressed by gzip, is a few megabytes.</p>",
        "id": 518254415,
        "sender_full_name": "Jz Pan",
        "timestamp": 1747302144
    }
]