[
    {
        "content": "<p>Hello!<br>\nI am a master student in mathematics and plan to write my master thesis about the implementation of a topic of my choice in lean4. I was wondering whether it would be feasible to implement a theorem like base change in lean4 (the sheaves in topology version). I have been reading up on sheaves in lean4 and i feel like it would be managable but i am also not an expert in lean4 so i was wondering if someone has an idea whether this is doable or not. Thank you in advance!</p>",
        "id": 545942594,
        "sender_full_name": "Tammo Brinner",
        "timestamp": 1760957836
    },
    {
        "content": "<p>what is a \"theorem like base change\"?</p>",
        "id": 545942753,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760957875
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Implementation.20of.20base.20change/near/545942753\">schrieb</a>:</p>\n<blockquote>\n<p>what is a \"theorem like base change\"?</p>\n</blockquote>\n<p>Are you asking the precise contents of this theorem?</p>",
        "id": 545942898,
        "sender_full_name": "Tammo Brinner",
        "timestamp": 1760957914
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Implementation.20of.20base.20change/near/545942753\">said</a>:</p>\n<blockquote>\n<p>what is a \"theorem like base change\"?</p>\n</blockquote>\n<p>it could also be read as \"a theorem such as base change\"</p>",
        "id": 545943165,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1760957999
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"880680\">Tammo Brinner</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Implementation.20of.20base.20change/near/545942898\">said</a>:</p>\n<blockquote>\n<p>Are you asking the precise contents of this theorem?</p>\n</blockquote>\n<p>yes</p>",
        "id": 545943966,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760958235
    },
    {
        "content": "<p>If you are thinking about stuff like <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo>∗</mo></msup><mo stretchy=\"false\">(</mo><msup><mi>R</mi><mi>p</mi></msup><msub><mi>g</mi><mo>∗</mo></msub><mi mathvariant=\"script\">F</mi><mo stretchy=\"false\">)</mo><mo>≅</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">f^\\ast(R^p g_\\ast \\mathcal{F}) \\cong ...</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1757em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathcal\" style=\"margin-right:0.09931em;\">F</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≅</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.1056em;\"></span><span class=\"mord\">...</span></span></span></span> then this a probably a little bit difficult to formalize (we don't have spectral sequence, and this is really not something adapted for a first project), but I may be wrong.</p>",
        "id": 545945224,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1760958567
    },
    {
        "content": "<p>okay let me give you the precise reference. The theorem is stated as follows: </p>\n<p><a href=\"/user_uploads/3121/VMtatziqwP4LkC2wck2UEGio/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/VMtatziqwP4LkC2wck2UEGio/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"620x233\" src=\"/user_uploads/thumbnail/3121/VMtatziqwP4LkC2wck2UEGio/image.png/840x560.webp\"></a></div><p>There is also a derived version of this as Riccardo pointed out, but i just want to prove this version. I asked my professor for persmission to share his script for more context. You do not need spectral sequences for this.</p>",
        "id": 545949683,
        "sender_full_name": "Tammo Brinner",
        "timestamp": 1760959824
    },
    {
        "content": "<p>Do we have lower shrink?</p>",
        "id": 545950491,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1760960046
    },
    {
        "content": "<p>I dont think that has been implemented, but that should not be hard.</p>",
        "id": 545965586,
        "sender_full_name": "Tammo Brinner",
        "timestamp": 1760963916
    },
    {
        "content": "<p>Here is the Script:<br>\n<a href=\"/user_uploads/3121/g_JYoOu15GFKIeFHerNMfCoF/SiT_holstein.pdf\">SiT_holstein.pdf</a></p>",
        "id": 545966504,
        "sender_full_name": "Tammo Brinner",
        "timestamp": 1760964129
    },
    {
        "content": "<p>Lol that theorem is impossible to formalize as it is stated, because the word \"canonical\" has no formal meaning. As a warm-up exercise, would you like to state what you mean by that word? Note that the answer needs to cover every single naturality statement used in the rest of the paper after that point.</p>",
        "id": 545969720,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1760964882
    },
    {
        "content": "<p>In Lean the result you quote would not be a theorem, because actually the theorem (\"there exists natural isomorphisms between these two functors\") is far too weak for applications; it does not tell you what the map is, only that <em>some</em> construction gives a nat iso. In Lean, this \"theorem\" would be a definition consisting of the actual map (and ideally maps in both directions) plus proof that it (they) are natural isomorphism(s), and then after that there would be more theorems (doing the heavy lifting of \"canonical\" by saying exactly which diagrams you are claiming will commute, rather than just leaving this as an (unreasonable) exercise for the reader).</p>\n<p>Feel free to tell this to your professor ;-)</p>",
        "id": 545970902,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1760965152
    },
    {
        "content": "<p>PS I think this would be a great project; in fact it might even teach your professor what their theorem says.</p>",
        "id": 545971581,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1760965299
    },
    {
        "content": "<p>Hahaha okay, i mean you are right with this. Normally, mathematicians write canonical when they mean that the map is constructed in the proof and consists of  a \"natural choice\" of a natural transformation between these functor. If you look at the script, there is a map constructed (as per usual without checking the naturality condition). So the statement in Lean would be something like this: Given a pullback square of locally compact spaces, these compositions of functors are naturally isomorphic.<br>\nOf course now one would need to construct this natural transformation and show every square involved actually commutes.</p>",
        "id": 545980797,
        "sender_full_name": "Tammo Brinner",
        "timestamp": 1760967390
    },
    {
        "content": "<p>I'll say it again: I think this is a great project. My super-pedantic comments above are just basically a joke; I think there's some very interesting content here and my impression is that we have most if not all of the prerequisites, and those that we don't have also look very much like they're in scope for mathlib.</p>",
        "id": 545995960,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1760970724
    },
    {
        "content": "<p>OTOH spectral sequences are probably an MSc project in themselves!</p>",
        "id": 545996161,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1760970767
    },
    {
        "content": "<p>I think <span class=\"user-mention\" data-user-id=\"459699\">@Joël Riou</span> has done spectral sequence. They are somewhere in his glacier of PRs, making their way towards mathlib.</p>",
        "id": 546161124,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1761031928
    },
    {
        "content": "<p>Thank you for your estimation Kevin!</p>",
        "id": 546169585,
        "sender_full_name": "Tammo Brinner",
        "timestamp": 1761034685
    },
    {
        "content": "<p>If any other Lean expert has thoughts on this, please share them:)</p>",
        "id": 546169872,
        "sender_full_name": "Tammo Brinner",
        "timestamp": 1761034784
    },
    {
        "content": "<p>The basic formalism of sheaves allows to define a base change morphism for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msup><mi>f</mi><mo>⋆</mo></msup><mo separator=\"true\">,</mo><msub><mi>f</mi><mo>⋆</mo></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(f^\\star,f_\\star)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">⋆</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1757em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">⋆</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> (<span class=\"user-mention\" data-user-id=\"648495\">@Christian Merten</span> and I have some draft code in the abstract context of pseudofunctors to the bicategory of adjunctions <a href=\"https://github.com/leanprover-community/mathlib4/blob/22d7d35bb6e82d0f454021f64fd2f7bc61db0738/Mathlib/CategoryTheory/Bicategory/Adjunction/BaseChange.lean#L233\">https://github.com/leanprover-community/mathlib4/blob/22d7d35bb6e82d0f454021f64fd2f7bc61db0738/Mathlib/CategoryTheory/Bicategory/Adjunction/BaseChange.lean#L233</a> ; see also for example <a href=\"https://github.com/leanprover-community/mathlib4/pull/30350\">#30350</a> which shows that defining such pseudofunctors is very much within reach).<br>\nThen, as in this context <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mo stretchy=\"false\">!</mo></msub><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">f_!F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mclose mtight\">!</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span> is defined as a subobject of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mo>⋆</mo></msub><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">f_\\star F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1757em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">⋆</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span>, the right way to formalize the statement would be to have a definition of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mo stretchy=\"false\">!</mo></msub></mrow><annotation encoding=\"application/x-tex\">f_!</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mclose mtight\">!</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, a definition of the base change isomorphism for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msup><mi>f</mi><mo>⋆</mo></msup><mo separator=\"true\">,</mo><msub><mi>f</mi><mo stretchy=\"false\">!</mo></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(f^\\star,f_!)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">⋆</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mclose mtight\">!</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> and a commutative diagram saying that it is induced by the base change morphism for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msup><mi>f</mi><mo>⋆</mo></msup><mo separator=\"true\">,</mo><msub><mi>f</mi><mo>⋆</mo></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(f^\\star,f_\\star)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">⋆</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1757em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">⋆</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> (taking into account that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo>⋆</mo></msup></mrow><annotation encoding=\"application/x-tex\">f^\\star</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">⋆</span></span></span></span></span></span></span></span></span></span></span> is exact).<br>\nThe homological extensions of this theory are certainly possible, but a lot of prerequisites are missing in mathlib (even though part of it, like spectral sequences, are in the branch <a href=\"https://github.com/joelriou/mathlib4/tree/jriou_localization\">https://github.com/joelriou/mathlib4/tree/jriou_localization</a>).</p>",
        "id": 546227479,
        "sender_full_name": "Joël Riou",
        "timestamp": 1761051014
    },
    {
        "content": "<p>Thank you for the references, i will take a look at them soon. One thing i do not understand is why everyone thinks that spectral sequences are needed here. As far as i can tell one only needs a lot of point set topology and a fair bit of category theory and sheaf theory.</p>",
        "id": 546237739,
        "sender_full_name": "Tammo Brinner",
        "timestamp": 1761053429
    },
    {
        "content": "<p>It is only for the derived version where you need to talk about the derived functor of a composition of  functors. Then you need spectral sequences or the analogous derived category formulation of the same fact.</p>",
        "id": 546238402,
        "sender_full_name": "Christian Merten",
        "timestamp": 1761053584
    },
    {
        "content": "<p>Okay that makes sense. Maybe i will get to that.</p>",
        "id": 546251357,
        "sender_full_name": "Tammo Brinner",
        "timestamp": 1761056714
    }
]