[
    {
        "content": "<p>I was reviewing a PR and I found the statement of a lemma very hard to read; it said this</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">d_eq_zero_of_f_eq_d_apply</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">x₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">forget₂</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">Ab</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">X₂</span><span class=\"bp\">.</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">forget₂</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">Ab</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">X₁</span><span class=\"bp\">.</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">)))</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hx₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">forget₂</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">Ab</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">x₁</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">forget₂</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">Ab</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">X₂</span><span class=\"bp\">.</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">x₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">((</span><span class=\"n\">forget₂</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">Ab</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">X₁</span><span class=\"bp\">.</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">x₁</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>(and there are some variables as well). This is the kind of theorem which in my opinion would be much easier to understand with a docstring. But that docstring should contain this picture:</p>\n<p><a href=\"/user_uploads/3121/FXpyzwovdMW85dkL9fwN2MCY/Screenshot-from-2025-06-29-21-42-05.png\">Screenshot from 2025-06-29 21-42-05.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/FXpyzwovdMW85dkL9fwN2MCY/Screenshot-from-2025-06-29-21-42-05.png\" title=\"Screenshot from 2025-06-29 21-42-05.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"694x594\" src=\"/user_uploads/thumbnail/3121/FXpyzwovdMW85dkL9fwN2MCY/Screenshot-from-2025-06-29-21-42-05.png/840x560.webp\"></a></div><p>and then just say \"if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>∈</mo><msub><mi>X</mi><mrow><mn>2</mn><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">x_2\\in X_{2,i}</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>∈</mo><msub><mi>X</mi><mrow><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">x_1\\in X_{1,j}</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> with <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mi>d</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x_1)=d(x_2)</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> then <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">d(x_1)=0</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>\". If I could see that picture and that one line of mathematics then not only can I immediately see what the lemma says, I can even construct a proof immediately (hint: to prove <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">d(x_1)=0</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> it suffices to prove <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>d</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">f(d(x_1))=0</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>). </p>\n<p>I have seen two attempts to put diagrams like this into docstrings. The first is via ASCII art. This gets garbled in the API docs. The second is via LaTeX. But the LaTeX for that commutative diagram is the incomprehensible</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">\\</span><span class=\"o\">[</span><span class=\"bp\">\\</span><span class=\"n\">begin</span><span class=\"o\">{</span><span class=\"n\">tikzcd</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">\\\\</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">cdots</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X_</span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"n\">i</span><span class=\"o\">}}</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X_</span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"n\">j</span><span class=\"o\">}}</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X_</span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"n\">k</span><span class=\"o\">}}</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"bp\">\\</span><span class=\"n\">cdots</span><span class=\"w\"> </span><span class=\"bp\">\\\\</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">cdots</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X_</span><span class=\"o\">{</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"n\">i</span><span class=\"o\">}}</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X_</span><span class=\"o\">{</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"n\">j</span><span class=\"o\">}}</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X_</span><span class=\"o\">{</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"n\">k</span><span class=\"o\">}}</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"bp\">\\</span><span class=\"n\">cdots</span><span class=\"w\"> </span><span class=\"bp\">\\\\</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">cdots</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X_</span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"n\">i</span><span class=\"o\">}}</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X_</span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"n\">j</span><span class=\"o\">}}</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X_</span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"n\">k</span><span class=\"o\">}}</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"bp\">\\</span><span class=\"n\">cdots</span><span class=\"w\"> </span><span class=\"bp\">\\\\</span>\n<span class=\"w\">    </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&amp;</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">1</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">2</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">1</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">2</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">1</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">2</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">2</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">2</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">2</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">2</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">2</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">3</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"s2\">\"d\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">2</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">2</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"s2\">\"f\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">2</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">3</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">2</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">2</span><span class=\"bp\">-</span><span class=\"mi\">5</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">2</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">3</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">3</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">3</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"s2\">\"d\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">3</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">3</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">3</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">4</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">3</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">3</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">3</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">4</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">3</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">3</span><span class=\"bp\">-</span><span class=\"mi\">5</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">3</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">4</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">4</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">4</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">4</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">4</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">4</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">5</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">4</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">4</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">4</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">5</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">4</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">4</span><span class=\"bp\">-</span><span class=\"mi\">5</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"n\">arrow</span><span class=\"o\">[</span><span class=\"k\">from</span><span class=\"bp\">=</span><span class=\"mi\">4</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"bp\">=</span><span class=\"mi\">5</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"o\">]</span>\n<span class=\"bp\">\\</span><span class=\"kn\">end</span><span class=\"o\">{</span><span class=\"n\">tikzcd</span><span class=\"o\">}</span><span class=\"bp\">\\</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>so that will be unreadable in code.</p>\n<p>What can we do here? As the abstract algebra part of mathlib grows it will get increasingly unreadable if we don't have a good solution to commutative diagrams in docstrings. Or is there already a good solution and I'm just unaware of it?</p>",
        "id": 526294192,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751229820
    },
    {
        "content": "<p>If the ascii art gets garbled, add some backticks</p>",
        "id": 526294834,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1751230618
    },
    {
        "content": "<p>ASCII art still leaves something to be desired -- the horizontal arrows are being rendered as comments and thus come out in green.</p>\n<p><a href=\"/user_uploads/3121/cafkW6C0rL5Yhk8mYYBDOBCv/Screenshot-from-2025-06-29-22-11-48.png\">Screenshot from 2025-06-29 22-11-48.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/cafkW6C0rL5Yhk8mYYBDOBCv/Screenshot-from-2025-06-29-22-11-48.png\" title=\"Screenshot from 2025-06-29 22-11-48.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"449x261\" src=\"/user_uploads/thumbnail/3121/cafkW6C0rL5Yhk8mYYBDOBCv/Screenshot-from-2025-06-29-22-11-48.png/840x560.webp\"></a></div><p>I still feel like ASCII art is a bit of a crappy hack. It is 2025 for goodness' sake! Credit to Gemini for doing most of the work BTW (directly from the LaTeX)</p>",
        "id": 526295552,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751231559
    },
    {
        "content": "<p>My confusion increases. Right now in <code>Mathlib.Algebra.Homology.ShortComplex.SnakeLemma</code> in the module docstring we have</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"w\"> </span><span class=\"n\">The</span><span class=\"w\"> </span><span class=\"n\">snake</span><span class=\"w\"> </span><span class=\"kn\">lemma</span>\n\n<span class=\"n\">The</span><span class=\"w\"> </span><span class=\"n\">snake</span><span class=\"w\"> </span><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">standard</span><span class=\"w\"> </span><span class=\"n\">tool</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">homological</span><span class=\"w\"> </span><span class=\"n\">algebra</span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">The</span><span class=\"w\"> </span><span class=\"n\">basic</span><span class=\"w\"> </span><span class=\"n\">situation</span>\n<span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">when</span><span class=\"w\"> </span><span class=\"n\">we</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">diagram</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"n\">follows</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">abelian</span><span class=\"w\"> </span><span class=\"n\">category</span><span class=\"w\"> </span><span class=\"ss\">`C</span><span class=\"bp\">`</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">rows</span><span class=\"o\">:</span>\n\n<span class=\"w\">    </span><span class=\"n\">L₁</span><span class=\"bp\">.</span><span class=\"n\">X₁</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">L₁</span><span class=\"bp\">.</span><span class=\"n\">X₂</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">L₁</span><span class=\"bp\">.</span><span class=\"n\">X₃</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\">       </span><span class=\"bp\">|</span><span class=\"w\">       </span><span class=\"bp\">|</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"n\">v₁₂</span><span class=\"bp\">.</span><span class=\"n\">τ₁</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">v₁₂</span><span class=\"bp\">.</span><span class=\"n\">τ₂</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">v₁₂</span><span class=\"bp\">.</span><span class=\"n\">τ₃</span>\n<span class=\"w\">      </span><span class=\"n\">v</span><span class=\"w\">       </span><span class=\"n\">v</span><span class=\"w\">       </span><span class=\"n\">v</span>\n<span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">L₂</span><span class=\"bp\">.</span><span class=\"n\">X₁</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">L₂</span><span class=\"bp\">.</span><span class=\"n\">X₂</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">L₂</span><span class=\"bp\">.</span><span class=\"n\">X₃</span>\n\n<span class=\"n\">We</span><span class=\"w\"> </span><span class=\"n\">shall</span><span class=\"w\"> </span><span class=\"n\">think</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">diagram</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">datum</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">morphism</span><span class=\"w\"> </span><span class=\"ss\">`v₁₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">L₁</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">L₂</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span>\n</code></pre></div>\n<p>which is being rendered in the API docs as</p>\n<p><a href=\"/user_uploads/3121/dNtB0Up1T8m13bHdMn21Sa10/Screenshot-from-2025-06-29-22-35-22.png\">Screenshot from 2025-06-29 22-35-22.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/dNtB0Up1T8m13bHdMn21Sa10/Screenshot-from-2025-06-29-22-35-22.png\" title=\"Screenshot from 2025-06-29 22-35-22.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"738x345\" src=\"/user_uploads/thumbnail/3121/dNtB0Up1T8m13bHdMn21Sa10/Screenshot-from-2025-06-29-22-35-22.png/840x560.webp\"></a></div><p>What made the API docs stop rendering the ASCII art midway?</p>",
        "id": 526296594,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751232968
    },
    {
        "content": "<p>Oh! Is this the old \"four spaces at the start means you're writing code\" thing?! Ha! Our API docs use that convention?? Is the fix \"put three backticks around the ASCII art\"?</p>",
        "id": 526296620,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751233013
    },
    {
        "content": "<p>Yes, and agree that ascii art is a hack. One could imagine some kind of domain-specific language that looks like ascii art in the source but renders like tikz, but that would be Work(TM)</p>",
        "id": 526296854,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1751233425
    },
    {
        "content": "<p>If you go down the path of doing ascii art I prefer to use unicode <a href=\"https://en.wikipedia.org/wiki/Box-drawing_characters\">box-drawing characters</a> and unicode <a href=\"https://www.unicode.org/charts/nameslist/n_2190.html\">arrows</a> instead of <code>-</code> and <code>v</code>. They look a lot better IMO and are less likely to be misinterpreted as comments</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">    </span><span class=\"n\">L₁</span><span class=\"bp\">.</span><span class=\"n\">X₁</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">L₁</span><span class=\"bp\">.</span><span class=\"n\">X₂</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">L₁</span><span class=\"bp\">.</span><span class=\"n\">X₃</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">      </span><span class=\"bp\">│</span><span class=\"w\">       </span><span class=\"bp\">│</span><span class=\"w\">       </span><span class=\"bp\">│</span>\n<span class=\"w\">      </span><span class=\"bp\">│</span><span class=\"n\">v₁₂</span><span class=\"bp\">.</span><span class=\"n\">τ₁</span><span class=\"w\"> </span><span class=\"bp\">│</span><span class=\"n\">v₁₂</span><span class=\"bp\">.</span><span class=\"n\">τ₂</span><span class=\"w\"> </span><span class=\"bp\">│</span><span class=\"n\">v₁₂</span><span class=\"bp\">.</span><span class=\"n\">τ₃</span>\n<span class=\"w\">      </span><span class=\"bp\">↓</span><span class=\"w\">       </span><span class=\"bp\">↓</span><span class=\"w\">       </span><span class=\"bp\">↓</span>\n<span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">L₂</span><span class=\"bp\">.</span><span class=\"n\">X₁</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">L₂</span><span class=\"bp\">.</span><span class=\"n\">X₂</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">L₂</span><span class=\"bp\">.</span><span class=\"n\">X₃</span>\n</code></pre></div>\n<p><a href=\"/user_uploads/3121/1EbLSTBfDQAkpulqWFMnTuqg/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/1EbLSTBfDQAkpulqWFMnTuqg/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1160x406\" src=\"/user_uploads/thumbnail/3121/1EbLSTBfDQAkpulqWFMnTuqg/image.png/840x560.webp\"></a></div>",
        "id": 526297306,
        "sender_full_name": "Li Xuanji",
        "timestamp": 1751234132
    },
    {
        "content": "<p>Unicode art rather than ascii art, then :)</p>",
        "id": 526297377,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1751234231
    },
    {
        "content": "<p>And here's what the original docstring might look like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">       </span><span class=\"mi\">0</span><span class=\"w\">        </span><span class=\"mi\">0</span><span class=\"w\">         </span><span class=\"mi\">0</span>\n<span class=\"w\">       </span><span class=\"bp\">│</span><span class=\"w\">        </span><span class=\"bp\">│</span><span class=\"w\">         </span><span class=\"bp\">│</span>\n<span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"bp\">───▶</span><span class=\"w\"> </span><span class=\"n\">X₁</span><span class=\"o\">,</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">──▶</span><span class=\"w\"> </span><span class=\"n\">X₁</span><span class=\"o\">,</span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">─</span><span class=\"n\">d</span><span class=\"bp\">─▶</span><span class=\"w\"> </span><span class=\"n\">X₁</span><span class=\"o\">,</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">──▶</span><span class=\"w\"> </span><span class=\"bp\">…</span>\n<span class=\"w\">       </span><span class=\"bp\">│</span><span class=\"w\">        </span><span class=\"bp\">↓</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\">       </span><span class=\"bp\">│</span>\n<span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"bp\">───▶</span><span class=\"w\"> </span><span class=\"n\">X₂</span><span class=\"o\">,</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">──</span><span class=\"n\">d</span><span class=\"bp\">─▶</span><span class=\"w\"> </span><span class=\"n\">X₂</span><span class=\"o\">,</span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">─▶</span><span class=\"w\"> </span><span class=\"n\">X₂</span><span class=\"o\">,</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">──▶</span><span class=\"w\"> </span><span class=\"bp\">…</span>\n<span class=\"w\">        </span><span class=\"bp\">│</span><span class=\"w\">       </span><span class=\"bp\">│</span><span class=\"w\">         </span><span class=\"bp\">│</span>\n<span class=\"bp\">…</span><span class=\"w\"> </span><span class=\"bp\">───▶</span><span class=\"w\"> </span><span class=\"n\">X₃</span><span class=\"o\">,</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">───▶</span><span class=\"w\"> </span><span class=\"n\">X₃</span><span class=\"o\">,</span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">──▶</span><span class=\"w\"> </span><span class=\"n\">X₃</span><span class=\"o\">,</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">──▶</span><span class=\"w\"> </span><span class=\"bp\">…</span>\n<span class=\"w\">        </span><span class=\"bp\">↓</span><span class=\"w\">       </span><span class=\"bp\">↓</span><span class=\"w\">         </span><span class=\"bp\">↓</span>\n<span class=\"w\">        </span><span class=\"mi\">0</span><span class=\"w\">       </span><span class=\"mi\">0</span><span class=\"w\">         </span><span class=\"mi\">0</span>\n</code></pre></div>\n<p><a href=\"/user_uploads/3121/FqNy6BTPLYGXACHkxEEGF_19/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/FqNy6BTPLYGXACHkxEEGF_19/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"580x460\" src=\"/user_uploads/thumbnail/3121/FqNy6BTPLYGXACHkxEEGF_19/image.png/840x560.webp\"></a></div>",
        "id": 526298060,
        "sender_full_name": "Li Xuanji",
        "timestamp": 1751235056
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"308587\">@Li Xuanji</span> I prefer your art solution to mine (now available <a href=\"https://github.com/leanprover-community/mathlib4/pull/25872#discussion_r2173928327\">here</a> ), not least because it doesn't seem to be rendering as comments. However your f is all squashed. Can I made the vertical arrows longer somehow? What are the tricks here? Can I get a better \"long down arrow\" than \"a bunch of U+2502's and then a \\d at the end\"? Should I just be cutting and pasting from the Wikipedia page? Seeing that Commodore PET keyboard and all the discussions about early Sinclair and Acorn machines reminds me of my youth :-)</p>",
        "id": 526298542,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751235700
    },
    {
        "content": "<p>There don't seem to be many good down arrow choices, I found <code>˅</code> (U+02C5 Modifier Letter Down Arrowhead), <code>↓</code> (U+2193 Downwards Arrow), and <code>ꜜ</code> (U+A71C Modifier Letter Raised Down Arrow).</p>",
        "id": 526298724,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1751235963
    },
    {
        "content": "<p>If ASCII art is the state of the art and getting something much better is a nontrivial project then I'd be interested in experimenting with Unicode art</p>",
        "id": 526298797,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751236054
    },
    {
        "content": "<p>We had something similar recently in PNT+ where we wanted to draw a diagram (in a blueprint, not docstring). <br>\n<a href=\"/user_uploads/3121/OCzGVUmIV-_0E9FDiovZe8ON/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/OCzGVUmIV-_0E9FDiovZe8ON/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"677x771\" src=\"/user_uploads/thumbnail/3121/OCzGVUmIV-_0E9FDiovZe8ON/image.png/840x560.webp\"></a></div>",
        "id": 526298805,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1751236060
    },
    {
        "content": "<p>I should think that Patrick would hit the roof if he saw that -- surely the point of blueprint is exactly that you can unleash Latex! But here (in theorem docstrings) we can't :-(</p>",
        "id": 526298875,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751236150
    },
    {
        "content": "<p>To get this image, I scribbled something by hand on a piece of paper, took a picture with my phone, and uploaded it to Claude, asking it to make me this image in a way that it would render in LaTeX.  <br>\n<a href=\"/user_uploads/3121/LYfeQ72svhevDF2i5FIcWnYq/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/LYfeQ72svhevDF2i5FIcWnYq/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"242x527\" src=\"/user_uploads/thumbnail/3121/LYfeQ72svhevDF2i5FIcWnYq/image.png/840x560.webp\"></a></div>",
        "id": 526298878,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1751236156
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/287929-mathlib4/topic/readable.20commutative.20diagrams.20in.20docstrings/near/526298875\">said</a>:</p>\n<blockquote>\n<p>I should think that Patrick would hit the roof if he saw that -- surely the point of blueprint is exactly that you can unleash Latex! But here (in theorem docstrings) we can't :-(</p>\n</blockquote>\n<p>Ha! :) I hope he doesn't see this thread then... How would I make it in \"true\" LaTeX, using TikZ or something? I wasn't sure if Blueprint was set up for that...</p>",
        "id": 526298920,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1751236213
    },
    {
        "content": "<p>I think I would have just made a nice picture and then included a screenshot :-) Looking at it again maybe latex isn't the right tool for that diagram!</p>",
        "id": 526298923,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751236215
    },
    {
        "content": "<p>I think blueprint is fine with tikzcd</p>",
        "id": 526298952,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751236246
    },
    {
        "content": "<p>Ok, so maybe I'll experiment with making a better picture... :)</p>",
        "id": 526298979,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1751236277
    },
    {
        "content": "<p>I know it's a bit 2023 but you could try <a href=\"https://q.uiver.app/\">quiver</a> and then exporting to latex and dumping it straight in blueprint</p>",
        "id": 526299019,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751236316
    },
    {
        "content": "<p>In fact, I think Claude first gave me a tikz diagram, and I was scared it wouldn't work with Blueprint, so I told it to give me text instead; so it suggested \\begin{verbatim}, which blueprint accepted... So I didn't push it further...</p>",
        "id": 526299079,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1751236436
    },
    {
        "content": "<p>The commutative square just after <a href=\"https://imperialcollegelondon.github.io/FLT/blueprint/Adele_miniproject.html#IsDedekindDomain.HeightOneSpectrum.adicCompletionComap_isModuleTopology\">Theorem 8.7</a> in the FLT blueprint is <a href=\"https://github.com/ImperialCollegeLondon/FLT/blob/0b6117d7de9274ea368274b41492f28c6c9b360d/blueprint/src/chapter/AdeleMiniproject.tex#L225-L231\">done with tikzcd</a></p>",
        "id": 526299101,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751236473
    },
    {
        "content": "<p>Ok so I'd better change it then <span aria-label=\"joy\" class=\"emoji emoji-1f602\" role=\"img\" title=\"joy\">:joy:</span> before Patrick sees...</p>",
        "id": 526299135,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1751236523
    },
    {
        "content": "<p>Are you familiar with <a href=\"https://q.uiver.app/\">https://q.uiver.app/</a> ? We could embed links to diagrams as a general habit. Then duplicate with ASCII art. At some point, hopefully Verso could help us display these from within the editor and the ASCII art would become obsolete.</p>",
        "id": 526300082,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1751238054
    },
    {
        "content": "<p>Oh I see Kevin just mentioned quiver <span aria-label=\"face palm\" class=\"emoji emoji-1f926\" role=\"img\" title=\"face palm\">:face_palm:</span></p>",
        "id": 526300106,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1751238079
    },
    {
        "content": "<p>I did use it to quickly knock up the picture of the commutative diagram but it hadn't occurred to me to actually link to it!</p>",
        "id": 526330694,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751266552
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/stream/287929-mathlib4/topic/readable.20commutative.20diagrams.20in.20docstrings/near/526300082\">said</a>:</p>\n<blockquote>\n<p>Are you familiar with <a href=\"https://q.uiver.app/\">https://q.uiver.app/</a> ? We could embed links to diagrams as a general habit. Then duplicate with ASCII art. At some point, hopefully Verso could help us display these from within the editor and the ASCII art would become obsolete.</p>\n</blockquote>\n<p>And then, whenever q.uiver is down or the service is sunset, we have useless URLs in our docs?</p>",
        "id": 526336948,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1751269100
    },
    {
        "content": "<p>I mean, yes, but you could say the same thing about most of the internet (I find it frustrating that links posted on MathOverflow 15 years ago can sometimes not work...)</p>",
        "id": 526337229,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751269217
    },
    {
        "content": "<p>Plus the extra traffic on their server from every time someone visits lean docs.</p>",
        "id": 526337491,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1751269308
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/287929-mathlib4/topic/readable.20commutative.20diagrams.20in.20docstrings/near/526337229\">said</a>:</p>\n<blockquote>\n<p>I mean, yes, but you could say the same thing about most of the internet (I find it frustrating that links posted on MathOverflow 15 years ago can sometimes not work...)</p>\n</blockquote>\n<p>Well, this applies in theory to any external url in docs (or code) that becomes an implicit dependency on an external service. E.g what happened to polarity which is now useless.</p>\n<p>Some URLs are \"less likely to go away\" than others, and I wouldn't bet that quiver will be a very long term service (or just that they wouldn't make any breaking change).<br>\nI'd really prefer a self-contained solution rather than one creating a dependency.</p>",
        "id": 526338133,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1751269551
    },
    {
        "content": "<p>(though, in the case of q.uiver, they whole thing is open source, not sure about the exact licence, so maybe if we decide to do it we should host a quiver mirror to be responsible for the traffic generated as well as making sure we don't loose every picture in our docs the day q.uiver dies)</p>",
        "id": 526338571,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1751269685
    },
    {
        "content": "<p>I mean, worst case is we have the ascii art and a broken link, best case we have ascii art and a working link</p>",
        "id": 526338900,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1751269801
    },
    {
        "content": "<p>This compared to the current situation of ascii art and no link</p>",
        "id": 526338953,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1751269814
    },
    {
        "content": "<p>I though the suggestion was to only link (and eventually hope verso would generate pictures from links). If a ASCII/unicode art remains it's definitely better.</p>",
        "id": 526339220,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1751269898
    },
    {
        "content": "<p>Oh, that's not how I read the suggestion. If we don't keep the art, we might as well dump the unreadable tikz code into the docstring, because then you've lost the ability to see the diagram within your code editor anyway</p>",
        "id": 526340244,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1751270225
    },
    {
        "content": "<p>So I think that at the very least we are saying \"keep the ASCII art for now\" (or perhaps \"switch to unicode art but keep some kind of art\") and perhaps other things are a bonus.</p>",
        "id": 526341533,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751270637
    },
    {
        "content": "<p>A solution in the Haskell ecosystem is to use the Haskell diagrams package then you have full control over your diagrams included in your documentation. I haven't looked but I don't think there is a Lean equivalent. Here's one example of a diagram I created to show how a PDE numerical scheme works as part of the documentation: <a href=\"https://hackage.haskell.org/package/diagrams-contrib-1.4.6/docs/Diagrams-TwoD-Grid.html\">https://hackage.haskell.org/package/diagrams-contrib-1.4.6/docs/Diagrams-TwoD-Grid.html</a>.</p>\n<p>And here's a stand alone diagram showing an atlas for the circle (not using stereographic projection - who even needs that ;-)) which I could embed in my documentation (if I so wished).</p>\n<p><a href=\"/user_uploads/3121/4K2WAZKCyEbrWikUIOV5GOgv/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/4K2WAZKCyEbrWikUIOV5GOgv/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"300x300\" src=\"/user_uploads/thumbnail/3121/4K2WAZKCyEbrWikUIOV5GOgv/image.png/840x560.webp\"></a></div>",
        "id": 526346056,
        "sender_full_name": "Dominic Steinitz",
        "timestamp": 1751272101
    },
    {
        "content": "<p>Okay, but what does it look like in the source?</p>",
        "id": 526346730,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1751272314
    },
    {
        "content": "<p>The blueprint should indeed have no problem with tikzcd or even tikz in general. Otherwise it’s a bug that needs a urgent fix.</p>",
        "id": 526346962,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1751272396
    },
    {
        "content": "<p>And I agree that <code>q.uiver.app</code> is great. Note that it’s not more dangerous that LaTeX in term of maintenance. Hosting you own instance is <em>trivial</em>. You just clone the repo and serve it locally. I always have it on my laptop in case I need to work on a train or plane without internet.</p>",
        "id": 526347280,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1751272508
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/channel/287929-mathlib4/topic/readable.20commutative.20diagrams.20in.20docstrings/near/526346730\">said</a>:</p>\n<blockquote>\n<p>Okay, but what does it look like in the source?</p>\n</blockquote>\n<p>The <a href=\"https://hackage.haskell.org/package/diagrams-contrib-1.4.6/docs/Diagrams-TwoD-Grid.html\">link</a> gives the source for this image</p>\n<p><a href=\"/user_uploads/3121/yd1HD3lcfhkyxAfUcMY_51Is/image.png\">image.png</a>.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/yd1HD3lcfhkyxAfUcMY_51Is/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"200x300\" src=\"/user_uploads/thumbnail/3121/yd1HD3lcfhkyxAfUcMY_51Is/image.png/840x560.webp\"></a></div><p>Do you mean for the image of the charts for the circle? I wrote that over 10 years ago. I am sure I have the source somewhere but undoubtedly it will no longer compile :-(</p>",
        "id": 526347664,
        "sender_full_name": "Dominic Steinitz",
        "timestamp": 1751272624
    },
    {
        "content": "<p>By trivial I mean </p>\n<ul>\n<li><code>git clone https://github.com/varkor/quiver.git</code></li>\n<li><code>cd quiver</code></li>\n<li><code>make</code></li>\n</ul>\n<p>And then whenever you want to play locally you go to your quiver folder and type <code>make serve</code> which says something like <code>Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...</code> and then go to your webrowser and open the given url <code>http://0.0.0.0:8000/</code></p>",
        "id": 526347981,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1751272726
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/channel/287929-mathlib4/topic/readable.20commutative.20diagrams.20in.20docstrings/near/526346730\">said</a>:</p>\n<blockquote>\n<p>Okay, but what does it look like in the source?</p>\n</blockquote>\n<div class=\"codehilite\" data-code-language=\"Haskell\"><pre><span></span><code><span class=\"nf\">circleAtlas</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">rans</span><span class=\"w\"> </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">doms</span><span class=\"w\"> </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">arr1s</span><span class=\"w\"> </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">arr2s</span><span class=\"w\"> </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">arr3s</span><span class=\"w\"> </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">arr4s</span>\n<span class=\"w\">  </span><span class=\"kr\">where</span>\n<span class=\"w\">    </span><span class=\"n\">rans</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\">    </span><span class=\"n\">l1</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lc</span><span class=\"w\"> </span><span class=\"n\">green</span><span class=\"w\">  </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lw</span><span class=\"w\"> </span><span class=\"mf\">0.05</span>\n<span class=\"w\">           </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">l2</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lc</span><span class=\"w\"> </span><span class=\"n\">yellow</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lw</span><span class=\"w\"> </span><span class=\"mf\">0.05</span>\n<span class=\"w\">           </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">l3</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lc</span><span class=\"w\"> </span><span class=\"n\">blue</span><span class=\"w\">   </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lw</span><span class=\"w\"> </span><span class=\"mf\">0.05</span>\n<span class=\"w\">           </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">l4</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lc</span><span class=\"w\"> </span><span class=\"n\">red</span><span class=\"w\">    </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lw</span><span class=\"w\"> </span><span class=\"mf\">0.05</span>\n\n\n<span class=\"w\">    </span><span class=\"n\">doms</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\">        </span><span class=\"n\">arc'</span><span class=\"w\"> </span><span class=\"mf\">1.1</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"n\">a2</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lc</span><span class=\"w\"> </span><span class=\"n\">green</span><span class=\"w\">  </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lw</span><span class=\"w\"> </span><span class=\"mf\">0.05</span>\n<span class=\"w\">           </span><span class=\"p\">`</span><span class=\"n\">atop</span><span class=\"p\">`</span><span class=\"w\"> </span><span class=\"n\">arc'</span><span class=\"w\"> </span><span class=\"mf\">1.2</span><span class=\"w\"> </span><span class=\"n\">a3</span><span class=\"w\"> </span><span class=\"n\">a4</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lc</span><span class=\"w\"> </span><span class=\"n\">yellow</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lw</span><span class=\"w\"> </span><span class=\"mf\">0.05</span>\n<span class=\"w\">           </span><span class=\"p\">`</span><span class=\"n\">atop</span><span class=\"p\">`</span><span class=\"w\"> </span><span class=\"n\">arc'</span><span class=\"w\"> </span><span class=\"mf\">1.1</span><span class=\"w\"> </span><span class=\"n\">a5</span><span class=\"w\"> </span><span class=\"n\">a6</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lc</span><span class=\"w\"> </span><span class=\"n\">blue</span><span class=\"w\">   </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lw</span><span class=\"w\"> </span><span class=\"mf\">0.05</span>\n<span class=\"w\">           </span><span class=\"p\">`</span><span class=\"n\">atop</span><span class=\"p\">`</span><span class=\"w\"> </span><span class=\"n\">arc'</span><span class=\"w\"> </span><span class=\"mf\">1.2</span><span class=\"w\"> </span><span class=\"n\">a7</span><span class=\"w\"> </span><span class=\"n\">a8</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lc</span><span class=\"w\"> </span><span class=\"n\">red</span><span class=\"w\">    </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lw</span><span class=\"w\"> </span><span class=\"mf\">0.05</span>\n\n\n<span class=\"w\">    </span><span class=\"n\">arr1</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">arrowAt'</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"w\"> </span><span class=\"n\">shaftStyle</span><span class=\"w\"> </span><span class=\"o\">%~</span><span class=\"w\"> </span><span class=\"n\">lw</span><span class=\"w\"> </span><span class=\"mf\">0.05</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">dashing</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"mf\">0.05</span><span class=\"p\">,</span><span class=\"mf\">0.05</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"mf\">0.0</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lc</span><span class=\"w\"> </span><span class=\"n\">green</span><span class=\"p\">)</span>\n<span class=\"w\">                    </span><span class=\"p\">(</span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">1.3</span><span class=\"p\">))</span>\n<span class=\"w\">                    </span><span class=\"p\">((</span><span class=\"n\">pt1</span><span class=\"w\"> </span><span class=\"o\">.+^</span><span class=\"w\"> </span><span class=\"mf\">0.5</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">pt2</span><span class=\"w\"> </span><span class=\"o\">.-.</span><span class=\"w\"> </span><span class=\"n\">pt1</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">.-.</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">1.3</span><span class=\"p\">)))</span>\n<span class=\"w\">    </span><span class=\"n\">arr1s</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\">    </span><span class=\"n\">arr1</span>\n<span class=\"w\">            </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">arr1</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">translate</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">r2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">0.0</span><span class=\"p\">)))</span>\n<span class=\"w\">            </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">arr1</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">translate</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">r2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">0.5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">0.0</span><span class=\"p\">)))</span>\n\n\n<span class=\"w\">    </span><span class=\"n\">arr2</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">arrowAt'</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"w\"> </span><span class=\"n\">shaftStyle</span><span class=\"w\"> </span><span class=\"o\">%~</span><span class=\"w\"> </span><span class=\"n\">lw</span><span class=\"w\"> </span><span class=\"mf\">0.05</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">dashing</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"mf\">0.05</span><span class=\"p\">,</span><span class=\"mf\">0.05</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"mf\">0.0</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lc</span><span class=\"w\"> </span><span class=\"n\">yellow</span><span class=\"p\">)</span>\n<span class=\"w\">                    </span><span class=\"p\">(</span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">1.4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">0.0</span><span class=\"p\">))</span>\n<span class=\"w\">                    </span><span class=\"p\">((</span><span class=\"n\">pt3</span><span class=\"w\"> </span><span class=\"o\">.+^</span><span class=\"w\"> </span><span class=\"mf\">0.5</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">pt4</span><span class=\"w\"> </span><span class=\"o\">.-.</span><span class=\"w\"> </span><span class=\"n\">pt3</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">.-.</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">1.4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">0.0</span><span class=\"p\">)))</span>\n\n\n<span class=\"w\">    </span><span class=\"n\">arr2s</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\">    </span><span class=\"n\">arr2</span>\n<span class=\"w\">            </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">arr2</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">translate</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">r2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">0.5</span><span class=\"p\">)))</span>\n<span class=\"w\">            </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">arr2</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">translate</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">r2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mf\">0.5</span><span class=\"p\">)))</span>\n\n\n<span class=\"w\">    </span><span class=\"n\">arr3</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">arrowAt'</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"w\"> </span><span class=\"n\">shaftStyle</span><span class=\"w\"> </span><span class=\"o\">%~</span><span class=\"w\"> </span><span class=\"n\">lw</span><span class=\"w\"> </span><span class=\"mf\">0.05</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">dashing</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"mf\">0.05</span><span class=\"p\">,</span><span class=\"mf\">0.05</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"mf\">0.0</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lc</span><span class=\"w\"> </span><span class=\"n\">blue</span><span class=\"p\">)</span>\n<span class=\"w\">                    </span><span class=\"p\">(</span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mf\">1.3</span><span class=\"p\">))</span>\n<span class=\"w\">                    </span><span class=\"p\">((</span><span class=\"n\">pt5</span><span class=\"w\"> </span><span class=\"o\">.+^</span><span class=\"w\"> </span><span class=\"mf\">0.5</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">pt6</span><span class=\"w\"> </span><span class=\"o\">.-.</span><span class=\"w\"> </span><span class=\"n\">pt5</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">.-.</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mf\">1.3</span><span class=\"p\">)))</span>\n\n\n<span class=\"w\">    </span><span class=\"n\">arr3s</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\">    </span><span class=\"n\">arr3</span>\n<span class=\"w\">            </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">arr3</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">translate</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">r2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">0.0</span><span class=\"p\">)))</span>\n<span class=\"w\">            </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">arr3</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">translate</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">r2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">0.5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">0.0</span><span class=\"p\">)))</span>\n\n\n<span class=\"w\">    </span><span class=\"n\">arr4</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">arrowAt'</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"w\"> </span><span class=\"n\">shaftStyle</span><span class=\"w\"> </span><span class=\"o\">%~</span><span class=\"w\"> </span><span class=\"n\">lw</span><span class=\"w\"> </span><span class=\"mf\">0.05</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">dashing</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"mf\">0.05</span><span class=\"p\">,</span><span class=\"mf\">0.05</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"mf\">0.0</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">lc</span><span class=\"w\"> </span><span class=\"n\">red</span><span class=\"p\">)</span>\n<span class=\"w\">                    </span><span class=\"p\">(</span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">1.4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">0.0</span><span class=\"p\">))</span>\n<span class=\"w\">                    </span><span class=\"p\">((</span><span class=\"n\">pt7</span><span class=\"w\"> </span><span class=\"o\">.+^</span><span class=\"w\"> </span><span class=\"mf\">0.5</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">pt8</span><span class=\"w\"> </span><span class=\"o\">.-.</span><span class=\"w\"> </span><span class=\"n\">pt7</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">.-.</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">1.4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">0.0</span><span class=\"p\">)))</span>\n\n\n<span class=\"w\">    </span><span class=\"n\">arr4s</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\">    </span><span class=\"n\">arr4</span>\n<span class=\"w\">            </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">arr4</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">translate</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">r2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">0.5</span><span class=\"p\">)))</span>\n<span class=\"w\">            </span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">arr4</span><span class=\"w\"> </span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"n\">translate</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">r2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mf\">0.5</span><span class=\"p\">)))</span>\n\n\n<span class=\"w\">    </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\">  </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">tau</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"mi\">12</span><span class=\"w\"> </span><span class=\"ow\">::</span><span class=\"w\"> </span><span class=\"kt\">Rad</span>\n<span class=\"w\">    </span><span class=\"n\">a2</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\">  </span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">tau</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"mi\">12</span><span class=\"w\"> </span><span class=\"ow\">::</span><span class=\"w\"> </span><span class=\"kt\">Rad</span>\n<span class=\"w\">    </span><span class=\"n\">a3</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\">  </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">tau</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"mi\">12</span><span class=\"w\"> </span><span class=\"ow\">::</span><span class=\"w\"> </span><span class=\"kt\">Rad</span>\n<span class=\"w\">    </span><span class=\"n\">a4</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\">  </span><span class=\"mi\">8</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">tau</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"mi\">12</span><span class=\"w\"> </span><span class=\"ow\">::</span><span class=\"w\"> </span><span class=\"kt\">Rad</span>\n<span class=\"w\">    </span><span class=\"n\">a5</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\">  </span><span class=\"mi\">7</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">tau</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"mi\">12</span><span class=\"w\"> </span><span class=\"ow\">::</span><span class=\"w\"> </span><span class=\"kt\">Rad</span>\n<span class=\"w\">    </span><span class=\"n\">a6</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"mi\">11</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">tau</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"mi\">12</span><span class=\"w\"> </span><span class=\"ow\">::</span><span class=\"w\"> </span><span class=\"kt\">Rad</span>\n<span class=\"w\">    </span><span class=\"n\">a7</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">tau</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"mi\">12</span><span class=\"w\"> </span><span class=\"ow\">::</span><span class=\"w\"> </span><span class=\"kt\">Rad</span>\n<span class=\"w\">    </span><span class=\"n\">a8</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\">  </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">tau</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"mi\">12</span><span class=\"w\"> </span><span class=\"ow\">::</span><span class=\"w\"> </span><span class=\"kt\">Rad</span>\n\n\n<span class=\"w\">    </span><span class=\"n\">l1</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">pt1</span><span class=\"w\"> </span><span class=\"o\">~~</span><span class=\"w\"> </span><span class=\"n\">pt2</span>\n<span class=\"w\">    </span><span class=\"n\">pt1</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">1.1</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">cos</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">fromRational</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">toRational</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"mf\">2.0</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">pt2</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">1.1</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">cos</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">fromRational</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">toRational</span><span class=\"w\"> </span><span class=\"n\">a2</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"mf\">2.0</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">l2</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">pt3</span><span class=\"w\"> </span><span class=\"o\">~~</span><span class=\"w\"> </span><span class=\"n\">pt4</span>\n<span class=\"w\">    </span><span class=\"n\">pt3</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">2.0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">1.2</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">sin</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">fromRational</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">toRational</span><span class=\"w\"> </span><span class=\"n\">a3</span><span class=\"p\">))</span>\n<span class=\"w\">    </span><span class=\"n\">pt4</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">2.0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">1.2</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">sin</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">fromRational</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">toRational</span><span class=\"w\"> </span><span class=\"n\">a4</span><span class=\"p\">))</span>\n<span class=\"w\">    </span><span class=\"n\">l3</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">pt5</span><span class=\"w\"> </span><span class=\"o\">~~</span><span class=\"w\"> </span><span class=\"n\">pt6</span>\n<span class=\"w\">    </span><span class=\"n\">pt5</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">1.1</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">cos</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">fromRational</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">toRational</span><span class=\"w\"> </span><span class=\"n\">a5</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mf\">2.0</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">pt6</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">1.1</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">cos</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">fromRational</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">toRational</span><span class=\"w\"> </span><span class=\"n\">a6</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mf\">2.0</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">l4</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">pt7</span><span class=\"w\"> </span><span class=\"o\">~~</span><span class=\"w\"> </span><span class=\"n\">pt8</span>\n<span class=\"w\">    </span><span class=\"n\">pt7</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">2.0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">1.2</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">sin</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">fromRational</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">toRational</span><span class=\"w\"> </span><span class=\"n\">a7</span><span class=\"p\">))</span>\n<span class=\"w\">    </span><span class=\"n\">pt8</span><span class=\"w\"> </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"n\">p2</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">2.0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">1.2</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">sin</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">fromRational</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">toRational</span><span class=\"w\"> </span><span class=\"n\">a8</span><span class=\"p\">))</span>\n</code></pre></div>",
        "id": 526351943,
        "sender_full_name": "Dominic Steinitz",
        "timestamp": 1751273876
    },
    {
        "content": "<p>Just for clarity: I was suggesting writing your diagrams in Lean (declaratively) rather than using e.g. tikz. Maybe that is a bridge too far.</p>",
        "id": 526352241,
        "sender_full_name": "Dominic Steinitz",
        "timestamp": 1751273987
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span> <a href=\"#narrow/channel/287929-mathlib4/topic/readable.20commutative.20diagrams.20in.20docstrings/near/526347280\">said</a>:</p>\n<blockquote>\n<p>Note that it’s not more dangerous that LaTeX in term of maintenance. Hosting you own instance is <em>trivial</em></p>\n</blockquote>\n<p>Exactly, I also host my own. We could have it running on the community website easily.</p>",
        "id": 526432157,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1751298297
    },
    {
        "content": "<p>Probably, we could even have a widget to parse the quiver stuff and display (or even edit) the result in the infoview, although it's beyond my expertise to implement. It would be a <code>#quiver</code> command that you could then call on the code.</p>",
        "id": 526433008,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1751298548
    },
    {
        "content": "<p>Some thoughts:</p>\n<ul>\n<li>Infoview hovers already support MathJax, and MathJax supports AMScd. It's unfortunately a very limited package, but e.g. hovering on <code>test</code> below <em>in the infoview</em> shows a diagram</li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"sd\">/--</span>\n<span class=\"sd\">$\\begin{CD}</span>\n<span class=\"sd\">  A @&gt;a&gt;&gt; B\\\\</span>\n<span class=\"sd\">  @V b V V= @VV c V\\\\</span>\n<span class=\"sd\">  C @&gt;&gt;d&gt; D</span>\n<span class=\"sd\">\\end{CD}$</span>\n<span class=\"sd\">-/</span>\n<span class=\"kd\">theorem</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">⟨⟩</span>\n\n<span class=\"k\">#check</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"n\">test</span>\n</code></pre></div>\n<ul>\n<li>Adding any visualization to hovers <em>not in the infoview</em> is an open problem (<a href=\"https://github.com/leanprover-community/vscode-lean4/pull/541\">vscode-lean4#541</a>).</li>\n<li>A PR adding support for other kinds of visualization, e.g. quiver diagram descriptions, to infoview hovers would probably be quite welcome. The community would have to come to some agreement on which format to use; quiver can parse tikz-cd code, so that might be a good solution.</li>\n</ul>",
        "id": 531216647,
        "sender_full_name": "𝚠𝚘𝚓𝚌𝚒𝚎𝚌𝚑 𝚗𝚊𝚠𝚛𝚘𝚌𝚔𝚒",
        "timestamp": 1753652027
    },
    {
        "content": "<p>Does the above also render in doc-gen?</p>",
        "id": 531218080,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1753652624
    },
    {
        "content": "<p>Note that none of this works in neovim.</p>",
        "id": 531292520,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1753687009
    }
]