[
    {
        "content": "<p>On a PR where there are very few files built (<a href=\"https://github.com/leanprover-community/mathlib4/pull/25816\">#25816</a>), <code>lake exe cache get</code> is essentially unusable for me (1 second per failed file, 5550 files). My connection should in theory be good, so I wonder if there's something I could make to mitigate the issue?</p>",
        "id": 523788423,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749744040
    },
    {
        "content": "<p>Hmm, I'm seeing about 100/s, even on my not-that-great-hooray-internet-in-Australia connection.</p>",
        "id": 523800065,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1749748536
    },
    {
        "content": "<p><span aria-label=\"fingers crossed\" class=\"emoji emoji-1f91e\" role=\"img\" title=\"fingers crossed\">:fingers_crossed:</span> it's was a transient issue?</p>",
        "id": 523800125,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1749748560
    },
    {
        "content": "<p>I think the point is that it's long for <em>failed</em> files. I sometimes experience that as well, I get \".../6xxx\" attempted, while 0 downloaded, and that takes a very long while.</p>",
        "id": 523801541,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749749099
    },
    {
        "content": "<p>Nope, it's still 1 (failed) file per second now. It's really because of the failed files: on a green branch, it will happily download the 6000 files in 5 seconds or so, but when there are failures it is super slow.</p>",
        "id": 523810319,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749752567
    },
    {
        "content": "<p>I wonder how complicated it would be to try to download files in order, starting from files at the root, and if a file fails then not even trying to download the files that depend on it. The order must already be available somewhere (because when computing the hash of a file you need the hashes of all of its parents), I guess, but I don't know how much engineering this would require (and if it wouldn't slow down things in the typical case where there are almost no failures)</p>",
        "id": 523811140,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749752906
    },
    {
        "content": "<p>I got some similar behavior just now.</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>Mathlib<span class=\"w\"> </span>repository:<span class=\"w\"> </span>mattrobball/mathlib4\nAttempting<span class=\"w\"> </span>to<span class=\"w\"> </span>download<span class=\"w\"> </span><span class=\"m\">6808</span><span class=\"w\"> </span>file<span class=\"o\">(</span>s<span class=\"o\">)</span><span class=\"w\"> </span>from<span class=\"w\"> </span>leanprover-community/mathlib4<span class=\"w\"> </span>cache\nDownloaded:<span class=\"w\"> </span><span class=\"m\">6808</span><span class=\"w\"> </span>file<span class=\"o\">(</span>s<span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span>attempted<span class=\"w\"> </span><span class=\"m\">6808</span>/6808<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">100</span>%<span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">100</span>%<span class=\"w\"> </span>success<span class=\"o\">)</span>\nAttempting<span class=\"w\"> </span>to<span class=\"w\"> </span>download<span class=\"w\"> </span><span class=\"m\">6808</span><span class=\"w\"> </span>file<span class=\"o\">(</span>s<span class=\"o\">)</span><span class=\"w\"> </span>from<span class=\"w\"> </span>mattrobball/mathlib4<span class=\"w\"> </span>cache\nDownloaded:<span class=\"w\"> </span><span class=\"m\">0</span><span class=\"w\"> </span>file<span class=\"o\">(</span>s<span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span>attempted<span class=\"w\"> </span><span class=\"m\">1498</span>/6808<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">22</span>%<span class=\"o\">]</span>\n</code></pre></div>",
        "id": 523811590,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1749753065
    },
    {
        "content": "<p>In your case, it's just silly behavior: it has already found all the files in the first cache source, so why even look in the second?</p>",
        "id": 523812460,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749753380
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span>, does your speedy download happen on a good branch, or on <a href=\"https://github.com/leanprover-community/mathlib4/pull/25816\">#25816</a>? I.e., is</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\"> </span><span class=\"n\">gh</span><span class=\"w\"> </span><span class=\"n\">pr</span><span class=\"w\"> </span><span class=\"n\">checkout</span><span class=\"w\"> </span><span class=\"mi\">25816</span>\n<span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get</span>\n</code></pre></div>\n<p>fast for you? It's still dramatically slow for me.</p>",
        "id": 523812726,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749753495
    },
    {
        "content": "<p>I just did that:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">[</span><span class=\"n\">jireh</span><span class=\"bp\">@</span><span class=\"n\">boston</span><span class=\"w\"> </span><span class=\"n\">mathlib4</span><span class=\"o\">]</span><span class=\"bp\">$</span><span class=\"w\">  </span><span class=\"n\">gh</span><span class=\"w\"> </span><span class=\"n\">pr</span><span class=\"w\"> </span><span class=\"n\">checkout</span><span class=\"w\"> </span><span class=\"mi\">25816</span>\n<span class=\"n\">remote</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Enumerating</span><span class=\"w\"> </span><span class=\"n\">objects</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">done</span><span class=\"bp\">.</span>\n<span class=\"n\">remote</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Counting</span><span class=\"w\"> </span><span class=\"n\">objects</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">100</span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">5</span><span class=\"bp\">/</span><span class=\"mi\">5</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">done</span><span class=\"bp\">.</span>\n<span class=\"n\">remote</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Compressing</span><span class=\"w\"> </span><span class=\"n\">objects</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">100</span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">3</span><span class=\"bp\">/</span><span class=\"mi\">3</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">done</span><span class=\"bp\">.</span>\n<span class=\"n\">remote</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">delta</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">reused</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">delta</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">pack</span><span class=\"bp\">-</span><span class=\"n\">reused</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n<span class=\"n\">Unpacking</span><span class=\"w\"> </span><span class=\"n\">objects</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">100</span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">6</span><span class=\"bp\">/</span><span class=\"mi\">6</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"mf\">10.80</span><span class=\"w\"> </span><span class=\"n\">KiB</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">526.00</span><span class=\"w\"> </span><span class=\"n\">KiB</span><span class=\"bp\">/</span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">done</span><span class=\"bp\">.</span>\n<span class=\"n\">From</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span>\n<span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">new</span><span class=\"w\"> </span><span class=\"n\">ref</span><span class=\"o\">]</span><span class=\"w\">                 </span><span class=\"n\">refs</span><span class=\"bp\">/</span><span class=\"n\">pull</span><span class=\"bp\">/</span><span class=\"mi\">25816</span><span class=\"bp\">/</span><span class=\"n\">head</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">SG_coeEquiv</span>\n<span class=\"n\">Switched</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">branch</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">SG_coeEquiv'</span>\n<span class=\"o\">[</span><span class=\"n\">jireh</span><span class=\"bp\">@</span><span class=\"n\">boston</span><span class=\"w\"> </span><span class=\"n\">mathlib4</span><span class=\"o\">]</span><span class=\"bp\">$</span><span class=\"w\">  </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get</span>\n<span class=\"n\">Mathlib</span><span class=\"w\"> </span><span class=\"n\">repository</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"bp\">-</span><span class=\"n\">loreaux</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span>\n<span class=\"n\">Attempting</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">download</span><span class=\"w\"> </span><span class=\"mi\">5964</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"w\"> </span><span class=\"n\">cache</span>\n<span class=\"n\">Downloaded</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">414</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">attempted</span><span class=\"w\"> </span><span class=\"mi\">5964</span><span class=\"bp\">/</span><span class=\"mi\">5964</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">100</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">6</span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">success</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- about 20-30 seconds here, total, with many misses</span>\n<span class=\"n\">Attempting</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">download</span><span class=\"w\"> </span><span class=\"mi\">5550</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"bp\">-</span><span class=\"n\">loreaux</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"w\"> </span><span class=\"n\">cache</span>\n<span class=\"n\">Downloaded</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">attempted</span><span class=\"w\"> </span><span class=\"mi\">465</span><span class=\"bp\">/</span><span class=\"mi\">5550</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">8</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"c1\">-- about 4-5 seconds per file here, much slower</span>\n</code></pre></div>\n<p>I'm on a ≥ 1 Gb/s connection.</p>",
        "id": 523814691,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1749754288
    },
    {
        "content": "<p>It's not too bad, because you can kill the second download as it won't find new files. But after that, what happens if you do again <code>lake exe cache get</code>? Is it still reasonable in the first step?</p>",
        "id": 523815089,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749754482
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 523815230,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1749754555
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 523815285,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1749754580
    },
    {
        "content": "<p>Ah! It now attempts to download from <code>leanprover-community/mathlib4</code>, but it is now just as slow as when trying <code>j-loreaux/mathlib4</code> the first time!</p>",
        "id": 523815483,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1749754658
    },
    {
        "content": "<p>ok, that's exactly the same behavior as the one I have. So it's not just me. Thanks for trying!</p>",
        "id": 523815634,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749754729
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span> , I don't know if this slowness is to be expected?</p>",
        "id": 523815772,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749754801
    },
    {
        "content": "<p>There is currently a major Internet outage in the U.S. for GCS (Google Cloud Service) and some other regions.</p>\n<p><a href=\"https://status.cloud.google.com/regional/multiregions\">https://status.cloud.google.com/regional/multiregions</a></p>\n<p><a href=\"https://www.githubstatus.com/\">https://www.githubstatus.com/</a></p>\n<p>HTH</p>",
        "id": 523817403,
        "sender_full_name": "Eric Taucher",
        "timestamp": 1749755450
    },
    {
        "content": "<p>I've had this behavior several time when there was no outage</p>",
        "id": 523817734,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749755612
    },
    {
        "content": "<p>What is most strange to me about this is that <code>cache</code> (IIRC) executes downloading of cached files <em>in parallel</em>, but the failure mode makes it appear as if they are attempted <em>iteratively</em>. <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 523818764,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1749756087
    },
    {
        "content": "<p>Next time it happens I'll Wireshark and look at the requests</p>",
        "id": 523818956,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749756192
    },
    {
        "content": "<p>It could be rate limiting on the server end?</p>",
        "id": 523856034,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1749777552
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110050\">Sébastien Gouëzel</span> <a href=\"#narrow/channel/287929-mathlib4/topic/lake.20exe.20cache.20get.20very.20slow/near/523815772\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"315577\">Mac Malone</span> , I don't know if this slowness is to be expected?</p>\n</blockquote>\n<p>Unfortunately, it is partially expected. Downloads of missing files in the cache (i.e., cache misses) have been observed to often be quite slow.</p>",
        "id": 523999532,
        "sender_full_name": "Mac Malone",
        "timestamp": 1749841152
    },
    {
        "content": "<p>It seems to me that there is still something fishy going on. I just had a <code>lake exe cache get</code> executed, where in the end it only found 11 files out of 372, as expected. At the beginning, each failed attempt was taking 1 second per file. When it found the first successful file, after 20 files and 20 seconds, then it finished the rest in 1 second overall -- which means that all the other failures were essentially instant! Is there a different behavior in the code before the first success and after the first success?</p>",
        "id": 524072650,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749915924
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span></p>",
        "id": 524072669,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749915942
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span>  As far as I am aware, cache just downloads all the files in parallel using <code>curl</code>. Thus, any such behavior would be <code>curl</code> itself doing something weird.</p>",
        "id": 524096183,
        "sender_full_name": "Mac Malone",
        "timestamp": 1749949444
    },
    {
        "content": "<p>My suspicion is that the blame goes to the cache providers (Azure, S3, I'm not even sure), not <code>cache</code> or <code>curl</code>.</p>",
        "id": 524107274,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1749966909
    },
    {
        "content": "<p>Could we hack it around by downloading also the cache of a very low file in the hierarchy (preferably as the first download), even if if we already have it, just to get the process going?</p>",
        "id": 524110459,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749971286
    },
    {
        "content": "<p>I guess there's no reason we can't force downloading Mathlib.Init even if it is available locally, if anything else needs downloading...</p>",
        "id": 524112261,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1749973743
    },
    {
        "content": "<p>My current workflow is the following, when I'm on a branch with mostly failed files that remain to be downloaded. First, start with</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get!</span>\n</code></pre></div>\n<p>This redownloads already downloaded files, but it also means I will hit a successful download much quicker, and then everything is quick. This is much quicker than <code>lake exe cache get</code>. There is a difficulty if I'm on a fork, though. I will see</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Mathlib</span><span class=\"w\"> </span><span class=\"n\">repository</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">sgouezel</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span>\n<span class=\"n\">Attempting</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">download</span><span class=\"w\"> </span><span class=\"mi\">6814</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"w\"> </span><span class=\"n\">cache</span>\n<span class=\"n\">Downloaded</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1264</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">attempted</span><span class=\"w\"> </span><span class=\"mi\">6814</span><span class=\"bp\">/</span><span class=\"mi\">6814</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">100</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">18</span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">success</span><span class=\"o\">)</span>\n<span class=\"n\">Attempting</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">download</span><span class=\"w\"> </span><span class=\"mi\">6814</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">sgouezel</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"w\"> </span><span class=\"n\">cache</span>\n<span class=\"n\">Downloaded</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">attempted</span><span class=\"w\"> </span><span class=\"mi\">12</span><span class=\"bp\">/</span><span class=\"mi\">6814</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"bp\">%</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>where the second download on <code>sgouezel/mathlib4 cache</code> will only see failures, and will take more than one hour to do so. Then I interrupt the second download with Ctrl-C, but this means the files are not decompressed. Then I do</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">unpack</span>\n</code></pre></div>\n<p>to unpack already downloaded files.</p>\n<p>With this worflow, things become usable again.</p>",
        "id": 524113668,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749975389
    },
    {
        "content": "<p>(If you're not convinced the above is necessary, I invite you to try it by yourself: on a mathlib fork, do</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">gh</span><span class=\"w\"> </span><span class=\"n\">pr</span><span class=\"w\"> </span><span class=\"n\">checkout</span><span class=\"w\"> </span><span class=\"mi\">25816</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get</span>\n</code></pre></div>\n<p>let it complete, and then do a second</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get</span>\n</code></pre></div>\n<p>For me (with an 8Gb/s connection), the second one takes more than one hour to complete -- I'd be interested to know if someone gets the same behavior, or a different one)</p>",
        "id": 524113846,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749975600
    },
    {
        "content": "<p>Can confirm same behaviour with this PR</p>",
        "id": 524114375,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749976253
    },
    {
        "content": "<p>The first <code>lake exe cache get</code> spends about a minute retrieving things (well, nothing) from leanprover-community/mathlib4, and them about the same from kim-em/mathlib4 cache. (This is definitely the wrong behaviour it should be looking in the sgouezel/mathlib4 fork!) The second invocation seems to be identical.</p>",
        "id": 524114646,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1749976553
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"286014\">@Robin Carlier</span>, <span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span>, which OS are you on? (I'm on a mac.)</p>",
        "id": 524114669,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1749976568
    },
    {
        "content": "<p><code>Linux 6.14.8 #1-NixOS SMP PREEMPT_DYNAMIC x86_64 GNU/Linux</code></p>",
        "id": 524114729,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749976645
    },
    {
        "content": "<p>Windows 11 for me.</p>\n<p>It could also be a geographical issue. I'm in France.</p>",
        "id": 524115128,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749977127
    },
    {
        "content": "<p>Yes, France as well here (Lyon).</p>",
        "id": 524115185,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749977212
    },
    {
        "content": "<p>Note that as mentioned above, for me this is issue is rather old, I have been having this kind of issues for at least more than 1 month. Can’t say exactly when this started.</p>",
        "id": 524115449,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749977551
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/287929-mathlib4/topic/lake.20exe.20cache.20get.20very.20slow/near/524114646\">said</a>:</p>\n<blockquote>\n<p>This is definitely the wrong behaviour it should be looking in the sgouezel/mathlib4 fork!</p>\n</blockquote>\n<p>I'm still working on this issue, but I'll try <span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span>'s suggestion when I can.</p>",
        "id": 524116094,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1749978437
    },
    {
        "content": "<p>Sigh, the best solution I have so far is really complicated: <a href=\"https://github.com/leanprover-community/mathlib4/pull/25895\">#25895</a></p>\n<p><span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span> or <span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span>, would you be available to review?</p>",
        "id": 524116722,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1749979277
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"286014\">@Robin Carlier</span>  or <span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span>, could one of you try <a href=\"https://github.com/leanprover-community/mathlib4/pull/25898\">#25898</a>? You may have to move the script to a different branch to test properly.</p>",
        "id": 524117977,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1749980615
    },
    {
        "content": "<p>(Alternatively, since we're working on the hypothesis this is a France-specific problem, can we find anyone who knows <code>cache</code> and is in France? Or can give me ssh access? :-)</p>",
        "id": 524118013,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1749980664
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/287929-mathlib4/topic/lake.20exe.20cache.20get.20very.20slow/near/524117977\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"286014\">Robin Carlier</span>  or <span class=\"user-mention silent\" data-user-id=\"110050\">Sébastien Gouëzel</span>, could one of you try <a href=\"https://github.com/leanprover-community/mathlib4/pull/25898\">#25898</a>? You may have to move the script to a different branch to test properly.</p>\n</blockquote>\n<p>copy-pasted the diff on <span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span>'s branch and ran cache, but no luck :(</p>",
        "id": 524118764,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749981516
    },
    {
        "content": "<p>I’ll try on a server I have access to that I think is hosted in France, to test the geography hyp.</p>",
        "id": 524119040,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749981759
    },
    {
        "content": "<p>Trying on a France-hosted <del>behavior</del> server, there is still a lot of cache misses, and it’s overall not fast, but this time it does seems like downloads happen in parallel, so while it takes a few minutes to fail the entire cache, it’s much faster than the 2h+ I  have at home.<br>\nThe system there is a debian 12</p>",
        "id": 524120242,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749982843
    },
    {
        "content": "<p>So we can scratch the \"cache doesn’t like french people\" hypothesis I guess?</p>",
        "id": 524120309,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749982904
    },
    {
        "content": "<p>Doesn't make a difference for me either. My internet provider at home is Free, what is yours Robin?</p>",
        "id": 524121310,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749983765
    },
    {
        "content": "<p>Mine is Orange. Maybe a weird thing with curl? fwiw at home</p>\n<div class=\"codehilite\" data-code-language=\"Bash Session\"><pre><span></span><code><span class=\"gp\">$ </span>curl<span class=\"w\"> </span>--version\n<span class=\"go\">curl 8.13.0 (x86_64-pc-linux-gnu) libcurl/8.13.0 OpenSSL/3.4.1 zlib/1.3.1 brotli/1.1.0 zstd/1.5.7 libidn2/2.3.8 libpsl/0.21.5 libssh2/1.11.1 nghttp2/1.65.0</span>\n<span class=\"go\">Release-Date: 2025-04-02</span>\n<span class=\"go\">Protocols: dict file ftp ftps gopher gophers http https imap imaps ipfs ipns mqtt pop3 pop3s rtsp scp sftp smb smbs smtp smtps telnet tftp</span>\n<span class=\"go\">Features: alt-svc AsynchDNS brotli GSS-API HSTS HTTP2 HTTPS-proxy IDN IPv6 Kerberos Largefile libz NTLM PSL SPNEGO SSL threadsafe TLS-SRP UnixSockets zstd</span>\n</code></pre></div>\n<p>while on the server on which it seems to work</p>\n<div class=\"codehilite\" data-code-language=\"Bash Session\"><pre><span></span><code><span class=\"gp\">$ </span>curl<span class=\"w\"> </span>--version\n<span class=\"go\">curl 7.88.1 (x86_64-pc-linux-gnu) libcurl/7.88.1 OpenSSL/3.0.16 zlib/1.2.13 brotli/1.0.9 zstd/1.5.4 libidn2/2.3.3 libpsl/0.21.2 (+libidn2/2.3.3) libssh2/1.10.0 nghttp2/1.52.0 librtmp/2.3 OpenLDAP/2.5.13</span>\n<span class=\"go\">Release-Date: 2023-02-20, security patched: 7.88.1-10+deb12u12</span>\n<span class=\"go\">Protocols: dict file ftp ftps gopher gophers http https imap imaps ldap ldaps mqtt pop3 pop3s rtmp rtsp scp sftp smb smbs smtp smtps telnet tftp</span>\n<span class=\"go\">Features: alt-svc AsynchDNS brotli GSS-API HSTS HTTP2 HTTPS-proxy IDN IPv6 Kerberos Largefile libz NTLM NTLM_WB PSL SPNEGO SSL threadsafe TLS-SRP UnixSockets zstd</span>\n</code></pre></div>",
        "id": 524121495,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749983928
    },
    {
        "content": "<p>I don't know if <code>cache</code> is using the system's <code>curl</code> or an embedded one. <code>curl --version</code> doesn't even make sense on a Windows system. I also have a mingw32 version</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">curl</span><span class=\"w\"> </span><span class=\"c1\">--version</span>\n<span class=\"n\">curl</span><span class=\"w\"> </span><span class=\"mf\">7.64</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x86_64</span><span class=\"bp\">-</span><span class=\"n\">w64</span><span class=\"bp\">-</span><span class=\"n\">mingw32</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">libcurl</span><span class=\"bp\">/</span><span class=\"mf\">7.64</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"w\"> </span><span class=\"n\">OpenSSL</span><span class=\"bp\">/</span><span class=\"mf\">1.1</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Schannel</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">zlib</span><span class=\"bp\">/</span><span class=\"mf\">1.2</span><span class=\"bp\">.</span><span class=\"m\">11</span><span class=\"w\"> </span><span class=\"n\">libidn2</span><span class=\"bp\">/</span><span class=\"mf\">2.1</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">nghttp2</span><span class=\"bp\">/</span><span class=\"mf\">1.36</span><span class=\"bp\">.</span><span class=\"m\">0</span>\n<span class=\"n\">Release</span><span class=\"bp\">-</span><span class=\"n\">Date</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2019</span><span class=\"bp\">-</span><span class=\"mi\">02</span><span class=\"bp\">-</span><span class=\"mi\">06</span>\n<span class=\"n\">Protocols</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">dict</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">ftp</span><span class=\"w\"> </span><span class=\"n\">ftps</span><span class=\"w\"> </span><span class=\"n\">gopher</span><span class=\"w\"> </span><span class=\"n\">http</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"w\"> </span><span class=\"n\">imap</span><span class=\"w\"> </span><span class=\"n\">imaps</span><span class=\"w\"> </span><span class=\"n\">ldap</span><span class=\"w\"> </span><span class=\"n\">ldaps</span><span class=\"w\"> </span><span class=\"n\">pop3</span><span class=\"w\"> </span><span class=\"n\">pop3s</span><span class=\"w\"> </span><span class=\"n\">rtsp</span><span class=\"w\"> </span><span class=\"n\">smtp</span><span class=\"w\"> </span><span class=\"n\">smtps</span><span class=\"w\"> </span><span class=\"n\">telnet</span><span class=\"w\"> </span><span class=\"n\">tftp</span>\n<span class=\"n\">Features</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AsynchDNS</span><span class=\"w\"> </span><span class=\"n\">IDN</span><span class=\"w\"> </span><span class=\"n\">IPv6</span><span class=\"w\"> </span><span class=\"n\">Largefile</span><span class=\"w\"> </span><span class=\"n\">SSPI</span><span class=\"w\"> </span><span class=\"n\">Kerberos</span><span class=\"w\"> </span><span class=\"n\">SPNEGO</span><span class=\"w\"> </span><span class=\"n\">NTLM</span><span class=\"w\"> </span><span class=\"n\">SSL</span><span class=\"w\"> </span><span class=\"n\">libz</span><span class=\"w\"> </span><span class=\"n\">TLS</span><span class=\"bp\">-</span><span class=\"n\">SRP</span><span class=\"w\"> </span><span class=\"n\">HTTP2</span><span class=\"w\"> </span><span class=\"n\">HTTPS</span><span class=\"bp\">-</span><span class=\"n\">proxy</span><span class=\"w\"> </span><span class=\"n\">MultiSSL</span><span class=\"w\"> </span><span class=\"n\">Metalink</span>\n</code></pre></div>\n<p>but I'm not sure it's the one it uses...</p>",
        "id": 524124328,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749986747
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110050\">Sébastien Gouëzel</span> <a href=\"#narrow/channel/287929-mathlib4/topic/lake.20exe.20cache.20get.20very.20slow/near/524124328\">said</a>:</p>\n<blockquote>\n<p><code>curl --version</code> doesn't even make sense on a Windows system. </p>\n</blockquote>\n<p>I'm on windows and <code>curl --version</code> seems to work just fine, it prints</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>C:\\Users\\aaron&gt;curl --version\ncurl 8.9.1 (Windows) libcurl/8.9.1 Schannel zlib/1.3 WinIDN\nRelease-Date: 2024-07-31\nProtocols: dict file ftp ftps http https imap imaps ipfs ipns mqtt pop3 pop3s smb smbs smtp smtps telnet tftp\nFeatures: alt-svc AsynchDNS HSTS HTTPS-proxy IDN IPv6 Kerberos Largefile libz NTLM SPNEGO SSL SSPI threadsafe Unicode UnixSockets\n</code></pre></div>",
        "id": 524124478,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1749986902
    },
    {
        "content": "<p>I get this output</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">PS</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">:</span><span class=\"bp\">\\</span><span class=\"n\">Users</span><span class=\"bp\">\\</span><span class=\"n\">Sebastien</span><span class=\"bp\">\\</span><span class=\"n\">Desktop</span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">curl</span><span class=\"w\"> </span><span class=\"c1\">--version</span>\n<span class=\"n\">curl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Le</span><span class=\"w\"> </span><span class=\"n\">nom</span><span class=\"w\"> </span><span class=\"n\">distant</span><span class=\"w\"> </span><span class=\"n\">n'a</span><span class=\"w\"> </span><span class=\"n\">pas</span><span class=\"w\"> </span><span class=\"n\">pu</span><span class=\"w\"> </span><span class=\"bp\">ê</span><span class=\"n\">tre</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"bp\">é</span><span class=\"n\">solu</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"c1\">--version'</span>\n<span class=\"n\">Au</span><span class=\"w\"> </span><span class=\"n\">caract</span><span class=\"bp\">è</span><span class=\"n\">re</span><span class=\"w\"> </span><span class=\"n\">Ligne</span><span class=\"o\">:</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">curl</span><span class=\"w\"> </span><span class=\"c1\">--version</span>\n<span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">~~~~~~~~~~~~~~</span>\n<span class=\"w\">    </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">CategoryInfo</span><span class=\"w\">          </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">InvalidOperation</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">System</span><span class=\"bp\">.</span><span class=\"n\">Net</span><span class=\"bp\">.</span><span class=\"n\">HttpWebRequest</span><span class=\"o\">:</span><span class=\"n\">HttpWebRequest</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Invoke</span><span class=\"bp\">-</span><span class=\"n\">WebRequest</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">WebEx</span>\n<span class=\"w\">   </span><span class=\"n\">ception</span>\n<span class=\"w\">    </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">FullyQualifiedErrorId</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WebCmdletWebResponseException</span><span class=\"o\">,</span><span class=\"n\">Microsoft</span><span class=\"bp\">.</span><span class=\"n\">PowerShell</span><span class=\"bp\">.</span><span class=\"n\">Commands</span><span class=\"bp\">.</span><span class=\"n\">InvokeWebRequestCommand</span>\n</code></pre></div>\n<p>but we're getting offtopic, I think.</p>",
        "id": 524124549,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749986976
    },
    {
        "content": "<p>oh you're on powershell</p>",
        "id": 524124566,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1749986993
    },
    {
        "content": "<p>indeed I get the same result on powershell</p>",
        "id": 524124597,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1749987023
    },
    {
        "content": "<p>Ah, on non powershell I get indeed</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">C</span><span class=\"o\">:</span><span class=\"bp\">\\</span><span class=\"n\">Users</span><span class=\"bp\">\\</span><span class=\"n\">Sebastien</span><span class=\"bp\">&gt;</span><span class=\"n\">curl</span><span class=\"w\"> </span><span class=\"c1\">--version</span>\n<span class=\"n\">curl</span><span class=\"w\"> </span><span class=\"mf\">8.13</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Windows</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">libcurl</span><span class=\"bp\">/</span><span class=\"mf\">8.13</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"w\"> </span><span class=\"n\">Schannel</span><span class=\"w\"> </span><span class=\"n\">zlib</span><span class=\"bp\">/</span><span class=\"mf\">1.3</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">WinIDN</span>\n<span class=\"n\">Release</span><span class=\"bp\">-</span><span class=\"n\">Date</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2025</span><span class=\"bp\">-</span><span class=\"mi\">04</span><span class=\"bp\">-</span><span class=\"mi\">02</span>\n<span class=\"n\">Protocols</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">dict</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">ftp</span><span class=\"w\"> </span><span class=\"n\">ftps</span><span class=\"w\"> </span><span class=\"n\">http</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"w\"> </span><span class=\"n\">imap</span><span class=\"w\"> </span><span class=\"n\">imaps</span><span class=\"w\"> </span><span class=\"n\">ipfs</span><span class=\"w\"> </span><span class=\"n\">ipns</span><span class=\"w\"> </span><span class=\"n\">mqtt</span><span class=\"w\"> </span><span class=\"n\">pop3</span><span class=\"w\"> </span><span class=\"n\">pop3s</span><span class=\"w\"> </span><span class=\"n\">smb</span><span class=\"w\"> </span><span class=\"n\">smbs</span><span class=\"w\"> </span><span class=\"n\">smtp</span><span class=\"w\"> </span><span class=\"n\">smtps</span><span class=\"w\"> </span><span class=\"n\">telnet</span><span class=\"w\"> </span><span class=\"n\">tftp</span><span class=\"w\"> </span><span class=\"n\">ws</span><span class=\"w\"> </span><span class=\"n\">wss</span>\n<span class=\"n\">Features</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">alt</span><span class=\"bp\">-</span><span class=\"n\">svc</span><span class=\"w\"> </span><span class=\"n\">AsynchDNS</span><span class=\"w\"> </span><span class=\"n\">HSTS</span><span class=\"w\"> </span><span class=\"n\">HTTPS</span><span class=\"bp\">-</span><span class=\"n\">proxy</span><span class=\"w\"> </span><span class=\"n\">IDN</span><span class=\"w\"> </span><span class=\"n\">IPv6</span><span class=\"w\"> </span><span class=\"n\">Kerberos</span><span class=\"w\"> </span><span class=\"n\">Largefile</span><span class=\"w\"> </span><span class=\"n\">libz</span><span class=\"w\"> </span><span class=\"n\">NTLM</span><span class=\"w\"> </span><span class=\"n\">SPNEGO</span><span class=\"w\"> </span><span class=\"n\">SSL</span><span class=\"w\"> </span><span class=\"n\">SSPI</span><span class=\"w\"> </span><span class=\"n\">threadsafe</span><span class=\"w\"> </span><span class=\"n\">Unicode</span><span class=\"w\"> </span><span class=\"n\">UnixSockets</span>\n</code></pre></div>",
        "id": 524124623,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749987051
    },
    {
        "content": "<p>Cache calls system’s curl on my system (I had <code>IO.getCurl</code> log what command it found). I’ll see if I can hack this with a different curl to test the hyp.</p>",
        "id": 524124949,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749987401
    },
    {
        "content": "<p>So I downgraded curl to 7.88.1 (the version mentioned in cache’s source), and suddenly it works: the cache fails but downloads everything in parallel, so is doing it fast</p>",
        "id": 524126866,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749989358
    },
    {
        "content": "<p>Back to 8.13 and we’re slowpokes again.<br>\nI think we have our culprit.</p>",
        "id": 524126941,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749989444
    },
    {
        "content": "<p>For me, removing the <code>--fail</code> option in the curl call (in <code>downloadFiles</code>) makes it fast again. That's weird, because it's supposed to be an option to make it fast. Bug in curl 8.13?</p>",
        "id": 524128081,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749990772
    },
    {
        "content": "<p>The regression happens between curl 8.9.1 and 8.10.0</p>",
        "id": 524129217,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749992100
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span>, does <code>--fail</code> really speedup things in your setup, or could we consider dropping it for everyone? I guess another option is to add it or not depending on the curl version.</p>",
        "id": 524129250,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1749992141
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/287929-mathlib4/topic/lake.20exe.20cache.20get.20very.20slow/near/524116722\">said</a>:</p>\n<blockquote>\n<p>Sigh, the best solution I have so far is really complicated: <a href=\"https://github.com/leanprover-community/mathlib4/pull/25895\">#25895</a></p>\n<p><span class=\"user-mention silent\" data-user-id=\"315577\">Mac Malone</span> or <span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span>, would you be available to review?</p>\n</blockquote>\n<p>I took a look, and as far as I can tell LGTM. But I would be happy if another pair of eyes took a look.</p>",
        "id": 524198073,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1750060370
    },
    {
        "content": "<p>Also, <span class=\"user-mention silent\" data-user-id=\"286014\">Robin Carlier</span> raises a valid point about <code>upstream</code>.</p>",
        "id": 524198244,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1750060423
    },
    {
        "content": "<p>So, what do we do about the <code>--fail</code>? Remove it? Remove it conditionally on <code>curl</code> version?</p>",
        "id": 524878713,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1750337364
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/lake.20exe.20cache.20get.20very.20slow/near/523815483\">said</a>:</p>\n<blockquote>\n<p>Ah! It now attempts to download from <code>leanprover-community/mathlib4</code>, but it is now just as slow as when trying <code>j-loreaux/mathlib4</code> the first time!</p>\n</blockquote>\n<p>I experienced someting similar: downloading from <code>leanprover-community/mathlib4</code> was fast, but did not have the cache for all files. Then it tried downloading <em>all files</em> from my fork <code>grunweg/mathlib4</code>, which mostly failed and did so slowly. Why did it even try to re-download files from my fork; that should not be necessary!</p>",
        "id": 524881993,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1750338364
    },
    {
        "content": "<p>I think the \"slow fail\" happens when <em>all</em> downloads fail, so when it tries do download from a fork that has no cache it's bound to hit the bug.</p>",
        "id": 524882975,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1750338662
    },
    {
        "content": "<p>Can we expose a flag to handle this?</p>",
        "id": 524884410,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1750339065
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/stream/287929-mathlib4/topic/lake.20exe.20cache.20get.20very.20slow/near/524881993\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/lake.20exe.20cache.20get.20very.20slow/near/523815483\">said</a>:</p>\n<blockquote>\n<p>Ah! It now attempts to download from <code>leanprover-community/mathlib4</code>, but it is now just as slow as when trying <code>j-loreaux/mathlib4</code> the first time!</p>\n</blockquote>\n<p>I experienced someting similar: downloading from <code>leanprover-community/mathlib4</code> was fast, but did not have the cache for all files. Then it tried downloading <em>all files</em> from my fork <code>grunweg/mathlib4</code>, which mostly failed and did so slowly. Why did it even try to re-download files from my fork; that should not be necessary!</p>\n</blockquote>\n<p>Same here, but trying one hour late succeeded, so I attributed it to random problems, or oversaturated server activities.</p>",
        "id": 524888881,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1750340425
    },
    {
        "content": "<p>My current workflow on startup is </p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>git<span class=\"w\"> </span>fetch<span class=\"w\"> </span>upstream<span class=\"w\"> </span>master\ngit<span class=\"w\"> </span>switch<span class=\"w\"> </span>--detach<span class=\"w\"> </span>upstream/master\ngit<span class=\"w\"> </span>switch<span class=\"w\"> </span>-c<span class=\"w\"> </span>new_branch\nlake<span class=\"w\"> </span>exe<span class=\"w\"> </span>cache<span class=\"w\"> </span>get\n</code></pre></div>\n<p>which is guaranteed to have no cache for my fork. For me, <code>lake exe cache get --upstream-only</code> would not be a burden. I also may be doing things suboptimally and am open to suggestions.</p>",
        "id": 524892515,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1750341538
    },
    {
        "content": "<p>Why do you need the <code>git switch --detach upstream/master</code>?</p>",
        "id": 524901752,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1750344487
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> mentioned that we should change how <code>lake exe cache</code> handles CLI arguments (e.g <code>--repo</code> which has to be before the  <code>get</code>), if we're adding flags (e.g <code>--upstream-only</code> and <code>--no-fail</code>), maybe it's a good time to do that?</p>",
        "id": 524911344,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1750347896
    },
    {
        "content": "<p>(at least I remember a comment about \"using <code>lean4cli</code>\", which I have no idea what it is)</p>",
        "id": 524911618,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1750347992
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"300245\">Filippo A. E. Nuccio</span> <a href=\"#narrow/channel/287929-mathlib4/topic/lake.20exe.20cache.20get.20very.20slow/near/524901752\">said</a>:</p>\n<blockquote>\n<p>Why do you need the <code>git switch --detach upstream/master</code>?</p>\n</blockquote>\n<p>I am on some random branch and don't want any branch tracking master on my fork.</p>",
        "id": 524916665,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1750349804
    },
    {
        "content": "<p>For the record, <code>lake exe cache get</code> is still unusable for me on branches with mostly missing files (1 second per missing file!), so I am using <code>lake exe cache get!</code> in such situations. I have seen that removing the <code>--fail</code> flag to the <code>curl</code> call solves the issue for me. I have opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/26367\">#26367</a> for this, but I can't test if this has bad performance consequences for other curl versions.</p>",
        "id": 525564015,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1750785789
    },
    {
        "content": "<p>About the curl version issue, while its behaviour when fetching mathlib change somewhere between 8.9.1 and 8.10.0, testing with local servers showed me that in fact <code>--parallel</code> + <code>--fail</code> never worked well together in the first place (for local servers, it seems to fail \"in series\"), even since curl 8.0.0. I don’t know if it is by design or by accident (curl’s documentation says nothing about this). <br>\nSo I think removing it is the right way for now, since we’ve been expecting a behaviour it does not have from the start.<br>\nNote however this will mean a very slight increase in network rate for whoever hosts the cache server, since now every failed download will still transfer a few bytes of data.</p>\n<p>We should however test that this does not actually write down files that look like html 404 errors, because I see potential very weird errors in this case.</p>",
        "id": 525567347,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1750787332
    },
    {
        "content": "<p>Could the removal of <code>--fail</code> maybe be a cause for some of the recent issues in <a class=\"message-link\" href=\"/#narrow/channel/287929-mathlib4/topic/lake.20exe.20cache.20get/near/536450882\">#mathlib4 &gt; lake exe cache get @ 💬</a>? If so, could switching to <code>--fail-early</code> instead of omitting <code>--fail</code> help?</p>",
        "id": 538238355,
        "sender_full_name": "Joscha Mennicken",
        "timestamp": 1757340962
    },
    {
        "content": "<p>That’s probably what I was describing in my last paragraph, yes.<br>\n<code>--fail-early</code> will exit curl and stop any pending download as soon as there is <em>one</em> error right? This might be even worse if the server is missing a single file, as it’ll fail quickly and then you won’t be able to download anything?</p>",
        "id": 538251497,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1757344139
    },
    {
        "content": "<p>Also from what I read in curl’s manual, it seems <code>--fail-early</code> won’t fail due to HTTP code and would still write an html 404 file as a .ltar unless paired with <code>--fail</code> anyways.</p>",
        "id": 538253723,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1757344631
    },
    {
        "content": "<p>I just discovered the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Threads</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Wall</span><span class=\"w\"> </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">vs</span><span class=\"w\"> </span><span class=\"mi\">24</span><span class=\"w\"> </span><span class=\"n\">threads</span><span class=\"w\"> </span><span class=\"bp\">|</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"c1\">---------|-----------|---------------|</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\">       </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">30.60</span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">0.7</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">slower</span><span class=\"w\">   </span><span class=\"bp\">|</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\">       </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">15.71</span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">1.4</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">faster</span><span class=\"w\">   </span><span class=\"bp\">|</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\">       </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">10.50</span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">2.1</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">faster</span><span class=\"w\">   </span><span class=\"bp\">|</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"w\">       </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">9.84</span><span class=\"n\">s</span><span class=\"w\">     </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">2.3</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">faster</span><span class=\"w\">   </span><span class=\"bp\">|</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"w\">       </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">9.37</span><span class=\"n\">s</span><span class=\"w\">     </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">2.4</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">faster</span><span class=\"w\">   </span><span class=\"bp\">|</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"w\">       </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">10.28</span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">2.2</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">faster</span><span class=\"w\">   </span><span class=\"bp\">|</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">8</span><span class=\"w\">       </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">10.09</span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">2.2</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">faster</span><span class=\"w\">   </span><span class=\"bp\">|</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">12</span><span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">12.65</span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">1.8</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">faster</span><span class=\"w\">   </span><span class=\"bp\">|</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">16</span><span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">15.44</span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">1.4</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">faster</span><span class=\"w\">   </span><span class=\"bp\">|</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">24</span><span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mf\">22.16</span><span class=\"n\">s</span><span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">baseline</span><span class=\"w\">      </span><span class=\"bp\">|</span>\n</code></pre></div>\n<p><code>leangz</code> is selecting 24 by default, since that's the number of CPUs I have. We can probably do some optimization here!</p>",
        "id": 561550811,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1764726888
    },
    {
        "content": "<p>Profiling tool at <a href=\"https://github.com/digama0/leangz/pull/6\">https://github.com/digama0/leangz/pull/6</a></p>",
        "id": 561555902,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1764731764
    },
    {
        "content": "<p>Could someone please check this out, and run</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"c1\">--release</span>\n<span class=\"n\">leantar</span><span class=\"bp\">-</span><span class=\"n\">benchmark</span><span class=\"w\"> </span><span class=\"c1\">--create-manifest v4.26.0-rc2</span>\n<span class=\"n\">leantar</span><span class=\"bp\">-</span><span class=\"n\">benchmark</span><span class=\"w\"> </span><span class=\"c1\">--sweep</span>\n</code></pre></div>\n<p>and report back their results? It would be good to have both old/new laptop/desktop linux/macos/windows data if possible.</p>\n<p>(edit: changed <code>rc1</code> to <code>rc2</code>)</p>",
        "id": 561555966,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1764731831
    },
    {
        "content": "<p>On my almost brand-new laptop running Ubuntu 24.04.3 LTS with a AMD Ryzen AI 5 PRO 340 (12 threads) CPU:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>chenson@chenson:~/git/leangz$<span class=\"w\"> </span>./target/release/leantar-benchmark<span class=\"w\"> </span>--sweep\n<span class=\"o\">===</span><span class=\"w\"> </span>Thread<span class=\"w\"> </span>Count<span class=\"w\"> </span><span class=\"nv\">Sweep</span><span class=\"w\"> </span><span class=\"o\">===</span>\nTesting<span class=\"w\"> </span>thread<span class=\"w\"> </span>counts:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">1</span>,<span class=\"w\"> </span><span class=\"m\">2</span>,<span class=\"w\"> </span><span class=\"m\">4</span>,<span class=\"w\"> </span><span class=\"m\">6</span>,<span class=\"w\"> </span><span class=\"m\">8</span>,<span class=\"w\"> </span><span class=\"m\">12</span><span class=\"o\">]</span>\n<span class=\"o\">(</span>This<span class=\"w\"> </span>will<span class=\"w\"> </span>take<span class=\"w\"> </span>a<span class=\"w\"> </span>few<span class=\"w\"> </span>minutes...<span class=\"o\">)</span>\n\nTesting<span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">17</span>.85s\nTesting<span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">7</span>.34s\nTesting<span class=\"w\"> </span><span class=\"m\">4</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">4</span>.12s\nTesting<span class=\"w\"> </span><span class=\"m\">6</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">3</span>.00s\nTesting<span class=\"w\"> </span><span class=\"m\">8</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">2</span>.78s\nTesting<span class=\"w\"> </span><span class=\"m\">12</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">2</span>.58s\n\n<span class=\"o\">===</span><span class=\"w\"> </span><span class=\"nv\">Results</span><span class=\"w\"> </span><span class=\"o\">===</span>\n\n<span class=\"w\"> </span>Threads<span class=\"w\">       </span>Time<span class=\"w\">    </span>vs<span class=\"w\"> </span>Best\n<span class=\"w\"> </span>-------<span class=\"w\">   </span>--------<span class=\"w\">    </span>-------\n<span class=\"w\">       </span><span class=\"m\">1</span><span class=\"w\">     </span><span class=\"m\">17</span>.85s<span class=\"w\">      </span><span class=\"m\">6</span>.93x\n<span class=\"w\">       </span><span class=\"m\">2</span><span class=\"w\">      </span><span class=\"m\">7</span>.34s<span class=\"w\">      </span><span class=\"m\">2</span>.85x\n<span class=\"w\">       </span><span class=\"m\">4</span><span class=\"w\">      </span><span class=\"m\">4</span>.12s<span class=\"w\">      </span><span class=\"m\">1</span>.60x\n<span class=\"w\">       </span><span class=\"m\">6</span><span class=\"w\">      </span><span class=\"m\">3</span>.00s<span class=\"w\">      </span><span class=\"m\">1</span>.17x\n<span class=\"w\">       </span><span class=\"m\">8</span><span class=\"w\">      </span><span class=\"m\">2</span>.78s<span class=\"w\">      </span><span class=\"m\">1</span>.08x\n<span class=\"w\">      </span><span class=\"m\">12</span><span class=\"w\">      </span><span class=\"m\">2</span>.58s<span class=\"w\">      </span><span class=\"m\">1</span>.00x<span class=\"w\"> </span>&lt;--<span class=\"w\"> </span>best\n\nOptimal<span class=\"w\"> </span>thread<span class=\"w\"> </span>count:<span class=\"w\"> </span><span class=\"m\">12</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">2</span>.58s<span class=\"o\">)</span>\n</code></pre></div>",
        "id": 561558671,
        "sender_full_name": "Chris Henson",
        "timestamp": 1764734018
    },
    {
        "content": "<p>I tried on my older Windows desktop too, but got a failure message for all thread counts. Maybe someone else can try?</p>",
        "id": 561560661,
        "sender_full_name": "Chris Henson",
        "timestamp": 1764735646
    },
    {
        "content": "<p>Hmm, if I run <code>leantar-benchmark --create-manifest v4.26.0-rc1</code>, then I get the following error:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Downloading</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">files</span><span class=\"bp\">...</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">plausible</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">plausible</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">plausible</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">ec4a54b5308c1f46b4b52a9c62fb67d193aa0972'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LeanSearchClient</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">LeanSearchClient</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LeanSearchClient</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">2</span><span class=\"n\">ed4ba69b6127de8f5c2af83cccacd3c988b06bf'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">importGraph</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"kn\">import</span><span class=\"bp\">-</span><span class=\"n\">graph</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">importGraph</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">7</span><span class=\"n\">ff87023a8e1b358d2d01c1bc56b040a60609577'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">proofwidgets</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">ProofWidgets4</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">proofwidgets</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">894</span><span class=\"n\">c511d39bf442636bcba085245a1cf2bbdf665'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">aesop</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">aesop</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">aesop</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">c00943d5ff28c6dc623dbc24f8d659a9d3a3d29a'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Qq</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">quote4</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Qq</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">1</span><span class=\"n\">be06a278c3c249edafb722bfb278622024929d8'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">batteries</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">batteries</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">batteries</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">c278d4e94fe43bc38da4966795dc0c72538e68ab'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cli</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">cli</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cli</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">00</span><span class=\"n\">fad25fa9bedece1f1f988ab9c180dfe3d535b3'</span>\n<span class=\"n\">PANIC</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"bp\">.</span><span class=\"n\">toNat!</span><span class=\"w\"> </span><span class=\"n\">Init</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">String</span><span class=\"bp\">.</span><span class=\"n\">Extra</span><span class=\"o\">:</span><span class=\"mi\">39</span><span class=\"o\">:</span><span class=\"mi\">4</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"n\">expected</span>\n<span class=\"n\">backtrace</span><span class=\"o\">:</span>\n<span class=\"mi\">0</span><span class=\"w\">   </span><span class=\"n\">cache</span><span class=\"w\">                               </span><span class=\"mi\">0</span><span class=\"n\">x0000000108f20074</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">ZN4leanL15lean_panic_implEPKcmb</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">268</span>\n<span class=\"mi\">1</span><span class=\"w\">   </span><span class=\"n\">cache</span><span class=\"w\">                               </span><span class=\"mi\">0</span><span class=\"n\">x0000000108f20548</span><span class=\"w\"> </span><span class=\"n\">lean_panic_fn</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">40</span>\n<span class=\"mi\">2</span><span class=\"w\">   </span><span class=\"n\">cache</span><span class=\"w\">                               </span><span class=\"mi\">0</span><span class=\"n\">x0000000102054048</span><span class=\"w\"> </span><span class=\"n\">l_Cache_IO_parseVersion</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">548</span>\n<span class=\"mi\">3</span><span class=\"w\">   </span><span class=\"n\">cache</span><span class=\"w\">                               </span><span class=\"mi\">0</span><span class=\"n\">x0000000102054ae4</span><span class=\"w\"> </span><span class=\"n\">l_Cache_IO_validateLeanTar</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1560</span>\n<span class=\"mi\">4</span><span class=\"w\">   </span><span class=\"n\">cache</span><span class=\"w\">                               </span><span class=\"mi\">0</span><span class=\"n\">x0000000102044ad0</span><span class=\"w\"> </span><span class=\"n\">l_main___lam__1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1416</span>\n<span class=\"mi\">5</span><span class=\"w\">   </span><span class=\"n\">cache</span><span class=\"w\">                               </span><span class=\"mi\">0</span><span class=\"n\">x0000000108f2df68</span><span class=\"w\"> </span><span class=\"n\">lean_apply_2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">788</span>\n<span class=\"mi\">6</span><span class=\"w\">   </span><span class=\"n\">cache</span><span class=\"w\">                               </span><span class=\"mi\">0</span><span class=\"n\">x0000000102047f0c</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">204</span>\n<span class=\"mi\">7</span><span class=\"w\">   </span><span class=\"n\">dyld</span><span class=\"w\">                                </span><span class=\"mi\">0</span><span class=\"n\">x000000019eeef154</span><span class=\"w\"> </span><span class=\"n\">start</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2476</span>\n<span class=\"n\">installing</span><span class=\"w\"> </span><span class=\"n\">leantar</span><span class=\"w\"> </span><span class=\"mf\">0.1</span><span class=\"bp\">.</span><span class=\"m\">16</span>\n<span class=\"w\">  </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\">    </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">Received</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">Xferd</span><span class=\"w\">  </span><span class=\"n\">Average</span><span class=\"w\"> </span><span class=\"n\">Speed</span><span class=\"w\">   </span><span class=\"n\">Time</span><span class=\"w\">    </span><span class=\"n\">Time</span><span class=\"w\">     </span><span class=\"n\">Time</span><span class=\"w\">  </span><span class=\"n\">Current</span>\n<span class=\"w\">                                 </span><span class=\"n\">Dload</span><span class=\"w\">  </span><span class=\"n\">Upload</span><span class=\"w\">   </span><span class=\"n\">Total</span><span class=\"w\">   </span><span class=\"n\">Spent</span><span class=\"w\">    </span><span class=\"n\">Left</span><span class=\"w\">  </span><span class=\"n\">Speed</span>\n<span class=\"w\">  </span><span class=\"mi\">0</span><span class=\"w\">     </span><span class=\"mi\">0</span><span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"w\">     </span><span class=\"mi\">0</span><span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"w\">     </span><span class=\"mi\">0</span><span class=\"w\">      </span><span class=\"mi\">0</span><span class=\"w\">      </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"c1\">--:--:-- --:--:-- --:--:--     0</span>\n<span class=\"mi\">100</span><span class=\"w\">  </span><span class=\"mi\">884</span><span class=\"n\">k</span><span class=\"w\">  </span><span class=\"mi\">100</span><span class=\"w\">  </span><span class=\"mi\">884</span><span class=\"n\">k</span><span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"w\">     </span><span class=\"mi\">0</span><span class=\"w\">  </span><span class=\"mi\">3278</span><span class=\"n\">k</span><span class=\"w\">      </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"c1\">--:--:-- --:--:-- --:--:-- 23.3M</span>\n\n<span class=\"n\">Fetching</span><span class=\"w\"> </span><span class=\"n\">ProofWidgets</span><span class=\"w\"> </span><span class=\"n\">cloud</span><span class=\"w\"> </span><span class=\"n\">release</span><span class=\"bp\">...</span><span class=\"w\"> </span><span class=\"n\">done!</span>\n</code></pre></div>",
        "id": 561666523,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1764772231
    },
    {
        "content": "<p>(Also, can I ask if using <code>-rc1</code> instead of <code>-rc2</code> was intentional?)</p>",
        "id": 561666617,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1764772251
    },
    {
        "content": "<p>Oops, that was a mistake, I had forgotten we were on rc2...</p>",
        "id": 561835491,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1764842218
    },
    {
        "content": "<p>I think it actually works even after the panic.</p>",
        "id": 561835530,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1764842229
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"238446\">@Anne Baanen</span> I've updated the PR to use rc2 instead of rc1.</p>\n<p>Is anyone available to test on macOS? It would help to know if the thread count optimization is reproducible there, or if this is Linux-specific.</p>",
        "id": 562585880,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1765244424
    },
    {
        "content": "<p>I'm on a Macbook Pro with an M4 Pro, Sequoia 15.6.1, and got failure on all counts:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>thomas@trm<span class=\"w\"> </span>leangz<span class=\"w\"> </span>%<span class=\"w\"> </span>leantar-benchmark<span class=\"w\"> </span>--sweep\nThread<span class=\"w\"> </span>Count<span class=\"w\"> </span>Sweep\nTesting:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">1</span>,<span class=\"w\"> </span><span class=\"m\">2</span>,<span class=\"w\"> </span><span class=\"m\">4</span>,<span class=\"w\"> </span><span class=\"m\">6</span>,<span class=\"w\"> </span><span class=\"m\">8</span>,<span class=\"w\"> </span><span class=\"m\">12</span>,<span class=\"w\"> </span><span class=\"m\">14</span><span class=\"o\">]</span>\n\nTesting<span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span>FAILED\nTesting<span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span>FAILED\nTesting<span class=\"w\"> </span><span class=\"m\">4</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span>FAILED\nTesting<span class=\"w\"> </span><span class=\"m\">6</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span>FAILED\nTesting<span class=\"w\"> </span><span class=\"m\">8</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span>FAILED\nTesting<span class=\"w\"> </span><span class=\"m\">12</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span>FAILED\nTesting<span class=\"w\"> </span><span class=\"m\">14</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span>FAILED\nNo<span class=\"w\"> </span>successful<span class=\"w\"> </span>benchmark<span class=\"w\"> </span>runs!\n</code></pre></div>\n<p>Here's everything I did (after some false starts) if you'd like to double-check that how I got here makes sense:<br>\n<a href=\"/user_uploads/3121/hwYotBMkA5DMXW4Jn8yiuGGN/PastedText.txt\">thomas-terminal-log.txt</a></p>",
        "id": 562589284,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1765246815
    },
    {
        "content": "<p>I was reminded of this just now and realized I could also try it on a modern windows machine (Windows 11, AMD Ryzen 9 9950X) which I have access to. I also got the same failure on all counts there. <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span> Here's the log: <br>\n<a href=\"/user_uploads/3121/YMR6GoctN9nXnD-SzFcVK5Z0/PastedText.txt\">thomas-windows-terminal-log.txt</a></p>\n<p>If it's any help, each test took a long time to fail on mac, but failed basically instantly on windows. (The rest of the process was comparable in speed, so I'm not sure it's a difference in power between the machines.)</p>",
        "id": 562811020,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1765318537
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> I also got <code>FAILED</code> runs. Prior to that, creating the manifest failed because it exceed the inode quota in my <code>/tmp‌/</code> directory. So I had to temporarily change my <code>TMPDIR</code> environment variable to something else (which I also did for the sweep). Then it succeeded in creating the manifest, but the sweep failed.</p>",
        "id": 562811889,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1765318865
    },
    {
        "content": "<p>Thanks for testing <span class=\"user-mention\" data-user-id=\"548935\">@Thomas Murrills</span>! I found the bug - the <code>--create-manifest</code> command was downloading cache files to a temp directory and then deleting them immediately after writing the manifest. So when <code>--sweep</code> ran, the <code>.ltar</code> files no longer existed.</p>\n<p>I've pushed a fix: <a href=\"https://github.com/digama0/leangz/pull/6\">https://github.com/digama0/leangz/pull/6</a></p>\n<p>Now <code>--create-manifest</code> downloads cache files to a persistent directory (<code>benchmarks/cache-&lt;tag&gt;/</code>) and stores that path in the manifest. The benchmark then reads from there by default.</p>\n<p>If you have a chance to try again:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>git<span class=\"w\"> </span>pull\ncargo<span class=\"w\"> </span>build<span class=\"w\"> </span>--release\nrm<span class=\"w\"> </span>-rf<span class=\"w\"> </span>benchmarks/<span class=\"w\">  </span><span class=\"c1\"># clear old manifest</span>\nleantar-benchmark<span class=\"w\"> </span>--create-manifest<span class=\"w\"> </span>v4.26.0-rc2\nleantar-benchmark<span class=\"w\"> </span>--sweep\n</code></pre></div>\n<p>(The PANIC you saw is from the Lean <code>cache</code> tool, not leangz - it's harmless and happens during leantar version detection.)</p>",
        "id": 562815641,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1765320269
    },
    {
        "content": "<p>Success! <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span> Here's what I got on mac, M4 Pro:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>thomas@trm<span class=\"w\"> </span>leangz<span class=\"w\"> </span>%<span class=\"w\"> </span>leantar-benchmark<span class=\"w\"> </span>--sweep\nThread<span class=\"w\"> </span>Count<span class=\"w\"> </span>Sweep\nTesting:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">1</span>,<span class=\"w\"> </span><span class=\"m\">2</span>,<span class=\"w\"> </span><span class=\"m\">4</span>,<span class=\"w\"> </span><span class=\"m\">6</span>,<span class=\"w\"> </span><span class=\"m\">8</span>,<span class=\"w\"> </span><span class=\"m\">12</span>,<span class=\"w\"> </span><span class=\"m\">14</span><span class=\"o\">]</span>\n\nTesting<span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">21</span>.86s\nTesting<span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">12</span>.94s\nTesting<span class=\"w\"> </span><span class=\"m\">4</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">8</span>.59s\nTesting<span class=\"w\"> </span><span class=\"m\">6</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">7</span>.19s\nTesting<span class=\"w\"> </span><span class=\"m\">8</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">6</span>.68s\nTesting<span class=\"w\"> </span><span class=\"m\">12</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">7</span>.16s\nTesting<span class=\"w\"> </span><span class=\"m\">14</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">7</span>.79s\n\nResults:\n<span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">21</span>.86s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">3</span>.27x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">2</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">12</span>.94s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.94x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">4</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">8</span>.59s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.28x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">6</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">7</span>.19s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.08x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">8</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">6</span>.68s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.00x<span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span>best<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">12</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">7</span>.16s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.07x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">14</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">7</span>.79s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.17x<span class=\"o\">)</span>\n\nOptimal<span class=\"w\"> </span>thread<span class=\"w\"> </span>count:<span class=\"w\"> </span><span class=\"m\">8</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">6</span>.68s<span class=\"o\">)</span>\nSpeedup<span class=\"w\"> </span>vs<span class=\"w\"> </span><span class=\"m\">14</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">1</span>.2x\n</code></pre></div>",
        "id": 562817487,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1765321044
    },
    {
        "content": "<p>(For the record, I left my computer alone while benching. <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span>)</p>",
        "id": 562817565,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1765321076
    },
    {
        "content": "<p>(I'll try it on windows when that machine is next available.)</p>",
        "id": 562817866,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1765321183
    },
    {
        "content": "<p>Arch Linux with KDE:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>Thread<span class=\"w\"> </span>Count<span class=\"w\"> </span>Sweep\nTesting:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">1</span>,<span class=\"w\"> </span><span class=\"m\">2</span>,<span class=\"w\"> </span><span class=\"m\">4</span>,<span class=\"w\"> </span><span class=\"m\">6</span>,<span class=\"w\"> </span><span class=\"m\">8</span>,<span class=\"w\"> </span><span class=\"m\">12</span><span class=\"o\">]</span>\n\nTesting<span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">30</span>.13s\nTesting<span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">22</span>.36s\nTesting<span class=\"w\"> </span><span class=\"m\">4</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">33</span>.28s\nTesting<span class=\"w\"> </span><span class=\"m\">6</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">39</span>.92s\nTesting<span class=\"w\"> </span><span class=\"m\">8</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">30</span>.96s\nTesting<span class=\"w\"> </span><span class=\"m\">12</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">42</span>.35s\n\nResults:\n<span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">30</span>.13s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.35x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">2</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">22</span>.36s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.00x<span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span>best<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">4</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">33</span>.28s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.49x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">6</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">39</span>.92s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.79x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">8</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">30</span>.96s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.38x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">12</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">42</span>.35s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.89x<span class=\"o\">)</span>\n\nOptimal<span class=\"w\"> </span>thread<span class=\"w\"> </span>count:<span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">22</span>.36s<span class=\"o\">)</span>\nSpeedup<span class=\"w\"> </span>vs<span class=\"w\"> </span><span class=\"m\">12</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">1</span>.9x\n</code></pre></div>",
        "id": 562818417,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1765321390
    },
    {
        "content": "<p>My normal decompression rates when working on Mathlib are more like &lt;10s though, so I suspect there is still some sort of problem with this benchmarking.</p>",
        "id": 562818608,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1765321475
    },
    {
        "content": "<p>1 year-old Macbook Air M3 w/ 24GB RAM:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$<span class=\"w\"> </span>./target/release/leantar-benchmark<span class=\"w\"> </span>--sweep\nThread<span class=\"w\"> </span>Count<span class=\"w\"> </span>Sweep\nTesting:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">1</span>,<span class=\"w\"> </span><span class=\"m\">2</span>,<span class=\"w\"> </span><span class=\"m\">4</span>,<span class=\"w\"> </span><span class=\"m\">6</span>,<span class=\"w\"> </span><span class=\"m\">8</span><span class=\"o\">]</span>\n\nTesting<span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">26</span>.77s\nTesting<span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">16</span>.61s\nTesting<span class=\"w\"> </span><span class=\"m\">4</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">10</span>.88s\nTesting<span class=\"w\"> </span><span class=\"m\">6</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">8</span>.97s\nTesting<span class=\"w\"> </span><span class=\"m\">8</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">7</span>.68s\n\nResults:\n<span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">26</span>.77s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">3</span>.48x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">2</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">16</span>.61s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">2</span>.16x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">4</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">10</span>.88s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.42x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">6</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">8</span>.97s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.17x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">8</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">7</span>.68s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.00x<span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span>best<span class=\"o\">)</span>\n\nOptimal<span class=\"w\"> </span>thread<span class=\"w\"> </span>count:<span class=\"w\"> </span><span class=\"m\">8</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">7</span>.68s<span class=\"o\">)</span>\n</code></pre></div>",
        "id": 562821694,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1765322850
    },
    {
        "content": "<p>I was really surprised by the performance on Windows (AMD Ryzen 9 9950X) compared to my M4 Pro mac; it was quite a bit worse.</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>Thread<span class=\"w\"> </span>Count<span class=\"w\"> </span>Sweep\nTesting:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">1</span>,<span class=\"w\"> </span><span class=\"m\">2</span>,<span class=\"w\"> </span><span class=\"m\">4</span>,<span class=\"w\"> </span><span class=\"m\">6</span>,<span class=\"w\"> </span><span class=\"m\">8</span>,<span class=\"w\"> </span><span class=\"m\">12</span>,<span class=\"w\"> </span><span class=\"m\">16</span>,<span class=\"w\"> </span><span class=\"m\">24</span>,<span class=\"w\"> </span><span class=\"m\">32</span><span class=\"o\">]</span>\n\nTesting<span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">42</span>.37s\nTesting<span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">31</span>.94s\nTesting<span class=\"w\"> </span><span class=\"m\">4</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">32</span>.22s\nTesting<span class=\"w\"> </span><span class=\"m\">6</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">31</span>.69s\nTesting<span class=\"w\"> </span><span class=\"m\">8</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">29</span>.49s\nTesting<span class=\"w\"> </span><span class=\"m\">12</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">30</span>.65s\nTesting<span class=\"w\"> </span><span class=\"m\">16</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">30</span>.66s\nTesting<span class=\"w\"> </span><span class=\"m\">24</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">29</span>.90s\nTesting<span class=\"w\"> </span><span class=\"m\">32</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">30</span>.32s\n\nResults:\n<span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">42</span>.37s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.44x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">2</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">31</span>.94s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.08x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">4</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">32</span>.22s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.09x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">6</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">31</span>.69s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.07x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">8</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">29</span>.49s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.00x<span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span>best<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">12</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">30</span>.65s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.04x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">16</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">30</span>.66s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.04x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">24</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">29</span>.90s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.01x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">32</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">30</span>.32s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.03x<span class=\"o\">)</span>\n\nOptimal<span class=\"w\"> </span>thread<span class=\"w\"> </span>count:<span class=\"w\"> </span><span class=\"m\">8</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">29</span>.49s<span class=\"o\">)</span>\nSpeedup<span class=\"w\"> </span>vs<span class=\"w\"> </span><span class=\"m\">32</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">1</span>.0x\n</code></pre></div>\n<p>Then I noticed in task manager that the antimalware process was whirring away, so I turned it off temporarily:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>Thread<span class=\"w\"> </span>Count<span class=\"w\"> </span>Sweep\nTesting:<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">1</span>,<span class=\"w\"> </span><span class=\"m\">2</span>,<span class=\"w\"> </span><span class=\"m\">4</span>,<span class=\"w\"> </span><span class=\"m\">6</span>,<span class=\"w\"> </span><span class=\"m\">8</span>,<span class=\"w\"> </span><span class=\"m\">12</span>,<span class=\"w\"> </span><span class=\"m\">16</span>,<span class=\"w\"> </span><span class=\"m\">24</span>,<span class=\"w\"> </span><span class=\"m\">32</span><span class=\"o\">]</span>\n\nTesting<span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">32</span>.05s\nTesting<span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">19</span>.62s\nTesting<span class=\"w\"> </span><span class=\"m\">4</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">13</span>.99s\nTesting<span class=\"w\"> </span><span class=\"m\">6</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">14</span>.92s\nTesting<span class=\"w\"> </span><span class=\"m\">8</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">11</span>.90s\nTesting<span class=\"w\"> </span><span class=\"m\">12</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">11</span>.73s\nTesting<span class=\"w\"> </span><span class=\"m\">16</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">14</span>.08s\nTesting<span class=\"w\"> </span><span class=\"m\">24</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">11</span>.53s\nTesting<span class=\"w\"> </span><span class=\"m\">32</span><span class=\"w\"> </span>threads...<span class=\"w\"> </span><span class=\"m\">12</span>.26s\n\nResults:\n<span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">32</span>.05s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">2</span>.78x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">2</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">19</span>.62s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.70x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">4</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">13</span>.99s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.21x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">6</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">14</span>.92s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.29x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">8</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">11</span>.90s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.03x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">12</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">11</span>.73s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.02x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">16</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">14</span>.08s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.22x<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">24</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">11</span>.53s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.00x<span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span>best<span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"m\">32</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">12</span>.26s<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">1</span>.06x<span class=\"o\">)</span>\n\nOptimal<span class=\"w\"> </span>thread<span class=\"w\"> </span>count:<span class=\"w\"> </span><span class=\"m\">24</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">11</span>.53s<span class=\"o\">)</span>\nSpeedup<span class=\"w\"> </span>vs<span class=\"w\"> </span><span class=\"m\">32</span><span class=\"w\"> </span>threads:<span class=\"w\"> </span><span class=\"m\">1</span>.1x\n</code></pre></div>\n<p>which is better! But still a bit behind the M4 Pro. (The M4 Pro has a bit more memory, though.)</p>\n<p>I'm not sure if it's possible for leangz to do anything about antimalware on windows, though. It's not the first case in which dealing with the cache (or other similar things) has been annoying on this machine due to windows defender, and it seems like this just has to be dealt with locally. <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span></p>\n<p>(Aside for anyone else with a windows machine: maybe it's worth setting up a <a href=\"http://learn.microsoft.com/en-us/windows/dev-drive/\">dev drive</a>, since apparently there's a windows defender setting which allows it to run asynchronously on dev drives, such that it doesn't interrupt operations like this...?)</p>",
        "id": 562855829,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1765339739
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"687698\">@Chris Henson</span> I'm quite impressed by your sub-3-second times! <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span> Do you mind if I ask how much memory that machine has? I'm wondering how big a factor that is here.</p>",
        "id": 562857096,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1765340466
    },
    {
        "content": "<p>It is 96GB, you're probably right about that being significant.</p>",
        "id": 562859300,
        "sender_full_name": "Chris Henson",
        "timestamp": 1765341494
    }
]