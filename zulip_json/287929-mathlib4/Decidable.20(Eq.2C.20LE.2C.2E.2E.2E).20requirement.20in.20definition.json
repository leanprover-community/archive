[
    {
        "content": "<p>In <a href=\"https://github.com/leanprover-community/mathlib4/pull/27055\">#27055</a>, <span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> brought up a good point about requiring Decidability for definition (and also recommended me creating this thread). My original code looked like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">coeff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">PartialOrder</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">â‰¤</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>and the suggestion was to remove <code>open Classical</code> in and adding <code>[DecidableLE G]</code>, because for some <code>G</code> this could be decidable and we don't want to use the classical instance on them. This makes sense to me. I'd like to understand a more general guideline similar to this, as there are other existing definitions that doesn't seem to follow this logic (e.g. <code>HahnSeries.single</code>). </p>\n<p>My current understanding is: if the <code>if</code> condition involves generic types that could make it decidable, then the decidability should be put in parameters and let downstream user decide whether to use classical or provide decidable types. If the <code>if</code> condition involves a more concrete type that is not likely going to be decidable in most cases, then one should open classical in the definition. Does this sound about right?</p>\n<p>And perhaps we can add related guideline in <a href=\"https://leanprover-community.github.io/contribute/style.html\">https://leanprover-community.github.io/contribute/style.html</a> ?</p>",
        "id": 531709058,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1753827725
    },
    {
        "content": "<p>Just to say that I am not confident that <code>open Classical in</code> will cause problems, but my instinct is that <code>[DecidableLE]</code> will not cause problems in the definition; it will however cause problems for mathemtical users of the definition in that they'll have to supply some mathematically spurious hypothesis.</p>",
        "id": 531776113,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1753862804
    }
]