[
    {
        "content": "<p>I just made a PR to split up <code>Analysis/Calculus/FDeriv/Basic.lean</code> (<a href=\"https://github.com/leanprover-community/mathlib4/pull/25207\">#25207</a>), since the file is perilously close to the 1500-line limit and one of my under-review PR's would push it over.</p>\n<p>For some reason the file-split PR is failing CI with a linter warning in some completely unrelated code:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">specified</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"c1\">-- Found 1 error in 252888 declarations (plus 546163 automatically generated ones) in Mathlib with 15 linters</span>\n<span class=\"c\">/-</span><span class=\"cm\"> The `unusedHavesSuffices` linter reports:</span>\n<span class=\"cm\">THE FOLLOWING DECLARATIONS HAVE INEFFECTUAL TERM MODE HAVE/SUFFICES BLOCKS. In the case of `have` this is a term of the form `have h := foo, bar` where `bar` does not refer to `foo`. Such statements have no effect on the generated proof, and can just be replaced by `bar`, in addition to being ineffectual, they may make unnecessary assumptions in proofs appear as if they are used. For `suffices` this is a term of the form `suffices h : foo, proof_of_goal, proof_of_foo` where `proof_of_goal` does not refer to `foo`. Such statements have no effect on the generated proof, and can just be replaced by `proof_of_goal`, in addition to being ineffectual, they may make unnecessary assumptions in proofs appear as if they are used. -/</span>\n<span class=\"c1\">-- Mathlib.Analysis.Complex.Angle</span>\n<span class=\"n\">Error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">actions</span><span class=\"bp\">-</span><span class=\"n\">runner</span><span class=\"bp\">/_</span><span class=\"n\">work</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Analysis</span><span class=\"bp\">/</span><span class=\"n\">Complex</span><span class=\"bp\">/</span><span class=\"n\">Angle</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">33</span><span class=\"o\">:</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">angle_eq_abs_arg</span><span class=\"w\"> </span><span class=\"n\">unnecessary</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"n\">y</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"bp\">≠</span>\n<span class=\"w\">  </span><span class=\"mi\">0</span>\n</code></pre></div>\n<p>Of course it is trivial to fix this, and I have pushed a one-line fix to that PR, but I am puzzled why I am seeing this build failure as part of CI for a completely unrelated PR – did some failing code somehow get merged into master, or does my PR somehow randomly perturb stuff downstream (maybe changing which simp lemmas get used) that exposes the error somehow?</p>",
        "id": 520440865,
        "sender_full_name": "David Loeffler",
        "timestamp": 1748262936
    },
    {
        "content": "<p>Probably what happened is that some simp call was using the unnecessary hypothesis previously, and is not using it after your change because it perturbed the discr tree for simp lemmas</p>",
        "id": 520442206,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1748263289
    },
    {
        "content": "<p>Fair enough! I am surprised that splitting one big file into several smaller ones would have that effect, but the workings of the simplifier are a mystery to me</p>",
        "id": 520442546,
        "sender_full_name": "David Loeffler",
        "timestamp": 1748263368
    },
    {
        "content": "<p>If you want to chase this up further I guess you could squeeze the simp before and after and see if you get different answers.</p>",
        "id": 520450741,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1748265437
    },
    {
        "content": "<p>TBH I just want to stop the long-file-linter blocking me from getting my modular forms PR's reviewed; I'm not particularly motivated to chase it up any more than necessary.</p>",
        "id": 520453320,
        "sender_full_name": "David Loeffler",
        "timestamp": 1748266081
    }
]