[
    {
        "content": "<p>So, I'm running into a bit of an issue regarding outstanding technical debt in Mathlib's handling of Ideals...</p>\n<ul>\n<li><code>Ideal</code> itself is defined in a very general way, with only sufficient structure and assumptions to represent left ideals of semirings. </li>\n<li>However, most of the actual API interfacing with <code>Ideal</code> assumes not only <code>Ring</code> but in fact <code>CommRing</code>. </li>\n<li><code>RingQuot</code> permits noncommutative semirings, but implicitly builds two-sidedness into its definition.</li>\n<li>As such, all existing methods of making ring quotients are less general than the original definition of <code>Ideal</code>, as well as the the level at which <code>TensorProduct</code>, <code>PiTensorProduct</code>, and now <code>FreeProduct</code>, among others, are written.</li>\n<li>Worse, they're less general in different directions, there is no simple 'inclusion' hierarchy here.</li>\n</ul>",
        "id": 456926247,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722968736
    },
    {
        "content": "<p>I had originally thought proving the equivalence between <code>FreeProduct</code> and <code>PiTensorProduct</code> in the case of commutative (semi)rings would be easy, but in fact it has been quite difficult in part for this reason. I'm not entirely sure where I should go from here as a result.</p>",
        "id": 456926257,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722968739
    },
    {
        "content": "<p>See also <a href=\"https://github.com/orgs/leanprover-community/projects/11\">https://github.com/orgs/leanprover-community/projects/11</a> . This is all basically my fault; I wanted to get started on commutative algebra in 2017 when there were literally 0 people in the Lean community interested in noncommutative ring theory (there were only about 40 people in the Lean community in total, and most of them were computer scientists), so we just developed a bunch of theory for commutative rings (in order to define schemes) and then others built on that.</p>",
        "id": 456926798,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722968887
    },
    {
        "content": "<p>ooof.</p>",
        "id": 456926828,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722968896
    },
    {
        "content": "<p>Note: we are currently in a period of transition regarding ideals in non-commutative rings. We have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=TwoSidedIdeal#doc\">docs#TwoSidedIdeal</a> now, but the API is still under development.</p>",
        "id": 456926862,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722968913
    },
    {
        "content": "<p>Speaking as a physicist who is mostly interested in noncommutative operator algebras, that's very unfortunate for me personally :p.</p>",
        "id": 456926904,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722968921
    },
    {
        "content": "<p>Well, look at it from the bright side</p>",
        "id": 456927021,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1722968955
    },
    {
        "content": "<p>Now there's a cool project for you to work on!</p>",
        "id": 456927095,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1722968971
    },
    {
        "content": "<p>Fear not <span class=\"user-mention silent\" data-user-id=\"359992\">Robert Maxton</span> , I'm a C⋆-algebraist, and there are a few people working hard to fix this and other issues. Note that we now have the <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ContinuousFunctionalCalculus#doc\">docs#ContinuousFunctionalCalculus</a>, and we're making good progress in many directions.</p>",
        "id": 456927251,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722969008
    },
    {
        "content": "<p>For RingQuot if you want to quotient out by a left ideal you could just quotient out by the corresponding additive subgroup, the quotient won't be a ring if the ideal isn't a 2-sided ideal, right? The quotient is probably even an R-module I would imagine.</p>",
        "id": 456927279,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722969014
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"197836\">@Jireh Loreaux</span>  Oh good!</p>",
        "id": 456927362,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722969033
    },
    {
        "content": "<p>That being said, we'd definitely love your help, if you're willing to get involved!</p>",
        "id": 456927434,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722969055
    },
    {
        "content": "<p>In fact I'm a bit confused about what you're talking about above, if you quotient out a ring by an ideal which isn't two-sided then you don't get a quotient ring, so all existing methods of making ring quotients won't apply mathematically because they'll give you rings.</p>",
        "id": 456927465,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722969068
    },
    {
        "content": "<p>Kevin, I think Robert's point is that we don't currently have anyway to build a <code>Ring</code> instance on the quotient of a (non-commutative) ring by a two-sided ideal, but of course that's something we're working on now.</p>",
        "id": 456927689,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722969155
    },
    {
        "content": "<p>Oh ok, but this is on the way! I would imagine that the people working on Brauer groups have this already and are slowly porting it over.</p>",
        "id": 456927768,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722969194
    },
    {
        "content": "<p>Yeah, two-sided ideals are quite new.</p>",
        "id": 456927813,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722969218
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> so actually I'm writing up my List of Approaches </p>\n<ul>\n<li>I could ignore the problem, write a third competing quotient structure at the appropriate level of generality, and use that to provide the proof and the isomorphism theorems. This seems obviously Bad, as it increases the technical debt further while kicking the problem down the road.</li>\n<li>I could simply restrict my concern to two sided ideals. For actual <code>Ring</code>s, this is fine, but for <code>Semiring</code>s this is very not fine; while losing subtraction introduces other conditions on what counts as a subobject beyond \"ideal\", two-sidedness falls away, so I'd end up writing a fairly unnatural API.</li>\n<li>I could try and refactor <code>RingQuot</code> so that it produces left ideals. I think <code>RingQuot.lean</code> itself would be fairly easy to refactor in this way, but I have no idea how widely <code>RingQuot</code> is used in Mathlib, so this might turn into a particularly dramatic bit of yak shaving.</li>\n<li>I could focus on <code>Ring</code>s to the exclusion of <code>Semiring</code>s entirely. This seems somewhat reasonable, though there are a number of useful applications of <code>Semiring</code>s even already, but seems like it could very much end up turning into approach 1, i.e. adding technical debt to Mathlib and departing even further from the path of \"correct level of generality\".</li>\n</ul>",
        "id": 456927863,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722969241
    },
    {
        "content": "<p>Hmm... now it seems my assessment above of your desires may have been incorrect? <br>\n<span class=\"user-mention silent\" data-user-id=\"359992\">Robert Maxton</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Ideal.20and.20RingQuot/near/456927863\">said</a>:</p>\n<blockquote>\n<ul>\n<li>I could focus on <code>Ring</code>s to the exclusion of <code>Semiring</code>s entirely.</li>\n</ul>\n</blockquote>\n<p>As far as ideals go, I would advocate for this. Despite the fact that useful <code>Semiring</code>s exist, I'm not so sure how useful their ideal structure (or worse: quotients) actually ends up begin.</p>",
        "id": 456928376,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722969446
    },
    {
        "content": "<p>I mean, there's the thing I actually want to work on in the end, which is probably going to involve quite a lot of category theory/Grothendieck sieves and noncommutative algebra and would benefit from both<br>\nbut as the specific thing I would like to work on is self-admittedly pretty specific, I would prefer to do things in a way that would be generally useful to Mathlib rather than leaving a trail of overly-narrow libraries built in a straight line between me and my actual project :p</p>",
        "id": 456928715,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722969588
    },
    {
        "content": "<p>If R is a (non-commutative) ring then to give a surjection R -&gt; A of rings up to isomorphism is to give its kernel, which is a two-sided ideal. But in the semiring case there are more quotients than there are two-sided ideals, e.g. there's an obvious surjection from the naturals to the semiring {0,1,2,3} with a+b and a*b defined to be the right answer if it's &lt; 3, and 3 otherwise (i.e. 3=\"overflow\") and this map has trivial kernel in the sense that only 0 gets mapped to 0. So two-sided ideals don't tell the full story of quotients in the semiring case. In the presence of negation this phenomenon doesn't happen.</p>",
        "id": 456928802,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722969610
    },
    {
        "content": "<p>Robert, sure, and that's appreciated. But in this case, if all you (personally) care about is quotients of non-commutative <code>Ring</code>s (or <code>NonUnitalRing</code>s) by <code>TwoSidedIdeal</code>s, then that's already an appropriate level of generality, and hopefully we'll have all that working soon.</p>",
        "id": 456929195,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722969779
    },
    {
        "content": "<p>In particular I don't understand what you mean by \"I could try and refactor <code>RingQuot</code> so that it produces left ideals\". I am still confused about what you actually <em>want</em> at this point, I see your list of approaches but I don't know what you're approaching yet. Can you write some concrete Lean code indicating something which you want which isn't there yet?</p>",
        "id": 456929235,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722969796
    },
    {
        "content": "<p>If you're interested in contributing things though, we can definitely coordinate to find something useful!</p>",
        "id": 456929315,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722969835
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Ideal.20and.20RingQuot/near/456928802\">said</a>:</p>\n<blockquote>\n<p>So two-sided ideals don't tell the full story of quotients in the semiring case. In the presence of negation this phenomenon doesn't happen.</p>\n</blockquote>\n<p>Yeah, I ended up having to go track down a textbook on <code>Semiring</code>s and it seems it boils down to \"being a kernel is not sufficient, you need to be a kernel of a particularly 'nice') (Golan calls them 'tame') semiring hom<br>\nA category theorist would probably say something like \"<strong>SRing</strong> has 'fewer' epis than <strong>Ring</strong>, so the natural choice of quotient and subobject for a given arrow is similarly unfamiliar\"</p>",
        "id": 456929804,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722970042
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Ideal.20and.20RingQuot/near/456929235\">said</a>:</p>\n<blockquote>\n<p>In particular I don't understand what you mean by \"I could try and refactor <code>RingQuot</code> so that it produces left ideals\". I am still confused about what you actually <em>want</em> at this point, I see your list of approaches but I don't know what you're approaching yet. Can you write some concrete Lean code indicating something which you want which isn't there yet?</p>\n</blockquote>\n<p>Specifically, I recently contributed <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=LinearAlgebra.FreeProduct#doc\">docs#LinearAlgebra.FreeProduct</a> , and one of the TODOs left is to show that when dealing with commutative (semi)rings the free product reduces to <code>PiTensorProduct</code></p>",
        "id": 456929937,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722970095
    },
    {
        "content": "<p>And since <code>FreeProduct</code> and <code>PiTensorProduct</code> are both written for <code>Semiring</code>s I would kinda prefer to write the equivalence for <code>Semiring</code>s as well, but doing so without a robust quotient API has turned out to be a pain in its own right</p>",
        "id": 456930028,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722970146
    },
    {
        "content": "<p>(The issue is that <code>PiTensorProduct</code> doesn't actually have its universal property implemented, which I would rather like to fix as well -- <code>PiTensorProduct</code> will let you lift a <code>MultilinearMap</code> to the tensor product, but it won't work from an indexed family of <code>LinearMap</code>s, never mind an indexed family of <code>AlgHom</code>s)</p>",
        "id": 456930251,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722970227
    },
    {
        "content": "<p>(Which, to be fair, it's not actually the categorical coproduct/neither of those lifts even exist except in the presence of a <code>CommRing R</code> instance, but)</p>",
        "id": 456930462,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722970318
    },
    {
        "content": "<p>Where do left-ideals feature in writing down this equivalence?</p>",
        "id": 456931023,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722970547
    },
    {
        "content": "<p>Good question. I have in fact gotten pretty far afield in my yak-shaving, huh.</p>",
        "id": 456931435,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722970724
    },
    {
        "content": "<p>Just looking at PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/14858\">#14858</a> now. One answer to the question \"why is <code>lift</code> slow\" is \"you use <code>aesop</code> twice and non-squeezed simps twice\".  You get a 30% speedup by changing all of them to the relevant <code>simp only</code> calls. But it's still annoyingly slow even after those changes.</p>",
        "id": 456931877,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722970854
    },
    {
        "content": "<p>Basically, whether my approach is to first construct the relevant universal-coproduct API and then prove the equivalence or just build a special case into my proof, either way I'll probably want to reduce things down to <code>DirectSum</code>, which is the \"previous\" coproduct in the hierarchy and the last one that has a proper coproduct-lift defined. (It has a few features for the <code>DirectSum</code> of <code>Ring</code>s and <code>Algebra</code>s, but they're all written assuming a graded structure that doesn't apply in general).</p>",
        "id": 456931888,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722970855
    },
    {
        "content": "<p>(As a side note, I should really remove the \"same as <code>FreeAlgebra</code> from the TODOs, it's not actually <em>true</em> because <code>FreeProduct</code> imposes some extra substructure on the sum type.)</p>",
        "id": 456932151,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722970934
    },
    {
        "content": "<p>Unfortunately, by definition <code>DirectSum</code> involves finitely supported functions, and <code>PiTensorProduct</code> does not have such a requirement. While any given element of the tensor product is still a sum of finitely many terms, each term is an infinite product over potentially a proper class, and to be honest my math chops aren't quite up to figuring out how to handle that directly yet :v. </p>\n<p>The easiest method of glossing over the various issues with infinities is probably to stick to a categorical approach all the way through, focusing on families of arrows and functional properties without getting bogged down into the details of what the terms are doing. (Nothing in <code>PiTensorProduct</code> is computable anyway lol.) As such, my current approach is to attempt to prove </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">RingHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⨂</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⨆</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">RingHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">))</span>\n</code></pre></div>\n<p>which I believe directly implies that <code>PiTensorProduct</code> is indeed the categorical coproduct once you assume commutativity</p>",
        "id": 456933411,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722971310
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"359992\">Robert Maxton</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Ideal.20and.20RingQuot/near/456932151\">said</a>:</p>\n<blockquote>\n<p>(As a side note, I should really remove the \"same as <code>FreeAlgebra</code> from the TODOs, it's not actually <em>true</em> because <code>FreeProduct</code> imposes some extra substructure on the sum type.)</p>\n</blockquote>\n<p>That would be a nice short easily-reviewable PR.</p>",
        "id": 456933476,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722971333
    },
    {
        "content": "<p>Sure. And while I'm at it, should I fix the <code>aesop</code>s or do that in a separate PR?</p>",
        "id": 456933610,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722971377
    },
    {
        "content": "<blockquote>\n<p>which I believe directly implies that <code>PiTensorProduct</code> is indeed the categorical coproduct once you assume commutativity</p>\n</blockquote>\n<p>Which lets me write </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">liftAlgHom'</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">i</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Decidable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommSemiring</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]:</span>\n<span class=\"w\">  </span><span class=\"o\">(⦃</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"o\">⦄</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">→ₐ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">≃</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"bp\">⨂</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→ₐ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n</code></pre></div>",
        "id": 456933746,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722971409
    },
    {
        "content": "<p>Once I have that it's easy, because <code>FreeProduct</code> already has its <code>lift</code> defined, so I can just <code>lift</code> the identity going both ways and call it a day. (Which is basically just the Lean-formalized version of \"categorical coproducts are unique up to isomorphism\" anyway)</p>",
        "id": 456933969,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722971487
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"359992\">Robert Maxton</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Ideal.20and.20RingQuot/near/456933411\">said</a>:</p>\n<blockquote>\n<p>(Nothing in <code>PiTensorProduct</code> is computable anyway lol.)</p>\n</blockquote>\n<p>I think this is just because the Lean compiler is silly and sends itself on a wild goose chase (which does eventually conclude). For now we don't actually care about the computation, so we told it not to waste that time.</p>",
        "id": 456934475,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722971640
    },
    {
        "content": "<p>I would guess the right approach here is just to build the appropriate universal properties in each direction, and then the isomorphism will follow without much work</p>",
        "id": 456934656,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722971685
    },
    {
        "content": "<p>Well, yes. The issue is making the universal property for <code>PiTensorProduct</code>.</p>\n<p>... Though, now that I think about it, my problem was in part \"ugh all the <code>Ideal</code> and <code>ker</code> stuff is written for commutative rings\", but actually I'm <em>in</em> a commutative setting right now... Oh, but it also assumes actual <code>Ring</code>s and not just <code>Semiring</code>s, so I'd still be narrowing from my original PR if I used most of it.</p>",
        "id": 456934948,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722971770
    },
    {
        "content": "<p>OK so my understanding of your issue is the following: you would like to write down an R-algebra isomorphism between <code>LinearAlgebra.FreeProduct R A</code> and <code>PiTensorProduct R A</code>. If they are isomorphic then I'm a bit confused about why we want <code>LinearAlgebra.FreeProduct</code> at all, given that we have a semiring structure on <code>PiTensorProduct R A</code> if <code>A</code> is taking values in semirings, and we also have the R-algebra structure in <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PiTensorProduct.instAlgebra#doc\">docs#PiTensorProduct.instAlgebra</a> . What is the maths proof that they're isomorphic? And if they are isomorphic, why did you want to make <code>FreeProduct</code> at all?</p>",
        "id": 456935587,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722971904
    },
    {
        "content": "<p>They are isomorphic in the presence of <code>[CommRing R]</code>; they are distinct if <code>R</code> is not commutative</p>",
        "id": 456936538,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722972130
    },
    {
        "content": "<p>I made <code>FreeProduct</code> as step one in filling in <code>CategoryTheory/Ring/FilteredColimits.lean</code> and <code>CategoryTheory/Algebra/FilteredColimits.lean</code>, neither of which actually exist yet and whose absence I came across while trying to use Lean to help teach myself category theory</p>",
        "id": 456936822,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722972188
    },
    {
        "content": "<p>I don't understand -- both <code>FreeProduct</code> and <code>PiTensorProduct</code> require commutativity of <code>R</code> so \"they are distinct if R is not commutative\" seems like a meaningless statement. I am still confused about a precise statement of something you want which we don't currently have, and also confused about why <code>FreeProduct</code> exists at all.</p>",
        "id": 456937190,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722972262
    },
    {
        "content": "<p>.... Sorry, I got my letters mixed up. They are distinct if the <code>A i</code> are not commutative, not <code>R</code>!</p>",
        "id": 456937624,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722972366
    },
    {
        "content": "<p>Furthermore, neither of the files you mention above seem to exist.</p>",
        "id": 456937649,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722972372
    },
    {
        "content": "<p>Aah OK so perhaps I finally understand something: you want to prove </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">FreeProduct</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommSemiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">CommSemiring</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)]</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">FreeProduct</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">≃ₗ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">PiTensorProduct</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>?</p>",
        "id": 456938215,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722972500
    },
    {
        "content": "<p>And yeah, I mentioned that :p. I don't even remember what I was trying to study at the time, but I noticed that we didn't have a proof that <code>RingCat</code> and <code>AlgebraCat</code> are cocomplete or even have all filtered colimits, so I decided to fill in that gap. The relevant proofs are relatively straightforward and even close to boilerplate, as the exact same technique works for reducing all the way down to from <code>AlgebraCat</code>, through <code>ModuleCat</code>, down to <code>Type</code></p>",
        "id": 456938432,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722972538
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Ideal.20and.20RingQuot/near/456938215\">said</a>:</p>\n<blockquote>\n<p>Aah OK so perhaps I finally understand something: you want to prove </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">FreeProduct</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommSemiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">CommSemiring</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)]</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">FreeProduct</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">≃ₗ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">PiTensorProduct</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>?</p>\n</blockquote>\n<p>Yes, at least that's my immediate goal for now!</p>",
        "id": 456938455,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722972550
    },
    {
        "content": "<p>I find it much easier to understand if people state what they're trying to do in Lean, rather than in words.</p>",
        "id": 456938501,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722972575
    },
    {
        "content": "<blockquote>\n<p>Yes, at least that's my immediate goal for now!</p>\n</blockquote>\n<p>And what's the maths proof? And what's the problem stopping you from solving this goal in Lean?</p>",
        "id": 456938828,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722972652
    },
    {
        "content": "<p>The maths proof is that <code>FreeProduct R A</code> is the universal coproduct in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span><strong>-Alg</strong> unconditionally, and <code>PiTensorProduct</code> is the universal coproduct in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span><strong>-CAlg</strong> or however you want to refer to the category-of-commutative-<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>-algebras, and universal objects are unique up to isomorphism, QED</p>",
        "id": 456939087,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722972767
    },
    {
        "content": "<p>I don't follow that proof. The universal properties are different in the two categories.</p>",
        "id": 456939155,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722972804
    },
    {
        "content": "<p>Sure, but <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span><strong>-CAlg</strong> is a full subcategory of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span><strong>-Alg</strong>, so <code>FreeProduct R A</code> can validly lift arrows in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span><strong>-CAlg</strong></p>",
        "id": 456939418,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722972897
    },
    {
        "content": "<p>I don't even see why <code>FreeProduct R A</code> is commutative if all the <code>A i</code> are.</p>",
        "id": 456939584,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722972941
    },
    {
        "content": "<p>Surely the free product of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\R[x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi><mo stretchy=\"false\">[</mo><mi>y</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\R[y]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">]</span></span></span></span> over <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">R</span></span></span></span> is a polynomial ring in two non-commuting variables, and the PiTensorProduct is a polynomial ring in two commuting variables?</p>",
        "id": 456939875,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722973004
    },
    {
        "content": "<p>No, because the tensor product itself is only commutative up to isomorphism; matrices aren't equal to their transposes</p>",
        "id": 456940278,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722973110
    },
    {
        "content": "<p>But yes, the underlying structure (especially as implemented in Lean) is pretty different, so I think working through the nuts and bolts of what the isomorphism is doing to each element would be correspondingly difficult.</p>",
        "id": 456940474,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722973157
    },
    {
        "content": "<p>I need to go now but I'm still very confused. I don't know what matrices have to do with anything.</p>",
        "id": 456940561,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722973180
    },
    {
        "content": "<p>Are you claiming that the free product of the one-variable polynomial rings  <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\R[x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi><mo stretchy=\"false\">[</mo><mi>y</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\R[y]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">]</span></span></span></span> over <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">R</span></span></span></span> is commutative?</p>",
        "id": 456940739,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722973220
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Ideal.20and.20RingQuot/near/456940561\">said</a>:</p>\n<blockquote>\n<p>I need to go now but I'm still very confused. I don't know what matrices have to do with anything.</p>\n</blockquote>\n<p>Just an example. Every entry in a matrix represents a component of the form <code>a ⨂ b</code>, and trying to commute the tensor product would send every such entry to <code>b ⨂ a</code>, i.e. transposing the matrix; but matrices aren't equal to their transposes even though taking the transpose is an isomorphism, so the tensor product isn't commutative, so <code>PiTensorProduct</code> is a polynomial ring in two <em>noncommuting</em> variables, I believe.</p>",
        "id": 456941235,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722973339
    },
    {
        "content": "<p>So what do you make of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PiTensorProduct.instCommRing#doc\">docs#PiTensorProduct.instCommRing</a> ?</p>",
        "id": 456941565,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722973450
    },
    {
        "content": "<p>You claimed above that <code>PiTensorProduct</code> is the universal coproduct in the category of commutative R-algebras and hence surely it is a commutative R-algebra?</p>",
        "id": 456941678,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722973500
    },
    {
        "content": "<p>The polynomial ring as a whole has quite a lot of symmetry built into its operations, so multiplication is commutative<br>\nSo we have <code>∀ (a b : A₁ ⨂ A₂), a * b = b * a</code>, even though \"under the hood\", each of those elements are written as sums of noncommuting products</p>",
        "id": 456941882,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722973582
    },
    {
        "content": "<p>Basically, I'm arguing that \"<code>PiTensorProduct</code> is a commutative algebra built out of fundamentally noncommutative components, so it shouldn't surprise us that <code>FreeProduct R A</code> can be the same.\"</p>",
        "id": 456942204,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722973764
    },
    {
        "content": "<p>Which is not a proof, the actual proof is the categorical argument I outlined earlier</p>",
        "id": 456942220,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722973774
    },
    {
        "content": "<p>here, actually...</p>",
        "id": 456942390,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722973844
    },
    {
        "content": "<p>Mm, my current Mathlib environment isn't in a convenient place for this, so this is just psuedocode, but</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">FreeProduct</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">≃ₐ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">PiTensorProduct</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨</span><span class=\"w\"> </span><span class=\"n\">lift</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">AlgEquiv</span><span class=\"bp\">.</span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PiTensorProduct</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)),</span>\n<span class=\"w\">    </span><span class=\"n\">PiTensorProduct</span><span class=\"bp\">.</span><span class=\"n\">liftAlgHom'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">AlgEquiv</span><span class=\"bp\">.</span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeProduct</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)),</span>\n<span class=\"w\">    </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"bp\">⟩</span>\n</code></pre></div>",
        "id": 456943130,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722974164
    },
    {
        "content": "<p>Something like this is probably going to be the full proof when I'm done</p>",
        "id": 456943151,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722974173
    },
    {
        "content": "<p>And the fundmantal issue is that <code>PiTensorProduct.liftAlgHom'</code> doesn't exist yet</p>",
        "id": 456943194,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722974198
    },
    {
        "content": "<p>you can always just use the live environment temporarily. Just click the button in the top right of the code block you just wrote.</p>",
        "id": 456943244,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1722974222
    },
    {
        "content": "<p>Good thought. Here, it \"works\" other than the missing function</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">FreeProduct</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">PiTensorProduct</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">RingTheory</span><span class=\"bp\">.</span><span class=\"n\">PiTensorProduct</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Equiv</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">LinearAlgebra</span><span class=\"w\"> </span><span class=\"n\">FreeProduct</span><span class=\"w\"> </span><span class=\"n\">PiTensorProduct</span><span class=\"w\"> </span><span class=\"n\">TensorProduct</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_3</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_4</span><span class=\"o\">}</span>\n<span class=\"w\">         </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)]</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">equivPiTensorProduct</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeProduct</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">≃ₐ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⨂</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\">  </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨</span><span class=\"w\"> </span><span class=\"n\">FreeProduct</span><span class=\"bp\">.</span><span class=\"n\">lift</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">i</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">PiTensorProduct</span><span class=\"bp\">.</span><span class=\"n\">singleAlgHom</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">),</span>\n<span class=\"w\">    </span><span class=\"n\">PiTensorProduct</span><span class=\"bp\">.</span><span class=\"n\">liftAlgHom'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">i</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">FreeProduct</span><span class=\"bp\">.</span><span class=\"n\">ι</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">),</span>\n<span class=\"w\">    </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"bp\">⟩</span>\n</code></pre></div>",
        "id": 456945829,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722975014
    },
    {
        "content": "<p>Basically, once you have two objects that can both validly lift the same morphisms in a way that makes all diagrams commute, then you can just lift each others' canonical injections</p>",
        "id": 456945994,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722975062
    },
    {
        "content": "<p>At which point you have your isomorphism</p>",
        "id": 456946018,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722975069
    },
    {
        "content": "<p>Which is the Lean version of \"universal objects are unique\"</p>",
        "id": 456946045,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722975080
    },
    {
        "content": "<p>You'd do better to go via <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AlgEquiv.ofAlgHom#doc\">docs#AlgEquiv.ofAlgHom</a>, because then <code>ext</code> can take you home for the sorries</p>",
        "id": 456946417,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722975189
    },
    {
        "content": "<p>Ah, yes, that's what I meant to use rather than the anonymous constructor. Thanks though.</p>",
        "id": 456946516,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722975225
    },
    {
        "content": "<p>You might find a couple <code>ext</code> lemmas are missing too: you can usually recover them from an <code>Injective</code> lemma about the universal property (if you didn't end up proving them first)</p>",
        "id": 456947101,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722975392
    },
    {
        "content": "<p>So how are you dealing with my claim that the free product of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\R[x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi><mo stretchy=\"false\">[</mo><mi>y</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\R[y]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">]</span></span></span></span> is not commutative, but the tensor product is, and hence they can't be isomorphic?</p>",
        "id": 456953465,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722977543
    },
    {
        "content": "<p>In my current mental model, the free product is the vector space with basis <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>x</mi><mi>x</mi><mo separator=\"true\">,</mo><mi>x</mi><mi>y</mi><mo separator=\"true\">,</mo><mi>y</mi><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mi>y</mi><mo separator=\"true\">,</mo><mi>x</mi><mi>x</mi><mi>x</mi><mo separator=\"true\">,</mo><mi>x</mi><mi>x</mi><mi>y</mi><mo separator=\"true\">,</mo><mi>x</mi><mi>y</mi><mi>x</mi><mo separator=\"true\">,</mo><mi>x</mi><mi>y</mi><mi>y</mi><mo separator=\"true\">,</mo><mi>y</mi><mi>x</mi><mi>x</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">1,x,y,xx,xy,yx,yy,xxx,xxy,xyx,xyy,yxx,...</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">xx</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">yy</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">xxx</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">xx</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">yy</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord mathnormal\">xx</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span></span></span></span> and the tensor product is the vector space with basis <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>x</mi><mi>x</mi><mo separator=\"true\">,</mo><mi>x</mi><mi>y</mi><mo separator=\"true\">,</mo><mi>y</mi><mi>y</mi><mo separator=\"true\">,</mo><mi>x</mi><mi>x</mi><mi>x</mi><mo separator=\"true\">,</mo><mi>x</mi><mi>x</mi><mi>y</mi><mo separator=\"true\">,</mo><mi>x</mi><mi>y</mi><mi>y</mi><mo separator=\"true\">,</mo><mi>y</mi><mi>y</mi><mi>y</mi><mo separator=\"true\">,</mo><mi>x</mi><mi>x</mi><mi>x</mi><mi>x</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">1,x,y,xx,xy,yy,xxx,xxy,xyy,yyy,xxxx,...</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">xx</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">yy</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">xxx</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">xx</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">yy</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">yyy</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">xxxx</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span></span></span></span>.</p>",
        "id": 456953752,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722977671
    },
    {
        "content": "<p>My current mental model is that your abstract categorical argument doesn't work because the free product is not even an object of the category of commutative R-algebras, so the universal property of the tensor product in that category tells you nothing about the free product (because it can't be applied to the free product).</p>",
        "id": 456954739,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722978072
    },
    {
        "content": "<p>Mm.</p>",
        "id": 456973823,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722985789
    },
    {
        "content": "<p>I think you're right.</p>",
        "id": 456973871,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722985805
    },
    {
        "content": "<p>I thought I had a diagrammatic argument, but upon reflection all it actually demonstrates is that there's some nice subobject inside the free product that has a hom from the tensor product</p>",
        "id": 456973935,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722985859
    },
    {
        "content": "<p>Which we already knew, it's the subring of polynomials symmetric under permutation of terms of the same degrees in each component algebra</p>",
        "id": 456974106,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1722985987
    },
    {
        "content": "<p>Could you summary your plan? There's an obvious definition of the equivalence relations that give rise to quotient (semi) rings (just be compatible with + and *) and then you just take the quotient type, which will be a semiring. For rings, these equivalence relations are described by two sided ideals.</p>",
        "id": 457213939,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1723069594
    },
    {
        "content": "<p>I believe it is easy to get this generality, except that one needs a nice API to access the standard quotients (by twosided ideals for rings,  resp ideals fir commutative rings).</p>",
        "id": 457214266,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1723069704
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130609\">Antoine Chambert-Loir</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Ideal.20and.20RingQuot/near/457213939\">said</a>:</p>\n<blockquote>\n<p>There's an obvious definition of the equivalence relations that give rise to quotient (semi) rings (just be compatible with + and *) and then you just take the quotient type, which will be a semiring.</p>\n</blockquote>\n<p>This is precisely <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=RingCon#doc\">docs#RingCon</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=RingCon.Quotient#doc\">docs#RingCon.Quotient</a></p>",
        "id": 457214352,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723069742
    },
    {
        "content": "<p>A model for this already exists in Mathlib for algebras.</p>",
        "id": 457214353,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1723069742
    },
    {
        "content": "<p><code>RingQuot</code> predates <code>RingCon</code>, and the port got in the way before I could finish merging them</p>",
        "id": 457215105,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723069976
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"359992\">Robert Maxton</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Ideal.20and.20RingQuot/near/456974106\">said</a>:</p>\n<blockquote>\n<p>Which we already knew, it's the subring of polynomials symmetric under permutation of terms of the same degrees in each component algebra</p>\n</blockquote>\n<p>If I understand things correctly, that subring is not isomorphic to the polynomial ring except for Q-algebras.</p>",
        "id": 457215114,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1723069980
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Ideal.20and.20RingQuot/near/457215105\">said</a>:</p>\n<blockquote>\n<p><code>RingQuot</code> predates <code>RingCon</code>, and the port got in the way before I could finish merging them</p>\n</blockquote>\n<p>By the way, one also needs a notion of ‘ModuleCon‘.</p>",
        "id": 457215384,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1723070066
    },
    {
        "content": "<p>I claim that's the wrong approach, since you often want a congruence relation that respects multiple modules simultaneously</p>",
        "id": 457215471,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723070103
    },
    {
        "content": "<p>At least, it's the wrong approach if you want to work with quotients. If you want to work with the lattice structure then I agree.</p>",
        "id": 457215519,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723070131
    },
    {
        "content": "<p>I believe <a href=\"https://github.com/leanprover-community/mathlib4/pull/8658\">#8658</a> solves the quotient case, but it's been a while</p>",
        "id": 457215703,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723070190
    },
    {
        "content": "<p>Am I right in understanding that the the issue is the one that you suggest here?<br>\n\"that wouldn't work because a single congruence relation can inherit multiple simultaneous actions\"</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/8658#issuecomment-1862974245\">https://github.com/leanprover-community/mathlib4/pull/8658#issuecomment-1862974245</a></p>",
        "id": 457216134,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1723070354
    },
    {
        "content": "<p>Then a solution could be similar to what's done for localization. One needs some construction of quotient types that work for some action, and one could add a property that it inherits the required <code>SMul</code> actions (if they pass to the quotient), or that it is universal for these.</p>",
        "id": 457216377,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1723070441
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130609\">Antoine Chambert-Loir</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Ideal.20and.20RingQuot/near/457213939\">said</a>:</p>\n<blockquote>\n<p>Could you summary your plan? There's an obvious definition of the equivalence relations that give rise to quotient (semi) rings (just be compatible with + and *) and then you just take the quotient type, which will be a semiring. For rings, these equivalence relations are described by two sided ideals.</p>\n</blockquote>\n<p>Mm... I see, essentially the problem is that only subtractive ideals correspond to a relation with transitivity, but if you focus on an equivalence relation from the beginning the problem is moot. I think partitioning ideals are mooted similarly? </p>\n<p>In that case, I might just use <span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> 's nice  <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=RingCon.Quotient#doc\">docs#RingCon.Quotient</a>. My goal is just to get the isomorphism theorems for rings and semirings; then I'll use those to provide a <code>liftAlgHom</code> for <code>PiTensorProduct</code> as a coproduct in <strong>CRing</strong> /<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span><strong>-CAlg</strong>. The isomorphism isn't actually true so obviously I'll stop there.</p>",
        "id": 459539654,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1723226589
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130609\">Antoine Chambert-Loir</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Ideal.20and.20RingQuot/near/457215114\">said</a>:</p>\n<blockquote>\n<p>If I understand things correctly, that subring is not isomorphic to the polynomial ring except for Q-algebras.</p>\n</blockquote>\n<p>Well, I've been wrong once this thread already :p, but I think this one works? Basically, as <span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span>  said, the tensor product of two algebras <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo separator=\"true\">,</mo><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">A, B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> can be described by sums of terms of the form <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><msubsup><mo>∏</mo><mi>i</mi><mi>n</mi></msubsup><msubsup><mo>∏</mo><mi>j</mi><mi>m</mi></msubsup><msub><mi>a</mi><mi>i</mi></msub><msub><mi>b</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">r \\prod_i^n \\prod_j^m a_i b_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2401em;vertical-align:-0.4358em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∏</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∏</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>∈</mo><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">r \\in R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∀</mi><mi>i</mi><mo>&lt;</mo><mi>n</mi><mo separator=\"true\">,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>∈</mo><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">\\forall i &lt; n, a_i \\in A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.0391em;\"></span><span class=\"mord\">∀</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∀</mi><mi>j</mi><mo>&lt;</mo><mi>m</mi><mo separator=\"true\">,</mo><msub><mi>b</mi><mi>j</mi></msub><mo>∈</mo><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">\\forall j &lt;m, b_j \\in B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\">∀</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>. Meanwhile the free product can be described by sums of words with letters ranging over all <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo separator=\"true\">,</mo><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">A, B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> and again coefficients in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>. </p>\n<p>So, suppose you look at an element <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> of the free product, and you see that for every term <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><msub><mi>a</mi><mn>0</mn></msub><msub><mi>b</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><msub><mi>b</mi><mn>1</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">r a_0 b_0 a_1 a_2 b_1 ...</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span></span></span></span>, if you permute the entries however you like, the resulting term is also present in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> with the same coefficient <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>. I claim that the set of such elements form a subring and that the resulting subring is isomorphic with the tensor product.</p>",
        "id": 459545415,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1723227783
    }
]