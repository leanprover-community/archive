[
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsClosed#doc\">docs#IsClosed</a> is a class, but <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsOpen#doc\">docs#IsOpen</a> is just a def. Should <code>IsOpen</code> be a class?</p>\n<p>The reason I ask is that Antoine has had to articificially use a <code>Fact</code> in <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=RestrictedProduct.isTopologicalRing#doc\">docs#RestrictedProduct.isTopologicalRing</a> to insert the openness of a subring into the typeclass system, which means that now I have to insert <code>Fact</code>s that things are open in <a href=\"https://github.com/leanprover-community/mathlib4/pull/23542\">#23542</a> and David Loeffler has flagged this.</p>\n<p>Of course we could avoid <code>Fact</code>s by demanding not that the sets were open, but that the complements were closed! But I am not sure I want to go down this route! Do topologists have an opinion on whether <code>IsOpen</code> should be a class?</p>",
        "id": 513042955,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744986816
    },
    {
        "content": "<p>How about having <code>B</code> map into <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=TopologicalSpace.Opens#doc\">docs#TopologicalSpace.Opens</a> ?</p>",
        "id": 513043499,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1744987005
    },
    {
        "content": "<p>I don't see how to get this to work. The way RestrictedProduct is set up is</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"c1\">-- subobject type</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">Π</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">SetLike</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">Π</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">}</span>\n</code></pre></div>\n<p>and in the applications <code>S i</code> is things like <code>Submonoid (R i)</code> or <code>Subring (R i)</code>. Hmm, so in fact it could work if there were an <code>OpenSubring</code> structure like the <code>OpenSubgroup</code> structure. We would perhaps need an <code>OpenSetLike</code> class if we went down this route. It would certainly be a far less painful refactor. <span class=\"user-mention\" data-user-id=\"268315\">@Anatole Dedecker</span> I'm guessing you wrote the TODO <a href=\"https://github.com/leanprover-community/mathlib4/blame/dad08fa365650bbf2f7aed844722fea2c735069c/Mathlib/Topology/Algebra/RestrictedProduct.lean#L719\">here</a>; what do you think about this alternative approach?</p>",
        "id": 513047199,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744988400
    },
    {
        "content": "<p>I'll also need <code>S i</code> to be <code>Subalgebra R0 (R i)</code> soon in FLT, so we'll also need <code>OpenSubalgebra</code> with this approach. This feels like something which should really be decoupled rather than encouraged.</p>",
        "id": 513047622,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744988539
    },
    {
        "content": "<p>We already have the original sin of OpenSubgroup so it's hard to say in which direction the slope should be slippery</p>",
        "id": 513049446,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1744989226
    },
    {
        "content": "<p>It seems one has to go either in the direction of <code>IsOpen</code> as a class, or <code>Submonoidal</code> as a class, if one wants to have TC know things like <code>ContinuousMul</code>.</p>",
        "id": 513055359,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1744991335
    },
    {
        "content": "<p><code>IsClosed</code> was changed to be a class to make sure that typeclass inference would notice that the quotient of a normed vector space by a closed subspace is a normed vector space (instead of just pseudo-normed), which is often important. It seems to me that this is the same kind of situation here, so making <code>IsOpen</code> a class looks natural to me.</p>",
        "id": 513055699,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1744991470
    },
    {
        "content": "<p>Yes, here it is the claim that a restricted product of weakly locally compact spaces with respect to open subsets is a weakly locally compact space.</p>",
        "id": 513056924,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744991956
    },
    {
        "content": "<p>Yes, this is precisely what I had in mind when writing the TODO: we will probably want an instance of <code>DiscreteTopology</code> on the quotient by an open subgroup, so we probably want <code>IsOpen</code> as a class anyways.</p>",
        "id": 513057107,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1744992013
    },
    {
        "content": "<p>Arguably <code>OpenSubgroup</code>/<code>OpenSubmodule</code>/... should work as well, but I think that's a lot of trouble for not that many use cases.</p>",
        "id": 513057208,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1744992054
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Should.20IsOpen.20be.20a.20class.3F/near/513042955\">said</a>:</p>\n<blockquote>\n<p>The reason I ask is that Antoine has had to articificially use a <code>Fact</code> in <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=RestrictedProduct.isTopologicalRing#doc\">docs#RestrictedProduct.isTopologicalRing</a> to insert the openness of a subring into the typeclass system, which means that now I have to insert <code>Fact</code>s that things are open in <a href=\"https://github.com/leanprover-community/mathlib4/pull/23542\">#23542</a> and David Loeffler has flagged this.</p>\n</blockquote>\n<p>(Casually learning that I am now called Antoine ! <span aria-label=\"scream\" class=\"emoji emoji-1f631\" role=\"img\" title=\"scream\">:scream:</span>)</p>",
        "id": 513061641,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1744993845
    },
    {
        "content": "<p>isOpen vs IsClosed has been discussed before, possible multiple times. I'm not sure there was a clear decision over keeping it as a class vs wrapping it in Fact</p>",
        "id": 513067117,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744996299
    },
    {
        "content": "<p><a href=\"#narrow/stream/113489-new-members/topic/IsOpen.20vs.2E.20IsClosed/near/416330706\">https://leanprover.zulipchat.com/#narrow/stream/113489-new-members/topic/IsOpen.20vs.2E.20IsClosed/near/416330706</a></p>",
        "id": 513067271,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744996354
    },
    {
        "content": "<p>Apologies Anatole! (I am terrible at names)</p>",
        "id": 513071435,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744998275
    },
    {
        "content": "<p>No worries!</p>",
        "id": 513071707,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1744998399
    }
]