[
    {
        "content": "<p>Hi is there a way to build a dependency graph for all theorems, lemma and axioms in mathlib? I know <a href=\"https://github.com/leanprover-community/import-graph\">https://github.com/leanprover-community/import-graph</a> can build import graph for all lean files in mathlib.</p>\n<p>I tried to implement one version, <br>\n<a href=\"/user_uploads/3121/6J5iKMjS-B5jHraAj9wn3ZAH/graphExtractor2.lean\">graphExtractor2.lean</a><br>\nbut in the extracted json file, theorem names seems weird, not the same as the original name<br>\n<a href=\"/user_uploads/3121/cZfAuIMzXxYetZhpL819WN44/partial_dependency_graph2.json\">partial_dependency_graph2.json</a><br>\nFor example, \"private.Mathlib.Algebra.Group.End.0.Equiv.Perm.pow_aux.match_1\".</p>\n<p>What's wrong with my code and what is the correct way to get the real name of the theorems?</p>",
        "id": 503921589,
        "sender_full_name": "Shuffle",
        "timestamp": 1741308074
    },
    {
        "content": "<p>Names get mangled for two main reasons:</p>\n<ul>\n<li>Private declarations get a unique, very long prefix so they don't collide with other private declarations. I think you can just run <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.privateToUserName#doc\">docs#Lean.privateToUserName</a> on all names and it will strip the unique prefix from any private names. That explains the first part of <code>_private.Mathlib.Algebra.Group.End.0.Equiv.Perm.pow_aux</code>.</li>\n<li>Declarations may contain other internal declarations (used for example in <code>match</code> blocks). Those internal details have suffixes on their names: see <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Name.isImplementationDetail#doc\">docs#Lean.Name.isImplementationDetail</a>. I think there's some code that strips off those suffixes but I can't quickly find it.</li>\n</ul>",
        "id": 504054687,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1741341467
    },
    {
        "content": "<p>Btw, this is not answering your question, but if you do get this working you could PR the functions getting the dependency graph of constants to <a href=\"https://github.com/leanprover-community/import-graph\">import-graph</a>, Maybe as something like <code>ImportGraph/Constants.lean</code></p>\n<p>I think that would be useful to have, but personally I don't have the bandwidth to add it myself.</p>",
        "id": 504062975,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1741344139
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"238446\">Anne Baanen</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Dependency.20Graph.20of.20Mathlib/near/504054687\">发言道</a>：</p>\n<blockquote>\n<p>Names get mangled for two main reasons:</p>\n<ul>\n<li>Private declarations get a unique, very long prefix so they don't collide with other private declarations. I think you can just run <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.privateToUserName#doc\">docs#Lean.privateToUserName</a> on all names and it will strip the unique prefix from any private names. That explains the first part of <code>_private.Mathlib.Algebra.Group.End.0.Equiv.Perm.pow_aux</code>.</li>\n<li>Declarations may contain other internal declarations (used for example in <code>match</code> blocks). Those internal details have suffixes on their names: see <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Name.isImplementationDetail#doc\">docs#Lean.Name.isImplementationDetail</a>. I think there's some code that strips off those suffixes but I can't quickly find it.</li>\n</ul>\n</blockquote>\n<p>Thanks! I will try if these could fix the bug.</p>",
        "id": 504357448,
        "sender_full_name": "Shuffle",
        "timestamp": 1741499605
    },
    {
        "content": "<p>Sure, I will let you know if I finish implementing this.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"385895\">Jon Eugster</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Dependency.20Graph.20of.20Mathlib/near/504062975\">发言道</a>：</p>\n<blockquote>\n<p>Btw, this is not answering your question, but if you do get this working you could PR the functions getting the dependency graph of constants to <a href=\"https://github.com/leanprover-community/import-graph\">import-graph</a>, Maybe as something like <code>ImportGraph/Constants.lean</code></p>\n<p>I think that would be useful to have, but personally I don't have the bandwidth to add it myself.</p>\n</blockquote>",
        "id": 504357472,
        "sender_full_name": "Shuffle",
        "timestamp": 1741499631
    }
]