[
    {
        "content": "<p>Currently polyrith is giving error 520 from sagecell. This seems to be caused by an error on the sagecell service, which you can check here: <a href=\"https://sagecell.sagemath.org/service\">https://sagecell.sagemath.org/service</a>. The sagecell online version seems to still be working fine, and seemingly this should resolve itself when the sagecell web server gets fixed, but I'm mentioning it here in case other people run into this and don't understand what's happening.</p>",
        "id": 518359674,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1747329340
    },
    {
        "content": "<p>I just want to bump this thread since I'm still running into the issue</p>",
        "id": 523952931,
        "sender_full_name": "Michał Mrugała",
        "timestamp": 1749823301
    },
    {
        "content": "<p>wait... mathlib4 calls an online service?</p>",
        "id": 523953287,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749823413
    },
    {
        "content": "<p>Given the sage service has been down for now for a month now, I think it is safe to say that it will not go back on in the near future. So it would be nice if polyrith can support local installations.</p>",
        "id": 523953310,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1749823426
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Polyrith.20error.20520/near/523953287\">said</a>:</p>\n<blockquote>\n<p>wait... mathlib4 calls an online service?</p>\n</blockquote>\n<p>It can, and polyrith is currently the only one that does.</p>",
        "id": 523953378,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1749823444
    },
    {
        "content": "<p>and after the calling is the result converted back to an independent proof?</p>",
        "id": 523953569,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749823498
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Polyrith.20error.20520/near/523953569\">said</a>:</p>\n<blockquote>\n<p>and after the calling is the result converted back to an independent proof?</p>\n</blockquote>\n<p>Yes</p>",
        "id": 523953680,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1749823525
    },
    {
        "content": "<p>as in, you actually replace the code with one that is independent?</p>",
        "id": 523953689,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749823527
    },
    {
        "content": "<p>similar to how <code>simp?</code> replaces itself when you click on the message</p>",
        "id": 523953743,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749823539
    },
    {
        "content": "<p>Sage figures out a combination of hypotheses that equals the goal, and <code>polyrith</code> converts this into a call to the <code>linear_combination</code> tactic.</p>",
        "id": 523953905,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1749823584
    },
    {
        "content": "<p>ok, good, lean is still sound then</p>",
        "id": 523954045,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749823620
    },
    {
        "content": "<p>Are you sure? Have you formalized the whole GMP <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span></p>",
        "id": 523956635,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1749824482
    },
    {
        "content": "<p>let's formalise lean inside lean</p>",
        "id": 523956856,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749824558
    },
    {
        "content": "<p>Mario is already doing that</p>",
        "id": 523959034,
        "sender_full_name": "Michał Mrugała",
        "timestamp": 1749825310
    },
    {
        "content": "<p><a href=\"https://github.com/digama0/lean4lean\">https://github.com/digama0/lean4lean</a></p>",
        "id": 523959194,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1749825370
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"439483\">Andrew Yang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Polyrith.20error.20520/near/523953310\">said</a>:</p>\n<blockquote>\n<p>Given the sage service has been down for now for a month now, I think it is safe to say that it will not go back on in the near future. So it would be nice if polyrith can support local installations.</p>\n</blockquote>\n<p>It may be the case that the sagecell service isn't really used, and so the sage people aren't aware of this... Or alternatively, the endpoint has changed</p>",
        "id": 523959346,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1749825426
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"439483\">Andrew Yang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Polyrith.20error.20520/near/523953378\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Polyrith.20error.20520/near/523953287\">said</a>:</p>\n<blockquote>\n<p>wait... mathlib4 calls an online service?</p>\n</blockquote>\n<p>It can, and polyrith is currently the only one that does.</p>\n</blockquote>\n<p>There are also <code>#search</code> I think.</p>",
        "id": 523978884,
        "sender_full_name": "Jz Pan",
        "timestamp": 1749832523
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"439483\">Andrew Yang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Polyrith.20error.20520/near/523953310\">said</a>:</p>\n<blockquote>\n<p>it would be nice if polyrith can support local installations.</p>\n</blockquote>\n<p>A full local installation of Sage will likely not be necessary for this. <a href=\"https://pypi.org/project/passagemath-singular/\">https://pypi.org/project/passagemath-singular/</a></p>",
        "id": 523993131,
        "sender_full_name": "Matthias Köppe",
        "timestamp": 1749838321
    },
    {
        "content": "<p>Hopefully <code>grind</code> can become a drop-in replacement for <code>polyrith</code> in most cases</p>",
        "id": 523994125,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1749838722
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116034\">@William Stein</span> are you aware of this?</p>",
        "id": 524016111,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1749849927
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"631691\">Thomas Zhu</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Polyrith.20error.20520/near/523994125\">said</a>:</p>\n<blockquote>\n<p>Hopefully <code>grind</code> can become a drop-in replacement for <code>polyrith</code> in most cases</p>\n</blockquote>\n<p>Yes, but I would like to have other tactics (some of which are written, and led me to discover the problem at the start of this thread, it wasn't <code>polyrith</code>!) which use the sage server</p>",
        "id": 524028634,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1749859450
    },
    {
        "content": "<p>My understanding is that the sage cell server is working.    It is monitored, and there are many complaints when it goes down.  I guess I don't understand what \"Given the sage service has been down for now for a month now\" means.  Perhaps it means that something changed with the <a href=\"https://sagecell.sagemath.org/\">https://sagecell.sagemath.org/</a> to make it incompatible with something else.  In that case, I have no opinion, because I'm not aware of the issue.</p>",
        "id": 524033187,
        "sender_full_name": "William Stein",
        "timestamp": 1749865097
    },
    {
        "content": "<p>I see the same as what the original message reported -- <a href=\"https://sagecell.sagemath.org/\">https://sagecell.sagemath.org/</a> seems to work fine, but <a href=\"https://sagecell.sagemath.org/service\">https://sagecell.sagemath.org/service</a> does not and returns a 520 error page from Cloudflare in a browser, and similarly if one tries it via Python including via <a href=\"https://github.com/sagemath/sagecell/blob/master/contrib/sagecell-client/sagecell-service.py\">https://github.com/sagemath/sagecell/blob/master/contrib/sagecell-client/sagecell-service.py</a> which looks like a little script to test the endpoint.</p>",
        "id": 524034112,
        "sender_full_name": "Julian Berman",
        "timestamp": 1749866380
    },
    {
        "content": "<p>The page gives an email address (for Andrey Novoseltsev) who I just passed the message along to (even though I know who William is :).</p>",
        "id": 524034480,
        "sender_full_name": "Julian Berman",
        "timestamp": 1749866792
    },
    {
        "content": "<p>Andrey responded already, to say:</p>\n<blockquote>\n<p>It is down due to overuse by somebody, maybe Lean users. It is not going to come back on public servers, but interested people are welcome to spin off their own servers!</p>\n</blockquote>\n<p>So it sounds like unfortunately it's going to stay offline.</p>",
        "id": 524036013,
        "sender_full_name": "Julian Berman",
        "timestamp": 1749869554
    },
    {
        "content": "<p>Overuse caused by LLM training sounds very plausible</p>",
        "id": 524036087,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1749869696
    },
    {
        "content": "<p>I wonder if there is an easy way to prove to a remote server that you are running Lean. :-)</p>",
        "id": 524039828,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1749875414
    },
    {
        "content": "<p>Have the server issue a challenge problem that Lean's automation can reliably solve, then have the server verify the proof?</p>",
        "id": 524040038,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1749875503
    },
    {
        "content": "<p>This isn't quite proof, but polyrith currently does let the server know that it's coming from Lean: <a href=\"https://github.com/leanprover-community/mathlib4/blob/7deb334c5f5104f4edad1a6396dd02a8cddefb86/Mathlib/Tactic/Polyrith.lean#L330\">https://github.com/leanprover-community/mathlib4/blob/7deb334c5f5104f4edad1a6396dd02a8cddefb86/Mathlib/Tactic/Polyrith.lean#L330</a> and <a href=\"https://github.com/leanprover-community/mathlib4/blob/7deb334c5f5104f4edad1a6396dd02a8cddefb86/Mathlib/Tactic/Polyrith.lean#L350\">https://github.com/leanprover-community/mathlib4/blob/7deb334c5f5104f4edad1a6396dd02a8cddefb86/Mathlib/Tactic/Polyrith.lean#L350</a></p>",
        "id": 524040646,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1749876458
    },
    {
        "content": "<p>In the meantime, maybe it could be a good idea to make it so that users can override the default URL hardcoded in the tactic (an env var or a <code>set_option</code>is a good way to achieve this?), so that if someone wants to set up a server locally (or if someone sets up a server for lean users) and want to use their own server for their polyrith usage it’s an option.</p>",
        "id": 524047403,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1749886618
    },
    {
        "content": "<p>Perhaps a good opportunity to dust off <span class=\"user-mention\" data-user-id=\"461731\">@Miguel Marco</span>'s PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/20334\">https://github.com/leanprover-community/mathlib4/pull/20334</a></p>",
        "id": 524076529,
        "sender_full_name": "Matthias Köppe",
        "timestamp": 1749920841
    },
    {
        "content": "<p>I didn't see this thread/issue until now -- please feel free to tag me on <code>polyrith</code>-related issues!</p>\n<p><span class=\"user-mention silent\" data-user-id=\"321696\">Julian Berman</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Polyrith.20error.20520/near/524036013\">said</a>:</p>\n<blockquote>\n<p>Andrey responded already, to say:</p>\n<blockquote>\n<p>It is down due to overuse by somebody, maybe Lean users. It is not going to come back on public servers, but interested people are welcome to spin off their own servers!</p>\n</blockquote>\n<p>So it sounds like unfortunately it's going to stay offline.</p>\n</blockquote>\n<p>We've reached an (unfortunate) milestone. Three years ago I asked Andrey for permission to hook up <code>polyrith</code> to SageCell and his answer was</p>\n<blockquote>\n<p>I am glad that our service was useful to you! From what you are describing, there are no issues with using the public servers. There are health checks that run simple computations every couple of minutes, so 720 times a day, actually 2000 over 3 containers. I don't anticipate problems with actual users either, and if you do manage to become so popular - it would be a great opportunity indeed to setup another server!</p>\n</blockquote>\n<p>So I guess we've gone beyond \"so popular\"...</p>",
        "id": 525956394,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1750961003
    },
    {
        "content": "<p>My understanding is that there will be (or already is?) a Grobner basis module in core Lean. <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> do you know details?</p>",
        "id": 525956933,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1750961177
    },
    {
        "content": "<p>Long term, using an internal implementation is going to be the most stable solution</p>",
        "id": 525957043,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1750961204
    },
    {
        "content": "<p>I don't think it's sustainable to expect users to have a local install of Sage or anything else besides Lean</p>",
        "id": 525957268,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1750961264
    },
    {
        "content": "<p>Are there other tactics that use a locally installed Python? Elsewhere I saw cvc5 (a SAT/SMT solver) mentioned<br>\n(edit: That may have been <a href=\"https://github.com/ufmg-smite/lean-smt\">https://github.com/ufmg-smite/lean-smt</a>, <a href=\"https://github.com/abdoo8080/lean-cvc5\">https://github.com/abdoo8080/lean-cvc5</a>)</p>",
        "id": 525958089,
        "sender_full_name": "Matthias Köppe",
        "timestamp": 1750961509
    },
    {
        "content": "<p>I believe <code>polyrith</code> is the only mathlib tactic that calls an external tool</p>",
        "id": 525959829,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1750962120
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110596\">@Rob Lewis</span> , but there's this from above:<br>\n<span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Polyrith.20error.20520/near/524028634\">said</a>:</p>\n<blockquote>\n<p>Yes, but I would like to have other tactics (some of which are written, and led me to discover the problem at the start of this thread, it wasn't <code>polyrith</code>!) which use the sage server</p>\n</blockquote>",
        "id": 525960362,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1750962335
    },
    {
        "content": "<p>If there is interest, I can help on the Sage side of things, for example by preparing a lightweight version of the SageCell server that can run locally without a full installation of Sage, <a href=\"https://github.com/passagemath/passagemath/issues/1058\">https://github.com/passagemath/passagemath/issues/1058</a></p>",
        "id": 525961276,
        "sender_full_name": "Matthias Köppe",
        "timestamp": 1750962693
    },
    {
        "content": "<p>A lightweight local SageCell would be extremely helpful, especially if it's possible to occasionally update how much it imports. I've looked at the normal SageCell installation directions and I don't see myself getting a server up and running anytime soon.</p>",
        "id": 525989319,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1750977949
    },
    {
        "content": "<p>I've created the fork <a href=\"https://github.com/passagemath/passagemath-cell-server\">https://github.com/passagemath/passagemath-cell-server</a> for this work</p>",
        "id": 525991506,
        "sender_full_name": "Matthias Köppe",
        "timestamp": 1750979756
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110596\">@Rob Lewis</span>  I've got it to the point that it can be installed with a simple \"pip install\", see updated README. The next step should probably be to cut out the ssh-based connection to work servers.</p>",
        "id": 525997450,
        "sender_full_name": "Matthias Köppe",
        "timestamp": 1750985014
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110596\">Rob Lewis</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Polyrith.20error.20520/near/525956933\">said</a>:</p>\n<blockquote>\n<p>My understanding is that there will be (or already is?) a Grobner basis module in core Lean. <span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> do you know details?</p>\n</blockquote>\n<p>There's some documentation about the Grobner basis solver at <a href=\"https://pr-451--lean-reference-manual-review.netlify.app/The--grind--tactic/Algebraic-Solver-_LPAR_Commutative-Rings___-Fields_RPAR_/#The-Lean-Language-Reference--The--grind--tactic--Algebraic-Solver-_LPAR_Commutative-Rings___-Fields_RPAR_\">https://pr-451--lean-reference-manual-review.netlify.app/The--grind--tactic/Algebraic-Solver-_LPAR_Commutative-Rings___-Fields_RPAR_/#The-Lean-Language-Reference--The--grind--tactic--Algebraic-Solver-_LPAR_Commutative-Rings___-Fields_RPAR_</a>.</p>\n<p>Hopefully available on Tuesday or Wednesday.</p>",
        "id": 526020144,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1751005846
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"513554\">@Matthias Köppe</span> thanks for this. I'm trying to follow the directions in the readme, but getting errors at <code>sage -sh -c make</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>ERROR in ./js/css.js\nModule not found: Error: Can't resolve 'colorpicker.css' in '/home/rlewis13/lean/passagemath-cell-server/js'\n @ ./js/cell.js\n @ ./js/main.js\n\nERROR in ./js/css.js\nModule not found: Error: Can't resolve 'fontawesome.css' in '/home/rlewis13/lean/passagemath-cell-server/js'\n @ ./js/cell.js\n @ ./js/main.js\n\nERROR in ./js/css.js\nModule not found: Error: Can't resolve 'sagecell.css' in '/home/rlewis13/lean/passagemath-cell-server/js'\n @ ./js/cell.js\n @ ./js/main.js\n\nERROR in ./js/interact_cell.js\nModule not found: Error: Can't resolve 'base/js/events' in '/home/rlewis13/lean/passagemath-cell-server/js'\n @ ./js/session.js\n @ ./js/cell.js\n @ ./js/main.js\n\nERROR in ./js/session.js\nModule not found: Error: Can't resolve 'base/js/events' in '/home/rlewis13/lean/passagemath-cell-server/js'\n @ ./js/cell.js\n @ ./js/main.js\n\nERROR in ./js/session.js\nModule not found: Error: Can't resolve 'base/js/namespace' in '/home/rlewis13/lean/passagemath-cell-server/js'\n @ ./js/cell.js\n @ ./js/main.js\n\nERROR in ./js/session.js\nModule not found: Error: Can't resolve 'services/kernels/kernel' in '/home/rlewis13/lean/passagemath-cell-server/js'\n @ ./js/cell.js\n @ ./js/main.js\n\nERROR in ./js/utils.js\nModule not found: Error: Can't resolve 'base/js/utils' in '/home/rlewis13/lean/passagemath-cell-server/js'\n @ ./js/cell.js\n @ ./js/main.js\n\nERROR in ./js/widgets.js\nModule not found: Error: Can't resolve 'mpl' in '/home/rlewis13/lean/passagemath-cell-server/js'\n @ ./js/session.js\n @ ./js/cell.js\n @ ./js/main.js\n</code></pre></div>",
        "id": 526093442,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1751033712
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110596\">@Rob Lewis</span> Thanks for testing, fixed now</p>",
        "id": 526117160,
        "sender_full_name": "Matthias Köppe",
        "timestamp": 1751041333
    }
]