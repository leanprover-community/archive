[
    {
        "content": "<p>Splitting off the discussion from <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/set_option.20maxSynthPendingDepth.202/with/499579408\">#mathlib4 &gt; set_option maxSynthPendingDepth 2</a> about this since there appears to be support on both sides of the question. </p>\n<p>It might be too early for a poll but please register your sentiments about dropping the <code>Decidable</code> fields from <code>LinearOrder</code>.</p>",
        "id": 502060689,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1740580200
    },
    {
        "content": "<p>Personally I also found this strange compared to the rest of mathlib when I first encountered it. I would lean yes</p>",
        "id": 502060888,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1740580248
    },
    {
        "content": "<p>I don't think \"strange\" is that good a reason; <code>Field.nnqsmul</code> is certainly also strange, but it is also useful!</p>",
        "id": 502062514,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740580659
    },
    {
        "content": "<p>I think <del>your</del> this proposal would amount to replacing</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearOrder</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>with</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearOrder</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ord</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableLT</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableLE</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">LawfulOrd</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>which is rather a mouthful</p>",
        "id": 502063021,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740580786
    },
    {
        "content": "<p>Perhaps \"inconsistent\" is better language. I hesitate to call this \"mine\" :) The previous thread had people responding with exclamation points! and did have an actual problem that was currently hidden under the cutoff for depth. </p>\n<p>I really just want people to convince me one way or the other while I focus on grading for bit. But I do think further discussion is merited either way.</p>",
        "id": 502063871,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1740580990
    },
    {
        "content": "<p>I think the actuall problem was a weird typeclass argument, not the fields within <code>LinearOrder</code>. I think pulling decidable fields out of <code>LinearOrder</code> is likely to <em>increase</em> the prevalence of such weird arguments (chosen from the mouthful above)</p>",
        "id": 502064618,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740581164
    },
    {
        "content": "<p>Certainly a mouthful of typeclass assumptions is a solid reason against</p>",
        "id": 502064749,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1740581201
    },
    {
        "content": "<p>But we already have default values for some don't we?</p>",
        "id": 502064883,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1740581240
    },
    {
        "content": "<p>I think splitting it also means we need to re-separate <code>min</code> and <code>inf</code></p>",
        "id": 502064914,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740581248
    },
    {
        "content": "<p>Otherwise either <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=minOfLe#doc\">docs#minOfLe</a> creates an instance diamond, or we still need all the decidable instances to define <code>LinearOrder</code> anyway</p>",
        "id": 502064952,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740581257
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306577\">Matthew Ballard</span> <a href=\"#narrow/channel/287929-mathlib4/topic/remove.20decidable.20fields.20from.20LinearOrder.3F/near/502064883\">said</a>:</p>\n<blockquote>\n<p>But we already have default values for some don't we?</p>\n</blockquote>\n<p>We already have default values for the fields in LinearOrder. Did you mean default instances? I think default <code>Decidable</code> instances is just reverting back to the (global) <code>open scoped Classical</code> approach that we've moved away from</p>",
        "id": 502065311,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740581345
    },
    {
        "content": "<blockquote>\n<p>that we've moved away from</p>\n</blockquote>\n<p>...and for good reason, as it used to cause diamonds when Lean found the actual decidable order instances on e.g. Nat. So this is where it differs from the <code>[DecidableEq (Ideal R)]</code> situation where there are literally no instances in mathlib.</p>",
        "id": 502135400,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740600696
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/remove.20decidable.20fields.20from.20LinearOrder.3F/near/502062514\">said</a>:</p>\n<blockquote>\n<p>I don't think \"strange\" is that good a reason; <code>Field.nnqsmul</code> is certainly also strange, but it is also useful!</p>\n</blockquote>\n<p>It is a good reason. If possible, we should avoid \"strange things\" in definitions. Imagine somebody comes with a new shiny theorem about linear orders. Whoëver comes to check whether the theorem holds really for all linear orders will be puzzled with the complicated definition, making them wonder whether some linear orders (according to their personal understanding of what linear order is) are excluded. In my case, I have struggled both with <code>nnqsmul</code> and with what OP mentions.</p>\n<p>However, I also understand the reasons why it shouldn't be changed.</p>",
        "id": 502343519,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1740678419
    },
    {
        "content": "<p><code>1 / 0 = 0</code> is strange to many mathematicians, and we <em>could</em> avoid it. But we don't because <em>strange</em> is not the primary metric we should minimize / optimize for. It's much more <em>useful</em> to allow <code>1 / 0 = 0</code>.</p>",
        "id": 502354442,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1740682014
    },
    {
        "content": "<p>Philosophically, it is the same kind of issue, but in practice, division by zero has different trade-offs.</p>",
        "id": 502379818,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1740691578
    },
    {
        "content": "<p>Could there be some comment at <code>LinearOrder</code> explaining why these fields are there?</p>\n<p>I think the mouthful of typeclass assumptions isn't a good objection, because we can define <code>ComputableLinearOrder</code> to extend <code>LinearOrder</code> and also contain all of <code>[Ord X] [DecidableEq X] [DecidableLT X] [DecidableLE X] [Batteries.LawfulOrd X]</code>.</p>",
        "id": 505749618,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1741979469
    },
    {
        "content": "<p>Certainly we should document the status quo</p>",
        "id": 505784161,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1741995415
    },
    {
        "content": "<p>I think if you had that second typeclass, you'd just annoy a bunch of mathematicians who don't like typing the word \"computable\" because they don't care about it, and then mathlib would end up being less computable as a result.</p>",
        "id": 505784380,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1741995560
    },
    {
        "content": "<p>Which is a loss both for the mathematicians who were made to think about it more than they currently do, and a loss for the people who like using <code>#eval</code>.</p>",
        "id": 505784503,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1741995623
    },
    {
        "content": "<p>Note: we had <code>linear_order</code> and <code>decidable_linear_order</code> in Lean 3, then decided to merge them.</p>",
        "id": 505811657,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1742015882
    },
    {
        "content": "<p>Semi-offtopic: I think that default fields is a footgun. IMHO, we should use something like <code>ofMinimalAxioms</code> instead.</p>",
        "id": 505811709,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1742015929
    },
    {
        "content": "<p>BTW, doesn't <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=minOfLe#doc\">docs#minOfLe</a> create a diamon for <code>Min (Nat × Nat)</code>?</p>",
        "id": 505811859,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1742016052
    },
    {
        "content": "<p>Yes, it does:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- (0,0)</span>\n\n<span class=\"kn\">attribute</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">high</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">minOfLe</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- (1,0)</span>\n</code></pre></div>",
        "id": 505828473,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1742030208
    },
    {
        "content": "<p>I think nobody would ever use <code>minOfLe</code> on <code>Nat × Nat</code>, because it only really makes sense on a linear order, while <code>×</code> is given the pairwise order.</p>",
        "id": 505828624,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1742030336
    },
    {
        "content": "<p>Is it possible that someone will use it by accident?</p>",
        "id": 505865939,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1742057910
    },
    {
        "content": "<p>(probably, yes, but how easy is to shoot yourself in the foot with this?)</p>",
        "id": 505866017,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1742057985
    },
    {
        "content": "<p>It's not an instance, so I don't think so.</p>",
        "id": 505866102,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1742058020
    },
    {
        "content": "<p>Ah, indeed!</p>",
        "id": 505866130,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1742058041
    },
    {
        "content": "<p>Aha, so it's on a par with that non-instance which makes <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><msub><mo>⊗</mo><mi>R</mi></msub><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">A\\otimes_R B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"><span class=\"mbin\">⊗</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> into a <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>-algebra, which gives a diamond if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">A=B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>.</p>",
        "id": 505866222,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1742058104
    }
]