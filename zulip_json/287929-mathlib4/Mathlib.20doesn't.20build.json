[
    {
        "content": "<p>If I try to simply clone and run mathlib in VSCode right now, I get the following error:<br>\n<a href=\"/user_uploads/3121/AHgeaiejmr_tLnDBYmW_nq-7/PastedText.txt\">PastedText.txt</a><br>\nHow do I deal with this?</p>",
        "id": 570456931,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1769567315
    },
    {
        "content": "<p>Did you try running <code>lake exe cache get</code> like the middle of the log suggested?</p>",
        "id": 570458547,
        "sender_full_name": "James E Hanson",
        "timestamp": 1769568001
    },
    {
        "content": "<p>Ok I have tried to run lake exe cache get on my fork on Mathlib, which is identical to current Mathlib, and after just a few hours of build I get this: <br>\n<a href=\"/user_uploads/3121/YFCVMhPDF-Ukafy2h4bD18nD/PastedText.txt\">PastedText.txt</a></p>",
        "id": 570475671,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1769580465
    },
    {
        "content": "<p>Basically it seems like this random chunk of Mathlib suddenly contains a wrong proof:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- The group morphism from `fixingSubgroup` of a union to the iterated `fixingSubgroup`. -/</span>\n<span class=\"kd\">@[</span><span class=\"n\">to_additive</span>\n<span class=\"sd\">/-- The additive group morphism from `fixingAddSubgroup` of a union</span>\n<span class=\"sd\">to the iterated `fixingAddSubgroup`. -/</span><span class=\"kd\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">fixingSubgroup_union_to_fixingSubgroup_of_fixingSubgroup</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">fixingSubgroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→*</span>\n<span class=\"w\">      </span><span class=\"n\">fixingSubgroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fixingSubgroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"bp\">⁻¹'</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ofFixingSubgroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨⟨</span><span class=\"n\">m</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mem_fixingSubgroup_union_iff</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">prop</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">⟩</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">rintro</span><span class=\"w\"> </span><span class=\"bp\">⟨⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"bp\">⟩</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx'</span><span class=\"bp\">⟩</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">mem_preimage</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hx'</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">SetLike</span><span class=\"bp\">.</span><span class=\"n\">coe_eq_coe</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">SubMulAction</span><span class=\"bp\">.</span><span class=\"n\">val_smul_of_tower</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mem_fixingSubgroup_union_iff</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">prop</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx'</span><span class=\"bp\">⟩⟩</span>\n<span class=\"w\">  </span><span class=\"n\">map_one'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"n\">map_mul'</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n</code></pre></div>\n<p>The last simp does not finish the job</p>",
        "id": 570475805,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1769580550
    },
    {
        "content": "<p>Which I can fix with <code>simp; rfl</code> and proceed to do what I wanted to do but obviously I feel very suspicious of the fact that I need to actually fix a part of mathlib before it compiles, and it's more likely that I did something wrong</p>",
        "id": 570476238,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1769580824
    },
    {
        "content": "<p>You should never have a few hours of build for mathlib</p>",
        "id": 570479392,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1769582505
    },
    {
        "content": "<p>The cache command should download the compiled version of mathlib</p>",
        "id": 570479440,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1769582530
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20doesn't.20build/near/570479440\">said</a>:</p>\n<blockquote>\n<p>The cache command should download the compiled version of mathlib</p>\n</blockquote>\n<p>Is it <code>lake exe cache get</code> or a separate command?</p>",
        "id": 570479963,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1769582829
    },
    {
        "content": "<p>That one, yeah</p>",
        "id": 570480158,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1769582965
    },
    {
        "content": "<p>Well I did run<code> lake exe cache get</code></p>",
        "id": 570480200,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1769582989
    },
    {
        "content": "<p>Another interesting fact is that it only works if you don't try to <code>lake update</code>, otherwise<br>\nstepannesterov@DN0a1e875b Stepan-s-mathlib4-fork % lake update<br>\ninfo: leanprover-community/plausible: checking out revision '7311586e1a56af887b1081d05e80c11b6c41d212'<br>\ninfo: leanprover-community/importGraph: checking out revision '875ad9d88ed684e39c16bdea260e6ecfa15afd60'<br>\ninfo: leanprover-community/aesop: checking out revision 'f08e838d4f9aea519f3cde06260cfb686fd4bab0'<br>\ninfo: leanprover-community/Qq: checking out revision '23324752757bf28124a518ec284044c8db79fee5'<br>\ninfo: leanprover-community/batteries: checking out revision 'a7ab123915d17f92587c2b1ec7218db7db7856e1'<br>\ninfo: updating toolchain to 'leanprover/lean4:v4.28.0-rc1'<br>\ninfo: restarting Lake via Elan<br>\ninfo: toolchain not updated; already up-to-date<br>\ninfo: Cli: checking out revision '28e0856d4424863a85b18f38868c5420c55f9bae'<br>\ninfo: mathlib: running post-update hooks<br>\n(base) stepannesterov@DN0a1e875b Stepan-s-mathlib4-fork % lake exe cache get<br>\n✖ [13/21] Building Batteries.Data.Array.Match<br>\ntrace: .&gt; LEAN_PATH=/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/Cli/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/batteries/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/Qq/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/aesop/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/proofwidgets/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/importGraph/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/LeanSearchClient/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/plausible/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/build/lib/lean /Users/stepannesterov/.elan/toolchains/leanprover--lean4---v4.27.0-rc1/bin/lean /Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/batteries/Batteries/Data/Array/Match.lean -o /Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/Array/Match.olean -i /Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/Array/Match.ilean -c /Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/batteries/.lake/build/ir/Batteries/Data/Array/Match.c --setup /Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/batteries/.lake/build/ir/Batteries/Data/Array/Match.setup.json --json<br>\nerror: Batteries/Data/Array/Match.lean:138:2: <code>Rel</code> is not a field of structure <code>FinitenessRelation</code><br>\nerror: Batteries/Data/Array/Match.lean:137:44: Fields missing: <code>rel</code></p>\n<p>Field <code>rel</code> must be explicitly provided; its synthesized value is<br>\n  InvImage IterM.IsPlausibleSuccessorOf ?m.18<br>\nerror: Batteries/Data/Array/Match.lean:146:6: failed to synthesize<br>\n  Iterator ?m.19 ?m.20 ?m.21</p>\n<p>Hint: Additional diagnostic information may be available using the <code>set_option diagnostics true</code> command.<br>\nerror: Batteries/Data/Array/Match.lean:154:10: failed to synthesize<br>\n  Iterator ?m.19 ?m.20 ?m.21</p>\n<p>Hint: Additional diagnostic information may be available using the <code>set_option diagnostics true</code> command.<br>\nerror: Batteries/Data/Array/Match.lean:162:10: failed to synthesize<br>\n  Iterator ?m.19 ?m.20 ?m.21</p>\n<p>Hint: Additional diagnostic information may be available using the <code>set_option diagnostics true</code> command.<br>\nerror: Lean exited with code 1<br>\nSome required targets logged failures:</p>\n<ul>\n<li>Batteries.Data.Array.Match<br>\nerror: build failed</li>\n</ul>",
        "id": 570480296,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1769583038
    },
    {
        "content": "<p>That makes sense, you should not run <code>lake update</code> within mathlib</p>",
        "id": 570480383,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1769583089
    },
    {
        "content": "<p>So potentially maybe my mathlib doesn't work because I can't <code>lake update</code>, but I really cant <code>lake update</code>, because then everything is on fire</p>",
        "id": 570480397,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1769583099
    },
    {
        "content": "<p>After you revert all local chances and run <code>lake exe cache get</code>, what's the output?</p>",
        "id": 570480522,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1769583171
    },
    {
        "content": "<p>I don't know how to revert <code>lake exe cache get</code>, but when I executed it for the first time, it was<br>\nstepannesterov@DN0a1e875b Stepan-s-mathlib4-fork % git switch semisimple-branch<br>\nbranch 'semisimple-branch' set up to track 'origin/semisimple-branch'.<br>\nSwitched to a new branch 'semisimple-branch'<br>\n(base) stepannesterov@DN0a1e875b Stepan-s-mathlib4-fork % lake exe cache get<br>\ninfo: proofwidgets: checking out revision 'c04225ee7c0585effbd933662b3151f01b600e40'<br>\ninfo: aesop: checking out revision 'cb837cc26236ada03c81837bebe0acd9c70ced7d'<br>\ninfo: Qq: checking out revision 'bd58c9efe2086d56ca361807014141a860ddbf8c'<br>\ninfo: batteries: checking out revision '4ca6ac27b5b03d9554013a85343f75f43501175a'<br>\ninfo: Cli: checking out revision '55c37290ff6186e2e965d68cf853a57c0702db82'<br>\nFetching ProofWidgets cloud release... done!<br>\nCurrent branch: semisimple-branch<br>\nUsing cache (Azure) from origin: stepan2698-cpu/Stepan-s-mathlib4-fork<br>\nNo files to download<br>\nNo files to download<br>\nDecompressing 7874 file(s)<br>\nUnpacked in 11594 ms<br>\nCompleted successfully!</p>",
        "id": 570480690,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1769583260
    },
    {
        "content": "<p>But of course mathlib.lean still was complaining that imports are out of date, so I pressed 'Restart File' and waited for a couple hours</p>",
        "id": 570480781,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1769583312
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"407114\">Stepan Nesterov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Mathlib.20doesn't.20build/near/570475671\">said</a>:</p>\n<blockquote>\n<p>Ok I have tried to run lake exe cache get on my fork on Mathlib, which is identical to current Mathlib, and after just a few hours of build I get this: <br>\n<a href=\"/user_uploads/3121/YFCVMhPDF-Ukafy2h4bD18nD/PastedText.txt\">PastedText.txt</a></p>\n</blockquote>\n<p>And then this happened</p>",
        "id": 570480829,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1769583333
    },
    {
        "content": "<p>Sometimes, I need to restart the server in VSCode, to make it aware that the cache is available.</p>",
        "id": 570481912,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1769583889
    },
    {
        "content": "<p>Just to emphasize a couple of things: (1) an end user should never have to type <code>lake update</code> in mathlib (2) waiting more than a few minutes for anything almost certainly means something has gone wrong (in particular essentially the only reason you should be watching a machine slowly counting to 7000 is if you've changed a file which is imported early and have decided to compile the resulting mathlib on your own computer rather than getting one of github's computers to do this for you).</p>",
        "id": 570487907,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1769586558
    },
    {
        "content": "<p>What does <code>lake setup-file</code> do? <code>lake help</code> says nothing about it. Did you run it yourself? I checked that <code>lake update</code> doesn't call it.</p>",
        "id": 570531603,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1769599580
    },
    {
        "content": "<p>I think it's called by VSCode when it sets up the file</p>",
        "id": 570531993,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1769599706
    },
    {
        "content": "<p>I don't recall ever seeing <code>lake setup-file</code> being called; do they appear in the infoview?</p>",
        "id": 570532331,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1769599822
    },
    {
        "content": "<p>What if I cannot get cache because of the following:<br>\n(base) stepannesterov@DNa221b1b Stepan-s-mathlib4-fork % lake exe cache get<br>\n✖ [9/22] Building Batteries.Data.Array.Match<br>\ntrace: .&gt; LEAN_PATH=/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/Cli/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/batteries/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/Qq/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/aesop/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/proofwidgets/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/importGraph/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/LeanSearchClient/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/plausible/.lake/build/lib/lean:/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/build/lib/lean /Users/stepannesterov/.elan/toolchains/leanprover--lean4---v4.27.0-rc1/bin/lean /Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/batteries/Batteries/Data/Array/Match.lean -o /Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/Array/Match.olean -i /Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/Array/Match.ilean -c /Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/batteries/.lake/build/ir/Batteries/Data/Array/Match.c --setup /Users/stepannesterov/Lean/Stepan-s-mathlib4-fork/.lake/packages/batteries/.lake/build/ir/Batteries/Data/Array/Match.setup.json --json<br>\nerror: Batteries/Data/Array/Match.lean:138:2: <code>Rel</code> is not a field of structure <code>FinitenessRelation</code><br>\nerror: Batteries/Data/Array/Match.lean:137:44: Fields missing: <code>rel</code></p>\n<p>Field <code>rel</code> must be explicitly provided; its synthesized value is<br>\n  InvImage IterM.IsPlausibleSuccessorOf ?m.18<br>\nerror: Batteries/Data/Array/Match.lean:146:6: failed to synthesize<br>\n  Iterator ?m.19 ?m.20 ?m.21</p>\n<p>Hint: Additional diagnostic information may be available using the <code>set_option diagnostics true</code> command.<br>\nerror: Batteries/Data/Array/Match.lean:154:10: failed to synthesize<br>\n  Iterator ?m.19 ?m.20 ?m.21</p>\n<p>Hint: Additional diagnostic information may be available using the <code>set_option diagnostics true</code> command.<br>\nerror: Batteries/Data/Array/Match.lean:162:10: failed to synthesize<br>\n  Iterator ?m.19 ?m.20 ?m.21</p>\n<p>Hint: Additional diagnostic information may be available using the <code>set_option diagnostics true</code> command.<br>\nerror: Lean exited with code 1<br>\nSome required targets logged failures:</p>\n<ul>\n<li>Batteries.Data.Array.Match<br>\nerror: build failed</li>\n</ul>",
        "id": 570865108,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1769710461
    },
    {
        "content": "<p>Did you try switching it off and on again with <code>rm -rf .lake</code> (aka delete the directory <code>.lake</code>) then <code>lake exe cache get</code> again?</p>",
        "id": 570892208,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1769719731
    },
    {
        "content": "<p>I tried creating a new branch for a new PR, running <code>rm -rf .lake</code>, <code>lake exe cache get</code>, but this still happens:<br>\n<a href=\"/user_uploads/3121/ta2FMeI0Vi8MKbzvBIjzHV7u/PastedText.txt\">PastedText.txt</a></p>",
        "id": 572219119,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1770315259
    },
    {
        "content": "<p>Could you start a new clone of Mathlib and see what happens? Copy-pasting all the commands you type and their outputs would hopefully help.</p>",
        "id": 572219403,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1770315358
    },
    {
        "content": "<p>Well I guess this happens when I restart the file. When I <code>lake exe cache get</code>, I get <br>\n<a href=\"/user_uploads/3121/2lTKHwaMrJpe-g2bvH9jt906/PastedText.txt\">PastedText.txt</a></p>",
        "id": 572219501,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1770315379
    },
    {
        "content": "<p>I mean, from a fresh directory, start with</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">clone</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"bp\">.</span><span class=\"n\">git</span>\n<span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span>\n</code></pre></div>",
        "id": 572219663,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1770315420
    },
    {
        "content": "<p>Well it works on mathlib itself, but not on my fork whose master branch is supposed to be identical to mathlib<br>\nFull log:<br>\n<a href=\"/user_uploads/3121/M_PFFA-E3vMgcylHraKXPwxS/PastedText.txt\">PastedText.txt</a></p>",
        "id": 572223989,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1770316828
    },
    {
        "content": "<p>That said, I've already made one PR by working inside mathlib in VSCode, and then just copypasting my code into the broken fork and commiting it. Github couldn't tell the difference c;</p>",
        "id": 572224195,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1770316893
    },
    {
        "content": "<p>Okay, that's because you're running <code>lake</code> inside your <code>Lean</code> folder rather than <code>Lean/Stepan-s-mathlib4-fork</code></p>",
        "id": 572231570,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1770319316
    },
    {
        "content": "<p>Oh yeah I did that by mistake at first. But the same thing happens when I run it from VSCode</p>",
        "id": 572231842,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1770319414
    },
    {
        "content": "<p>Or in the right directory which I did afterwards</p>",
        "id": 572231860,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1770319424
    },
    {
        "content": "<p>It looks like you're building with lean 4.27 but your repository is on 4.28</p>",
        "id": 572232330,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1770319580
    },
    {
        "content": "<p>Did you ever set up a version override in lake?</p>",
        "id": 572232396,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1770319600
    },
    {
        "content": "<p>I might have written some bespoke commands which chatGPT told me to do...</p>",
        "id": 572232496,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1770319632
    },
    {
        "content": "<p>When I tried to fix it by myself I mean</p>",
        "id": 572232550,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1770319651
    },
    {
        "content": "<p>That's always risky</p>",
        "id": 572232722,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1770319715
    },
    {
        "content": "<p>I don't recall the command to check, but look at <code>lake --help</code> for something related to version overrides</p>",
        "id": 572232829,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1770319751
    },
    {
        "content": "<p>You could start from a fresh directory but cloning your fork instead of the main mathlib. Hopefully the override shouldn't be set up there.</p>",
        "id": 572244976,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1770324074
    },
    {
        "content": "<p>That's exactly what I did</p>",
        "id": 572245151,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1770324132
    },
    {
        "content": "<p>Could the version override somehow have propagated into github?</p>",
        "id": 572245192,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1770324149
    },
    {
        "content": "<p>What does <code>elan override list</code> say?</p>",
        "id": 572247282,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1770324963
    },
    {
        "content": "<p>(base) stepannesterov@DN0a221534 Stepan-s-mathlib4-fork % elan override list<br>\n/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork       leanprover/lean4:v4.27.0-rc1</p>",
        "id": 572247396,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1770325010
    },
    {
        "content": "<p>That's your issue</p>",
        "id": 572247447,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1770325029
    },
    {
        "content": "<p>Run <code>elan override unset /Users/stepannesterov/Lean/Stepan-s-mathlib4-fork</code></p>",
        "id": 572247511,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1770325053
    },
    {
        "content": "<p>(base) stepannesterov@DN0a221534 Stepan-s-mathlib4-fork % elan override unset /Users/stepannesterov/Lean/Stepan-s-mathlib4-fork<br>\nerror: Found argument '/Users/stepannesterov/Lean/Stepan-s-mathlib4-fork' which wasn't expected, or isn't valid in this context</p>\n<p>USAGE:<br>\n    elan override unset [FLAGS] [OPTIONS]</p>",
        "id": 572247681,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1770325116
    },
    {
        "content": "<p>I saw the same today on two student's computer. mathlib was just cloned (and Lean just installed). I thinking something strange was going on, but maybe there is actually a problem somewhere.</p>",
        "id": 572248359,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1770325384
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"300245\">@Filippo A. E. Nuccio</span> it was the same error, right?</p>",
        "id": 572248386,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1770325395
    },
    {
        "content": "<p>Sorry, <code>elan override unset --path /Users/stepannesterov/Lean/Stepan-s-mathlib4-fork</code></p>",
        "id": 572249499,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1770325847
    },
    {
        "content": "<p>It works!! <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span></p>",
        "id": 572249872,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1770326007
    },
    {
        "content": "<p>Thank you so much for the quick reaction</p>",
        "id": 572249905,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1770326023
    },
    {
        "content": "<p>I still believe elan should print a warning on every command when an override is in place</p>",
        "id": 572256069,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1770328748
    },
    {
        "content": "<p>Issue posted as <a href=\"https://github.com/leanprover/elan/issues/189\">https://github.com/leanprover/elan/issues/189</a></p>",
        "id": 572267745,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1770334294
    },
    {
        "content": "<p>PR: <a href=\"https://github.com/leanprover/elan/pull/190\">elan#190</a></p>",
        "id": 572268166,
        "sender_full_name": "Kim Morrison :bot:",
        "timestamp": 1770334560
    }
]