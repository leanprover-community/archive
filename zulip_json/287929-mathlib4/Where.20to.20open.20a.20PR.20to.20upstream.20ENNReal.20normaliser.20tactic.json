[
    {
        "content": "<p>I am searching for a good place to upstream a tactic I wrote to normalize ENNReal (non-negative extended real) numbers. I refactored it a lot and I have been looking at several places in Mathlib to upstream it (such as Mathlib/Tactic/NormNum or ), but Mathlib is quite big and maybe its better if I just ask this group. Does anyone have a suggestion? I also have quite a lot of unit tests coming with this tactic.</p>\n<p>This is the github project: <a href=\"https://github.com/wvhulle/ennreal-arith\">ennreal-arith</a></p>",
        "id": 540228531,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1758200740
    },
    {
        "content": "<p>Can you describe its spec?</p>",
        "id": 540367261,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1758255145
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Where.20to.20open.20a.20PR.20to.20upstream.20ENNReal.20normaliser.20tactic/near/540367261\">said</a>:</p>\n<blockquote>\n<p>Can you describe its spec?</p>\n</blockquote>\n<p>It’s a tactic that searches for atomic numbers and associated finiteness proofs and lifts the ENNReal to the reals. It solves it in the reals using ring and norm_num. Works with basic equations.</p>",
        "id": 540412811,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1758274603
    },
    {
        "content": "<p>What does the tactic do if the first step (lifting) works, but the second one (prove in R) fails?</p>",
        "id": 540412963,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1758274648
    },
    {
        "content": "<p>(Should these be two separate tactics? Or should the tactic do only the first, if it succeeds? The in-progress <code>field</code> tactic does the latter, so there is some precedent.)</p>",
        "id": 540413082,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1758274683
    },
    {
        "content": "<p>\"basic equations\" seems pretty vague. I'd much prefer to see the lifting part as a standalone --- can this be done using <code>lift</code>?</p>",
        "id": 540413601,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1758274863
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Where.20to.20open.20a.20PR.20to.20upstream.20ENNReal.20normaliser.20tactic/near/540413082\">said</a>:</p>\n<blockquote>\n<p>(Should these be two separate tactics? Or should the tactic do only the first, if it succeeds? The in-progress <code>field</code> tactic does the latter, so there is some precedent.)</p>\n</blockquote>\n<p>It emits an error saying the equality is not true.</p>",
        "id": 540436444,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1758282737
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Where.20to.20open.20a.20PR.20to.20upstream.20ENNReal.20normaliser.20tactic/near/540413601\">said</a>:</p>\n<blockquote>\n<p>\"basic equations\" seems pretty vague. I'd much prefer to see the lifting part as a standalone --- can this be done using <code>lift</code>?</p>\n</blockquote>\n<p>Maybe it could be done with the lift tactic, but I’m still fairly new to lean. I don’t know how to use it yet.</p>",
        "id": 540436559,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1758282781
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Where.20to.20open.20a.20PR.20to.20upstream.20ENNReal.20normaliser.20tactic/near/540413601\">said</a>:</p>\n<blockquote>\n<p>\"basic equations\" seems pretty vague. I'd much prefer to see the lifting part as a standalone --- can this be done using <code>lift</code>?</p>\n</blockquote>\n<p>I had a try to use the lift tactic and implemented the CanLift class but I  couldn’t rewrite my tactic definition into using the lift tactic.</p>",
        "id": 541071705,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1758650348
    },
    {
        "content": "<p>I think a better reference for this might be something like the <code>enat_to_nat</code> tactic, described here: <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Mathlib.Tactic.ENatToNat.tacticEnat_to_nat#doc\">docs#Mathlib.Tactic.ENatToNat.tacticEnat_to_nat</a>. Having this for <code>ennreal_to_real</code> or <code>ennreal_to_nnreal</code> would be nice. Then your tactic would just become <code>ennreal_to_real; norm_num</code>.</p>",
        "id": 541096584,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1758660322
    },
    {
        "content": "<p>Of course, if it's possible to unify these tactics somehow, that would be even better.</p>",
        "id": 541096745,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1758660383
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Where.20to.20open.20a.20PR.20to.20upstream.20ENNReal.20normaliser.20tactic/near/541096584\">said</a>:</p>\n<blockquote>\n<p>I think a better reference for this might be something like the <code>enat_to_nat</code> tactic, described here: <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Mathlib.Tactic.ENatToNat.tacticEnat_to_nat#doc\">docs#Mathlib.Tactic.ENatToNat.tacticEnat_to_nat</a>. Having this for <code>ennreal_to_real</code> or <code>ennreal_to_nnreal</code> would be nice. Then your tactic would just become <code>ennreal_to_real; norm_num</code>.</p>\n</blockquote>\n<p>That looks like a really useful reference! Thanks! Maybe my tactic could as short as well <span aria-label=\"smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"smile\">:smile:</span>.</p>",
        "id": 541098432,
        "sender_full_name": "Willem vanhulle",
        "timestamp": 1758660998
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Where.20to.20open.20a.20PR.20to.20upstream.20ENNReal.20normaliser.20tactic/near/541096745\">said</a>:</p>\n<blockquote>\n<p>Of course, if it's possible to unify these tactics somehow, that would be even better.</p>\n</blockquote>\n<p>I assume you mean \"unify <code>enat_to_nat</code> with <code>ennreal_to_real</code>\". This is a good idea.</p>\n<p>I hope you don't mean \"unify <code>ennreal_to_real</code> with <code>norm_num</code>\". This is a bad idea (there is a unification that would be useful, but it is not possible to reach that point starting with, or calling, <code>norm_num</code>).</p>",
        "id": 541172760,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1758703046
    }
]