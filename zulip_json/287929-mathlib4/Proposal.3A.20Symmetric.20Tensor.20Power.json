[
    {
        "content": "<p>In the process of thinking about generalisations of affine space and projective space, it has occurred to me that perhaps defining the symmetric tensor powers of a module might be beneficial.</p>\n<p>If M is an R-module and n is a natural number (perhaps can be an arbitrary fintype), then Sym^n(M) is the n-th tensor power of M, quotient out by the relation that x1 ⊗ₜ x2 ⊗ₜ ... ⊗ₜ xn = that but reorder the indices. (Do we have generalisation of quotients to monoids yet? I've deliberately avoided the use of subtraction.) (Sym^0(M) = R.)</p>\n<p>Then, ⊕_n Sym^n(M) has the structure of a graded R-algebra. It is actually the left adjoint of the forgetful functor R-Alg ⥤ R-Mod.</p>\n<p>Currently MvPolynomial σ R is actually a special case of this, for M = free module generated by σ. Note that this grading agrees with the homogeneous grading.</p>\n<p>Typing this, I realised that it is possible to do this by passing through MvPolynomial σ R, since any module is a quotient of a free module. So I suppose I would like to also discuss the merits of this alternative construction. (Actually, I've heard that this pathway would depend on a pending PR?)</p>\n<p>This thread also serves to gauge the interest of the community in this construction. If enough people are interested, then I'll try to come up with the basic definition and make a small PR.</p>",
        "id": 524795235,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750288567
    },
    {
        "content": "<p>I'll split the part about quotient of a monoid to a separate thread.</p>",
        "id": 524795363,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750288690
    },
    {
        "content": "<p>Is this <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SymmetricAlgebra#doc\">docs#SymmetricAlgebra</a> ?</p>",
        "id": 524795427,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1750288734
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SymmetricAlgebra.lift#doc\">docs#SymmetricAlgebra.lift</a> is the universal property you want</p>",
        "id": 524795623,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1750288868
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"268315\">@Anatole Dedecker</span> aha, that is indeed the \"global\" version, but I suspect that by throwing away some work, it might be harder to recover a grading from the algebra... unless there's a smart trick somehow</p>",
        "id": 524795663,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750288895
    },
    {
        "content": "<p>by global I mean that you have sidestepped the Sym^n(R) construction and went directly for the graded algebra</p>",
        "id": 524795698,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750288928
    },
    {
        "content": "<p>I suspect we can still do this by first showing that the commutativity relation on the tensor algebra (which is the version for R-Alg without commutativity condition) is \"homogeneous\"...</p>",
        "id": 524795785,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750288993
    },
    {
        "content": "<p>I don’t know the state of the grading API, but in theory you should be able to just say that the ideal is homogeneous right ? That said maybe it’s not ideal in some setups when we need one fixed n</p>",
        "id": 524795816,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1750289009
    },
    {
        "content": "<p>there's also a universal property satisfied by Sym^n(M): maps from that is equivalent to symmetric n-linear functions</p>",
        "id": 524795849,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750289032
    },
    {
        "content": "<p>there is also a \"sanity check\" that Sym^k(R^n) is a free module of dimension (n+k-1) choose k</p>",
        "id": 524795948,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750289099
    },
    {
        "content": "<p>it is also functorial and respects base change</p>",
        "id": 524796009,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750289136
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"268315\">Anatole Dedecker</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Proposal.3A.20Symmetric.20Tensor.20Power/near/524795816\">said</a>:</p>\n<blockquote>\n<p>I don’t know the state of the grading API, but in theory you should be able to just say that the ideal is homogeneous right ? That said maybe it’s not ideal in some setups when we need one fixed n</p>\n</blockquote>\n<p>What's the generalisation of ideal called? If we're working with monoids</p>",
        "id": 524796544,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750289504
    },
    {
        "content": "<p>I guess I could call it \"congruence\"</p>",
        "id": 524796558,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750289516
    },
    {
        "content": "<p>I don't know, it's theoretically possible since the definition is mathematically correct, but I feel like we might have thrown too much work away.</p>",
        "id": 524796625,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750289564
    },
    {
        "content": "<p>Honestly, everything could indeed work out, but I'm not very confident that this is the \"correct\" approach... whatever \"correct\" even means</p>",
        "id": 524796786,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750289678
    },
    {
        "content": "<p>It's also the approach taken by <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/LinearAlgebra/ExteriorAlgebra/Basic.html#ExteriorAlgebra\">ExteriorAlgebra</a> and the universal property is available as <del><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/LinearAlgebra/ExteriorAlgebra/OfAlternating.html#ExteriorAlgebra.liftAlternatingEquiv\">ExteriorAlgebra.liftAlternatingEquiv</a></del> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/LinearAlgebra/ExteriorPower/Basic.html#exteriorPower.alternatingMapLinearEquiv\">exteriorPower.alternatingMapLinearEquiv</a>; maybe you can mimic the proof. Bases of the exterior powers is at <a href=\"https://github.com/leanprover-community/mathlib4/pull/18771\">#18771</a>.</p>\n<p>Homogeneous relations were PR'd as <a href=\"https://github.com/leanprover-community/mathlib4/pull/22279\">#22279</a>.</p>",
        "id": 524846995,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1750324895
    },
    {
        "content": "<p>aha that's the pending PR, i'll wait for that PR then</p>",
        "id": 524847244,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750325014
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> has marked this topic as resolved.</p>",
        "id": 524847338,
        "sender_full_name": "Notification Bot",
        "timestamp": 1750325056
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"224323\">@Junyan Xu</span> actually, what do you think? which pathway is better? a direct construction, or via the grading and homogeneous quotient?</p>",
        "id": 524848699,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750325610
    },
    {
        "content": "<p>I suspect it wouldn't actually be hard to construct it by hand, i could probably do it in 20 lines</p>",
        "id": 524848806,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750325653
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">TensorProduct</span><span class=\"w\"> </span><span class=\"n\">Equiv</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommSemiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">SymmetricPower</span><span class=\"bp\">.</span><span class=\"n\">Rel</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">⨂</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"bp\">^</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">⨂</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"bp\">^</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">perm</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Perm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Rel</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⨂ₜ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⨂ₜ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">))</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">SymmetricPower</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommSemiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">AddCon</span><span class=\"bp\">.</span><span class=\"n\">Quotient</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">addConGen</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">SymmetricPower</span><span class=\"bp\">.</span><span class=\"n\">Rel</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span>\n</code></pre></div>",
        "id": 524850732,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750326425
    },
    {
        "content": "<p>This is the direct construction.</p>",
        "id": 524850756,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750326434
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> has marked this topic as unresolved.</p>",
        "id": 524850766,
        "sender_full_name": "Notification Bot",
        "timestamp": 1750326437
    },
    {
        "content": "<p>I think both have their own advantages and make different things easier to prove. It's nice that the \"indirect\" approach via RingCon only requires relations in degree 2, for example.</p>",
        "id": 524852314,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1750327048
    },
    {
        "content": "<p>Whichever approach we end up choosing, we should try to have a coherent API. The way I am personaly thinking about the symmetric algebra is as the direct sum of the symmetric powers (defined as you suggest), and there, using the universal property of each symmetric power as a module, we can deduce that the symmetric algebra satisfies a universal property as a graded algebra. I do not know how to prove the universal property of the individual symmetric powers if we start from the full symmetric algebra.</p>",
        "id": 524852858,
        "sender_full_name": "Joël Riou",
        "timestamp": 1750327233
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"459699\">@Joël Riou</span> (the symmetric algebra is already in mathlib using the \"indirect\" approach)</p>",
        "id": 524853004,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750327295
    },
    {
        "content": "<p>Yes, so the question is: if we keep this definition, and define the symmetric <code>n</code>th power as the submodule generated by <code>n</code>-uple products, how do we show that it satisfies the universal property it should satisfy as a module. If we cannot, we may consider changing the definitions?</p>",
        "id": 524853582,
        "sender_full_name": "Joël Riou",
        "timestamp": 1750327526
    },
    {
        "content": "<p>You coauthored <a href=\"https://github.com/leanprover-community/mathlib4/pull/18590\">#18590</a> and you think the symmetric power version is much different from the exterior power version?</p>",
        "id": 524855607,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1750328468
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">TensorProduct</span><span class=\"w\"> </span><span class=\"n\">Equiv</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommSemiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">SymmetricPower</span><span class=\"bp\">.</span><span class=\"n\">Rel</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">⨂</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"bp\">^</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">⨂</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"bp\">^</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">perm</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Perm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Rel</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⨂ₜ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⨂ₜ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">))</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">SymmetricPower</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommSemiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">AddCon</span><span class=\"bp\">.</span><span class=\"n\">Quotient</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">addConGen</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">SymmetricPower</span><span class=\"bp\">.</span><span class=\"n\">Rel</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">SymmetricPower</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">SymmetricPower</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">AddCon</span><span class=\"bp\">.</span><span class=\"n\">addCommMonoid</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">smul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">⨂</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"bp\">^</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">addConGen</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Rel</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">addConGen</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Rel</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">perm</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">addConGen</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Rel</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">          </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">AddConGen</span><span class=\"bp\">.</span><span class=\"n\">Rel</span><span class=\"bp\">.</span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Rel</span><span class=\"bp\">.</span><span class=\"n\">perm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)))</span>\n<span class=\"w\">          </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MultilinearMap</span><span class=\"bp\">.</span><span class=\"n\">map_update_smul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">update_eq_self</span><span class=\"o\">]</span>\n<span class=\"w\">          </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp_rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">update_apply_equiv_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">MultilinearMap</span><span class=\"bp\">.</span><span class=\"n\">map_update_smul</span><span class=\"o\">,</span>\n<span class=\"w\">              </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">update_comp_equiv</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">update_eq_self</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">AddCon</span><span class=\"bp\">.</span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"bp\">..</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">AddCon</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">assumption</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">AddCon</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">assumption</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">smul_add</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">smul_add</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">AddCon</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">assumption</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">smul'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SymmetricPower</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→+</span><span class=\"w\"> </span><span class=\"n\">SymmetricPower</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">AddCon</span><span class=\"bp\">.</span><span class=\"n\">lift</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">AddMonoidHom</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">AddCon</span><span class=\"bp\">.</span><span class=\"n\">mk'</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">      </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"n\">map_zero'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">smul_zero</span><span class=\"w\"> </span><span class=\"n\">r</span>\n<span class=\"w\">      </span><span class=\"n\">map_add'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">smul_add</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">})</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">Quotient</span><span class=\"bp\">.</span><span class=\"n\">sound</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">smul</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">))</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">SymmetricPower</span>\n</code></pre></div>",
        "id": 524856845,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750329011
    },
    {
        "content": "<p>I've written more code in case it's useful later</p>",
        "id": 524856855,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750329016
    },
    {
        "content": "<p>The module stuff should be generalised first (see <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/Proposal.3A.20Quotient.20of.20monoid/with/524795534\">#mathlib4 &gt; Proposal: Quotient of monoid</a>)</p>",
        "id": 524856941,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750329053
    },
    {
        "content": "<p>/poll Which pathway would you prefer?<br>\nDirect construction: pending smul on congruence<br>\nIndirect construction via symmetric algebra: pending homogeneous quotient</p>",
        "id": 524858889,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750329912
    },
    {
        "content": "<p>Let's put it to a vote.</p>",
        "id": 524858905,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750329920
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"224323\">Junyan Xu</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Proposal.3A.20Symmetric.20Tensor.20Power/near/524855607\">said</a>:</p>\n<blockquote>\n<p>You coauthored <a href=\"https://github.com/leanprover-community/mathlib4/pull/18590\">#18590</a> and you think the symmetric power version is much different from the exterior power version?</p>\n</blockquote>\n<p>Then, I only deduced the categorical formulation from the unbundled formulation (the proof of which I did not study...).</p>",
        "id": 524872455,
        "sender_full_name": "Joël Riou",
        "timestamp": 1750335271
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/26192\">#26192</a> created</p>",
        "id": 524959689,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750377542
    },
    {
        "content": "<p>Why not define symmetric powers as in your PR and the symmetric algebra as the quotient of the tensor algebra, then construct the (natural) isomorphism?</p>",
        "id": 524961636,
        "sender_full_name": "Scott Carnahan",
        "timestamp": 1750378812
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"630477\">Scott Carnahan</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Proposal.3A.20Symmetric.20Tensor.20Power/near/524961636\">said</a>:</p>\n<blockquote>\n<p>Why not define symmetric powers as in your PR and the symmetric algebra as the quotient of the tensor algebra, then construct the (natural) isomorphism?</p>\n</blockquote>\n<p>How do you construct the map from the other side?</p>",
        "id": 524963292,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750379983
    },
    {
        "content": "<p>Do you mean the map from the degree n part of the symmetric algebra to the nth symmetric power? My guess for a first step would be to show that both are quotients of the degree n part of the tensor algebra, on one hand identifying it with the nth tensor power and on the other using the homogeneity of the quotient map of algebras.</p>",
        "id": 524963916,
        "sender_full_name": "Scott Carnahan",
        "timestamp": 1750380566
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Proposal.3A.20Symmetric.20Tensor.20Power/near/524963292\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"630477\">Scott Carnahan</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Proposal.3A.20Symmetric.20Tensor.20Power/near/524961636\">said</a>:</p>\n<blockquote>\n<p>Why not define symmetric powers as in your PR and the symmetric algebra as the quotient of the tensor algebra, then construct the (natural) isomorphism?</p>\n</blockquote>\n<p>How do you construct the map from the other side?</p>\n</blockquote>\n<p>I think that can be directly constructed from a graded ringHom from the tensor algebra to the symmetric powers, then take the (graded) <code>RingQuot</code> by the homogeneous relation (defined as xy-yx)? I think that many things still need to done for graded objects (e.g. graded ringHom), but of course we can try to add that.</p>",
        "id": 524964810,
        "sender_full_name": "Wang Jingting",
        "timestamp": 1750381419
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"630477\">@Scott Carnahan</span> <span class=\"user-mention\" data-user-id=\"750070\">@Wang Jingting</span> that's why i said above, this is pending the \"homogeneous quotient\" PR (<a href=\"https://github.com/leanprover-community/mathlib4/pull/22279\">#22279</a>)</p>",
        "id": 524995803,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750406953
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/26192\">#26192</a> (symmetric tensor power) is now a month old, can we decide if we want <code>Fin n</code> or arbitrary fintype? The latter would likely require a refactor of tensor power as well, and I don't think this PR should be held up by a future refactor.</p>",
        "id": 532889649,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1754391295
    },
    {
        "content": "<p>It doesn't look like you use <code>TensorPower</code> here at all, so it's not relevant that this is indexed over a <code>Nat</code>. You're already using <code>PiTensorProduct</code>, which is arbitrarily indexed.</p>",
        "id": 533004752,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1754438817
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> <code>⨂[R]^n M</code> in <a href=\"https://github.com/leanprover-community/mathlib4/pull/26192/files#diff-1779a9adbc1b3d226451e13217e1b877db70ca4c20b362ff70f11a92f651c004R41\">L41</a> is TensorPower</p>",
        "id": 533005184,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1754439220
    },
    {
        "content": "<p>I guess if we really wanted to go nuts here we could have the elements dependently-typed and pass around a family of isomorphisms between every pair too</p>",
        "id": 533005312,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1754439367
    },
    {
        "content": "<p>(I doubt that's actually a good idea!)</p>",
        "id": 533005359,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1754439395
    },
    {
        "content": "<p>I think Kim's point is that you could swap that for <code>PiTensorProduct</code> and everything would keep working</p>",
        "id": 533005475,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1754439492
    },
    {
        "content": "<p>People happy now?</p>",
        "id": 533252973,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1754558716
    }
]