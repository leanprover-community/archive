[
    {
        "content": "<p>Currently, probability measures take values in the extended nonnegative reals. This makes manipulating probabilities pretty clunky, as simple tactics like ring do not work and I need to use the ENNReal version. Would it be possible to change probability measures in mathlib so they take values in the non-negative reals (or just reals)?</p>\n<p><span class=\"user-mention\" data-user-id=\"111080\">@Floris van Doorn</span> <span class=\"user-mention\" data-user-id=\"350992\">@Rémy Degenne</span> <span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span></p>",
        "id": 511522347,
        "sender_full_name": "Fred Rajasekaran",
        "timestamp": 1744325603
    },
    {
        "content": "<p>Maybe something with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.FiniteMeasure#doc\">docs#MeasureTheory.FiniteMeasure</a></p>",
        "id": 511522712,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1744325797
    },
    {
        "content": "<p>I spoke with Fred this week, and I think this would be useful to do.<br>\nCarleson has the <code>MeasureReal</code> file (coming from PFR) which defines for an arbitrary measure the <code>.real</code> function, which is a real value.<br>\nThis will give you the right function, and I think it's worth it to duplicate a whole lot of lemmas about measure to also work with this function.</p>\n<p>For probability theory, I can imagine that we want the coercion-to-functions of a probability measure (or finite measure) to use this function by default. If we want to do that, I think we have to make <code>FiniteMeasure</code> a separate structure (not a mixin on top of <code>Measure</code>).</p>\n<p>I'm curious what the people that actually use probability theory think.</p>",
        "id": 511527515,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1744328138
    },
    {
        "content": "<p>(additional ping: <span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span>)</p>",
        "id": 511527611,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1744328174
    },
    {
        "content": "<p>Currently, probability in Mathlib is done with <code>{P : Measure α} [IsProbabilityMeasure P]</code>, not <code>{P : ProbabilityMeasure α}</code>. A bundled <code>ProbabilityMeasure</code> type is used as a tool to define/use the topology on the space of finite/probability measures.</p>",
        "id": 511532969,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744331161
    },
    {
        "content": "<p>If we want to change this, then we should figure out how to make definitions like <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.ae#doc\">docs#MeasureTheory.ae</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.Measure.AbsolutelyContinuous#doc\">docs#MeasureTheory.Measure.AbsolutelyContinuous</a> codomain-polymorphic.</p>",
        "id": 511533157,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744331244
    },
    {
        "content": "<p>Adding a separate <code>FiniteMeasure</code> structure might be a bigger endeavor than I anticipated. It will also affect integrals etc. That might not be worth it.<br>\nI didn't know we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.OuterMeasureClass#doc\">docs#MeasureTheory.OuterMeasureClass</a> for <code>Measure.ae</code>.</p>",
        "id": 511535585,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1744332732
    },
    {
        "content": "<p>I added it a few months ago, because I wanted to generalize some lemmas so that they work for <code>OuterMeasure</code> and <code>Measure</code>.</p>",
        "id": 511536944,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744333609
    },
    {
        "content": "<p>We already have thought about it, and we definitely want to keep probability measures as genuine measures with a typeclass <code>[IsProbabilityMeasure P]</code>, because there is so much API for measures (integrals, almost everywhere behavior, restrictions, and so on). However, it's true that having the real-valued versions has definitely proved useful, both in PFR and in Carleson, which is why we had introduced <code>P.real</code> there. Since this keeps coming back and has already been used in two projects, I think this is ample proof that this is useful, and high time to upstream. I've just opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/23943\">#23943</a> for this.</p>",
        "id": 511603572,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1744363528
    },
    {
        "content": "<p>Thank you Sébastien! I wasn't feeling very confident upstreaming that myself</p>",
        "id": 511604288,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1744363747
    },
    {
        "content": "<p>Does someone plan to replace <code>(μ s).toReal</code> with <code>μ.real s</code> in Mathlib?</p>",
        "id": 511752840,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744415462
    },
    {
        "content": "<p>If not, then I can do it (but I have other plans too).</p>",
        "id": 511752854,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1744415474
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Probability.20Measure.20Type.20in.20Mathlib/near/511752840\">said</a>:</p>\n<blockquote>\n<p>Does someone plan to replace <code>(μ s).toReal</code> with <code>μ.real s</code> in Mathlib?</p>\n</blockquote>\n<p>I'm working on it.</p>",
        "id": 512776834,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1744881217
    },
    {
        "content": "<p>PR at <a href=\"https://github.com/leanprover-community/mathlib4/pull/24204\">#24204</a>. long (910/-698), but mostly straighforward and repetitive. Touches 100 files, will rot very quickly.</p>",
        "id": 513191372,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1745085082
    },
    {
        "content": "<p>Took a look at the first quarter: I'll need to get off the train soon - but posted where I stopped - so others may continue from there.</p>",
        "id": 513194079,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1745087208
    },
    {
        "content": "<p>Ah didn't see Michael's message. I went through the whole PR and left a few comments.</p>",
        "id": 513202757,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1745094674
    }
]