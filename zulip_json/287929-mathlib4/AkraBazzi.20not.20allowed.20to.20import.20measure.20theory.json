[
    {
        "content": "<p>The directory dependency linter prevents files in <code>Computability</code> from importing files in <code>MeasureTheory</code>. In particular, the file <code>Computability.AkraBazzi.AkraBazzi</code> is not allowed to import any measure theory. But I'm running into problems on <a href=\"https://github.com/leanprover-community/mathlib4/pull/34456\">#34456</a> where the reasonable looking import of <code>Analysis.Meromorphic.Basic</code> into <code>Analysis.SpecialFunctions.Complex.LogDeriv</code> is resulting in a problem via the following chain:<br>\n<code>MeasureTheory.Constructions.BorelSpace.Basic -&gt; Analysis.Meromorphic.Basic -&gt; Analysis.SpecialFunctions.Complex.LogDeriv -&gt; Analysis.SpecialFunctions.Pow.Deriv -&gt; Computability.AkraBazzi.AkraBazzi</code>.</p>\n<p>Any thoughts on what should be done here?</p>",
        "id": 570131870,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1769443523
    },
    {
        "content": "<p>Can the final import be made private?</p>",
        "id": 570132466,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769443653
    },
    {
        "content": "<p>Yes, but that doesn't appease the linter</p>",
        "id": 570132692,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1769443705
    },
    {
        "content": "<p>Then probably the linter should be fixed!</p>",
        "id": 570133845,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769444026
    },
    {
        "content": "<p>We developed a lot of tooling before the module system became a thing, before even we really understood what modules were. I expect there will be a lot of thinking required to update this tooling to the new reality of things</p>",
        "id": 570134311,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769444139
    },
    {
        "content": "<p>I don't think this linter makes much sense in the first place, it's simply not true that no result about computability involves measure theory. In fact the standard statement of Akra Bazzi literally has an integral in it; as far as I know mathlib is the only place that states it using a sum.</p>",
        "id": 570134831,
        "sender_full_name": "Frédéric Dupuis",
        "timestamp": 1769444273
    },
    {
        "content": "<p>For now I've added an exception for Akra-Bazzi to the PR, but both of these points are worth looking into I think.</p>",
        "id": 570135576,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1769444471
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/287929-mathlib4/topic/AkraBazzi.20not.20allowed.20to.20import.20measure.20theory/near/570133845\">said</a>:</p>\n<blockquote>\n<p>Then probably the linter should be fixed!</p>\n</blockquote>\n<p>Although isn't the linter mostly to avoid nasty circular import issues long-term? You can still have circular imports with private imports, right?</p>",
        "id": 570136054,
        "sender_full_name": "Thomas Browning",
        "timestamp": 1769444595
    },
    {
        "content": "<p>Length 2 cycles only, so that's fine?</p>",
        "id": 570136896,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769444817
    },
    {
        "content": "<p>No, it's more about modularizing mathlib</p>",
        "id": 570136927,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1769444823
    },
    {
        "content": "<p>As far as I understand, the initial list of banned imports was built based on what was in the repo, not based on what should be banned forever. I think that it should act like a reminder to think once if the import is actually needed (and add an exception or remove an entry, if it is) rather than a big \"NO\".</p>",
        "id": 570139220,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1769445443
    },
    {
        "content": "<p>E.g., I'm going to allow complex analysis to import algebraic topology soon, because you need simply connected sets etc for the Riemann mapping theorem.</p>",
        "id": 570139377,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1769445481
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/AkraBazzi.20not.20allowed.20to.20import.20measure.20theory/near/570139220\">said</a>:</p>\n<blockquote>\n<p>As far as I understand, the initial list of banned imports was built based on what was in the repo, not based on what should be banned forever. I think that it should act like a reminder to think once if the import is actually needed (and add an exception or remove an entry, if it is) rather than a big \"NO\".</p>\n</blockquote>\n<p>As the developer of this linter, Yuri is exactly right. Adding an exception allowing <code>Computability.AkraBazzi</code> to import <code>MeasureTheory</code> is the way to go here.</p>",
        "id": 570152765,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1769449141
    },
    {
        "content": "<p>Should the warning/error message of the linter communicate this better? (I haven't studied it.)</p>",
        "id": 570168320,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1769454144
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/287929-mathlib4/topic/AkraBazzi.20not.20allowed.20to.20import.20measure.20theory/near/570139377\">said</a>:</p>\n<blockquote>\n<p>E.g., I'm going to allow complex analysis to import algebraic topology soon, because you need simply connected sets etc for the Riemann mapping theorem.</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/33364\">#33364</a> on abstract simplicial complexes is also currently blocked by the rule that analysis files can't import algebraic topology files, so that would be another argument to remove that specific rule - though if I understand this thread right, the solution until that happens is to just add an exception for that file?</p>",
        "id": 570187461,
        "sender_full_name": "Ben Eltschig",
        "timestamp": 1769460780
    },
    {
        "content": "<p>I think that we should disable this rule, or restrict it to specific subfolders of <code>Analysis</code>. Say, <code>Analysis/Calculus</code>, until it needs algebraic topology.</p>",
        "id": 570192400,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1769462945
    },
    {
        "content": "<p>Adding an exception to the rule (e.g., for <code>Analysis/Convex/SimplicialComplex</code>) seems reasonable to me.</p>",
        "id": 570197705,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1769465407
    }
]