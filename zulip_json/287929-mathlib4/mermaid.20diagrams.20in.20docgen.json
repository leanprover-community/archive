[
    {
        "content": "<p>If I put a mermaid diagram in a library note, will docgen render it? I thought it would, but I was having trouble building the documentation locally in order to find out.</p>",
        "id": 502908918,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1740956297
    },
    {
        "content": "<p>Context: <a href=\"https://github.com/leanprover-community/mathlib4/pull/22172\">#22172</a></p>",
        "id": 502909000,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1740956355
    },
    {
        "content": "<p>I strongly suspect the answer is no, but we could probably make a PR to doc-gen after the fact</p>",
        "id": 502912186,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740958902
    },
    {
        "content": "<p>As far as I know, no. In order to implement it I think we need to postprocess the HTML returned by md4c, filter the <code>&lt;code class=\"language-mermaid\"&gt;</code> and send the contents of it to external program.</p>\n<p>And now we can't insert pictures in doc-gen yet. This need to be developed as we need a way to track external pictures which probably will be generated by the above external program.</p>\n<p>By the way, I think currently doc-gen does not render library note at all?</p>",
        "id": 502955713,
        "sender_full_name": "Jz Pan",
        "timestamp": 1740986060
    },
    {
        "content": "<p>I think mermaid runs client side?</p>",
        "id": 502982422,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740995283
    },
    {
        "content": "<p>So all we have to do is add the JavaScript to the page template</p>",
        "id": 502982542,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740995316
    },
    {
        "content": "<p>But we still need doc-gen to load the script</p>",
        "id": 502982560,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1740995322
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/mermaid.20diagrams.20in.20docgen/near/502982560\">said</a>:</p>\n<blockquote>\n<p>But we still need doc-gen to load the script</p>\n</blockquote>\n<p>Then it's easy, just modify the template file is OK.</p>",
        "id": 503041900,
        "sender_full_name": "Jz Pan",
        "timestamp": 1741012502
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/doc-gen4/blob/main/DocGen4/Output/Template.lean\">https://github.com/leanprover/doc-gen4/blob/main/DocGen4/Output/Template.lean</a></p>",
        "id": 503043606,
        "sender_full_name": "Jz Pan",
        "timestamp": 1741012923
    },
    {
        "content": "<p>As <span class=\"user-mention silent\" data-user-id=\"366779\">Jz Pan</span> points out, we don't currently do <em>anything</em> with library notes in docgen, so this is moot. (See: <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/HierarchyDesign.html\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/HierarchyDesign.html</a>)</p>",
        "id": 503126583,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1741037163
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"311453\">@Frédéric Dupuis</span> what would you like me to do for <a href=\"https://github.com/leanprover-community/mathlib4/pull/22172\">#22172</a>? Make an ASCII art diagram?</p>",
        "id": 503126693,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1741037196
    },
    {
        "content": "<p>I think we should merge as is with mermaid, and then make a PR to doc-gen</p>",
        "id": 503126804,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1741037240
    },
    {
        "content": "<p>The mermaid isn't going to be rendered in VSCode anyway, but it's easy enough to render online via <a href=\"https://codapi.org/mermaid/\">https://codapi.org/mermaid/</a> for someone who wants to look at it while we work out what doc-gen should do</p>",
        "id": 503126840,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1741037253
    },
    {
        "content": "<p>Is <code>library_note</code> a feature for core Lean or only for mathlib? If it's latter, I've remembered that doc-gen will not add features only work for mathlib...</p>\n<p>Technical level, I think it's not hard to rendere <code>library_note</code>, just pretend it to be a <code>/-! ... -/</code>, adds a header <code>## Library note: &lt;name&gt;</code> then append the contents of <code>/-- ... -/</code>.</p>",
        "id": 503168037,
        "sender_full_name": "Jz Pan",
        "timestamp": 1741057011
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/mermaid.20diagrams.20in.20docgen/near/503126693\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"311453\">Frédéric Dupuis</span> what would you like me to do for <a href=\"https://github.com/leanprover-community/mathlib4/pull/22172\">#22172</a>? Make an ASCII art diagram?</p>\n</blockquote>\n<p>I think I would vote for ASCII art, it's not a very big diagram, and my guess is that people won't bother to figure out how to compile it.</p>",
        "id": 503577461,
        "sender_full_name": "Frédéric Dupuis",
        "timestamp": 1741194266
    },
    {
        "content": "<p>So, ASCII art in a code block? That way, when it does get rendered elsewhere, the ASCII art isn't destroyed by a kerned font?</p>",
        "id": 503579206,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1741194593
    },
    {
        "content": "<p>Yeah</p>",
        "id": 503584313,
        "sender_full_name": "Frédéric Dupuis",
        "timestamp": 1741195656
    },
    {
        "content": "<p>Maybe chatgpt can do it for you</p>",
        "id": 503644555,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1741212632
    },
    {
        "content": "<p>mermaid-ascii exists</p>",
        "id": 503652615,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1741215713
    },
    {
        "content": "<p>It seems to me like the ~5 line change to doc-gen is easier than any of these options</p>",
        "id": 503653436,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1741216103
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/mermaid.20diagrams.20in.20docgen/near/503653436\">said</a>:</p>\n<blockquote>\n<p>It seems to me like the ~5 line change to doc-gen is easier than any of these options</p>\n</blockquote>\n<p>The problem is that it does not render in VSCode pop-up tooltips.</p>",
        "id": 503708075,
        "sender_full_name": "Jz Pan",
        "timestamp": 1741242205
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"311453\">@Frédéric Dupuis</span> I've switched to ASCII-art in <a href=\"https://github.com/leanprover-community/mathlib4/pull/22172\">#22172</a></p>",
        "id": 505466369,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1741882475
    },
    {
        "content": "<blockquote>\n<p>The problem is that it does not render in VSCode pop-up tooltips.</p>\n</blockquote>\n<p>This doesn't happen in library notes anyway</p>",
        "id": 505474308,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1741884510
    }
]