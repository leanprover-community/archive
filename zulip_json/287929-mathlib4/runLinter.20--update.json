[
    {
        "content": "<p>(Other aside: it looks to me like the existing <code>runLinter --update</code> doesn't work as intended? It just writes the declarations that failed to the nolint file. It should presumably only be writing failing declarations <em>already in the nolints file</em> to the nolints file, right?)</p>",
        "id": 566412983,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1767636679
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"548935\">Thomas Murrills</span> <a href=\"#narrow/channel/287929-mathlib4/topic/slow.20linting.20step.20CI.3F/near/566412983\">said</a>:</p>\n<blockquote>\n<p>Other aside: it looks to me like the existing <code>runLinter --update</code> doesn't work as intended?</p>\n</blockquote>\n<p>(<a href=\"https://github.com/leanprover-community/batteries/pull/1600\">batteries#1600</a>)</p>",
        "id": 566420001,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1767639500
    },
    {
        "content": "<p>I can't remember exactly, but I seem to recall that the whole point of these update commands was to allow us to easily add new violations to the nolints file. Maybe I'm missing something though.</p>",
        "id": 566424940,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1767641578
    },
    {
        "content": "<p>Hmm, so maybe the docstring is wrong? It says it “removes any declarations that no longer need to be nolinted”.</p>\n<p>I can imagine both functionalities would be useful…!</p>",
        "id": 566425256,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1767641721
    },
    {
        "content": "<p>Ah, now that I read your explanation in <a href=\"https://github.com/leanprover-community/batteries/pull/1600\">batteries#1600</a> I understand your point. I guess I had never considered that case, but now I can imagine there being cases where we would want one behavior or the other.</p>",
        "id": 566425368,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1767641774
    },
    {
        "content": "<p>4 messages were moved here from <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/slow.20linting.20step.20CI.3F/with/566414623\">#mathlib4 &gt; slow linting step CI?</a> by <span class=\"user-mention silent\" data-user-id=\"123965\">Bryan Gin-ge Chen</span>.</p>",
        "id": 566425534,
        "sender_full_name": "Notification Bot",
        "timestamp": 1767641848
    },
    {
        "content": "<p><a href=\"#narrow/channel/287929-mathlib4/topic/runLinter.20--update/near/566412983\">A message</a> was moved here from <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/slow.20linting.20step.20CI.3F/with/566425536\">#mathlib4 &gt; slow linting step CI?</a> by <span class=\"user-mention silent\" data-user-id=\"123965\">Bryan Gin-ge Chen</span>.</p>",
        "id": 566425581,
        "sender_full_name": "Notification Bot",
        "timestamp": 1767641867
    },
    {
        "content": "<p>So, should we have two separate flags? Or <code>--update!</code>, even? Happy to make a PR for whatever design we want! :)</p>",
        "id": 566425647,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1767641897
    },
    {
        "content": "<p>(Note that I think the current “add new violations” behavior would also need a tweak: currently it erases nolints that pertain to modules which are not currently being linted. Not a problem when we only ever lint the one module, but in general… <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span>)</p>",
        "id": 566425898,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1767641995
    },
    {
        "content": "<p>My guess is that the only regular user of the <code>--update</code> option right now is <a href=\"https://github.com/leanprover-community/mathlib4/blob/master/.github/workflows/nolints.yml\">this workflow</a> that runs weekly, so my instinct would be to just document this and then move on. </p>\n<p>However, maybe this is also used when people add new linters. Are we typically using <code>--update</code> to populate the nolints file then too?</p>",
        "id": 566426291,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1767642129
    },
    {
        "content": "<p>Hmm, so that workflow effectively just so happens to do a cleanup instead of adding new nolints, because CI ensures there are no new violations, right? <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span></p>",
        "id": 566427684,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1767642651
    },
    {
        "content": "<p>Yep, exactly!</p>",
        "id": 566427731,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1767642670
    },
    {
        "content": "<p>Gotcha!</p>",
        "id": 566427752,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1767642682
    }
]