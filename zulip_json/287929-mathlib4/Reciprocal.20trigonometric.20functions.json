[
    {
        "content": "<p>There are 3 basic trigonometric functions (<code>sin</code>/<code>cos</code>/<code>tan</code>), and 3 operations one can perform on them to get more functions- reciprocal, inverse, hyperbolic. This produces <code>3 * 2 * 2 * 2 = 24</code> functions.<br>\nMathlib has 13 of these- the 12 non-reciprocal functions, plus <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Complex.cot#doc\">docs#Complex.cot</a>.<br>\n(<code>artanh</code> was recently added :)</p>\n<p>Do you think we should add the missing 11, remove <code>cot</code>, or do nothing?<br>\n(it's actually adding 16 because non-inverses have a complex and a real version)</p>\n<p>While it's easy to just write <code>1 / ...</code>, an advantage of adding the functions is that <code>HasSum csc ...</code> looks better than <code>HasSum (1 / sin) ...</code> and in other theorems / trig identities, and makes the results easier to Loogle (standardizes spelling between <code>1 / sin</code> and <code>fun x ↦ 1 / sin x</code>).</p>\n<p>OTOH randomly adding 16 functions sounds weird, even if we include some easy trig identities about them.<br>\n(maybe proving their Taylor series expansion is enough of a non-trivial theorem to motivate adding them?)</p>\n<p>Are these reciprocals used in papers / fancy theorems, or are they a math history relic that is not worth defining?</p>",
        "id": 564822533,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1766230807
    },
    {
        "content": "<p>I tend to think that if we have separate definitions at all for the reciprocal functions, they should not be <code>simp</code>-normal form (and so not have much API beyond the definition). I think all functions and results in <a href=\"https://dlmf.nist.gov/\">DLMF</a> should be in scope for mathlib, but that doesn't mean every function in informal use needs to get its own formal definition when <code>sin⁻¹</code> can be used directly (apart from any potential for confusing those people who use that as informal notation for arcsin).</p>\n<p>We should definitely add the five missing complex inverse trigonometric / hyperbolic functions to mathlib (which might in turn first require adding <code>Complex.sqrt</code>).</p>",
        "id": 564862278,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1766277615
    },
    {
        "content": "<p>Slightly off-topic but I happened to look for <code>Complex.sqrt</code> for other purpose. I ended up just writing <code>^ (1/2)</code> because I don't care which branch it picks for my purpose, but now I wonder what branch cut it actually uses and whether <code>Complex.sqrt</code> can be simply defined as it</p>",
        "id": 564862430,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1766277926
    },
    {
        "content": "<p>I expect <code>^ (1/2)</code> should get the correct branch. I also think that the square root is a case where there's probably enough to say about it that it does make sense to have its own definition and API even if that's defined in terms of <code>^ (1/2)</code>.</p>",
        "id": 564862563,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1766278182
    },
    {
        "content": "<p>It's just <code>a^b = exp(b log a)</code></p>",
        "id": 564862721,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1766278509
    },
    {
        "content": "<p>log is chosen so that the imaginary part is within <code>Ioc (-pi) (pi)</code></p>",
        "id": 564862761,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1766278578
    },
    {
        "content": "<p>and there's a special case for when the base is zero</p>",
        "id": 564862796,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1766278628
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"266253\">Joseph Myers</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Reciprocal.20trigonometric.20functions/near/564862278\">said</a>:</p>\n<blockquote>\n<p>I tend to think that if we have separate definitions at all for the reciprocal functions, they should not be <code>simp</code>-normal form (and so not have much API beyond the definition). I think all functions and results in <a href=\"https://dlmf.nist.gov/\">DLMF</a> should be in scope for mathlib, but that doesn't mean every function in informal use needs to get its own formal definition when <code>sin⁻¹</code> can be used directly (apart from any potential for confusing those people who use that as informal notation for arcsin).</p>\n</blockquote>\n<p>I mostly agree, but I'm not sure how that argument doesn't work for not defining <code>tan</code>. Is it just the case that it's slightly longer to write <code>sin x / cos x</code> than <code>(sin x)⁻¹</code>, so it crosses some threshold that <code>csc</code> doesn't?</p>\n<p>I also think this doesn't hold for the inverse reciprocals, since they can't be as easily written; e.g. <code>arccot x</code> is not the same as <code>(arctan x)⁻¹</code> nor <code>arctan (x⁻¹)</code>.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"266253\">Joseph Myers</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Reciprocal.20trigonometric.20functions/near/564862278\">said</a>:</p>\n<blockquote>\n<p>We should definitely add the five missing complex inverse trigonometric / hyperbolic functions to mathlib</p>\n</blockquote>\n<p>The 5 I mentioned are reciprocals not inverses, specifically <code>Complex.csc</code>/<code>Complex.sec</code>/<code>Complex.csch</code>/<code>Complex.sech</code>/<code>Complex.coth</code>.</p>\n<p>There are however 6 missing real inverses, if that's what you meant: <code>Real.arccsc</code>/<code>Real.arcsec</code>/<code>Real.arccot</code>/<code>Real.arcsch</code>/<code>Real.arsech</code>/<code>Real.arcoth</code></p>",
        "id": 564863189,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1766279317
    },
    {
        "content": "<p>A weird reason I'd like to use <code>tan x</code> over of <code>sin x / cos x</code> is that I'd like to have its doc to tell me what junk value it gets, instead of figuring it out by looking at the long expression</p>",
        "id": 564863746,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1766280293
    },
    {
        "content": "<p>(though the doc does do it currently)</p>",
        "id": 564863822,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1766280420
    },
    {
        "content": "<p>But I think the real \"threshold\" between <code>tan</code> and <code>csc</code> is just how often it is used?</p>",
        "id": 564863875,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1766280504
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"873350\">Weiyi Wang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Reciprocal.20trigonometric.20functions/near/564863875\">said</a>:</p>\n<blockquote>\n<p>But I think the real \"threshold\" between <code>tan</code> and <code>csc</code> is just how often it is used?</p>\n</blockquote>\n<p>I'm not sure we'll be able to find out before creating the definitions, since people change their expressions to accommodate for the lack of definitions. For example:</p>\n<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/blob/e549dc07be46cc0c65177f9f2c7d82931c9ef455/Mathlib/Analysis/SpecialFunctions/Log/Deriv.lean\"><code>Mathlib/Analysis/SpecialFunctions/Log/Deriv.lean</code></a> uses the expression <code>1 / 2 * log ((1 + x) / (1 - x))</code> a few times as a stand-in for <code>artanh</code>, because the theorems were created before the definitions: <a href=\"https://github.com/leanprover-community/mathlib4/pull/31487\">#31487</a> vs <a href=\"https://github.com/leanprover-community/mathlib4/pull/32696\">#32696</a>.</li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Complex.Gamma_mul_Gamma_one_sub#doc\">docs#Complex.Gamma_mul_Gamma_one_sub</a> divides by <code>sin</code> instead of multiplying by <code>csc</code>, similarly for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Complex.Gamma%E2%84%9D_one_sub_mul_Gamma%E2%84%9D_one_add#doc\">docs#Complex.Gammaℝ_one_sub_mul_Gammaℝ_one_add</a></li>\n<li>The derivative of <code>tan</code> is <code>sec^2</code>, but Mathlib <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/SpecialFunctions/Trigonometric/ComplexDeriv.html#Complex.hasStrictDerivAt_tan\">uses</a> <code>1 / cos^2</code></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Complex.tan_pi_div_two_sub#doc\">docs#Complex.tan_pi_div_two_sub</a> is <code>tan (π / 2 - x) = cot x</code> but doesn't use <code>cot</code> because it was created (<a href=\"https://github.com/leanprover-community/mathlib3/pull/17024\">mathlib3#17024</a>) before <code>cot</code> was (<a href=\"https://github.com/leanprover-community/mathlib4/pull/12758\">#12758</a>)</li>\n</ul>\n<p>and there might be more, but it's very hard to find when there isn't a name for the definition.</p>\n<p>btw the <code>cot</code> PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/12758\">#12758</a> is weird, it was accepted without any justification or argument.</p>",
        "id": 564865004,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1766282375
    },
    {
        "content": "<p>The missing inverses I'm referring to are <code>Complex.arcsin</code>, <code>Complex.arccos</code>, <code>Complex.arsinh</code>, <code>Complex.arcosh</code> and <code>Complex.artanh</code>. (We have <code>Complex.arctan</code>.) I think all of those are uncontroversial functions, with well-established standard choices of principal values, and we have all the corresponding real functions.</p>",
        "id": 564865586,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1766283406
    },
    {
        "content": "<p>It is probably also related to how people usually write it on paper. For gammaR, I have seen sin more than csc even when there is no mathlib limitation</p>",
        "id": 564865631,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1766283464
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"266253\">Joseph Myers</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Reciprocal.20trigonometric.20functions/near/564865586\">said</a>:</p>\n<blockquote>\n<p>The missing inverses I'm referring to are <code>Complex.arcsin</code>, <code>Complex.arccos</code>, <code>Complex.arsinh</code>, <code>Complex.arcosh</code> and <code>Complex.artanh</code>. (We have <code>Complex.arctan</code>.) I think all of those are uncontroversial functions, with well-established standard choices of principal values, and we have all the corresponding real functions.</p>\n</blockquote>\n<p>Oh I thought there aren't nice complex inverses and that's why only the real ones were defined. Is it just the same expression Mathlib currently uses for the reals but with complex numbers? (assuming <code>Complex.sqrt</code> with a branch cut below the positive real line)</p>",
        "id": 564865729,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1766283640
    },
    {
        "content": "<p><a href=\"https://dlmf.nist.gov/4.23\">https://dlmf.nist.gov/4.23</a> (under \"Logarithmic Forms\") and <a href=\"https://dlmf.nist.gov/4.37\">https://dlmf.nist.gov/4.37</a> (likewise) give suitable expressions.</p>",
        "id": 564865815,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1766283793
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"873350\">Weiyi Wang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Reciprocal.20trigonometric.20functions/near/564865631\">said</a>:</p>\n<blockquote>\n<p>It is probably also related to how people usually write it on paper. For gammaR, I have seen sin more than csc even when there is no mathlib limitation</p>\n</blockquote>\n<p>This might be true for the gamma example, I also saw a division by <code>sin</code> in theorems about Chebyshev polynomial but didn't mention it because Wikipedia uses the same expression.<br>\nYou could maybe make a similar argument for the derivative of <code>tan</code> though , but searching online seems to yield mostly the <code>sec</code> version. The other examples still hold IMO.</p>",
        "id": 564865833,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1766283863
    },
    {
        "content": "<p>(These complex inverse trigonometric and hyperbolic functions have been in the C standard library since C99, for example, with the standard choice of principal value.)</p>",
        "id": 564865858,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1766283913
    },
    {
        "content": "<p>Wow I had no idea that C has complex numbers, very cool</p>",
        "id": 564865919,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1766284027
    },
    {
        "content": "<p>I always saw the reciprocal functions as one of those weird things school teaches you that's outdated by two centuries. We do not need twelve new names for what amounts to <code>(f x)⁻¹</code>.</p>",
        "id": 564872046,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1766293948
    },
    {
        "content": "<p>So the conclusion of this thread is to remove <code>cot</code>?</p>",
        "id": 564872119,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1766294070
    },
    {
        "content": "<p>That's my suggestion, not sure if everyone else shares it.</p>",
        "id": 564872130,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1766294093
    },
    {
        "content": "<p>cot has some interesting series though, to the point an entire file is dedicated to it <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/SpecialFunctions/Trigonometric/Cotangent.html\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/SpecialFunctions/Trigonometric/Cotangent.html</a></p>",
        "id": 564872525,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1766294907
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Reciprocal.20trigonometric.20functions/near/564872130\">said</a>:</p>\n<blockquote>\n<p>That's my suggestion, not sure if everyone else shares it.</p>\n</blockquote>\n<p>I'm not against it, but just to challenge it a little:</p>\n<ul>\n<li>Not all of them are <code>(f x)⁻¹</code> btw, <code>arccsc x = arcsin (x⁻¹)</code>. Not sure if that holds for complex inputs though.</li>\n<li>\n<p>What about <code>arccot</code>? I don't know of a simple expression for it using <code>arctan</code> without an <code>if</code>:<br>\n<a href=\"/user_uploads/3121/0CgOR42EWxERslz0rH9gq1Nv/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/0CgOR42EWxERslz0rH9gq1Nv/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1422x478\" src=\"/user_uploads/thumbnail/3121/0CgOR42EWxERslz0rH9gq1Nv/image.png/840x560.webp\"></a></div></li>\n<li>\n<p>What do we do with <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/SpecialFunctions/Trigonometric/Cotangent.html\">Mathlib.Analysis.SpecialFunctions.Trigonometric.Cotangent</a> then? Refactor and rename everything to <code>tan_inv</code>?</p>\n</li>\n</ul>",
        "id": 564872776,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1766295232
    },
    {
        "content": "<p>btw this theorem is apparently not in Mathlib, which I find strange:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">cot</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">tan</span><span class=\"bp\">⁻¹</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">cot</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">tan</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 564872790,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1766295248
    },
    {
        "content": "<p>That's why I tell people \"just do your own project on random topic and you will find small things to contribute to mathlib here and there\"<span aria-label=\"joy\" class=\"emoji emoji-1f602\" role=\"img\" title=\"joy\">:joy:</span></p>",
        "id": 564872893,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1766295412
    },
    {
        "content": "<p>I’ve seen cotangent appear “in nature” much more than some of the other functions, for example in classical treatments of modular forms (perhaps because it is the log derivative of sin). For this reason, I think we should be hesitant to remove it simply for reasons of symmetry.</p>",
        "id": 564889983,
        "sender_full_name": "Scott Carnahan",
        "timestamp": 1766317484
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"933054\">Snir Broshi</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Reciprocal.20trigonometric.20functions/near/564872790\">said</a>:</p>\n<blockquote>\n<p><code>Complex.cot = Complex.tan</code></p>\n</blockquote>\n<p>Please make a pr, and for <code>Real</code> as well</p>",
        "id": 564890210,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1766317714
    }
]