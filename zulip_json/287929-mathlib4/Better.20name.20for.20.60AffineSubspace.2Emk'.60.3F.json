[
    {
        "content": "<p>I'd like it if <code>AffineSubspace.mk'</code> had a more descriptive name.</p>\n<p>There are 2 main ways of making an <code>AffineSubspace</code>: either, given a set of points, construct the <code>affineSpan</code>, or, given a point <code>p : P</code> and a subspace <code>direction : Submodule k V</code>, construct the <code>AffineSubspace.mk' p direction</code>, which is the image of <code>direction</code> under <code>fun v ↦ v +ᵥ p</code>.</p>\n<p>I'd suggest something like <code>Submodule.affineTranslation</code>, <code>Submodule.embedAffine</code>, <code>Submodule.toAffine</code>, <code>AffineSubspace.ofSubmodule</code>.</p>\n<p>There is also <code>Submodule.toAffineSubspace</code>, which is the special case <code>P = V</code> and <code>p = 0</code>.</p>",
        "id": 509013957,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743331496
    },
    {
        "content": "<p>Something in the namespace <code>Submodule</code>, for example <code>Submodule.vadd</code>,  would allow to use dot notation and write write <code>W.vadd p</code>.</p>",
        "id": 509035784,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1743347916
    },
    {
        "content": "<p>That seems nice.</p>\n<p>The instance <code>Nonempty (W.vadd p)</code> is still missing, but with that we will get an instance for <code>NormedAddTorsor V (W.vadd p)</code>.</p>",
        "id": 509051644,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743358135
    },
    {
        "content": "<p>Hmm, calling it <code>Submodule.vadd</code> leads to the confusing lemma name <code>Submodule.vadd_mem_vadd (hv : v ∈ s) : v +ᵥ p ∈ s.vadd p</code>.</p>\n<p>What about <code>Submodule.shifted</code>?</p>\n<p>Or do we follow in the footsteps of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Set.vsub_mem_vsub#doc\">docs#Set.vsub_mem_vsub</a>, and use the <code>+ᵥ</code> notation for <code>Submodule.vadd</code>?</p>",
        "id": 509126631,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743408190
    },
    {
        "content": "<p>Right, I've made a PR renaming it to <code>Submodule.shift</code> <a href=\"https://github.com/leanprover-community/mathlib4/pull/23546\">#23546</a></p>",
        "id": 509476990,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743519826
    },
    {
        "content": "<p>Thanks. Could you please run <code>scripts/add_deprecations.sh</code>?</p>",
        "id": 509477408,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1743519915
    },
    {
        "content": "<p>Can we completely remove it instead? I believe <code>AffineSubspace.mk' p s = p +ᵥ s.toAffineSubspace</code>, and both these operations feel more fundamental than <code>AffineSubspace.mk'</code></p>",
        "id": 509477524,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1743519942
    },
    {
        "content": "<p><code>Submodule.toAffineSubspace</code> requires that <code>P = V</code>, <del>although this could be generalized.</del></p>",
        "id": 509480929,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743520698
    },
    {
        "content": "<p>Additionally, there is no instance of HVAdd doing what you want it to do. If it were, then we could use it in the definition of <code>AffineSubspace.Parallel</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Parallel</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s₁</span><span class=\"w\"> </span><span class=\"n\">s₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AffineSubspace</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">s₂</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">s₁</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">constVAdd</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 509482405,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743521026
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span>, the problem with that idea is that the only way to embed a linear subspace into an affice space is by providing a base point. Do you think that <code>AffineSubspace.mk'</code> should be called <code>Submodule.toAffineSubspace</code> instead?</p>",
        "id": 509484357,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743521437
    },
    {
        "content": "<p>Yes, I realised that now. I agree that <code>Submodule.toAffineSubspace</code> would be a better name for <code>AffineSpace.mk'</code>. Then the current <code>Submodule.toAffineSubspace</code> would become <code>Submodule.toAffineSubspace 0</code>, which I guess is not so bad? cc <span class=\"user-mention\" data-user-id=\"266253\">@Joseph Myers</span></p>",
        "id": 509484700,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1743521522
    },
    {
        "content": "<p>The name <code>shift</code> or notation at least has the benefit over <code>toAffineSubspace</code> of providing a reasonably short name for a common operation.</p>",
        "id": 509568881,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1743551856
    },
    {
        "content": "<p>But whatever <code>mk'</code> gets renamed to, should we replace the current <code>.toAffineSubspace</code> by <code>.mk' 0</code>?</p>",
        "id": 509649800,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743587281
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Better.20name.20for.20.60AffineSubspace.2Emk'.60.3F/near/509477408\">said</a>:</p>\n<blockquote>\n<p>Thanks. Could you please run <code>scripts/add_deprecations.sh</code>?</p>\n</blockquote>\n<p>Done</p>",
        "id": 509656112,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743589306
    },
    {
        "content": "<p>Could <a href=\"https://github.com/leanprover-community/mathlib4/pull/23546\">#23546</a> get another review? I'm still not 100% convinced <code>Submodule.shift</code> is the best name, maybe <code>Submodule.toAffine</code> is better?</p>",
        "id": 513593883,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1745324219
    },
    {
        "content": "<p>I recently found that I want another funtion with a similar flavour to <code>AffineSubspace.mk'</code> to exist: a function lifting a <code>ContinuousLinearMap</code> to a <code>ContinuousAffineMap</code>, by providing a corresponding function on the affine spaces and showing it is compatible (i.e. <code>map_vadd'</code>). I think this should be named analogously to <code>AffineSubspace.mk'</code>, so either <code>ContinuousLinearMap.shift</code>, or <code>ContinuousLinearMap.toAffine</code>. Or maybe just the name <code>affine</code>?</p>",
        "id": 514460103,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1745614097
    }
]