[
    {
        "content": "<p>In the following example, setting <code>pp.explicit</code> affects the error message produced by <code>rw</code> as expected:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">explicit</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span>\n<span class=\"c\">/-</span>\n<span class=\"cm\">Tactic `rewrite` failed: Did not find an occurrence of the pattern</span>\n<span class=\"cm\">  p ∧ q</span>\n<span class=\"cm\">in the target expression</span>\n<span class=\"cm\">  p ↔ r</span>\n<span class=\"cm\">-/</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">explicit</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span>\n<span class=\"c\">/-</span>\n<span class=\"cm\">Tactic `rewrite` failed: Did not find an occurrence of the pattern</span>\n<span class=\"cm\">  And p q</span>\n<span class=\"cm\">in the target expression</span>\n<span class=\"cm\">  Iff p r</span>\n<span class=\"cm\">-/</span>\n</code></pre></div>\n<p>However, in the following example, setting <code>pp.explicit true</code> does not print the <code>⊓</code> and <code>⊔</code> explicitly.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">explicit</span><span class=\"w\"> </span><span class=\"n\">true</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Lattice</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">⊔</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊓</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">⊔</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">⊓</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inf_sup_right</span><span class=\"o\">]</span>\n<span class=\"c\">/-</span>\n<span class=\"cm\">Tactic `rewrite` failed: Did not find an occurrence of the pattern</span>\n<span class=\"cm\">  (?a ⊔ ?b) ⊓ ?c</span>\n<span class=\"cm\">in the target expression</span>\n<span class=\"cm\">  @LE.le α</span>\n<span class=\"cm\">    (@Preorder.toLE α</span>\n<span class=\"cm\">      (@PartialOrder.toPreorder α (@SemilatticeInf.toPartialOrder α (@Lattice.toSemilatticeInf α inst✝))))</span>\n<span class=\"cm\">    ((a ⊔ b) ⊓ c) (a ⊔ b ⊓ c)</span>\n<span class=\"cm\">-/</span>\n</code></pre></div>\n<p>Is this a problem with those notations explicitly?</p>",
        "id": 537218406,
        "sender_full_name": "Marcus Rossel",
        "timestamp": 1756795903
    },
    {
        "content": "<p>This topic was moved here from <a href=\"#narrow/channel/270676-lean4/topic/.60pp.2Eexplicit.60.20in.20.60rw.60.20error.20message\">#lean4 &gt; &#96;pp.explicit&#96; in &#96;rw&#96; error message</a> by <span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span>.</p>",
        "id": 537221076,
        "sender_full_name": "Notification Bot",
        "timestamp": 1756797068
    },
    {
        "content": "<p>Yes, it's a problem with the pretty printers for these notations specifically.</p>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Mathlib.Meta.delabSup#doc\">docs#Mathlib.Meta.delabSup</a> is not checking that <code>pp.explicit</code> is false. It's also not checking that <code>pp.notation</code> is true.</p>\n<p>Inserting this before <code>do</code> will fix it: <code>whenNotPPOption getPPExplicit &lt;| whenPPOption getPPNotation</code></p>",
        "id": 537221272,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1756797159
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/29312\">#29312</a></p>",
        "id": 537465992,
        "sender_full_name": "Marcus Rossel",
        "timestamp": 1756902927
    }
]