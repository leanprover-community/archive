[
    {
        "content": "<p>This stuff is on its way from my repo to mathlib, and so for the sake of planning ahead, I wanted to solicit a consensus.</p>\n<p>A matroid <code>M : Matroid α</code> is a certain structure on a type <code>α</code> with a distinguished 'ground set' <code>M.E : Set α</code>. <br>\nFor each <code>X : Set α</code>, there is a notion of the 'rank of <code>X</code> in <code>M</code>, which generalizes the usual rank in linear algebra. The 'rank of <code>M</code>' refers to the rank in <code>M</code> of the set <code>M.E</code>.</p>\n<p>In various settings, it is reasonable for rank to take values in <code>ℕ</code>, <code>ℕ∞</code> and <code>Cardinal</code>. <br>\nAll three versions are useful. The <code>ℕ</code> version, in particular, is all that is used in 95% of the literature, the <code>ℕ∞</code> version is far less common but is needed for formalizing infinite matroids,  and the <code>Cardinal</code> version is even less common (and not well-defined for all matroids), but has some applications.  It is also very helpful to refer to the 'rank of a matroid' separately from just saying 'rank of the ground set in the matroid'. This means, in practice,  that the following things need names: </p>\n<ul>\n<li>a term <code>Matroid α → ℕ</code> assigning each matroid its rank as a natural number. </li>\n<li>a term <code>Matroid α → ℕ∞</code> assigning each matroid its rank as an extended natural number. </li>\n<li>a term <code>Matroid α → Cardinal</code> assigning each matroid its rank as a cardinal. </li>\n<li>a term in <code>Matroid α → Set α → ℕ</code> assigning each set to its <code>ℕ</code>-valued rank in a matroid</li>\n<li>a term in <code>Matroid α → Set α → ℕ∞</code> assigning each set to its <code>ℕ∞</code>-valued rank in a matroid</li>\n<li>a term in <code>Matroid α → Set α → Cardinal</code> assigning each set to its <code>Cardinal</code>-valued rank in a matroid.</li>\n<li>certain typeclasses in <code>Matroid α → Prop</code> stating a matroid's rank is finite/infinite/positive.</li>\n</ul>\n<p>The current terms in my repo are </p>\n<ul>\n<li><code>Matroid.rk (M : Matroid α) : ℕ</code></li>\n<li><code>Matroid.erk (M : Matroid α) : ℕ∞</code></li>\n<li>nothing yet for cardinal rank</li>\n<li><code>Matroid.r (M : Matroid α) (X : Set α) : ℕ</code></li>\n<li><code>Matroid.er (M : Matroid α) (X : Set α) : ℕ∞</code></li>\n<li>nothing yet for cardinal rank of sets</li>\n<li><code>FiniteRk</code>, <code>RkPos</code>, etc for typeclasses. <br>\n  (Also already in mathlib, but can be changed without too much hassle)</li>\n</ul>\n<p>I've favoured short names here, especially for the functions on sets, because they are ubiquitous in calculations, and because <code>r</code> is the usual pen-and-paper notation for all notions of rank. But perhaps notation that terse is bad for other reasons. A poll follows with some options. (The <code>Matroid</code> namespace is assumed)</p>",
        "id": 495576698,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1737662584
    },
    {
        "content": "<p>/poll How should matroid rank terms be named?<br>\n<code>rk, erk, cardrk</code> for the terms, <code>r, er, cardr</code> for the set functions, <code>FiniteRk</code> etc for the typeclasses<br>\n<code>rank, erank, cardRank</code> for the terms, <code>rk, erk, cardRk</code> for the set functions,  <code>FiniteRank</code> etc for the typeclasses<br>\nSomething else</p>",
        "id": 495576709,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1737662592
    },
    {
        "content": "<p>I guess the closest comparison would be <code>Module.rank</code> and <code>Module.finrank</code>. I'm curious if you can make do without the ENat version, since we were able to make do without it for linear algebra. If both ENat and Cardinal are rare, then the slight pain of using the cardinal one for the enat case shouldn't come up enough to matter.</p>",
        "id": 495579182,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737663721
    },
    {
        "content": "<p>Is <code>M.rk</code> the same thing as <code>M.r univ</code>, using the names in your initial message?</p>",
        "id": 495579289,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737663764
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Matroid.20rank.20-.20naming.20poll/near/495579289\">said</a>:</p>\n<blockquote>\n<p>Is <code>M.rk</code> the same thing as <code>M.r univ</code>, using the names in your initial message?</p>\n</blockquote>\n<p>Yes, but also <code>M.r M.E</code>, which comes up more.</p>",
        "id": 495579357,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1737663799
    },
    {
        "content": "<p>The <code>ENat</code> version is needed, because (for instance), it is consistent with ZFC that there are matroids having both a countable basis and an uncountable basis. </p>\n<p>This means that cardinal rank, even if defined as a supremum or infimum of the cardinalities of bases, will not have nice properties at the full generality of matroids (as a concrete example, things like monotonicity, or the statement that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>r</mi><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">c</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">s</mi><mi mathvariant=\"normal\">u</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">X</mi><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">r(X) = r(\\mathrm{closure(X)})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathrm\">closure</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">X</span><span class=\"mclose\">)</span></span><span class=\"mclose\">)</span></span></span></span> will be unprovable in general).</p>",
        "id": 495579570,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1737663891
    },
    {
        "content": "<p>If you have a cardinal-valued cardinality, you can always use <code>toENat</code> on the result</p>",
        "id": 495580664,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737664366
    },
    {
        "content": "<p>That's right - the cardinal expression is ok as a definition, but you can't prove anything nice about it, so all the proofs happen in <code>ENat</code> anyway.</p>",
        "id": 495580761,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1737664409
    },
    {
        "content": "<p>It's ok to prove things about <code>(rank M).toENat</code> without creating a new definition though, especially given you claim the cases where this arises are rarer</p>",
        "id": 495580901,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737664471
    },
    {
        "content": "<p>I meant that they are rare in the literature. <code>ENat</code>-valued rank is all over the place when formalizing, to maintain generality.</p>",
        "id": 495581038,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1737664534
    },
    {
        "content": "<p>I'm afraid through my own ignorance I don't understand the comment about why the cardinal-valued statements are poorly behaved; they work quite well for us in linear algebra. Is there some nice intuition for why this doesn't successfully generalize to matroids?</p>",
        "id": 495581878,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737664904
    },
    {
        "content": "<p>I guess 'infinite matroids are too wild' is the only real answer. Higgs proved that if the generalized continuum hypothesis holds, then cardinal-valued rank is well-behaved (i.e. all bases are equicardinal), and it is known that bases are equicardinal for certain classes, such as the finitary matroids - and this last result is now in mathlib!</p>\n<p>Because of the GCH result, the constructions that show the bad behaviour necessarily involve exotic set-theoretic assumptions like Martin's axiom. I don't have any intuition.</p>",
        "id": 495582357,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1737665095
    },
    {
        "content": "<p>This is one of the ways that infinite matroids are terrible. But they are surprisingly nice in most ways.</p>",
        "id": 495582663,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1737665224
    },
    {
        "content": "<p>Note that we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Polynomial.degree#doc\">docs#Polynomial.degree</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Polynomial.natDegree#doc\">docs#Polynomial.natDegree</a></p>",
        "id": 495649221,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737703418
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> seems to think we should change <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Module.finrank#doc\">docs#Module.finrank</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Subfield.relrank#doc\">docs#Subfield.relrank</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Subfield.relfinrank#doc\">docs#Subfield.relfinrank</a>, and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Subgroup.relindex#doc\">docs#Subgroup.relindex</a> (anything else?) to finRank, relRank, relFinRank, and redIndex according to his vote. <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/FieldTheory/SeparableDegree.html#Field.finSepDegree\">Field.finSepDegree</a> already follows this convention. I don't think we're going to change Finset and Fintype though ...</p>",
        "id": 495693994,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1737718687
    },
    {
        "content": "<p>Note that I've opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/19872\">#19872</a> for a similar rename</p>",
        "id": 495696139,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737719424
    },
    {
        "content": "<p>I think I like the extra option that was added (rank, eRank cRank, for the terms, rk, eRk, cRk for the functions). </p>\n<p>I would rather not use <code>nat_, fin_</code> or such variants for the <code>Nat</code> versions, because this will make the statements of real theorems involving the rank function less readable in exactly the setting that they are most common.</p>",
        "id": 495698445,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1737720230
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"224323\">Junyan Xu</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Matroid.20rank.20-.20naming.20poll/near/495693994\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> seems to think we should change <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Module.finrank#doc\">docs#Module.finrank</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Subfield.relrank#doc\">docs#Subfield.relrank</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Subfield.relfinrank#doc\">docs#Subfield.relfinrank</a>, and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Subgroup.relindex#doc\">docs#Subgroup.relindex</a> (anything else?) to finRank, relRank, relFinRank, and redIndex according to his vote. <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/FieldTheory/SeparableDegree.html#Field.finSepDegree\">Field.finSepDegree</a> already follows this convention. I don't think we're going to change Finset and Fintype though ...</p>\n</blockquote>\n<p>Would this mean <code>ncard</code> -&gt; <code>nCard</code> and <code>encard</code> -&gt; <code>eCard</code> would be good ideas? <span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span></p>",
        "id": 495716921,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1737726091
    },
    {
        "content": "<p>Isn't the argument for <code>encard</code> vs <code>enCard</code> the same as the argument for <code>ennreal</code> vs <code>ennReal</code> in theorem names?</p>",
        "id": 495717958,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737726360
    },
    {
        "content": "<p>or <code>eNNReal</code>? <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span></p>",
        "id": 495718976,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737726642
    },
    {
        "content": "<p>I don't think there was much of a naming discussion about <code>encard</code> when I made the PR. But would it be <code>enCard</code> or <code>eNCard</code> according to the new rules?</p>",
        "id": 495719668,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1737726845
    },
    {
        "content": "<p>I don't think the rules are clear here</p>",
        "id": 495719828,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737726895
    },
    {
        "content": "<p>i'd say that since we're abbreviating <code>Nat</code>, the <code>n</code> becomes lowercase? (compare to <code>eNatCard</code>).</p>",
        "id": 495720048,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737726962
    },
    {
        "content": "<p>Agreed, but I think the rules ought to spell that out</p>",
        "id": 495720185,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737726996
    },
    {
        "content": "<p>But the <code>c</code> should still become <code>C</code>, I guess.</p>",
        "id": 495720220,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1737727004
    },
    {
        "content": "<p>If the rule were \"name in CamelCase then lowercase with the normal rules\", then you'd have <code>ENCard</code> lowercased to <code>encard</code>.</p>",
        "id": 495720583,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1737727096
    },
    {
        "content": "<p>Well that's easy, then!</p>",
        "id": 495720781,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1737727150
    },
    {
        "content": "<p>Note that some lemmas lower-case <code>AEStronglyMeasurable</code> to <code>aeStronglyMeasurable</code>. Not sure how to feel about those</p>",
        "id": 495721444,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737727320
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Matroid.20rank.20-.20naming.20poll/near/495720583\">said</a>:</p>\n<blockquote>\n<p>If the rule were \"name in CamelCase then lowercase with the normal rules\", then you'd have <code>ENCard</code> lowercased to <code>encard</code>.</p>\n</blockquote>\n<p>i believe actually it is more common for just the first character to become lowercase?</p>",
        "id": 495721688,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737727380
    },
    {
        "content": "<p>see <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=natCast#doc\">docs#natCast</a> for an example</p>",
        "id": 495722082,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737727475
    },
    {
        "content": "<p>i could also be wrong about that, though...</p>",
        "id": 495722366,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737727558
    },
    {
        "content": "<p>but it's not called <code>NATCast</code> in upper-case?</p>",
        "id": 495722392,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737727563
    },
    {
        "content": "<p>ah, i get what you mean now...</p>",
        "id": 495722559,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737727602
    },
    {
        "content": "<p>Can I suggest that those involved in this discussion provide an opinion in the poll at the top? It seems we're heading in the direction of a consensus. (The <code>encard</code> issue is orthogonal)</p>",
        "id": 495722816,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1737727682
    },
    {
        "content": "<p>Whatever the rules are, we should make sure that we don't end up with <code>crank</code>. I don't care about the rest (-;</p>",
        "id": 495777031,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1737745988
    },
    {
        "content": "<p><a href=\"https://en.wikipedia.org/wiki/Crank_of_a_partition\">They</a>'ll come sooner or later!</p>",
        "id": 495779888,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1737747233
    },
    {
        "content": "<p>I'll leave this for the weekend, but it doesn't seem like there's much disagreement (a vote or two more would be nice!).</p>",
        "id": 495783475,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1737748724
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Matroid.20rank.20-.20naming.20poll/near/495696139\">said</a>:</p>\n<blockquote>\n<p>Note that I've opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/19872\">#19872</a> for a similar rename</p>\n</blockquote>\n<p>Worth noting there's <a href=\"https://github.com/leanprover-community/mathlib4/pull/19872#issuecomment-2550529933\">an objection</a> to such renaming in the PR.</p>",
        "id": 495788948,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1737751038
    }
]