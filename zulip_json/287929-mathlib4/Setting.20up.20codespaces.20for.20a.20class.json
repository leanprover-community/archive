[
    {
        "content": "<p>I'm teaching a Lean class this semester. I'm concerned not all my students will have computers that are able to run Lean. I was advised to have an option to use Github Codespaces. I just need some help setting this up. I copied a .devcontainer folder into my project from someone else's repo, but I'm not sure what comes next. Is there anything else I need to do? What do the students need to do to open/create a codespace based on my repo?</p>",
        "id": 495084067,
        "sender_full_name": "Trevor Hyde",
        "timestamp": 1737473648
    },
    {
        "content": "<p>If the <code>.devcontainer</code> is OK just go to <a href=\"https://codespaces.new/yourname/yourrepo\">https://codespaces.new/yourname/yourrepo</a> to create it</p>",
        "id": 495094066,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737476217
    },
    {
        "content": "<p>Each student has to create it</p>",
        "id": 495094132,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737476233
    },
    {
        "content": "<p>Hey Riccardo, I'm trying to setup codespaces for my Lean class using the dev container from your repo. When I open my repo in codespaces and try to build the container, I'm getting errors. I suspect I probably didn't make the right changes in the dev container.</p>\n<p>This seems to be the relevant error:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">======================================</span><span class=\"w\"> </span><span class=\"n\">ERROR</span><span class=\"w\"> </span><span class=\"bp\">====================================</span>\n<span class=\"mi\">2025</span><span class=\"bp\">-</span><span class=\"mi\">01</span><span class=\"bp\">-</span><span class=\"mi\">21</span><span class=\"w\"> </span><span class=\"mi\">15</span><span class=\"o\">:</span><span class=\"mi\">56</span><span class=\"o\">:</span><span class=\"mf\">01.208</span><span class=\"n\">Z</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">create</span><span class=\"w\"> </span><span class=\"n\">container</span><span class=\"bp\">.</span>\n<span class=\"bp\">=================================================================================</span>\n<span class=\"mi\">2025</span><span class=\"bp\">-</span><span class=\"mi\">01</span><span class=\"bp\">-</span><span class=\"mi\">21</span><span class=\"w\"> </span><span class=\"mi\">15</span><span class=\"o\">:</span><span class=\"mi\">56</span><span class=\"o\">:</span><span class=\"mf\">01.208</span><span class=\"n\">Z</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Command</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">sh</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get!</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span>\n<span class=\"mi\">2025</span><span class=\"bp\">-</span><span class=\"mi\">01</span><span class=\"bp\">-</span><span class=\"mi\">21</span><span class=\"w\"> </span><span class=\"mi\">15</span><span class=\"o\">:</span><span class=\"mi\">56</span><span class=\"o\">:</span><span class=\"mf\">01.209</span><span class=\"n\">Z</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Error</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1302</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">UnifiedContainersErrorFatalCreatingContainer</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Here is my devcontainer.json</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">{</span>\n<span class=\"w\">  </span><span class=\"s2\">\"name\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"math301spring2025 dev container\"</span><span class=\"o\">,</span>\n\n<span class=\"w\">  </span><span class=\"s2\">\"build\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"s2\">\"dockerfile\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Dockerfile\"</span>\n<span class=\"w\">  </span><span class=\"o\">},</span>\n\n<span class=\"w\">  </span><span class=\"s2\">\"onCreateCommand\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"lake exe cache get! &amp;&amp; lake build\"</span><span class=\"o\">,</span>\n\n<span class=\"w\">  </span><span class=\"s2\">\"hostRequirements\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">     </span><span class=\"s2\">\"cpus\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">4</span>\n<span class=\"w\">  </span><span class=\"o\">},</span>\n\n<span class=\"w\">  </span><span class=\"s2\">\"customizations\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"s2\">\"vscode\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">      </span><span class=\"s2\">\"extensions\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"w\"> </span><span class=\"s2\">\"leanprover.lean4\"</span><span class=\"w\"> </span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n<span class=\"o\">}</span>\n</code></pre></div>\n<p>All I changed was the name and removed the <code>Library</code>after <code>lake build</code> since my project doesn't have a Library.</p>",
        "id": 495094356,
        "sender_full_name": "Trevor Hyde",
        "timestamp": 1737476294
    },
    {
        "content": "<p>Hmm, I am not sure. Is your repo public?</p>",
        "id": 495094962,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737476477
    },
    {
        "content": "<p>Yes<br>\n<a href=\"https://github.com/tghyde/math301spring2025\">https://github.com/tghyde/math301spring2025</a></p>",
        "id": 495095065,
        "sender_full_name": "Trevor Hyde",
        "timestamp": 1737476508
    },
    {
        "content": "<p>I also get an error doing <code>lake build</code> locally (probably because there is no file called <code>math301spring2025.lean</code>)</p>",
        "id": 495096248,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737476828
    },
    {
        "content": "<p>I see. The repo seems to work fine for me locally. There is a file, but it looks like it was created with a capital M. I'll try changing the name of the file.</p>",
        "id": 495096980,
        "sender_full_name": "Trevor Hyde",
        "timestamp": 1737477026
    },
    {
        "content": "<p>That is the file that is compiled when you do <code>lake build</code>. You can erase it and never doing <code>lake build</code> if you don't need it (if each file only depends on mathlib and NOT on other files of your project for example)</p>",
        "id": 495097263,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737477113
    },
    {
        "content": "<p>Or you can keep it empty, or with just <code>#eval 2+2</code> to check that everything works.</p>",
        "id": 495097395,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737477143
    },
    {
        "content": "<p>change the <code>M</code> to <code>m</code> and it should work</p>",
        "id": 495098503,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737477445
    },
    {
        "content": "<p>I see. I didn't understand what the <code>lake build</code> command was doing, I thought it was needed whenever starting a Lean project.</p>",
        "id": 495098876,
        "sender_full_name": "Trevor Hyde",
        "timestamp": 1737477545
    },
    {
        "content": "<p>It compiles the file specified in <code>lakefile.lean</code> at the <code>@[default_targer]</code> line. Currently you have</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>@<span class=\"o\">[</span>default_target<span class=\"o\">]</span>\nlean_lib<span class=\"w\"> </span>«math301spring2025»<span class=\"w\"> </span><span class=\"o\">{</span>\n</code></pre></div>\n<p>that is why it is looking for <code>math301spring2025.lean</code>.</p>",
        "id": 495099536,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737477740
    },
    {
        "content": "<p>You can of course put <code>Math301spring2025</code> there</p>",
        "id": 495099596,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737477758
    },
    {
        "content": "<p>the idea is that that file imports everything in your project (or maybe it contains the final theorem), so compiling it checks that everything is ok.</p>",
        "id": 495099712,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737477794
    },
    {
        "content": "<p>Got it. I was naively copying files from another repo and changing the names of things that seemed like they needed to change. So if I had custom libraries of definitions and theorems that I wanted the class to use, I could put them all in this file and they'd be available for students to use in this project? Of in the case of your project, we can have a folder full of different Lean files to be imported?</p>",
        "id": 495100130,
        "sender_full_name": "Trevor Hyde",
        "timestamp": 1737477916
    },
    {
        "content": "<p>if you have prerequisites written by yourself just put them in a folder <code>whatevername</code>  and import them in any file you need (I suggest to hide this in VS Code so students don't play with it). In this case importing those in <code>math301spring2025.lean</code> and doing <code>lake build</code> (only once) it is necessary.</p>",
        "id": 495100654,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737478070
    },
    {
        "content": "<p>Note that with code space students have to create the codespace only once, then they are supposed to go to <a href=\"https://github.com/codespaces/\">https://github.com/codespaces/</a> and reopen it.</p>",
        "id": 495100834,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737478113
    },
    {
        "content": "<p>anyway now your repo works on codespace for me</p>",
        "id": 495101031,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737478166
    },
    {
        "content": "<p>Thanks @<strong>Riccardo</strong>, I appreciate the help</p>",
        "id": 495101244,
        "sender_full_name": "Trevor Hyde",
        "timestamp": 1737478224
    },
    {
        "content": "<p>I just did the installation with students today and I have to say everything went pretty well.</p>\n<p>Of course you have to deal with trivial things like \"I didn't register to github even if you asked us to do so\" or \"I forgot the password and it is sending the code to my other phone\" but well, that's life</p>",
        "id": 495101742,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737478375
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Setting.20up.20codespaces.20for.20a.20class/near/495101742\">said</a>:</p>\n<blockquote>\n<p>Of course you have to deal with trivial things like \"I didn't register to github even if you asked us to do so\" or \"I forgot the password and it is sending the code to my other phone\" but well, that's life</p>\n</blockquote>\n<p>These kind of things make me think that AI can be more successful than humans at <em>everything</em>.</p>",
        "id": 495102762,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737478632
    },
    {
        "content": "<p>Can AI register a github account?</p>",
        "id": 495103520,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1737478828
    },
    {
        "content": "<p>The captcha is <em>really hard</em>, with a finger pointing left (say) and you have to rotate a cat (say) to same direction of the finger</p>",
        "id": 495103998,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737478943
    },
    {
        "content": "<p>Can AI guess the password of an existing github account?</p>\n<p>(Sorry, really going off topic here)</p>",
        "id": 495104173,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1737478998
    },
    {
        "content": "<p>More to the point, my strategy for the first class was the following: getting codespace ready asap, explaining that this part is like a pre-introduction to be done once. Once everyone has clicked on \"create codespace\" I asked to not touch the computer and listen to me doing the actual introduction to the class.</p>",
        "id": 495105026,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1737479264
    },
    {
        "content": "<p>Something I just discovered the other day, of interest to people teaching with codespaces: GitHub is willing to prebuild codespace images for a very small fee. (In your repository, Settings -&gt; Codespaces.) For me it'll cost about $1 to keep the image available this whole semester, and save each student minutes every time they create a codespace. Well worth it.</p>",
        "id": 495110210,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1737480803
    }
]