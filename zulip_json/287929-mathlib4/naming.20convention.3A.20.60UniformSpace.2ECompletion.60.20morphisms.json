[
    {
        "content": "<p>Currently the naming convention surroounding bundled morphisms concerning <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=UniformSpace.Completion#doc\">docs#UniformSpace.Completion</a> is inconsistent. For example, given a morphism <code>α →?hom β</code>, the map <code>UniformSpace.Completion.map : Completion α →?hom Completion β</code> is called, for various morphisms:</p>\n<ol>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AddMonoidHom.completion#doc\">docs#AddMonoidHom.completion</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=NormedAddGroupHom.completion#doc\">docs#NormedAddGroupHom.completion</a> (matches the above)</li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=UniformSpace.Completion.mapRingHom#doc\">docs#UniformSpace.Completion.mapRingHom</a></li>\n</ol>\n<p>And in <a href=\"https://github.com/leanprover-community/mathlib4/pull/33116\">#33116</a>, the author (<span class=\"user-mention\" data-user-id=\"939215\">@Gregory Wickham</span>) is adding a version for continuous ilnear maps. Which of the above should we choose? I see arguments in both directions: (a) choose <code>.completion</code> to allow for dot notation, (b) choose the namespaced <code>mapHom</code> because it mentions <code>map</code> and when we're working with completions, we'll often have the namespace opem already.</p>\n<p>My complaint with (a) is that there is no mention of <code>map</code>, and there are other things it could reasonably be (e.g., <code>extension</code> or <code>coe</code>). Note that along the lines of these other possibilites, we have the terrible (guess which morphism it is before clicking!) <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=UniformSpace.Completion.extensionHom#doc\">docs#UniformSpace.Completion.extensionHom</a>, we also have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=UniformSpace.Completion.coeRingHom#doc\">docs#UniformSpace.Completion.coeRingHom</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Isometry.extensionHom#doc\">docs#Isometry.extensionHom</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=NormedAddGroupHom.extension#doc\">docs#NormedAddGroupHom.extension</a>. And finally we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=normedAddGroupHomCompletionHom#doc\">docs#normedAddGroupHomCompletionHom</a>, which is a bundling of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=NormedAddGroupHom.completion#doc\">docs#NormedAddGroupHom.completion</a> into an <code>AddMonoidHom</code> between spaces of <code>NormedAddGroupHom</code>s.</p>\n<p>So, what do we prefer? I think my preference, if I were to do it from scratch would be: given <code>α →?hom β</code>, to name:</p>\n<ol>\n<li><code>Hom.completionCoe : β → Completion β</code>. This is not a typo, I really mean <code>α</code> in both places because we can just compose with this map to go from <code>α → Completion β</code>.</li>\n<li><code>Hom.completionExtension : Completion α → β</code>.</li>\n<li><code>Hom.completionMap : Completion α → Completion β</code>.</li>\n</ol>\n<p>(1) allows for anonymous dot notation, while (2) and (3) allow for dot notation. In addition, this more closely follows our naming convention (than e.g., <code>AddMonoidHom.completion</code>) because this is about <code>Completion.map</code> (which becomes <code>completionMap</code> according to our conventions). </p>\n<p>cc <span class=\"user-mention\" data-user-id=\"477483\">@Monica Omar</span></p>",
        "id": 566777988,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1767804652
    },
    {
        "content": "<p>What about <code>Hom.toCompletion</code> for the version <code>α → Completion β</code>, and <code>Hom.fromCompletion</code> for the version <code>Completion α → β</code> (already assuming that beta is complete, probably) and <code>Hom.completion</code> for <code>Completion α → Completion β</code>? This looks easier to remember to me.</p>",
        "id": 566778981,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1767804929
    },
    {
        "content": "<p>It's clear enough, so I'm fine with that, but I'll point out that it's sort of <del>special casing</del> an exception to our naming conventions</p>",
        "id": 566779210,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1767804993
    },
    {
        "content": "<p>What is the naming convention that would apply here?</p>",
        "id": 566779494,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1767805044
    },
    {
        "content": "<p>I just mean that we name things in terms of what's involved. Since this is a bundling of <code>Completion.map</code>, presumably <code>map</code> would appear in the name.</p>",
        "id": 566779678,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1767805089
    },
    {
        "content": "<p>It's true that <code>A.toB</code> normally turns <code>A</code> into something of type <code>B</code>, and my proposal doesn't respect that...</p>",
        "id": 566779688,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1767805091
    },
    {
        "content": "<p>Maybe I'm arguing that <code>Completion.map</code> should be renamed <code>Function.completion</code>...</p>",
        "id": 566780057,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1767805197
    },
    {
        "content": "<p>Without a <code>UniformSpace.</code> preceding it? That sounds potentially confusing.</p>",
        "id": 566780309,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1767805269
    },
    {
        "content": "<p>Yes, that's a bad idea, there are too many kinds of completions.</p>",
        "id": 566780423,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1767805303
    },
    {
        "content": "<p>So <code>toCompletion</code>, <code>fromCompletion</code> and <code>completionMap</code>?</p>",
        "id": 566782613,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1767805934
    },
    {
        "content": "<p><code>toCompletion</code> and <code>fromCompletion</code> still don't mention the underlying function (though you could argue <code>coe</code> isn't much better). But I was only pointing this out, not necessarily dictating. Like I said above (about <code>toCompletion</code>, <code>fromCompletion</code> and <code>completion</code>): <br>\n<span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/naming.20convention.3A.20.60UniformSpace.2ECompletion.60.20morphisms/near/566779210\">said</a>:</p>\n<blockquote>\n<p>It's clear enough, so I'm fine with that</p>\n</blockquote>",
        "id": 566783332,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1767806151
    },
    {
        "content": "<p>I like <code>toCompletion</code> and <code>fromCompletion</code>.<br>\n<code>completionMap</code> is okay, but maybe <code>.Completion.map</code> is also fine?</p>",
        "id": 566787616,
        "sender_full_name": "Monica Omar",
        "timestamp": 1767807452
    },
    {
        "content": "<p>Actually, <code>completionMap</code> is better, so, in the case of continuous linear maps, we can just have <code>UniformSpace.completionCLM</code>?</p>",
        "id": 566787853,
        "sender_full_name": "Monica Omar",
        "timestamp": 1767807534
    },
    {
        "content": "<p>I think it is important to have dot notation. So, if <code>A</code> is a continuous linear map, I would like <code>A.completion</code> or <code>A.completionMap</code> or whatever to be valid for the continuous linear map between the completions.</p>",
        "id": 566788151,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1767807633
    },
    {
        "content": "<p>Yeah, I agree, that's what I was thinking too</p>",
        "id": 566788261,
        "sender_full_name": "Monica Omar",
        "timestamp": 1767807676
    },
    {
        "content": "<p>What would <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Isometry.extensionHom#doc\">docs#Isometry.extensionHom</a> be called? The current naming doesn't even mention what kind of homomorphism.</p>",
        "id": 566789520,
        "sender_full_name": "Monica Omar",
        "timestamp": 1767808085
    },
    {
        "content": "<p><code>Isometry.fromCompletion</code>?</p>",
        "id": 566789819,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1767808186
    },
    {
        "content": "<p>How about <code>RingHom.Isometry.fromCompletion</code>?</p>",
        "id": 566789994,
        "sender_full_name": "Monica Omar",
        "timestamp": 1767808246
    },
    {
        "content": "<p>Or <code>RingHom.fromCompletion_of_isometry</code>? But I like the dot notation one better</p>",
        "id": 566790150,
        "sender_full_name": "Monica Omar",
        "timestamp": 1767808306
    },
    {
        "content": "<p>The only one enabling dot notation is <code>Isometry.fromCompletion</code>, right?</p>",
        "id": 566790281,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1767808341
    },
    {
        "content": "<p><code>RingHom.Isometry.fromCompletion</code> too, but you would need to have <code>RingHom</code> opened for it to work (which is why I'm suggesting it)</p>",
        "id": 566790406,
        "sender_full_name": "Monica Omar",
        "timestamp": 1767808380
    },
    {
        "content": "<p>If <code>h : Isometry f</code> (where <code>Isometry</code> is in the root namespace), are you saying that <code>h.fromCompletion</code> would work if one defines <code>RingHom.Isometry.fromCompletion</code> and <code>RingHom</code> is open? I didn't know that!</p>",
        "id": 566790733,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1767808488
    },
    {
        "content": "<p>Yeah! But note that you need to explicitly <code>open RingHom</code> and not just be in the <code>namespace RingHom</code></p>",
        "id": 566790945,
        "sender_full_name": "Monica Omar",
        "timestamp": 1767808549
    },
    {
        "content": "<p>Even though namespace opens it..?</p>",
        "id": 566791104,
        "sender_full_name": "Monica Omar",
        "timestamp": 1767808600
    },
    {
        "content": "<p>Indeed it works:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"bp\">.</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">selfy</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Foo</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">selfy</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>I'd like to be sure it's a feature and not a bug, though :-)</p>",
        "id": 566791226,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1767808638
    },
    {
        "content": "<p>If we're going with <code>to</code> and <code>from</code>, I think that bare <code>completion</code> is fine (and involves fewer deprecations).</p>",
        "id": 566791408,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1767808685
    },
    {
        "content": "<blockquote>\n<p>I'd like to be sure it's a feature and not a bug, though :-)</p>\n</blockquote>\n<p>I think the part where we need to do <code>open Foo</code> rather than just be in the <code>Foo</code> namespace is a bug:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"bp\">.</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">selfy</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Foo</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">selfy</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"c1\">-- fails</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Foo</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">selfy</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 566791952,
        "sender_full_name": "Monica Omar",
        "timestamp": 1767808864
    },
    {
        "content": "<p>For me, it's rather the last one working which looks like a bug. But in any case the fact that one works and not the other is definitely a bug :-)</p>",
        "id": 566792497,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1767809026
    },
    {
        "content": "<p>I think <span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> added this feature (intentionally), but I can't never remember how to find the thread that mentioned it.</p>",
        "id": 566792629,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1767809068
    },
    {
        "content": "<p>Alright, I can do all the renames and stuff next week, unless someone wants to do it asap?<br>\nBut, I guess, for now, we can have the new definition of <code>ContinuousLinearMap.completion</code> <span class=\"user-mention\" data-user-id=\"939215\">@Gregory Wickham</span>?</p>",
        "id": 566792794,
        "sender_full_name": "Monica Omar",
        "timestamp": 1767809135
    },
    {
        "content": "<p>With this feature, I think it would even make sense to rename <code>Completion.map</code> to <code>UniformSpace.Function.completion</code>.</p>",
        "id": 566795726,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1767810085
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/naming.20convention.3A.20.60UniformSpace.2ECompletion.60.20morphisms/near/566777988\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=UniformSpace.Completion.mapRingHom#doc\">docs#UniformSpace.Completion.mapRingHom</a></p>\n</blockquote>\n<p>This looks best to me as there are many other kinds of completion out there</p>",
        "id": 566800636,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1767811750
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110050\">Sébastien Gouëzel</span> <a href=\"#narrow/channel/287929-mathlib4/topic/naming.20convention.3A.20.60UniformSpace.2ECompletion.60.20morphisms/near/566795726\">said</a>:</p>\n<blockquote>\n<p>With this feature, I think it would even make sense to rename <code>Completion.map</code> to <code>UniformSpace.Function.completion</code>.</p>\n</blockquote>\n<p>Sorry but I am still of the opinion that this \"feature\" shouldn't be used as it makes the naming convention needlessly complicated and unpredictable</p>",
        "id": 566801128,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1767811894
    },
    {
        "content": "<p>Unpredictable how?<br>\nI wouldn't say unpredictable, but names do get long yeah. But dot notation is a win I'd say.</p>",
        "id": 566802405,
        "sender_full_name": "Monica Omar",
        "timestamp": 1767812336
    },
    {
        "content": "<blockquote>\n<p>This looks best to me as there are many other kinds of completion out there</p>\n</blockquote>\n<p>I know you dislike this, but what about <code>UniformSpace.RingHom.completion</code>?</p>",
        "id": 566802630,
        "sender_full_name": "Monica Omar",
        "timestamp": 1767812409
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/287929-mathlib4/topic/naming.20convention.3A.20.60UniformSpace.2ECompletion.60.20morphisms/near/566800636\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/naming.20convention.3A.20.60UniformSpace.2ECompletion.60.20morphisms/near/566777988\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=UniformSpace.Completion.mapRingHom#doc\">docs#UniformSpace.Completion.mapRingHom</a></p>\n</blockquote>\n<p>This looks best to me as there are many other kinds of completion out there</p>\n</blockquote>\n<p>I don't see what other kind of completion this could be for <code>ContinuousLinearMap.completion</code>, say.</p>",
        "id": 566803199,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1767812558
    },
    {
        "content": "<p>Or <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=NormedAddGroupHom.completion#doc\">docs#NormedAddGroupHom.completion</a></p>",
        "id": 566803466,
        "sender_full_name": "Monica Omar",
        "timestamp": 1767812650
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/287929-mathlib4/topic/naming.20convention.3A.20.60UniformSpace.2ECompletion.60.20morphisms/near/566792629\">said</a>:</p>\n<blockquote>\n<p>I think <span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> added this feature (intentionally), but I can't never remember how to find the thread that mentioned it.</p>\n</blockquote>\n<ul>\n<li><a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/dot.20notation.20and.20open/with/543335338\">#lean4 &gt; dot notation and open</a> </li>\n<li><a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/open.20is.20confused/with/528814423\">#lean4 &gt; open is confused</a></li>\n</ul>",
        "id": 566831270,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1767823329
    }
]