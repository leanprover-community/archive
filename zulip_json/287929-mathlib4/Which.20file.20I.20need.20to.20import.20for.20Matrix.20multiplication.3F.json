[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">Matrix</span><span class=\"bp\">.</span><span class=\"n\">Defs</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Matrix</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mat_mul</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span>\n<span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"bp\">*</span><span class=\"n\">B</span>\n</code></pre></div>\n<p>This simple code fails because it cannot synthesize the instance HMul of given type Matrix (Fin 3) (Fin 3) ℝ. Ofcourse, if I import full Mathlib, it success, but I don't want to do it. </p>\n<p>I search in Mathlib database and expect something like <code>HMul (Matrix A B C) (Matrix B D C) (Matrix A D C) </code> exists but I cannot find it...</p>",
        "id": 538580853,
        "sender_full_name": "Hyunwoo Lee",
        "timestamp": 1757488139
    },
    {
        "content": "<p>You can import all of mathlib and then put <code>#min_imports</code> at the bottom of your file</p>",
        "id": 538581495,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1757488418
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Matrix</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mat_mul</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span>\n<span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"bp\">*</span><span class=\"n\">B</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">info: import Mathlib.Data.Matrix.Mul</span>\n<span class=\"sd\">import Mathlib.Data.Real.Basic</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"bp\">#</span><span class=\"n\">min_imports</span>\n</code></pre></div>\n<p>Seems like Mathlib.Data.Matrix.Mul is what you need here</p>",
        "id": 538581649,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1757488487
    },
    {
        "content": "<p>Thank you so much. You save me. </p>\n<p>instance <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Data/Matrix/Mul.html#Matrix.instHMulOfFintypeOfMulOfAddCommMonoid\">Matrix.instHMulOfFintypeOfMulOfAddCommMonoid</a> , that's what I want. </p>\n<p>But I still have two other questions.</p>\n<ol>\n<li>Doesn't #min_imports still make automation tactic like aesop bit slower while writing the proof interactively? That's the biggest reason I don't want to import Mathlib.</li>\n<li>I can't distinguish the definition in Mathlib.Data, and one in each module, such as Mathlib.LinearAlgebra. Is there a convention, or at least intuition about location of definition in Mathlib?</li>\n</ol>",
        "id": 538582802,
        "sender_full_name": "Hyunwoo Lee",
        "timestamp": 1757488954
    },
    {
        "content": "<p>When developing I always import mathlib, I minimise imports at the end. I don't care where things are (unless I'm trying to add to mathlib, then I have to learn)</p>",
        "id": 538590033,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1757491609
    }
]