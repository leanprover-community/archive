[
    {
        "content": "<p>The mathlib4 linter is sometimes unhappy with simp annotations.<br>\nThe ensuing link to the documentation explaining how to debug this leads to the mathlib3 docs!</p>",
        "id": 561513399,
        "sender_full_name": "Yuval Filmus",
        "timestamp": 1764707561
    },
    {
        "content": "<p>Please elaborate.</p>",
        "id": 561523006,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1764711074
    },
    {
        "content": "<p>What you're describing sounds wrong and like it should be fixed --- but it's hard to guess what exactly you mean. If you provide more detail (so we can reproduce ourselves), we can investigate.</p>",
        "id": 561533295,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1764715361
    },
    {
        "content": "<p>Perhaps he means this? (I ran into this issue earlier but fixed it) <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19838703436/job/56842041319\">https://github.com/leanprover-community/mathlib4/actions/runs/19838703436/job/56842041319</a></p>",
        "id": 561536867,
        "sender_full_name": "David Ledvinka",
        "timestamp": 1764716929
    },
    {
        "content": "<p>but the link is to mathlib3 doc</p>",
        "id": 561536889,
        "sender_full_name": "David Ledvinka",
        "timestamp": 1764716943
    },
    {
        "content": "<p>So really this is a batteries issue, as it appears on <a href=\"https://github.com/leanprover-community/batteries/blob/e1c1e06b9cbfc873b309695c9e9584de88ec22ac/Batteries/Tactic/Lint/Simp.lean#L106\">this line</a> of the <code>simpNF</code> linter.</p>",
        "id": 561537567,
        "sender_full_name": "Chris Henson",
        "timestamp": 1764717312
    },
    {
        "content": "<p>It could be updated maybe to <a href=\"https://leanprover-community.github.io/extras/simp.html#simp-normal-form\">https://leanprover-community.github.io/extras/simp.html#simp-normal-form</a> or <a href=\"https://lean-lang.org/doc/reference/latest/The-Simplifier/Simp-Normal-Forms/\">https://lean-lang.org/doc/reference/latest/The-Simplifier/Simp-Normal-Forms/</a>?</p>",
        "id": 561538017,
        "sender_full_name": "Chris Henson",
        "timestamp": 1764717513
    },
    {
        "content": "<p>Though those are a bit different from the original note giving specific tips about the linter.</p>",
        "id": 561538802,
        "sender_full_name": "Chris Henson",
        "timestamp": 1764717912
    },
    {
        "content": "<p>The error is part of <em>continuous integration (mathlib forks)</em>.<br>\nThe exact text (in a sample case) is:</p>\n<p>/- The <code>simpNF</code> linter reports:</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:22\">https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:22</a>SOME SIMP LEMMAS ARE NOT IN SIMP-NORMAL FORM.</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:23\">https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:23</a>see note [simp-normal form] for tips how to debug this.</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:24\">https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:24</a>https://leanprover-community.github.io/mathlib_docs/notes.html#simp-normal%20form -/</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:25\">https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:25</a>-- Mathlib.Analysis.SpecialFunctions.Arcosh</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:26\">https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:26</a>Error: /home/lean/actions-runner/_work/mathlib4/mathlib4/pr-branch/Mathlib/Analysis/SpecialFunctions/Arcosh.lean:183:3: error: Real.cosh'OrderIso_apply_coe Left-hand side simplifies from</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:27\">https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:27</a>↑(Real.cosh'OrderIso x)</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:28\">https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:28</a>to</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:29\">https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:29</a>↑(Real.cosh'OrderIso x)</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:30\">https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:30</a>using</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:31\">https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:31</a>dsimp only [*, AOReal.val_eq_coe]</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:32\">https://github.com/leanprover-community/mathlib4/actions/runs/19871554851/job/56948601734#step:37:32</a>Try to change the left-hand side to the simplified term!</p>",
        "id": 561571638,
        "sender_full_name": "Yuval Filmus",
        "timestamp": 1764743848
    },
    {
        "content": "<p>Thanks! <a href=\"https://github.com/leanprover-community/batteries/pull/1544\">batteries#1544</a> improves the error messages.</p>",
        "id": 561591183,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1764752255
    },
    {
        "content": "<p>CC <span class=\"user-mention\" data-user-id=\"238446\">@Anne Baanen</span> Here's another documentation question: should the practical tips from <a href=\"https://leanprover-community.github.io/mathlib_docs/notes.html#simp-normal%20form\">https://leanprover-community.github.io/mathlib_docs/notes.html#simp-normal%20form</a> be integrated into <a href=\"https://leanprover-community.github.io/extras/simp.html#simp-normal-form\">https://leanprover-community.github.io/extras/simp.html#simp-normal-form</a>? Do you have capacity to do so?</p>",
        "id": 561591338,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1764752295
    },
    {
        "content": "<p>Actually, a better fix might be to port <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=LibraryNote#doc\">docs#LibraryNote</a> to batteries, and then link to the documentation entry for the \"simp normal form\" library note as before. But you also wanted to do that, right?</p>",
        "id": 561593909,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1764753096
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Error.20messages/near/561593909\">said</a>:</p>\n<blockquote>\n<p>Actually, a better fix might be to port <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=LibraryNote#doc\">docs#LibraryNote</a> to batteries, and then link to the documentation entry for the \"simp normal form\" library note as before. But you also wanted to do that, right?</p>\n</blockquote>\n<p>Yes, that was my plan once I got doc-gen to output a library notes page. But I can already do the upstreaming right now, and then add the doc-gen support later.</p>",
        "id": 561623794,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1764760909
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Error.20messages/near/561593909\">said</a>:</p>\n<blockquote>\n<p>Actually, a better fix might be to port <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=LibraryNote#doc\">docs#LibraryNote</a> to batteries, and then link to the documentation entry for the \"simp normal form\" library note as before. But you also wanted to do that, right?</p>\n</blockquote>\n<p>I agree this is better, for the reason I mention above of the note serving a different purpose than other docs. (A different Divio quadrant, to use the language of the new documentation overview.)</p>",
        "id": 561634773,
        "sender_full_name": "Chris Henson",
        "timestamp": 1764763930
    },
    {
        "content": "<p>Upstreaming PR: <a href=\"https://github.com/leanprover-community/batteries/pull/1545\">batteries#1545</a> (should build now, I'll work on the Mathlib adaptation right now)</p>",
        "id": 561640841,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1764765703
    },
    {
        "content": "<p>So now all library notes, including downstream uses, fall under the <code>_root_.LibraryNote</code> namespace? This seems like an improvement to me. </p>\n<p>I suppose you could have <code>library_note</code> take an optional top level namespace to nest under if you wanted to differentiate where they were added similar to what Mathlib has currently, but maybe that's unnecessary.</p>",
        "id": 561646608,
        "sender_full_name": "Chris Henson",
        "timestamp": 1764767307
    }
]