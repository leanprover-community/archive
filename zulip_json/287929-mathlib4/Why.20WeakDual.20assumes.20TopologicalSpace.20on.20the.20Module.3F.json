[
    {
        "content": "<p>In Mathlib.Topology.Algebra.Module.WeakDual the current definition is</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"w\"> </span><span class=\"n\">ùïù</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span>\n\n<span class=\"sd\">/-- The weak star topology is the topology coarsest topology on `E ‚ÜíL[ùïú] ùïú` such that all</span>\n<span class=\"sd\">functionals `fun v =&gt; v x` are continuous. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">WeakDual</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ùïú</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommSemiring</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ContinuousAdd</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">ContinuousConstSMul</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">WeakBilin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">topDualPairing</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">AddCommMonoid</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">TopologicalSpace</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ContinuousAdd</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Inhabited</span><span class=\"o\">,</span>\n<span class=\"w\">  </span><span class=\"n\">FunLike</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ContinuousLinearMapClass</span>\n</code></pre></div>\n<p>What I fail to understand is <code> [TopologicalSpace E] </code> assumption. In particular, I am finding myself in a situation where my vector space is not equipped with a topology but nevertheless I want weak topology on the algebraic duals. It is possible to use <code>WeakBilin</code> API and basically repeat steps taken in <code>WeakDual </code> without  <code> [TopologicalSpace E] </code> assumption. But this adds a lot of redundancy. What is the correct way of handling this problem?</p>",
        "id": 560921530,
        "sender_full_name": "Paradoxy",
        "timestamp": 1764428511
    },
    {
        "content": "<p>The weak-* topology is a topology over the topological dual, which only exists if <code>E</code> has a topology.</p>",
        "id": 560922537,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1764429454
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"703970\">Etienne Marion</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Why.20WeakDual.20assumes.20TopologicalSpace.20on.20the.20Module.3F/near/560922537\">said</a>:</p>\n<blockquote>\n<p>The weak-* topology is a topology over the topological dual, which only exists if <code>E</code> has a topology.</p>\n</blockquote>\n<p>Sorry, I don't follow. The topology is indeed required on the underlying Field, but not on the vector space itself. <a href=\"https://en.wikipedia.org/wiki/Weak_topology#Weak_topology_with_respect_to_a_pairing\">https://en.wikipedia.org/wiki/Weak_topology#Weak_topology_with_respect_to_a_pairing</a></p>",
        "id": 560923893,
        "sender_full_name": "Paradoxy",
        "timestamp": 1764430561
    },
    {
        "content": "<p><code>WeakDual</code> is the continuous dual, not the algebraic one</p>",
        "id": 560923992,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1764430645
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Ya√´l Dillies</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Why.20WeakDual.20assumes.20TopologicalSpace.20on.20the.20Module.3F/near/560923992\">said</a>:</p>\n<blockquote>\n<p><code>WeakDual</code> is the continuous dual, not the algebraic one</p>\n</blockquote>\n<p>I understand. But what is the proper way of handling the issue I described in my question? Should I simply repeat the same file, without <code>[TopologicalSpace E]</code> assumption?</p>",
        "id": 560924156,
        "sender_full_name": "Paradoxy",
        "timestamp": 1764430789
    },
    {
        "content": "<p>Probably you should use <code>WeakBilin</code> with <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/LinearAlgebra/Dual/Defs.html#Module.dualPairing\">Module.dualPairing</a>.</p>",
        "id": 560924334,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1764430912
    },
    {
        "content": "<p>What is your use case?</p>",
        "id": 560924379,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1764430952
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"703970\">Etienne Marion</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Why.20WeakDual.20assumes.20TopologicalSpace.20on.20the.20Module.3F/near/560924334\">said</a>:</p>\n<blockquote>\n<p>Probably you should use <code>WeakBilin</code> with <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/LinearAlgebra/Dual/Defs.html#Module.dualPairing\">Module.dualPairing</a>.</p>\n</blockquote>\n<p>Yeah, this is what I currently have, but it doesn't look right to me to repeat the same construction all over again. Note if <code>WeakDual</code> was defined for algebraic duals, it would've worked for continuous duals for the most part as well, since continuous dual is a special case of algebraic dual. But the way it is defined currently make repetition necessary. </p>\n<p>I am working on tensor product of partially vector spaces. In particular, topology is not assumed in this vector spaces to keep the choice of tensor product unique.</p>",
        "id": 560924656,
        "sender_full_name": "Paradoxy",
        "timestamp": 1764431200
    },
    {
        "content": "<p>Continuous dual is not a special case of algebraic dual -- it's the other way around. Presumably you could just put the discrete topology on E or something?</p>",
        "id": 560924725,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1764431266
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Why.20WeakDual.20assumes.20TopologicalSpace.20on.20the.20Module.3F/near/560924725\">said</a>:</p>\n<blockquote>\n<p>Continuous dual is not a special case of algebraic dual -- it's the other way around.</p>\n</blockquote>\n<p>Sorry, I don't understand. Every Continuous dual is an algebraic dual through <code>ContinuousLinearMap.toLinearMap</code> but not every algebraic dual is a Continuous dual .  </p>\n<p>I am not allowed to put any topology on the vector space.</p>",
        "id": 560924908,
        "sender_full_name": "Paradoxy",
        "timestamp": 1764431431
    },
    {
        "content": "<p>Every <em>element</em> of the continuous dual is an <em>element</em> of the algebraic dual. That means that the continuous dual is a subset of the algebraic dual, not that it is equal to it. And what Kevin is saying is that the algebraic dual is equal to the continuous dual with respect to the discrete topology.</p>",
        "id": 560925248,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1764431693
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Ya√´l Dillies</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Why.20WeakDual.20assumes.20TopologicalSpace.20on.20the.20Module.3F/near/560925248\">said</a>:</p>\n<blockquote>\n<p>That means that the continuous dual is a subset of the algebraic dual, not that it is equal to it.</p>\n</blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"387244\">Ya√´l Dillies</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Why.20WeakDual.20assumes.20TopologicalSpace.20on.20the.20Module.3F/near/560925248\">said</a>:</p>\n<blockquote>\n<p>Every <em>element</em> of the continuous dual is an <em>element</em> of the algebraic dual. That means that the continuous dual is a subset of the algebraic dual, not that it is equal to it. And what Kevin is saying is that the algebraic dual is equal to the continuous dual with respect to the discrete topology.</p>\n</blockquote>\n<p>Which I presume it means in a general setting where no discrete topology is available, continuous dual is a special case of algebraic dual, or a subset as you put it. Given this fact, should I repeat the construction or should I weaken the current construction?</p>",
        "id": 560925526,
        "sender_full_name": "Paradoxy",
        "timestamp": 1764431937
    },
    {
        "content": "<p>My instinct would just be to use <code>WeakBilin</code> and if there is API which is there for <code>WeakDual</code> but not <code>WeakBilin</code> then just add it to <code>WeakBilin</code>.</p>",
        "id": 560925536,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1764431942
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Why.20WeakDual.20assumes.20TopologicalSpace.20on.20the.20Module.3F/near/560925536\">said</a>:</p>\n<blockquote>\n<p>My instinct would just be to use <code>WeakBilin</code> and if there is API which is there for <code>WeakDual</code> but not <code>WeakBilin</code> then just add it to <code>WeakBilin</code>.</p>\n</blockquote>\n<p>It will be a part of much larger contribution to mathlib4 library itself. Is it acceptable to have these two types of WeakDuals in the library? I genuinely do not know.</p>",
        "id": 560925711,
        "sender_full_name": "Paradoxy",
        "timestamp": 1764432067
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"900949\">Paradoxy</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Why.20WeakDual.20assumes.20TopologicalSpace.20on.20the.20Module.3F/near/560925526\">said</a>:</p>\n<blockquote>\n<p>continuous dual is a special case of algebraic dual, or a subset as you put it.</p>\n</blockquote>\n<p>This is just a grammar issue. \"Construction X is a special case of construction Y\" means \"if you can do construction Y then you can do construction X using it because it's a special case\". \"Construction X is a subset of Construction Y\" means something else, it means every element of construction X is an element of construction Y. All of us know what is happening mathematically so there is nothing more to say here.</p>\n<p>I am not suggesting you make a second <code>WeakDual</code>, I am suggesting you use <code>WeakBilin</code> and do not make any new things. Mathlib maintainers love PRs which add new theorems and API for given definitions. They are far more fussy about PRs which add new definitions and are extremely fussy about PRs which change definitions. </p>\n<p>You have never made it clear what is wrong with <code>WeakBilin</code>. Why is it not just the answer to your question?</p>",
        "id": 560925975,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1764432253
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Why.20WeakDual.20assumes.20TopologicalSpace.20on.20the.20Module.3F/near/560925975\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"900949\">Paradoxy</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Why.20WeakDual.20assumes.20TopologicalSpace.20on.20the.20Module.3F/near/560925526\">said</a>:</p>\n<blockquote>\n<p>continuous dual is a special case of algebraic dual, or a subset as you put it.</p>\n</blockquote>\n<p>This is just a grammar issue. \"Construction X is a special case of construction Y\" means \"if you can do construction Y then you can do construction X using it because it's a special case\". \"Construction X is a subset of Construction Y\" means something else, it means every element of construction X is an element of construction Y. All of us know what is happening mathematically so there is nothing more to say here.</p>\n<p>I am not suggesting you make a second <code>WeakDual</code>, I am suggesting you use <code>WeakBilin</code> and do not make any new things. Mathlib maintainers love PRs which add new theorems and API for given definitions. They are far more fussy about PRs which add new definitions and are extremely fussy about PRs which change definitions. </p>\n<p>You have never made it clear what is wrong with <code>WeakBilin</code>. Why is it not just the answer to your question?</p>\n</blockquote>\n<p>Yes, sorry I am not a native English speaker.  Currently, I have</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">LinearAlgebra</span><span class=\"bp\">.</span><span class=\"n\">Dual</span><span class=\"bp\">.</span><span class=\"n\">Lemmas</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">LocallyConvex</span><span class=\"bp\">.</span><span class=\"n\">WeakDual</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">Submodule</span><span class=\"w\"> </span><span class=\"n\">WeakBilin</span><span class=\"w\"> </span><span class=\"n\">Topology</span>\n\n<span class=\"kn\">section</span><span class=\"w\"> </span><span class=\"n\">Dual</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">instAddCommGroup</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Dual</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">WeakBilin</span><span class=\"bp\">.</span><span class=\"n\">instAddCommGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">dualPairing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">instModule</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Dual</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">WeakBilin</span><span class=\"bp\">.</span><span class=\"n\">instModule'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">dualPairing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">instTopologicalSpace</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Dual</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">WeakBilin</span><span class=\"bp\">.</span><span class=\"n\">instTopologicalSpace</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">dualPairing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">dual_coefn_continuous</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Continuous</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Dual</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">continuous_induced_dom</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">dual_eval_continuous</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Continuous</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Dual</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">continuous_pi_iff</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"n\">dual_coefn_continuous</span><span class=\"w\"> </span><span class=\"n\">y</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsTopologicalAddGroup</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ContinuousSMul</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">instIsTopologicalAddGroup</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsTopologicalAddGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Dual</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">WeakBilin</span><span class=\"bp\">.</span><span class=\"n\">instIsTopologicalAddGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">dualPairing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">instContinuousAdd</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContinuousAdd</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Dual</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">WeakBilin</span><span class=\"bp\">.</span><span class=\"n\">instContinuousAdd</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">dualPairing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">instContinuousSMul</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContinuousSMul</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Dual</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">‚ü®</span><span class=\"n\">continuous_induced_rng</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span>\n<span class=\"w\">    </span><span class=\"n\">continuous_fst</span><span class=\"bp\">.</span><span class=\"n\">smul</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">WeakBilin</span><span class=\"bp\">.</span><span class=\"n\">coeFn_continuous</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">dualPairing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">continuous_snd</span><span class=\"o\">)</span><span class=\"bp\">‚ü©</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">instT2Space</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">T2Space</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T2Space</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Dual</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">WeakBilin</span><span class=\"bp\">.</span><span class=\"n\">isEmbedding</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">t2Space</span>\n</code></pre></div>\n<p>It works just fine for the later constructions. I can either add this to <code>WeakBilin</code> as you suggested, or maybe keep it as a separate file. Alternatively, there is an option of weakening WeakDual assumptions, making all these lines unnecessary.</p>",
        "id": 560926255,
        "sender_full_name": "Paradoxy",
        "timestamp": 1764432508
    },
    {
        "content": "<p>You shouldn't put instances on <code>Dual R V</code>, instead you should manipulate <code>WeakBilin (Module.dualPairing R V)</code> which already has the topological instance you want. And if you want an instance that is missing, then you should add it to <code>WeakBilin</code>.</p>",
        "id": 560926424,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1764432673
    },
    {
        "content": "<p>If you get bored of typing <code>WeakBilin (Module.dualPairing R V)</code> then you can make an <code>abbrev</code> in your file.</p>",
        "id": 560926538,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1764432755
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"703970\">Etienne Marion</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Why.20WeakDual.20assumes.20TopologicalSpace.20on.20the.20Module.3F/near/560926424\">said</a>:</p>\n<blockquote>\n<p>You shouldn't put instances on <code>Dual R V</code>, instead you should manipulate <code>WeakBilin (Module.dualPairing R V)</code> which already has the topological instance you want. And if you want an instance that is missing, then you should add it to <code>WeakBilin</code>.</p>\n</blockquote>\n<p>How should I avoid defining instances? For example, I want to prove a particular set of dual vectors is compact in this topology. Either I have to use the instance shown above, or every time I have to manually type</p>\n<p><code>@IsCompact _ (WeakBilin.instTopologicalSpace (dualPairing R V)) ...</code></p>\n<p>Is there any other option?</p>",
        "id": 560938356,
        "sender_full_name": "Paradoxy",
        "timestamp": 1764443891
    },
    {
        "content": "<p>You should never write <code>Dual R V</code>, and always write <code>WeakBilin (Module.dualPairing R V)</code> (or an abbrev you may have created).</p>",
        "id": 560938690,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1764444236
    },
    {
        "content": "<p>That's the point of having a type synonym: it is the same underlying type, but the name is different so you can endow it with different instances.</p>",
        "id": 560938727,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1764444273
    }
]