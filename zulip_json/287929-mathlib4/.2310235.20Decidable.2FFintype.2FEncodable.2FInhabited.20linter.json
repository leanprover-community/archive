[
    {
        "content": "<p>In case anybody wonders:</p>\n<ul>\n<li>I asked urkud before posting this, and</li>\n<li>I'm happy to help with reviewing or cleaning up the implementation (in fact, <a href=\"https://github.com/leanprover-community/mathlib4/tree/MR-metrisable-lint\">branch#MR-metrisable-lint</a> does some of this). But I don't know how to implement the above tweak (yet?).</li>\n</ul>",
        "id": 472263358,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1727105194
    },
    {
        "content": "<p>Trying to add that check myself, I can only add rough approximations:</p>\n<ul>\n<li>I can match on the constantInfo variant, and only lint e.g. axioms, defs, theorems and opaques. Every structure is an inductive type, so this avoid these false positives. I'm not sure about false negatives.</li>\n<li>I could also just exclude all inductive types: that is more comprehensive, but I'm also not sure about false negatives.</li>\n<li>I'm not sure if there's an easy way to check for \"is this a structure definition?\". <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.matchConstStruct#doc\">docs#Lean.matchConstStruct</a> seems related, but is not quite it.</li>\n</ul>\n<p>Some advice would be appreciated.</p>",
        "id": 472263567,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1727105248
    },
    {
        "content": "<p>I think that we should ignore all inductive types for now. We can add them back when we decide what should we check for.</p>",
        "id": 472293575,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1727113788
    },
    {
        "content": "<p>About metrizable: could you please open a draft PR?</p>",
        "id": 472293715,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1727113823
    },
    {
        "content": "<p>I have pushed my clean-up changes to <a href=\"https://github.com/leanprover-community/mathlib4/pull/10235\">#10235</a>, and made it skip all inductive types. (Partial types would be easy to add; I'll wait to see the current count of false positives first.)</p>",
        "id": 472536152,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1727197000
    },
    {
        "content": "<p>I'll file a PR about metrisable depending on this one.</p>",
        "id": 472536176,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1727197014
    },
    {
        "content": "<p>Update: omitting inductive types does not appear to have helped a lot. Help investigating is welcome.</p>",
        "id": 472541225,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1727198693
    },
    {
        "content": "<p>We should somehow skip constructors of inductive types.</p>",
        "id": 472573634,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1727211917
    },
    {
        "content": "<p>I have now tried to also skip the <code>ConstantInfo.ctorInfo</code> variant: let's see if that helps.</p>",
        "id": 472582633,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1727216843
    },
    {
        "content": "<p>It did: with that change, nolinting some real false positives and two fixes (PRed as <a href=\"https://github.com/leanprover-community/mathlib4/pull/17125\">#17125</a> and <a href=\"https://github.com/leanprover-community/mathlib4/pull/17126\">#17126</a>), there are only <strong>23</strong> linter warnings left.</p>",
        "id": 472628115,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1727248396
    },
    {
        "content": "<p>Fixes for <code>decidableClassical</code> to lemmas in the <code>Decidable</code> namespace should be reverted, and all these lemmas should be ignored by the linter.</p>",
        "id": 472714864,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1727275553
    },
    {
        "content": "<p>Also, why do you need <code>nolint</code> in <code>Analytic/CPolynomial</code> and <code>Galois/Basic</code>?</p>",
        "id": 472715135,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1727275621
    },
    {
        "content": "<p>I can look at these later tonight, starting day job right now.</p>",
        "id": 472715237,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1727275654
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/287929-mathlib4/topic/.2310235.20Decidable.2FFintype.2FEncodable.2FInhabited.20linter/near/472715237\">said</a>:</p>\n<blockquote>\n<p>I can look at these later tonight, starting day job right now.</p>\n</blockquote>\n<p>That's very welcome; I'll be pretty busy for the rest of the week.</p>",
        "id": 472779702,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1727301381
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/10235\">#10235</a> is now green and basically ready for review. (There are three small PRs for fixing violations: <a href=\"https://github.com/leanprover-community/mathlib4/pull/17502\">#17502</a>, <a href=\"https://github.com/leanprover-community/mathlib4/pull/17505\">#17505</a> and <a href=\"https://github.com/leanprover-community/mathlib4/pull/17509\">#17509</a>.) Comments are welcome!</p>",
        "id": 475402034,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1728336360
    },
    {
        "content": "<p><img alt=\":merge:\" class=\"emoji\" src=\"https://avatars.zulip.com/3121/emoji/images/37577b95.png\" title=\"merge\"> for the 3 deps</p>",
        "id": 475465759,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1728361418
    }
]