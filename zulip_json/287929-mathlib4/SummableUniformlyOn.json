[
    {
        "content": "<p>As part of  <a href=\"https://github.com/leanprover-community/mathlib4/pull/13349\">#13349</a> one suggestion I've had from <span class=\"user-mention\" data-user-id=\"481963\">@David Loeffler</span>  is to maybe define the notion of summableUniformlyOn (and multipliable versions), for infinite sums/products that converge uniformly on some subset. I guess we could start with something like:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">HasProdUniformlyOn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œπ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Œ≤</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œ≤</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Œ≤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">TendstoUniformlyOn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">Œπ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"bp\">‚àè</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">atTop</span><span class=\"w\"> </span><span class=\"n\">s</span>\n</code></pre></div>\n<p>and then build the API from there. Are there any thoughts/suggestions on this approach?</p>",
        "id": 509163256,
        "sender_full_name": "Chris Birkbeck",
        "timestamp": 1743418112
    },
    {
        "content": "<p>I have no idea how to do it properly but I agree we should definitely have some form of this.</p>",
        "id": 509177880,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1743422072
    },
    {
        "content": "<p>Why does <code>HasProdUniformlyOn</code> take a family of sets instead of just one set? <br>\nContext: I am trying to restate <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=tendstoUniformlyOn_tsum#doc\">docs#tendstoUniformlyOn_tsum</a> and friends to <code>HasProdUniformlyOn</code> and I am wondering if we were happy with the following or if we want the set family version.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">summableUniformlyOn_tsum</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Œ≤</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hu</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Summable</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Œ≤</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hfu</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"bp\">‚Äñ</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">‚Äñ</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SummableUniformlyOn</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"o\">}</span>\n</code></pre></div>\n<p>I am guessing we should just make <code>SummableUniformlyOn</code> take only one set but I have little experience around these.</p>",
        "id": 553838193,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1762345071
    },
    {
        "content": "<p>IIRC it was todo with being able to match or use what we have for <code>UniformOnFun</code> which takes a family of sets.</p>",
        "id": 553853971,
        "sender_full_name": "Chris Birkbeck",
        "timestamp": 1762349195
    },
    {
        "content": "<p>It is hard to recover <code>Œ≤ ‚Üí·µ§[ùîñ] F</code> from <code>Œ≤ ‚Üí·µ§[{s}] F</code> but it is easy to recover <code>SummableUniformlyOn f ùîñ</code> from <code>SummableUniformlyOn f {s}</code> via <code>‚àÄ s ‚àà ùîñ, SummableUniformlyOn f {s}</code>. So I think it is reasonable to stick with <code>SummableUniformlyOn f {s}</code> (i.e. redefine  <code>SummableUniformlyOn</code> to take a set instead of a bunch of sets) so that the <code>*On</code> predicates have a more uniform API?</p>",
        "id": 553861762,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1762350724
    },
    {
        "content": "<p>I sort of agree, so far I've only used if for a single set. But maybe <span class=\"user-mention\" data-user-id=\"481963\">@David Loeffler</span>  has some thoughts on this?</p>",
        "id": 553862368,
        "sender_full_name": "Chris Birkbeck",
        "timestamp": 1762350875
    },
    {
        "content": "<p>Is it actually true that <code>SummableUniformlyOn f ùîñ</code> is equivalent to <code>‚àÄ s ‚àà ùîñ, SummableUniformlyOn f {s}</code>? It is true for <code>HasSum</code>, but for the <code>Summable</code> statement we might have some horrible situation where the sum over each <code>s</code> was convergent but the limit depended on which <code>s</code> you took. Probably this is impossible if the target space is Hausdorff but it's not \"definitionally impossible\".</p>",
        "id": 553910534,
        "sender_full_name": "David Loeffler",
        "timestamp": 1762361345
    },
    {
        "content": "<p>Good point. I agree my claim above is not always true. But do we need this extra bit of flexibility?</p>",
        "id": 553911721,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1762361598
    },
    {
        "content": "<p>Here is the PR attempting the change: <a href=\"https://github.com/leanprover-community/mathlib4/pull/31293\">#31293</a></p>",
        "id": 553918211,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1762363037
    },
    {
        "content": "<p>I think the extra bit of flexibility (coming from the difference between<code>‚àÄ s ‚àà ùîñ, ‚àÉ g, ...</code> vs <code>‚àÉ g, ‚àÄ s‚àà ùîñ, ...</code>) is not that useful, because the two conditions are equivalent when the target space is T2, and without this sanity assumption the theory of infinite sums / products is a mess anyway.  I think it's a good idea to get rid of the set families.</p>",
        "id": 553935898,
        "sender_full_name": "David Loeffler",
        "timestamp": 1762367865
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"481963\">David Loeffler</span> <a href=\"#narrow/channel/287929-mathlib4/topic/SummableUniformlyOn/near/553910534\">said</a>:</p>\n<blockquote>\n<p>Is it actually true that <code>SummableUniformlyOn f ùîñ</code> is equivalent to <code>‚àÄ s ‚àà ùîñ, SummableUniformlyOn f {s}</code>? It is true for <code>HasSum</code>, but for the <code>Summable</code> statement we might have some horrible situation where the sum over each <code>s</code> was convergent but the limit depended on which <code>s</code> you took. Probably this is impossible if the target space is Hausdorff but it's not \"definitionally impossible\".</p>\n</blockquote>\n<p>Uniform spaces are pretty nice, they are R1-separated, meaning if you quotient out by the equivalence relation of \"topologically indistinguishable\" (pass to the <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SeparationQuotient#doc\">docs#SeparationQuotient</a>) you get a hausdorff space</p>",
        "id": 553945609,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762370897
    },
    {
        "content": "<p>And for a set of topologically indistinguishable points, if you converge to one you converge to all, so that shouldn't affect summability.</p>",
        "id": 553947031,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762371376
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> Interesting. Are you saying you can deduce <code>SummableUniformlyOn f ùîñ</code> from <code>‚àÄ s ‚àà ùîñ, SummableUniformlyOn f {s}</code> without assuming the target of <code>f</code> is Hausdorff (or T0, which is equivalent in this setting)?</p>",
        "id": 553948345,
        "sender_full_name": "David Loeffler",
        "timestamp": 1762371857
    },
    {
        "content": "<p>I'm saying, it shouldn't be a problem to assume all your spaces are hausdorff (since they basically are)</p>",
        "id": 553948595,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762371920
    },
    {
        "content": "<p>I do not understand what you mean, since it is definitely not the case that a uniform space is automatically Hausdorff.</p>",
        "id": 553948769,
        "sender_full_name": "David Loeffler",
        "timestamp": 1762371979
    },
    {
        "content": "<p>But a T0 uniform space is hausdorff, and all spaces are essentially T0</p>",
        "id": 553948950,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762372048
    },
    {
        "content": "<p>You are using words like \"basically\" and \"essentially\" in ways that I am struggling to attach a rigorous meaning to.</p>",
        "id": 553949040,
        "sender_full_name": "David Loeffler",
        "timestamp": 1762372086
    },
    {
        "content": "<p>I was using \"basically\" in an informal manner</p>",
        "id": 553949100,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762372111
    },
    {
        "content": "<p>\"all spaces are essentially T0\" means that every space is equivalent to a T0 space</p>",
        "id": 553949255,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762372172
    },
    {
        "content": "<p>Where \"equivalent\" means what, may I ask?</p>",
        "id": 553949338,
        "sender_full_name": "David Loeffler",
        "timestamp": 1762372199
    },
    {
        "content": "<p>I think what Aaron is trying to say is yes to the following</p>\n<p><span class=\"user-mention silent\" data-user-id=\"481963\">David Loeffler</span> <a href=\"#narrow/channel/287929-mathlib4/topic/SummableUniformlyOn/near/553948345\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> Interesting. Are you saying you can deduce <code>SummableUniformlyOn f ùîñ</code> from <code>‚àÄ s ‚àà ùîñ, SummableUniformlyOn f {s}</code> without assuming the target of <code>f</code> is Hausdorff (or T0, which is equivalent in this setting)?</p>\n</blockquote>\n<p>Because you can do this on the t0 quotient (i.e. quotient by the inseparable relation), and any lift would still be a limit.</p>",
        "id": 553949450,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1762372234
    },
    {
        "content": "<p>I think that's what he's trying to say as well, but it's not self-explanatory to me that this works.</p>",
        "id": 553949808,
        "sender_full_name": "David Loeffler",
        "timestamp": 1762372370
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"481963\">David Loeffler</span> <a href=\"#narrow/channel/287929-mathlib4/topic/SummableUniformlyOn/near/553949338\">said</a>:</p>\n<blockquote>\n<p>Where \"equivalent\" means what, may I ask?</p>\n</blockquote>\n<p>Continuous function with continuous not-quite-inverse such that both ways composition is pointwise inseparable from identity function</p>",
        "id": 553949881,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762372396
    },
    {
        "content": "<p>This is not what \"topological equivalence\" means in mathlib (where it's a synonym for \"homeomorphism\").</p>\n<p>To explain a little more what I was getting at above: if X, Y are uniform spaces, then functions X -&gt; Y are a uniform space in a natural way (this is <code>UniformOnFun</code> in mathlib). With this uniform structure, is the separation quotient of X --&gt; Y the same as X --&gt; (separation quotient of Y)? It seems plausible, but not entirely self-evident; and I think this what's needed to make the argument work.</p>\n<p>(EDIT: I mean uniformly-continuous functions here, not arbitrary functions, sorry.)</p>",
        "id": 553951246,
        "sender_full_name": "David Loeffler",
        "timestamp": 1762372828
    },
    {
        "content": "<p>yes it is</p>",
        "id": 553951315,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762372853
    },
    {
        "content": "<p>obviously</p>",
        "id": 553951386,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762372870
    },
    {
        "content": "<p>maybe not that obvious</p>",
        "id": 553951502,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762372906
    },
    {
        "content": "<p>well, it should at least be true that sepquot(X-&gt;Y) is uniform isomorphic to sepquot(X-&gt;sepquot(Y))</p>",
        "id": 553951721,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762372969
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> If you feel like a challenge, perhaps you might like to try proving  <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/Algebra/InfiniteSum/UniformOn.html#SummableUniformlyOn.hasSumUniformlyOn\">SummableUniformlyOn.hasSumUniformlyOn</a> (maybe just for <code>ùîñ = {s}</code> a singleton) with the <code>[T2Space Œ±]</code> hypothesis removed. (Note that there is no such hypothesis in <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/Algebra/InfiniteSum/Defs.html#Summable.hasSum\">Summable.hasSum</a>.)</p>",
        "id": 553953195,
        "sender_full_name": "David Loeffler",
        "timestamp": 1762373402
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"481963\">David Loeffler</span> <a href=\"#narrow/channel/287929-mathlib4/topic/SummableUniformlyOn/near/553953195\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> If you feel like a challenge, perhaps you might like to try proving  <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/Algebra/InfiniteSum/UniformOn.html#SummableUniformlyOn.hasSumUniformlyOn\">SummableUniformlyOn.hasSumUniformlyOn</a> (maybe just for <code>ùîñ = {s}</code> a singleton) with the <code>[T2Space Œ±]</code> hypothesis removed. (Note that there is no such hypothesis in <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/Algebra/InfiniteSum/Defs.html#Summable.hasSum\">Summable.hasSum</a>.)</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/31313\">#31313</a></p>",
        "id": 553995350,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762395513
    },
    {
        "content": "<p>A related PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/31377\">#31377</a></p>",
        "id": 554470571,
        "sender_full_name": "Yongxi Lin (Aaron)",
        "timestamp": 1762596659
    }
]