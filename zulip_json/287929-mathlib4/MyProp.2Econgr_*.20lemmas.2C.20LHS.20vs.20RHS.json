[
    {
        "content": "<p>When we have <code>(h : MyProp a b)</code>, then some <code>congr</code> lemmas assume that <code>ha</code> and <code>hb</code> in <code>(h.congr ha hb : MyProp a' b')</code> have the form <code>a = a'</code>, <code>b = b'</code>, while other lemmas expect <code>a' = a</code>, <code>b' = b</code> (and similary for other assumptions like <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Filter.EventuallyEq#doc\">docs#Filter.EventuallyEq</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Set.EqOn#doc\">docs#Set.EqOn</a>). E.g., we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ContinuousAt.congr#doc\">docs#ContinuousAt.congr</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ContinuousAt.congr_of_eventuallyEq#doc\">docs#ContinuousAt.congr_of_eventuallyEq</a> that differ by <code>EventuallyEq.symm</code>. Which convention should we use?</p>",
        "id": 572588355,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1770524756
    },
    {
        "content": "<p>I would expect a signature of the form <code>a = a' -&gt; P a -&gt; P a'</code></p>",
        "id": 572589389,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1770525201
    },
    {
        "content": "<p>Also, once we make a decision (so far, <code>a = a'</code> wins, but it's been only 25 minutes), should I go and change lemmas in place, or create new ones &amp; leave the old ones as deprecated?</p>",
        "id": 572590563,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1770526238
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> Do you think the order of <code>a = a'</code> and <code>P a</code> is important?</p>",
        "id": 572591097,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1770526862
    },
    {
        "content": "<p>I don't think it's as important as being consistent about the <code>=</code> direction, but I do prefer that order</p>",
        "id": 572591735,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1770527648
    },
    {
        "content": "<p>Currently, most of topology&amp;analysis <code>congr</code> lemmas (both asymptotics and continuity/differentiability) put <code>P a</code> first.</p>",
        "id": 572591804,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1770527739
    },
    {
        "content": "<p>I think this order: <code>P.congr : P a → a = a' → P a'</code> is common for the following reason. Often you know <code>P a</code> and you then supply a (sometimes long) proof of <code>a = a'</code>. So, if <code>hPa : P a</code> you can write <code>apply P.congr hPa</code> and then your goal will be <code>a = a'</code>, whereas in the reverse argument order, you would have to write <code>apply P.congr ?_ hPa</code>. Of course, if you use dot notation, this is moot because <code>apply hPa.congr</code> will generally work.</p>",
        "id": 572592071,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1770528103
    },
    {
        "content": "<p>Of course, this is a very minor point, but I think it might explain the slight preference for that order.</p>",
        "id": 572592144,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1770528212
    },
    {
        "content": "<p>I have an idea why so many lemmas in topology/analysis use <code>a' = a</code>. We want to show that some function is nice at a point. We simplify it near this point (so, we have <code>f = f'</code> with a simpler <code>f'</code>). Then we have <code>MyProp f'</code> and <code>f = f'</code>, so this order avoids <code>.symm</code> here and there.</p>",
        "id": 572592580,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1770528741
    },
    {
        "content": "<p>I'm going to wait for a day or two before going forward with swapping LHS and RHS in these lemmas.</p>",
        "id": 572593573,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1770529694
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span> WDYT? It looks like you've added some (most?) of the <code>congr_of_eventuallyEq</code> lemmas.</p>",
        "id": 572645987,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1770580685
    },
    {
        "content": "<p>I think coherence throughout the library is important. So changing the lemmas so that they all use the same order looks definitely like a good idea to me!</p>",
        "id": 572648990,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1770583566
    },
    {
        "content": "<p>Even nicer would be to have some kind of linter enforcing consistency.</p>",
        "id": 572649013,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1770583603
    },
    {
        "content": "<p>And documenting this in one of our documentation files.</p>",
        "id": 572649053,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1770583662
    },
    {
        "content": "<p>To minimize merge conflicts, I would prefer to get <a href=\"https://github.com/leanprover-community/mathlib4/pull/34965\">#34965</a> merged first, then I can open a PR swapping LHS with RHS in all these <code>congr</code> lemmas.</p>",
        "id": 572650466,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1770584900
    }
]