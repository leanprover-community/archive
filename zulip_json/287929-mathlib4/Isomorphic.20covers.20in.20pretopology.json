[
    {
        "content": "<p>Is the following true? <br>\nIf <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>J</mi></mrow><annotation encoding=\"application/x-tex\">J</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span></span></span></span> is a pretopology on <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>‚Üí</mo><mi>X</mi><msub><mo stretchy=\"false\">}</mo><mrow><mi>i</mi><mo>‚àà</mo><mi>I</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\{ Y_i \\to X \\}_{i \\in I}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\"><span class=\"mclose\">}</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">‚àà</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span></span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1774em;\"><span></span></span></span></span></span></span></span></span></span> is a cover of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span>, and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>Y</mi><mi>i</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">‚Ä≤</mo></msubsup><mo>‚âÖ</mo><msub><mi>Y</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">Y&#x27;_i \\cong Y_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0106em;vertical-align:-0.2587em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-2.4413em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">‚Ä≤</span></span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2587em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚âÖ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> is another family, then <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><msubsup><mi>Y</mi><mi>i</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">‚Ä≤</mo></msubsup><mo>‚Üí</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>‚Üí</mo><mi>X</mi><msub><mo stretchy=\"false\">}</mo><mrow><mi>i</mi><mo>‚àà</mo><mi>I</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\{ Y&#x27;_i \\to Y_i \\to X \\}_{i \\in I}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0106em;vertical-align:-0.2587em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-2.4413em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">‚Ä≤</span></span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2587em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\"><span class=\"mclose\">}</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">‚àà</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span></span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1774em;\"><span></span></span></span></span></span></span></span></span></span> is also a cover of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span>.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">Pretopology</span><span class=\"bp\">.</span><span class=\"n\">ofArrows_mem_of_iso</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasPullbacks</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">Œπ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Y'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œπ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">‚ü∂</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Y'</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">‚âÖ</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Pretopology</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Presieve</span><span class=\"bp\">.</span><span class=\"n\">ofArrows</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Presieve</span><span class=\"bp\">.</span><span class=\"n\">ofArrows</span><span class=\"w\"> </span><span class=\"n\">Y'</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">‚â´</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">¬∑</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>Answer: It is not (at least in mathlib)</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\"><pre><span></span><code>inductive M | A | B\n\ninductive M.Hom : M ‚Üí M ‚Üí Type\n | id X : M.Hom X X\n | flip : M.Hom A A\n | l : M.Hom A B\n | r : M.Hom A B\n\ndef M.Hom.comp : ‚àÄ {X Y Z : M}, X.Hom Y ‚Üí Y.Hom Z ‚Üí X.Hom Z\n  | _, _, _, .id _, g =&gt; g\n  | _, _, _, g, .id _ =&gt; g\n  | _, _, _, .flip, .l =&gt; .r\n  | _, _, _, .flip, .r =&gt; .l\n  | _, _, _, .flip, .flip =&gt; .id _\n\ninstance : Category M where\n  Hom := M.Hom\n  id := M.Hom.id\n  comp := M.Hom.comp\n  id_comp f := by cases f &lt;;&gt; rfl\n  comp_id f := by cases f &lt;;&gt; rfl\n  assoc f g h := by cases f &lt;;&gt; cases g &lt;;&gt; cases h &lt;;&gt; rfl\n\ninstance {X Y : M} (f : X ‚ü∂ Y) : Mono f := by\n  rcases f\n  ¬∑ show Mono (ùüô _); infer_instance\n  ¬∑ constructor\n    rintro _ ‚ü®‚ü© ‚ü®‚ü© ‚ü®‚ü© &lt;;&gt; rfl\n  ¬∑ constructor\n    rintro _ ‚ü®‚ü© ‚ü®‚ü© ‚ü®‚ü© &lt;;&gt; rfl\n  ¬∑ constructor\n    rintro _ ‚ü®‚ü© ‚ü®‚ü© ‚ü®‚ü© &lt;;&gt; rfl\n\nattribute [instance] hasPullback_of_left_iso hasPullback_of_right_iso in\ninstance : HasPullbacks M := by\n  apply (config := { allowSynthFailures := true }) hasPullbacks_of_hasLimit_cospan\n  rintro X Y Z ‚ü®‚ü© g\n  ¬∑ show HasPullback (ùüô _) _\n    infer_instance\n  ¬∑ rcases g\n    ¬∑ show HasPullback _ (ùüô _); infer_instance\n    ¬∑ infer_instance\n  ¬∑ rcases g\n    ¬∑ show HasPullback _ (ùüô _); infer_instance\n    ¬∑ infer_instance\n    ¬∑ show HasPullback (C := M) (M.Hom.flip ‚â´ M.Hom.r) M.Hom.r; infer_instance\n  ¬∑ rcases g\n    ¬∑ show HasPullback _ (ùüô _); infer_instance\n    ¬∑ show HasPullback (C := M) M.Hom.r (M.Hom.flip ‚â´ M.Hom.r); infer_instance\n    ¬∑ infer_instance\n\ndef M.pretopology : Pretopology M where\n  coverings X := { S | ‚àÉ Y, ‚àÉ (f : Y ‚ü∂ X), S = .singleton f }\n  has_isos _ _ _ _ := ‚ü®_, _, rfl‚ü©\n  pullbacks := by\n    rintro _ _ _ _ ‚ü®_, _, rfl‚ü©\n    simp only [Presieve.pullback_singleton, Set.mem_setOf_eq]\n    exact ‚ü®_, _, rfl‚ü©\n  transitive := by\n    rintro X S Ti ‚ü®Y, f, rfl‚ü© hS&#39;\n    choose Z fZ hZ using hS&#39;\n    refine ‚ü®_, fZ f .mk ‚â´ f, ?_‚ü©\n    refine funext‚ÇÇ fun W fW ‚Ü¶ eq_iff_iff.mpr ‚ü®?_, ?_‚ü©\n    ¬∑ rintro ‚ü®_, fW&#39;, c, ‚ü®‚ü©, e, rfl‚ü©\n      rcases (hZ _ _).le _ e\n      exact .mk\n    ¬∑ rintro ‚ü®‚ü©\n      exact ‚ü®_, _, _, .mk, (hZ _ _).ge _ .mk, rfl‚ü©\n\ndef M.flipIso : M.A ‚âÖ M.A where\n  hom := .flip\n  inv := .flip\n  hom_inv_id := rfl\n  inv_hom_id := rfl\n\nexample : False := by\n  obtain ‚ü®b, f, hf‚ü© := Pretopology.ofArrows_mem_of_iso (C := M) (f := fun b : Bool ‚Ü¶ M.Hom.l)\n    (e := fun b ‚Ü¶ bif b then .refl _ else M.flipIso) M.pretopology\n    ‚ü®_, .l, funext‚ÇÇ (fun X f ‚Ü¶ eq_iff_iff.mpr &lt;| by\n      constructor\n      ¬∑ rintro ‚ü®i‚ü©\n        exact .mk\n      ¬∑ rintro ‚ü®‚ü©\n        exact ‚ü®true‚ü©)‚ü©\n  rcases f\n  ¬∑ cases hf.ge _ .mk\n  ¬∑ cases hf.le _ (.mk false)\n  ¬∑ cases hf.le _ (.mk true)\n</code></pre></div>\n</div></div>\n<p>But is this true mathematically? Is our definition of <code>Pretopology</code> not strong enough?</p>",
        "id": 517197559,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1746830800
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"459699\">@Jo√´l Riou</span> <span class=\"user-mention\" data-user-id=\"648495\">@Christian Merten</span></p>",
        "id": 517197571,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1746830808
    },
    {
        "content": "<p>This is true if <code>Y</code> is injective (as a function!).</p>",
        "id": 517200699,
        "sender_full_name": "Christian Merten",
        "timestamp": 1746833144
    },
    {
        "content": "<p>But should it not be true for non injective Y?<br>\nThis is exceptionally bad when you consider this with our formulation of <code>pullbacks</code>. It says that if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">Y_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> is a cover, then <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><msub><mo>√ó</mo><mi>X</mi></msub><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">Y_i \\times_X Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"><span class=\"mbin\">√ó</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span> is also a cover of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span>, where here <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><msub><mo>√ó</mo><mi>X</mi></msub><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">Y_i \\times_X Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"><span class=\"mbin\">√ó</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span> is some random <code>Nonempty.some</code> of a pullback, and there is no guarantee that this is injective even if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">Y_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> is.</p>",
        "id": 517200952,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1746833311
    },
    {
        "content": "<p>I agree, it should be true for non-injective <code>Y</code>.<br>\nSo is the issue that <code>Presieve.ofArrows Y f</code> does not only depend on the range of <code>Y</code> and <code>f</code>?</p>",
        "id": 517201293,
        "sender_full_name": "Christian Merten",
        "timestamp": 1746833618
    },
    {
        "content": "<p>Yeah and <code>bind</code> only allow sieves depending on the range of <code>Y</code>.</p>",
        "id": 517201392,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1746833684
    },
    {
        "content": "<p>I claim that <code>Pretopology</code> need this extra condition</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Presieve</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"bp\">.</span><span class=\"n\">isoClosure</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">isoClosure</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"n\">X</span>\n</code></pre></div>\n<p>where</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Presieve</span><span class=\"bp\">.</span><span class=\"n\">isoClosure</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Presieve</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Presieve</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"bp\">‚âÖ</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"bp\">‚â´</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>",
        "id": 517201453,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1746833741
    },
    {
        "content": "<p>What is the idea behind defining <code>Presieve X</code> as <code>‚àÄ ‚¶ÉY‚¶Ñ, Set (Y ‚ü∂ X)</code> in the first place? To be precise, what goes wrong with:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">HomTo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">source</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span>\n<span class=\"w\">  </span><span class=\"n\">hom</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">source</span><span class=\"w\"> </span><span class=\"bp\">‚ü∂</span><span class=\"w\"> </span><span class=\"n\">X</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Presieve'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">HomTo</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Presieve'</span><span class=\"bp\">.</span><span class=\"n\">ofArrows</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œπ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œπ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">‚ü∂</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Presieve'</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">‚ü©</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 517202639,
        "sender_full_name": "Christian Merten",
        "timestamp": 1746834735
    },
    {
        "content": "<p>First of all I don't think this solves the titular question.<br>\nSecondly, I think you are just un-currying  <code>‚àÄ (Y), (Y ‚ü∂ X) -&gt; Prop</code> and we like to curry things in mathlib.</p>",
        "id": 517202791,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1746834873
    },
    {
        "content": "<p>But <code>AlgebraicGeometry.Scheme.zariskiPretopology</code> doesn't satisfy the definition...<br>\nIt doesn't even satisfy the titular question, because you can have a cover that is (set-theoretically) big but essentially small, and the topology is defined only by the small covers. Do we want to change that and allow big covers as well?</p>",
        "id": 517211040,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1746841176
    },
    {
        "content": "<p>I would say that pretopologies are only a way to construct Grothendieck topologies. There is no similar issue with topologies.</p>",
        "id": 517233029,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1746861358
    },
    {
        "content": "<p>Here's my use case:<br>\nI want to show some functor is a sheaf in <code>Scheme.zariskiTopology.over X</code>, and naturally I tried <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Presieve.isSheaf_pretopology#doc\">docs#CategoryTheory.Presieve.isSheaf_pretopology</a> and I am led to showing something like <code>Scheme.zariskiPretopology.toGrothendieck.over X = (Scheme.zariskiPretopology.over X).toGrothendieck</code> But the <code>over</code> of an pretopology isn't necessarily a pretopology and the RHS makes no sense because of the pullback field and the issue above.</p>",
        "id": 517233598,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1746861723
    },
    {
        "content": "<p>If this can help, we could introduce a typeclass <code>Pretopology.RespectsIso</code>?<br>\nIn any case, we need to introduce lemmas which characterizes the Zariski sheaves on <code>Scheme</code> (and <code>Over X</code>)  by saying that the \"restrictions\" to <code>Opens V</code> for all <code>V</code> are sheaves (and also in terms of the sheaf condition for the families given by <code>OpenCover</code>).</p>",
        "id": 517236689,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1746864193
    },
    {
        "content": "<p>The thing is <code>AlgebraicGeometry.Scheme.zariskiPretopology</code> (as it currently is) doesn't satisfy <code>RespectsIso</code> because of set-theoretic concerns.</p>",
        "id": 517236973,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1746864380
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"439483\">Andrew Yang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Isomorphic.20covers.20in.20pretopology/near/517233598\">said</a>:</p>\n<blockquote>\n<p>Here's my use case:<br>\nI want to show some functor is a sheaf in <code>Scheme.zariskiTopology.over X</code>, and naturally I tried <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Presieve.isSheaf_pretopology#doc\">docs#CategoryTheory.Presieve.isSheaf_pretopology</a> and I am led to showing something like <code>Scheme.zariskiPretopology.toGrothendieck.over X = (Scheme.zariskiPretopology.over X).toGrothendieck</code> But the <code>over</code> of an pretopology isn't necessarily a pretopology and the RHS makes no sense because of the pullback field and the issue above.</p>\n</blockquote>\n<p>Does <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AlgebraicGeometry.Scheme.overGrothendieckTopology_eq_toGrothendieck_overPretopology#doc\">docs#AlgebraicGeometry.Scheme.overGrothendieckTopology_eq_toGrothendieck_overPretopology</a> help?</p>",
        "id": 517237781,
        "sender_full_name": "Christian Merten",
        "timestamp": 1746865013
    },
    {
        "content": "<p>Yes it works. So this issue is not immediate bugging me now. But shouldn't (and do we not need) this over thing to work for all topologies that is not necessarily defined by some morphism property (e.g. fpqc)?</p>",
        "id": 517238353,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1746865425
    },
    {
        "content": "<p>We will (hopefully) need this for the fpqc topology in the coming weeks, yes. But I think if we just take intersections with the pretopology given by <code>QuasiCompact</code> covers (or just assume <code>QuasiCompact</code> in <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AlgebraicGeometry.Scheme.pretopology#doc\">docs#AlgebraicGeometry.Scheme.pretopology</a>) it should still work on the level of Grothendieck topologies?</p>",
        "id": 517238849,
        "sender_full_name": "Christian Merten",
        "timestamp": 1746865817
    },
    {
        "content": "<p>A similar phenomenon with size issues arises here (<a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AlgebraicGeometry.Scheme.grothendieckTopology_eq_inf#doc\">docs#AlgebraicGeometry.Scheme.grothendieckTopology_eq_inf</a>) btw, but it only happens on the level of pretopologies.</p>",
        "id": 517239129,
        "sender_full_name": "Christian Merten",
        "timestamp": 1746866047
    },
    {
        "content": "<blockquote>\n<p>or just assume¬†<code>QuasiCompact</code>¬†in <code>Scheme.pretopology</code></p>\n</blockquote>\n<p>This approach still screams to me that this is not in the right generality and we are making our lives more painful.</p>",
        "id": 517239184,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1746866125
    },
    {
        "content": "<p>Maybe <span class=\"user-mention\" data-user-id=\"459699\">@Jo√´l Riou</span> knows of a natural example of a topology on schemes where coverings are not assumed to be \"quasicompact\"? (by \"quasicompact\" I mean, they satisfy the finiteness conditions in the definition of fpqc).</p>",
        "id": 517239401,
        "sender_full_name": "Christian Merten",
        "timestamp": 1746866291
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"439483\">Andrew Yang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Isomorphic.20covers.20in.20pretopology/near/517239184\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>or just assume¬†<code>QuasiCompact</code>¬†in <code>Scheme.pretopology</code></p>\n</blockquote>\n<p>This approach still screams to me that this is not in the right generality and we are making our lives more painful.</p>\n</blockquote>\n<p>But are you fine with taking intersections then?</p>",
        "id": 517239444,
        "sender_full_name": "Christian Merten",
        "timestamp": 1746866344
    },
    {
        "content": "<blockquote>\n<p>or just assume¬†<code>QuasiCompact</code>¬†in <code>Scheme.pretopology</code></p>\n</blockquote>\n<p>Okay maybe this is fine because it is defining a pretopology anyway. I should be saying that every thing that works with an arbitrary pretopology should work for an arbitrary pretopology. Or else we need to massage our pretopology into the right form before we can apply anything.</p>",
        "id": 517239704,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1746866580
    },
    {
        "content": "<p>(e.g. <code>eq_toGrothendieck_overPretopology</code> or even <code>Scheme.Cover</code>)</p>",
        "id": 517239737,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1746866624
    },
    {
        "content": "<p>But is there a general <code>CategoryTheory.Pretopology.over</code> with good definitional properties?</p>",
        "id": 517240094,
        "sender_full_name": "Christian Merten",
        "timestamp": 1746866944
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Presieve</span><span class=\"bp\">.</span><span class=\"n\">overForget</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Over</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Presieve</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Presieve</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">      </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Over</span><span class=\"bp\">.</span><span class=\"n\">homMk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Over</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚â´</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">}</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Pretopology</span><span class=\"bp\">.</span><span class=\"n\">over</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Pretopology</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">J</span><span class=\"bp\">.</span><span class=\"n\">IsNice</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Pretopology</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Over</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coverings</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">overForget</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>\n<p>This works (under a better definition of <code>pullbacks</code> that <code>Scheme.pretopology</code> does not yet satisfy)</p>",
        "id": 517240194,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1746867032
    },
    {
        "content": "<p>Yes, at some point, if we absolutely need it, we may improve the <code>pullbacks</code> condition so as to allow any pullback instead of the arbitrarily chosen pullback of the limits API.</p>",
        "id": 517240804,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1746867541
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"439483\">Andrew Yang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Isomorphic.20covers.20in.20pretopology/near/517240194\">said</a>:</p>\n<blockquote>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Presieve</span><span class=\"bp\">.</span><span class=\"n\">overForget</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Over</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Presieve</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Presieve</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">      </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Over</span><span class=\"bp\">.</span><span class=\"n\">homMk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Over</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚â´</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">}</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Pretopology</span><span class=\"bp\">.</span><span class=\"n\">over</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Pretopology</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">J</span><span class=\"bp\">.</span><span class=\"n\">IsNice</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Pretopology</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Over</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coverings</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">overForget</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>\n<p>This works (under a better definition of <code>pullbacks</code> that <code>Scheme.pretopology</code> does not yet satisfy)</p>\n</blockquote>\n<p>Does this give the same pretopology as <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AlgebraicGeometry.Scheme.overPretopology#doc\">docs#AlgebraicGeometry.Scheme.overPretopology</a> though? Doesn't your definition mean that the component maps in the covering won't necessarily be over <code>X</code>?</p>",
        "id": 517240852,
        "sender_full_name": "Christian Merten",
        "timestamp": 1746867592
    },
    {
        "content": "<p>The <code>X</code>-structure on <code>U</code> is by definition <code>U.map i &gt;&gt; Y.hom</code> here so <code>U.map i</code> commutes with them by <code>rfl</code>.</p>",
        "id": 517241077,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1746867727
    },
    {
        "content": "<p>Ah yes, you are right.</p>",
        "id": 517241614,
        "sender_full_name": "Christian Merten",
        "timestamp": 1746868150
    }
]