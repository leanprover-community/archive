[
    {
        "content": "<p>Hey! So I can't figure out how to create a vector in Mathlib, is it just this?</p>\n<blockquote>\n<p>![1, 2,3] </p>\n<div class=\"codehilite\" data-code-language=\"what\"><pre><span></span><code>```quote\nstructure test (n: ℕ) where\nx: Vector Float n\n\ndef test1: test (2) := {x:= ![1.2,2.3]\n</code></pre></div>\n<p>but then i get the error saying <code>type mismatch\n  ![1.2, 2.3]\nhas type\n  Fin (Nat.succ 0).succ → ?m.1099 : Type ?u.1098\nbut is expected to have type\n  Mathlib.Vector Float 2 : Type</code></p>\n<p>im so confused, the documentation is so unclear about data structures, if i work with lists above and change it to say x: List Float and make everything dynamic then it all works, but then I dont know how to compute the dot product between two lists , cause Matrix.dotProduct takes in two vectors, and so I tried converting the list into a vector but it got some error as well.</p>\n<p>so just a general question, is it better to use lists or vectors? if so lists are better how does one compute the dot product between the lists or convert lists into vectors so i can use the vector operations directly in lean? also why doesn't this work, </p>\n<blockquote>\n<p>def x1 := [1, 2]</p>\n<p>def x2 := [3, 4]</p>\n<p>def x3 := ∑ i in [0, 1], x1[i] * x2[i]```</p>\n<p>this gives me <code>application type mismatch\n  Finset.sum [0, 1]\nargument\n  [0, 1]\nhas type\n  List ?m.445 : Type ?u.364\nbut is expected to have type\n  Finset ?m.365 : Type ?u.364</code></p>\n<p>im so confused, i would assume straightforward computations like this would be relatively easy in Lean. Sorry for too many questions, its just hard to get even basic lists or vectors working without so many issues: ( i wish the documentation or textbook had more info on just data structures and how to use them</p>\n</blockquote>\n</blockquote>",
        "id": 484393189,
        "sender_full_name": "Robert",
        "timestamp": 1732570396
    },
    {
        "content": "<p>Could you provide a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a>? The formatting in your comment is messed up which makes it hard to understand what you're asking.</p>",
        "id": 484406392,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1732576654
    },
    {
        "content": "<p>I would recommend reading through this page if you haven't already: <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Data/Fin/VecNotation.html\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Data/Fin/VecNotation.html</a></p>",
        "id": 484407103,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1732577075
    },
    {
        "content": "<p>I think part of your confusion is coming from the assumption that vector math is done with the <code>Mathlib.Vector</code> type... that's not the right type in this context</p>",
        "id": 484407390,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1732577244
    },
    {
        "content": "<p>they're represented by functions from indices to values</p>",
        "id": 484407777,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1732577480
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Matrix</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">⬝ᵥ</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"mi\">4</span><span class=\"o\">,</span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"mi\">6</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 484407935,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1732577574
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"380294\">Matt Diamond</span><br>\nsure here is a mwe</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"n\">x</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">Float</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">test1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"mf\">1.2</span><span class=\"o\">,</span><span class=\"mf\">2.3</span><span class=\"o\">]}</span>\n</code></pre></div>\n<p>but then i get the error saying type mismatch<br>\n  ![1.2, 2.3]<br>\nhas type<br>\n  Fin (Nat.succ 0).succ → ?m.1099 : Type ?u.1098<br>\nbut is expected to have type<br>\n  Mathlib.Vector Float 2 : Type</p>\n<p>so not sure how to even create a new vector and also is there a way to convert a list into a vector cause its easier to work with lists, but then i don't know how to properly compute the dot product. I did this and it worked but is it the best way</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">product_list</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Float</span><span class=\"o\">):=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">zipWith</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">foldl</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"bp\">```</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">worked</span><span class=\"w\"> </span><span class=\"n\">well</span><span class=\"bp\">.</span>\n</code></pre></div>",
        "id": 484407988,
        "sender_full_name": "Robert",
        "timestamp": 1732577614
    },
    {
        "content": "<p>Don't use <code>Mathlib.Vector</code>, that's not the right type</p>",
        "id": 484408128,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1732577656
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Float</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">test1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"mf\">1.2</span><span class=\"o\">,</span><span class=\"mf\">2.3</span><span class=\"o\">]}</span>\n</code></pre></div>",
        "id": 484408302,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1732577738
    },
    {
        "content": "<p>If you look at my earlier example above, I showed how you could compute the dot product using the <code>⬝ᵥ</code> operator</p>",
        "id": 484408444,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1732577818
    },
    {
        "content": "<p>Oh thanks Matt, I see now,! Also for computations i would assume its more efficient to use vectors compared to lists? also i see that you can convert a vector into a list but i assume the other way is not possible as vectors are fixed size and lists are dynamic correct? cause if i could convert a list into a vector for efficiency that would be great cause then i can do the dot product etc and use other operations with vectors.</p>",
        "id": 484408653,
        "sender_full_name": "Robert",
        "timestamp": 1732577923
    },
    {
        "content": "<p>In theory you could convert a single-dimensional array to a vector using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.get#doc\">docs#List.get</a>, but why do you find it easier to work with lists?</p>",
        "id": 484408785,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1732578002
    },
    {
        "content": "<p>There are functions that allow you to manipulate vectors in much the same way that you would manipulate lists</p>",
        "id": 484409103,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1732578170
    },
    {
        "content": "<p>Note that there are two different versions of <code>Vector</code>: <code>Mathlib.Vector</code>, which is based on <code>List</code>, and <code>Batteries.Vector</code> (soon to be just <code>Vector</code>) which is based on <code>Array</code>.</p>\n<p>If you're actually doing computations you should surely be using the Array backed version.</p>",
        "id": 484409226,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732578242
    },
    {
        "content": "<p>I'd suggest we actually rename <code>Mathlib.Vector</code> to <code>Mathlib.ListWithLength</code>, but I'm not putting my hand up. :-)</p>",
        "id": 484409345,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732578298
    },
    {
        "content": "<p>Oh thanks Matt! Oh it just was easier to follow and create/do operations with list compared to the vectors (im still learning and found lists to be easier to work with), plus i wasnt sure how to use vectors properly. but i will try to move to using vectors.</p>",
        "id": 484409455,
        "sender_full_name": "Robert",
        "timestamp": 1732578362
    },
    {
        "content": "<p>oh <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> why is that i should use the array backed version? is the syntax the same as what Matt wrote before ie Fin n -&gt; Float? or is it different</p>",
        "id": 484409569,
        "sender_full_name": "Robert",
        "timestamp": 1732578423
    },
    {
        "content": "<p>also is there documentation like a paper or some guide for it? I came across batteries and it seems to be mainly focussed on data structures, is that correct?</p>",
        "id": 484409704,
        "sender_full_name": "Robert",
        "timestamp": 1732578495
    },
    {
        "content": "<p>Thanks for all your help!</p>",
        "id": 484409719,
        "sender_full_name": "Robert",
        "timestamp": 1732578509
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Lists.20and.20vector.20basics/near/484409226\">said</a>:</p>\n<blockquote>\n<p>If you're actually doing computations you should surely be using the Array backed version.</p>\n</blockquote>\n<p>In theory you can use this at the same time as the abstract version Matt describes, as</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">myDotProduct</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">Rat</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Rat</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Matrix</span><span class=\"bp\">.</span><span class=\"n\">dotProduct</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">get</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">get</span><span class=\"w\">  </span><span class=\"c1\">-- this works on the `Fin _ → _`-style vectors</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">myDotProduct</span><span class=\"w\"> </span><span class=\"bp\">⟨#</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">⟨#</span><span class=\"o\">[</span><span class=\"mi\">4</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span>\n</code></pre></div>",
        "id": 484412315,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1732579947
    },
    {
        "content": "<p>(unfortunately this doesn't work on <code>Float</code> because addition is not associative, and so the order that you do the summation matters!)</p>",
        "id": 484412387,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1732580004
    },
    {
        "content": "<p>I see that makes sense! Thanks, ill just stick to lists for now then, unless I need to change to vectors</p>",
        "id": 484420498,
        "sender_full_name": "Robert",
        "timestamp": 1732585846
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"782569\">Robert</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Lists.20and.20vector.20basics/near/484409569\">said</a>:</p>\n<blockquote>\n<p>oh <span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> why is that i should use the array backed version? is the syntax the same as what Matt wrote before ie Fin n -&gt; Float? or is it different</p>\n</blockquote>\n<p>If you're doing proofs, then <code>Fin n → X</code> is surely going to be best. If you're programming, then <code>Vector</code> will be best. If you're doing both, then you'll need to convert!</p>",
        "id": 484420639,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732585975
    }
]