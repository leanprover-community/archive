[
    {
        "content": "<p>There has been several discussions about the relations between <code>WithLp</code> and measure theory, for instance <a href=\"#narrow/channel/287929-mathlib4/topic/Diamond.20with.20.60EuclideanSpace.60.20.28.60PiLp.60.29\">#mathlib4 &gt; Diamond with &#96;EuclideanSpace&#96; (&#96;PiLp&#96;)</a> and <a href=\"#narrow/channel/287929-mathlib4/topic/Lacking.20theorems.20involving.20.60Measure.60.2C.20.60Prod.60.20and.20.60WithLp.60\">#mathlib4 &gt; Lacking theorems involving &#96;Measure&#96;, &#96;Prod&#96; and &#96;WithLp&#96;</a>. We are stumbling upon the same thing in the Brownian motion project. There isn't even a measurable space structure on <code>WithLp</code>. In <a href=\"https://github.com/leanprover-community/mathlib4/pull/26249\">#26249</a> I simply propose:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Normed</span><span class=\"bp\">.</span><span class=\"n\">Lp</span><span class=\"bp\">.</span><span class=\"n\">WithLp</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">MeasurableSpace</span><span class=\"bp\">.</span><span class=\"n\">Embedding</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">ENNReal</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"bp\">∞</span><span class=\"o\">}</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">WithLp</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">measurableSpace</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">WithLp</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">MeasurableSpace</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">WithLp</span><span class=\"bp\">.</span><span class=\"n\">equiv</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">WithLp</span>\n</code></pre></div>\n<p>Is this too general? I'm guessing that if this has not been done before it's because there are some cases where you want something different (e.g. for <code>p &lt; 1</code>). My question is: are there some cases where we are certain that this is the instance we want, and we can declare it as global, or should instances for <code>WithLp</code> always be local?</p>",
        "id": 525154341,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1750506724
    },
    {
        "content": "<p>(Not sure if it's related but I am aware of the current refactor of <code>WithLp</code>, and I'm happy to wait until it's done and then modify things accordingly.)</p>",
        "id": 525154384,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1750506787
    },
    {
        "content": "<p>I have the same question for the topology actually. There is <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Normed/Lp/ProdLp.html#WithLp.instProdTopologicalSpace\">WithLp.instProdTopologicalSpace</a>. Should that also be defined for <code>PiLp</code>? For any <code>WithLp</code>?</p>",
        "id": 525173892,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1750531691
    },
    {
        "content": "<p>Based on the topological instances for <code>PiLp</code> I deduce that the basic one is just missing. <a href=\"https://github.com/leanprover-community/mathlib4/pull/26261\">#26261</a></p>",
        "id": 525177884,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1750538568
    }
]