[
    {
        "content": "<p>while trying to prove that elementary topoi have finite colimits, i've run into the following defeq-diamond issue:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Monoidal</span><span class=\"bp\">.</span><span class=\"n\">OfHasFiniteProducts</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Monoidal</span><span class=\"bp\">.</span><span class=\"n\">Cartesian</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">u</span>\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Limits</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasFiniteLimits</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">monoidalOfHasFiniteProducts</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">CartesianMonoidalCategory</span><span class=\"bp\">.</span><span class=\"n\">ofHasFiniteProducts</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">toMonoidalCategory</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">try</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"c1\">-- fails</span>\n<span class=\"w\">  </span><span class=\"n\">dsimp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">monoidalOfHasFiniteProducts</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">CartesianMonoidalCategory</span><span class=\"bp\">.</span><span class=\"n\">ofHasFiniteProducts</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">CartesianMonoidalCategory</span><span class=\"bp\">.</span><span class=\"n\">ofChosenFiniteProducts</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">congr</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">congr!</span><span class=\"w\"> </span><span class=\"mi\">6</span>\n<span class=\"w\">    </span><span class=\"n\">rename_i</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÉ</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÑ</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">all_goals</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span>\n</code></pre></div>\n<p>it appears the issue is that <code>prod.map f g = CartesianMonoidalCategory.ofChosenFiniteProducts.tensorHom (fun x1 x2 ‚Ü¶ getLimitCone (pair x1 x2)) f g</code> is not <code>rfl</code>...</p>",
        "id": 545835198,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760885686
    },
    {
        "content": "<p>with this much choice I'm not really surprised</p>",
        "id": 545835415,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760885853
    },
    {
        "content": "<p>it's not that terribly different though, this should just be defeq? they assume the same <code>Nonempty</code> structures</p>",
        "id": 545835470,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760885891
    },
    {
        "content": "<p>down the line the difference is exactly where you match on <code>Discrete WalkingPair</code> (i.e. how you create the relevant cone)</p>",
        "id": 545835507,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760885921
    },
    {
        "content": "<p>after unfolding everything and applying <code>congr</code> I get</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Monoidal</span><span class=\"bp\">.</span><span class=\"n\">OfHasFiniteProducts</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Monoidal</span><span class=\"bp\">.</span><span class=\"n\">Cartesian</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">u</span>\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Limits</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasFiniteLimits</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"bp\">._</span><span class=\"n\">example</span><span class=\"bp\">.</span><span class=\"n\">extracted_1</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inst</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inst_1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasFiniteLimits</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">X‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÉ</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÑ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÅ</span><span class=\"w\"> </span><span class=\"bp\">‚ü∂</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÉ</span><span class=\"w\"> </span><span class=\"bp\">‚ü∂</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÑ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">getLimitCone</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">pair</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÉ</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">cone</span><span class=\"bp\">.</span><span class=\"n\">œÄ</span><span class=\"bp\">.</span><span class=\"n\">app</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">‚â´</span>\n<span class=\"w\">      </span><span class=\"n\">WalkingPair</span><span class=\"bp\">.</span><span class=\"n\">rec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">          </span><span class=\"o\">(</span><span class=\"n\">pair</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÉ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Discrete</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚ü∂</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">pair</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÑ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Discrete</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">))</span>\n<span class=\"w\">        </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"bp\">.</span><span class=\"n\">as</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">WalkingPair</span><span class=\"bp\">.</span><span class=\"n\">rec</span>\n<span class=\"w\">        </span><span class=\"o\">((</span><span class=\"n\">getLimitCone</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">pair</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÉ</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">cone</span><span class=\"bp\">.</span><span class=\"n\">œÄ</span><span class=\"bp\">.</span><span class=\"n\">app</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Discrete</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">WalkingPair</span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚â´</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span>\n<span class=\"w\">        </span><span class=\"o\">((</span><span class=\"n\">getLimitCone</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">pair</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">X‚ÇÉ</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">cone</span><span class=\"bp\">.</span><span class=\"n\">œÄ</span><span class=\"bp\">.</span><span class=\"n\">app</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Discrete</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">WalkingPair</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚â´</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">as</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">try</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"c1\">-- fails</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span>\n</code></pre></div>",
        "id": 545836397,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760886602
    },
    {
        "content": "<p>exactly</p>",
        "id": 545836474,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760886659
    },
    {
        "content": "<p>I guess it's not the choice's fault</p>",
        "id": 545836553,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760886715
    },
    {
        "content": "<p>I think <code>monoidalOfHasFiniteProducts</code> is not meant to be used. See the todo in the file containing that construction. cc <span class=\"user-mention\" data-user-id=\"387244\">@Ya√´l Dillies</span></p>",
        "id": 545836782,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1760886950
    },
    {
        "content": "<p>sure, but then what should i do now? because that means that right now, we don't have that the monoidal category structure of <code>CartesianMonoidalCategory.ofHasFiniteLimits</code> is symmetric? and i <em>think</em> it still would be nice to have these things be defeq?</p>",
        "id": 545836928,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760887092
    },
    {
        "content": "<p>Every cartesian-monoidal category structure is symmetric. All you need to do is to show it's braided (which is data, so that shouldn't be inferred automatically)</p>",
        "id": 545837001,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760887152
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> \"braided\", \"cartesian\"</p>",
        "id": 545837136,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760887274
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Monoidal/Cartesian/Basic.html#CategoryTheory.BraidedCategory.ofCartesianMonoidalCategory\">CategoryTheory.BraidedCategory.ofCartesianMonoidalCategory</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Monoidal/Cartesian/Basic.html#CategoryTheory.CartesianMonoidalCategory.instNonemptyBraidedCategory\">CategoryTheory.CartesianMonoidalCategory.instNonemptyBraidedCategory</a>, and <a href=\"https://loogle.lean-lang.org/?q=%22braided%22%2C%20%22cartesian%22\">1 more</a></p>",
        "id": 545837138,
        "sender_full_name": "loogle",
        "timestamp": 1760887275
    },
    {
        "content": "<p>well it's nonempty and subsingleton</p>",
        "id": 545837153,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760887288
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> \"symmetric\", \"cartesian\"</p>",
        "id": 545837171,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760887307
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Monoidal/Cartesian/Basic.html#CategoryTheory.CartesianMonoidalCategory.instSubsingletonSymmetricCategory\">CategoryTheory.CartesianMonoidalCategory.instSubsingletonSymmetricCategory</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Monoidal/Cartesian/Basic.html#CategoryTheory.CartesianMonoidalCategory.toSymmetricCategory\">CategoryTheory.CartesianMonoidalCategory.toSymmetricCategory</a></p>",
        "id": 545837172,
        "sender_full_name": "loogle",
        "timestamp": 1760887308
    },
    {
        "content": "<p>oh there's an instance inferring symmetric from braided called <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.CartesianMonoidalCategory.toSymmetricCategory#doc\">docs#CategoryTheory.CartesianMonoidalCategory.toSymmetricCategory</a></p>",
        "id": 545837202,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760887334
    },
    {
        "content": "<p>Indeed, this is what I was referring to by \"All you need to do is to show it's braided\"</p>",
        "id": 545837229,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760887361
    },
    {
        "content": "<p>ok. So then the question becomes: is it sensible to (for now) change the defeq of the CartesianMonoidalCategory instance to lign up with the generic one?</p>",
        "id": 545837271,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760887400
    },
    {
        "content": "<p>Which <code>CartesianMonoidalCategory</code> instance and what's the \"generic one\"?</p>",
        "id": 545837307,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760887432
    },
    {
        "content": "<p>the ones mentioned in my first MWE?</p>",
        "id": 545837321,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760887449
    },
    {
        "content": "<p>Which is which?</p>",
        "id": 545837331,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760887457
    },
    {
        "content": "<p>by generic, i meant the instance for just <code>MonoidalCategory</code>, i.e. <code>monoidalOfHasFiniteProducts</code></p>",
        "id": 545837374,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760887503
    },
    {
        "content": "<p>You know what, it's easier to bust <code>monoidalOfHasFiniteProducts</code> than to have this discussion. Give me 10min <span aria-label=\"runner\" class=\"emoji emoji-1f3c3\" role=\"img\" title=\"runner\">:runner:</span></p>",
        "id": 545837380,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760887506
    },
    {
        "content": "<p>Yes, this is a TODO <a href=\"https://github.com/leanprover-community/mathlib4/blob/5c98c223ad372ac3992aa23bd2a4a67cd6a9b13f/Mathlib/CategoryTheory/Monoidal/OfHasFiniteProducts.lean#L24-L25\">https://github.com/leanprover-community/mathlib4/blob/5c98c223ad372ac3992aa23bd2a4a67cd6a9b13f/Mathlib/CategoryTheory/Monoidal/OfHasFiniteProducts.lean#L24-L25</a></p>",
        "id": 545838435,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1760888497
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/30684\">#30684</a></p>",
        "id": 545839532,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760889604
    },
    {
        "content": "<p>great, so you just worsen mathlib without replacement. excellent idea</p>",
        "id": 545839707,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760889753
    },
    {
        "content": "<p>What do you mean? I have just spent 30min of my life documenting the replacements to declarations that are now completely unused in mathlib!</p>",
        "id": 545839820,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760889852
    },
    {
        "content": "<p>Maybe the question I should have started with: How did you end up with <code>monoidalOfHasFiniteProducts</code> in your goal?</p>",
        "id": 545839916,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760889936
    },
    {
        "content": "<p><code>symmetricOfHasFiniteProducts</code> uses it for the <code>MonoidalCategoryStruct</code>, iirc</p>",
        "id": 545839962,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760889977
    },
    {
        "content": "<p>How did you end up with <code>symmetricOfHasFiniteProducts</code> in your goal?</p>",
        "id": 545839994,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760889995
    },
    {
        "content": "<p>elementary topoi (cartesian closed categories with finite limits and subobject classifier) are finitely cocomplete because the (contravariant) functor mapping an object <code>X</code> to the object <code>(exp X).obj Œ©</code> is monadic. showing this requires us to construct a map <code>X -&gt; (exp ((exp X).obj Œ©)).obj Œ©</code>, which is precisely induced by evaluating after braiding</p>",
        "id": 545840177,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760890201
    },
    {
        "content": "<p>i.e. <a href=\"https://q.uiver.app/#q=WzAsNixbMCwwLCJYIl0sWzAsMSwiXFxPbWVnYV57XFxPbWVnYV5YfSJdLFsxLDAsIlhcXHRpbWVzIFxcT21lZ2FeWCJdLFsxLDEsIlxcT21lZ2Fee1xcT21lZ2FeWH1cXHRpbWVzIFxcT21lZ2FeWCJdLFsyLDEsIlxcT21lZ2EiXSxbMiwwLCJcXE9tZWdhXlhcXHRpbWVzIFgiXSxbMyw0LCJldiJdLFswLDEsIj8iXSxbMiwzLCI/XFx0aW1lcyBpZF97XFxPbWVnYV5YfSJdLFsyLDUsImJyYWlkIiwyXSxbNSw0LCJldiIsMl1d\">this diagram</a></p>",
        "id": 545840319,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760890379
    },
    {
        "content": "<p>Do not use <code>monoidalOfHasFiniteProducts</code>. Add a <code>CartesianMonoidalCategory</code> assumption instead.</p>",
        "id": 545841531,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1760891782
    },
    {
        "content": "<p>are you saying i shouldn't be working with <code>HasFiniteLimits</code> then?</p>",
        "id": 545841602,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760891872
    },
    {
        "content": "<p>Can you please unxy yourself by providing a mwe or at least some pointer to some existing code?</p>",
        "id": 545841663,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1760891947
    },
    {
        "content": "<p>The intended way to equip a concrete category with <code>HasFiniteLimits</code> with a symmetric monoidal category structure is </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"w\"> </span><span class=\"n\">Limits</span>\n\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">u</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">section</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">MyCat</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">MyCat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasFiniteLimits</span><span class=\"w\"> </span><span class=\"n\">MyCat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CartesianMonoidalCategory</span><span class=\"w\"> </span><span class=\"n\">MyCat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofHasFiniteProducts</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BraidedCategory</span><span class=\"w\"> </span><span class=\"n\">MyCat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofCartesianMonoidalCategory</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SymmetricCategory</span><span class=\"w\"> </span><span class=\"n\">MyCat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span>\n</code></pre></div>\n<p>The intended way to assume you have an arbitrary symmetric monoidal cartesian category is via</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"w\"> </span><span class=\"n\">Limits</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CartesianMonoidalCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">BraidedCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 545841953,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1760892284
    },
    {
        "content": "<p>right, and what is the intended way to assume a category is an elementary topos?</p>",
        "id": 545841995,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760892321
    },
    {
        "content": "<p>personally i was feeling <code>(ùíû : Classifier C) [HasFiniteLimits C] [CartesianClosed C]</code></p>",
        "id": 545842052,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760892374
    },
    {
        "content": "<p>(find my project <a href=\"https://github.com/edegeltje/CwFTT/tree/main/CwFTT/Classifier\">here</a>)</p>",
        "id": 545842168,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760892508
    },
    {
        "content": "<p>the finitely cocomplete is necessary to prove that there is a heytingalgebra structure on morphisms into a subobject classifier from a specific object</p>",
        "id": 545842225,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760892559
    },
    {
        "content": "<p>I think <code>(ùíû : Classifier C) [HasFiniteLimits C] [CartesianMonoidalCategory C] [CartesianClosed C]</code></p>",
        "id": 545842301,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1760892659
    },
    {
        "content": "<p>that looks very weird to me, tbh. you're doubling your finite products for whatever reason</p>",
        "id": 545842348,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760892712
    },
    {
        "content": "<p>Doesn't <code>CartesianMonoidalCategory</code> imply <code>HasFiniteLimits</code>?</p>",
        "id": 545842410,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760892779
    },
    {
        "content": "<p>But the point is <code>CartesianMonoidalCategory</code> contains a choice of defeqs for the product. I mean you can also do <code>HasEqualizers C</code> instead of <code>HasFiniteLimits C</code> but I don't see the point.</p>",
        "id": 545842426,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1760892795
    },
    {
        "content": "<p>Andrew, are you saying it doesn't mathematically imply it, or that we are missing the instance in mathlib?</p>",
        "id": 545842484,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760892840
    },
    {
        "content": "<p>i think the first</p>",
        "id": 545842502,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760892850
    },
    {
        "content": "<p>CartesianMonoidalCategory only implies has finite products</p>",
        "id": 545842513,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1760892862
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"439483\">Andrew Yang</span> <a href=\"#narrow/channel/287929-mathlib4/topic/defeq.20diamond.20with.20MonoidalCategory.20ofFiniteLimits/near/545842426\">said</a>:</p>\n<blockquote>\n<p>But the point is <code>CartesianMonoidalCategory</code> contains a choice of defeqs for the product. I mean you can also do <code>HasEqualizers C</code> instead of <code>HasFiniteLimits C</code> but I don't see the point.</p>\n</blockquote>\n<p>If both <code>CartesianClosed</code> and <code>Classifier</code> were prop valued I can see an argument that we would prefer the prop valued <code>HasFiniteLimits</code> too but I think if we are fixing the choice of internal homs and classifiers then fixing the product is also reasonable.</p>",
        "id": 545842705,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1760893011
    },
    {
        "content": "<p>(classifier contains data)</p>",
        "id": 545842723,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760893026
    },
    {
        "content": "<p>So is <code>CartesianClosed</code>. That's precisely my point.</p>",
        "id": 545842758,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1760893041
    },
    {
        "content": "<p>so then i guess we need a way to fix all finite limits?</p>",
        "id": 545842778,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760893056
    },
    {
        "content": "<p>(if that's a thing you can do)</p>",
        "id": 545842801,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1760893083
    },
    {
        "content": "<p>I think <code>[HasFiniteLimits C] [CartesianMonoidalCategory C]</code> is fine for now?</p>",
        "id": 545842832,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1760893109
    },
    {
        "content": "<p>Ah yes sorry, I clearly can't read</p>",
        "id": 545850003,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1760900227
    }
]