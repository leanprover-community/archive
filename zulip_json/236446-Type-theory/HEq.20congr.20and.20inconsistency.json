[
    {
        "content": "<p>Maybe a bit of a naive question because I don't grasp the foundations so well (as a follow-up to <a href=\"#narrow/channel/287929-mathlib4/topic/HEq.20congr/near/476274468\">https://leanprover.zulipchat.com/#narrow/channel/287929-mathlib4/topic/HEq.20congr/near/476274468</a> too): does the existence of non-standard models where heterogeneous congruence is a non-theorem mean that adding it as an axiom is inconsistent?</p>\n<p>In other words, if I add congruence of <code>HEq</code> as an <code>axiom</code> (something like)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">axiom</span><span class=\"w\"> </span><span class=\"n\">heq_congr</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α₂</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β₂</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HEq</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HEq</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HEq</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Can I use that to prove <code>False</code>? Or do I just get a type theory that doesn't have as many models?</p>",
        "id": 484476868,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1732615991
    },
    {
        "content": "<p>As long as there is some model in which it is true, it is safe to add as an axiom, and you just get a type theory that has fewer models.</p>",
        "id": 484482854,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1732617856
    },
    {
        "content": "<p>Is there a model where <code>HEq a b &lt;-&gt; a = b</code>?</p>",
        "id": 484504906,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1732625094
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/236446-Type-theory/topic/HEq.20congr.20and.20inconsistency/near/484504906\">said</a>:</p>\n<blockquote>\n<p>Is there a model where <code>HEq a b &lt;-&gt; a = b</code>?</p>\n</blockquote>\n<p>There is at least a model of dependent type theory, namely Extensional Type Theory featuring equality reflection that collapses propositional equality with conversion (a.k.a. definitional equality).</p>",
        "id": 484506395,
        "sender_full_name": "Kyod",
        "timestamp": 1732625564
    },
    {
        "content": "<p>I guess my question was specifically about Lean's type theory, motivated by the fact that if Andres could add that as an axiom instead whilst maintaining consistency, his life might be even easier!</p>",
        "id": 484508826,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1732626223
    },
    {
        "content": "<p>There seems to be an issue that this axiom isn't well-typed, unless somehow the underlying rule is \"if <code>h : a = b</code> then <code>a</code> is defeq to <code>b</code> (and <code>h</code> is defeq to <code>rfl</code>)\"</p>",
        "id": 484574136,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1732646150
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/236446-Type-theory/topic/HEq.20congr.20and.20inconsistency/near/484504906\">said</a>:</p>\n<blockquote>\n<p>Is there a model where <code>HEq a b &lt;-&gt; a = b</code>?</p>\n</blockquote>\n<p>This is provable in lean :)</p>",
        "id": 484599109,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1732656376
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HEq</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n</code></pre></div>",
        "id": 484599247,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1732656450
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/236446-Type-theory/topic/HEq.20congr.20and.20inconsistency/near/484574136\">said</a>:</p>\n<blockquote>\n<p>There seems to be an issue that this axiom isn't well-typed, unless somehow the underlying rule is \"if <code>h : a = b</code> then <code>a</code> is defeq to <code>b</code> (and <code>h</code> is defeq to <code>rfl</code>)\"</p>\n</blockquote>\n<p>not sure I quite understand, what is not well-typed precisely? (at least Lean doesn't complain it's not well-typed)</p>",
        "id": 484599768,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1732656684
    },
    {
        "content": "<p>Make sure to look at the type's of <code>a</code> and <code>b</code> here — it's better not to rely on autoimplicits if you want to be sure everything is what you think it is.</p>",
        "id": 484603230,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1732658315
    },
    {
        "content": "<p>I still don't get what you mean. I am not relying on autoimplicit (in fact, turning it off doesn't break things),  the types of <code>a</code> and <code>b</code> are explicit there. I'm only relying on <code>{α₁}</code> being elaborated to something like <code>{α₁ : Sort u}</code></p>",
        "id": 484603618,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1732658478
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">autoImplicit</span><span class=\"w\"> </span><span class=\"n\">false</span>\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span>\n<span class=\"kn\">axiom</span><span class=\"w\"> </span><span class=\"n\">heq_congr</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α₂</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β₁</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HEq</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HEq</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HEq</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Lean doesn't complain here either (also not if I remove the <code>Sort u</code> annotations)</p>",
        "id": 484603882,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1732658599
    },
    {
        "content": "<p>all that being said, I just wrote down the first sensible version that Lean didn't complain about, it's not about this precise term (and that's why I wrote \"something like this\"). I'm asking the more general question, can something like congruence of <code>HEq</code> be added as an axiom, and would that make things inconsistent or just rule out some non-standard models (that I don't know if I care about)</p>",
        "id": 484604122,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1732658727
    },
    {
        "content": "<p>(but I'd be curious to undersand why it's not well-typed!)</p>",
        "id": 484604157,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1732658747
    },
    {
        "content": "<p>That's not <code>HEq a b ↔ a = b</code> though, I'm confused? I'm responding to Kevin's question.</p>",
        "id": 484604506,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1732658895
    },
    {
        "content": "<p>oh, gotcha, that's the confusion! I thought you meant my question before that!</p>",
        "id": 484604580,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1732658933
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/channel/236446-Type-theory/topic/HEq.20congr.20and.20inconsistency/near/484599247\">said</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HEq</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>What happens in the example? What are the types?</p>",
        "id": 488582877,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1733994438
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"417654\">Martin Dvořák</span> <a href=\"#narrow/stream/236446-Type-theory/topic/HEq.20congr.20and.20inconsistency/near/488582877\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/channel/236446-Type-theory/topic/HEq.20congr.20and.20inconsistency/near/484599247\">said</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HEq</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>What happens in the example? What are the types?</p>\n</blockquote>\n<p>I think the point here is that for the term <code>a = b</code> to even be well-typed, <code>a</code> and <code>b</code> must have the same (definitionally equal) type. If <code>a</code> and <code>b</code> didn't have the same type, you couldn't even state this theorem. And then <code>simp</code> presumably uses <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=eq_of_heq#doc\">docs#eq_of_heq</a>.</p>",
        "id": 488588373,
        "sender_full_name": "Marcus Rossel",
        "timestamp": 1733996063
    }
]