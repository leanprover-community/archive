[
    {
        "content": "<p>The major problem of Lean foundations is that it uses several axioms, namely propext, funext, quot.sound and choice.</p>\n<p>However, propext, funext and quot.sound are trivially provable in cubical type theory, so as a thought experiment we could imagine replacing the foundation of Lean with it.</p>\n<p>Proving the axioms would require to replace Lean's equality with path equality; the issue is that Lean has UIP, but it seems this is easily solved by adding an isSet typeclass instance hypothesis for all type parameters that requires the type to be an HoTT Set, i.e. the types for which UIP holds. AFAIK unless non-Set HITs are defined, all types that can be formed are Sets, and quotients are Set HITs by definition (the squash constructor in <a href=\"https://agda.github.io/cubical/Cubical.HITs.SetQuotients.Base.html\">https://agda.github.io/cubical/Cubical.HITs.SetQuotients.Base.html</a>), and it should thus be possible to automatically generate the isSet proofs. It also may be possible to use a two-level type theory which directly provides a sort of Sets.</p>\n<p>As for the axiom of choice, changing the sort doesn't work because \"sets with choice\" are not closed under formation of function types; however, it seems that it should still be possible to define a typeclass for sets with choice and automatically relativize all Lean statements using choice to it, and recursively add whatever instances the child definitions require to the parent definitions.</p>\n<p>So if I'm not missing something this would allow in principle to essentially translate elaborated Lean code to Cubical Agda with no axioms and having it typecheck.</p>\n<p>This would mean that one can be more confident in Lean's consistency and also it would enable to replace Lean's foundations with cubical type theory and still keep compatibility with Lean 4 code, but also allow definitions outside it without the Set-only restriction. One could then, still keeping compatibility, gradually generalize mathlib statements to work on non-Sets where valid, and to avoid choice where unnecessary, and then have a formalization of mathematics that doesn't make any compromise.</p>\n<p>Does this work or is there any issue in this reasoning?</p>",
        "id": 462533011,
        "sender_full_name": "E M",
        "timestamp": 1723722216
    },
    {
        "content": "<blockquote>\n<p>still keep compatibility with Lean 4 code </p>\n</blockquote>\n<p>I think this clause is doing a lot of heavy lifting.</p>",
        "id": 462551395,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1723728818
    },
    {
        "content": "<p>As a point of pedantry, note that functional extensionality is also a theorem in lean, see <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=funext#doc\">docs#funext</a></p>",
        "id": 462557153,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1723730380
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"745882\">E M</span> <a href=\"#narrow/stream/236446-Type-theory/topic/Justifying.20Lean's.20axioms.20with.20cubical.20type.20theory/near/462533011\">said</a>:</p>\n<blockquote>\n<p>This would mean that one can be more confident in Lean's consistency</p>\n</blockquote>\n<p>Can you elaborate on this? I'm not sure your proposal makes progress on that front unless the axioms of cubical agda are dramatically simpler than those of Lean or Agda's kernel/implementation is somehow more trustworthy than Lean's. If you believe one or both of those to be the case, I'd be interested to know why.</p>",
        "id": 462557243,
        "sender_full_name": "Chris Bailey",
        "timestamp": 1723730403
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"228466\">Chris Bailey</span> <a href=\"#narrow/stream/236446-Type-theory/topic/Justifying.20Lean's.20axioms.20with.20cubical.20type.20theory/near/462557243\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"745882\">E M</span> <a href=\"#narrow/stream/236446-Type-theory/topic/Justifying.20Lean's.20axioms.20with.20cubical.20type.20theory/near/462533011\">said</a>:</p>\n<blockquote>\n<p>This would mean that one can be more confident in Lean's consistency</p>\n</blockquote>\n<p>Can you elaborate on this? I'm not sure your proposal makes progress on that front unless the axioms of cubical agda are dramatically simpler than those of Lean or Agda's kernel/implementation is somehow more trustworthy than Lean's. If you believe one or both of those to be the case, I'd be interested to know why.</p>\n</blockquote>\n<p>I would say that cubical  type theory is even more complex, they buy into a lot of additional inference rules around the whole cube thing in order to build up the theory.</p>",
        "id": 462557456,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1723730464
    },
    {
        "content": "<p>/me is resisting time cube jokes</p>",
        "id": 462557890,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1723730589
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 462557976,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1723730631
    },
    {
        "content": "<p>But seriously, I think a main selling point of Lean is the flexibility of its metaprogramming. At a minimum, a cubical TT DSL would be very cool.</p>",
        "id": 462558403,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1723730797
    },
    {
        "content": "<p>I don't see why Lean can't have all the type theories (just not in the kernel)</p>",
        "id": 462558776,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1723730950
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306577\">Matthew Ballard</span> <a href=\"#narrow/stream/236446-Type-theory/topic/Justifying.20Lean's.20axioms.20with.20cubical.20type.20theory/near/462558403\">said</a>:</p>\n<blockquote>\n<p>But seriously, I think a main selling point of Lean is the flexibility of its metaprogramming. At a minimum, a cubical TT DSL would be very cool.</p>\n</blockquote>\n<p>wouldn't that require it be the other way around? i.e. embedding cubical TT into Lean's TT? (sounds more complicated/unclear if feasible as a shallow embedding)</p>",
        "id": 462558784,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1723730955
    },
    {
        "content": "<p>Sure, but that is what I find most interesting</p>",
        "id": 462558868,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1723730996
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"395550\">Henrik Böving</span> <a href=\"#narrow/stream/236446-Type-theory/topic/Justifying.20Lean's.20axioms.20with.20cubical.20type.20theory/near/462557456\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"228466\">Chris Bailey</span> <a href=\"#narrow/stream/236446-Type-theory/topic/Justifying.20Lean's.20axioms.20with.20cubical.20type.20theory/near/462557243\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"745882\">E M</span> <a href=\"#narrow/stream/236446-Type-theory/topic/Justifying.20Lean's.20axioms.20with.20cubical.20type.20theory/near/462533011\">said</a>:</p>\n<blockquote>\n<p>This would mean that one can be more confident in Lean's consistency</p>\n</blockquote>\n<p>Can you elaborate on this? I'm not sure your proposal makes progress on that front unless the axioms of cubical agda are dramatically simpler than those of Lean or Agda's kernel/implementation is somehow more trustworthy than Lean's. If you believe one or both of those to be the case, I'd be interested to know why.</p>\n</blockquote>\n<p>I would say that cubical  type theory is even more complex, they buy into a lot of additional inference rules around the whole cube thing in order to build up the theory.</p>\n</blockquote>\n<p>I would go further and say that cubical type theory is the most complex axiomatic system I have ever seen presented. It's also not just one thing, there are many versions of CTT (I know at least 5), which makes it difficult as an implementer to make CTT theorists happy AFAICT. That said, I am all in favor of any attempt to embed theory X in theory Y since we learn a little bit about X and Y every time we try it</p>",
        "id": 462640015,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1723755526
    },
    {
        "content": "<p>Maybe a bit late to chime in but if you want to build a model of lean in another theory then <a href=\"https://arxiv.org/abs/2003.01491\">XTT</a> might be a well-suited by product of cubical type theories for that end because XTT is already specialized to talk about (homotopy) sets (technically 0-truncated types in HoTT linguo). There is also a related line of work on Observational Type Theories (<a href=\"http://strictlypositive.org/ott.pdf\">orginal OTT paper</a>) whose metatheory (including normalization and canonicity) has been established in a recent series of papers (<a href=\"https://inria.hal.science/hal-03367052/file/main.pdf\">here</a>, <a href=\"https://hal.science/hal-03857705v2/document\">tackling impredicativity</a> and <a href=\"https://hal.science/hal-04535982v1/document\">inductives</a>). However all these papers are targetting other properties than (relative) consistency that can be established through a model to sets (assuming a metatheory that's strong enough).</p>",
        "id": 463396764,
        "sender_full_name": "Kyod",
        "timestamp": 1724072078
    }
]