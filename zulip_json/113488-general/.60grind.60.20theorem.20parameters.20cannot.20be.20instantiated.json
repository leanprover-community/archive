[
    {
        "content": "<p>The following example of marking a theorem for use with <code>grind</code> fails:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Lie</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"c\">/-</span>\n<span class=\"cm\">invalid pattern(s) for `LieRingModule.add_lie`</span>\n<span class=\"cm\">  [@Bracket.bracket #7 #6 _ (@HAdd.hAdd _ _ _ _ #2 #1) #0]</span>\n<span class=\"cm\">the following theorem parameters cannot be instantiated:</span>\n<span class=\"cm\">  inst✝¹ : LieRing L</span>\n<span class=\"cm\">  inst✝ : AddCommGroup M</span>\n<span class=\"cm\">  self : LieRingModule L M</span>\n<span class=\"cm\">-/</span>\n<span class=\"n\">grind_pattern</span><span class=\"w\"> </span><span class=\"n\">LieRingModule</span><span class=\"bp\">.</span><span class=\"n\">add_lie</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⁅</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">⁆</span>\n</code></pre></div>\n<p>What does <code>the following theorem parameters cannot be instantiated</code> mean? And is there any (multi-)pattern which works for this theorem?</p>\n<p>My guess is that this is somehow related to type class instances being considered supporting elements in <code>grind</code> and therefore not being recoverable by the given pattern. Though I don't quite understand how the example above is different from something like:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"n\">grind_pattern</span><span class=\"w\"> </span><span class=\"n\">CommMonoid</span><span class=\"bp\">.</span><span class=\"n\">mul_comm</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b</span>\n</code></pre></div>",
        "id": 542214002,
        "sender_full_name": "Marcus Rossel",
        "timestamp": 1759221170
    },
    {
        "content": "<p>I think it doesn't like the implicit arguments for the instances</p>",
        "id": 542223837,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1759223894
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Lie</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">LieRingModule</span><span class=\"bp\">.</span><span class=\"n\">add_lie2</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LieRing</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">self</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LieRingModule</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">⁅</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">⁆</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⁅</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">⁆</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">⁅</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">⁆</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">LieRingModule</span><span class=\"bp\">.</span><span class=\"n\">add_lie</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">m</span>\n\n<span class=\"n\">grind_pattern</span><span class=\"w\"> </span><span class=\"n\">LieRingModule</span><span class=\"bp\">.</span><span class=\"n\">add_lie2</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⁅</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">⁆</span>\n</code></pre></div>\n<p>works</p>",
        "id": 542223892,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1759223912
    },
    {
        "content": "<p>That pattern is the same as a <code>@[grind =]</code> annotation, right?</p>",
        "id": 542225096,
        "sender_full_name": "Chris Henson",
        "timestamp": 1759224294
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"687698\">Chris Henson</span> <a href=\"#narrow/channel/113488-general/topic/.60grind.60.20theorem.20parameters.20cannot.20be.20instantiated/near/542225096\">said</a>:</p>\n<blockquote>\n<p>That pattern is the same as a <code>@[grind =]</code> annotation, right?</p>\n</blockquote>\n<p>Yes, which in this case is also the same as just <code>@[grind]</code>.</p>",
        "id": 542225625,
        "sender_full_name": "Marcus Rossel",
        "timestamp": 1759224459
    },
    {
        "content": "<p>Note that <code>@[grind]</code> now always suggests a replacement, and is not something that can be left in source code. If you want the old behavour of <code>@[grind]</code>, using <code>@[grind .]</code> instead.</p>",
        "id": 544857209,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1760488581
    }
]