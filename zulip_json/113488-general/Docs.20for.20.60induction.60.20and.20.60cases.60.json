[
    {
        "content": "<p>When doing</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">help</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">induction</span>\n</code></pre></div>\n<p>a long message presenting the different options is displayed, and one can read \"You can use <code>with</code> to provide the variables names for each constructor.\" This is false, this only works with <code>induction'</code>, that is also somewhat mentioned but with the doc \"  The <code>induction'</code> tactic is similar to the <code>induction</code> tactic in Lean 4 core,  but with slightly different syntax (such as, no requirement to name the constructors).\" That sounds a bit cryptic, to me: I would say that one advantage of <code>induction' </code> is that <em>you can name them</em>!</p>\n<p>Similarly, the doc for <code>cases</code> contains \"You can use <code>with</code> to provide the variables names for each constructor.\" that is false, but becomes true for <code>cases'</code> and once more the small doc about <code>cases'</code> has no reference to the fact that it is a good variation to name the constructors. It is also a pity that <code>rcases</code> is not mentioned in the <code>cases</code> docs.</p>\n<p>I wanted to open a PR to modify these docs, but I cannot find where they are. The <code>def evalCases</code> contained in <code>Lean/Elab/Tactic/Induction.lean</code> contains no doc (AFAICT), so I do not know where to look.</p>",
        "id": 474840793,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728053744
    },
    {
        "content": "<p>I think this refers to the following?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib.Tactic</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n\n<span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">factorial</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">factorial_zero</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">factorial_succ</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">mul_pos</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">succ_pos</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n</code></pre></div>",
        "id": 474841967,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728054051
    },
    {
        "content": "<p>(similarly for <code>cases</code>)</p>",
        "id": 474842017,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728054068
    },
    {
        "content": "<p>Ah, I see, true. But you also agree that one could read it as <code>induction n with m hm</code> works (and it does not).</p>",
        "id": 474842198,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728054117
    },
    {
        "content": "<p>But I do agree that the documentation should be improved. For example, the one for <code>induction</code> mentions two examples at the bottom, but not one with the above variant.</p>",
        "id": 474842336,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728054150
    },
    {
        "content": "<p>And I'd be happy to help in doing so, but do you know <em>how</em>?</p>",
        "id": 474842455,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728054197
    },
    {
        "content": "<p>Yes, if you only read that line without the following <del>three</del> four bulletpoints, you could get that impression</p>",
        "id": 474842484,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728054210
    },
    {
        "content": "<p>I think a better wording would be approx \"You can use <code>with</code> to provide the variables names for each constructor with one of the following variants:\" or something like that.</p>",
        "id": 474842815,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728054316
    },
    {
        "content": "<p>Yes</p>",
        "id": 474843120,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728054416
    },
    {
        "content": "<p>Hmmm... it is a bit hard to find where the documentation is written!</p>",
        "id": 474843121,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728054416
    },
    {
        "content": "<p>I found the one for <code>induction'</code>, it's in <code>Mathlib/Tactic/Cases</code></p>",
        "id": 474843429,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728054511
    },
    {
        "content": "<p>Yes, that one I found as well, but not the one for <code>induction</code>.</p>",
        "id": 474843494,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728054535
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/blob/4f5f39294d8ccc65e50939270a230899d1d0294c/src/Init/Tactics.lean#L818\">https://github.com/leanprover/lean4/blob/4f5f39294d8ccc65e50939270a230899d1d0294c/src/Init/Tactics.lean#L818</a></p>",
        "id": 474843850,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728054628
    },
    {
        "content": "<p>Thanks!</p>",
        "id": 474843911,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728054648
    },
    {
        "content": "<p>I had to copy-paste a snippet of text from the doc that <code>#help</code> found, and search through the sourcecode on github in the Lean4 repo <span aria-label=\"rofl\" class=\"emoji emoji-1f923\" role=\"img\" title=\"rofl\">:rofl:</span></p>",
        "id": 474843964,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728054669
    },
    {
        "content": "<p>Smart! Did not cross my mind... <span aria-label=\"cross mark\" class=\"emoji emoji-274c\" role=\"img\" title=\"cross mark\">:cross_mark:</span></p>",
        "id": 474844068,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728054708
    },
    {
        "content": "<p>FWIW I think the <code>#help tactic foo</code> command does roughly the following: it looks for all tactics in the imports that have <code>foo</code> somewhere in the name, and displays their documentation. By \"tactic\" here it's really looking at the syntax itself, which is why the documentation for <code>induction</code> is attached to where the syntax is defined.</p>",
        "id": 474844218,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728054750
    },
    {
        "content": "<p>I think it searches for tactics whose name <em>starts</em> with <code>foo</code>, no?</p>",
        "id": 474844299,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728054786
    },
    {
        "content": "<p>yes, you're probably right.</p>",
        "id": 474844333,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728054799
    },
    {
        "content": "<p>I guess I can try <code>#help tactic uction</code> :)</p>",
        "id": 474844359,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728054808
    },
    {
        "content": "<p>...and?</p>",
        "id": 474844382,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728054819
    },
    {
        "content": "<p>nada! you're right :)</p>",
        "id": 474844408,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728054827
    },
    {
        "content": "<p><code>no tactic declarations start with uction</code></p>",
        "id": 474844478,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728054843
    },
    {
        "content": "<p>eheh, which is a pity, otherwise <code>help tactic cases</code> would find <code>rcases</code>.</p>",
        "id": 474844502,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728054847
    },
    {
        "content": "<p>(it would admittedly also find <code>briefcases</code>, the day we create it <span aria-label=\"briefcase\" class=\"emoji emoji-1f4bc\" role=\"img\" title=\"briefcase\">:briefcase:</span> )</p>",
        "id": 474844658,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728054902
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243562\">Adam Topaz</span> <a href=\"#narrow/stream/113488-general/topic/Docs.20for.20.60induction.60.20and.20.60cases.60/near/474843964\">said</a>:</p>\n<blockquote>\n<p>I had to copy-paste a snippet of text from the doc that <code>#help</code> found, and search through the sourcecode on github in the Lean4 repo <span aria-label=\"rofl\" class=\"emoji emoji-1f923\" role=\"img\" title=\"rofl\">:rofl:</span></p>\n</blockquote>\n<p>You should be able to ctrl-click something in the <code>#help</code> output</p>",
        "id": 474845412,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728055162
    },
    {
        "content": "<p>This works for tactics in mathlib, but not for very basic ones like <code>induction</code> (at least for me).</p>",
        "id": 474845490,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728055194
    },
    {
        "content": "<p>did you <code>import Lean</code>?</p>",
        "id": 474845615,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728055225
    },
    {
        "content": "<p>I was in a random file in <code>mathlib</code>, so I do not remember. But I guess that the answer is then</p>\n<ul>\n<li>Sure, I was in <code>mathlib</code></li>\n<li>Surely not, I was in <code>mathlib</code><br>\n...</li>\n</ul>",
        "id": 474845751,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728055274
    },
    {
        "content": "<p>I can check</p>",
        "id": 474845858,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728055320
    },
    {
        "content": "<p>(in 10 mins...)</p>",
        "id": 474846290,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728055461
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> how do you do this in neovim?</p>",
        "id": 474852204,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728057506
    },
    {
        "content": "<p>my usual LSP go-to-definition hotkey doesn't do it.</p>",
        "id": 474852297,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728057535
    },
    {
        "content": "<p>The bracketed thing after each entry produced by <code>#help</code> is a <code>MessageData.expr</code>, which means you can ctrl-click on it in vscode</p>",
        "id": 474853205,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728057795
    },
    {
        "content": "<p>I don't know if this works in neovim, are you able to ctrl-click things in the goal view normally?</p>",
        "id": 474853392,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728057848
    },
    {
        "content": "<p>Oh, I guess not. <span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span> could probably help!</p>",
        "id": 474853479,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728057877
    },
    {
        "content": "<p>Scratch that, yes, it does work in the infoview in goals etc.</p>",
        "id": 474853649,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728057919
    },
    {
        "content": "<p>well <span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span> can probably still help if this is due to goals being implemented in a different way</p>",
        "id": 474854186,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728058044
    },
    {
        "content": "<p>I'm mostly offline till Monday, but it should work \"the same\". Is this what you're trying <span class=\"user-mention\" data-user-id=\"243562\">@Adam Topaz</span> ? I'm hitting <code>gd</code> here inside the infoview:</p>\n<p><a href=\"/user_uploads/3121/0rwUx_0cyRwseqJjdZ-jrbw7/output.mp4\">output.mp4</a></p>\n<div class=\"message_inline_image message_inline_video\"><a href=\"/user_uploads/3121/0rwUx_0cyRwseqJjdZ-jrbw7/output.mp4\" title=\"output.mp4\"><video preload=\"metadata\" src=\"/user_uploads/3121/0rwUx_0cyRwseqJjdZ-jrbw7/output.mp4\"></video></a></div><p>Note two things:</p>\n<p>1) it only works between the brackets (this is the same as VSCode AFAICT)<br>\n2) make sure you <em>don't</em> accidentally override the <code>gd</code> mapping in the infoview (which I show at the end there, hit <code>:map gd</code> to check). The reason is that this behavior is \"fake\" -- it doesn't really come from the language server's usual <code>textDocument/definition</code>, so \"normal\" go to definition isn't what's being used there, we've reimplemented it for this case where it's an interactive diagnostic message. Again AFAIK that's the same as in VSCode.</p>",
        "id": 474884499,
        "sender_full_name": "Julian Berman",
        "timestamp": 1728068672
    },
    {
        "content": "<p>It's a bit ugly looking, we should do some syntax highlighting there I guess, but I see VSCode doesn't do any either.</p>",
        "id": 474884616,
        "sender_full_name": "Julian Berman",
        "timestamp": 1728068719
    },
    {
        "content": "<p>yeah this behavior seems to be about the same as vscode</p>",
        "id": 474884653,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728068742
    },
    {
        "content": "<p>I see, yes it does indeed work with the cursor between the brackets! Thanks <span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span> !</p>",
        "id": 474886159,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728069365
    },
    {
        "content": "<p>I wish there was some (even slight) colour variation between what's in the bracket and the rest of the text by default, at least to have a visual cue that this is something to try.</p>",
        "id": 474886265,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728069410
    },
    {
        "content": "<p>I would have preferred to just link the syntax line itself, but messageData is limited in the things that get clicky stuff</p>",
        "id": 474886352,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728069458
    },
    {
        "content": "<p>especially because the names of the constants can be quite unsightly</p>",
        "id": 474886458,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728069490
    },
    {
        "content": "<p>While we are on the topic of <code>induction</code> and <code>cases</code>, I'll share a thought. I am currently teaching an undergraduate course on interactive theorem proving based on MIL (as well as material I will work into a new MIL chapter soon). The last week or so covered induction on the natural numbers, as well as structural induction on things like lists and trees.</p>\n<p>MIL has normalized on <code>rcases</code> and <code>obtain</code> for destructing data and we have a pretty good story for using <code>cases</code> with structured proofs for structural induction. We also normalize on <code>induction'</code> for ordinary proof by induction on the natural numbers. The one thing that annoys me is having the prime in the name of the tactic that we pitching as the canonical one for many use cases. Does that annoy anyone else? How about renaming it <code>induct</code> so we can write <code>induct n with n ih</code> rather than <code>induction' n with n ih</code>?</p>",
        "id": 474992756,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728143807
    },
    {
        "content": "<p>Why don’t you want to use <code>induction</code> instead? Is it because the code action is not good enough?</p>",
        "id": 474993707,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1728144578
    },
    {
        "content": "<p>You cannot write <code>induction n with m hm</code>, no?</p>",
        "id": 474995244,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728145904
    },
    {
        "content": "<p>You need a prime for it to accept the explicit naming of the new variable and new assumption.</p>",
        "id": 474995301,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728145931
    },
    {
        "content": "<p>The alternative is <code>induction ... with | ...</code></p>",
        "id": 474996415,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728146849
    },
    {
        "content": "<p><code>induction'</code> is not so bad for natural numbers, but much less fun when you have multiple cases where you need to name multiple new variables in each</p>",
        "id": 474996523,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728146909
    },
    {
        "content": "<p>This is even less documented.</p>",
        "id": 474996524,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728146909
    },
    {
        "content": "<p>is it? It should be right there in the docstring</p>",
        "id": 474996547,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728146927
    },
    {
        "content": "<p>...well there is a lot of stuff there and no example. There should be an example</p>",
        "id": 474996563,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728146959
    },
    {
        "content": "<p>let me check</p>",
        "id": 474996565,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728146960
    },
    {
        "content": "<p>It is there, but it would be better to have an example (like at the top of the thread)</p>",
        "id": 474996570,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1728146964
    },
    {
        "content": "<p>it would also be nice if <code>induction n with n ih</code> parsed and gave an error with a try this</p>",
        "id": 474996649,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728147028
    },
    {
        "content": "<p>unfortunately, the position after <code>with</code> in induction is already taken, it's a tactic which runs before each match arm</p>",
        "id": 474996889,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728147171
    },
    {
        "content": "<p>Well, but there are two points here. One is whether it is possible or not to change the behaviour (probably hard), the other is whether we can at least document well what this behaviour is and provide good information to users.</p>",
        "id": 474997010,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728147248
    },
    {
        "content": "<p><code>induction</code> is more verbose. It's usually nicer to write</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">induction'</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n<span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">base</span><span class=\"w\"> </span><span class=\"n\">case</span><span class=\"o\">]</span>\n<span class=\"o\">[</span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>than</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">base</span><span class=\"w\"> </span><span class=\"n\">case</span><span class=\"o\">]</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>At least, that's what we favor in MIL.</p>",
        "id": 474997061,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728147299
    },
    {
        "content": "<p>(Sorry, I was responding to Patrick before I saw the other comments.)</p>",
        "id": 474997101,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728147352
    },
    {
        "content": "<p>I agree that, for many purposes, structured proofs with <code>induction</code> are better. But it's hard to beat <code>induction'</code> for induction on the natural numbers.</p>",
        "id": 474997218,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728147423
    },
    {
        "content": "<p>what would be your opinion on an rcases-like syntax for <code>induction'</code>? It's a bit more verbose, but not multiline</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">rinduction</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"bp\">⟩</span>\n<span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">base</span><span class=\"w\"> </span><span class=\"n\">case</span><span class=\"o\">]</span>\n<span class=\"o\">[</span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 474997364,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728147532
    },
    {
        "content": "<p>I thought about that. IIRC, the SSReflect <code>case</code> (which was similar to <code>rcases</code> could handle recursive eliminators  and let you name the inductive hypothesis). But I don't think <code>rinduction</code> would be a big win. I agree with Filippo that when you are doing computer-sciency things with multiple constructors, <code>induction</code> is nicer. <code>induction'</code> is good for simple structures like the natural numbers and lists, when e.g. there is one trivial base case and one constructor. In that case, the syntax of <code>induction'</code> is optimal.</p>",
        "id": 474997766,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728147858
    },
    {
        "content": "<p>It's hard to beat <code>induction'  xs with x xs ih</code> for induction on lists.</p>",
        "id": 474997971,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728148043
    },
    {
        "content": "<p>I'm not sure it's optimal, even if we restrict to the simple case. For example, you could just name the variable the same as the original induction variable and call the inductive hypothesis <code>ih</code> always, and then there is nothing to name</p>",
        "id": 474997991,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728148065
    },
    {
        "content": "<p>if we focus in on just nat / list I think optimal means no names</p>",
        "id": 474998124,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728148092
    },
    {
        "content": "<p>(or optional but frequently omitted names)</p>",
        "id": 474998148,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728148120
    },
    {
        "content": "<p>Observe also that if you do not know exactly what the names of constructors are, <code>induction'</code>inserts it for you, but <code>induction</code> does not.  For instance, when proving</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span>\n</code></pre></div>\n<p>you see <code>0 ≤ 0</code> but you need to write <code>zero</code> to enter a nice goal state; on the other hand, after</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction'</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">hm</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span>\n</code></pre></div>\n<p>you are ready to go.</p>",
        "id": 474998283,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728148214
    },
    {
        "content": "<p>I don't have strong opinions about that. But I don't mind writing <code>induction' n with n ih</code>; it seems to be good hygiene to name the things that are being introduced. (And I'd prefer <code>induct n with n ih</code>.) Having to write the underscore and the angle brackets is a much bigger imposition.</p>",
        "id": 474998320,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728148256
    },
    {
        "content": "<p>if you write <code>induction n</code> you can see the names of the constructors</p>",
        "id": 474998321,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728148260
    },
    {
        "content": "<p>(Again, my response was to Mario.)</p>",
        "id": 474998357,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728148295
    },
    {
        "content": "<p>What do other systems do?</p>",
        "id": 474998447,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728148352
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113488-general/topic/Docs.20for.20.60induction.60.20and.20.60cases.60/near/474998321\">said</a>:</p>\n<blockquote>\n<p>if you write <code>induction n</code> you can see the names of the constructors</p>\n</blockquote>\n<p>For <code>Nat</code>, you see <code>0</code> but you need to type <code>zero</code>. If you start off with </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n</code></pre></div>\n<p>you get problems, but what you see is a <code>0</code>.<br>\nWhat you might do is to use the bulb to have VSCode create the pattern-matching for you, but this also is not written in the doc.</p>",
        "id": 474998486,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728148391
    },
    {
        "content": "<p><a href=\"https://coq.inria.fr/doc/V8.18.0/refman/proofs/writing-proofs/reasoning-inductives.html#coq:tacn.induction\">https://coq.inria.fr/doc/V8.18.0/refman/proofs/writing-proofs/reasoning-inductives.html#coq:tacn.induction</a></p>",
        "id": 474998573,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728148461
    },
    {
        "content": "<p>(I was thinking of languages other than coq, since lean's tactics are mostly borrowed from coq to begin with)</p>",
        "id": 474998592,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728148496
    },
    {
        "content": "<p><a href=\"https://isabelle.in.tum.de/Isar/Isar-induct.pdf\">https://isabelle.in.tum.de/Isar/Isar-induct.pdf</a></p>",
        "id": 474998635,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728148543
    },
    {
        "content": "<p>the isar syntax looks more heavyweight and similar to lean 4 <code>induction</code></p>",
        "id": 474998700,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728148582
    },
    {
        "content": "<p>It's similar to <code>induction</code>.</p>",
        "id": 474998703,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728148587
    },
    {
        "content": "<p>Here's a HOL4 proof:</p>\n<div class=\"codehilite\" data-code-language=\"Standard ML\"><pre><span></span><code><span class=\"cm\">(* Theorem: x IN G /\\ y IN G /\\ x * y = y * x ==&gt; (x ** n) * (y ** m) = (y ** m) * (x ** n) *)</span>\n<span class=\"cm\">(* Proof:</span>\n<span class=\"cm\">   By inducton on m.</span>\n<span class=\"cm\">   Base case: x ** n * y ** 0 = y ** 0 * x ** n</span>\n<span class=\"cm\">   LHS = x ** n * y ** 0</span>\n<span class=\"cm\">       = x ** n * #e         by monoid_exp_0</span>\n<span class=\"cm\">       = x ** n              by monoid_rid</span>\n<span class=\"cm\">       = #e * x ** n         by monoid_lid</span>\n<span class=\"cm\">       = y ** 0 * x ** n     by monoid_exp_0</span>\n<span class=\"cm\">       = RHS</span>\n<span class=\"cm\">   Step case: x ** n * y ** m = y ** m * x ** n ==&gt; x ** n * y ** SUC m = y ** SUC m * x ** n</span>\n<span class=\"cm\">   LHS = x ** n * y ** SUC m</span>\n<span class=\"cm\">       = x ** n * (y * y ** m)    by monoid_exp_SUC</span>\n<span class=\"cm\">       = (x ** n * y) * y ** m    by monoid_assoc</span>\n<span class=\"cm\">       = (y * x ** n) * y ** m    by monoid_comm_exp (with single y)</span>\n<span class=\"cm\">       = y * (x ** n * y ** m)    by monoid_assoc</span>\n<span class=\"cm\">       = y * (y ** m * x ** n)    by induction hypothesis</span>\n<span class=\"cm\">       = (y * y ** m) * x ** n    by monoid_assoc</span>\n<span class=\"cm\">       = y ** SUC m  * x ** n     by monoid_exp_SUC</span>\n<span class=\"cm\">       = RHS</span>\n<span class=\"cm\">*)</span>\n<span class=\"kr\">val</span> <span class=\"nv\">monoid_comm_exp_exp</span> <span class=\"p\">=</span> <span class=\"n\">store_thm</span><span class=\"p\">(</span>\n  <span class=\"s2\">\"monoid_comm_exp_exp\"</span><span class=\"p\">,</span>\n  <span class=\"n\">``!g</span><span class=\"p\">:</span><span class=\"nd\">'a</span> <span class=\"nn\">monoid</span><span class=\"p\">.</span><span class=\"err\"> </span><span class=\"n\">Monoid</span> <span class=\"n\">g</span> <span class=\"n\">==&gt;</span> <span class=\"n\">!x</span> <span class=\"nn\">y</span><span class=\"p\">.</span><span class=\"err\"> </span><span class=\"n\">x</span> <span class=\"n\">IN</span> <span class=\"n\">G</span> <span class=\"n\">/\\</span> <span class=\"n\">y</span> <span class=\"n\">IN</span> <span class=\"n\">G</span> <span class=\"n\">/\\</span> <span class=\"p\">(</span><span class=\"n\">x</span> <span class=\"n\">*</span> <span class=\"n\">y</span> <span class=\"p\">=</span> <span class=\"n\">y</span> <span class=\"n\">*</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"n\">==&gt;</span>\n   <span class=\"n\">!n</span> <span class=\"nn\">m</span><span class=\"p\">.</span><span class=\"err\"> </span><span class=\"n\">x</span> <span class=\"n\">**</span> <span class=\"n\">n</span> <span class=\"n\">*</span> <span class=\"n\">y</span> <span class=\"n\">**</span> <span class=\"n\">m</span> <span class=\"p\">=</span> <span class=\"n\">y</span> <span class=\"n\">**</span> <span class=\"n\">m</span> <span class=\"n\">*</span> <span class=\"n\">x</span> <span class=\"n\">**</span> <span class=\"n\">n``</span><span class=\"p\">,</span>\n  <span class=\"n\">rpt</span> <span class=\"n\">strip_tac</span> <span class=\"n\">&gt;&gt;</span>\n  <span class=\"n\">Induct_on</span> <span class=\"n\">`m`</span> <span class=\"n\">&gt;-</span>\n  <span class=\"n\">rw</span><span class=\"p\">[]</span> <span class=\"n\">&gt;&gt;</span>\n  <span class=\"n\">`x</span> <span class=\"n\">**</span> <span class=\"n\">n</span> <span class=\"n\">*</span> <span class=\"n\">y</span> <span class=\"n\">**</span> <span class=\"n\">SUC</span> <span class=\"n\">m</span> <span class=\"p\">=</span> <span class=\"n\">x</span> <span class=\"n\">**</span> <span class=\"n\">n</span> <span class=\"n\">*</span> <span class=\"p\">(</span><span class=\"n\">y</span> <span class=\"n\">*</span> <span class=\"n\">y</span> <span class=\"n\">**</span> <span class=\"n\">m</span><span class=\"p\">)</span><span class=\"n\">`</span> <span class=\"n\">by</span> <span class=\"n\">rw</span><span class=\"p\">[]</span> <span class=\"n\">&gt;&gt;</span>\n  <span class=\"n\">`</span><span class=\"p\">_</span> <span class=\"p\">=</span> <span class=\"p\">(</span><span class=\"n\">x</span> <span class=\"n\">**</span> <span class=\"n\">n</span> <span class=\"n\">*</span> <span class=\"n\">y</span><span class=\"p\">)</span> <span class=\"n\">*</span> <span class=\"n\">y</span> <span class=\"n\">**</span> <span class=\"n\">m`</span> <span class=\"n\">by</span> <span class=\"n\">rw</span><span class=\"p\">[</span><span class=\"n\">monoid_assoc</span><span class=\"p\">]</span> <span class=\"n\">&gt;&gt;</span>\n  <span class=\"n\">`</span><span class=\"p\">_</span> <span class=\"p\">=</span> <span class=\"p\">(</span><span class=\"n\">y</span> <span class=\"n\">*</span> <span class=\"n\">x</span> <span class=\"n\">**</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"n\">*</span> <span class=\"n\">y</span> <span class=\"n\">**</span> <span class=\"n\">m`</span> <span class=\"n\">by</span> <span class=\"n\">metis_tac</span><span class=\"p\">[</span><span class=\"n\">monoid_comm_exp</span><span class=\"p\">]</span> <span class=\"n\">&gt;&gt;</span>\n  <span class=\"n\">`</span><span class=\"p\">_</span> <span class=\"p\">=</span> <span class=\"n\">y</span> <span class=\"n\">*</span> <span class=\"p\">(</span><span class=\"n\">x</span> <span class=\"n\">**</span> <span class=\"n\">n</span> <span class=\"n\">*</span> <span class=\"n\">y</span> <span class=\"n\">**</span> <span class=\"n\">m</span><span class=\"p\">)</span><span class=\"n\">`</span> <span class=\"n\">by</span> <span class=\"n\">rw</span><span class=\"p\">[</span><span class=\"n\">monoid_assoc</span><span class=\"p\">]</span> <span class=\"n\">&gt;&gt;</span>\n  <span class=\"n\">`</span><span class=\"p\">_</span> <span class=\"p\">=</span> <span class=\"n\">y</span> <span class=\"n\">*</span> <span class=\"p\">(</span><span class=\"n\">y</span> <span class=\"n\">**</span> <span class=\"n\">m</span> <span class=\"n\">*</span> <span class=\"n\">x</span> <span class=\"n\">**</span> <span class=\"n\">n</span><span class=\"p\">)</span><span class=\"n\">`</span> <span class=\"n\">by</span> <span class=\"n\">metis_tac</span><span class=\"p\">[]</span> <span class=\"n\">&gt;&gt;</span>\n  <span class=\"n\">rw</span><span class=\"p\">[</span><span class=\"n\">monoid_assoc</span><span class=\"p\">]);</span>\n</code></pre></div>",
        "id": 474998769,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728148654
    },
    {
        "content": "<p>which I think means that the inductive hypothesis is in scope but basically unnamed, and the variable name has been reused</p>",
        "id": 474998872,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728148732
    },
    {
        "content": "<p>In the HOL family, assumptions in the context (like the ih) aren't named, right?</p>",
        "id": 474998875,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728148736
    },
    {
        "content": "<p>We're writing at the same time.</p>",
        "id": 474998882,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728148747
    },
    {
        "content": "<p>usually you pick out hypotheses by giving patterns describing their type</p>",
        "id": 474998913,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728148786
    },
    {
        "content": "<p>like the <code>\\f&lt;&gt;</code> syntax</p>",
        "id": 474998925,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728148799
    },
    {
        "content": "<p>(or you just call hammers all the time like in this example)</p>",
        "id": 474998981,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728148819
    },
    {
        "content": "<p>In Isabelle tactic proofs, it was more common just to call hammers or use tactics that take the first assumption that matches.</p>",
        "id": 474999018,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728148859
    },
    {
        "content": "<p>Anyhow, I think <code>induction'</code> is close to optimal. Maybe there is a way to choose sensible defaults when the <code>with</code> is omitted, but that seems to be a minor issue. I am more bothered by the aesthetics of having the prime in the name.</p>",
        "id": 474999125,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728148976
    },
    {
        "content": "<p>I don't have any interesting facts to add to this discussion other than I'm a fan of <code>induction</code> the way it is now and I think of <code>induction'</code> as legacy Lean 3 code. That said, I'm noticing I appear to be in the minority.</p>\n<p>I especially like you can use the place after<code>with</code> to deal with trivial cases and focus on important ones. This is from Batteries.Data.Array code I played with this morning:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">size_shrink_loop</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">shrink</span><span class=\"bp\">.</span><span class=\"n\">loop</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">generalizing</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">shrink</span><span class=\"bp\">.</span><span class=\"n\">loop</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">omega</span>\n</code></pre></div>\n<p>This one is pretty slick (and didn't make it to the PR because of the non-terminal simp). I find this format especially clear and useful when there's a lot of cases and only one or two are nontrivial.</p>",
        "id": 474999134,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1728148985
    },
    {
        "content": "<p>I think Jeremy has a valid argument here that while the syntax of <code>induction'</code> doesn't scale well, it does handle the simple (and common!) cases better than most alternatives, and the challenge is how to have the best of both worlds</p>",
        "id": 474999226,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728149060
    },
    {
        "content": "<p>In particular, we should stop thinking of <code>induction'</code> as legacy lean 3 code, there are reasons to use it which have nothing to do with historical usage patterns</p>",
        "id": 474999402,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728149202
    },
    {
        "content": "<p>Note that we have a similar duality with <code>rcases</code> and structured <code>case</code> syntax. Sometimes <code>rcases</code> is more convenient, and sometimes it is better to use a more verbose but structured proof with <code>cases</code>. I like the fact that Lean offers both options and they are both first-class citizens. Similarly, I like the fact that we can choose between <code>induction'</code> and <code>induction</code>. I only dislike the fact that the prime makes <code>induction'</code> feel like a second-class citizen.</p>",
        "id": 474999724,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1728149481
    },
    {
        "content": "<p>another thing I was thinking of would be to make <code>with</code> a tactic, which just acts like <code>map_tacs [rename_i ..., rename_i ...]</code>. So then you could write <code>induction x; with | n ih</code> which is pretty compact and also generalizes to any tactic that does both multiple subgoals and intros</p>",
        "id": 474999923,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728149644
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113488-general/topic/Docs.20for.20.60induction.60.20and.20.60cases.60/near/474999226\">said</a>:</p>\n<blockquote>\n<p>I think Jeremy has a valid argument here that while the syntax of <code>induction'</code> doesn't scale well, it does handle the simple (and common!) cases better than most alternatives, and the challenge is how to have the best of both worlds</p>\n<p>In particular, we should stop thinking of <code>induction'</code> as legacy lean 3 code, there are reasons to use it which have nothing to do with historical usage patterns</p>\n</blockquote>\n<p>I agree with that. I certainly did not mean to imply that everyone should think of <code>induction'</code> as legacy Lean 3 code! I barely use it now but I do use it occasionally, I think. I certainly have used it in the past. Maybe my brain rewired itself to use the new <code>induction</code> over time but I'm definitely not against occasionally using <code>induction'</code>.</p>",
        "id": 475000056,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1728149780
    },
    {
        "content": "<p>maybe a minimalistic change to <code>induction'</code> which is backward compatible is to allow adding <code>|</code> between the variables to separate the cases</p>",
        "id": 475000130,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728149846
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113488-general/topic/Docs.20for.20.60induction.60.20and.20.60cases.60/near/474999923\">said</a>:</p>\n<blockquote>\n<p>another thing I was thinking of would be to make <code>with</code> a tactic, which just acts like <code>map_tacs [rename_i ..., rename_i ...]</code>. So then you could write <code>induction x; with | n ih</code> which is pretty compact and also generalizes to any tactic that does both multiple subgoals and intros</p>\n</blockquote>\n<p>This is pretty similar to <code>induction x; next =&gt; ...; next n ih =&gt; ...</code> (Admittedly, I never thought <code>next</code> was an obvious name for what it does.)</p>",
        "id": 475000210,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1728149882
    },
    {
        "content": "<p>the difference is that all the names come at the beginning instead of before the case</p>",
        "id": 475000271,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728149907
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113488-general/topic/Docs.20for.20.60induction.60.20and.20.60cases.60/near/475000130\">said</a>:</p>\n<blockquote>\n<p>maybe a minimalistic change to <code>induction'</code> which is backward compatible is to allow adding <code>|</code> between the variables to separate the cases</p>\n</blockquote>\n<p>That's pretty much like Coq, right?</p>",
        "id": 475000302,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1728149944
    },
    {
        "content": "<p>yeah, the idea is to make it closer to rcases patterns which are also similar to ssreflect intro patterns</p>",
        "id": 475000318,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728149975
    },
    {
        "content": "<p>there isn't a whole lot to work with in the syntax there because there are no delimiters at all</p>",
        "id": 475000488,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728150115
    },
    {
        "content": "<p>Sounds good. Like you suggested elsewhere a while ago, we ultimately would like to have some form of \"Coq compatibility mode\" be able to copy paste a Coq proof in Lean. That task is easier if Lean has some syntax options that are mostly compatible with Coq's syntax.</p>",
        "id": 475000571,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1728150164
    },
    {
        "content": "<p>Stay tuned, I'll be talking to Assia next week and we'll be thinking about this general area</p>",
        "id": 475000613,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728150207
    },
    {
        "content": "<p>but I think it's more likely to go in the direction of syntax translation, which means the main concern is ensuring that equivalent semantics exist, even if the concrete syntax differs in trivial ways</p>",
        "id": 475000703,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728150259
    },
    {
        "content": "<p>One thing we might consider: if <code>induction'</code> didn't exist and we were all used to the (admittedly fairly verbose) <code>induction</code> syntax - would we add it?</p>",
        "id": 475001508,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728150806
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113488-general/topic/Docs.20for.20.60induction.60.20and.20.60cases.60/near/475000703\">said</a>:</p>\n<blockquote>\n<p>but I think it's more likely to go in the direction of syntax translation, which means the main concern is ensuring that equivalent semantics exist, even if the concrete syntax differs in trivial ways</p>\n</blockquote>\n<p>Indeed, let's get v1.0 working and then add copy-paste functionality in v2.0.</p>",
        "id": 475001712,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1728150954
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span> <a href=\"#narrow/stream/113488-general/topic/Docs.20for.20.60induction.60.20and.20.60cases.60/near/474993707\">said</a>:</p>\n<blockquote>\n<p>Is it because the code action is not good enough?</p>\n</blockquote>\n<p>I always struggle with the code action. I think my issue is that I write <code>induction n with</code>, and then it's too late for the action to run?</p>",
        "id": 475027986,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1728167495
    },
    {
        "content": "<p>But also, I don't think the action supports <code>induction using</code>, so then you play this stupid game where you only get an error message telling you what the missing cases are after your first correct guess</p>",
        "id": 475028046,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1728167554
    },
    {
        "content": "<p>an enumeration of failing examples (and expected results if it's not obvious) would help</p>",
        "id": 475028101,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728167637
    },
    {
        "content": "<p>Three worked examples in the <code>induction</code> tactic docstring would help.</p>",
        "id": 475070318,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1728200551
    },
    {
        "content": "<p>I like <code>induction</code> as well. It's a bit verbose, but since I don't have to type it myself, I don't mind.</p>",
        "id": 475266202,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1728296960
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/113488-general/topic/Docs.20for.20.60induction.60.20and.20.60cases.60/near/475028046\">said</a>:</p>\n<blockquote>\n<p>But also, I don't think the action supports <code>induction using</code>, so then you play this stupid game where you only get an error message telling you what the missing cases are after your first correct guess</p>\n</blockquote>\n<p>While it's true that the action doesn't support <code>using</code>, you don't have to get a correct guess first. If you put your cursor on <code>|</code> in the example below, you'll see in the infoview the arm named in the infoview: <code>case ind</code>, which tells you how to name the arms.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">strongRecOn</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span>\n</code></pre></div>",
        "id": 476210069,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1728588964
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> do you need failing examples of where the code action doesn't work for <code>induction ... using ... with _</code>?</p>",
        "id": 476210183,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1728589015
    },
    {
        "content": "<p>The thing about <code>induction</code> that annoys me is that the hypotheses in each arm are introduced by default (and inaccessible if unnamed). This wouldn't be so bad, except I don't think there's anyway to disable the introduction.</p>\n<p>I just learned about the <code>@</code> syntax for induction arms (this is <em>not</em> included in the documentation, and I only found out about it by stumbling on the docstring for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Parser.Tactic.inductionAltLHS#doc\">docs#Lean.Parser.Tactic.inductionAltLHS</a>), which allows you to name <em>implicit</em> arguments, but unfortunately <code>| @succ =&gt; sorry</code> still introduces the inaccessible variables <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span>. See also <a href=\"#narrow/stream/287929-mathlib4/topic/migrating.20to.20dependent.20induction.20lemmas/near/476204778\">this thread</a></p>",
        "id": 476211176,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1728589352
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/stream/113488-general/topic/Docs.20for.20.60induction.60.20and.20.60cases.60/near/476210183\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> do you need failing examples of where the code action doesn't work for <code>induction ... using ... with _</code>?</p>\n</blockquote>\n<p>I want examples where it doesn't work and you think it should</p>",
        "id": 476246316,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728604166
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/stream/113488-general/topic/Docs.20for.20.60induction.60.20and.20.60cases.60/near/476211176\">said</a>:</p>\n<blockquote>\n<p>The thing about <code>induction</code> that annoys me is that the hypotheses in each arm are introduced by default (and inaccessible if unnamed). This wouldn't be so bad, except I don't think there's anyway to disable the introduction.</p>\n</blockquote>\n<p>Yeah, I don't think you should think of it as doing an introduction, it's part of the tactic operation itself (and it has to do some other stuff afterwards) so it's not really an option to not do it - you can name the variables or <code>revert</code> them if you don't want them intro'd. (Or just use <code>apply</code> with the recursor in this case)</p>",
        "id": 476246669,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728604360
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> here is an example of the code action working (without <code>using</code>) and failing (with <code>using</code>). I have <em>never</em> seen the code action available for <code>using</code>; I thought it just wasn't implemented.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"c1\">-- cursor on `_` gives an :idea: bubble, which generates:</span>\n<span class=\"w\">  </span><span class=\"c1\">-- | zero =&gt; sorry</span>\n<span class=\"w\">  </span><span class=\"c1\">-- | succ n ih =&gt; sorry</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">strongRecOn</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"c1\">-- no :idea: bubble</span>\n</code></pre></div>",
        "id": 476445194,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1728674098
    },
    {
        "content": "<p>(<span class=\"user-mention\" data-user-id=\"197836\">@Jireh Loreaux</span>: not directly related, but note that <code>induction t</code> already gives a code action, no need to type <code>with _</code>)</p>",
        "id": 476445795,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1728674399
    },
    {
        "content": "<p>But I indeed also have no code action for (variations of) the second example.</p>",
        "id": 476445917,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1728674447
    },
    {
        "content": "<p>I wasn't saying it is implemented, I was requesting scenarios where the code action does not work, including also incomplete inputs that the code action did not anticipate</p>",
        "id": 476470827,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728687934
    },
    {
        "content": "<p>another case I'm aware of is <code>match e with | ...</code> or <code>induction e with | ...</code> where the arms are present but not exhaustive (e.g. there is a missing variant)</p>",
        "id": 476470979,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1728688047
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> Is there any news about having a code action for <code>induction … using …</code>?</p>",
        "id": 481356429,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1731086502
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/batteries/pull/1030\">batteries#1030</a></p>",
        "id": 481377567,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1731095518
    },
    {
        "content": "<p>Great, thank you so much!</p>",
        "id": 481377753,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1731095598
    },
    {
        "content": "<p>How much pushing of luck is it to ask the same question about the <code>match </code> arm generation code action (which it looks like was last discussed here: <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/the.20coherent.20isomorphism/near/471050444\">https://leanprover.zulipchat.com/#narrow/channel/455414-Infinity-Cosmos/topic/the.20coherent.20isomorphism/near/471050444</a> )?</p>",
        "id": 481490849,
        "sender_full_name": "Julian Berman",
        "timestamp": 1731183085
    }
]