[
    {
        "content": "<p>I'm new to Lean and trying to write some formalization on simply typed LC. I wanted to use notation for typing in the inductive type definition. Is there a way of doing this? I've seen this implemented in Rocq using „Reserved” notation.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">syntax</span><span class=\"o\">:</span><span class=\"mi\">40</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"o\">:</span><span class=\"mi\">40</span><span class=\"w\"> </span><span class=\"s2\">\" ⊢ \"</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"o\">:</span><span class=\"mi\">50</span><span class=\"w\"> </span><span class=\"s2\">\" : \"</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"o\">:</span><span class=\"mi\">40</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">HasType</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Env</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Δ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Expr</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Typ</span><span class=\"w\"> </span><span class=\"n\">Δ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">unit</span>\n<span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Γ</span><span class=\"w\"> </span><span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">unit</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">unit</span>\n<span class=\"w\">  </span><span class=\"c1\">-- when i try to use it i get „elaboration function for</span>\n<span class=\"w\">  </span><span class=\"c1\">-- `«term_⊢_:_»` has not been implemented”</span>\n\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">var</span>\n<span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Γ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">τ</span>\n<span class=\"w\">    </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">HasType</span><span class=\"w\"> </span><span class=\"n\">Γ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">var</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">τ</span>\n\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">abs</span>\n<span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasType</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Γ</span><span class=\"bp\">.</span><span class=\"n\">extend</span><span class=\"w\"> </span><span class=\"n\">τ1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">τ2</span>\n<span class=\"w\">    </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">HasType</span><span class=\"w\"> </span><span class=\"n\">Γ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Typ</span><span class=\"bp\">.</span><span class=\"n\">arr</span><span class=\"w\"> </span><span class=\"n\">τ1</span><span class=\"w\"> </span><span class=\"n\">τ2</span><span class=\"o\">)</span>\n\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">app</span>\n<span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasType</span><span class=\"w\"> </span><span class=\"n\">Γ</span><span class=\"w\"> </span><span class=\"n\">e1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Typ</span><span class=\"bp\">.</span><span class=\"n\">arr</span><span class=\"w\"> </span><span class=\"n\">τ1</span><span class=\"w\"> </span><span class=\"n\">τ2</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">HasType</span><span class=\"w\"> </span><span class=\"n\">Γ</span><span class=\"w\"> </span><span class=\"n\">e2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">τ1</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">HasType</span><span class=\"w\"> </span><span class=\"n\">Γ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">app</span><span class=\"w\"> </span><span class=\"n\">e1</span><span class=\"w\"> </span><span class=\"n\">e2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">τ2</span>\n\n<span class=\"w\">  </span><span class=\"kn\">notation</span><span class=\"o\">:</span><span class=\"mi\">40</span><span class=\"w\"> </span><span class=\"n\">Γ</span><span class=\"w\"> </span><span class=\"s2\">\" ⊢ \"</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">:</span><span class=\"mi\">50</span><span class=\"w\"> </span><span class=\"s2\">\" : \"</span><span class=\"w\"> </span><span class=\"n\">τ</span><span class=\"o\">:</span><span class=\"mi\">40</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">HasType</span><span class=\"w\"> </span><span class=\"n\">Γ</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">τ</span>\n</code></pre></div>",
        "id": 562239084,
        "sender_full_name": "Dominik Muc",
        "timestamp": 1765023984
    },
    {
        "content": "<p>I looked around in web for some time now and only thing I found is<br>\n<a href=\"https://github.com/leanprover/lean3/issues/1149\">https://github.com/leanprover/lean3/issues/1149</a><br>\nfrom almost 10 years ago</p>",
        "id": 562239162,
        "sender_full_name": "Dominik Muc",
        "timestamp": 1765024073
    },
    {
        "content": "<p>I've you're using <code>notation</code>, don't use <code>syntax</code>. <code>notation</code> is a sugar for <code>syntax</code> + <code>macro</code>. Also <code>notation</code> shouldn't be indented (though, I guess it still works even if it is).</p>",
        "id": 562243515,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1765029217
    },
    {
        "content": "<p>The error came from the fact, that it parsed you're syntax according to what was declared in the first line<br>\n<code>syntax:40 term:40 \" ⊢ \" term:50 \" : \" term:40 : term</code>, and it ignored <code>notation:40 Γ \" ⊢ \" e:50 \" : \" τ:40 =&gt; HasType Γ e τ</code>. And if you use <code>syntax</code>, you have to give implementation for this <code>syntax</code> somewhere else in your file.<br>\nIirc you can't use syntax in a file, before you give it's implementation, so I don't think there's a way to use your syntax inside <code>HasType</code> definition. (Actually, I think there is, by referring to <code>HasType</code> by name, but I wouldn't recommend that method)</p>",
        "id": 562243735,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1765029491
    }
]