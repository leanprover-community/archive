[
    {
        "content": "<p>I am modeling simply-typed lambda-calculus, but I see some repeated tactics. Here's a minimal example.</p>\n<p>Let's first define types <code>Ty</code> and terms <code>Tm</code>.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Ty</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Bool</span>\n\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Tm</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Tm</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ite</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Tm</span>\n</code></pre></div>\n<p>with the obvious computation and typing rules</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zeroAdd</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">m2</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succAdd</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m1</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">m1</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m1</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">succ</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">m'</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}:</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">m'</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">m'</span><span class=\"bp\">.</span><span class=\"n\">succ</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">add1</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m1</span><span class=\"w\"> </span><span class=\"n\">m1'</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}:</span><span class=\"w\"> </span><span class=\"n\">m1</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">m1'</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m1</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m1'</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">add2</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m1</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"w\"> </span><span class=\"n\">m2'</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}:</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">m2'</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m1</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m1</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">m2'</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ifTrue</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">t</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ifFalse</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">f</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">if1</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">c'</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}:</span>\n<span class=\"w\">    </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">c'</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"n\">c'</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">if2</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}:</span>\n<span class=\"w\">    </span><span class=\"n\">t</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">if3</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">f'</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}:</span>\n<span class=\"w\">    </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">f'</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">f'</span><span class=\"o\">)</span>\n\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Ty</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">Nat</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}:</span>\n<span class=\"w\">    </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">Nat</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m1</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}:</span>\n<span class=\"w\">    </span><span class=\"n\">m1</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">m2</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">m1</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">Nat</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">true</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">Bool</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">false</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">Bool</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">T</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Ty</span><span class=\"o\">}:</span>\n<span class=\"w\">    </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">Bool</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">t</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"n\">T</span>\n</code></pre></div>\n<p>I want to prove that the types are preserved after each computation step.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Ty</span><span class=\"bp\">.</span><span class=\"n\">preserve</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">m'</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">T</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Ty</span><span class=\"o\">}:</span>\n<span class=\"w\">  </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span>\n<span class=\"w\">  </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">m'</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span>\n<span class=\"w\">  </span><span class=\"n\">m'</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"n\">T</span>\n<span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">Ht</span><span class=\"w\"> </span><span class=\"n\">Hstep</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">generalizing</span><span class=\"w\"> </span><span class=\"n\">m'</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Hstep</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">IH</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Ht</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Hstep</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">constructor</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span>\n<span class=\"w\">        </span><span class=\"n\">solve_by_elim</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">m1</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"w\"> </span><span class=\"n\">IH1</span><span class=\"w\"> </span><span class=\"n\">IH2</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Ht</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Hstep</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zeroAdd</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">solve_by_elim</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succAdd</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">next</span><span class=\"w\"> </span><span class=\"n\">Ht</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Ht</span>\n<span class=\"w\">      </span><span class=\"c1\">-- solve_by_elim</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"bp\">.</span><span class=\"n\">succ</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"bp\">.</span><span class=\"n\">add</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">assumption</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">assumption</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">add1</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">add2</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">constructor</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span>\n<span class=\"w\">        </span><span class=\"n\">solve_by_elim</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"n\">m1</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"w\"> </span><span class=\"n\">m3</span><span class=\"w\"> </span><span class=\"n\">IH1</span><span class=\"w\"> </span><span class=\"n\">IH2</span><span class=\"w\"> </span><span class=\"n\">IH3</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Ht</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Hstep</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ifTrue</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">solve_by_elim</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ifFalse</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">solve_by_elim</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">if1</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">if2</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">if3</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">constructor</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span>\n<span class=\"w\">        </span><span class=\"n\">solve_by_elim</span>\n</code></pre></div>\n<p>You may have observed that those computation rules (<code>Tm.step</code>) are split into two cases:</p>\n<ol>\n<li>The real computation rules like <code>zeroAdd</code>, <code>succAdd</code>, <code>ifTrue</code>, <code>ifFalse</code>;</li>\n<li>And the compatibility rules that make the equivalence closure of <code>Tm.step</code> a congruence relation, i.e. <code>succ</code>, <code>add1</code>, <code>add2</code>, <code>if1</code>, <code>if2</code>, <code>if3</code>.</li>\n</ol>\n<p>When I proved <code>Ty.preserve</code>, I did the induction on <code>m</code>, and in each case of the induction, I took the inversion of <code>step</code>. Then, for each possible case of <code>step</code>, I did the corresponding proof. Of course, those cases of <code>step</code> split into two situations:</p>\n<ol>\n<li>They are some real computation rules;</li>\n<li>They are some compatibility rules.</li>\n</ol>\n<p>The core of the proof is to satisfy those computation rules, while for the compatibility rules, the theorem follows naturally from the constructors and other (inductive) hypotheses. So, they are proved by <code>constructor &lt;;&gt; solve_by_elim</code>.</p>\n<p>My question is how I can reduce those repeated <code>constructor &lt;;&gt; solve_by_elim</code>. I only want to focus on the computational rules. In my real case, the repeated tactics are relatively long. I hope not to repeat them.<br>\nYou can find my code <a href=\"https://live.lean-lang.org/#codez=FASwdgJgrgxgLiAbgUwAQBUCeAuDmAOaA7gBbIBOywqqAPqgHICGcdqAQgPacA2w/4aPCRp0AW1xZCqUhSo16ALwqdJY6mwDOsGGtQBaAHwZ1C1EwgQ9RkwePiN9OOSjI1j1ADMmPTW5MeIHD+4na2NqER6gKQsAgoJgB0msH41vZiYQAK5Jz4MmSUHsq5AIKWqADeYgBMagC+uAAU4okWEKiJJZyotQCUyam9NR7aMDDlHdUAjMMNza3tvdPJOsMDKcj5TWIrS/2r46Nr1b0A5PO9g1vnYWKHMNf5YmcPHu2zM8tncyaNy09vmEdnsKgdNttdq99jU+u9LDUqrthsMLn9cLVAbUfjYQW0wbDAXiYWc4WYQJ50C40JVWJ55hoaC17kE0IlnK5UHSNkM4IFPAAxHx+Kp0hk0JmtVmdby+NDcwGefmfGCoGA/MXoxlqwHquza5mJaWqhUQ1CG40arxktgUxGVE1cn70rUSrmAuA4wwGqXBNVc61E31oE3Om30CkAZiqjs8XjR4ka2s8iq9PpZftjPJuFszAc8pP4oFiwgSrRITE0AH04AQQpkIphsrl8rIimZumouipEhXq7XpIlmHyzGNVdVxRL7n2a3XOsP9W77mPe5XZ4Ph/CpsjapOaLtV/250OWIupzVD+u2QujAaDzCBjOB9eWB4OfX2dTL8/OlxeB5ZT8LtAOQb9jz/PhyT9B18waKp0EkTAkzdR4n3A7geDPGg4DA6R0CwrxcNEAjcxDfNHzXH90CLOAyE4ShMiwRJ8EoPxyASU4XjgyoELwZCrjQvCz2XIYXmE15BNEYBsAAXlQAAjTANHAZwegACVYNSIWUksEE4MBelQABzZAwAoHwQEUcAjNufCiCCEhihUNh3zYEDUBk70UMrZBNFQLTUmOcZUAMgBJNSPK8iUYB8vyNO1GK/Dis17No7V6DHSLtRoGB9JSFx4Ho1AAB4AG4ordGhNF4FAq0UqtkB4EBTDYfZZlqVBwtmcLEU8hLYv8kdooGgKblSxy3SUFRJiyyrUGqnhavqxrmvS+adBmvq5rMgAPTTWC2yrEt8wbsoMfR5pq5A6swBqmpat0mHwfAeCbctKLrN45qel63unD7CHxCAzsScxNG0MR8D0sAQbBiGoZAfS1o+VqEVmo68o5QryBK8qzqqq6bru1aoLQHdETEaMus6tTEXC6NDpykahqZpL/JShy1opKlOUZiUFqW26Voe21BWFNA+YJxbruW+6uc8WYI08RElYZirosxgq4CKsr1bdAWZaFuWaCAA\">here</a>.</p>",
        "id": 541524382,
        "sender_full_name": "xiao",
        "timestamp": 1758826041
    },
    {
        "content": "<p>Why not simply do induction on <code>Hstep</code>?</p>",
        "id": 541528093,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1758827327
    },
    {
        "content": "<p>I think you are correct for this case. I can certainly do induction on <code>Hstep</code>. But, is there any general answer on that? I am not sure whether I will encounter the same case while I cannot do the induction on the inner one.</p>",
        "id": 541568566,
        "sender_full_name": "xiao",
        "timestamp": 1758850348
    },
    {
        "content": "<p>I mean, you can also just</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Ty</span><span class=\"bp\">.</span><span class=\"n\">preserve</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">m'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Ty</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ht</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Hstep</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">m'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">m'</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">generalizing</span><span class=\"w\"> </span><span class=\"n\">m'</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">grind</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 541621888,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1758878425
    },
    {
        "content": "<p>Or well</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Ty</span><span class=\"bp\">.</span><span class=\"n\">preserve</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">m'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Ty</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Ht</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Hstep</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">m'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">m'</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">Hstep</span><span class=\"w\"> </span><span class=\"n\">generalizing</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">grind</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 541622047,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1758878477
    },
    {
        "content": "<p>Well, still thank you. I am not seeking for a shorter solution for this specific example, but in general, how to reduce the replication. Here's the <a href=\"https://softwarefoundations.cis.upenn.edu/plf-current/References.html#STLCRef.preservation\">real case</a>. Maybe the replication is inevitable.</p>",
        "id": 541729974,
        "sender_full_name": "xiao",
        "timestamp": 1758913628
    },
    {
        "content": "<p>Hmm I'm still not quite sure what you are looking for, is it something like this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">first</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">constructor</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">solve_by_elim</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">solve_by_elim</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">skip</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"bp\">...</span>\n</code></pre></div>\n<p>That way, all the cases that can be solved by <code>constructor &lt;;&gt; solve_by_elim</code> or <code>solve_by_elim</code> can be omitted</p>",
        "id": 541735006,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1758915891
    },
    {
        "content": "<p>I think <code>first | constructor &lt;;&gt; solve_by_elim | skip</code> is something I want. Thank you.</p>\n<p>In case <code>| add</code> and <code>| ite</code>, I don't want to <code>| zeroAdd</code>, <code>| succAdd</code>, <code>ifTrue</code>, <code>ifFalse</code> to be solved, because they are the computation parts so I want to hand write a proof, while for the other branches, I want them to be solved automatically by some common tactics.</p>\n<p>For example, something like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">generalizing</span><span class=\"w\"> </span><span class=\"n\">m'</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"o\">(</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Ht</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"n\">Hstep</span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span>\n<span class=\"w\">        </span><span class=\"n\">constructor</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span>\n<span class=\"w\">          </span><span class=\"n\">solve_by_elim</span>\n<span class=\"w\">  </span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">m1</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"w\"> </span><span class=\"n\">IH1</span><span class=\"w\"> </span><span class=\"n\">IH2</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Hstep</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zeroAdd</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">solve_by_elim</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succAdd</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">next</span><span class=\"w\"> </span><span class=\"n\">Ht</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Ht</span>\n<span class=\"w\">      </span><span class=\"c1\">-- solve_by_elim</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"bp\">.</span><span class=\"n\">succ</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"bp\">.</span><span class=\"n\">add</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">assumption</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">assumption</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"n\">m1</span><span class=\"w\"> </span><span class=\"n\">m2</span><span class=\"w\"> </span><span class=\"n\">m3</span><span class=\"w\"> </span><span class=\"n\">IH1</span><span class=\"w\"> </span><span class=\"n\">IH2</span><span class=\"w\"> </span><span class=\"n\">IH3</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Ht</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Hstep</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ifTrue</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">solve_by_elim</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ifFalse</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">solve_by_elim</span>\n</code></pre></div>\n<p>I want to preserve the cases for <code>zeroAdd</code>, <code>succAdd</code>, <code>ifTrue</code>, <code>ifFalse</code> because they are the computation parts, while I don't want to focus on <code>add1</code>, <code>add2</code>, <code>if1</code>, <code>if2</code>, <code>if3</code> because they are just the compatibility rules.</p>\n<p>Even if there exists some shorter proof for</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">next</span><span class=\"w\"> </span><span class=\"n\">Ht</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Ht</span>\n<span class=\"w\">      </span><span class=\"c1\">-- solve_by_elim</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"bp\">.</span><span class=\"n\">succ</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Tm</span><span class=\"bp\">.</span><span class=\"n\">has_type</span><span class=\"bp\">.</span><span class=\"n\">add</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">assumption</span>\n<span class=\"w\">      </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">assumption</span>\n</code></pre></div>\n<p>I still want to write this silly proof in order to show the computation process for a pedagogical purpose.</p>",
        "id": 541748048,
        "sender_full_name": "xiao",
        "timestamp": 1758922140
    },
    {
        "content": "<p>Another trick you can try: <code>refine ?h</code> names the placeholder it creates <code>h</code>, so you can access it later with <code>case h</code> and even (sometimes) reuse it in other terms by re-mentioning <code>?h</code> (though for some reason you can only do this before you close the goal it's attached to, so you need to either reorder your proof accordingly or do <code>have h := ?h</code> to 'save' it to a local variable. Similarly, <code>refine (fun x =&gt; ⟨?f, ?g⟩) ?x</code> creates three goals <code>x, f, g</code> where an opaque variable referencing <code>x</code> appears in the contexts of <code>f</code> and <code>g</code></p>",
        "id": 541760084,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1758931397
    },
    {
        "content": "<p>I see. Thank you!</p>",
        "id": 541827327,
        "sender_full_name": "xiao",
        "timestamp": 1758996910
    }
]