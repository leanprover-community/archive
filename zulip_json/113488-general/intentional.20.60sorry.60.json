[
    {
        "content": "<p>I often use <code>sorry</code> intentionally for illustrative purposes. In such cases, the warning that <code>sorry</code> is being used is obtrusive and should be removed.</p>\n<p>This can be done using the <code>#guard_msgs (drop warning) in</code> command, but all warnings will disappear and I do not want to write them every time.</p>\n<p>You could solve this by creating a new tactic that does the same thing instead of <code>sorry</code>, but there is no such tactic in the standard library, so you would have to define it yourself, which is not a desirable solution.</p>\n<ol>\n<li>\n<p>Is there a good solution?</p>\n</li>\n<li>\n<p>Also, can it be solved by tactic, but also by  (creating) an attribute?</p>\n</li>\n</ol>",
        "id": 481968034,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731423330
    },
    {
        "content": "<p><code>set_option linter.sorry false</code> might be a nice way to spell this</p>",
        "id": 481968355,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731423422
    },
    {
        "content": "<blockquote>\n<p><code>set_option linter.sorry false</code> might be a nice way to spell this</p>\n</blockquote>\n<p>Nice idea!!</p>",
        "id": 481968682,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731423497
    },
    {
        "content": "<p>Do you get a warning also if you define your own \"copy\" of sorry and use that instead?</p>",
        "id": 481968718,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1731423507
    },
    {
        "content": "<p>Some of the test files do that.</p>",
        "id": 481968741,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1731423516
    },
    {
        "content": "<p>E.g. <a href=\"https://github.com/leanprover-community/mathlib4/blob/b00c9dba4d70ab0ba583936391d41c5d5df86681/MathlibTest/ring.lean#L5\">https://github.com/leanprover-community/mathlib4/blob/b00c9dba4d70ab0ba583936391d41c5d5df86681/MathlibTest/ring.lean#L5</a></p>",
        "id": 481968872,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1731423552
    },
    {
        "content": "<p>I see no warning</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">axiom</span><span class=\"w\"> </span><span class=\"n\">anotherSorryAx</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">P</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span>\n\n<span class=\"n\">macro</span><span class=\"w\"> </span><span class=\"s2\">\"intensional_sorry\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">anotherSorryAx</span><span class=\"o\">)</span>\n\n<span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intensional_sorry</span>\n</code></pre></div>",
        "id": 481969130,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731423615
    },
    {
        "content": "<p>Would a <code>#with_sorry</code> command be more ergonomic?</p>",
        "id": 481969504,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1731423710
    },
    {
        "content": "<p>It seems strange that they have to make their own tactic every time just for this. This is because we often want to use sorry intentionally.</p>",
        "id": 481969648,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731423747
    },
    {
        "content": "<blockquote>\n<p>Would a <code>#with_sorry</code> command be more ergonomic?</p>\n</blockquote>\n<p>option would be more suitable. We already frequently use option when we want to temporarily change the behaviour of a tactic.</p>",
        "id": 481970090,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731423865
    },
    {
        "content": "<p>So something like <code>sorry +intentional</code>?</p>",
        "id": 481978239,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1731425986
    },
    {
        "content": "<p><code>sorry +not_sorry</code></p>",
        "id": 481987909,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1731428553
    },
    {
        "content": "<p>Does anyone else want this feature?</p>",
        "id": 482880439,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731864456
    },
    {
        "content": "<p>Lean and mathlib tests add this to the top of files that want silent sorries:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">axiom</span><span class=\"w\"> </span><span class=\"n\">test_sorry</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"n\">α</span>\n</code></pre></div>\n<p>then you write <code>exact test_sorry</code>. (Edit: I see Damiano already mentioned this.)</p>",
        "id": 482884955,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731868016
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"626349\">Asei Inoue</span> <a href=\"#narrow/channel/113488-general/topic/intentional.20.60sorry.60/near/481969648\">said</a>:</p>\n<blockquote>\n<p>It seems strange that they have to make their own tactic every time just for this. This is because we often want to use sorry intentionally.</p>\n</blockquote>\n<p>You'll have to justify why making it so that people can insert silent sorries into proofs is desirable in general, since writing examples with silent sorries is the uncommon case. Think about the case of mathlib: if this feature existed, we would have to have an additional linter to make sure this new kind of sorry does not exist. Currently, we can rely on <code>sorry</code> raising a warning and the linter that disallows new <code>axiom</code>s.</p>",
        "id": 482885162,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731868180
    },
    {
        "content": "<p>I think it would be useful to have a way to filter the warnings from a build to exclude the <code>sorry</code>s; if you're working on a project full of sorries, it's much harder to keep on top of deprecations if they're mixed in with hundreds of sorry warnings.</p>",
        "id": 482887274,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731869880
    },
    {
        "content": "<p><code>linter.sorry=false</code> passed on the command line in CI seems like a reasonable way to address this</p>",
        "id": 482887385,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731869951
    },
    {
        "content": "<p>Is there a way to get lake to give a warning if you use that setting? (But only once per build)</p>",
        "id": 482905245,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1731885848
    },
    {
        "content": "<p>I think the real issue is the \"hundreds of sorry warnings\" part, not the existence of the warnings themselves. If there was some kind of satiation where you don't get any more warnings of a specific kind once you have seen enough then that would solve this issue. (I have pitched this to Mac in the past but I don't think he took me up on it)</p>",
        "id": 482905372,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1731885979
    },
    {
        "content": "<p>one of the things that is missing here is to get more structured communication from lean to lake, so that lake can identify which warning is which so it can only make the noisy ones be quiet so that you can spot the others</p>",
        "id": 482905429,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1731886051
    },
    {
        "content": "<p>I think the intention of <a href=\"https://github.com/leanprover/lean4/pull/5945\">lean4#5945</a> is to help with this last point <span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span></p>",
        "id": 482905658,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731886287
    },
    {
        "content": "<p>ah so maybe this is on his agenda after all</p>",
        "id": 482905751,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1731886379
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/pull/5194\">lean4#5194</a> is also perhaps related here</p>",
        "id": 482905779,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731886429
    },
    {
        "content": "<p>(one of the bullets in the RFC is \"tag the sorry warnings\", another is the PR that Kyle just linked)</p>",
        "id": 482905793,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731886442
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> </p>\n<blockquote>\n<p>if this feature existed, we would have to have an additional linter to make sure this new kind of sorry does not exist.</p>\n</blockquote>\n<p>I wasn't aware of that. Thanks.<br>\nI think there was already a linter that warned against the use of <code>set_option</code>, so why not <code>set_option linter.sorry</code> to switch?</p>",
        "id": 482919216,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731897810
    },
    {
        "content": "<blockquote>\n<p>I think it would be useful to have a way to filter the warnings from a build to exclude the <code>sorry</code>s; if you're working on a project full of sorries, it's much harder to keep on top of deprecations if they're mixed in with hundreds of sorry warning</p>\n</blockquote>\n<p>This is close to my original motivation. I wanted to run the <code>lake build</code> with <code>--wfail</code> to make sure there were no warnings, but I was running into the problem of lots of deliberately filled in sorrys. </p>\n<p>However, aesop may use sorryAx without notice, e.g. due to aesop updates. So we don't want CI to ignore all sorry-related warnings.</p>\n<p>So for me it would be ideal if I could switch with <code>set_option linter.sorry</code>.</p>",
        "id": 482919508,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731898051
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> </p>\n<p>now <a href=\"https://github.com/leanprover/lean4/issues/5194\">https://github.com/leanprover/lean4/issues/5194</a> has been completed.</p>\n<p>Have I found a new, better way to suppress warnings caused by \"sorry\" without having to use \"#guard_msgs\" every time?</p>",
        "id": 494388782,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1737128924
    }
]