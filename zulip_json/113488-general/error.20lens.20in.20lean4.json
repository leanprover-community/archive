[
    {
        "content": "<p>error lens (<a href=\"https://marketplace.visualstudio.com/items?itemName=usernamehw.errorlens\">https://marketplace.visualstudio.com/items?itemName=usernamehw.errorlens</a>) is very popular extension in lean community.<br>\nI think it would be better lean4 extension have the feature similar to error lens.</p>",
        "id": 547022844,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1761362892
    },
    {
        "content": "<p>instead, it would be good to have extension pack</p>",
        "id": 547022881,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1761362949
    },
    {
        "content": "<p>The default functionality of ErrorLens is quite visually noisy and asking some users on their opinion about it revealed that quite a few people would prefer not to have it enabled by default (e.g. because highlighting the entire line and displaying text after it is noisy, because squishing Lean's multi-line errors into one line often isn't helpful and displaying them on multiple lines next to the text is even noisier, etc.). This is ultimately one of the reasons why we implemented <a href=\"https://github.com/leanprover-community/vscode-lean4/pull/585\">vscode-lean4#585</a> as a less visually noisy alternative catered to Lean.<br>\nIf the functionality that is provided by ErrorLens and not by our extension can't be enabled by default, I don't see much of a strong reason to duplicate it into the Lean VS Code extension.</p>",
        "id": 547050910,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1761392356
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"221921\">@Marc Huisinga</span> Thank you!!</p>",
        "id": 547050988,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1761392452
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/channel/113488-general/topic/error.20lens.20in.20lean4/near/547050910\">said</a>:</p>\n<blockquote>\n<p>The default functionality of ErrorLens is quite visually noisy and asking some users on their opinion about it revealed that quite a few people would prefer not to have it enabled by default (e.g. because highlighting the entire line and displaying text after it is noisy, because squishing Lean's multi-line errors into one line often isn't helpful and displaying them on multiple lines next to the text is even noisier, etc.). This is ultimately one of the reasons why we implemented <a href=\"https://github.com/leanprover-community/vscode-lean4/pull/585\">vscode-lean4#585</a> as a less visually noisy alternative catered to Lean.<br>\nIf the functionality that is provided by ErrorLens and not by our extension can't be enabled by default, I don't see much of a strong reason to duplicate it into the Lean VS Code extension.</p>\n</blockquote>\n<p>I use Error Lens with Lean. I love the gutter decorations, but I think if anything then the Lean extension is even visually noisier than Error Lens with its yellow squiggles which appear for almost anything.<br>\nIs there a way to turn off all yellow squiggles? (but not the red ones)<br>\nSpecifically these are very visually noisy:</p>\n<ul>\n<li><code>declaration uses 'sorry'</code></li>\n<li><code>This line exceeds the 100 character limit, please shorten it!</code></li>\n<li><code>automatically included section variable(s) unused in theorem</code></li>\n</ul>",
        "id": 547068832,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1761410284
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"933054\">@Snir Broshi</span> You’re talking about how to silence specific linter?</p>",
        "id": 547068917,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1761410406
    },
    {
        "content": "<p>No I want the lint, I just hate the visual noise</p>",
        "id": 547068933,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1761410427
    },
    {
        "content": "<p>for VSCode, there's a hard cap of 500 squiggles, so if you put 500 overlapping squiggles in one place it won't generate any more beyond that</p>",
        "id": 547069024,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1761410543
    },
    {
        "content": "<p>That would also eliminate red squiggles, which will make it hard to spot the error.<br>\nThe errors I mentioned above aren't about a specific position in the line, so a gutter icon on the line should be enough.</p>",
        "id": 547069098,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1761410667
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"933054\">Snir Broshi</span> <a href=\"#narrow/channel/113488-general/topic/error.20lens.20in.20lean4/near/547068832\">said</a>:</p>\n<blockquote>\n<p><code>This line exceeds the 100 character limit, please shorten it!</code></p>\n</blockquote>\n<p>This one is particularly annoying as it gives on the <em>whole</em> line, hiding other potentially useful warnings. Typical case is that I am removing unused lemmas in a simp call, but sometimes I remove a line break and suddenly the line is too long and all the visual info about which lemmas are unused disappears until I add the line-break back... Would it be possible to <strong>put the squiggle on the characters past the limit only</strong>?</p>",
        "id": 547074537,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1761416637
    },
    {
        "content": "<p>Or even just on the 101st character</p>",
        "id": 547075836,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1761418057
    },
    {
        "content": "<p>Ah, localising the error on a subset of the line is easy.</p>",
        "id": 547075969,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1761418200
    },
    {
        "content": "<p>Just the 101st character seems too minimal, but the interval starting at 101 would seem reasonable to me.</p>",
        "id": 547076025,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1761418257
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"933054\">Snir Broshi</span> <a href=\"#narrow/channel/113488-general/topic/error.20lens.20in.20lean4/near/547068832\">said</a>:</p>\n<blockquote>\n<p>but I think if anything then the Lean extension is even visually noisier than Error Lens with its yellow squiggles which appear for almost anything.</p>\n</blockquote>\n<p>Just to be clear: the squigglies are a default functionality of VS Code, not the Lean extension. It's one of the ways in which VS Code renders warnings provided by the extension (or rather, the language server and the elaboration code it runs, which is extensible by meta code).<br>\nBy default, the Error Lens extension will also mark every single line that has a yellow squiggly with a yellow background color and text describing the warning next to it. If your editor feels noisy with squigglies, surely it will feel even more noisy with yellow background coloring for the whole line and warning text at the end of every line, no matter how small the squiggly in that line was?</p>\n<p><span class=\"user-mention silent\" data-user-id=\"933054\">Snir Broshi</span> <a href=\"#narrow/channel/113488-general/topic/error.20lens.20in.20lean4/near/547068832\">said</a>:</p>\n<blockquote>\n<p>Is there a way to turn off all yellow squiggles? (but not the red ones)</p>\n</blockquote>\n<p>I don't think that this is a good idea in general. When there is a warning on a line, the presence of which you are made aware of by some part of the UI, then the editor should also display the specific location of that warning within the line, otherwise it is very easy to be confused for most warnings (e.g. consider a line with multiple similarly-named parameter declarations where one of them generates an unused variable warning).</p>\n<p>That said, I agree that for some specific linter warnings (like the line character limit linter of Mathlib), it might be desirable to display them everywhere <em>but</em> as a squiggly (i.e. to display them in VS Code's 'Problems' view, to have them interact correctly with the 'Go to Next Problem' command, to have them show up in the InfoView and in the gutter, etc.), but this isn't supported by VS Code because the diagnostic API inherently ties the squigglies to lots of other functionalities with no configurable middle-ground on a per-diagnostic (or even just per-diagnostic code) basis.</p>\n<p>If you really want to disable <em>all</em> warning squigglies, then to my knowledge the only way to do so is to modify your color theme and make them transparent by adding</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"nt\">\"workbench.colorCustomizations\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">  </span><span class=\"nt\">\"editorWarning.foreground\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"#00000000\"</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>to your <code>settings.json</code> in VS Code ('File' &gt; 'Preferences' &gt; 'Settings' &gt; 'Open Settings (JSON)' button in the top right).</p>\n<p><span class=\"user-mention silent\" data-user-id=\"933054\">Snir Broshi</span> <a href=\"#narrow/channel/113488-general/topic/error.20lens.20in.20lean4/near/547068832\">said</a>:</p>\n<blockquote>\n<ul>\n<li><code>This line exceeds the 100 character limit, please shorten it!</code></li>\n</ul>\n</blockquote>\n<p>This warning is generated by the style linter in Mathlib, not core.</p>",
        "id": 547081176,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1761424432
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/channel/113488-general/topic/error.20lens.20in.20lean4/near/547081176\">said</a>:</p>\n<blockquote>\n<p>It's one of the ways in which VS Code renders warnings provided by the extension (or rather, the language server and the elaboration code it runs, which is extensible by meta code).</p>\n</blockquote>\n<p>Yes I'm aware, which means that they'll disappear if Lean chooses not to report them. I understand that some people use the \"problems\" feature, but I'd like some warnings to be gutter-only.</p>\n<blockquote>\n<p>If your editor feels noisy with squigglies, surely it will feel even more noisy with yellow background coloring for the whole line and warning text at the end of every line, no matter how small the squiggly in that line was?</p>\n</blockquote>\n<p>Not for me, personally the background color is way cleaner than squigglies. I've disabled the text for these specific errors in ErrorLens's settings.</p>\n<blockquote>\n<p>When there is a warning on a line, the presence of which you are made aware of by some part of the UI, then the editor should also display the specific location of that warning within the line, otherwise it is very easy to be confused for most warnings (e.g. consider a line with multiple similarly-named parameter declarations where one of them generates an unused variable warning).</p>\n</blockquote>\n<p>I only mentioned warnings which were about the whole line/declaration.</p>\n<blockquote>\n<p>this isn't supported by VS Code because the diagnostic API inherently ties the squigglies to lots of other functionalities with no configurable middle-ground</p>\n</blockquote>\n<p>Sure but I don't want them to be reported as problems at all, so VSCode is not the blocker here</p>\n<blockquote>\n<p>If you really want to disable <em>all</em> warning squigglies</p>\n</blockquote>\n<p>I don't, but it may be worth sacrificing useful squigglies to hide the spammy ones</p>",
        "id": 547081898,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1761425382
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"933054\">Snir Broshi</span> <a href=\"#narrow/channel/113488-general/topic/error.20lens.20in.20lean4/near/547081898\">said</a>:</p>\n<blockquote>\n<p>I understand that some people use the \"problems\" feature, but I'd like some warnings to be gutter-only.</p>\n</blockquote>\n<p>You will not even be able to read the warning message if the linter warning is <em>only</em> displayed in the gutter, since VS Code unfortunately has no workable mechanism for hovers in gutter decorations. I'm also not convinced that we should have warnings in the gutter that you can't navigate to using VS Code's problem navigation commands. I'd certainly expect to be able to automatically navigate to a warning that VS Code displays to me as such using the usual keyboard shortcuts.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"933054\">Snir Broshi</span> <a href=\"#narrow/channel/113488-general/topic/error.20lens.20in.20lean4/near/547081898\">said</a>:</p>\n<blockquote>\n<p>I only mentioned warnings which were about the whole line/declaration.</p>\n</blockquote>\n<p>The paragraph you are responding to explicitly refers to the question about turning off <em>all</em> yellow squigglies.</p>",
        "id": 547082794,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1761426568
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"933054\">Snir Broshi</span> <a href=\"#narrow/channel/113488-general/topic/error.20lens.20in.20lean4/near/547068832\">said</a>:</p>\n<blockquote>\n<p>Specifically these are very visually noisy:</p>\n<ul>\n<li><code>declaration uses 'sorry'</code></li>\n<li><code>This line exceeds the 100 character limit, please shorten it!</code></li>\n<li><code>automatically included section variable(s) unused in theorem</code></li>\n</ul>\n</blockquote>\n<p>Found another example of one that bothers me often: <code>tactic does nothing</code> on <code>#check</code> in a proof</p>",
        "id": 547083052,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1761426921
    },
    {
        "content": "<p>Although these might be visually noisy, all of them other than \"declaration uses <code>sorry</code>\" are issues which should probably be fixed immediately and are probably easy to fix immediately; in my experience these are not annoying because I just fix them and then they go away.</p>\n<p>I have found <code>declaration uses 'sorry'</code> noisy in my work though, not least because I am involved in projects which are full of <code>sorry</code>s, but for those projects I switch off sorry warnings completely with</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code># Switch off warnings generated by `sorry`\nwarn.sorry = false\n</code></pre></div>\n<p>in my <code>lakefile.lean</code>.</p>",
        "id": 547083340,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1761427314
    },
    {
        "content": "<p>I think that the unused <code>#check</code> had been brought up before as well   The linter should probably ignore those, since the <code>#check</code> tactic is noisy anyway, so would not make it past mathlib's CI.</p>",
        "id": 547083352,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1761427325
    },
    {
        "content": "<p>Oh wait I have misunderstood the <code>#check</code> one  -- I thought Snir was just complaining about the unused tactic linter in general (and the fix is to delete the unused tactics). What is the issue with <code>#check</code>?</p>",
        "id": 547083409,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1761427405
    },
    {
        "content": "<p>I think that this is the <em>tactic</em> <code>#check</code>, which indeed is always unused.</p>",
        "id": 547083443,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1761427460
    },
    {
        "content": "<p>So, you get the output of <code>#check</code> and also a warning from the linter telling you that <code>#check</code> is doing nothing.</p>",
        "id": 547083507,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1761427547
    },
    {
        "content": "<p>and the warning covers up the useful info of what the <code>#check</code> tactic outputs</p>",
        "id": 547086063,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1761431075
    },
    {
        "content": "<p>can we make the unused tactic linter not lint on noisy tactics maybe</p>",
        "id": 547086085,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1761431107
    },
    {
        "content": "<p>Tried Marc's solution to hide all warning squigglies and so far I'm lovin it (though I fear missing an important warning):</p>\n<hr>\n<p>By default: <a href=\"/user_uploads/3121/IRrjGt4Z3oc00XBMb5s3dA5w/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/IRrjGt4Z3oc00XBMb5s3dA5w/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1984x182\" src=\"/user_uploads/thumbnail/3121/IRrjGt4Z3oc00XBMb5s3dA5w/image.png/840x560.webp\"></a></div><hr>\n<p>Error Lens + <code>errorLens.excludeByMessage</code> + Marc's <code>workbench.colorCustomizations</code>: <a href=\"/user_uploads/3121/HweS5hnmcXyeJ-xz-3bhTqje/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/HweS5hnmcXyeJ-xz-3bhTqje/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1984x182\" src=\"/user_uploads/thumbnail/3121/HweS5hnmcXyeJ-xz-3bhTqje/image.png/840x560.webp\"></a></div><hr>\n<blockquote>\n<p>all of them other than \"declaration uses <code>sorry</code>\" are issues which should probably be fixed immediately and are probably easy to fix immediately; in my experience these are not annoying because I just fix them and then they go away.</p>\n</blockquote>\n<p>I regularly have temporary comments that are over the limit, I'm surprised that it's not common.<br>\nAlso even when the warnings are only for a minute, such as when adding a parameter to a theorem or a lemma to a <code>simp</code>/<code>grind</code>, I still find these warnings incredibly annoying.</p>\n<p>I agree it's usually fine when it comes to <code>automatically included section variable</code>, or <code>tactic does nothing</code> on tactics other than <code>#check</code>.</p>",
        "id": 547087060,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1761432658
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/stream/113488-general/topic/error.20lens.20in.20lean4/near/547074537\">said</a>:</p>\n<blockquote>\n<p>Would it be possible to <strong>put the squiggle on the characters past the limit only</strong>?</p>\n</blockquote>\n<p><del>This linter is in mathlib, right? This feels like quite an easy PR.</del></p>\n<p><a href=\"#narrow/stream/287929-mathlib4/topic/Restrict.20longLine.20warning.20to.20exceeding.20characters/near/547081669\">https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Restrict.20longLine.20warning.20to.20exceeding.20characters/near/547081669</a></p>",
        "id": 547087145,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1761432788
    },
    {
        "content": "<p>Snir, it sounds like your complaint might lean further towards \"some mathlib linters are annoying for development\" than \"the warning UI is bad\"</p>",
        "id": 547087184,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1761432869
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/113488-general/topic/error.20lens.20in.20lean4/near/547087184\">said</a>:</p>\n<blockquote>\n<p>Snir, it sounds like your complaint might lean further towards \"some mathlib linters are annoying for development\" than \"the warning UI is bad\"</p>\n</blockquote>\n<p>Yeah but I don't want to turn them off completely, even for development. The gutter is a pretty good middle-ground for me, although the fact that it can't support hovers kinda ruins this idea.</p>\n<p>Usually when programming my preferred solution is to hide all warnings/errors on the current line, but in Lean I have many comments lines over the limit. Turning the line-limit linter off will mean I might miss long lines when opening a PR.</p>\n<p>btw <code>sorry</code>s colored in red is a great choice <span aria-label=\"handshake\" class=\"emoji emoji-1f91d\" role=\"img\" title=\"handshake\">:handshake:</span>, I don't miss the yellow squiggly on theorem names as I can easily see when a theorem uses <code>sorry</code>.</p>",
        "id": 547087548,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1761433468
    }
]