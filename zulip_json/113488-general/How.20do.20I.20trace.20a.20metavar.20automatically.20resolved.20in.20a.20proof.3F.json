[
    {
        "content": "<p>Consider the following incomplete definition and its state:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">makeSuccNTimesFunc</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin2</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin2</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin2</span><span class=\"bp\">.</span><span class=\"n\">fs</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">swap</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">makeSuccNTimesFunc</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">nn</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">mm</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"bp\">_</span>\n<span class=\"c\">/-</span><span class=\"cm\"> state:</span>\n<span class=\"cm\">case h'</span>\n<span class=\"cm\">n m : ℕ</span>\n<span class=\"cm\">a✝ : Fin2 (n + 1).succ</span>\n<span class=\"cm\">⊢ Fin2 (n.succ + m) = Fin2 ((n + 1).succ + ?mm)</span>\n\n<span class=\"cm\">case mm</span>\n<span class=\"cm\">n m : ℕ</span>\n<span class=\"cm\">⊢ ℕ</span>\n\n<span class=\"cm\">n m : ℕ</span>\n<span class=\"cm\">ha : Fin2 n.succ → Fin2 (n.succ + m)</span>\n<span class=\"cm\">⊢ Fin2 n.succ → Fin2 (n.succ + m)</span>\n</code></pre></div>\n<p>it seems using <code>convert</code> has automatically resolved the value of <code>?nn</code>. Is there a trace I could run to see what value it resolved to?</p>",
        "id": 487043937,
        "sender_full_name": "nrs",
        "timestamp": 1733762302
    },
    {
        "content": "<p>Please include your imports.</p>",
        "id": 487044372,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1733762426
    },
    {
        "content": "<p>whoops sorry, it's just Mathlib</p>",
        "id": 487044513,
        "sender_full_name": "nrs",
        "timestamp": 1733762470
    },
    {
        "content": "<p>it seems <code>set_option pp.explicit true</code> with <code>#print makeSuccNTimesFunc._unsafe_rec</code> contains the information, I believe it is <code>(@HAdd.hAdd Nat Nat Nat (@instHAdd Nat instAddNat) n (@OfNat.ofNat Nat 1 (instOfNatNat 1))).succ</code> that was inferred here? This is pretty painful to read, if anyone has suggestions it would be highly appreciated</p>",
        "id": 487052377,
        "sender_full_name": "nrs",
        "timestamp": 1733764321
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">makeSuccNTimesFunc</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin2</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin2</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin2</span><span class=\"bp\">.</span><span class=\"n\">fs</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">swap</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">makeSuccNTimesFunc</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">nn</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">mm</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">nn</span><span class=\"w\"> </span><span class=\"c1\">-- n + 1 : ℕ</span>\n</code></pre></div>",
        "id": 487053407,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1733764564
    },
    {
        "content": "<p>ahhhh so much better! thank you very much!</p>",
        "id": 487053789,
        "sender_full_name": "nrs",
        "timestamp": 1733764670
    }
]