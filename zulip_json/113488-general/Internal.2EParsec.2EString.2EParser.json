[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Std</span><span class=\"bp\">.</span><span class=\"n\">Internal</span><span class=\"bp\">.</span><span class=\"n\">Parsec</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Std</span><span class=\"bp\">.</span><span class=\"n\">Internal</span><span class=\"bp\">.</span><span class=\"n\">Parsec</span><span class=\"bp\">.</span><span class=\"n\">String</span>\n\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">DimacsHeader</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">numVars</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"w\">  </span><span class=\"n\">numClauses</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Parser</span><span class=\"bp\">.</span><span class=\"n\">dimacsHeader</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Parser</span><span class=\"w\"> </span><span class=\"n\">DimacsHeader</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">skipString</span><span class=\"w\"> </span><span class=\"s2\">\"p cnf \"</span>\n\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">numVarsStr</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">many1Chars</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">satisfy</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"bp\">.</span><span class=\"n\">isDigit</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">numVars</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">numVarsStr</span><span class=\"bp\">.</span><span class=\"n\">toNat!</span>\n\n<span class=\"w\">  </span><span class=\"n\">skipString</span><span class=\"w\"> </span><span class=\"s2\">\" \"</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">numClausesStr</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">many1Chars</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">satisfy</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"bp\">.</span><span class=\"n\">isDigit</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">numClauses</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">numClausesStr</span><span class=\"bp\">.</span><span class=\"n\">toNat!</span>\n\n<span class=\"w\">  </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">numVars</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">numClauses</span><span class=\"w\"> </span><span class=\"o\">}</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">result</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Parser</span><span class=\"bp\">.</span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">Parser</span><span class=\"bp\">.</span><span class=\"n\">dimacsHeader</span><span class=\"w\"> </span><span class=\"s2\">\"p cnf 1200 14\"</span>\n<span class=\"w\">  </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">result</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Except</span><span class=\"bp\">.</span><span class=\"n\">ok</span><span class=\"w\"> </span><span class=\"n\">header</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"numVars: {header.numVars}, numClauses: {header.numClauses}\"</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Except</span><span class=\"bp\">.</span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">err</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"Error: {err}\"</span>\n</code></pre></div>",
        "id": 547253305,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1761564744
    },
    {
        "content": "<p>Here is a code example using <code>Std.Internal.Parsec.String.Parser</code>.</p>",
        "id": 547253400,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1761564777
    },
    {
        "content": "<p>I want to use a Parser combinator in Lean and I've found <code>Std.Internal.Parsec.String.Parser</code>.<br>\nBut it is under <code>Std.Internal</code> namespace. <br>\nThis is not stable or not recommended to use by user?</p>",
        "id": 547253789,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1761564909
    },
    {
        "content": "<p>why is it placed under <code>internal</code> namespace?</p>",
        "id": 547253993,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1761564967
    },
    {
        "content": "<blockquote>\n<p>This is not stable or not recommended to use by user?</p>\n</blockquote>\n<p>Not stable and thus not recommended for serious use at the moment yes</p>",
        "id": 547256097,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1761565631
    },
    {
        "content": "<p>ok thanks</p>",
        "id": 547257517,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1761566084
    },
    {
        "content": "<p>is there plan to make it stable?</p>",
        "id": 547257663,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1761566123
    },
    {
        "content": "<p>Not in the near term. It mostly exists because we have things that need high performance parsing internally, such as the LRAT checker, but there are currently no direct plans to stabilize it.</p>",
        "id": 547258060,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1761566204
    },
    {
        "content": "<p>Thank you Henrik!</p>",
        "id": 547260558,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1761566958
    },
    {
        "content": "<p>I've been using the parser combinator library <a href=\"https://github.com/fgdorais/lean4-parser\">https://github.com/fgdorais/lean4-parser</a> a lot in my personal projects. I think it's a good alternative to <code>Std.Internal.Parsec</code></p>",
        "id": 547334897,
        "sender_full_name": "Matej Penciak",
        "timestamp": 1761585790
    },
    {
        "content": "<p>lean4-parser will be maintained in the future?</p>",
        "id": 547398059,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1761616311
    }
]