[
    {
        "content": "<p>What is the standard way to annotate function arguments and return values in Lean with Doc comments?</p>\n<p>It would be useful to be able to read the documentation when hovering over an argument, but is this difficult to achieve?</p>",
        "id": 434582559,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1713699708
    },
    {
        "content": "<p>I don‚Äôt think this is possible at all. We have markdown in doc strings, that‚Äôs about it.</p>",
        "id": 434586529,
        "sender_full_name": "Max Nowak üêâ",
        "timestamp": 1713703876
    },
    {
        "content": "<p>i was thinking about this too looking at <span class=\"user-mention\" data-user-id=\"417654\">@Martin Dvo&rcaron;&aacute;k</span>&lsquo;s code. i often wish for this <a href=\"/user_uploads/3121/eMw61PON3eMn_r6wSVvsgaAx/99808EB0-2059-403B-86D3-924B6705692C.png\">99808EB0-2059-403B-86D3-924B6705692C.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/eMw61PON3eMn_r6wSVvsgaAx/99808EB0-2059-403B-86D3-924B6705692C.png\" title=\"99808EB0-2059-403B-86D3-924B6705692C.png\"><img data-original-dimensions=\"2752x2064\" src=\"/user_uploads/thumbnail/3121/eMw61PON3eMn_r6wSVvsgaAx/99808EB0-2059-403B-86D3-924B6705692C.png/840x560.webp\"></a></div>",
        "id": 462204515,
        "sender_full_name": "Alok Singh",
        "timestamp": 1723580002
    },
    {
        "content": "<p>I found #guard_msgs has documented arguments.</p>",
        "id": 462225682,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723590420
    },
    {
        "content": "<p>To be honest, my comments on <code>extendedFarkas</code> provide little to no value for the reader. By reading the code, you get the same or better information in approximately the same time as it takes to read the comments. I might as well delete them ‚Äî just keep the docstring on the top, as it provides context.</p>",
        "id": 462280990,
        "sender_full_name": "Martin Dvo≈ô√°k",
        "timestamp": 1723620101
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"417654\">Martin Dvo≈ô√°k</span> <a href=\"#narrow/stream/113488-general/topic/docstring.20of.20function.20arguments.2Freturn.20value/near/462280990\">said</a>:</p>\n<blockquote>\n<p>To be honest, my comments on <code>extendedFarkas</code> provide little to no value for the reader. By reading the code, you get the same or better information in approximately the same time as it takes to read the comments. I might as well delete them ‚Äî just keep the docstring on the top, as it provides context.</p>\n</blockquote>\n<p>i totally disagree. the prose is much easier to read than math/code for most people. if you‚Äôre intro-ing using yourself as a generic reader, i think that‚Äôs off for figuring out what‚Äôs valuable to them. i certainly find the prose easier for the hypotheses. not for the matrix, for the bounding vector b it‚Äôs good but there i‚Äôd just call it boundingVector</p>",
        "id": 462285236,
        "sender_full_name": "Alok Singh",
        "timestamp": 1723621777
    },
    {
        "content": "<p>I also think that it is <em>really</em> rare that a comment does not provide added value.  As Alok also said: even a mere translation into natural language of what the code represents is often useful.</p>",
        "id": 462285705,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1723621968
    },
    {
        "content": "<p>But you have to remember that every comment is a maintenance burden. A docstring needs to be reviewed, kept in sync, copied over to similar lemmas...</p>",
        "id": 462286521,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1723622171
    },
    {
        "content": "<p>So, even if it's obvious that most comments add value to the reader, it's not obvious that some comments have positive value once you take into account both the reader and the library maintenance.</p>",
        "id": 462286823,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1723622250
    },
    {
        "content": "<p>With the advent of LLM-based tools, it is thinkable that trivial comment that just restate a piece of Lean code shouldn't be written and maintained in the codebase, but rather generated on demand when the user asks for it</p>",
        "id": 462286994,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1723622313
    },
    {
        "content": "<p>I would have reached the opposite conclusion: if something needs to be kept in sync, then this is a feature of a meaningful text!  <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 462287091,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1723622350
    },
    {
        "content": "<p>There certainly are low-value comments, the standard example being</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- Increment `i` by one.</span>\n<span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>\n<p>That said: if you find most of your comments on functions or definitions are low-value, I'd tend to</p>\n<ul>\n<li>wonder if the comments are as useful (are they detailed enough, keeping in mind the the right target audience?)</li>\n<li>wonder if the extra definitions are useful. (For instance, not every lemma in mathlib has a documentation string. For some lemmas, I'd argue this is fine!)</li>\n</ul>",
        "id": 462301204,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1723626937
    },
    {
        "content": "<p>In favor of argument docstrings:</p>\n<ul>\n<li>They provide a source for a tooltip when hovering over <code>(argname := _)</code></li>\n<li>They avoid us having to invent syntax inside the docstring</li>\n</ul>\n<p>And arguments against:</p>\n<ul>\n<li>They make declarations headers much more verbose, as the arguments might be hidden amidst a large body of text</li>\n<li>Sometimes arguments are best documented all at once rather than separately (\"<code>foo a b</code> is the <code>foo</code> of <code>a</code> at <code>b</code>\")</li>\n</ul>",
        "id": 462302111,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723627308
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Ya√´l Dillies</span> <a href=\"#narrow/stream/113488-general/topic/docstring.20of.20function.20arguments.2Freturn.20value/near/462286994\">said</a>:</p>\n<blockquote>\n<p>With the advent of LLM-based tools, it is thinkable that trivial comment that just restate a piece of Lean code shouldn't be written and maintained in the codebase, but rather generated on demand when the user asks for it</p>\n</blockquote>\n<p>Actually, I was having a conversation with some LLM folks not long ago that came to basically the opposite conclusion: one reason why LLMs aren't better at autoformalization and informalization is lack of parallel corpora, so paired english and lean text is actually hugely valuable to them and they wish the whole library was marked up like this.</p>",
        "id": 462380065,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1723652664
    },
    {
        "content": "<p>Not to mention that using an LLM to generate the text on demand means there is no chance for an expert reviewer to be able to catch mistakes before they are shown to the user. This is less of an issue if an LLM fills in some form which is edited by a human if necessary and then committed somewhere for retrieval by the user</p>",
        "id": 462380516,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1723652860
    },
    {
        "content": "<p>I'm all for good documentation, but I think the benefits of documenting every single value don't outweigh the inherent verbosity. In 99% of cases, understanding what the variables in a theorem are doing is no more difficult than understanding the theorem itself.</p>",
        "id": 462554412,
        "sender_full_name": "Violeta Hern√°ndez",
        "timestamp": 1723729553
    },
    {
        "content": "<p>Even in cases where you have much more bespoke arguments, e.g. complex induction proofs split into multiple lemmas, it's probably better to have a top-level comment explaining what these assumptions are and where they come from</p>",
        "id": 462554582,
        "sender_full_name": "Violeta Hern√°ndez",
        "timestamp": 1723729610
    }
]