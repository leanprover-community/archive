[
    {
        "content": "<p>I want to use Lean 4.21.0 in a new project with that version of mathlib. In a completely fresh project with the configuration below, <code>lake build</code> works:</p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>lake build output</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<p>markusde@mac myProject % lake build<br>\n<strong>info:</strong> mathlib: cloning <a href=\"https://github.com/leanprover-community/mathlib4\">https://github.com/leanprover-community/mathlib4</a><br>\n<strong>info:</strong> mathlib: checking out revision '377c35f5df452d352c03f82784efd629d4f27f41'<br>\n<strong>info:</strong> plausible: cloning <a href=\"https://github.com/leanprover-community/plausible\">https://github.com/leanprover-community/plausible</a><br>\n<strong>info:</strong> plausible: checking out revision 'c37191eba2da78393070da8c4367689d8c4276e4'<br>\n<strong>info:</strong> LeanSearchClient: cloning <a href=\"https://github.com/leanprover-community/LeanSearchClient\">https://github.com/leanprover-community/LeanSearchClient</a><br>\n<strong>info:</strong> LeanSearchClient: checking out revision '6c62474116f525d2814f0157bb468bf3a4f9f120'<br>\n<strong>info:</strong> importGraph: cloning <a href=\"https://github.com/leanprover-community/import-graph\">https://github.com/leanprover-community/import-graph</a><br>\n<strong>info:</strong> importGraph: checking out revision '4241928fd3ebae83a037a253e39d9b773e34c3b4'<br>\n<strong>info:</strong> proofwidgets: cloning <a href=\"https://github.com/leanprover-community/ProofWidgets4\">https://github.com/leanprover-community/ProofWidgets4</a><br>\n<strong>info:</strong> proofwidgets: checking out revision '96c67159f161fb6bf6ce91a2587232034ac33d7e'<br>\n<strong>info:</strong> aesop: cloning <a href=\"https://github.com/leanprover-community/aesop\">https://github.com/leanprover-community/aesop</a><br>\n<strong>info:</strong> aesop: checking out revision '0a136f764a5dfedc4498e93ad8e297cff57ba2fc'<br>\n<strong>info:</strong> Qq: cloning <a href=\"https://github.com/leanprover-community/quote4\">https://github.com/leanprover-community/quote4</a><br>\n<strong>info:</strong> Qq: checking out revision '1ef3dac0f872ca6aaa7d02e015427e06dd0b6195'<br>\n<strong>info:</strong> batteries: cloning <a href=\"https://github.com/leanprover-community/batteries\">https://github.com/leanprover-community/batteries</a><br>\n<strong>info:</strong> batteries: checking out revision 'e96b5eca4fcfe2e0e96a1511a6cd5747515aba82'<br>\n<strong>info:</strong> Cli: cloning <a href=\"https://github.com/leanprover/lean4-cli\">https://github.com/leanprover/lean4-cli</a><br>\n<strong>info:</strong> Cli: checking out revision 'c682c91d2d4dd59a7187e2ab977ac25bd1f87329'<br>\nBuild completed successfully.</p>\n</div></div>\n<p>But when I add <code>import Mathlib</code> to <code>Basic.lean</code>, I get a ton of errors:</p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>Representative error</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<p><strong>error:</strong> Lean exited with code 1<br>\n<strong>✖ [70/7017] Building Batteries.Tactic.OpenPrivate</strong><br>\n<strong>trace:</strong> .&gt; LEAN_PATH= ...  --json<br>\n<strong>error:</strong> Batteries/Tactic/OpenPrivate.lean:1:0: invalid -D parameter, unknown configuration option 'linter.unusedSimpArgs'</p>\n</div></div>\n<p>Here is my lakefile (lean-toolchain is<code>leanprover/lean4:v4.21.0</code>). Am I missing something in my configuration? </p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>lakefile.toml</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<p>name = \"myProject\"<br>\nversion = \"0.1.0\"<br>\nkeywords = [\"math\"]<br>\ndefaultTargets = [\"MyProject\"]</p>\n<p>[leanOptions]<br>\n<a href=\"http://pp.unicode.fun\">pp.unicode.fun</a> = true # pretty-prints <code>fun a ↦ b</code><br>\nautoImplicit = false</p>\n<p>[[require]]<br>\nname = \"mathlib\"<br>\nversion = \"4.21.0\"<br>\nscope = \"leanprover-community\"</p>\n<p>[[lean_lib]]<br>\nname = \"myProject\"</p>\n</div></div>",
        "id": 531047963,
        "sender_full_name": "Markus de Medeiros",
        "timestamp": 1753585140
    },
    {
        "content": "<p>Change \"version\" to \"rev\" in the require block.</p>",
        "id": 531048240,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1753585254
    },
    {
        "content": "<p>This did not fix it, and the errors are the same. I even deleted my <code>.lake/</code> directory and ran <code>lake build</code> again to be sure.</p>",
        "id": 531048930,
        "sender_full_name": "Markus de Medeiros",
        "timestamp": 1753585564
    },
    {
        "content": "<p>Is there a repository we could clone to observe the problem?</p>",
        "id": 531049011,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1753585598
    },
    {
        "content": "<p>It is a completely new project but I could put it on github if that would help</p>",
        "id": 531049090,
        "sender_full_name": "Markus de Medeiros",
        "timestamp": 1753585628
    },
    {
        "content": "<p><a href=\"https://github.com/markusdemedeiros/IrisLeanMath\">https://github.com/markusdemedeiros/IrisLeanMath</a></p>",
        "id": 531049247,
        "sender_full_name": "Markus de Medeiros",
        "timestamp": 1753585711
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"721721\">@Markus de Medeiros</span> Did you run <code>lake update</code> after changing <code>version</code> to <code>rev</code>?</p>",
        "id": 531049355,
        "sender_full_name": "Mac Malone",
        "timestamp": 1753585761
    },
    {
        "content": "<p>I didn't! Thanks, let me try.</p>",
        "id": 531049475,
        "sender_full_name": "Markus de Medeiros",
        "timestamp": 1753585815
    },
    {
        "content": "<p>Yep, it works now, thanks Kim and Mac! I also had to change the rev to \"v4.21.0\".</p>",
        "id": 531049747,
        "sender_full_name": "Markus de Medeiros",
        "timestamp": 1753585942
    },
    {
        "content": "<p>Could you please upvote <a href=\"https://github.com/leanprover/lean4/issues/6482\">https://github.com/leanprover/lean4/issues/6482</a> if you think this is a completely unnecessary trap for new users?</p>",
        "id": 531125954,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1753617436
    }
]