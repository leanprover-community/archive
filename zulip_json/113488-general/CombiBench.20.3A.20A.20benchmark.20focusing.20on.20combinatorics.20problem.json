[
    {
        "content": "<p>Glad to share the new work from our Kimina team! We have released the first Benchmark focusing on formalized mathematics in combinatorics ‚Äî‚Äî CombiBench, and for the first time, proposed an Evaluation method for fill-in-the-blank questions ‚Äî‚Äî Fine-Eval! We have open-sourced the complete datasets with and without solutions, as well as one-click Evaluation code that can be used with Kimina Lean Server!</p>\n<p>Github:<a href=\"https://github.com/MoonshotAI/CombiBench\">https://github.com/MoonshotAI/CombiBench</a><br>\nHuggingface:<a href=\"https://huggingface.co/datasets/AI-MO/CombiBench\">https://huggingface.co/datasets/AI-MO/CombiBench</a><br>\nWebsite:<a href=\"https://moonshotai.github.io/CombiBench\">https://moonshotai.github.io/CombiBench</a><br>\nLeaderBoard:<a href=\"https://moonshotai.github.io/CombiBench/leaderboard.html\">https://moonshotai.github.io/CombiBench/leaderboard.html</a></p>",
        "id": 514856740,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1745857696
    },
    {
        "content": "<p>Can you remind me how moonshot AI and Numini are related?  Is moonshot = Kimina = Numina + Kimi ?</p>",
        "id": 514899099,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745872486
    },
    {
        "content": "<p><a href=\"https://kimi.moonshot.cn/\">Kimi</a> is product of Moonshot (the company), and Kimi Team (coauthor of Kimina) is presumably the team working on the product, as I understand it.</p>",
        "id": 514903947,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1745874380
    },
    {
        "content": "<p>\"Without solution\" means the model has to give the solution and a formal proof?  What we sometimes call \"hard mode\"?  Is that correct?  Or do I have it backward (or totally wrong)?</p>",
        "id": 514911726,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745877891
    },
    {
        "content": "<p>Also the Leaderboard is really hard to read on a mobile device.</p>",
        "id": 514911754,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745877912
    },
    {
        "content": "<p>It looks like a nice benchmark overall.</p>",
        "id": 514912139,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745878133
    },
    {
        "content": "<p>I‚Äôd be curious what quality control you did to sure there are no mistakes in translation.  This is one of the largest issues with making these formal benchmarks.  All the standard benchmarks when first released had a lot of mistakes (and many still do).  This often makes the problems either impossible or trivial.</p>",
        "id": 514912361,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745878240
    },
    {
        "content": "<p>I am also curious about this: so far I have looked at three of the problems, and two out of the three had obvious mistakes (of the form Jason mentions). <br>\nIt's a small sample size, but given past problems with benchmarks, this makes me not at all optimistic about this one.</p>",
        "id": 514912836,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1745878526
    },
    {
        "content": "<blockquote>\n<p>for the first time, proposed an Evaluation method for fill-in-the-blank questions ‚Äî‚Äî Fine-Eval!</p>\n</blockquote>\n<p>Am I right in assuming that the dataset format for such questions is exactly that of PutnamBench?</p>",
        "id": 514913455,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1745878840
    },
    {
        "content": "<p>From their README: \"For problems that require providing a solution first and then proving its correctness, we have referred to the style of PutnamBench.\"</p>",
        "id": 514913515,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1745878879
    },
    {
        "content": "<p>Also I‚Äôd be curious what <span class=\"user-mention\" data-user-id=\"266253\">@Joseph Myers</span> thinks both in terms of correctness and style.  He has strong opinions on how competition problems should be formalized.</p>",
        "id": 514913879,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745879045
    },
    {
        "content": "<p>Also, besides errors and style, I have a checklist of things to think about when making a Lean benchmark: <a class=\"message-link\" href=\"/#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/Lean-based.20advanced.20mathematics.20benchmark/near/512421045\">#Machine Learning for Theorem Proving &gt; Lean-based advanced mathematics benchmark @ üí¨</a></p>",
        "id": 514914472,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745879341
    },
    {
        "content": "<p>From the README:</p>\n<blockquote>\n<p>It is released under permissive licenses Apache 2.0 for Lean 4.</p>\n</blockquote>\n<p>The <code>LICENSE</code> file says it is MIT-licensed. Which is correct?</p>",
        "id": 514915747,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1745880038
    },
    {
        "content": "<p><a href=\"https://github.com/MoonshotAI/CombiBench/blob/master/docs/README.md\">https://github.com/MoonshotAI/CombiBench/blob/master/docs/README.md</a> also looks out of place</p>",
        "id": 514915844,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1745880089
    },
    {
        "content": "<p>I notice some overlap between the contents of Compfiles and this repository, in fact some code appears to be directly copied from there without attribution. Compare, for instance:<br>\nfrom Compfiles:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- A cell on the board for the game. -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">√ó</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n\n<span class=\"sd\">/-- A row that is neither the first nor the last (and thus contains a monster). -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">InteriorRow</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Icc</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">omega</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)))</span>\n\n<span class=\"sd\">/-- Data for valid positions of the monsters. -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">InteriorRow</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">‚Ü™</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n\n<span class=\"sd\">/-- The cells with monsters as a Set, given an injection from rows to columns. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"bp\">.</span><span class=\"n\">monsterCells</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">InteriorRow</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)),</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">))</span>\n\n<span class=\"sd\">/-- Whether two cells are adjacent. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Adjacent</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">dist</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">dist</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"sd\">/-- A valid path from the first to the last row. -/</span>\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The cells on the path. -/</span>\n<span class=\"w\">  </span><span class=\"n\">cells</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">nonempty</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cells</span><span class=\"w\"> </span><span class=\"bp\">‚â†</span><span class=\"w\"> </span><span class=\"o\">[]</span>\n<span class=\"w\">  </span><span class=\"n\">head_first_row</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">head</span><span class=\"w\"> </span><span class=\"n\">nonempty</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">  </span><span class=\"n\">last_last_row</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">getLast</span><span class=\"w\"> </span><span class=\"n\">nonempty</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"n\">valid_move_seq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">Chain'</span><span class=\"w\"> </span><span class=\"n\">Adjacent</span>\n\n<span class=\"sd\">/-- The first monster on a path, or `none`. -/</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"bp\">.</span><span class=\"n\">firstMonster</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">letI</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">propDecidable</span>\n<span class=\"w\">  </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">find?</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">monsterCells</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"o\">))</span>\n\n<span class=\"sd\">/-- A strategy, given the results of initial attempts, returns a path for the next attempt. -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Strategy</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">N</span>\n\n<span class=\"sd\">/-- Playing a strategy, k attempts. -/</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Strategy</span><span class=\"bp\">.</span><span class=\"n\">play</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Strategy</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">elim0</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">snoc</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">play</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">play</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">firstMonster</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>with, from the \"new\" benchmark:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- A cell on the board for the game.</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">√ó</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n\n<span class=\"c1\">-- A row that is neither the first nor the last (and thus contains a monster).</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">InteriorRow</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Icc</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">omega</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)))</span>\n\n<span class=\"c1\">-- Data for valid positions of the monsters.</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">InteriorRow</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">‚Ü™</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n\n<span class=\"c1\">-- The cells with monsters as a Set, given an injection from rows to columns.</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"bp\">.</span><span class=\"n\">monsterCells</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">N</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">InteriorRow</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)),</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">))</span>\n\n<span class=\"c1\">-- Whether two cells are adjacent.</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Adjacent</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">N</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">dist</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">dist</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"c1\">-- A valid path from the first to the last row.</span>\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"c1\">-- The cells on the path.</span>\n<span class=\"w\">  </span><span class=\"n\">cells</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">nonempty</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cells</span><span class=\"w\"> </span><span class=\"bp\">‚â†</span><span class=\"w\"> </span><span class=\"o\">[]</span>\n<span class=\"w\">  </span><span class=\"n\">head_first_row</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">head</span><span class=\"w\"> </span><span class=\"n\">nonempty</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">  </span><span class=\"n\">last_last_row</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">getLast</span><span class=\"w\"> </span><span class=\"n\">nonempty</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"n\">valid_move_seq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">Chain'</span><span class=\"w\"> </span><span class=\"n\">Adjacent</span>\n\n<span class=\"c1\">-- The first monster on a path, or `none`.</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"bp\">.</span><span class=\"n\">firstMonster</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">N</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">letI</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">propDecidable</span>\n<span class=\"w\">  </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">find?</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">monsterCells</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"o\">))</span>\n\n<span class=\"c1\">-- A strategy, given the results of initial attempts, returns a path for the next attempt.</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Strategy</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">N</span>\n\n<span class=\"c1\">-- Playing a strategy, k attempts.</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Strategy</span><span class=\"bp\">.</span><span class=\"n\">play</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">N</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Strategy</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">elim0</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">snoc</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">play</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">play</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">firstMonster</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 514918639,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1745881604
    },
    {
        "content": "<p>Thank you all for pointing out these errors! We will correct them ASAP. And you are all welcome to make pull requests too. We believe community effort is key for constructing a reliable benchmark consisting of only formal statement like this one. It's really not easy. We made sure that every problem is reviewed by at least two reviewers before the release but errors are still very hard to avoid...</p>",
        "id": 514926066,
        "sender_full_name": "Zhengying Liu",
        "timestamp": 1745885884
    },
    {
        "content": "<p>Could you share the exact location of these errors? We'll correct them ASAP. Thank you! <span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span> </p>\n<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514912836\">said</a>:</p>\n<blockquote>\n<p>I am also curious about this: so far I have looked at three of the problems, and two out of the three had obvious mistakes (of the form Jason mentions). <br>\nIt's a small sample size, but given past problems with benchmarks, this makes me not at all optimistic about this one.</p>\n</blockquote>",
        "id": 514926365,
        "sender_full_name": "Zhengying Liu",
        "timestamp": 1745886062
    },
    {
        "content": "<p>I like the choice to use plenty of external <code>def</code>s and types rather than trying to force everything into a single statement to be proved (which gets very awkward for many combinatorics problems), at least.</p>",
        "id": 514929765,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745888214
    },
    {
        "content": "<p>I looked at a few examples of problems I described in the IMOLean README as technically geometrical (that is, combinatorics problems where a literal reading of the original English statement uses geometrical concepts and you can plausibly argue whether than should be retained in a formal statement or whether the formal statement should be purely combinatorial).</p>",
        "id": 514929914,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745888312
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"398687\">Zhengying Liu</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514926365\">said</a>:</p>\n<blockquote>\n<p>Could you share the exact location of these errors?</p>\n</blockquote>\n<p>No, I am not prepared to do unpaid work for an AI company.</p>",
        "id": 514929990,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1745888386
    },
    {
        "content": "<p>For IMO 2018 P4, the formal statement reflects the geometrical formulation in terms of a distance of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msqrt><mn>5</mn></msqrt></mrow><annotation encoding=\"application/x-tex\">\\sqrt{5}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.1328em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9072em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">5</span></span></span><span style=\"top:-2.8672em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1328em;\"><span></span></span></span></span></span></span></span></span> (not present in the version in the IMO 2018 shortlist; the problem was reformulated after selection to avoid dependence on knowing what a knight's move is). But I think that formal statement gets the geometrical formulation wrong for a well-known reason: <code>‚Ñù √ó ‚Ñù</code> does not have the Euclidean metric. IMO 2017 P3 looks like it has the same problem with the wrong metric. For IMOLean my conventions explicitly say to use <code>EuclideanSpace ‚Ñù (Fin 2)</code> (which has the right metric) for problems involving coordinates.</p>",
        "id": 514930465,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745888667
    },
    {
        "content": "<p>IMO 2013 P6 is another technically geometrical problem I looked at as an example, where the geometry in the statement is about points on a circle and intersections of chords between those points. Without attempting to assess whether the proposed statement is correct, I'd say that if you want to use non-geometrical statements for such problems (where the only geometry is about orderings of points in a cyclic ordering described in terms of whether chords intersect), surely you should first add appropriate definitions to mathlib for whether four points in a <code>CircularOrder</code> correspond to non-intersecting chords or not; there must be a better way to express that than the very long <code>IsBeautiful</code> definition in that statement.</p>",
        "id": 514931040,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745889061
    },
    {
        "content": "<p>As another example (not geometrical), the formal statement for IMO 2022 P1 is very different in style from my statement for that problem. Again without trying to assess whether it's correct, the formal statement you have is rather heavy on computable functions defined imperatively with <code>do</code>, which is not what I'd expect; the ability to prove things about such function definitions may not have much to do with the ability to prove things about more usual styles of mathematical problem statements, and such function definitions would be more common in Lean code that is intended to be executed than in definitions that are the subjects of proofs. (And while I suggest that AIs not be presented with doc strings about the correspondence between formal and informal statements when given problems to solve, I <em>do</em> suggest that formal statements be written with such doc strings on their definitions for the benefit of humans trying to judge correctness - just that the doc strings should be removed before giving the problems to an AI.)</p>",
        "id": 514931784,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745889506
    },
    {
        "content": "<p>I have explicitly not looked for other examples of problem statements that use the wrong metric, or any of the other well-known pitfalls in writing formal problem statements.</p>",
        "id": 514931998,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745889621
    },
    {
        "content": "<p>I think incidentally that the antonym of \"easy mode\" should be \"standard mode\" not \"hard mode\" (it's asking an AI to do the same things a human is asked for - find an answer and prove it correct).</p>",
        "id": 514932518,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745889962
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514918639\">said</a>:</p>\n<blockquote>\n<p>I notice some overlap between the contents of Compfiles and this repository, in fact some code appears to be directly copied from there without attribution. Compare, for instance:<br>\nfrom Compfiles:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- A cell on the board for the game. -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">√ó</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n\n<span class=\"sd\">/-- A row that is neither the first nor the last (and thus contains a monster). -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">InteriorRow</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Icc</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">omega</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)))</span>\n\n<span class=\"sd\">/-- Data for valid positions of the monsters. -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">InteriorRow</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">‚Ü™</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n\n<span class=\"sd\">/-- The cells with monsters as a Set, given an injection from rows to columns. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"bp\">.</span><span class=\"n\">monsterCells</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">InteriorRow</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)),</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">))</span>\n\n<span class=\"sd\">/-- Whether two cells are adjacent. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Adjacent</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">dist</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">dist</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"sd\">/-- A valid path from the first to the last row. -/</span>\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The cells on the path. -/</span>\n<span class=\"w\">  </span><span class=\"n\">cells</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">nonempty</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cells</span><span class=\"w\"> </span><span class=\"bp\">‚â†</span><span class=\"w\"> </span><span class=\"o\">[]</span>\n<span class=\"w\">  </span><span class=\"n\">head_first_row</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">head</span><span class=\"w\"> </span><span class=\"n\">nonempty</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">  </span><span class=\"n\">last_last_row</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">getLast</span><span class=\"w\"> </span><span class=\"n\">nonempty</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"n\">valid_move_seq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">Chain'</span><span class=\"w\"> </span><span class=\"n\">Adjacent</span>\n\n<span class=\"sd\">/-- The first monster on a path, or `none`. -/</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"bp\">.</span><span class=\"n\">firstMonster</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">letI</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">propDecidable</span>\n<span class=\"w\">  </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">find?</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">monsterCells</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"o\">))</span>\n\n<span class=\"sd\">/-- A strategy, given the results of initial attempts, returns a path for the next attempt. -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Strategy</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">N</span>\n\n<span class=\"sd\">/-- Playing a strategy, k attempts. -/</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Strategy</span><span class=\"bp\">.</span><span class=\"n\">play</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Strategy</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">elim0</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">snoc</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">play</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">play</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">firstMonster</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>with, from the \"new\" benchmark:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- A cell on the board for the game.</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">√ó</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n\n<span class=\"c1\">-- A row that is neither the first nor the last (and thus contains a monster).</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">InteriorRow</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Icc</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">omega</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)))</span>\n\n<span class=\"c1\">-- Data for valid positions of the monsters.</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">InteriorRow</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">‚Ü™</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n\n<span class=\"c1\">-- The cells with monsters as a Set, given an injection from rows to columns.</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"bp\">.</span><span class=\"n\">monsterCells</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">N</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">InteriorRow</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)),</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">))</span>\n\n<span class=\"c1\">-- Whether two cells are adjacent.</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Adjacent</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">N</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">dist</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">dist</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"c1\">-- A valid path from the first to the last row.</span>\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"c1\">-- The cells on the path.</span>\n<span class=\"w\">  </span><span class=\"n\">cells</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">nonempty</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cells</span><span class=\"w\"> </span><span class=\"bp\">‚â†</span><span class=\"w\"> </span><span class=\"o\">[]</span>\n<span class=\"w\">  </span><span class=\"n\">head_first_row</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">head</span><span class=\"w\"> </span><span class=\"n\">nonempty</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">  </span><span class=\"n\">last_last_row</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">getLast</span><span class=\"w\"> </span><span class=\"n\">nonempty</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"n\">valid_move_seq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">Chain'</span><span class=\"w\"> </span><span class=\"n\">Adjacent</span>\n\n<span class=\"c1\">-- The first monster on a path, or `none`.</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"bp\">.</span><span class=\"n\">firstMonster</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">N</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">letI</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">propDecidable</span>\n<span class=\"w\">  </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">cells</span><span class=\"bp\">.</span><span class=\"n\">find?</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">monsterCells</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"o\">))</span>\n\n<span class=\"c1\">-- A strategy, given the results of initial attempts, returns a path for the next attempt.</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Strategy</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">‚¶É</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">‚¶Ñ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Path</span><span class=\"w\"> </span><span class=\"n\">N</span>\n\n<span class=\"c1\">-- Playing a strategy, k attempts.</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Strategy</span><span class=\"bp\">.</span><span class=\"n\">play</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">N</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Strategy</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonsterData</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cell</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">elim0</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">snoc</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">play</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">play</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">firstMonster</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>This is already in Archive. We point out this in the paper: <br>\n<a href=\"/user_uploads/3121/-pqWRGOjR7gBbDYOiSpeL0dh/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/-pqWRGOjR7gBbDYOiSpeL0dh/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1496x134\" src=\"/user_uploads/thumbnail/3121/-pqWRGOjR7gBbDYOiSpeL0dh/image.png/840x560.webp\"></a></div>",
        "id": 514932909,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1745890150
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514918639\">said</a>:</p>\n<blockquote>\n<p>I notice some overlap between the contents of Compfiles and this repository, in fact some code appears to be directly copied from there without attribution. </p>\n</blockquote>\n<p>Compfiles imported that problem (<a href=\"https://dwrensha.github.io/compfiles/problems/Compfiles.Imo2024P5.html\">2024P5</a>) from <a href=\"https://github.com/leanprover-community/mathlib4/blob/master/Archive/Imo/Imo2024Q5.lean\"><code>mathlib4/Archive</code></a>. Let me know if there's something I could be doing to make the attribution more clear.</p>",
        "id": 514932950,
        "sender_full_name": "David Renshaw",
        "timestamp": 1745890173
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514915844\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://github.com/MoonshotAI/CombiBench/blob/master/docs/README.md\">https://github.com/MoonshotAI/CombiBench/blob/master/docs/README.md</a> also looks out of place</p>\n</blockquote>\n<p>Sorry, this is fixed!</p>",
        "id": 514933526,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1745890541
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243791\">David Renshaw</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514932950\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514918639\">said</a>:</p>\n<blockquote>\n<p>I notice some overlap between the contents of Compfiles and this repository, in fact some code appears to be directly copied from there without attribution. </p>\n</blockquote>\n<p>Compfiles imported that problem (<a href=\"https://dwrensha.github.io/compfiles/problems/Compfiles.Imo2024P5.html\">2024P5</a>) from <a href=\"https://github.com/leanprover-community/mathlib4/blob/master/Archive/Imo/Imo2024Q5.lean\"><code>mathlib4/Archive</code></a>. Let me know if there's something I could be doing to make the attribution more clear.</p>\n</blockquote>\n<p>Ah, I misunderstood the order that these were done in - this is clear in Compfiles. However, I think CombiBench should make this clearer in the dataset, rather than burying the attribution in the paper and putting \"new work\" in the announcement.</p>",
        "id": 514933847,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1745890767
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"266253\">Joseph Myers</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514931040\">said</a>:</p>\n<blockquote>\n<p>IMO 2013 P6 is another technically geometrical problem I looked at as an example, where the geometry in the statement is about points on a circle and intersections of chords between those points. Without attempting to assess whether the proposed statement is correct, I'd say that if you want to use non-geometrical statements for such problems (where the only geometry is about orderings of points in a cyclic ordering described in terms of whether chords intersect), surely you should first add appropriate definitions to mathlib for whether four points in a <code>CircularOrder</code> correspond to non-intersecting chords or not; there must be a better way to express that than the very long <code>IsBeautiful</code> definition in that statement.</p>\n</blockquote>\n<p>Thank you for your suggestion. We hope to get some feedback on our current formalized definitions. The definitions we used in the process of completing CombiBench will be gradually contributed to mathlib through a theorem library in the future. We will also continuously adjust the statements of our CombiBench in this process.</p>",
        "id": 514934387,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1745891120
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"266253\">Joseph Myers</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514930465\">said</a>:</p>\n<blockquote>\n<p>For IMO 2018 P4, the formal statement reflects the geometrical formulation in terms of a distance of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msqrt><mn>5</mn></msqrt></mrow><annotation encoding=\"application/x-tex\">\\sqrt{5}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.1328em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9072em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">5</span></span></span><span style=\"top:-2.8672em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1328em;\"><span></span></span></span></span></span></span></span></span> (not present in the version in the IMO 2018 shortlist; the problem was reformulated after selection to avoid dependence on knowing what a knight's move is). But I think that formal statement gets the geometrical formulation wrong for a well-known reason: <code>‚Ñù √ó ‚Ñù</code> does not have the Euclidean metric. IMO 2017 P3 looks like it has the same problem with the wrong metric. For IMOLean my conventions explicitly say to use <code>EuclideanSpace ‚Ñù (Fin 2)</code> (which has the right metric) for problems involving coordinates.</p>\n</blockquote>\n<p>Thanks! Our team has considered this issue, but due to some reasons, we have chosen the current formalization method. However, thank you for pointing out this issue. We will discuss this point again.</p>",
        "id": 514934761,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1745891328
    },
    {
        "content": "<p>IMO 2015 P1 is another example where you're using the wrong metric (so there are at least three problems in this benchmark with the wrong metric just from among those geometrically-flavoured combinatorics problems for which I was a coordinator at the IMO). In my view, it's best to use the right metric even for those problems for which the choice of metric doesn't actually matter (unless the problem statement doesn't involve coordinates, so a concrete type isn't used, and wouldn't use the type class hypotheses relating to the metric at all, so such hypotheses aren't needed) - but for these three examples, the problem only has its intended meaning at all with the Euclidean rather than the sup metric.</p>",
        "id": 514936933,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745892564
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514929990\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"398687\">Zhengying Liu</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514926365\">said</a>:</p>\n<blockquote>\n<p>Could you share the exact location of these errors?</p>\n</blockquote>\n<p>No, I am not prepared to do unpaid work for an AI company.</p>\n</blockquote>\n<p>There may have been some misunderstanding. Numina is a non-profit organization, and everything we develop ‚Äî datasets, models, and training pipelines ‚Äî will be fully open-sourced and freely available to the public. In this particular case, we are discussing a benchmark that we believe could contribute to the broader community. There is no plan to commercialize or profit from this work.</p>\n<p>We are deeply grateful to the Lean community, whose support and guidance have been valuable to this project from the very beginning. In fact, we view the strength of the Lean community as one of Lean 4‚Äôs greatest assets, and it is a key reason we chose Lean 4 for our models.</p>\n<p>We sincerely hope that our work can, in turn, contribute to the growth of the Lean ecosystem. You are absolutely right ‚Äî we owe a great deal to the Lean community, and we will make a stronger effort to explicitly acknowledge and credit the community's contributions in our future communications.</p>",
        "id": 514941097,
        "sender_full_name": "Jia Li",
        "timestamp": 1745895089
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514899099\">said</a>:</p>\n<blockquote>\n<p>Can you remind me how moonshot AI and Numini are related?  Is moonshot = Kimina = Numina + Kimi ?</p>\n</blockquote>\n<p>Kimina-Prover is a collaboration between moonshot ai and Numina to develop an IMO level formal reasoning model. All our works are meants to be fully open sourced in the next months, especially the dataset. Kimi is the name of the product developped by moonshot. We planned to explain this in a blog post the day of the full release.</p>",
        "id": 514942280,
        "sender_full_name": "Jia Li",
        "timestamp": 1745895840
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514933847\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"243791\">David Renshaw</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514932950\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514918639\">said</a>:</p>\n<blockquote>\n<p>I notice some overlap between the contents of Compfiles and this repository, in fact some code appears to be directly copied from there without attribution. </p>\n</blockquote>\n<p>Compfiles imported that problem (<a href=\"https://dwrensha.github.io/compfiles/problems/Compfiles.Imo2024P5.html\">2024P5</a>) from <a href=\"https://github.com/leanprover-community/mathlib4/blob/master/Archive/Imo/Imo2024Q5.lean\"><code>mathlib4/Archive</code></a>. Let me know if there's something I could be doing to make the attribution more clear.</p>\n</blockquote>\n<p>Ah, I misunderstood the order that these were done in - this is clear in Compfiles. However, I think CombiBench should make this clearer in the dataset, rather than burying the attribution in the paper and putting \"new work\" in the announcement.</p>\n</blockquote>\n<p>Thank you for the feedbacks. We have updated our dataset card to be more explicit.<br>\n<a href=\"https://huggingface.co/datasets/AI-MO/CombiBench\">https://huggingface.co/datasets/AI-MO/CombiBench</a><br>\nWe believe that the majority of the statements are novel, and that this does not compromise the originality of our work.</p>",
        "id": 514943164,
        "sender_full_name": "Jia Li",
        "timestamp": 1745896377
    },
    {
        "content": "<p>The worry I have about taking a problem already formalized in mathlib/Archive or compcert is that many AI models will not be careful with avoiding contamination.  No AI models probably thinks about such benchmarks for pretraining, and for fine tuning there have been cases like InternLM-Math where they train on test problems formalized in CompCert.</p>",
        "id": 514946906,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745898708
    },
    {
        "content": "<p>As for <span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span>‚Äôs concerns, regardless of if pointing out two errors is unpaid labor, it seems that (from his comments) your benchmark may need a lot more fixing than a casual bug fix from a friendly volunteer on two problems.  Again, this is a major and common problem with these benchmarks.  It is so easy to make mistakes that ruin the integrity of benchmark (much more than informal math benchmarks).</p>",
        "id": 514947420,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745899022
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514947420\">said</a>:</p>\n<blockquote>\n<p>As for <span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span>‚Äôs concerns, regardless of if pointing out two errors is unpaid labor, it seems that (from his comments) your benchmark may need a lot more fixing than a casual bug fix from a friendly volunteer on two problems.  Again, this is a major and common problem with these benchmarks.  It is so easy to make mistakes that ruin the integrity of benchmark (much more than informal math benchmarks).</p>\n</blockquote>\n<p>Thank you for your suggestions. We understand that maintaining a benchmark is a long-term endeavor. As Zhengying mentioned earlier, our team has double-checked the work. However, we still cannot guarantee that there are no errors. We have also mentioned in the README: We welcome everyone to point out any potential issues through the issue tracker, and we will respond to each one. Regarding the style and metric issues raised by Joseph Myers, we will also give them serious consideration. For¬†@Bhavik Mehta‚Äôs concerns, we will re-examine our Benchmark.</p>",
        "id": 514952219,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1745901656
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"266253\">Joseph Myers</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514931040\">said</a>:</p>\n<blockquote>\n<p>you should first add appropriate definitions to mathlib for whether four points in a <code>CircularOrder</code> correspond to non-intersecting chords or not; there must be a better way to express that than the very long <code>IsBeautiful</code> definition in that statement.</p>\n</blockquote>\n<p>That was indeed the plan. Intersecting chords came up several times, and the second time I wrote a dedicated API, but I haven't yet pushed it towards mathlib</p>",
        "id": 514973106,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745909060
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"509372\">Jia Li</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514941097\">said</a>:</p>\n<blockquote>\n<p>There may have been some misunderstanding.</p>\n</blockquote>\n<p>The dataset you have published is from the Moonshot AI github account. And Moonshot AI is a for-profit AI company, no?</p>",
        "id": 515011568,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1745919712
    },
    {
        "content": "<p>Indeed Jason explains my concerns clearly: the errors I have seen and that Joseph has kindly pointed out are very similar both in frequency and form to those in earlier benchmarks, and significantly compromise the quality of this benchmark.</p>",
        "id": 515013305,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1745919956
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/515011568\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"509372\">Jia Li</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514941097\">said</a>:</p>\n<blockquote>\n<p>There may have been some misunderstanding.</p>\n</blockquote>\n<p>The dataset you have published is from the Moonshot AI github account. And Moonshot AI is a for-profit AI company, no?</p>\n</blockquote>\n<p>Yes you are right. It is a joint development effort between the two teams. Moonshot is a for profit company. But this does not change the fact that we are releasing all the result of this collaboration (currently partial results). At the very beginning, we have agreed on open sourcing the datasets and the models that we developped togather. Hosting the page on moonshot is a way to give them credits to their contribution</p>",
        "id": 515015963,
        "sender_full_name": "Jia Li",
        "timestamp": 1745920702
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/515013305\">said</a>:</p>\n<blockquote>\n<p>Indeed Jason explains my concerns clearly: the errors I have seen and that Joseph has kindly pointed out are very similar both in frequency and form to those in earlier benchmarks, and significantly compromise the quality of this benchmark.</p>\n</blockquote>\n<p>I'd go so far as to say that it would be more novel and interesting to see research that looks at <em>why</em> errors in formal problem statements are so common (covering both human and technical factors) and how to improve accuracy, than yet another paper about yet another formal benchmark.</p>",
        "id": 515019189,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745921634
    },
    {
        "content": "<p>While <span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span> isn't willing to share his experiment, I'm willing to share mine.  There are 2.5 errors in the first three problems:</p>\n<ul>\n<li><code>apmo_1991_p2</code> doesn't assume the points are distinct, so it is trivially false.  (I would be curious if a good AI could prove this is false.)</li>\n<li><code>apmo_2023_p1</code> seems to be correct, but note that the definition of <code>touches</code> and <code>touches_interior_or_edge</code> are not symmetric (and I assume that was a mistake).  The redeeming property of the theorem statement is that you consider both directions of <code>touches_interior_or_edge</code> which I <em>think</em> (I'm about 98% sure) fixes the problem.</li>\n<li><code>balticway_2015_p7</code> forgot about the anti-reflexivity of graphs.  When stating that a subset is a clique (both the two groups in the partition, as well as the board), you can't have <code>l</code> being adjacent to itself.  You could use <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Combinatorics/SimpleGraph/Clique.html#SimpleGraph.IsClique\"><code>SimpleGraph.IsClique</code></a> instead.  (As stated, the theorem is trivially true since the <code>h_board</code> hypothesis is a contradiction.  And moreover, the only way one can prove this theorem is to use the that <code>h_board</code> is contradictory.  Otherwise, the conclusion is impossible for the same reason.  I wonder if, DeepSeek-Prover-style, a good AI could figure out that this hypothesis is contradictory.)</li>\n</ul>",
        "id": 515039951,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745927186
    },
    {
        "content": "<p>But again, please assume there are many more errors which we didn't find.  As for <span class=\"user-mention\" data-user-id=\"266253\">@Joseph Myers</span>'s point about why these errors are so common, I think it is a combination of multiple factors:</p>\n<ul>\n<li>You clearly didn't prove these theorems true.  The first version of miniF2F took the time to formalize the proofs of a number of statements to guarantee correctness, and I think that is also what Harmonic (and proabably AlphaProof) did with their own version of MiniF2F.</li>\n<li>Also, by not using standard definitions like <code>SimpleGraph.IsClique</code> you are reinventing the wheel and making it more likely you will get a mistake.</li>\n<li>There probably are ways around this, but it would involve writing unit-test style formalizations making sure the relevant parts are correct and keeping a list of common issues to check against.  Distinctness is one such issue.</li>\n</ul>",
        "id": 515043936,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745928315
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514915747\">said</a>:</p>\n<blockquote>\n<p>From the README:</p>\n<blockquote>\n<p>It is released under permissive licenses Apache 2.0 for Lean 4.</p>\n</blockquote>\n<p>The <code>LICENSE</code> file says it is MIT-licensed. Which is correct?</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"708643\">@Junqi Liu</span>, ping on this.</p>",
        "id": 515046147,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1745928964
    },
    {
        "content": "<p>I think there is also a problem in the last problem, <code>usamo_2000_p4</code> (which is the fourth problem I've looked at).  If I understand correctly, the way you have formalized the problem is to find the cardinality of the smallest set with a right triangle, which is trivially 3, and not the smallest number <code>n</code> which has a right triangle for all such sets of that size.  So in the \"without solution\" mode, this theorem is impossible to prove as stated.  (Again, thinking about how to find this error automatically, an AI could solve this trivial answer as 3 with a proof, which would automatically flag some bug since 3 is not the expected answer, so if correctly stated it would be impossible to prove it is 3.)</p>",
        "id": 515050442,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745930070
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/515046147\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/514915747\">said</a>:</p>\n<blockquote>\n<p>From the README:</p>\n<blockquote>\n<p>It is released under permissive licenses Apache 2.0 for Lean 4.</p>\n</blockquote>\n<p>The <code>LICENSE</code> file says it is MIT-licensed. Which is correct?</p>\n</blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"708643\">Junqi Liu</span>, ping on this.</p>\n</blockquote>\n<p>This have fixed!  MIT-licensed.</p>",
        "id": 515055239,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1745931290
    },
    {
        "content": "<p>We are truly grateful for the errors <span class=\"user-mention\" data-user-id=\"115715\">@Jason Rute</span>  have pointed out to us. We have already corrected them and will gradually check each problem over the next two weeks. Where possible, we will also attempt to provide proofs for the problems. Meanwhile, we will ensure that these proofs do not appear in any training data, but are solely to guarantee the correctness of the formalization of the statements.</p>",
        "id": 515100239,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1745941430
    },
    {
        "content": "<p>The thing I remained scared about here is that on the basis that Jason, Joseph, and Bhavik have been finding approximately 1 error per problem in the problems they have looked at, a bystander should be concluding from this that <em>nearly all</em> the problems which no one (external) has looked at are also incorrect. They are not pointing out the isolated examples of problems they have found, but are providing statistical evidence that almost everything is wrong --- and this evidence needs to be addressed systematically.</p>",
        "id": 515109613,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1745943990
    },
    {
        "content": "<p>This also probably invalidates the leaderboard information, given the likelihood that AIs have actually discovered some problems that are made much easier by being incorrectly stated. Could the leaderboard be made to provide access to both lists of the problems claimed to be solved by each AI, and all the underlying Lean solutions (I couldn't see how to access this data at present), since seeing whether formal solutions actually correspond to the intended informal problem is a useful way of detecting formalization mistakes?</p>",
        "id": 515163564,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745963348
    },
    {
        "content": "<p>There were a few problems where I only commented on choices made without assessing whether the formal statement was correct, but having looked at a few more problems on which I was a coordinator, I think I believe the statistical evidence is indeed that almost all the problems are incorrect.</p>",
        "id": 515163704,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745963414
    },
    {
        "content": "<ul>\n<li>The EGMO 2022 P5 formal statement defines <code>PerfectCover</code> in a way that distinguishes permutations of the labels on the dominoes, and distinguishes the two squares of each domino. Thus, the number of ways of covering the board gets multiplied by <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mi>k</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">!</mo><msup><mn>2</mn><mrow><mi>n</mi><mi>k</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">(nk)!2^{nk}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0991em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">nk</span><span class=\"mclose\">)!</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">nk</span></span></span></span></span></span></span></span></span></span></span></span> compared to the intended number in the formal statement. That's obviously no good for a problem concerned with when that number of ways is odd.</li>\n</ul>",
        "id": 515164086,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745963621
    },
    {
        "content": "<ul>\n<li>The IMO 2023 P5 formal statement defines a directed graph <code>triangleGraph</code> used to determine permitted ninja paths. But the definition in the formal statement has edges pointing both up and down (so would allow ninja paths that mix edges up and down), whereas the problem requires ninja paths to go down only. Also, the with_solution version of that problem statement gives the wrong answer; <code>Real.log</code> is not a base-2 logarithm.</li>\n</ul>",
        "id": 515164487,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745963836
    },
    {
        "content": "<ul>\n<li>The formal statement of IMO 2014 P6 defines <code>finite_regions</code> as a predicate on sets of points <code>S</code> in the plane, requiring such a set to be nonempty, bounded, and, for each line in the given set of lines, either all points of <code>S</code> must lie in that line, or all must lie on the same side of that line. For example, any singleton set would satisfy that predicate. The formal statement of the problem is then trivially false given how <code>finite_regions</code> is true for any singleton set; it doesn't come anywhere close to what the informal statement actually asks (about taking the finite regions determined by all <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> lines and looking at the colours of lines on their boundaries).</li>\n</ul>",
        "id": 515165297,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745964224
    },
    {
        "content": "<p>And a couple of bonus incorrect statements for problems I wasn't a coordinator on:</p>",
        "id": 515165528,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745964324
    },
    {
        "content": "<ul>\n<li>The one non-IMO problem using <code>dist</code>, brualdi_ch3_18, seems to have the same issue with using the wrong metric as the other problems I listed before.</li>\n</ul>",
        "id": 515165670,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745964386
    },
    {
        "content": "<ul>\n<li>In the IMO 2005 P6 formal statement, the hypothesis <code>(h' : ‚àÄ i, (solved i).card &lt; Fintype.card participants)</code> looks like \"each problem had some contestant who failed to solve it\". That's not the same thing as \"Moreover, no contestant solved all the 6 problems.\" from the informal statement (<code>solved</code> here maps problems to Finsets of contestants who solved them).</li>\n</ul>",
        "id": 515166120,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745964639
    },
    {
        "content": "<p>Writing a formal solution based on a known informal solution to a problem is indeed a very good way of detecting mistakes in the formal statement. It's also incredibly time-consuming to do on the scale of 100 problems; my experience is that a combinatorics problem doesn't need to be that hard for a formal solution to be 1000 lines or more of Lean. (The first olympiad combinatorics problem I formalized a solution to ended up as 3000 lines of Lean 3, though I expect that was longer than necessary through inexperience.)</p>",
        "id": 515166605,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745964900
    },
    {
        "content": "<p>Clearly, there is a lot of cleanup needed.  I hope the authors do it and rerun the benchmark.  And I hope they maintain it and version it properly going forward, noting which version each model was run with (including which version of Lean, Mathlib, and the benchmark itself).</p>",
        "id": 515173081,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745968405
    },
    {
        "content": "<p>I may have been ambitious to suggest formalizing each proof.  It would be good to get guidance from those with experience in this sort of thing on how to avoid mistakes.</p>",
        "id": 515173185,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745968459
    },
    {
        "content": "<p>Overall, I think this benchmark likely won't have a lot of impact.  It will be good for R&amp;D, but as a goal post it has all the same problems that MiniF2F and PutnamBench have:</p>\n<ul>\n<li>The problems are old and found on the internet, probably even in various natural language math training sets (maybe even in Numina Math 1.5).  I think leakage (where the model is aware of the informal proof) will be common.</li>\n<li>In some cases, there are even already formal proofs on the internet, and I suspect <span class=\"user-mention\" data-user-id=\"243791\">@David Renshaw</span> plans to formalize many more of these problems, especially the IMO ones, in <a href=\"https://dwrensha.github.io/compfiles/\">Compfiles</a>.  This leads to even more leakage, and of the worst kind, where the formal proof is available on the open internet.</li>\n<li>As models get better on these benchmarks (like they are on the informal math benchmarks), there will be a lot of distrust.  Does it do well because it has memorized the proof (or the numerical solution at least), or because it is really reasoning?</li>\n<li>Competition math isn't really that interesting to what formal math is used for.  It is just a convenient benchmark.</li>\n</ul>",
        "id": 515174909,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745969548
    },
    {
        "content": "<p>I think going forward, the following two types of benchmarks will have more value:</p>\n<ul>\n<li>Benchmarks that are more closely tied to the needs of formal math: autoformalization, provably correct code, and research math.</li>\n<li>Benchmarks that are resistant to data leakage.  For natural language competition math, the new standard is <a href=\"https://matharena.ai/\">matharena.ai</a>, a project by researchers as ETH where they run models on the current math competitions immediately after the competition (which avoids leakage).  <span class=\"user-mention\" data-user-id=\"350365\">@Mislav Balunoviƒá</span> has already stated that he is considering a formal version of the matharena benchmark.  I think Lean experts here should partner with him on that (or make their own version of that benchmark).  I could even imagine a near future (2026?) where the standard competitions (USAMO, IMO, Putnam, etc) release formal Lean versions of all their problems.</li>\n</ul>",
        "id": 515174913,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745969554
    },
    {
        "content": "<p>For the informal leakage issue, it's always possible for someone to use such a benchmark as an autoformalization benchmark - give an autoformalization AI the formal statement and the informal solution - even if it's not what the benchmark was designed or intended for. (That's still at risk of leakage from training materials including existing formal solutions.)</p>",
        "id": 515176561,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745970646
    },
    {
        "content": "<p>I like the idea of competitions releasing formal statements of their own problems. But there are <a href=\"https://artofproblemsolving.com/community/c13_contests\">a lot of competitions</a> (plenty of which don't even have websites that get promptly updated with the official informal statements after the competition); to have several competitions releasing formal problem statements (and thus several different groups of people releasing them, not all with a great deal of Lean expertise), you really need a better solution (that can be applied by non-experts) to getting correct (even if not perfectly idiomatic) Lean problem statements. If several competitions release Lean versions of their problems where most of the formal statements are wrong, that's not very useful for benchmarking any kind of AI other than an interactive \"tell me what I got wrong in this formal statement\" autoformalizer for statements.</p>",
        "id": 515177016,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1745970964
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"266253\">Joseph Myers</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/515176561\">said</a>:</p>\n<blockquote>\n<p>For the informal leakage issue, it's always possible for someone to use such a benchmark as an autoformalization benchmark - give an autoformalization AI the formal statement and the informal solution - even if it's not what the benchmark was designed or intended for. (That's still at risk of leakage from training materials including existing formal solutions.)</p>\n</blockquote>\n<p>I totally agree!  <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/Hard.20proof-based.20auto-formalization.20benchmark/near/514687609\">I discussed this specifically here</a> as a Tier 0 of my <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/Hard.20proof-based.20auto-formalization.20benchmark\">ambitious autoformalization benchmark idea</a> where one formalizes entire mathematical arguments.  Indeed ProofNet and MiniF2F are already ready for this Tier 0 autoformalization benchmark since they have informal proofs as well.  This was run on MiniF2F a few years ago as part of the <a href=\"https://arxiv.org/abs/2210.12283\">Draft-Sketch-Prove</a> paper.  In that paper, providing the human proof didn't help much at all, but I think with better autoformalizers it could help a lot.  If not, we will discover that autoformalization is the current bottleneck.</p>",
        "id": 515177142,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745971044
    },
    {
        "content": "<p>As for getting (at least some of the major) math competitions to have high-quality formalized translations, if anyone in the world could make it happen, it is you <span class=\"user-mention\" data-user-id=\"266253\">@Joseph Myers</span>! <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 515178419,
        "sender_full_name": "Jason Rute",
        "timestamp": 1745971747
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"266253\">Joseph Myers</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/515163564\">said</a>:</p>\n<blockquote>\n<p>This also probably invalidates the leaderboard information, given the likelihood that AIs have actually discovered some problems that are made much easier by being incorrectly stated. Could the leaderboard be made to provide access to both lists of the problems claimed to be solved by each AI, and all the underlying Lean solutions (I couldn't see how to access this data at present), since seeing whether formal solutions actually correspond to the intended informal problem is a useful way of detecting formalization mistakes?</p>\n</blockquote>\n<p>We list the most of 7 problems in the end of our paper. There are two problems (<code>brualdi_ch7_7</code> and <code>brualdi_ch14_33</code>) for which we did not post the solutions, as these two problems can be proved very easily with a one-step theorem.</p>",
        "id": 515193306,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1745980902
    },
    {
        "content": "<p>Out of curiosity, how do you plan to grade problems that require exhibiting certain sums? I picked a random problem in the benchmark:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"n\">abbrev</span><span class=\"w\"> </span><span class=\"n\">brualdi_ch5_9_solution</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñ§</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">Evaluate the sum $\\sum_{k=0}^{n}(-1)^{k}\\binom{n}{k} 10^{k}$.</span>\n<span class=\"sd\">-/</span>\n<span class=\"kd\">theorem</span><span class=\"w\"> </span><span class=\"n\">brualdi_ch5_9</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">Finset.range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñ§</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n.choose</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"n\">brualdi_ch5_9_solution</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>where part of the solution involves exhibiting a function <code>‚Ñï ‚Üí ‚Ñ§</code>. To me, it seems that an AI could just do</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"n\">abbrev</span><span class=\"w\"> </span><span class=\"n\">brualdi_ch5_9_solution</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñ§</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">Finset.range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñ§</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n.choose</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">k</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">Evaluate the sum $\\sum_{k=0}^{n}(-1)^{k}\\binom{n}{k} 10^{k}$.</span>\n<span class=\"sd\">-/</span>\n<span class=\"kd\">theorem</span><span class=\"w\"> </span><span class=\"n\">brualdi_ch5_9</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">Finset.range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñ§</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n.choose</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"n\">brualdi_ch5_9_solution</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>Would the solution for <code>brualdi_ch5_9_solution</code> need to be in some sort of closed form?<br>\nThis isn't really that big of a deal since it's quite easy for a human to just check manually that the function generated by the AI is simple enough to count as a solution.</p>",
        "id": 515416624,
        "sender_full_name": "Niels Voss",
        "timestamp": 1746055375
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"521331\">@Niels Voss</span>  You can read our evaluation code or our paper, we consider this situation.</p>",
        "id": 515515686,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1746109819
    },
    {
        "content": "<p>The Combibench paper recently got released, as someone trying to do justice to evaluation and measuring model performance on theorem proving. Any thoughts by people more familiar with the issues with lean benchmarks here, if the Fine-eval method they propose is everything you would want to see? </p>\n<p>Paper: <a href=\"https://arxiv.org/abs/2505.03171\">https://arxiv.org/abs/2505.03171</a></p>\n<p><a href=\"/user_uploads/3121/wqVXQSHaDnF3JBb7toBSKihY/image.png\">image.png</a><br>\n<a href=\"/user_uploads/3121/5nr364vWRRwiDDmkxSijlG1x/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/wqVXQSHaDnF3JBb7toBSKihY/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1066x414\" src=\"/user_uploads/thumbnail/3121/wqVXQSHaDnF3JBb7toBSKihY/image.png/840x560.webp\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/5nr364vWRRwiDDmkxSijlG1x/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1060x576\" src=\"/user_uploads/thumbnail/3121/5nr364vWRRwiDDmkxSijlG1x/image.png/840x560.webp\"></a></div>",
        "id": 516642947,
        "sender_full_name": "Pawan sasanka ammanamanchi",
        "timestamp": 1746616121
    },
    {
        "content": "<p>Wow, this is the most explicit cheat I've seen so far!  Just comment out the theorem and it passes all the tests!!!!  <span aria-label=\"laughter tears\" class=\"emoji emoji-1f602\" role=\"img\" title=\"laughter tears\">:laughter_tears:</span>  But this is yet another reason we need a better (and official) checking mechanism like I propose here: <a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/A.20better.20Lean.20checker/with/516560099\">#lean4 &gt; A better Lean checker</a></p>",
        "id": 516644864,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746616734
    },
    {
        "content": "<p>And to be clear, their evaluation strategy is not enough.  It wouldn't guard against the DeepSeek bug either.  <em>The simplest extra thing they should do is to append <code>#print axioms &lt;theorem_name&gt;</code> at the end.</em>  That will make sure the theorem exists (which would guard against deleting the theorem and other bugs/exploits that cause the theorem to get dropped from the environment), and they could check the output to make sure it only uses the three good axioms.  But it wouldn't guard against this kind of exploit:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">instNatAdd</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Add</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">mul</span><span class=\"bp\">‚ü©</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>(or some other exploits using metaprogramming).  They should look into using ¬†<span class=\"user-mention\" data-user-id=\"110596\">@Rob Lewis</span>'s ¬†<a href=\"https://github.com/robertylewis/lean4-autograder-main\">autograder</a>¬†and¬†<span class=\"user-mention\" data-user-id=\"776090\">@GasStationManager</span>'s¬†<a href=\"https://github.com/GasStationManager/SafeVerify\">SafeVerify</a> in the meantime.  I think that would be a pretty good solution.</p>",
        "id": 516646252,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746617155
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"708643\">@Junqi Liu</span></p>",
        "id": 516647410,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746617484
    },
    {
        "content": "<p>Another easy thing to do is to append this at the very end (in addition to <code>#print axioms</code>)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">all</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"n\">theorem_name</span><span class=\"bp\">&gt;</span>\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"n\">new_definition_used_in_problem</span><span class=\"bp\">&gt;</span>\n</code></pre></div>\n<p>which would check that the theorem statement and any new definitions/axioms used in the problem statement haven't changed.  Turning off the pretty printer with <code>set_option pp.all true</code> better guards against exploits like the <code>local instance</code> one above.  (But again, I wish there were a more one-size-fits-all official solution for these problems.)</p>",
        "id": 516653423,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746618706
    },
    {
        "content": "<p>(Also, I can empathize with the model and why it tried to cheat on that problem.  That is one of the problems we pointed out was false above.  I'd love to see the chain-of-thought to see if the model realized it was false and worthless to try to prove it, so it just commented it out. <span aria-label=\"laughter tears\" class=\"emoji emoji-1f602\" role=\"img\" title=\"laughter tears\">:laughter_tears:</span>)</p>",
        "id": 516657489,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746619665
    },
    {
        "content": "<p>Also, I just saw that the solutions in Appendix 3 all use native_decide.  That is a questionable tactic.  It bypasses the kernel, performing computation using the interpreter instead of the kernel.  It needs special axioms to allow this, and <code>lean4checker</code> won't check a proof using it.    It is known that you can use it to fairly easily prove <code>False</code>.  (I'm not sure, however, if there are any known ways that don't involve making new externally implemented definitions.  It might be that if you are using standard definitions, it is fine in practice.)  Hence, many consider it dangerous to allow it.  You can check if it is used with <code>#print_axioms</code>.  If the proof works with <code>decide</code> in place of <code>native_decide</code>, that is better.</p>",
        "id": 516665830,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746621916
    },
    {
        "content": "<p>You can trick native_decide with <code>@[csimp]</code></p>",
        "id": 516669708,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746622885
    },
    {
        "content": "<p>I made a list of ways that <code>native_decide</code> can be exploited here: <a href=\"#narrow/channel/113488-general/topic/Using.20.60native_decide.60.20to.20prove.20False.3F\">#general &gt; Using &#96;native_decide&#96; to prove False?</a></p>",
        "id": 516671703,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746623354
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/516644864\">said</a>:</p>\n<blockquote>\n<p>Wow, this is the most explicit cheat I've seen so far!  Just comment out the theorem and it passes all the tests!!!!  <span aria-label=\"laughter tears\" class=\"emoji emoji-1f602\" role=\"img\" title=\"laughter tears\">:laughter_tears:</span>  But this is yet another reason we need a better (and official) checking mechanism like I propose here: <a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/A.20better.20Lean.20checker/with/516560099\">#lean4 &gt; A better Lean checker</a></p>\n</blockquote>\n<p>The situation you mentioned is avoidable in our checks. Please refer to the fourth point in our requirements, which states that the Lean 4 code extracted from the model's response, after removing all comments, should meet the four requirements illustrated in the diagram.</p>",
        "id": 516809796,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1746679311
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/516646252\">said</a>:</p>\n<blockquote>\n<p>And to be clear, their evaluation strategy is not enough.  It wouldn't guard against the DeepSeek bug either.  <em>The simplest extra thing they should do is to append <code>#print axioms &lt;theorem_name&gt;</code> at the end.</em>  That will make sure the theorem exists (which would guard against deleting the theorem and other bugs/exploits that cause the theorem to get dropped from the environment), and they could check the output to make sure it only uses the three good axioms.  But it wouldn't guard against this kind of exploit:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">instNatAdd</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Add</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">mul</span><span class=\"bp\">‚ü©</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>(or some other exploits using metaprogramming).  They should look into using ¬†<span class=\"user-mention silent\" data-user-id=\"110596\">Rob Lewis</span>'s ¬†<a href=\"https://github.com/robertylewis/lean4-autograder-main\">autograder</a>¬†and¬†<span class=\"user-mention silent\" data-user-id=\"776090\">GasStationManager</span>'s¬†<a href=\"https://github.com/GasStationManager/SafeVerify\">SafeVerify</a> in the meantime.  I think that would be a pretty good solution.</p>\n</blockquote>\n<p>Can you explain what the Deepseek bug you mentioned is?</p>",
        "id": 516810027,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1746679446
    },
    {
        "content": "<p>I don't understand the specifics of the deepseek bug but it's discussed in detail here: <a class=\"message-link\" href=\"/#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515487837\">#Machine Learning for Theorem Proving &gt; DeepSeek-Prover V2 @ üí¨</a></p>\n<p>I think it's that in older versions of Lean, using <code>apply?</code> in some circumstances involving universes can cause the theorem to get deleted instead of erroring out, which meant that if you were just checking for error messages you wouldn't find any, although someone should please double check me on this.</p>",
        "id": 516822402,
        "sender_full_name": "Niels Voss",
        "timestamp": 1746686755
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 516839575,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1746693058
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/516646252\">said</a>:</p>\n<blockquote>\n<p>And to be clear, their evaluation strategy is not enough.  It wouldn't guard against the DeepSeek bug either.  <em>The simplest extra thing they should do is to append <code>#print axioms &lt;theorem_name&gt;</code> at the end.</em>  That will make sure the theorem exists (which would guard against deleting the theorem and other bugs/exploits that cause the theorem to get dropped from the environment), and they could check the output to make sure it only uses the three good axioms.  But it wouldn't guard against this kind of exploit:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">instNatAdd</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Add</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">mul</span><span class=\"bp\">‚ü©</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>(or some other exploits using metaprogramming).  They should look into using ¬†<span class=\"user-mention silent\" data-user-id=\"110596\">Rob Lewis</span>'s ¬†<a href=\"https://github.com/robertylewis/lean4-autograder-main\">autograder</a>¬†and¬†<span class=\"user-mention silent\" data-user-id=\"776090\">GasStationManager</span>'s¬†<a href=\"https://github.com/GasStationManager/SafeVerify\">SafeVerify</a> in the meantime.  I think that would be a pretty good solution.</p>\n</blockquote>\n<p>Thank you very much! Your suggestion is great, and we will incorporate it into our checks right away. And so far, we haven't found the model using this method to cheat in our experimental results. Perhaps the current model's capabilities are not yet sufficient to write such an advanced tactic as a local instance. <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 516856474,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1746698417
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"708643\">Junqi Liu</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/516809796\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/516644864\">said</a>:</p>\n<blockquote>\n<p>Wow, this is the most explicit cheat I've seen so far!  Just comment out the theorem and it passes all the tests!!!!  <span aria-label=\"laughter tears\" class=\"emoji emoji-1f602\" role=\"img\" title=\"laughter tears\">:laughter_tears:</span>  But this is yet another reason we need a better (and official) checking mechanism like I propose here: <a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/A.20better.20Lean.20checker/with/516560099\">#lean4 &gt; A better Lean checker</a></p>\n</blockquote>\n<p>The situation you mentioned is avoidable in our checks. Please refer to the fourth point in our requirements, which states that the Lean 4 code extracted from the model's response, after removing all comments, should meet the four requirements illustrated in the diagram.</p>\n</blockquote>\n<p>To be clear, I know it was avoided in your checks, but I thought it was funny and (more importantly) think it shows the subtleties involved here.  Your checks are quite ad-hoc, and while they now catch this, they could easily miss other stuff.  I think it is good for others to be aware of this exploit to avoid it.  Did you also see this behavior in training Kimina-Prover, and if so did you have checks on it then?</p>",
        "id": 516865244,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746701383
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"708643\">Junqi Liu</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/516810027\">said</a>:</p>\n<blockquote>\n<p>Can you explain what the Deepseek bug you mentioned is?</p>\n</blockquote>\n<p>The DeepSeek bug was a bug in Lean &lt; 4. 13.0 (and in particular in Lean 0.4.9 which is what DeepSeek used) where <code>apply ?</code> with a type jump in the proof caused Lean to drop the theorem from the kernel without an error message. <br>\n I called it the DeepSeek bug, since it came out in the results of the DeepSeek-Prover where the model seems to have discovered that exploit.  It comes up in one of their claimed MiniF2F solutions and two of the 7B Putnam Bench solutions in the paper.  (I can't tell if they claimed, without realizing it was a bug, that this pattern was common in their 7B model.)  You can read more about it here:</p>\n<ul>\n<li><a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/apply.3F.20might.20suppress.20other.20warnings.2Ferrors/with/515641973\">#lean4 &gt; apply? might suppress other warnings/errors</a> (description of the bug)</li>\n<li><a class=\"stream-topic\" data-stream-id=\"219941\" href=\"/#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2.20TODO.20List/with/516083350\">#Machine Learning for Theorem Proving &gt; DeepSeek-Prover V2 TODO List</a> (compact summary of the issues in the DeepSeek-Prover V2 paper)</li>\n</ul>\n<p>The reason I make a large deal about this bug is because most of the standard checks (including, I think, all the checks you mention in the CombiBench paper, as well as other gold-standard checks like <code>lean4checker</code>) would not have caught it.  Also, unlike other known exploits, it used standard tactics inside a proof, so it was even more subtle and hard to find.  I hope the Lean community uses this as a way to come up with a set of better non-ad-hoc solutions (something like SafeVerify but officially supported).</p>",
        "id": 516867984,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746702260
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/516867984\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"708643\">Junqi Liu</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/516810027\">said</a>:</p>\n<blockquote>\n<p>Can you explain what the Deepseek bug you mentioned is?</p>\n</blockquote>\n<p>The DeepSeek bug was a bug in Lean &lt; 4. 13.0 (and in particular in Lean 0.4.9 which is what DeepSeek used) where <code>apply ?</code> with a type jump in the proof caused Lean to drop the theorem from the kernel without an error message. <br>\n I called it the DeepSeek bug, since it came out in the results of the DeepSeek-Prover where the model seems to have discovered that exploit.  It comes up in one of their claimed MiniF2F solutions and two of the 7B Putnam Bench solutions in the paper.  (I can't tell if they claimed, without realizing it was a bug, that this pattern was common in their 7B model.)  You can read more about it here:</p>\n<ul>\n<li><a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/apply.3F.20might.20suppress.20other.20warnings.2Ferrors/with/515641973\">#lean4 &gt; apply? might suppress other warnings/errors</a> (description of the bug)</li>\n<li><a class=\"stream-topic\" data-stream-id=\"219941\" href=\"/#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2.20TODO.20List/with/516083350\">#Machine Learning for Theorem Proving &gt; DeepSeek-Prover V2 TODO List</a> (compact summary of the issues in the DeepSeek-Prover V2 paper)</li>\n</ul>\n<p>The reason I make a large deal about this bug is because most of the standard checks (including, I think, all the checks you mention in the CombiBench paper, as well as other gold-standard checks like <code>lean4checker</code>) would not have caught it.  Also, unlike other known exploits, it used standard tactics inside a proof, so it was even more subtle and hard to find.  I hope the Lean community uses this as a way to come up with a set of better non-ad-hoc solutions (something like SaneVerify but officially supported).</p>\n</blockquote>\n<p>Yes! However, perhaps we could monitor the feedback from Lean and prohibit the appearance of the keyword <code>Try this</code> in the feedback. Do you think this approach could avoid the Deepseek-bug?</p>",
        "id": 516868502,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1746702439
    },
    {
        "content": "<p>It is only a coincidence that this bug uses <code>apply?</code> which also prints \"Try this\".  The next such bug may not.  Also <code>exact?</code> is a \"Try this\" tactic, but it is really powerful and AlphaProof uses it.  I think one needs a more principled approach to this sort of stuff, which I think the two tools SafeVerify and autograder are (although I would prefer a more official tool).</p>",
        "id": 516869038,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746702623
    },
    {
        "content": "<p>Also, while we are talking about exploits to avoid, here is the worst exploit I know of (thanks to <span class=\"user-mention\" data-user-id=\"873547\">@Robin Arnez</span> in <a href=\"#narrow/channel/113488-general/topic/Using.20.60native_decide.60.20to.20prove.20False.3F\">#general &gt; Using &#96;native_decide&#96; to prove False?</a>  for pointing it out):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">debug</span><span class=\"bp\">.</span><span class=\"n\">skipKernelTC</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">innocent_lemma</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Add</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">False</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">innocent_lemma</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">instHAdd</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">this</span>\n<span class=\"w\">  </span><span class=\"n\">contradiction</span>\n</code></pre></div>\n<p>The ad-hoc print checks I suggested won't work:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">all</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\">         </span><span class=\"c1\">-- f : False</span>\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">axioms</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\">  </span><span class=\"c1\">-- 'f' depends on axioms: [propext]</span>\n</code></pre></div>\n<p>But SafeVerify and lean4checker would catch it.  (I haven't checked if <span class=\"user-mention\" data-user-id=\"110596\">@Rob Lewis</span>'s autograder would catch it as well.)</p>",
        "id": 516869622,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746702802
    },
    {
        "content": "<p>I haven't found an exploit yet that SafeVerify doesn't catch.  The only question now is if it is fast enough for practical applications (cc <span class=\"user-mention\" data-user-id=\"776090\">@GasStationManager</span>).</p>",
        "id": 516870185,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746702995
    },
    {
        "content": "<p>...And if it covers all the usage patterns in something like CombiBench.</p>",
        "id": 516870651,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746703144
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/516869038\">said</a>:</p>\n<blockquote>\n<p>It is only a coincidence that this bug uses <code>apply?</code> which also prints \"Try this\".  The next such bug may not.  Also <code>exact?</code> is a \"Try this\" tactic, but it is really powerful and AlphaProof uses it.  I think one needs a more principled approach to this sort of stuff, which I think the two tools SaneVerify and autograder are (although I would prefer a more official tool).</p>\n</blockquote>\n<p>Fine! But our Kimina Lean Server can capture this false. Maybe there's just an issue with Deepseek's Lean server.</p>",
        "id": 516871007,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1746703282
    },
    {
        "content": "<p>It has to do with versions.  DeepSeek uses Lean 4.9.0.  I assume you use something &gt;= 4.13.0.  The bug, while not discovered until now, only affects older versions of Lean.</p>",
        "id": 516871630,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746703526
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"708643\">@Junqi Liu</span> The final proof in the appendix of <code>brualdi_ch6_11</code> is wrong for two reasons.  First, I think the answer in the paper is wrong, or at least a different answer works for the native_decide calculation at the end.  Also, the proof of the lemma <code>h1</code> is not finished at least on the version of Lean/math at <a href=\"https://live.lean-lang.org/\">https://live.lean-lang.org/</a> where I tested it.  Does it work for you?</p>",
        "id": 517000879,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746750165
    },
    {
        "content": "<p>(If it does work in your version of Lean and not the one I was using, maybe some simp lemmas changed in that time.)</p>",
        "id": 517000942,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746750215
    },
    {
        "content": "<p>It is work for me. It should be noted that all our training and testing were conducted using version <code>v4.15.0</code>.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">brualdi_ch6_11_solution</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">24024</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">brualdi_ch6_11</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">sols</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Perm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">Icc</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">8</span><span class=\"o\">)))</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">h_sols</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">œÉ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">œÉ</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">sols</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Even</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">œÉ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">‚â†</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">sols</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">brualdi_ch6_11_solution</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">sols</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">filter</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">œÉ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Even</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">œÉ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">‚â†</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">univ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">œÉ</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h_sols</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h1</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">native_decide</span>\n</code></pre></div>",
        "id": 517011015,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1746755809
    },
    {
        "content": "<p>For <code>native_decide</code>, if Lean can deal with some simple computations, then why don't we let it compute them?</p>",
        "id": 517011354,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1746755973
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"708643\">Junqi Liu</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/517011354\">said</a>:</p>\n<blockquote>\n<p>For <code>native_decide</code>, if Lean can deal with some simple computations, then why don't we let it compute them?</p>\n</blockquote>\n<p>Since <code>native_decide</code> can be unsound (see <a href=\"#narrow/channel/113488-general/topic/Using.20.60native_decide.60.20to.20prove.20False.3F\">#general &gt; Using &#96;native_decide&#96; to prove False?</a>)</p>",
        "id": 517013405,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1746756743
    },
    {
        "content": "<p>As <span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> says, <code>native_decide</code> is a double-edged sword.  It is fast because it uses machine data structures like bigints, arrays, etc. to do computation, but they come with a cost, since the interface to them is more likely to be wrong.  Moreover, since you can add your own external implementation of functions, you can easily make your own proofs of false.  (And there are some other examples in that thread.)  People do use <code>native_decide</code> but at their own peril.  If used carefully, it is probably correct and faster than pure varients in Lean (at least right now).</p>",
        "id": 517015890,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746758089
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/517015890\">said</a>:</p>\n<blockquote>\n<p>As <span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> says, <code>native_decide</code> is a double-edged sword.  It is fast because it uses machine data structures like bigints, arrays, etc. to do computation, but they come with a cost, since the interface to them is more likely to be wrong.  Moreover, since you can add your own external implementation of functions, you can easily make your own proofs of false.  (And there are some other examples in that thread.)  People do use <code>native_decide</code> but at their own peril.  If used carefully, it is probably correct and faster than pure varients in Lean (at least right now).</p>\n</blockquote>\n<p>Agree! I think it makes sense for tasks like computing cardinalities or when dealing with numerical values.</p>",
        "id": 517015952,
        "sender_full_name": "Junqi Liu",
        "timestamp": 1746758137
    },
    {
        "content": "<p>And as for <code>brualdi_ch6_11</code>, I must have copy-and-pasted it wrong from the paper (which involved a bit of cleanup).  The version above works fine on <a href=\"https://live.lean-lang.org/\">https://live.lean-lang.org/</a> with 24024 as well as on my laptop.</p>",
        "id": 517016585,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746758487
    },
    {
        "content": "<p>I do wonder whether part of what <code>native_decide</code> does, like fast numerical computation, can become verified (using only the standard axioms).</p>",
        "id": 517018002,
        "sender_full_name": "GasStationManager",
        "timestamp": 1746759292
    },
    {
        "content": "<p>Yes, tactics like norm_num (and I think the upcoming grind tactic) are very good and don‚Äôt using anything external.  Also, the four color theorem proof in Coq is a great example of good engineering to speed up a proof by computation.</p>",
        "id": 517018231,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746759439
    },
    {
        "content": "<p>And there is another practical reasoning why native_decide is a problem for benchmarks.  A lot of the talk above was about how to verify proofs correctly without worrying about exploits or bugs.  You just can‚Äôt verify a native_decide proof in the same way.  Lean4checker, SafeVerify, etc won‚Äôt work because the proof just doesn‚Äôt exist in full (because native_decide doesn‚Äôt generate a kernel proof).</p>",
        "id": 517018777,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746759774
    },
    {
        "content": "<p>I don't really think numerical computation is necessarily much slower without <code>native_decide</code> -- at least most basic operations (addition, subtraction, multiplication, division, modulo, power, greatest common divisor, equality, inequality, bitwise and, bitwise or, bitwise xor, shift left, shift right) on natural numbers <em>do</em> use bigints, even when just using reduction. The main thing that verification using <code>decide</code> struggles with are:</p>\n<ul>\n<li>well-founded recursion (the nemesis of <code>decide</code> and <code>rfl</code> proofs): makes any kind of reduction slow and often impossible</li>\n<li>long iteration: <code>decide</code> doesn't really work well with e.g. deep recursion because it doesn't seem like it has good tail-call strategies</li>\n<li>other blockers: <code>opaque</code>, <code>@[irreducible]</code> and casts (as in <code>‚ñ∏</code>) can often block reduction completely while the compiler has no problem with them (example: <code>Rat.add</code> is irreducible).</li>\n</ul>\n<p>But, in fact, it is still useful enough that <code>grind</code> leaves <em>a lot</em> of the work to <code>rfl</code> (kernel level unification).</p>",
        "id": 517033078,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1746768922
    },
    {
        "content": "<p>Then I look forward to when we have a pure tactic which is more or less a drop in replacement for <code>native_decide</code>.  <span class=\"user-mention\" data-user-id=\"873547\">@Robin Arnez</span> is <code>grind</code> going to be that tactic?</p>",
        "id": 517078553,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746786395
    },
    {
        "content": "<p>native_decide performs native computation that the kernel believes, there are just certain problems that are not tractable without this. grind is not a term evaluator its an SMT style tactic</p>",
        "id": 517085639,
        "sender_full_name": "Henrik B√∂ving",
        "timestamp": 1746789059
    }
]