[
    {
        "content": "<p>In general, is there a \"startup cost\" to calling the <code>grind</code> tactic that makes it better to combine calls when possible? E.g. if I have</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">grind</span><span class=\"o\">)</span>\n<span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">grind</span><span class=\"o\">)</span>\n<span class=\"n\">grind</span>\n</code></pre></div>\n<p>and I know that </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">foo</span>\n<span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">bar</span>\n<span class=\"n\">grind</span>\n</code></pre></div>\n<p>would also work, is there a preference between them? Or is the work done by <code>grind</code> incrementally stored in a way that makes this irrelevant?</p>",
        "id": 574498301,
        "sender_full_name": "Chris Henson",
        "timestamp": 1771418584
    },
    {
        "content": "<p>This is somewhat related to the discussion at <a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/grind_calc/with/574128729\">#lean4 &gt; grind_calc</a>, i.e. the question how to consider:<br>\n<span class=\"user-mention silent\" data-user-id=\"311453\">Frédéric Dupuis</span> <a href=\"#narrow/channel/270676-lean4/topic/grind_calc/near/573982229\">said</a>:</p>\n<blockquote>\n<p>unless there's a caching mechanism I'm not aware of, basically restarts <code>grind</code> everytime on more or less the same proof state. </p>\n</blockquote>\n<p>in terms of performance.</p>",
        "id": 574505624,
        "sender_full_name": "Chris Henson",
        "timestamp": 1771420760
    },
    {
        "content": "<p>What's wrong with <code>grind [foo, bar]</code>?</p>",
        "id": 574518967,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1771424296
    },
    {
        "content": "<p>To answer your actual question, yes there is a startup cost to calling <code>grind</code>, though presumably this is only significant if your local context is complicated.</p>\n<p>In general you can use the interactive mode <code>grind =&gt;</code> in order to only pay the startup cost a single time.</p>",
        "id": 574519737,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1771424499
    },
    {
        "content": "<p>If you're unfamiliar with <code>grind =&gt;</code>, I'd suggest watching the Lean together talk by <span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> which does a good job at presenting this feature.</p>",
        "id": 574520192,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1771424618
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479299\">Jovan Gerbscheid</span> <a href=\"#narrow/channel/113488-general/topic/grind.20performance.20questions/near/574518967\">said</a>:</p>\n<blockquote>\n<p>What's wrong with <code>grind [foo, bar]</code>?</p>\n</blockquote>\n<p>I've definitely encountered cases where <code>have := foo; grind</code> works but <code>grind [foo]</code> doesn't, fwiw! Would that be an issue and worth reporting?</p>",
        "id": 574522765,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1771425262
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479299\">Jovan Gerbscheid</span> <a href=\"#narrow/channel/113488-general/topic/grind.20performance.20questions/near/574518967\">said</a>:</p>\n<blockquote>\n<p>What's wrong with <code>grind [foo, bar]</code>?</p>\n</blockquote>\n<p>I'd have to do a bit of work to minimize this from CSLib, but there are some situations where for performance reasons I'd pass some additional parameters to these theorems, making this not exactly the same.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"479299\">Jovan Gerbscheid</span> <a href=\"#narrow/channel/113488-general/topic/grind.20performance.20questions/near/574519737\">said</a>:</p>\n<blockquote>\n<p>To answer your actual question, yes there is a startup cost to calling <code>grind</code>, though presumably this is only significant if your local context is complicated.</p>\n<p>In general you can use the interactive mode <code>grind =&gt;</code> in order to only pay the startup cost a single time.</p>\n</blockquote>\n<p>Good to confirm, thanks! I just wanted to double check my intuition about startup cost before suggesting this in CSLib. I am familiar with the interactive mode and watched Kim's talk. (In fact I just opened up a PR to Mathlib that I think makes good use of it in addressing the weekly <code>mergeWithGrind</code> linting!)</p>",
        "id": 574523146,
        "sender_full_name": "Chris Henson",
        "timestamp": 1771425360
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"448405\">Alex Meiburg</span> <a href=\"#narrow/channel/113488-general/topic/grind.20performance.20questions/near/574522765\">said</a>:</p>\n<blockquote>\n<p>I've definitely encountered cases where <code>have := foo; grind</code> works but <code>grind [foo]</code> doesn't, fwiw! Would that be an issue and worth reporting?</p>\n</blockquote>\n<p><code>grind [foo]</code> for an arbitrary proof <code>foo</code> is a relatively new feature. Maybe you were on an older version? I'd expect this to always work, yes.</p>",
        "id": 574523811,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1771425509
    }
]