[
    {
        "content": "<p>I set up <a href=\"https://github.com/lecopivo/SciLean\">https://github.com/lecopivo/SciLean</a> as in the manual, but I have say another repo where I want to now call SciLean, how do I set it up in my lakefile.lean ? Like for Batteries <a href=\"https://github.com/leanprover-community/batteries\">https://github.com/leanprover-community/batteries</a> i just had toi insert into my lakefile </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">require</span><span class=\"w\"> </span><span class=\"s2\">\"leanprover-community\"</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"s2\">\"batteries\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"s2\">\"main\"</span>\n</code></pre></div>\n<p>and it worked, i tried the same for SciLean but it gave me an error. Any help?</p>",
        "id": 484602533,
        "sender_full_name": "Robert",
        "timestamp": 1732657985
    },
    {
        "content": "<p>What did you write, exactly?</p>",
        "id": 484605322,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1732659289
    },
    {
        "content": "<p>I wrote </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">require</span><span class=\"w\"> </span><span class=\"s2\">\"lecopivo\"</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"s2\">\"SciLean\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"s2\">\"master\"</span>\n</code></pre></div>",
        "id": 484606282,
        "sender_full_name": "Robert",
        "timestamp": 1732659729
    },
    {
        "content": "<p>I wonder if that requires Reservoir support...</p>",
        "id": 484612387,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1732663144
    },
    {
        "content": "<p>Yes, the new short <code>require</code> syntax requires that Reservoir has indexed the project.</p>\n<p><span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span>, can you do something to make sure that the error message in this situation is really clear? Ideally including links to reservoir, explanations about how to get something indexed by reservoir, ideally ideally even a link to the page on reservoir explaining why this project hasn't been indexed, etc.</p>\n<p>People are <em>always</em> going to set up there lakefiles by copying and pasting someone elses, so this is going to be a ubiquitous failure mode.</p>",
        "id": 484615610,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732665460
    },
    {
        "content": "<p>Currently I get:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">dependency</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">SciLean'</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">manifest</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`lake</span><span class=\"w\"> </span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">SciLean</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">it</span>\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">SciLean</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lecopivo</span><span class=\"bp\">/</span><span class=\"n\">SciLean</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Reservoir</span><span class=\"w\"> </span><span class=\"n\">lookup</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Internal</span><span class=\"w\"> </span><span class=\"n\">server</span><span class=\"w\"> </span><span class=\"n\">error</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lecopivo</span><span class=\"bp\">/</span><span class=\"n\">SciLean</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">could</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">materialize</span><span class=\"w\"> </span><span class=\"n\">package</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">dependency</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">explicit</span><span class=\"w\"> </span><span class=\"n\">source</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">was</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">found</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">Reservoir</span>\n</code></pre></div>",
        "id": 484615621,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732665472
    },
    {
        "content": "<p>.... which is completely unactionable.</p>",
        "id": 484615677,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732665491
    },
    {
        "content": "<p>The internal server error is not good and definitely indicates something amiss.</p>",
        "id": 484615713,
        "sender_full_name": "Mac Malone",
        "timestamp": 1732665529
    },
    {
        "content": "<p>This really <em>must</em> print a suggestion of the </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">require</span><span class=\"w\"> </span><span class=\"s2\">\"lecopivo\"</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"s2\">\"SciLean\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"s2\">\"master\"</span>\n<span class=\"w\">  </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/lecopivo/SciLean\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"s2\">\"master\"</span>\n</code></pre></div>",
        "id": 484615724,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732665535
    },
    {
        "content": "<p>although that errors as <code>error: mathlib: package 'scilean' was required as 'SciLean'</code></p>",
        "id": 484615750,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732665567
    },
    {
        "content": "<p>SciLean is indexed by Reservoir though (see <a href=\"https://reservoir.lean-lang.org/@lecopivo/scilean\">here</a>)</p>",
        "id": 484615768,
        "sender_full_name": "Mac Malone",
        "timestamp": 1732665580
    },
    {
        "content": "<p>So the correct suggestion is actually</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">require</span><span class=\"w\"> </span><span class=\"s2\">\"lecopivo\"</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"s2\">\"scilean\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"s2\">\"master\"</span>\n<span class=\"w\">  </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/lecopivo/SciLean\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"s2\">\"master\"</span>\n</code></pre></div>",
        "id": 484615776,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732665594
    },
    {
        "content": "<p>The <code>from git</code> is unnecessary in this case because Reservoir does index it.</p>",
        "id": 484615865,
        "sender_full_name": "Mac Malone",
        "timestamp": 1732665620
    },
    {
        "content": "<p>Okay... so what should it be printing here?</p>",
        "id": 484615903,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732665636
    },
    {
        "content": "<p>The reservoir failing because of the casing discrepancy?</p>",
        "id": 484615951,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732665663
    },
    {
        "content": "<p>What you suggested initially is probably ideal for unindexed packages. The problem here is likely a Reservoir bug (indicating by the internal serve error).</p>",
        "id": 484616010,
        "sender_full_name": "Mac Malone",
        "timestamp": 1732665692
    },
    {
        "content": "<p>What Lake should ideally do here is special case on the response code, but it was not clear to me how to do that with curl iniitally. I think i have discovered a way in the interim, which could be used to improve this error.</p>",
        "id": 484616328,
        "sender_full_name": "Mac Malone",
        "timestamp": 1732665826
    },
    {
        "content": "<p>Okay -- for unindexed packages, do you think we can get this done asap? I'm happy to cut an RC for this, we really can't leave users unable to add packages.</p>",
        "id": 484616480,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732665851
    },
    {
        "content": "<p>Possibly? I was planning to be done for the day and on Thanksgiving vacation, but I can see if it can't hot fix this.</p>",
        "id": 484616878,
        "sender_full_name": "Mac Malone",
        "timestamp": 1732666124
    },
    {
        "content": "<p>I'm not planning on cutting v4.14.0 stable until early next week anyway, so please don't interrupt any vacation plans!! (Despite me wanting to get this fixed asap, I strongly believe in defending vacations. :-)</p>",
        "id": 484617208,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732666357
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> The internal server error you encountered seems like it was a single network failure. While that should be fixed with retries, I don't think the error <span class=\"user-mention\" data-user-id=\"782569\">@Robert</span> encountered was yours. When I try a lakefile with </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">test</span>\n\n<span class=\"n\">require</span><span class=\"w\"> </span><span class=\"s2\">\"lecopivo\"</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"s2\">\"SciLean\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"s2\">\"master\"</span>\n</code></pre></div>\n<p>I get:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$<span class=\"w\"> </span>lake<span class=\"w\"> </span>-d<span class=\"w\"> </span>private/require-test<span class=\"w\"> </span>resolve-deps\ninfo:<span class=\"w\"> </span>test:<span class=\"w\"> </span>no<span class=\"w\"> </span>previous<span class=\"w\"> </span>manifest,<span class=\"w\"> </span>creating<span class=\"w\"> </span>one<span class=\"w\"> </span>from<span class=\"w\"> </span>scratch\ninfo:<span class=\"w\"> </span>lecopivo/scilean:<span class=\"w\"> </span>cloning<span class=\"w\"> </span>https://github.com/lecopivo/SciLean\ninfo:<span class=\"w\"> </span>lecopivo/scilean:<span class=\"w\"> </span>checking<span class=\"w\"> </span>out<span class=\"w\"> </span>revision<span class=\"w\"> </span><span class=\"s1\">'3cb99b5bb69dcbe69c694c78e364c589eca8781e'</span>\ninfo:<span class=\"w\"> </span>updating<span class=\"w\"> </span>toolchain<span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'leanprover/lean4:v4.14.0-rc2'</span>\ninfo:<span class=\"w\"> </span>restarting<span class=\"w\"> </span>Lake<span class=\"w\"> </span>via<span class=\"w\"> </span>Elan\ninfo:<span class=\"w\"> </span>test:<span class=\"w\"> </span>no<span class=\"w\"> </span>previous<span class=\"w\"> </span>manifest,<span class=\"w\"> </span>creating<span class=\"w\"> </span>one<span class=\"w\"> </span>from<span class=\"w\"> </span>scratch\ntrace:<span class=\"w\"> </span>private/require-test<span class=\"se\">\\.\\.</span>lake<span class=\"se\">\\p</span>ackages<span class=\"se\">\\s</span>cilean&gt;<span class=\"w\"> </span>git<span class=\"w\"> </span>fetch<span class=\"w\"> </span>--tags<span class=\"w\"> </span>--force<span class=\"w\"> </span>origin\nerror:<span class=\"w\"> </span><span class=\"s1\">'SciLean'</span><span class=\"w\"> </span>was<span class=\"w\"> </span>downloaded<span class=\"w\"> </span>incorrectly<span class=\"p\">;</span><span class=\"w\"> </span>you<span class=\"w\"> </span>will<span class=\"w\"> </span>need<span class=\"w\"> </span>to<span class=\"w\"> </span>manually<span class=\"w\"> </span>delete<span class=\"w\"> </span><span class=\"s1\">'private/require-test\\.\\.lake\\packages\\scilean'</span>:<span class=\"w\"> </span>permission<span class=\"w\"> </span>denied<span class=\"w\"> </span><span class=\"o\">(</span>error<span class=\"w\"> </span>code:<span class=\"w\"> </span><span class=\"m\">13</span><span class=\"o\">)</span>\n<span class=\"w\">  </span>file:<span class=\"w\"> </span>private/require-test<span class=\"se\">\\.\\.</span>lake<span class=\"se\">\\p</span>ackages<span class=\"se\">\\s</span>cilean<span class=\"se\">\\.</span>git<span class=\"se\">\\o</span>bjects<span class=\"se\">\\p</span>ack<span class=\"se\">\\p</span>ack-07df397d18640e15e0e7822b39a4535cc6b5a17e.idx\nerror:<span class=\"w\"> </span>test:<span class=\"w\"> </span>package<span class=\"w\"> </span><span class=\"s1\">'scilean'</span><span class=\"w\"> </span>was<span class=\"w\"> </span>required<span class=\"w\"> </span>as<span class=\"w\"> </span><span class=\"s1\">'SciLean'</span>\n</code></pre></div>\n<p>In which case, I believe the underlying error was just the mispelling?</p>",
        "id": 484620931,
        "sender_full_name": "Mac Malone",
        "timestamp": 1732668948
    },
    {
        "content": "<p>(The error message you encountered still does need improvement, though.)</p>",
        "id": 484621058,
        "sender_full_name": "Mac Malone",
        "timestamp": 1732669003
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> Improved error message is at <a href=\"https://github.com/leanprover/lean4/pull/6231\">lean4#6231</a>. Feel free to suggest any changes.</p>",
        "id": 484628786,
        "sender_full_name": "Mac Malone",
        "timestamp": 1732674323
    },
    {
        "content": "<p>thanks for all your help, but sorry I still dont understand how to install it, is it just that I use this line </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">require</span><span class=\"w\"> </span><span class=\"s2\">\"lecopivo\"</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"s2\">\"SciLean\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"s2\">\"master\"</span>\n<span class=\"w\">  </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/lecopivo/SciLean\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"s2\">\"master\"</span>\n</code></pre></div>\n<p>or something more? I tried that but it didnt work</p>",
        "id": 484649429,
        "sender_full_name": "Robert",
        "timestamp": 1732689334
    },
    {
        "content": "<p>any updates here <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> <span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span>? I also am tagging <span class=\"user-mention\" data-user-id=\"346070\">@Tomas Skrivan</span> since he is the owner of SciLean?</p>",
        "id": 484845416,
        "sender_full_name": "Robert",
        "timestamp": 1732773253
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"782569\">@Robert</span>  The correct invocation should be:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">require</span><span class=\"w\"> </span><span class=\"s2\">\"lecopivo\"</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"s2\">\"scilean\"</span>\n</code></pre></div>",
        "id": 484845504,
        "sender_full_name": "Mac Malone",
        "timestamp": 1732773339
    },
    {
        "content": "<p>Thank you so much <span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span> ! it worked</p>",
        "id": 484853045,
        "sender_full_name": "Robert",
        "timestamp": 1732778042
    },
    {
        "content": "<p>Sorry Robert, I thought I'd replied earlier today, but apparently not. I did try out your previous attempt above, and although it didn't work right away, I thought the error messages did clearly explain what to change.</p>",
        "id": 484860705,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732781498
    }
]