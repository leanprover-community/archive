[
    {
        "content": "<p>Hi, I recently wrote a small tool to plot lines of code based on <code>git blame</code> and thought mathlib4 would be a nice benchmark. There are two (interactive) graphs (that don't work well on mobile, sorry):</p>\n<ul>\n<li><a href=\"https://plugh.de/tmp/mathlib4_years.html\">Lines of mathlib4 code over time, split up by the year they were written</a></li>\n<li><a href=\"https://plugh.de/tmp/mathlib4_authors.html\">Lines of mathlib4 code over time, split up by author</a> (I limited the graph to 50 authors but it's still pretty unwieldy.)</li>\n</ul>\n<p>The commits are roughly ordered by their committer date, but inside each month they are ordered topologically and spread out to cover the entire month evenly. This is also the reason why the graph seems to flatten out around the beginning of the current month - there's just not many commits yet.</p>\n<p>Controls: Click and drag or scroll to zoom. Double-click to fully zoom back out. Click a commit to pin its info to the right, for copy-pasting. Click on the legend to hide/show individual years or authors. Ctrl-click to show only a specific year or author.</p>\n<p><a href=\"/user_uploads/3121/xHqUDLIUQACgybVb4O9y3KlP/image.png\">image.png</a><br>\n<a href=\"/user_uploads/3121/M4Tz4KPMqmT6lkbyjyfXUaLz/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/xHqUDLIUQACgybVb4O9y3KlP/image.png\" title=\"image.png\"><img data-original-dimensions=\"792x658\" src=\"/user_uploads/thumbnail/3121/xHqUDLIUQACgybVb4O9y3KlP/image.png/840x560.webp\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/M4Tz4KPMqmT6lkbyjyfXUaLz/image.png\" title=\"image.png\"><img data-original-dimensions=\"789x628\" src=\"/user_uploads/thumbnail/3121/M4Tz4KPMqmT6lkbyjyfXUaLz/image.png/840x560.webp\"></a></div>",
        "id": 456061245,
        "sender_full_name": "Joscha Mennicken",
        "timestamp": 1722643102
    },
    {
        "content": "<p>big thanks to our greatest contributor Misc. Authors for making the project possible <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span></p>",
        "id": 456127333,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722676320
    },
    {
        "content": "<p>i'm curious, is there a significant change in policy/workflow that caused the slowing of growth around the start of july 2023?</p>",
        "id": 456127795,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722676717
    },
    {
        "content": "<p>The port ended!</p>",
        "id": 456127820,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1722676733
    },
    {
        "content": "<p>ahhh</p>",
        "id": 456127823,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722676739
    },
    {
        "content": "<p>it looks like the sudden drop is the removing of <code>#align</code>-like lines, for those wondering.</p>",
        "id": 456128041,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722676867
    },
    {
        "content": "<p>I've produced the same set of graphs for the lean4 repository (excluding stage0 as best as I could), and they look a lot more exciting :P. I've also updated the mathlib4 author graph to use the author names instead of email addresses, and to count the amount of hidden misc authors.</p>\n<ul>\n<li><a href=\"https://plugh.de/tmp/lean4_years.html\">Lines of lean4 code over time, split up by the year they were written</a></li>\n<li><a href=\"https://plugh.de/tmp/lean4_authors.html\">Lines of lean4 code over time, split up by author</a></li>\n</ul>\n<p>If you're wondering about the vertical jumps from mid-2021 to mid-2023, those are due to lake and lean4 being developed in parallel but separate repos/branches, and they go away when lake is merged into lean.</p>\n<p><a href=\"/user_uploads/3121/ABkwS38CX6pEjy5F-1msxOE9/image.png\">image.png</a><br>\n<a href=\"/user_uploads/3121/JKAMAc2B9k3F6svdaTD6368o/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/ABkwS38CX6pEjy5F-1msxOE9/image.png\" title=\"image.png\"><img data-original-dimensions=\"789x688\" src=\"/user_uploads/thumbnail/3121/ABkwS38CX6pEjy5F-1msxOE9/image.png/840x560.webp\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/JKAMAc2B9k3F6svdaTD6368o/image.png\" title=\"image.png\"><img data-original-dimensions=\"790x631\" src=\"/user_uploads/thumbnail/3121/JKAMAc2B9k3F6svdaTD6368o/image.png/840x560.webp\"></a></div>",
        "id": 456141878,
        "sender_full_name": "Joscha Mennicken",
        "timestamp": 1722686048
    },
    {
        "content": "<p>Perhaps for mathlib it would be more interesting to have plots ignoring everything before the end of the port</p>",
        "id": 456142021,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1722686198
    },
    {
        "content": "<p>According to <a href=\"https://leanprover-community.github.io/mathlib-port-status/\">https://leanprover-community.github.io/mathlib-port-status/</a>, the port was declared complete on 2023-07-16, so here are the mathlib4 graphs but every commit before 2023-07-16 is ignored:</p>\n<ul>\n<li><a href=\"https://plugh.de/tmp/mathlib4_years_after_rewrite.html\">Lines of mathlib4 code since 2023-07-16, split up by the year they were written</a> (somewhat boring)</li>\n<li><a href=\"https://plugh.de/tmp/mathlib4_authors_after_rewrite.html\">Lines of mathlib4 code since 2023-07-16, split up by author</a> (now <span class=\"user-mention silent\" data-user-id=\"387244\">Ya&euml;l Dillies</span> is at the bottom)</li>\n</ul>\n<p>By the way, authors are sorted roughly by their area below the graph.</p>\n<p><a href=\"/user_uploads/3121/gaXjTk5RGT2pxhDWIP0EDCRM/image.png\">image.png</a><br>\n<a href=\"/user_uploads/3121/jGxkTVVepCshr493J8KK3Mmh/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/gaXjTk5RGT2pxhDWIP0EDCRM/image.png\" title=\"image.png\"><img data-original-dimensions=\"793x658\" src=\"/user_uploads/thumbnail/3121/gaXjTk5RGT2pxhDWIP0EDCRM/image.png/840x560.webp\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/jGxkTVVepCshr493J8KK3Mmh/image.png\" title=\"image.png\"><img data-original-dimensions=\"791x736\" src=\"/user_uploads/thumbnail/3121/jGxkTVVepCshr493J8KK3Mmh/image.png/840x560.webp\"></a></div>",
        "id": 456145475,
        "sender_full_name": "Joscha Mennicken",
        "timestamp": 1722687670
    },
    {
        "content": "<p>Yet I don't beat Misc. <span aria-label=\"pensive\" class=\"emoji emoji-1f614\" role=\"img\" title=\"pensive\">:pensive:</span></p>",
        "id": 456147475,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1722688145
    },
    {
        "content": "<p>These were very interesting charts!  I got credit (or blame) for more lines than I had expected.  Looking a little more closely, it turns out that about half of them came from splitting up big files, i.e., other people's hard work.</p>",
        "id": 456172784,
        "sender_full_name": "Scott Carnahan",
        "timestamp": 1722698178
    },
    {
        "content": "<p>I find it interesting how mathlib seems to be growing at a fairly consistent rate compared to other repos. The size and complexity doesn't seem to be slowing it down.</p>",
        "id": 456177143,
        "sender_full_name": "Joscha Mennicken",
        "timestamp": 1722699172
    },
    {
        "content": "<p>Scott, that kind of phenomenon is part of why we stopped having such statistics on the community website. And of course the port completely changed those statistics.</p>",
        "id": 456213895,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1722714695
    },
    {
        "content": "<p>I've updated the graph of <a href=\"https://plugh.de/tmp/mathlib4_years.html\">lines of mathlib4 code over time, split up by the year they were written</a> and created <a href=\"https://plugh.de/tmp/mathlib4_years_adjusted.html\">a version without the refactor jump at 2024-07-19</a> (the lines before the refactor jump are scaled down linearly). See the original message for why the last month may look too flat.</p>\n<p><a href=\"/user_uploads/3121/mS69Uj-GZfcuz9PiiRzWI7LX/image.png\">image.png</a><br>\n<a href=\"/user_uploads/3121/91S507tifyZSSUUtiUx9UB_X/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/mS69Uj-GZfcuz9PiiRzWI7LX/image.png\" title=\"image.png\"><img data-original-dimensions=\"1586x1334\" src=\"/user_uploads/thumbnail/3121/mS69Uj-GZfcuz9PiiRzWI7LX/image.png/840x560.webp\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/91S507tifyZSSUUtiUx9UB_X/image.png\" title=\"image.png\"><img data-original-dimensions=\"1588x1338\" src=\"/user_uploads/thumbnail/3121/91S507tifyZSSUUtiUx9UB_X/image.png/840x560.webp\"></a></div>",
        "id": 493131487,
        "sender_full_name": "Joscha Mennicken",
        "timestamp": 1736633454
    },
    {
        "content": "<p>I would guess the refactor jump can be addressed by including mathlib dependencies (following the shas in the lake-manifest.json)</p>",
        "id": 493137490,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1736639718
    },
    {
        "content": "<p>That is, it represents code being upstreamed</p>",
        "id": 493137502,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1736639729
    },
    {
        "content": "<p>Oh, I assumed it was removing <code>#align</code>.</p>",
        "id": 493141611,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736643701
    },
    {
        "content": "<p>Yes, that's the cause of the jump (commit 465f26fde59aa31d051ef0b6db1fb34476802b64) as you can see if you zoom into the graph enough.</p>",
        "id": 493141743,
        "sender_full_name": "Joscha Mennicken",
        "timestamp": 1736643830
    }
]