[
    {
        "content": "<p>Does <code>notation</code> have its own precedence values, disconnected from those of <code>infix</code> and similar?</p>\n<p>The following works:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">infix</span><span class=\"o\">:</span><span class=\"mi\">63</span><span class=\"w\"> </span><span class=\"s2\">\" _and_ \"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">And</span>\n<span class=\"kn\">prefix</span><span class=\"o\">:</span><span class=\"mi\">64</span><span class=\"w\"> </span><span class=\"s2\">\"_not_\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Not</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"n\">not_</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">and_</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">not_</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">and_</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>The following doesn't:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">infix</span><span class=\"o\">:</span><span class=\"mi\">63</span><span class=\"w\"> </span><span class=\"s2\">\" _and_ \"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">And</span>\n<span class=\"kn\">notation</span><span class=\"o\">:</span><span class=\"mi\">64</span><span class=\"w\"> </span><span class=\"s2\">\"_not_\"</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Not</span><span class=\"w\"> </span><span class=\"n\">X</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"n\">not_</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">and_</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">not_</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">and_</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>And to make things even weirder, the following works:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">infix</span><span class=\"o\">:</span><span class=\"mi\">63</span><span class=\"w\"> </span><span class=\"s2\">\" _and_ \"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">And</span>\n<span class=\"kn\">notation</span><span class=\"o\">:</span><span class=\"mi\">64</span><span class=\"w\"> </span><span class=\"s2\">\"_not_\"</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Not</span><span class=\"w\"> </span><span class=\"n\">X</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">and_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"n\">not_</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">and_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">not_</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 503787214,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1741266105
    },
    {
        "content": "<p><code>notation:64 \"_not_\" X =&gt; Not X</code> is equivalent to <code>notation:64 \"_not_\" X:0 =&gt; Not X</code></p>",
        "id": 503790019,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741266891
    },
    {
        "content": "<p>What does the second colon do?</p>",
        "id": 503790436,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1741267008
    },
    {
        "content": "<p>It's the precedence associated with the subterm, varying these allows you to create mixed precedence parsers that for example bind strongly on the left and weakly on the right.<br>\n<code>infix:63 \" _and_ \" =&gt; And</code> is <code>notation:63 lhs:64 \" _and_ \" rhs:64 =&gt; And lhs rhs</code><br>\n<code>prefix:64 \"_not_\" =&gt; Not</code> is <code>notation:64 \"_not_\" arg:64 =&gt; Not arg</code><br>\n<code>notation:64 \"_not_\" X =&gt; Not X</code> is <code>notation:64 \"_not_\" X:0 =&gt; Not X</code></p>",
        "id": 503791928,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741267394
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"417654\">Martin Dvořák</span> has marked this topic as resolved.</p>",
        "id": 503793971,
        "sender_full_name": "Notification Bot",
        "timestamp": 1741267922
    },
    {
        "content": "<p>See also <a href=\"https://lean-lang.org/doc/reference/latest/Notations-and-Macros/Notations\">https://lean-lang.org/doc/reference/latest/Notations-and-Macros/Notations</a></p>\n<blockquote>\n<p>While custom operators have a single notion of precedence, there are many involved in a notation. The notation itself has a precedence, as does each term to be parsed. The notation's precedence determines which contexts it may be parsed in: the parser only attempts to parse productions whose precedence is at least as high as the current context. For example, because multiplication has higher precedence than addition, the parser will attempt to parse an infix multiplication term while parsing the arguments to addition, but not vice versa. The precedence of each term to be parsed determines which other productions may occur in them.</p>\n</blockquote>",
        "id": 503797679,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1741268888
    }
]