[
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"455791\">Yuyang Zhao</span> <a href=\"#narrow/stream/287929-mathlib4/topic/RFC.3A.20QuotientGroup.20etc/near/458407804\">said</a>:</p>\n<blockquote>\n<p>Should we reduce the use of <code>(· ≈ ·)</code> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Setoid.r#doc\">docs#Setoid.r</a> in favor of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Setoid.Rel#doc\">docs#Setoid.Rel</a> or even make <code>Setoid</code> a <code>FunLike</code>?</p>\n</blockquote>\n<blockquote>\n<p>Currently <code>Quotient</code> APIs usually use <code>(· ≈ ·)</code> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Setoid.r#doc\">docs#Setoid.r</a>, which is annoying to use.</p>\n</blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/287929-mathlib4/topic/RFC.3A.20QuotientGroup.20etc/near/459327440\">said</a>:</p>\n<blockquote>\n<p>I think we're somewhat stuck here because <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Setoid.r#doc\">docs#Setoid.r</a> is in core yet <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Setoid.Rel#doc\">docs#Setoid.Rel</a> is in mathlib. So we might need a Lean RFC to tidy this up</p>\n</blockquote>\n<p>In core, <code>(· ≈ ·)</code> is still used after <a href=\"https://github.com/leanprover/lean4/commit/cd903bde772f94116b7c9d1f5b15116936c3aa56\">making <code>Setoid</code> arguments implicit</a>, should this be changed?</p>",
        "id": 465736115,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1724844781
    },
    {
        "content": "<p>I think to justify dropping that notation, <code>Setoid</code> should be changed from a <code>class</code> to a <code>structure</code></p>",
        "id": 465763101,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1724850802
    },
    {
        "content": "<p>I've been cleaning up the <code>Quotient</code> APIs recently (<a href=\"https://github.com/leanprover-community/mathlib4/pull/16210\">#16210</a>), but <code>Quotient.lift*</code> uses <code>· ≈ ·</code> while <code>Quotient.lift*'</code> uses <code>Setoid.r</code>. I feel that deprecating <code>Quotient.lift*'</code> directly is problematic.</p>",
        "id": 466970386,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1725287688
    },
    {
        "content": "<p>Maybe I should make new APIs that use typeclasses and migrate to that.</p>",
        "id": 466971391,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1725287933
    },
    {
        "content": "<p>The main things I've found awkward in working with quotients are (a) there are too many similar definitions for doing the same thing and it keeps being necessary to rewrite from one to another because some useful lemma isn't available for all the definitions and (b) some definitions have too much implicit, so you get hypotheses or goals that just say <code>≈</code> or <code>Setoid.r</code> without ever saying which setoid is involved (when I'm e.g. working with quotient by the actions of both a group and a subgroup thereof), and so a <code>change</code> to something else is needed to make the goal state readable.</p>\n<p>So eliminating the <code>≈</code> notation (and associated type class), and changing <code>Setoid</code> to a structure, and generally ensuring that setoids are only implicit when they really can be deduced from types of other hypotheses, seem like they would be desirable changes to make the quotient API easier to use.</p>",
        "id": 467066869,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1725320080
    },
    {
        "content": "<p>I second the first point. There's a bunch of <code>Quot</code> lemmas, a bunch of identical <code>Quotient</code> lemmas, and they're not even consistently named all the time!</p>",
        "id": 467068649,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1725321084
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"266253\">Joseph Myers</span> <a href=\"#narrow/stream/113488-general/topic/.60.28.C2.B7.20.E2.89.88.20.C2.B7.29.60.20in.20.60Quotient.60.20APIs/near/467066869\">said</a>:</p>\n<blockquote>\n<p>some definitions have too much implicit, so you get hypotheses or goals that just say <code>≈</code> or <code>Setoid.r</code> without ever saying which setoid is involved (when I'm e.g. working with quotient by the actions of both a group and a subgroup thereof), and so a <code>change</code> to something else is needed to make the goal state readable.</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/16254\">#16254</a> (the first dependency in <a href=\"https://github.com/leanprover-community/mathlib4/pull/16210\">#16210</a>) may be a simple solution (pretty printing <code>@Setoid.r _ s a b</code> as <code>s a b</code>).</p>",
        "id": 467082816,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1725327483
    },
    {
        "content": "<p>The APIs in the core no longer use instance <code>Setoid</code> parameters, but some still use <code>≈</code>, so I now feel it's not a good idea to simply remove the duplicate APIs with <code>'</code>. Also cleaning up <code>Quotient</code> APIs does not resolve defeq abuse. So I'm considering directly migrating to the new APIs (<a href=\"https://github.com/leanprover-community/mathlib4/pull/16421\">#16421</a>). Feel free to comment.</p>",
        "id": 467084441,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1725328246
    },
    {
        "content": "<p>I just read this thread after spending the past several days bashing my head over Quotient. I finally got it to work for my purposes <a href=\"https://github.com/AviCraimer/relational-calculus-library-lean4/blob/main/RelationalCalculus/Quotient.lean\">here</a>. Now reading this I'm wondering if I should have done something different. </p>\n<p>The comment in the source code says: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/--</span>\n<span class=\"sd\">`Quotient α s` is the same as `Quot α r`, but it is specialized to a setoid `s`</span>\n<span class=\"sd\">(that is, an equivalence relation) instead of an arbitrary relation.</span>\n<span class=\"sd\">Prefer `Quotient` over `Quot` if your relation is actually an equivalence relation.</span>\n<span class=\"sd\">-/</span>\n</code></pre></div>\n<p>This led me to think that Quotient was the correct choice for my purpose since I already had an equivalence relation. If there is a newer / better way to do quotients it might be good idea to document this in the source code at the Quotient definition.</p>",
        "id": 470780104,
        "sender_full_name": "Avi Craimer",
        "timestamp": 1726532217
    }
]