[
    {
        "content": "<p>Greetings!</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c\">/-</span><span class=\"cm\">Show that if $H$ is a normal subgroup of $G$ and $H$ is a $p$-group, then $H$ is contained in every Sylow $p$-subgroup of $G$.-/</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Sylow</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">SetLike</span><span class=\"bp\">.</span><span class=\"n\">instFinite</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Pointwise</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MulDistribMulAction</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fact</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">Prime</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h_normal</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"bp\">.</span><span class=\"n\">Normal</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h_pgroup</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsPGroup</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sylow</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- Given any Sylow $p$ group $P$ of $G$,</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">P</span>\n<span class=\"w\">  </span><span class=\"c1\">-- By Sylow first theorem, there exists a Sylow $p$ group $P_1$ s.t., $H \\leq P_1$.</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">H_in_sylow_p</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">IsPGroup</span><span class=\"bp\">.</span><span class=\"n\">exists_le_sylow</span><span class=\"w\"> </span><span class=\"n\">h_pgroup</span>\n<span class=\"w\">  </span><span class=\"n\">rcases</span><span class=\"w\"> </span><span class=\"n\">H_in_sylow_p</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">P₁</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hP₁</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"c1\">-- By Sylow second theorem, $P$ is conjugates to $P_1$</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">sylow_conj_same</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">instIsPretransitiveSylowOfFactPrimeOfFinite</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"c1\">-- That is, there exists a $g \\in G$, s.t., $g \\cdot P_1 = P$</span>\n<span class=\"w\">  </span><span class=\"n\">replace</span><span class=\"w\"> </span><span class=\"n\">sylow_conj_same</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">sylow_conj_same</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">P₁</span><span class=\"w\"> </span><span class=\"n\">P</span>\n<span class=\"w\">  </span><span class=\"n\">rcases</span><span class=\"w\"> </span><span class=\"n\">sylow_conj_same</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">g</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hg</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"c1\">-- By the normality of $H$, $g \\cdot H = H$</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">hg</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">Normal</span><span class=\"bp\">.</span><span class=\"n\">conjAct</span><span class=\"w\"> </span><span class=\"n\">h_normal</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"c1\">-- Thus $H \\leq P_1 \\Rightarrow H = g \\cdot H \\leq g \\cdot P_1 = P$</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">pointwise_smul_le_pointwise_smul_iff</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">ConjAct</span><span class=\"bp\">.</span><span class=\"n\">instMulDistribMulAction</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hP₁</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Sylow</span><span class=\"bp\">.</span><span class=\"n\">pointwise_smul_def</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">P₁</span><span class=\"o\">)]</span>\n</code></pre></div>\n<p>The above is the problem I am working on. The last <code> rw </code> is failed, and it warns that</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">rewrite'</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">did</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">find</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">pattern</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">expression</span>\n<span class=\"w\">  </span><span class=\"bp\">↑</span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">P₁</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>However, I hovered my mouse on every single character to check their types, and it seems to me that <code>↑(g • P₁)</code> is identical to the <code>↑(g • P₁)</code> in the goal. So I wonder why the rewrite doesn't work here, did I miss something? By the way, I am using v4.9.0-rc3, I imported mathlib.<br>\nThanks in advance for your help!</p>",
        "id": 453743963,
        "sender_full_name": "Suzuka Yu",
        "timestamp": 1721838688
    },
    {
        "content": "<p>Do you specifically want to understand why the rewrite isn't working?</p>",
        "id": 453745511,
        "sender_full_name": "Julian Berman",
        "timestamp": 1721839068
    },
    {
        "content": "<p>If not, removing your last rewrite and trying <code>exact?</code> shows that <code>exact hP₁</code> closes your goal.</p>",
        "id": 453745660,
        "sender_full_name": "Julian Berman",
        "timestamp": 1721839097
    },
    {
        "content": "<p>If you are trying to understand the rewrite, I don't immediately understand why it doesn't work either, the SMul and the coercion seem to be the same in the goal and in <code>pointwise_smul_def</code>, and if I try <code>norm_cast</code> it simply solves the goal, so I don't remember what the right thing is that will unfold stuff and show you what's different about them, but someone else will.</p>",
        "id": 453747799,
        "sender_full_name": "Julian Berman",
        "timestamp": 1721839586
    },
    {
        "content": "<p>I might be wrong, but some clicking in the infoview shows that your goal is using <code>Sylow.mulAction</code> while the theorem you are trying to rewrite uses <code>Sylow.pointwiseMulAction</code>, I would expect that to be the source of the problem</p>",
        "id": 453750026,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1721840306
    },
    {
        "content": "<p>Right:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">...</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">pointwise_smul_le_pointwise_smul_iff</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">ConjAct</span><span class=\"bp\">.</span><span class=\"n\">instMulDistribMulAction</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hP₁</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Sylow</span><span class=\"bp\">.</span><span class=\"n\">pointwise_smul_def</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">P₁</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">le_of_eq</span>\n<span class=\"w\">  </span><span class=\"n\">symm</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span>\n<span class=\"cm\">  foo : ↑(g • P₁) = g • ↑P₁</span>\n<span class=\"cm\">  ⊢ ↑(g • P₁) = g • H</span>\n<span class=\"cm\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"c1\">-- what are the precise differences between the goal and `foo`?</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span>\n<span class=\"cm\">  ⊢ Sylow.mulAction = Sylow.pointwiseMulAction (problem)</span>\n<span class=\"cm\">  ⊢ ConjAct.instMulDistribMulAction = inst✝¹ (problem)</span>\n<span class=\"cm\">  ⊢ H = ↑P₁ (expected)</span>\n<span class=\"cm\">  -/</span>\n</code></pre></div>",
        "id": 453750982,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1721840590
    },
    {
        "content": "<p>Aah, the issue is that</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MulDistribMulAction</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\">  </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>means \"let G act on G in a completely arbitrary way subject to certain axioms such as <code>1 • g = g</code> and <code>g • 1 = 1</code>. In other words, it means something like \"let us fix a random group homomorphism from G to Aut(G)\". You then go on to let G act on the Sylow p-subgroups of G in the way induced from this random action. The errors above are saying \"this action is random and hence I can't prove it's equal to the action which you have implicitly chosen\".</p>",
        "id": 453751434,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1721840723
    },
    {
        "content": "<p>This line from mathlib</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">Sylow</span><span class=\"bp\">.</span><span class=\"n\">mulAction</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MulAction</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Sylow</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">compHom</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">MulAut</span><span class=\"bp\">.</span><span class=\"n\">conj</span>\n</code></pre></div>\n<p>says \"let G act on the Sylow p-subgroups of G by using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MulAut.conj#doc\">docs#MulAut.conj</a> \", so that is the action you need to use.</p>",
        "id": 453753072,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1721841174
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">...</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">pointwise_smul_le_pointwise_smul_iff</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">ConjAct</span><span class=\"bp\">.</span><span class=\"n\">instMulDistribMulAction</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hP₁</span>\n<span class=\"w\">  </span><span class=\"n\">letI</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MulDistribMulAction</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ConjAct</span><span class=\"bp\">.</span><span class=\"n\">instMulDistribMulAction</span><span class=\"w\"> </span><span class=\"c1\">-- the correct action</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Sylow</span><span class=\"bp\">.</span><span class=\"n\">pointwise_smul_def</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">P₁</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"c1\">-- now it works</span>\n<span class=\"w\">  </span><span class=\"n\">assumption</span><span class=\"w\"> </span><span class=\"c1\">-- :tada:</span>\n</code></pre></div>\n<p>(and remove <code>[MulDistribMulAction G G]</code> from the top)</p>",
        "id": 453754163,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1721841416
    },
    {
        "content": "<p>oh, so that's the connection. I see. Thanks a lot!</p>\n<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113488-general/topic/rw.20failed.20in.20rewriting.20what.20seems.20to.20be.20the.20same.20thing/near/453751434\">发言道</a>：</p>\n<blockquote>\n<p>Aah, the issue is that</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MulDistribMulAction</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\">  </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>means \"let G act on G in a completely arbitrary way subject to certain axioms such as <code>1 • g = g</code> and <code>g • 1 = 1</code>. In other words, it means something like \"let us fix a random group homomorphism from G to Aut(G)\". You then go on to let G act on the Sylow p-subgroups of G in the way induced from this random action. The errors above are saying \"this action is random and hence I can't prove it's equal to the action which you have implicitly chosen\".</p>\n</blockquote>",
        "id": 454797375,
        "sender_full_name": "Suzuka Yu",
        "timestamp": 1722251257
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"739620\">Suzuka Yu</span> has marked this topic as resolved.</p>",
        "id": 455320848,
        "sender_full_name": "Notification Bot",
        "timestamp": 1722415387
    }
]