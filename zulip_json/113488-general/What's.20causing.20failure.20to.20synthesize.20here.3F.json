[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">myTerms</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">var</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">myTerms</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">other</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">myTerms</span>\n\n<span class=\"kn\">prefix</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"s2\">\"**\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">myTerms</span><span class=\"bp\">.</span><span class=\"n\">var</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">myCheck</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">myTerms</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">**_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">myTerms</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Empty</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">testFunc</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">myTerms</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">myCheck</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">**</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">s</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">testFunc</span><span class=\"w\"> </span><span class=\"bp\">**</span><span class=\"s2\">\"m\"</span>\n</code></pre></div>\n<p>Seems to me there's only a single possible way to resolve the type, but I'm a bit lost. Basically, I want to make a function that enforces at the type-level that <code>t</code> be pattern-matchable with <code>**s</code>. Anyone got tips/suggestions/readings?</p>",
        "id": 466774693,
        "sender_full_name": "nrs",
        "timestamp": 1725233006
    },
    {
        "content": "<p>We can see explicitly that there's more than way like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">testFunc</span><span class=\"w\"> </span><span class=\"bp\">**</span><span class=\"s2\">\"m\"</span><span class=\"w\"> </span><span class=\"n\">myTerms</span><span class=\"bp\">.</span><span class=\"n\">other</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">testFunc</span><span class=\"w\"> </span><span class=\"bp\">**</span><span class=\"s2\">\"m\"</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">myTerms</span><span class=\"bp\">.</span><span class=\"n\">var</span><span class=\"w\"> </span><span class=\"s2\">\"hello\"</span>\n</code></pre></div>\n<p>Maybe add the assumption <code>[Nonempty (myCheck t)]</code> instead.</p>",
        "id": 468518687,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1725774760
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"347475\">Bjørn Kjos-Hanssen ☀️</span> <a href=\"#narrow/stream/113488-general/topic/What's.20causing.20failure.20to.20synthesize.20here.3F/near/468518687\">said</a>:</p>\n<blockquote>\n<p>We can see explicitly that there's more than way like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">testFunc</span><span class=\"w\"> </span><span class=\"bp\">**</span><span class=\"s2\">\"m\"</span><span class=\"w\"> </span><span class=\"n\">myTerms</span><span class=\"bp\">.</span><span class=\"n\">other</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">testFunc</span><span class=\"w\"> </span><span class=\"bp\">**</span><span class=\"s2\">\"m\"</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">myTerms</span><span class=\"bp\">.</span><span class=\"n\">var</span><span class=\"w\"> </span><span class=\"s2\">\"hello\"</span>\n</code></pre></div>\n<p>Maybe add the assumption <code>[Nonempty (myCheck t)]</code> instead.</p>\n</blockquote>\n<p>ah I see! thanks a lot for the example!</p>",
        "id": 468666453,
        "sender_full_name": "nrs",
        "timestamp": 1725854604
    }
]