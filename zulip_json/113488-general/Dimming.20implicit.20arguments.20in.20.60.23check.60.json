[
    {
        "content": "<p>I just thought that it could improve user experience if I could quickly see the explicit arguments of a library function, so for example when typing</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">AffineSubspace</span>\n</code></pre></div>\n<p>Seeing highlighted output instead of the monotone current state. What do you think? Would it be easy to implement? Would it be generally appreciated?<br>\n<a href=\"/user_uploads/3121/oR95OrT80LHh4Z_CrtbZZnP5/check-AffineSubspace-hl.png\">check-AffineSubspace-hl.png</a> <br>\n<a href=\"/user_uploads/3121/nlzIoo1Gx2r2cXGTgz2Uc2A7/check-AffineSubspace.png\">check-AffineSubspace.png</a>.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/oR95OrT80LHh4Z_CrtbZZnP5/check-AffineSubspace-hl.png\" title=\"check-AffineSubspace-hl.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"776x100\" src=\"/user_uploads/thumbnail/3121/oR95OrT80LHh4Z_CrtbZZnP5/check-AffineSubspace-hl.png/840x560.webp\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/nlzIoo1Gx2r2cXGTgz2Uc2A7/check-AffineSubspace.png\" title=\"check-AffineSubspace.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"776x100\" src=\"/user_uploads/thumbnail/3121/nlzIoo1Gx2r2cXGTgz2Uc2A7/check-AffineSubspace.png/840x560.webp\"></a></div>",
        "id": 553249986,
        "sender_full_name": "Mirek Ol≈°√°k",
        "timestamp": 1762094911
    },
    {
        "content": "<p>I have the impression that this was discussed recently and it was hard, but would certainly be nice</p>",
        "id": 553250337,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1762095067
    },
    {
        "content": "<p>Also on hover</p>",
        "id": 553250345,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1762095073
    },
    {
        "content": "<p>Here is the recent discussion. It was about the signature help, not about #check. <a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/rfc.3A.20show.20arity.20of.20current.20function/with/543837834\">#lean4 &gt; rfc: show arity of current function</a></p>",
        "id": 553250401,
        "sender_full_name": "Markus Himmel",
        "timestamp": 1762095130
    },
    {
        "content": "<p>Hm, it should not be that hard at least in terms of generating HTML... Only that it would miss the hover feature, so it cannot be the default.</p>",
        "id": 553250690,
        "sender_full_name": "Mirek Ol≈°√°k",
        "timestamp": 1762095413
    },
    {
        "content": "<p>apparently we can do diagrams in the docstrings and it shows up in the infoview <a class=\"message-link\" href=\"/#narrow/channel/287929-mathlib4/topic/readable.20commutative.20diagrams.20in.20docstrings/near/531216647\">#mathlib4 &gt; readable commutative diagrams in docstrings @ üí¨</a></p>",
        "id": 553251026,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762095735
    },
    {
        "content": "<p>so the infoview is pretty powerful</p>",
        "id": 553251030,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762095741
    },
    {
        "content": "<p>In a sense, clickable grayed-out terms are possible</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">ProofWidgets</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Qq</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">ProofWidgets</span><span class=\"w\"> </span><span class=\"n\">Jsx</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Qq</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">makeWidget</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">MetaM</span><span class=\"w\"> </span><span class=\"n\">Html</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"n\">span</span><span class=\"w\"> </span><span class=\"bp\">¬´</span><span class=\"kn\">class</span><span class=\"bp\">¬ª=</span><span class=\"s2\">\"goal-inaccessible\"</span><span class=\"bp\">&gt;</span>\n<span class=\"w\">    </span><span class=\"bp\">&lt;</span><span class=\"n\">InteractiveCode</span><span class=\"w\"> </span><span class=\"n\">fmt</span><span class=\"bp\">=</span><span class=\"o\">{</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Widget</span><span class=\"bp\">.</span><span class=\"n\">ppExprTagged</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">/&gt;</span><span class=\"w\"> </span><span class=\"bp\">&lt;/</span><span class=\"n\">span</span><span class=\"bp\">&gt;</span>\n\n<span class=\"bp\">#</span><span class=\"n\">html</span><span class=\"w\"> </span><span class=\"n\">makeWidget</span>\n</code></pre></div>",
        "id": 553253115,
        "sender_full_name": "Mirek Ol≈°√°k",
        "timestamp": 1762097632
    },
    {
        "content": "<p>(only it is also italic)</p>",
        "id": 553253167,
        "sender_full_name": "Mirek Ol≈°√°k",
        "timestamp": 1762097678
    },
    {
        "content": "<p>My personal preference would be to add a version of #check that only shows explicit arguments. (Probably, adding a configuration option to #check would be the way, i.e. this needs core modifications.)</p>",
        "id": 553255252,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1762099601
    },
    {
        "content": "<p>Here is how to write this as a separate command, today:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">Elab</span><span class=\"w\"> </span><span class=\"n\">Command</span><span class=\"w\"> </span><span class=\"n\">PrettyPrinter</span><span class=\"w\"> </span><span class=\"n\">Delaborator</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">elab</span><span class=\"w\"> </span><span class=\"n\">tk</span><span class=\"o\">:</span><span class=\"s2\">\"#check' \"</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"o\">:</span><span class=\"n\">ident</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">runTermElabM</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">realizeGlobalConstWithInfos</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"n\">addCompletionInfo</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"bp\">.</span><span class=\"n\">getId</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">danglingDot</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{}</span><span class=\"w\"> </span><span class=\"n\">none</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">info</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">getConstInfo</span><span class=\"w\"> </span><span class=\"n\">c</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">delab</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Delab</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">      </span><span class=\"n\">delabForallParamsWithSignature</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">binders</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">        </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">binders</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">binders</span><span class=\"bp\">.</span><span class=\"n\">filter</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">binder</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">binder</span><span class=\"bp\">.</span><span class=\"n\">raw</span><span class=\"bp\">.</span><span class=\"n\">isOfKind</span><span class=\"w\"> </span><span class=\"ss\">``Parser.Term.explicitBinder</span>\n<span class=\"w\">        </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"bp\">‚ü®‚Üê</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">declSigWithId</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"o\">(</span><span class=\"n\">mkIdent</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">binders</span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">type</span><span class=\"o\">)</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">    </span><span class=\"n\">logInfoAt</span><span class=\"w\"> </span><span class=\"n\">tk</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofFormatWithInfosM</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PrettyPrinter</span><span class=\"bp\">.</span><span class=\"n\">ppExprWithInfos</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">delab</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">delab</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">info</span><span class=\"bp\">.</span><span class=\"n\">type</span><span class=\"o\">)</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">info: mfderiv_comp (x : M) (hg : MDifferentiableAt I' I'' g (f x)) (hf : MDifferentiableAt I I' f x) :</span>\n<span class=\"sd\">  mfderiv I I'' (g ‚àò f) x = (mfderiv I' I'' g (f x)).comp (mfderiv I I' f x)</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"bp\">#</span><span class=\"n\">check'</span><span class=\"w\"> </span><span class=\"n\">mfderiv_comp</span>\n</code></pre></div>",
        "id": 553255401,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1762099762
    },
    {
        "content": "<p>Note that <code>#check' mfderiv_comp</code> does not show any of the ~dozen implicit or typeclass arguments.</p>",
        "id": 553255430,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1762099781
    },
    {
        "content": "<p>Thanks for the first outline, although I would prefer the implicit arguments dimmed, not missing...</p>",
        "id": 553255701,
        "sender_full_name": "Mirek Ol≈°√°k",
        "timestamp": 1762100074
    },
    {
        "content": "<p>That probably means doing custom elementary argument decomposition side, to produce a <code>Html</code> instead of  <code>MessageData</code>, so we would need to reimplement things like</p>\n<ul>\n<li>printing different kinds of parentheses around arguments</li>\n<li>skipping <code>[anonymous] :</code> for arguments without names</li>\n<li>grouping together arguments with identical types</li>\n</ul>\n<p>Besides that, it suffices to group all the Html parts into <code>&lt;span class=\"font-code\"&gt;</code>, and dimmed arguments into <code>&lt;span class=\"goal-inaccessible\"&gt;</code>. Do I understand it correctly?</p>",
        "id": 553256193,
        "sender_full_name": "Mirek Ol≈°√°k",
        "timestamp": 1762100600
    },
    {
        "content": "<p>(Note: making a <code>#check'</code> tactic is not difficult either, I have that on a branch. Let me open a PR in any case.)</p>",
        "id": 553257036,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1762101415
    },
    {
        "content": "<p>Here we go!</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">ProofWidgets</span><span class=\"w\"> </span><span class=\"n\">Jsx</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">checkH</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Name</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">showAlt</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MetaM</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">constVal</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">getConstVal</span><span class=\"w\"> </span><span class=\"n\">name</span>\n<span class=\"w\">  </span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">forallTelescope</span><span class=\"w\"> </span><span class=\"n\">constVal</span><span class=\"bp\">.</span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">args</span><span class=\"w\"> </span><span class=\"n\">outType</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mut</span><span class=\"w\"> </span><span class=\"n\">msg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MessageData</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">toString</span><span class=\"w\"> </span><span class=\"n\">name</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"n\">constVal</span><span class=\"bp\">.</span><span class=\"n\">levelParams</span><span class=\"bp\">.</span><span class=\"n\">isEmpty</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">univStr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\",\"</span><span class=\"bp\">.</span><span class=\"n\">intercalate</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">constVal</span><span class=\"bp\">.</span><span class=\"n\">levelParams</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">toString</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">univStr</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\".{\"</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">univStr</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"s2\">\"}\"</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">alt</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">showAlt</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"n\">univStr</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"s2\">\"\"</span>\n<span class=\"w\">      </span><span class=\"n\">msg</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">msg</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚Üê</span><span class=\"n\">MessageData</span><span class=\"bp\">.</span><span class=\"n\">ofHtml</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"n\">span</span><span class=\"w\"> </span><span class=\"bp\">¬´</span><span class=\"kn\">class</span><span class=\"bp\">¬ª=</span><span class=\"s2\">\"o-50\"</span><span class=\"bp\">&gt;</span><span class=\"o\">{</span>\n<span class=\"w\">        </span><span class=\"bp\">.</span><span class=\"n\">text</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">univStr</span>\n<span class=\"w\">      </span><span class=\"o\">}</span><span class=\"bp\">&lt;/</span><span class=\"n\">span</span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">alt</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">decls</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">args</span><span class=\"bp\">.</span><span class=\"n\">mapM</span><span class=\"w\"> </span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">getFVarLocalDecl</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">groups</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">decls</span><span class=\"bp\">.</span><span class=\"n\">toList</span><span class=\"bp\">.</span><span class=\"n\">splitBy</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">d1</span><span class=\"w\"> </span><span class=\"n\">d2</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">declCore</span><span class=\"w\"> </span><span class=\"n\">d1</span><span class=\"w\"> </span><span class=\"bp\">==</span><span class=\"w\"> </span><span class=\"n\">declCore</span><span class=\"w\"> </span><span class=\"n\">d2</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">group</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">groups</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">decl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LocalDecl</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">group</span><span class=\"bp\">.</span><span class=\"n\">head!</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p1</span><span class=\"o\">,</span><span class=\"n\">p2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"bp\">√ó</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">decl</span><span class=\"bp\">.</span><span class=\"n\">binderInfo</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">default</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"s2\">\"(\"</span><span class=\"o\">,</span><span class=\"s2\">\")\"</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">implicit</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"s2\">\"{\"</span><span class=\"o\">,</span><span class=\"s2\">\"}\"</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">instImplicit</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"s2\">\"[\"</span><span class=\"o\">,</span><span class=\"s2\">\"]\"</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">strictImplicit</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"s2\">\"‚¶É\"</span><span class=\"o\">,</span><span class=\"s2\">\"‚¶Ñ\"</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mut</span><span class=\"w\"> </span><span class=\"n\">paramParts</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"bp\">‚äï</span><span class=\"w\"> </span><span class=\"n\">Expr</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"s2\">\" \"</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">paramParts</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">paramParts</span><span class=\"bp\">.</span><span class=\"n\">push</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"n\">p1</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">group</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">‚à®</span><span class=\"w\"> </span><span class=\"bp\">¬¨</span><span class=\"n\">decl</span><span class=\"bp\">.</span><span class=\"n\">binderInfo</span><span class=\"bp\">.</span><span class=\"n\">isInstImplicit</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">        </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">arg</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">group</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">          </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Expr</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">fvar</span><span class=\"w\"> </span><span class=\"n\">arg</span><span class=\"bp\">.</span><span class=\"n\">fvarId</span>\n<span class=\"w\">          </span><span class=\"n\">paramParts</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">paramParts</span><span class=\"bp\">.</span><span class=\"n\">push</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">)</span>\n<span class=\"w\">          </span><span class=\"n\">paramParts</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">paramParts</span><span class=\"bp\">.</span><span class=\"n\">push</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"s2\">\" \"</span><span class=\"o\">)</span>\n<span class=\"w\">        </span><span class=\"n\">paramParts</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">paramParts</span><span class=\"bp\">.</span><span class=\"n\">push</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"s2\">\": \"</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"n\">paramParts</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">paramParts</span><span class=\"bp\">.</span><span class=\"n\">push</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"n\">decl</span><span class=\"bp\">.</span><span class=\"n\">type</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"n\">paramParts</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">paramParts</span><span class=\"bp\">.</span><span class=\"n\">push</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"n\">p2</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">paramMsg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MessageData</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span>\n<span class=\"w\">        </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">decl</span><span class=\"bp\">.</span><span class=\"n\">binderInfo</span><span class=\"bp\">.</span><span class=\"n\">isExplicit</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">          </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">paramParts</span><span class=\"bp\">.</span><span class=\"n\">foldl</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">part</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">            </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">part</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">            </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">toMessageData</span><span class=\"w\"> </span><span class=\"n\">s</span>\n<span class=\"w\">            </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">toMessageData</span><span class=\"w\"> </span><span class=\"n\">e</span>\n<span class=\"w\">          </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\"\"</span>\n<span class=\"w\">        </span><span class=\"k\">else</span>\n<span class=\"w\">          </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">htmls</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">paramParts</span><span class=\"bp\">.</span><span class=\"n\">mapM</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">part</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">part</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">          </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">text</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span>\n<span class=\"w\">          </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">            </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">widget</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Widget</span><span class=\"bp\">.</span><span class=\"n\">ppExprTagged</span><span class=\"w\"> </span><span class=\"n\">e</span>\n<span class=\"w\">            </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"n\">InteractiveCode</span><span class=\"w\"> </span><span class=\"n\">fmt</span><span class=\"bp\">=</span><span class=\"o\">{</span><span class=\"n\">widget</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">/&gt;</span>\n<span class=\"w\">          </span><span class=\"o\">)</span>\n<span class=\"w\">          </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mut</span><span class=\"w\"> </span><span class=\"n\">alt</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"\"</span>\n<span class=\"w\">          </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">showAlt</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">            </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">strs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">paramParts</span><span class=\"bp\">.</span><span class=\"n\">mapM</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">part</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">part</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">            </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"n\">s</span>\n<span class=\"w\">            </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">toString</span><span class=\"w\"> </span><span class=\"bp\">&lt;$&gt;</span><span class=\"w\"> </span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">ppExpr</span><span class=\"w\"> </span><span class=\"n\">e</span>\n<span class=\"w\">            </span><span class=\"o\">)</span>\n<span class=\"w\">            </span><span class=\"n\">alt</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"\"</span><span class=\"bp\">.</span><span class=\"n\">intercalate</span><span class=\"w\"> </span><span class=\"n\">strs</span><span class=\"bp\">.</span><span class=\"n\">toList</span>\n<span class=\"w\">          </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"n\">MessageData</span><span class=\"bp\">.</span><span class=\"n\">ofHtml</span>\n<span class=\"w\">            </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">element</span><span class=\"w\"> </span><span class=\"s2\">\"span\"</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[(</span><span class=\"s2\">\"class\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"o-50\"</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"n\">htmls</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">alt</span>\n<span class=\"w\">      </span><span class=\"n\">msg</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">msg</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">paramMsg</span>\n<span class=\"w\">    </span><span class=\"n\">msg</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">msg</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"s2\">\" : \"</span>\n<span class=\"w\">    </span><span class=\"n\">msg</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">msg</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">outType</span>\n<span class=\"w\">    </span><span class=\"n\">logInfo</span><span class=\"w\"> </span><span class=\"n\">msg</span>\n<span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">declCore</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">decl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">LocalDecl</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">decl</span><span class=\"bp\">.</span><span class=\"n\">type</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">decl</span><span class=\"bp\">.</span><span class=\"n\">binderInfo</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">decl</span><span class=\"bp\">.</span><span class=\"n\">kind</span><span class=\"o\">)</span>\n\n<span class=\"kn\">elab</span><span class=\"w\"> </span><span class=\"s2\">\"#checkh \"</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"o\">:</span><span class=\"n\">ident</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">  </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Command</span><span class=\"bp\">.</span><span class=\"n\">runTermElabM</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">fullName</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">realizeGlobalConstWithInfos</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">      </span><span class=\"n\">checkH</span><span class=\"w\"> </span><span class=\"n\">fullName</span><span class=\"w\"> </span><span class=\"n\">false</span>\n<span class=\"kn\">elab</span><span class=\"w\"> </span><span class=\"s2\">\"#checkh' \"</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"o\">:</span><span class=\"n\">ident</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">  </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Command</span><span class=\"bp\">.</span><span class=\"n\">runTermElabM</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">fullName</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">realizeGlobalConstWithInfos</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">      </span><span class=\"n\">checkH</span><span class=\"w\"> </span><span class=\"n\">fullName</span><span class=\"w\"> </span><span class=\"n\">true</span>\n\n<span class=\"bp\">#</span><span class=\"n\">checkh</span><span class=\"w\"> </span><span class=\"n\">AffineSubspace</span>\n<span class=\"bp\">#</span><span class=\"n\">checkh</span><span class=\"w\"> </span><span class=\"n\">mul_assoc</span>\n</code></pre></div>\n<p>It might not be as sophisticated as the real delaboration but looks usable.</p>",
        "id": 553265087,
        "sender_full_name": "Mirek Ol≈°√°k",
        "timestamp": 1762108568
    },
    {
        "content": "<p>Update: Now it only passes the dimmed parts through <code>Html</code>, so Error Lens show the same as <code>check'</code>. Now I am quite happy with it. Where could this belong? ProofWidgets?<br>\nUpdate2: <code>o-50</code> looks like better dimmer than <code>goal-inaccessible</code>. I update the code above.</p>",
        "id": 553268250,
        "sender_full_name": "Mirek Ol≈°√°k",
        "timestamp": 1762111810
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/7ogrPnvCws_scDyJm15QDYGo/screenshot.png\">screenshot.png</a><br>\n<a href=\"/user_uploads/3121/ZBWbbk-KRa2KWz97mg4tRH0o/error-lens.png\">error-lens.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/7ogrPnvCws_scDyJm15QDYGo/screenshot.png\" title=\"screenshot.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"810x326\" src=\"/user_uploads/thumbnail/3121/7ogrPnvCws_scDyJm15QDYGo/screenshot.png/840x560.webp\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/ZBWbbk-KRa2KWz97mg4tRH0o/error-lens.png\" title=\"error-lens.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"994x289\" src=\"/user_uploads/thumbnail/3121/ZBWbbk-KRa2KWz97mg4tRH0o/error-lens.png/840x560.webp\"></a></div>",
        "id": 553268803,
        "sender_full_name": "Mirek Ol≈°√°k",
        "timestamp": 1762112421
    },
    {
        "content": "<p>I wonder if this should be built into the term MessageData formatter, so that this also happens in error messages about mismatching types?</p>",
        "id": 553271969,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1762115687
    },
    {
        "content": "<p>Unfortunatelly, I don't think it is a desirable feature in general that the export from <code>MessageData</code> to <code>String</code> hides some parts of the output. Only here, I didn't have much better option because I needed to insert an HTML tag into it, which breaks the path to string.</p>",
        "id": 553274708,
        "sender_full_name": "Mirek Ol≈°√°k",
        "timestamp": 1762118339
    },
    {
        "content": "<p>Actually, I could have used the alt-text, so it is possible to export string correctly... Hard to decide. I still think for user experience the shortened Error Lens is great, but I cannot expect this to be the default, when you also see the shortened string on terminal output upon calling lean from command line.</p>",
        "id": 553275555,
        "sender_full_name": "Mirek Ol≈°√°k",
        "timestamp": 1762119232
    },
    {
        "content": "<p>If the question was about dimming implicit arguments in other <code>MessageData</code>, then sure, I think it would be helpful &amp; principled (without the detour through <code>ProofWidgets</code>).</p>",
        "id": 553275819,
        "sender_full_name": "Mirek Ol≈°√°k",
        "timestamp": 1762119472
    },
    {
        "content": "<p>I made it a PR to ProofWidgets: <a href=\"https://github.com/leanprover-community/ProofWidgets4/pull/142\">https://github.com/leanprover-community/ProofWidgets4/pull/142</a><br>\nI understand it would be better to have it more general, and in Core but let's start somewhere...</p>",
        "id": 553495101,
        "sender_full_name": "Mirek Ol≈°√°k",
        "timestamp": 1762210414
    },
    {
        "content": "<p>Note that <code>checkh</code> now works with importing ProofWidgets</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">ProofWidgets</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"bp\">#</span><span class=\"n\">checkh</span><span class=\"w\"> </span><span class=\"n\">AffineSubspace</span>\n</code></pre></div>\n<p>It is only working with constants, not arbitrary terms but I don't plan on extending, there rather should be more principled approach.</p>",
        "id": 567347760,
        "sender_full_name": "Mirek Ol≈°√°k",
        "timestamp": 1768080537
    }
]