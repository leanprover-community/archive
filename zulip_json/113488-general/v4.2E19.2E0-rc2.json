[
    {
        "content": "<p>Downstream libraries using <code>Lean.importModules</code> should note a change of behaviour </p>\n<blockquote>\n<p>If <code>loadExts</code> is true (false by default), we initialize the environment extensions using the imported data. Doing so may use the interpreter and thus is only safe to do after calling enableInitializersExecution; see also caveats there. If not set, every extension will have its initial value as its state. While the environment's constant map can be accessed without loadExts, many functions that take Environment or are in a monad carrying it such as CoreM may not function properly without it.</p>\n</blockquote>\n<p>Uses should be carefully reviewed as the default behaviour has changed!</p>",
        "id": 510317353,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1743817093
    },
    {
        "content": "<p>The 'release notes' link is broken for me (i.e. <a href=\"https://lean-lang.org/doc/reference/latest/releases/v4.19.0-rc2/\">https://lean-lang.org/doc/reference/latest/releases/v4.19.0-rc2/</a>).<br>\nI can access this without the <code>-rc2</code> suffix tho, i.e. <a href=\"https://lean-lang.org/doc/reference/latest/releases/v4.19.0\">https://lean-lang.org/doc/reference/latest/releases/v4.19.0</a>.</p>",
        "id": 510349965,
        "sender_full_name": "Franti≈°ek Silv√°≈°i ü¶â",
        "timestamp": 1743842303
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"364929\">@Franti≈°ek Silv√°≈°i ü¶â</span> , fixed, thank you!</p>",
        "id": 510353590,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1743845146
    },
    {
        "content": "<p><a class=\"stream-topic\" data-stream-id=\"113488\" href=\"/#narrow/channel/113488-general/topic/v4.2E18.2E0.20regression.20on.20well-founded.20recursion/with/509659130\">#general &gt; v4.18.0 regression on well-founded recursion</a>  seems not fixed in v4.19.0. Filed <a href=\"https://github.com/leanprover/lean4/issues/7826\">https://github.com/leanprover/lean4/issues/7826</a>.</p>",
        "id": 510359187,
        "sender_full_name": "pandaman",
        "timestamp": 1743849522
    },
    {
        "content": "<p>The post on release notes appears to be talking about v4.19.0 rather than v4.19.0-rc2, is this intentional? The phrasing of <a href=\"https://lean-lang.org/doc/reference/latest/releases/#release-notes\">this page</a> indicates that it's about v4.19.0, and even links to a different place to look for release candidates.</p>",
        "id": 510383749,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1743867095
    },
    {
        "content": "<p>(For convenience) Announcement thread: <a class=\"message-link\" href=\"/#narrow/channel/113486-announce/topic/v4.2E19.2E0-rc2/near/510316970\">#announce &gt; v4.19.0-rc2 @ üí¨</a></p>",
        "id": 510397240,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1743876647
    },
    {
        "content": "<p>Some structure/class changes that I'd like to highlight so that people can take advantage of them (or report issues that these changes may have caused!):</p>\n<ul>\n<li>It's now possible to change the binder kinds for the type's parameters. I'm looking forward to cleanups of all the primed fields in mathlib, where an auxiliary definition is created just to make certain arguments be explicit. See <a href=\"#narrow/channel/287929-mathlib4/topic/Depriming.20fields/near/510093978\">this thread</a>.</li>\n<li>The types of fields are reduced when fields are elaborated. No more <code>{ x := v, y := w }.x</code> in expected types. Most cases of <code>dsimp only</code> and <code>beta_reduce</code> at the starts of proofs can be removed.</li>\n<li><em>All</em> class parents are now used when filling in fields (if you do <code>#print C</code> and look at \"field notation resolution order\", all the classes in this list except for <code>C</code> are used). Previously, only those parents that happened to be represented as \"subobject fields\" could be used this way. Many cases of <code>__ :=</code> in mathlib can be cleaned up because of this. Currently, it is synthesizing parents in a pass before any of the provided field values are elaborated, but in future releases this will be improved, with parent synthesis being a process that will interleave with field elaboration. (Why? Parents can have types that depend on the class's fields. In the current release, this is only supported in the case where those fields can be solved for by using another parent instance.)</li>\n<li>All parents can be assigned. If <code>toParentName</code> is the parent projection, then you just need to write <code>{ toParentName := v, ... }</code> to assign it.</li>\n<li>Both opt-param and auto-param fields can be overridden now, and they are inherited according to the resolution order that's listed under \"field notation resolution order\" in <code>#print</code>. Diamond inheritance no longer causes issues here.</li>\n<li>The pretty printer now knows about default values for structures, and fields containing default values are omitted. Using <code>set_option pp.structureInstances.defaults true</code> makes the fields print regardless.</li>\n<li>The project initiated by <span class=\"user-mention\" data-user-id=\"306577\">@Matthew Ballard</span> in <a href=\"https://github.com/leanprover-community/mathlib4/pull/2478\">#2478</a> has reached a new milestone: we now aggressively eta reduce all structure constructors created using <code>{...}</code>/<code>where</code> notation. There are still some things we can do in this direction to optimize structure layouts, e.g., be aware of proof irrelevance when eta reducing, allow parent structures to overlap on proof fields, unfolding inferred instances when eta reducing, etc. In a benchmark, the new structure elaborator saves 0.99% instructions when building mathlib.</li>\n</ul>",
        "id": 510399417,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1743878259
    },
    {
        "content": "<p>I don't have a precise bug report, but v4.19.0-rc2 feels a lot less snappy than v4.18.0. Actually, it feels less snappy <em>only when errors are present</em>. Furthermore, the infoview, syntax highlighting, etc become slower and slower to update when editing a file. It's as if Lean were spawning more and more processes when errors are present, and those processes take a long time to die out.</p>",
        "id": 510405557,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1743882529
    },
    {
        "content": "<p>Performance also seems to be degraded when editing &gt;= 5 files simultaneously, but I have less empirical evidence than the \"editing a file makes it slow\" remark above.</p>",
        "id": 510405624,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1743882596
    },
    {
        "content": "<p>In fact, editing almost <em>anything</em> is excruciatingly slow now. We're talking ~15s to replace <code>\\l</code> with <code>‚Üê</code></p>",
        "id": 510406592,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1743883268
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Ya√´l Dillies</span> <a href=\"#narrow/channel/113488-general/topic/v4.2E19.2E0-rc2/near/510406592\">said</a>:</p>\n<blockquote>\n<p>In fact, editing almost <em>anything</em> is excruciatingly slow now. We're talking ~15s to replace <code>\\l</code> with <code>‚Üê</code></p>\n</blockquote>\n<p>When you do what? Just open a file and type it point blank?</p>",
        "id": 510408134,
        "sender_full_name": "Henrik B√∂ving",
        "timestamp": 1743884373
    },
    {
        "content": "<p>Currently I am replacing a bunch of deprecated lemmas by their replacement, so each time I start with a declaration that builds but throws a warning, I perform a sequence of five or so simple edits, the declaration should work again but instead everything becomes sluggish and it takes 30s for the orange bar to leave the declaration</p>",
        "id": 510408391,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1743884542
    },
    {
        "content": "<p>When I do those type of actions in Lean core files or on a random mathlib file everything is still pretty fast for me :/ Can you provide a clearer reproducer maybe?</p>",
        "id": 510408585,
        "sender_full_name": "Henrik B√∂ving",
        "timestamp": 1743884713
    },
    {
        "content": "<p>I guess maybe a video might also be useful?</p>",
        "id": 510414787,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1743888965
    },
    {
        "content": "<p>I'm also curious if others are experiencing this - a portion of my experiences of the form \"Lean is being sluggish\" have been caused by working over ssh, and particularly since you're working on gitpod which is currently dying, I wonder if that's a factor in what you're experiencing?</p>",
        "id": 510415127,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1743889234
    },
    {
        "content": "<p>I haven't noticed this so far (having been using v4.19.0-rc2 on nightly testing for a month now), but I work on machines with many cores and it's possible users on smaller machines are experiencing something else due to all the new parallelism. Good reproducers would be very helpful!</p>",
        "id": 510425418,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1743898082
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Ya√´l Dillies</span> When this happens and it gets really bad, a screenshot of the VS Code process explorer would also be very helpful. You can open it via 'Help' &gt; 'Open Process Explorer' in VS Code.</p>",
        "id": 510596424,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1744014761
    },
    {
        "content": "<p>Another useful bit of information would be whether these issues remain if you temporarily downgrade the Lean 4 VS Code extension to 0.0.195, because it tells us whether it's just v4.19.0-rc2 causing the issue or the combination of the VS Code extension update and v4.19.0-rc2.</p>",
        "id": 510596781,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1744014853
    },
    {
        "content": "<p>I am on the lookout for the next time it noticeably happens, and I'll try these tips, thanks!</p>",
        "id": 510596995,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1744014926
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Ya√´l Dillies</span> How many cores does this (Gitpod?) machine have?</p>",
        "id": 510604167,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1744016692
    },
    {
        "content": "<p>4 cores, 8GB RAM</p>",
        "id": 510679010,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1744034207
    },
    {
        "content": "<p>If Amazon or the FRO is willing to sponsor my absolutely ginormous use of gitpod, I wouldn't stop them <span aria-label=\"blush\" class=\"emoji emoji-1f60a\" role=\"img\" title=\"blush\">:blush:</span></p>",
        "id": 510679221,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1744034251
    },
    {
        "content": "<p>For what it's worth I haven't had this particular thing happen, on 4 cores and 4GB RAM</p>",
        "id": 510692140,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1744037017
    },
    {
        "content": "<p>Thanks, that's good to know. This is Gitpod as well?</p>",
        "id": 510699754,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1744038870
    },
    {
        "content": "<p>This is local</p>",
        "id": 510704556,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1744040026
    },
    {
        "content": "<p>For what it's worth, I have also run into the same performance issues as Ya√´l (while running on a local machine, not Gitpod etc). While working on a moderately (but not absurdly) complicated proof, if I hesitated a few times in the middle of typing some line of the proof ‚Äì¬†so Lean repeatedly re-started compilation of the proof when it was in an invalid, mid-editing state ‚Äì it would frequently just freeze, with the orange progress bar failing to move at all despite waiting several minutes. The only way I found of getting things moving again was to restart compilation of the entire file.  </p>\n<p>I'm no expert either in Lean's internals or in parallel programming, but Yael's interpretation </p>\n<blockquote>\n<p>It's as if Lean were spawning more and more processes when errors are present, and those processes take a long time to die out.</p>\n</blockquote>\n<p>does seem to match what I'm seeing.</p>",
        "id": 510843663,
        "sender_full_name": "David Loeffler",
        "timestamp": 1744091574
    },
    {
        "content": "<p>This sounds the same as <a href=\"#narrow/channel/270676-lean4/topic/hanging.20Lean.204.20in.20VS.20Code/near/508958432\">my #count_heartbeats complaint from recently</a> and I just checked that this is not v4.19.0-rc2-specific, my issue also occurs on v4.18.0.</p>",
        "id": 510843863,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744091683
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"481963\">@David Loeffler</span> There is a big difference between being sluggish and freezing (for which we've identified a relevant bug). As a first step, please check if any kind of process (Lean or VS Code) actually consumes CPU when that happens.</p>",
        "id": 510844837,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1744092153
    },
    {
        "content": "<p>Just hit this again with a (one-line) proof that takes a full 30 seconds to fail with a \"max heartbeats\" error, eating up the full capacity of two CPU cores in the interim. <span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span>  While I have this in front of me, what can I do to help you debug?</p>",
        "id": 510846546,
        "sender_full_name": "David Loeffler",
        "timestamp": 1744092988
    },
    {
        "content": "<p>Thanks, that's already good info. A debugger stack trace would be best depending on your OS, or a reproducer of course!</p>",
        "id": 510847776,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1744093554
    },
    {
        "content": "<p>Here's a MWE (or rather MnotWE):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">InfiniteSum</span><span class=\"bp\">.</span><span class=\"n\">Group</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommMonoid</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hc</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Multipliable</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">False</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">hc</span><span class=\"bp\">.</span><span class=\"n\">congr_cofinite</span><span class=\"w\"> </span><span class=\"n\">hs</span><span class=\"w\"> </span><span class=\"n\">hs'</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">tprod_eq</span>\n</code></pre></div>\n<p>This fails because <code>Multipliable.congr_cofinite</code> <del>doesn't exist</del> doesn't apply in this case (it was a typo for another lemma which does apply); but it takes an inordinately long time to fail.</p>",
        "id": 510848359,
        "sender_full_name": "David Loeffler",
        "timestamp": 1744093749
    },
    {
        "content": "<p>That doesn't even have a parallel theorem <span aria-label=\"big smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"big smile\">:big_smile:</span> . Thanks, will take a look. It's fast in 4.18?</p>",
        "id": 510848801,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1744093844
    },
    {
        "content": "<p>Wait, perhaps this is not actually the same performance issue I wanted to report. I definitely noticed a slowdown in 4.19 that wasn't there in 4.18, but I am not 100% sure that this particular example is part of that ‚Äì¬†it might be a different kind of slowness.</p>",
        "id": 510849015,
        "sender_full_name": "David Loeffler",
        "timestamp": 1744093933
    },
    {
        "content": "<p>Apologies ‚Äì this is indeed <strong>a different issue</strong> which is not specific to 4.19. (This is an example of \"typeclass instance search taking a long time to fail\" which is a long-standing problem.)</p>",
        "id": 510849316,
        "sender_full_name": "David Loeffler",
        "timestamp": 1744094098
    },
    {
        "content": "<p>That's a strange heartbeats error. The trace shows that it keeps trying to synthesize the same (CommGroup) instance (which is cached, so it is fast). But it doesn't stop trying to synthesize it.</p>",
        "id": 510861292,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1744098316
    },
    {
        "content": "<p>I also recently saw a trace where typeclass inference failing to infer some LinearOrderedCommRing about 50 times in a row (but very very quickly, and I also don't know if this was v4.19.0-rc2-specific)</p>",
        "id": 510876324,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744102716
    },
    {
        "content": "<p>If anyone else runs into the same issue as <span class=\"user-mention\" data-user-id=\"387244\">@Ya√´l Dillies</span> where all VS Code extension features (e.g. Unicode input) suddenly freeze up for a long time, I'd be very interested in a VS Code extension profile for the period of time where the issue is occurring, which helps me diagnose which parts of the VS Code extension are causing the slowdown.</p>\n<p>When the issue starts happening, you can record a profile as follows:</p>\n<ol>\n<li>Open the developer extension overview via Ctrl+Shift+P &gt; Developer: Show Running Extensions</li>\n<li>In the top right, click the black / white circle icon that is labeled \"Start Extension Host Profile\"</li>\n<li>Navigate back to your file that is frozen and wait until VS Code recovers</li>\n<li>Navigate back to the 'Running Extensions' tab and click the square in the top right that is labeled \"Stop Extension Host Profile\"</li>\n<li>Click the 'Save Extension Host Profile' button in the top right and send me the resulting file in a DM</li>\n</ol>\n<p>I don't know if this will work in Gitpod.</p>\n<p>Here's a .gif demonstrating the process:<br>\n<a href=\"/user_uploads/3121/LQHYH0mCC46a_ZHiIHdl_3Hs/Recording-2025-04-08-at-11.29.42.gif\">Recording VS Code extension profiles</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/LQHYH0mCC46a_ZHiIHdl_3Hs/Recording-2025-04-08-at-11.29.42.gif\" title=\"Recording VS Code extension profiles\"><img data-animated=\"true\" data-original-content-type=\"image/gif\" data-original-dimensions=\"3840x2090\" src=\"/user_uploads/thumbnail/3121/LQHYH0mCC46a_ZHiIHdl_3Hs/Recording-2025-04-08-at-11.29.42.gif/840x560-anim.webp\"></a></div>",
        "id": 510883766,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1744104792
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"481963\">David Loeffler</span> <a href=\"#narrow/channel/113488-general/topic/v4.2E19.2E0-rc2/near/510849015\">said</a>:</p>\n<blockquote>\n<p>Wait, perhaps this is not actually the same performance issue I wanted to report. I definitely noticed a slowdown in 4.19 that wasn't there in 4.18, but I am not 100% sure that this particular example is part of that ‚Äì¬†it might be a different kind of slowness.</p>\n</blockquote>\n<p>Many thanks to <span class=\"user-mention\" data-user-id=\"481963\">@David Loeffler</span> for providing me with a clear reproducer for this issue, this is now fixed in <a href=\"https://github.com/leanprover/lean4/pull/7882\">lean#7882</a> and I assume we'll likely make a backport available soon!</p>",
        "id": 511221258,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1744217090
    },
    {
        "content": "<p>Thanks David! I never managed to reproduce the issue consistently</p>",
        "id": 511221604,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1744217185
    },
    {
        "content": "<p>Here is a general recipe I figured out: in a file with an expensive proof at the end (e.g. with the remainder commented out), make a whitespace change to it and undo it after a small pause. Without the fix, I'm seeing 200% CPU usage from this, with it, usage quickly falls to 100%.</p>",
        "id": 511222800,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1744217559
    },
    {
        "content": "<p>Hooray, many thanks to Sebastian for getting to the bottom of this! I'm glad my rather scatter-shot attempts to find a reliable test case did eventually turn out to be helpful.</p>",
        "id": 511227860,
        "sender_full_name": "David Loeffler",
        "timestamp": 1744219222
    },
    {
        "content": "<p>Do I understand correctly that my test case was showing two bugs at once ‚Äì¬†a pre-existing issue with typeclass synthesis being slow to fail, worsened by a new 4.19-specific bug causing multiple threads to run into the typeclass synth bug simultaneously? And you have fixed the second, but the first remains to be solved?</p>",
        "id": 511228483,
        "sender_full_name": "David Loeffler",
        "timestamp": 1744219439
    },
    {
        "content": "<p>Yes, though I would like to be cautious about labelling automation taking a long time as a clear bug in general :)</p>",
        "id": 511228867,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1744219567
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/channel/113488-general/topic/v4.2E19.2E0-rc2/near/510883766\">said</a>:</p>\n<blockquote>\n<ol>\n<li>In the top right, click the black / white circle icon that is labeled \"Start Extension Host Profile\"</li>\n</ol>\n</blockquote>\n<p>This doesn't appear for me on gitpod unfortunately</p>",
        "id": 512195299,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744675927
    },
    {
        "content": "<p>I'm finding that there is still an issue in rc3; if I open Mathlib/MeasureTheory/Function/SimpleFunc.lean, and make edits around 240 (type and backspace a few characters in a proof to break it), that VSCode can get stuck building the whole file for each intermediate edit</p>",
        "id": 512195567,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744676117
    },
    {
        "content": "<p>While this is happening, the <code>\\</code> abbreviation input hangs, as does even using the terminal in gitpod!</p>",
        "id": 512195690,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744676183
    },
    {
        "content": "<p>Can't reproduce on macos.</p>",
        "id": 512196311,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1744676536
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/113488-general/topic/v4.2E19.2E0-rc2/near/512195567\">said</a>:</p>\n<blockquote>\n<p>I'm finding that there is still an issue in rc3; if I open Mathlib/MeasureTheory/Function/SimpleFunc.lean, and make edits around 240 (type and backspace a few characters in a proof to break it), that VSCode can get stuck building the whole file for each intermediate edit</p>\n</blockquote>\n<p>I tried to reproduce this in GitPod, but no luck unfortunately.</p>",
        "id": 512244174,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1744701474
    },
    {
        "content": "<p>Could you paste the output of <code>top -c</code> when this happens? This should work fine in Gitpod.</p>",
        "id": 512244807,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1744701708
    },
    {
        "content": "<p>I am back at this again. Things are still very slow whenever I type things. In fact, they seem to be slow proportionally to how many lines there are below in the file</p>",
        "id": 513367404,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745226007
    },
    {
        "content": "<p>I am quite worried, given that it is almost the end of the month, and simultaneously it is Easter</p>",
        "id": 513367472,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745226035
    },
    {
        "content": "<p>I can reproduce Eric's slowdown by eg replacing some of the <code>=&gt;</code> in <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.SimpleFunc.bind#doc\">docs#MeasureTheory.SimpleFunc.bind</a> with <code>‚Ü¶</code>. It first looks like this:<br>\n<a href=\"/user_uploads/3121/6PY-duW85h9NsjYAH7Up-M72/image.png\">image.png</a><br>\nthen by the point the language server actually performs the replacements, it gets confused:<br>\n<a href=\"/user_uploads/3121/X-pNTrGT2HzeqUvhxuaT824Q/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/6PY-duW85h9NsjYAH7Up-M72/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"819x161\" src=\"/user_uploads/thumbnail/3121/6PY-duW85h9NsjYAH7Up-M72/image.png/840x560.webp\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/X-pNTrGT2HzeqUvhxuaT824Q/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"850x127\" src=\"/user_uploads/thumbnail/3121/X-pNTrGT2HzeqUvhxuaT824Q/image.png/840x560.webp\"></a></div>",
        "id": 513367865,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745226201
    },
    {
        "content": "<p>Here's the output of <code>top -c</code> when it is still reparsing the file one keystroke at a time:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">top</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">09</span><span class=\"o\">:</span><span class=\"mi\">06</span><span class=\"o\">:</span><span class=\"mi\">37</span><span class=\"w\"> </span><span class=\"n\">up</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"n\">days</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">min</span><span class=\"o\">,</span><span class=\"w\">  </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">users</span><span class=\"o\">,</span><span class=\"w\">  </span><span class=\"n\">load</span><span class=\"w\"> </span><span class=\"n\">average</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">28.72</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mf\">18.69</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mf\">12.55</span>\n<span class=\"n\">Tasks</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"mi\">16</span><span class=\"w\"> </span><span class=\"n\">total</span><span class=\"o\">,</span><span class=\"w\">   </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">running</span><span class=\"o\">,</span><span class=\"w\">  </span><span class=\"mi\">14</span><span class=\"w\"> </span><span class=\"n\">sleeping</span><span class=\"o\">,</span><span class=\"w\">   </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">stopped</span><span class=\"o\">,</span><span class=\"w\">   </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">zombie</span>\n<span class=\"bp\">%</span><span class=\"n\">Cpu</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"mf\">55.8</span><span class=\"w\"> </span><span class=\"n\">us</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mf\">19.3</span><span class=\"w\"> </span><span class=\"n\">sy</span><span class=\"o\">,</span><span class=\"w\">  </span><span class=\"mf\">0.0</span><span class=\"w\"> </span><span class=\"n\">ni</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mf\">24.1</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"o\">,</span><span class=\"w\">  </span><span class=\"mf\">0.3</span><span class=\"w\"> </span><span class=\"n\">wa</span><span class=\"o\">,</span><span class=\"w\">  </span><span class=\"mf\">0.0</span><span class=\"w\"> </span><span class=\"n\">hi</span><span class=\"o\">,</span><span class=\"w\">  </span><span class=\"mf\">0.5</span><span class=\"w\"> </span><span class=\"n\">si</span><span class=\"o\">,</span><span class=\"w\">  </span><span class=\"mf\">0.0</span><span class=\"w\"> </span><span class=\"n\">st</span>\n<span class=\"n\">MiB</span><span class=\"w\"> </span><span class=\"n\">Mem</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"mf\">64297.9</span><span class=\"w\"> </span><span class=\"n\">total</span><span class=\"o\">,</span><span class=\"w\">   </span><span class=\"mf\">6681.5</span><span class=\"w\"> </span><span class=\"n\">free</span><span class=\"o\">,</span><span class=\"w\">  </span><span class=\"mf\">34731.5</span><span class=\"w\"> </span><span class=\"n\">used</span><span class=\"o\">,</span><span class=\"w\">  </span><span class=\"mf\">22885.0</span><span class=\"w\"> </span><span class=\"n\">buff</span><span class=\"bp\">/</span><span class=\"n\">cache</span>\n<span class=\"n\">MiB</span><span class=\"w\"> </span><span class=\"n\">Swap</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">384000.0</span><span class=\"w\"> </span><span class=\"n\">total</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mf\">382981.3</span><span class=\"w\"> </span><span class=\"n\">free</span><span class=\"o\">,</span><span class=\"w\">   </span><span class=\"mf\">1018.7</span><span class=\"w\"> </span><span class=\"n\">used</span><span class=\"bp\">.</span><span class=\"w\">  </span><span class=\"mf\">28700.4</span><span class=\"w\"> </span><span class=\"n\">avail</span><span class=\"w\"> </span><span class=\"n\">Mem</span>\n\n<span class=\"w\">    </span><span class=\"n\">PID</span><span class=\"w\"> </span><span class=\"n\">USER</span><span class=\"w\">      </span><span class=\"n\">PR</span><span class=\"w\">  </span><span class=\"n\">NI</span><span class=\"w\">    </span><span class=\"n\">VIRT</span><span class=\"w\">    </span><span class=\"n\">RES</span><span class=\"w\">    </span><span class=\"n\">SHR</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\">  </span><span class=\"bp\">%</span><span class=\"n\">CPU</span><span class=\"w\">  </span><span class=\"bp\">%</span><span class=\"n\">MEM</span><span class=\"w\">     </span><span class=\"n\">TIME</span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">COMMAND</span>\n<span class=\"w\">  </span><span class=\"mi\">52144</span><span class=\"w\"> </span><span class=\"n\">gitpod</span><span class=\"w\">    </span><span class=\"mi\">15</span><span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"mi\">9447044</span><span class=\"w\">   </span><span class=\"mf\">1.1</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"mi\">602968</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"mf\">139.5</span><span class=\"w\">   </span><span class=\"mf\">1.7</span><span class=\"w\">   </span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"mf\">41.91</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">gitpod</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---v4.19.0-rc3/bin/lean --worker file:///workspace/mathlib4/Mathlib/MeasureTheory+</span>\n<span class=\"w\">    </span><span class=\"mi\">106</span><span class=\"w\"> </span><span class=\"n\">gitpod</span><span class=\"w\">    </span><span class=\"mi\">15</span><span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"mi\">5</span><span class=\"w\">   </span><span class=\"mf\">31.5</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"mi\">352552</span><span class=\"w\">  </span><span class=\"mi\">22524</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\">  </span><span class=\"mf\">21.6</span><span class=\"w\">   </span><span class=\"mf\">0.5</span><span class=\"w\">   </span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"mf\">04.97</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">ide</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"w\"> </span><span class=\"c1\">--dns-result-order=ipv4first /ide/out/bootstrap-fork --type=extensionHost --transformURIs --useHostProxy=false</span>\n<span class=\"w\">     </span><span class=\"mi\">76</span><span class=\"w\"> </span><span class=\"n\">gitpod</span><span class=\"w\">    </span><span class=\"mi\">15</span><span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"mi\">5</span><span class=\"w\">   </span><span class=\"mf\">21.3</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"mi\">104300</span><span class=\"w\">  </span><span class=\"mi\">19268</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\">   </span><span class=\"mf\">7.0</span><span class=\"w\">   </span><span class=\"mf\">0.2</span><span class=\"w\">   </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"mf\">22.18</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">ide</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">ide</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">server</span><span class=\"bp\">-</span><span class=\"n\">main</span><span class=\"bp\">.</span><span class=\"n\">js</span><span class=\"w\"> </span><span class=\"c1\">--log=info --install-builtin-extension gitpod.gitpod-theme --install-builtin-extension github.+</span>\n<span class=\"w\">  </span><span class=\"mi\">52131</span><span class=\"w\"> </span><span class=\"n\">gitpod</span><span class=\"w\">    </span><span class=\"mi\">15</span><span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"mi\">2738416</span><span class=\"w\"> </span><span class=\"mi\">953808</span><span class=\"w\">  </span><span class=\"mi\">16396</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\">   </span><span class=\"mf\">6.6</span><span class=\"w\">   </span><span class=\"mf\">1.4</span><span class=\"w\">   </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"mf\">24.01</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">gitpod</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---v4.19.0-rc3/bin/lean --server /workspace/mathlib4</span>\n</code></pre></div>",
        "id": 513368335,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745226416
    },
    {
        "content": "<p>I don't want to sound dramatic, but IMO there is still a major regression compared from 4.18 lurking in there. I am willing to hop on as many calls as the FRO wants if it helps resolve the situation.</p>",
        "id": 513368413,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745226453
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/channel/113488-general/topic/v4.2E19.2E0-rc2/near/512244174\">said</a>:</p>\n<blockquote>\n<p>I tried to reproduce this in GitPod, but no luck unfortunately.</p>\n</blockquote>\n<p>How quick was your typing? If I replace one <code>=&gt;</code> every 4-5 seconds, it seems to be fine. If I replace one <code>=&gt;</code> every two seconds, it is not fine anymore</p>",
        "id": 513368559,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745226528
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Ya√´l Dillies</span>, could you give me a GitPod URL to use? I don't ever use it, and can't work out how to instantly... but I'm happy to try to repro.</p>",
        "id": 513368775,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1745226640
    },
    {
        "content": "<p>There you go: <a href=\"http://gitpod.io/#https://github.com/leanprover-community/mathlib4/\">http://gitpod.io/#https://github.com/leanprover-community/mathlib4/</a></p>",
        "id": 513368811,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745226663
    },
    {
        "content": "<p>How many gigs does this virtual machine have?</p>",
        "id": 513369311,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1745226857
    },
    {
        "content": "<p>8GB</p>",
        "id": 513369374,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745226893
    },
    {
        "content": "<p>I can't repro.</p>\n<p>I went to <code>SimpleFunc.lean</code>, as indicated above, went to line 240, and deleted and restored the first <code>=&gt; </code> many times as quickly as I could. Every time, the file snaps back to life as soon as I stop touching it...</p>",
        "id": 513369554,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1745226967
    },
    {
        "content": "<p>What if you try changing several of them in turn? How many gigabytes did you give your VM?</p>",
        "id": 513369678,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745227029
    },
    {
        "content": "<p>I didn't do anything, I just clicked the link you gave me and clicked the big button!</p>",
        "id": 513369717,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1745227048
    },
    {
        "content": "<p>That's crazy. What is going on? <span aria-label=\"half frown\" class=\"emoji emoji-1f615\" role=\"img\" title=\"half frown\">:half_frown:</span></p>",
        "id": 513369821,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745227081
    },
    {
        "content": "<p>Changing the two alternately doesn't cause any problem.</p>",
        "id": 513369888,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1745227096
    },
    {
        "content": "<p>Are you working in browser, or tranferring the gitpod session across to a local VSCode window?</p>",
        "id": 513369989,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1745227142
    },
    {
        "content": "<p>(I don't see how that could do anything, but ...)</p>",
        "id": 513370018,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1745227154
    },
    {
        "content": "<p>Working in the browser</p>",
        "id": 513370075,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745227181
    },
    {
        "content": "<p>(me too)</p>",
        "id": 513370102,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1745227191
    },
    {
        "content": "<p>(for anyone else confused, it's <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.SimpleFunc.bind#doc\">docs#MeasureTheory.SimpleFunc.bind</a>)</p>",
        "id": 513370222,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1745227222
    },
    {
        "content": "<p>I can't reproduce either. <span class=\"user-mention\" data-user-id=\"387244\">@Ya√´l Dillies</span> Does it reproduce for you immediately after a Restart Server? Could you attach a screen recording with <code>top</code> open?</p>",
        "id": 513370542,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1745227357
    },
    {
        "content": "<p>(I can't reproduce it either)</p>",
        "id": 513370596,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1745227388
    },
    {
        "content": "<p>(edited)</p>",
        "id": 513370812,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745227489
    },
    {
        "content": "<p>I tried the repro again, and I hit the exact same issue</p>",
        "id": 513371841,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745227979
    },
    {
        "content": "<p>Okay, I think we need a screen recording from top to bottom in order to try to repro.</p>",
        "id": 513371895,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1745228004
    },
    {
        "content": "<p>Here's something I have just discovered: If I SSH into the <em>same</em> gitpod instance from my local vscode, then the slowdowns vanish <span aria-label=\"explode\" class=\"emoji emoji-1f92f\" role=\"img\" title=\"explode\">:explode:</span></p>",
        "id": 513373441,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745228749
    },
    {
        "content": "<p>Have you considered that your browser is cursed?</p>",
        "id": 513374831,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1745229434
    },
    {
        "content": "<p>What happens if you try with another browser (chrome instead of firefox, or vice versa)? I just tried it, couldn't reproduce either.</p>",
        "id": 513376638,
        "sender_full_name": "S√©bastien Gou√´zel",
        "timestamp": 1745230293
    },
    {
        "content": "<p>If you use some kind of Firefox set-up (custom add-ons, existing profile with lots of data, certain configuration): what happens in a new profile? Does the issue still appear? Some of my bugs disappear when using vanilla Firefox.</p>",
        "id": 513379307,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1745231712
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Ya√´l Dillies</span> Do you have any other extensions in your Gitpod setup other than the Lean 4 extension? For example, are you using the Vim extension?</p>",
        "id": 513540994,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1745308342
    },
    {
        "content": "<p>The other thing to try is whether downgrading the extension to 0.0.195 fixes the issue on Gitpod for you.</p>",
        "id": 513541523,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1745308490
    },
    {
        "content": "<p>(... and if you're using the Vim extension, try disabling it before downgrading)</p>",
        "id": 513541664,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1745308540
    },
    {
        "content": "<p>Yes, I have all the extensions that come with the gitpod setup and a few more. The full list is:</p>\n<ul>\n<li>Docker</li>\n<li>Error Lens</li>\n<li>Jupyter</li>\n<li>Jupyter Cell Tags</li>\n<li>Jupyter Keymap</li>\n<li>Jupyter Notebook Renderers</li>\n<li>Jupyter Slideshow</li>\n<li>Python Debugger</li>\n<li>LaTeX Workshop (currently disabled)</li>\n</ul>",
        "id": 513543396,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745308969
    },
    {
        "content": "<p>Ah, so no Vim extension. That's good.</p>",
        "id": 513543566,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1745309013
    },
    {
        "content": "<p>If you can still reproduce it consistently: Is the issue still reproducible for you on 0.0.195 of the extension?</p>",
        "id": 513543850,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1745309088
    },
    {
        "content": "<p>How do I downgrade?</p>",
        "id": 513544041,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1745309153
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/aV5Ng8NSc2b5xFooLKevYgxv/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/aV5Ng8NSc2b5xFooLKevYgxv/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"739x581\" src=\"/user_uploads/thumbnail/3121/aV5Ng8NSc2b5xFooLKevYgxv/image.png/840x560.webp\"></a></div>",
        "id": 513544244,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1745309209
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/113488-general/topic/v4.2E19.2E0-rc2/near/510383749\">said</a>:</p>\n<blockquote>\n<p>The post on release notes appears to be talking about v4.19.0 rather than v4.19.0-rc2, is this intentional? The phrasing of <a href=\"https://lean-lang.org/doc/reference/latest/releases/#release-notes\">this page</a> indicates that it's about v4.19.0, and even links to a different place to look for release candidates.</p>\n</blockquote>\n<p>It looks to me that this wasn't fixed: the \"release notes\" for v4.19.0 say it was released near the beginning of April (on the same day as v4.18.0), and most of the commits leading up to v4.19.0 are not listed in those notes. <br>\nFor instance, the github tag for 4.19.0 explicitly mentions \"Includes changes from <a href=\"https://github.com/leanprover-community/mathlib4/pull/7809\">#7809</a>, <a href=\"https://github.com/leanprover-community/mathlib4/pull/8026\">#8026</a>, <a href=\"https://github.com/leanprover-community/mathlib4/pull/8152\">#8152</a>, and <a href=\"https://github.com/leanprover-community/mathlib4/pull/8190\">#8190</a>.\", but none of these PRs are mentioned in the release notes linked from Kim's post in <a class=\"stream\" data-stream-id=\"113486\" href=\"/#narrow/channel/113486-announce\">#announce</a></p>",
        "id": 516300219,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1746480632
    },
    {
        "content": "<p>Still sorting out some kinks with the release notes and the reference manual... </p>\n<p>As far as I understand, there are not going to be separate release notes for the release candidates and the final releases of a given version, and the date next to the release notes in the reference manual will be the date of the last update in that series (so in particular, dates for v4.19.0 and v4.20.0 might well be close together, as v4.20.0-rc1 is typically released approximately the same say as v4.19.0).</p>\n<p>The sentence about release notes for release candidates being on github still needs to be <a href=\"https://github.com/leanprover/reference-manual/pull/431\">removed</a>. There's apparently a manual step to updating the reference manual that I'm still missing.</p>",
        "id": 516302921,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1746481743
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/113488-general/topic/v4.2E19.2E0-rc2/near/516302921\">said</a>:</p>\n<blockquote>\n<p>the date next to the release notes in the reference manual will be the date of the last update in that series</p>\n</blockquote>\n<p>It doesn't look to me like this is accurate for v4.19.0, unless it's really true that the last Lean change that made it to 4.19.0 was made on April 2nd?</p>",
        "id": 516303510,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1746481972
    },
    {
        "content": "<p>Hmm, good point. These dates are a mess, and we need to rethink them. I will make the case for simply not having dates. :-)</p>",
        "id": 516303612,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1746482028
    },
    {
        "content": "<p>I guess what I literally meant was \"these dates will be the date of the last time someone thought to update the date while updating the release notes\", which is not particularly satisfactory. :-)</p>",
        "id": 516303714,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1746482074
    },
    {
        "content": "<p>It's been a long release process.</p>",
        "id": 516303759,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1746482095
    },
    {
        "content": "<p>I'm also still a bit confused about the list of changes. For instance, github shows that the PR <a href=\"https://github.com/leanprover/lean4/pull/8060\">lean#8060</a> is included in v4.19.0, but the reference manual doesn't mention this one (and it's <code>fix</code> so it should be in the list!). So in particular, I'm not actually sure if that PR is in the version of Lean being used in mathlib stable on the web editor at the moment...</p>",
        "id": 516303886,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1746482157
    },
    {
        "content": "<p>Okay, I'll investigate tomorrow.</p>",
        "id": 516303969,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1746482187
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/pull/8060\">lean#8060</a></p>",
        "id": 516304019,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1746482204
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/113488-general/topic/v4.2E19.2E0-rc2/near/516303886\">said</a>:</p>\n<blockquote>\n<p>github shows that the PR <a href=\"https://github.com/leanprover/lean4/pull/8060\">lean#8060</a> is included in v4.19.0</p>\n</blockquote>\n<p>What do you mean by this? <a href=\"https://github.com/leanprover/lean4/pull/8060\">lean#8060</a> is not in <code>v4.19.0</code> (I verified this by looking in the source code at the <code>v4.19.0</code> tag, but also I don't see any reason it would be --- it is only 2 weeks old, and does not have a backport label.)</p>",
        "id": 516304501,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1746482400
    },
    {
        "content": "<p>Oh, my mistake, I pressed the button on github that I thought shows the new commits in the release, but checking again now I realise it shows the commits to master that aren't in the release. I also thought that since it was merged to lean4 master before the date of release of v4.19.0, it'd be in that version, but I must have misunderstood the release process.</p>",
        "id": 516305005,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1746482612
    },
    {
        "content": "<p>No, v4.19.0 will agree with the last release candidate, ideally v4.19.0-rc1, which departed from <code>master</code> a whole month earlier.</p>",
        "id": 516306462,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1746483234
    }
]