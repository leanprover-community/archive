[
    {
        "content": "<p>In the repository I maintain, <a href=\"https://github.com/lean-ja/lean-by-example\">https://github.com/lean-ja/lean-by-example</a>, the GitHub Actions build is currently failing on Ubuntu, while it passes without issue on Windows. I have no idea why this is happening. If anyone has any insights into the cause, I would appreciate your help.</p>",
        "id": 529687527,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1753016920
    },
    {
        "content": "<p>log is here:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"bp\">✖</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">3247</span><span class=\"bp\">/</span><span class=\"mi\">3308</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">Playground</span><span class=\"bp\">.</span><span class=\"n\">Monkey</span><span class=\"bp\">.</span><span class=\"n\">Ast</span><span class=\"bp\">.</span><span class=\"n\">Ast</span>\n<span class=\"w\">  </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">file</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">runner</span><span class=\"bp\">/</span><span class=\"n\">work</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"k\">by</span><span class=\"bp\">-</span><span class=\"kn\">example</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"k\">by</span><span class=\"bp\">-</span><span class=\"kn\">example</span><span class=\"bp\">/</span><span class=\"n\">Playground</span><span class=\"bp\">/</span><span class=\"n\">Monkey</span><span class=\"bp\">/</span><span class=\"n\">Ast</span><span class=\"bp\">/</span><span class=\"n\">Ast</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"w\">  </span><span class=\"bp\">✖</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">3248</span><span class=\"bp\">/</span><span class=\"mi\">3308</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">Playground</span><span class=\"bp\">.</span><span class=\"n\">Monkey</span><span class=\"bp\">.</span><span class=\"n\">Parser</span><span class=\"bp\">.</span><span class=\"n\">Parser</span>\n<span class=\"w\">  </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">runner</span><span class=\"bp\">/</span><span class=\"n\">work</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"k\">by</span><span class=\"bp\">-</span><span class=\"kn\">example</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"k\">by</span><span class=\"bp\">-</span><span class=\"kn\">example</span><span class=\"bp\">/</span><span class=\"n\">Playground</span><span class=\"bp\">/</span><span class=\"n\">Monkey</span><span class=\"bp\">/</span><span class=\"n\">Parser</span><span class=\"bp\">/</span><span class=\"n\">Parser</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">bad</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Playground</span><span class=\"bp\">.</span><span class=\"n\">Monkey</span><span class=\"bp\">.</span><span class=\"n\">Ast</span><span class=\"bp\">.</span><span class=\"n\">Ast'</span>\n<span class=\"w\">  </span><span class=\"bp\">✖</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">3249</span><span class=\"bp\">/</span><span class=\"mi\">3308</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">Playground</span><span class=\"bp\">.</span><span class=\"n\">Monkey</span><span class=\"bp\">.</span><span class=\"n\">Parser</span><span class=\"bp\">.</span><span class=\"n\">ParserTest</span>\n<span class=\"w\">  </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">runner</span><span class=\"bp\">/</span><span class=\"n\">work</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"k\">by</span><span class=\"bp\">-</span><span class=\"kn\">example</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"k\">by</span><span class=\"bp\">-</span><span class=\"kn\">example</span><span class=\"bp\">/</span><span class=\"n\">Playground</span><span class=\"bp\">/</span><span class=\"n\">Monkey</span><span class=\"bp\">/</span><span class=\"n\">Parser</span><span class=\"bp\">/</span><span class=\"n\">ParserTest</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">bad</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Playground</span><span class=\"bp\">.</span><span class=\"n\">Monkey</span><span class=\"bp\">.</span><span class=\"n\">Parser</span><span class=\"bp\">.</span><span class=\"n\">Parser'</span>\n<span class=\"w\">  </span><span class=\"bp\">✔</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">3303</span><span class=\"bp\">/</span><span class=\"mi\">3308</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">Playground</span><span class=\"bp\">.</span><span class=\"n\">Monkey</span><span class=\"bp\">.</span><span class=\"n\">Token</span><span class=\"bp\">.</span><span class=\"n\">Token</span>\n<span class=\"w\">  </span><span class=\"bp\">✔</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">3304</span><span class=\"bp\">/</span><span class=\"mi\">3308</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">Playground</span><span class=\"bp\">.</span><span class=\"n\">Monkey</span><span class=\"bp\">.</span><span class=\"n\">Lexer</span><span class=\"bp\">.</span><span class=\"n\">Lexer</span>\n<span class=\"w\">  </span><span class=\"bp\">✔</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">3305</span><span class=\"bp\">/</span><span class=\"mi\">3308</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">Playground</span><span class=\"bp\">.</span><span class=\"n\">Monkey</span><span class=\"bp\">.</span><span class=\"n\">AST</span><span class=\"bp\">.</span><span class=\"n\">Ast</span>\n<span class=\"w\">  </span><span class=\"bp\">✔</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">3306</span><span class=\"bp\">/</span><span class=\"mi\">3308</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">Playground</span><span class=\"bp\">.</span><span class=\"n\">Monkey</span><span class=\"bp\">.</span><span class=\"n\">Repr</span><span class=\"bp\">.</span><span class=\"n\">Repr</span>\n<span class=\"w\">  </span><span class=\"bp\">✔</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">3307</span><span class=\"bp\">/</span><span class=\"mi\">3308</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">Playground</span><span class=\"bp\">.</span><span class=\"n\">Monkey</span><span class=\"bp\">.</span><span class=\"n\">Lexer</span><span class=\"bp\">.</span><span class=\"n\">LexerTest</span>\n<span class=\"w\">  </span><span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Playground</span><span class=\"bp\">.</span><span class=\"n\">Monkey</span><span class=\"bp\">.</span><span class=\"n\">Ast</span><span class=\"bp\">.</span><span class=\"n\">Ast</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Playground</span><span class=\"bp\">.</span><span class=\"n\">Monkey</span><span class=\"bp\">.</span><span class=\"n\">Parser</span><span class=\"bp\">.</span><span class=\"n\">Parser</span>\n<span class=\"w\">  </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Playground</span><span class=\"bp\">.</span><span class=\"n\">Monkey</span><span class=\"bp\">.</span><span class=\"n\">Parser</span><span class=\"bp\">.</span><span class=\"n\">ParserTest</span>\n<span class=\"w\">  </span><span class=\"n\">Error</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n<span class=\"w\">  </span><span class=\"n\">Error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Process</span><span class=\"w\"> </span><span class=\"n\">completed</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">exit</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mf\">1.</span>\n</code></pre></div>",
        "id": 529687550,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1753016943
    },
    {
        "content": "<p>version is: leanprover/lean4:v4.22.0-rc3</p>",
        "id": 529687600,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1753016987
    },
    {
        "content": "<p>Unix is case-sensitive; you import <code>import Playground.Monkey.Ast.Ast</code> but you have <code>Playground.Monkey.AST.Ast</code> as the file name.</p>",
        "id": 529688304,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1753017831
    },
    {
        "content": "<p>Windows isn't so it works there</p>",
        "id": 529688323,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1753017853
    },
    {
        "content": "<p>I get bitten by this every so often myself. You might want to thumbs up <a href=\"https://github.com/leanprover/lean4/pull/5409\">lean4#5409</a> and/or <a href=\"https://github.com/leanprover/lean4/pull/2768\">lean4#2768</a></p>",
        "id": 529688861,
        "sender_full_name": "Julian Berman",
        "timestamp": 1753018420
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"873547\">@Robin Arnez</span> Oh Thank you!!!!!!!</p>",
        "id": 529689291,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1753018917
    },
    {
        "content": "<p>Perhaps this could go on the pitfalls page, since it does indeed show up surprisingly often</p>",
        "id": 529705958,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1753036996
    },
    {
        "content": "<p>Is there a Windows pitfalls page??</p>",
        "id": 529914743,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1753111655
    },
    {
        "content": "<p>arguably this is an ubuntu pitfall</p>",
        "id": 529915727,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1753111924
    },
    {
        "content": "<p>How do other languages deal with this?</p>",
        "id": 529917020,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1753112350
    },
    {
        "content": "<p>I think python enforces case sensitivity even when the platform is not case sensitive (though somehow for the engineering team I'm part of we still managed to screw this up and write a Python program that only runs on macOS, which shouldn't be possible).</p>",
        "id": 529984664,
        "sender_full_name": "Niels Voss",
        "timestamp": 1753145439
    },
    {
        "content": "<p>Maybe it's worth considering enforcing on all OSes both case sensitivity of imports and also making sure that all file names are valid identifiers on Windows, Linux, and macOS (<a href=\"https://stackoverflow.com/a/31976060/30840616\">https://stackoverflow.com/a/31976060/30840616</a> claims that Aux.lean is an invalid file name, for example, though it appears to be valid for me on Windows), and making it so that if there are two files with the same name in different case, then importing either of them should fail (if this does not cause a performance penalty)</p>",
        "id": 529984890,
        "sender_full_name": "Niels Voss",
        "timestamp": 1753145644
    },
    {
        "content": "<p>Cross-linking <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/Never.20name.20a.20file.20Con.2Elean/with/531483026\">#mathlib4 &gt; Never name a file Con.lean</a> for discoverability</p>",
        "id": 531586449,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1753789427
    },
    {
        "content": "<p>The latter (case collisions) has been a mathlib linter for a while now.</p>",
        "id": 531586482,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1753789441
    },
    {
        "content": "<p>The former (forbidden names on (all but new versions of) Windows) got a linter yesterday.</p>",
        "id": 531586559,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1753789464
    },
    {
        "content": "<p>In mathlib, you can use <code>lake exe lint-style</code> to run these checks.</p>",
        "id": 531586604,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1753789478
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"238446\">@Anne Baanen</span> You worked on allowing downstream projects to do the same. Can you remind us of the right way to do so?</p>",
        "id": 531586656,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1753789497
    },
    {
        "content": "<p>If you dependent on mathlib, you can run <code>lake exe lint-style</code> locally, that should work. (Perhaps you need to set an option to explicitly enable that linter; I'd need to check.)</p>",
        "id": 531586779,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1753789526
    },
    {
        "content": "<p>To run things in CI, there is a special CI action now. Anne was involved and can tell us more.</p>",
        "id": 531586829,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1753789546
    },
    {
        "content": "<p>Speaking of which: is there a dedicated webpage \"here's how you can set up your CI to re-use mathlib's tools\"? (In the mean time, there is <a href=\"https://github.com/pitmonticone/LeanProject\">https://github.com/pitmonticone/LeanProject</a> --- which probably wouldn't mind somebody making a PR adding some of the very recent goodies. <a href=\"https://github.com/pitmonticone/LeanProject/issues/30\">https://github.com/pitmonticone/LeanProject/issues/30</a> tracks some of them.)</p>",
        "id": 531587112,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1753789629
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/113488-general/topic/Build.20Fails.20Only.20on.20Ubuntu/near/531586656\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"238446\">Anne Baanen</span> You worked on allowing downstream projects to do the same. Can you remind us of the right way to do so?</p>\n</blockquote>\n<p>To run <code>lint-style</code> in CI it should be as easy as adding the <a href=\"https://github.com/leanprover-community/lint-style-action\">leanprover-community/lint-style-action</a> step to your build workflow. For example:</p>\n<div class=\"codehilite\" data-code-language=\"YAML\"><pre><span></span><code><span class=\"nt\">on</span><span class=\"p\">:</span>\n<span class=\"w\">  </span><span class=\"nt\">push</span><span class=\"p\">:</span>\n<span class=\"w\">  </span><span class=\"nt\">pull_request</span><span class=\"p\">:</span>\n\n<span class=\"nt\">jobs</span><span class=\"p\">:</span>\n<span class=\"w\">  </span><span class=\"nt\">lint-style</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"nt\">name</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">Lint style</span>\n<span class=\"w\">    </span><span class=\"nt\">runs-on</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">ubuntu-latest</span>\n<span class=\"w\">    </span><span class=\"nt\">steps</span><span class=\"p\">:</span>\n<span class=\"w\">      </span><span class=\"p p-Indicator\">-</span><span class=\"w\"> </span><span class=\"nt\">uses</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">leanprover-community/lint-style-action</span>\n<span class=\"w\">        </span><span class=\"nt\">with</span><span class=\"p\">:</span>\n<span class=\"w\">          </span><span class=\"nt\">mode</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">check</span>\n<span class=\"w\">          </span><span class=\"nt\">lint-bib-file</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">true</span>\n</code></pre></div>",
        "id": 531589670,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1753790405
    }
]