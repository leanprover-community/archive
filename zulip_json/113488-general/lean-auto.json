[
    {
        "content": "<p>I am trying to use lean-auto.  I have the following line in lakefile.lean:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">require</span><span class=\"w\"> </span><span class=\"n\">auto</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/leanprover-community/lean-auto.git\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"s2\">\"v4.11.0\"</span>\n</code></pre></div>\n<p>I am trying this simple example <a href=\"https://github.com/leanprover-community/lean-auto/blob/main/Test/SmtTranslation/BoolNatInt.lean\">https://github.com/leanprover-community/lean-auto/blob/main/Test/SmtTranslation/BoolNatInt.lean</a></p>\n<p>I get several errors:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">auto</span><span class=\"bp\">\\.\\.\\</span><span class=\"n\">Auto</span><span class=\"bp\">\\</span><span class=\"n\">Lib</span><span class=\"bp\">\\</span><span class=\"n\">Pos</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">108</span><span class=\"o\">:</span><span class=\"mi\">13</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">rfl'</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">left</span><span class=\"bp\">-</span><span class=\"n\">hand</span><span class=\"w\"> </span><span class=\"n\">side</span>\n<span class=\"w\">  </span><span class=\"n\">ofNat'WF</span><span class=\"w\"> </span><span class=\"n\">xH</span><span class=\"bp\">.</span><span class=\"n\">toNat'</span>\n<span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">definitionally</span><span class=\"w\"> </span><span class=\"n\">equal</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">right</span><span class=\"bp\">-</span><span class=\"n\">hand</span><span class=\"w\"> </span><span class=\"n\">side</span>\n<span class=\"w\">  </span><span class=\"n\">xH</span>\n<span class=\"bp\">‚ä¢</span><span class=\"w\"> </span><span class=\"n\">ofNat'WF</span><span class=\"w\"> </span><span class=\"n\">xH</span><span class=\"bp\">.</span><span class=\"n\">toNat'</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">xH</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">auto</span><span class=\"bp\">\\.\\.\\</span><span class=\"n\">Auto</span><span class=\"bp\">\\</span><span class=\"n\">Lib</span><span class=\"bp\">\\</span><span class=\"n\">Pos</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">121</span><span class=\"o\">:</span><span class=\"mi\">25</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">rfl'</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">left</span><span class=\"bp\">-</span><span class=\"n\">hand</span><span class=\"w\"> </span><span class=\"n\">side</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">ofNat'WF</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toNat'</span>\n<span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">definitionally</span><span class=\"w\"> </span><span class=\"n\">equal</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">right</span><span class=\"bp\">-</span><span class=\"n\">hand</span><span class=\"w\"> </span><span class=\"n\">side</span>\n<span class=\"w\">  </span><span class=\"mi\">1</span>\n<span class=\"n\">a</span><span class=\"bp\">‚úù</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">‚â†</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"bp\">‚ä¢</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ofNat'WF</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toNat'</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">auto</span><span class=\"bp\">\\.\\.\\</span><span class=\"n\">Auto</span><span class=\"bp\">\\</span><span class=\"n\">Lib</span><span class=\"bp\">\\</span><span class=\"n\">Pos</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">166</span><span class=\"o\">:</span><span class=\"mi\">16</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">rfl'</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">left</span><span class=\"bp\">-</span><span class=\"n\">hand</span><span class=\"w\"> </span><span class=\"n\">side</span>\n<span class=\"w\">  </span><span class=\"n\">ofNat'WF</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">definitionally</span><span class=\"w\"> </span><span class=\"n\">equal</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">right</span><span class=\"bp\">-</span><span class=\"n\">hand</span><span class=\"w\"> </span><span class=\"n\">side</span>\n<span class=\"w\">  </span><span class=\"n\">ofNat'RD</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">‚â•</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"n\">hzero</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"bp\">‚ä¢</span><span class=\"w\"> </span><span class=\"n\">ofNat'WF</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">ofNat'RD</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">auto</span><span class=\"bp\">\\.\\.\\</span><span class=\"n\">Auto</span><span class=\"bp\">\\</span><span class=\"n\">Lib</span><span class=\"bp\">\\</span><span class=\"n\">ExprExtra</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">395</span><span class=\"o\">:</span><span class=\"mi\">37</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">unknown</span><span class=\"w\"> </span><span class=\"n\">constant</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">MetaEval'</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">auto</span><span class=\"bp\">\\.\\.\\</span><span class=\"n\">Auto</span><span class=\"bp\">\\</span><span class=\"n\">Lib</span><span class=\"bp\">\\</span><span class=\"n\">ExprExtra</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">396</span><span class=\"o\">:</span><span class=\"mi\">33</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">unknown</span><span class=\"w\"> </span><span class=\"n\">constant</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">runMetaEval'</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">auto</span><span class=\"bp\">\\.\\.\\</span><span class=\"n\">Auto</span><span class=\"bp\">\\</span><span class=\"n\">Lib</span><span class=\"bp\">\\</span><span class=\"n\">ExprExtra</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">402</span><span class=\"o\">:</span><span class=\"mi\">35</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">unknown</span><span class=\"w\"> </span><span class=\"n\">constant</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Eval'</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">auto</span><span class=\"bp\">\\.\\.\\</span><span class=\"n\">Auto</span><span class=\"bp\">\\</span><span class=\"n\">Lib</span><span class=\"bp\">\\</span><span class=\"n\">ExprExtra</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">403</span><span class=\"o\">:</span><span class=\"mi\">40</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">unknown</span><span class=\"w\"> </span><span class=\"n\">constant</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">runEval'</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">auto</span><span class=\"bp\">\\.\\.\\</span><span class=\"n\">Auto</span><span class=\"bp\">\\</span><span class=\"n\">Lib</span><span class=\"bp\">\\</span><span class=\"n\">ExprExtra</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">459</span><span class=\"o\">:</span><span class=\"mi\">29</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">unknown</span><span class=\"w\"> </span><span class=\"n\">constant</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">MetaEval'</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">auto</span><span class=\"bp\">\\.\\.\\</span><span class=\"n\">Auto</span><span class=\"bp\">\\</span><span class=\"n\">Parser</span><span class=\"bp\">\\</span><span class=\"n\">NDFA</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">468</span><span class=\"o\">:</span><span class=\"mi\">82</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">invalid</span><span class=\"w\"> </span><span class=\"n\">field</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">val'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">environment</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">contain</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">val'</span>\n<span class=\"w\">  </span><span class=\"n\">idx</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">Nat</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>\n<p>Any suggestion on how to fix them? I am using leanprover/lean4:v4.15.0-rc1</p>\n<p>Thanks<br>\nAlessandro</p>",
        "id": 485675582,
        "sender_full_name": "Alessandro Pinto",
        "timestamp": 1733160684
    },
    {
        "content": "<p>Try using the version of lean which lean-auto uses?</p>",
        "id": 485683109,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1733163433
    },
    {
        "content": "<p>I tried using leanprover/lean4:v4.13.0 (which is the toolchain used by lean-auto)<br>\nbut I now get the following error:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">proofwidgets</span><span class=\"bp\">\\</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">20</span><span class=\"o\">:</span><span class=\"mi\">20</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">invalid</span><span class=\"w\"> </span><span class=\"n\">argument</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">text'</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Lake</span><span class=\"bp\">.</span><span class=\"n\">buildFileAfterDep'</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">proofwidgets</span><span class=\"bp\">\\</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">configuration</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">errors</span>\n<span class=\"n\">Invalid</span><span class=\"w\"> </span><span class=\"n\">Lake</span><span class=\"w\"> </span><span class=\"n\">configuration</span><span class=\"bp\">.</span><span class=\"w\">  </span><span class=\"n\">Please</span><span class=\"w\"> </span><span class=\"n\">restart</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">server</span><span class=\"w\"> </span><span class=\"n\">after</span><span class=\"w\"> </span><span class=\"n\">fixing</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">Lake</span><span class=\"w\"> </span><span class=\"n\">configuration</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"bp\">.</span>\n</code></pre></div>",
        "id": 485703084,
        "sender_full_name": "Alessandro Pinto",
        "timestamp": 1733171205
    },
    {
        "content": "<p>Your first line fetches a <code>v4.11.0</code> tag, what happens if you use leanprover/lean4:v4.11.0?</p>",
        "id": 485704558,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1733171827
    },
    {
        "content": "<p>(you might have to delete the <code>.lake</code> directory inside your project)</p>",
        "id": 485704627,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1733171859
    },
    {
        "content": "<p>Thank you for the suggestions. I tried different versions of the toolchain, and I also tried deleting the .lake directory, but I still see the same issues regarding proofwidgets. I'll keep trying.</p>",
        "id": 485829741,
        "sender_full_name": "Alessandro Pinto",
        "timestamp": 1733226740
    },
    {
        "content": "<p>Does the <code>proofwidgets</code> you're using use the same lean version?</p>",
        "id": 485925580,
        "sender_full_name": "Yicheng Qian",
        "timestamp": 1733251286
    },
    {
        "content": "<p>That's a good point. Why is proofwidgets being imported in the first place? Are you using both <code>lean-auto</code> and <code>mathlib</code>? If so, you must <code>require</code> matching tags. Using mathlib master will cause trouble.</p>",
        "id": 486361125,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1733420494
    },
    {
        "content": "<p>If that's not the problem, please post your <code>lakefile.lean</code> file in full</p>",
        "id": 486361726,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1733420667
    },
    {
        "content": "<p>Lean-auto is a little sensitive to the exact version of Lean and other dependencies used. One data point: I am using Lean 4.12 with lean-auto at commit <code>680d6d58ce2bb65d15e5711d93111b2e5b22cb1a</code> and those work together.</p>",
        "id": 486609155,
        "sender_full_name": "Max Nowak üêâ",
        "timestamp": 1733527149
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"416280\">Max Nowak üêâ</span> <a href=\"#narrow/channel/113488-general/topic/lean-auto/near/486609155\">said</a>:</p>\n<blockquote>\n<p>Lean-auto is a little sensitive to the exact version of Lean and other dependencies used. One data point: I am using Lean 4.12 with lean-auto at commit <code>680d6d58ce2bb65d15e5711d93111b2e5b22cb1a</code> and those work together.</p>\n</blockquote>\n<p>I removed the mathlib dependency, and I am using Lean 4.13. It seems that auto is correctly setup. I am not sure about the output that I am seeing though. For the following Lean program:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Auto</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">redMode</span><span class=\"w\"> </span><span class=\"s2\">\"reducible\"</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">trace</span><span class=\"bp\">.</span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">smt</span><span class=\"bp\">.</span><span class=\"n\">printCommands</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">trace</span><span class=\"bp\">.</span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">smt</span><span class=\"bp\">.</span><span class=\"n\">result</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">smt</span><span class=\"bp\">.</span><span class=\"n\">solver</span><span class=\"bp\">.</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"s2\">\"z3\"</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">smt</span><span class=\"w\"> </span><span class=\"n\">true</span>\n\n\n<span class=\"w\"> </span><span class=\"c1\">-- In `Checker Statistics`, check that the `assertions` field is `4`</span>\n<span class=\"w\">  </span><span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">optimizeCheckerProof</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"w\">  </span><span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">trace</span><span class=\"bp\">.</span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">buildChecker</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"w\">  </span><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h‚ÇÅ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h‚ÇÉ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">auto</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h‚ÇÅ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÉ</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>I see the following output:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Tactic</span><span class=\"w\"> </span><span class=\"n\">state</span>\n<span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">goal</span>\n<span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"n\">Œ±</span><span class=\"bp\">‚úù</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u_1</span>\n<span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"bp\">‚úù</span>\n<span class=\"n\">h‚ÇÅ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span>\n<span class=\"n\">h‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">c</span>\n<span class=\"n\">h‚ÇÉ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">d</span>\n<span class=\"n\">a</span><span class=\"bp\">‚úù</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬¨</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">c</span>\n<span class=\"bp\">‚ä¢</span><span class=\"w\"> </span><span class=\"n\">False</span>\n\n<span class=\"n\">Messages</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"n\">auto_example</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">14</span><span class=\"o\">:</span><span class=\"mi\">4</span>\n<span class=\"mi\">5</span>\n<span class=\"n\">auto_example</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">14</span><span class=\"o\">:</span><span class=\"mi\">4</span>\n<span class=\"o\">[</span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">smt</span><span class=\"bp\">.</span><span class=\"n\">printCommands</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">declare</span><span class=\"bp\">-</span><span class=\"n\">sort</span><span class=\"w\"> </span><span class=\"n\">Empty</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n\n<span class=\"o\">[</span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">smt</span><span class=\"bp\">.</span><span class=\"n\">printCommands</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">define</span><span class=\"bp\">-</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">nsub</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">&gt;=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">))</span>\n\n<span class=\"o\">[</span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">smt</span><span class=\"bp\">.</span><span class=\"n\">printCommands</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">define</span><span class=\"bp\">-</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">itdiv</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">&gt;=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">div</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">div</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)))))</span>\n\n<span class=\"o\">[</span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">smt</span><span class=\"bp\">.</span><span class=\"n\">printCommands</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">define</span><span class=\"bp\">-</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">itmod</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">&gt;=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mod</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mod</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)))))</span>\n\n<span class=\"o\">[</span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">smt</span><span class=\"bp\">.</span><span class=\"n\">printCommands</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">define</span><span class=\"bp\">-</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">iediv</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">div</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)))</span>\n\n<span class=\"o\">[</span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">smt</span><span class=\"bp\">.</span><span class=\"n\">printCommands</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">define</span><span class=\"bp\">-</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">iemod</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mod</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)))</span>\n\n<span class=\"o\">[</span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">smt</span><span class=\"bp\">.</span><span class=\"n\">printCommands</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">declare</span><span class=\"bp\">-</span><span class=\"n\">sort</span><span class=\"w\"> </span><span class=\"bp\">|_</span><span class=\"n\">Œ±</span><span class=\"bp\">.</span><span class=\"m\">71</span><span class=\"bp\">_|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n\n<span class=\"o\">[</span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">smt</span><span class=\"bp\">.</span><span class=\"n\">printCommands</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">declare</span><span class=\"bp\">-</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"bp\">|_</span><span class=\"n\">Œ±</span><span class=\"bp\">.</span><span class=\"m\">71</span><span class=\"bp\">_|</span><span class=\"o\">)</span>\n\n<span class=\"o\">[</span><span class=\"n\">auto</span><span class=\"bp\">.</span><span class=\"n\">smt</span><span class=\"bp\">.</span><span class=\"n\">printCommands</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">assert</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">!</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">d</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"n\">named</span><span class=\"w\"> </span><span class=\"n\">valid_fact_0</span><span class=\"o\">))</span>\n</code></pre></div>\n<p>The <code>by auto</code> tactic is marked with a red squiggle. </p>\n<p>Any insight?</p>",
        "id": 486680551,
        "sender_full_name": "Alessandro Pinto",
        "timestamp": 1733586398
    }
]