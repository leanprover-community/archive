[
    {
        "content": "<p><a href=\"https://www.twitch.tv/quinn_dougherty\">https://www.twitch.tv/quinn_dougherty</a> project: jsonable ASTs of proofs for machine learning reasons</p>",
        "id": 464887672,
        "sender_full_name": "Quinn",
        "timestamp": 1724525373
    },
    {
        "content": "<p>going live in just a sec</p>",
        "id": 464887676,
        "sender_full_name": "Quinn",
        "timestamp": 1724525384
    },
    {
        "content": "<p>Have you seen <a href=\"https://github.com/andrejbauer/lean2sexp\">https://github.com/andrejbauer/lean2sexp</a> ?</p>",
        "id": 464888706,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1724526128
    },
    {
        "content": "<p>no, thanks!!!!</p>",
        "id": 464890664,
        "sender_full_name": "Quinn",
        "timestamp": 1724527096
    },
    {
        "content": "<p>I dont think there anything there that converts sexprs to json, but that should be really easy (it may even be possible to automatically derive a <code>ToJson</code> instance)</p>",
        "id": 464892466,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1724527729
    },
    {
        "content": "<p>dude this rocks so hard. i had no idea. thanks so much</p>",
        "id": 464893935,
        "sender_full_name": "Quinn",
        "timestamp": 1724528788
    },
    {
        "content": "<p><code>#synth ToJson Sexp</code> does fail, but i can hand roll it</p>",
        "id": 464894087,
        "sender_full_name": "Quinn",
        "timestamp": 1724528991
    },
    {
        "content": "<p>You can try to derive it</p>",
        "id": 464896274,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1724530328
    },
    {
        "content": "<p>what's the difference between derive and #synth? i thougth they were working with the same underlying capacties</p>",
        "id": 464896374,
        "sender_full_name": "Quinn",
        "timestamp": 1724530384
    },
    {
        "content": "<p>huh. you're right. going into source and adding <code>deriving ToJson</code> worked, even tho synth failed and when i tried to handroll it i thought i'd have to bypass termination checker or something</p>",
        "id": 464896598,
        "sender_full_name": "Quinn",
        "timestamp": 1724530496
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n\n<span class=\"kd\">inductive</span><span class=\"w\"> </span><span class=\"n\">Sexp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">atom</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Sexp</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">string</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Sexp</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">integer</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Sexp</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">double</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Float</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Sexp</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Sexp</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Sexp</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">Inhabited</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Lean.ToJson</span>\n\n<span class=\"bp\">#</span><span class=\"n\">synth</span><span class=\"w\"> </span><span class=\"n\">Lean.ToJson</span><span class=\"w\"> </span><span class=\"n\">Sexp</span>\n</code></pre></div>",
        "id": 464896632,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1724530514
    },
    {
        "content": "<p>you need to tell lean to explicitly derive the instance. #synth is for typeclass instances that already exist.</p>",
        "id": 464896691,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1724530544
    },
    {
        "content": "<p>oh. i was totally wrong about what synth is then</p>",
        "id": 464896777,
        "sender_full_name": "Quinn",
        "timestamp": 1724530576
    },
    {
        "content": "<p>I'm not sure this is correct (so I'll say it so someone points out a counterexample) but I don't think <code>#foo</code> commands ever have side effects (so it wouldn't create an instance)</p>",
        "id": 464897079,
        "sender_full_name": "Julian Berman",
        "timestamp": 1724530748
    },
    {
        "content": "<p>#foo commands <em>could</em> have side effects, but in practice they don't</p>",
        "id": 464897128,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1724530775
    },
    {
        "content": "<p>Yeah I meant stylistically to be clear.</p>",
        "id": 464897138,
        "sender_full_name": "Julian Berman",
        "timestamp": 1724530783
    },
    {
        "content": "<p>i basically thought it checked if the synthesis was possible, i didn't think it was actually creating it</p>",
        "id": 464897162,
        "sender_full_name": "Quinn",
        "timestamp": 1724530798
    },
    {
        "content": "<p>deriving does something different.</p>",
        "id": 464897218,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1724530811
    },
    {
        "content": "<p>synth just uses the typeclass system, but deriving uses custom handlers to derive instances</p>",
        "id": 464897247,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1724530831
    },
    {
        "content": "<p>Note that you can use deriving in another file, you don't have to edit the original definition.</p>",
        "id": 464897311,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724530859
    },
    {
        "content": "<p>That's a great note as well!</p>",
        "id": 464897370,
        "sender_full_name": "Quinn",
        "timestamp": 1724530891
    },
    {
        "content": "<p>Right (but I always forget the magic spell for this)</p>",
        "id": 464897377,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1724530893
    },
    {
        "content": "<p>What does that look like?</p>",
        "id": 464897395,
        "sender_full_name": "Quinn",
        "timestamp": 1724530900
    },
    {
        "content": "<p>I thought it was <code>deriving instance Lean.ToJson for Sexp</code> or something like that?</p>",
        "id": 464897428,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1724530916
    },
    {
        "content": "<p>Yes</p>",
        "id": 464897551,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724530953
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"693606\">@Quinn</span> I'm watching your stream: you probably want <code>IO.FS.Handle.putStrLn</code> together with <code>Json.compress</code> (or just toString)</p>",
        "id": 464899015,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1724531782
    },
    {
        "content": "<p>compress will make it into a single line</p>",
        "id": 464899081,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1724531829
    },
    {
        "content": "<p>toString usage is <code>toString j</code> for <code>j : Json</code></p>",
        "id": 464899171,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1724531867
    },
    {
        "content": "<p>you can a moduledata from an olean, or from the environment header which is part of an environment</p>",
        "id": 464899690,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1724532132
    }
]