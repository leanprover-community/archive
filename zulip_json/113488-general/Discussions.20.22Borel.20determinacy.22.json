[
    {
        "content": "<p>This is the discussion thread for my formalization of Borel determinacy (<a href=\"https://github.com/sven-manthe/A-formalization-of-Borel-determinacy-in-Lean\">https://github.com/sven-manthe/A-formalization-of-Borel-determinacy-in-Lean</a>, announcement see <a href=\"#narrow/channel/113486-announce/topic/Borel.20determinacy\">https://leanprover.zulipchat.com/#narrow/channel/113486-announce/topic/Borel.20determinacy</a>). In particular, at some point I will probably ask some questions here about whether/how to put this into mathlib. Apart from the definition of Gale-Stewart games and the main proof (which does not seem to be too reusable), the project also contains some API on \"trees\" in the sense of descriptive set theory, subsets of <code>List A</code> that are stable under taking prefixes, and a bit of category theory (for example, the computation of filtered colimits along isomorphisms).</p>",
        "id": 478931165,
        "sender_full_name": "Sven Manthe",
        "timestamp": 1729866739
    },
    {
        "content": "<p>Do you think any of the tactics you wrote would be useful more broadly? (I haven't carefully looked at what they do.)</p>",
        "id": 478933146,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1729867377
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/113488-general/topic/Discussions.20.22Borel.20determinacy.22/near/478933146\">said</a>:</p>\n<blockquote>\n<p>Do you think any of the tactics you wrote would be useful more broadly? (I haven't carefully looked at what they do.)</p>\n</blockquote>\n<p>Let's distinguish cases. <code>casesPlayers</code>, which just does cases on all variables of a fixed type in context, is easy, but maybe also convenient to have in mathlib. <code>synthIsPosition</code> and <code>synthIsFixing</code> are domain-specific.<br>\n<code>simpAtStar</code> just works around a missing configuration option for <code>simp</code>: <code>simp at *</code> won't simplify hypotheses that are dependencies of other hypothesis, which is annoying for tactic sequences like <code>simp at *; omega</code>. This is discussed at <a href=\"#narrow/channel/270676-lean4/topic/simp.20at.20*.20with.20hypotheses.20occurring.20in.20the.20goal\">https://leanprover.zulipchat.com/#narrow/channel/270676-lean4/topic/simp.20at.20*.20with.20hypotheses.20occurring.20in.20the.20goal</a>, <a href=\"https://github.com/leanprover/lean4/issues/5593\">https://github.com/leanprover/lean4/issues/5593</a> and I would argue that my simpAtStar should be added as an option to simp.<br>\nThe last remaining metaprogram is <code>abstract</code>, which moves a proof into an auxilary lemma. This is for performance reasons: Many tactics, like simp, rw or even sorry, will consider large proof terms generated by tactics that are called ad hoc (e.g., <code>f x (by omega)</code>). There is a current workaround that after a <code>def</code> is finished, <code>abstractNestedProofs</code> is called to do something similar to my abstract on propositional subterms. However, this is only done with the value, not with type of the definition, and it is also only done after the definition is evaluated completely, possibly slowing down later parts of this evaluation. I would argue that such a procedure should be applied eagerly as soon as a propositional subterm appears either in the type or the value of a definition (this should also fix <a href=\"https://github.com/leanprover/lean4/issues/5108\">https://github.com/leanprover/lean4/issues/5108</a>, and there is discussion in <a href=\"#narrow/channel/287929-mathlib4/topic/count_heartbeats.20CPU.20usage\">https://leanprover.zulipchat.com/#narrow/channel/287929-mathlib4/topic/count_heartbeats.20CPU.20usage</a>). My current <code>abstract</code>, however, only suffices to avoid the worst performance impacts and is not even able to handle universe metavariables, so that doing this would be some work that I probably won't do. Also note that the performance impact in my project is much larger because I didn't follow the mathlib convention to use junk values instead of propositional arguments (i.e., replace <code>f x (h : p)</code> for <code>p : Prop</code> by <code>if h : p then f x h else default</code>), and mathlib uses propositional arguments only at a few spots (e.g., <code>List.getElem</code>), where the performance impact due to unnecessary unfolding of proof terms isn't that significant yet.</p>",
        "id": 478942997,
        "sender_full_name": "Sven Manthe",
        "timestamp": 1729870519
    },
    {
        "content": "<p>API on \"trees\" in the sense of descriptive set theory would be nice to have in Mathlib.</p>",
        "id": 478986732,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1729889284
    },
    {
        "content": "<p>Tagging <span class=\"user-mention\" data-user-id=\"298851\">@Patrick Lutz</span> who was interested in this</p>",
        "id": 479018818,
        "sender_full_name": "Felix Weilacher",
        "timestamp": 1729915987
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"347475\">Bjørn Kjos-Hanssen ☀️</span> <a href=\"#narrow/channel/113488-general/topic/Discussions.20.22Borel.20determinacy.22/near/478986732\">said</a>:</p>\n<blockquote>\n<p>API on \"trees\" in the sense of descriptive set theory would be nice to have in Mathlib.</p>\n</blockquote>\n<p>There currently is something in the file \"PiNat\", but it codes basic opens by pairs of sequences and natural numbers, while I'm using lists. My choice seemed more convenient (one does not have to choose extensions of lists to sequences, thus needs no separate handling of the empty set, and there is already a good API on lists), but does only work for powers, not arbitrary products. Maybe both approaches could coexist in Mathlib.</p>",
        "id": 479061694,
        "sender_full_name": "Sven Manthe",
        "timestamp": 1729959465
    },
    {
        "content": "<p>Does this have anything to do with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CantorScheme#doc\">docs#CantorScheme</a> ?</p>",
        "id": 479070918,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1729968484
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/113488-general/topic/Discussions.20.22Borel.20determinacy.22/near/479070918\">said</a>:</p>\n<blockquote>\n<p>Does this have anything to do with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CantorScheme#doc\">docs#CantorScheme</a> ?</p>\n</blockquote>\n<p>Yes, this is one of the files that currently use PiNat. (And the result on embedding Cantor sets into Borel subsets of Polish spaces can also be deduced from determinacy.)</p>",
        "id": 479157234,
        "sender_full_name": "Sven Manthe",
        "timestamp": 1730056141
    },
    {
        "content": "<p>There is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PiNat.res#doc\">docs#PiNat.res</a> which allows one to use <code>List</code>s in a very limited way. Having a more well-developed API would be great.</p>",
        "id": 479170900,
        "sender_full_name": "Felix Weilacher",
        "timestamp": 1730068858
    },
    {
        "content": "<p>In <a class=\"stream-topic\" data-stream-id=\"116395\" href=\"/#narrow/channel/116395-maths/topic/borel.20sigma-algebra.20.26.20quotient.20topology\">#maths &gt; borel sigma-algebra &amp; quotient topology</a> ,  we have discussed formalizing the result that Analytic sets are Lebesgue measurable, Baire measurable, etc. </p>\n<p>These can also be deduced from Borel (just closed) determinacy. I wonder if it would be better to formalize these deductions than to give the direct proofs.</p>",
        "id": 479171172,
        "sender_full_name": "Felix Weilacher",
        "timestamp": 1730069135
    },
    {
        "content": "<p>Let's consider Baire category (measure should be analogous). I'm indeed inclined to think that it would be best to formalize the (unraveled) Banach-Mazur game to deduce the Baire property. On the one hand, this is also the proof Kechris uses if I remember correctly, and on the other hand this gives the corresponding results under, e.g., projective determinacy. However, currently mathlib does not even seem to know what analytic or projective sets are unless I missed something (these words have too many definitions in different areas...)</p>",
        "id": 479305336,
        "sender_full_name": "Sven Manthe",
        "timestamp": 1730130284
    },
    {
        "content": "<p>Kechris gives several proofs of analytic Lebesgue/Baire measurability, but I agree that it would be good to have a proof method which goes up through the projective hierarchy fairly seamlessly</p>",
        "id": 479343535,
        "sender_full_name": "Felix Weilacher",
        "timestamp": 1730142694
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/MeasureTheory/Constructions/Polish/Basic.html#MeasureTheory.AnalyticSet\">MeasureTheory.AnalyticSet</a></p>",
        "id": 479343627,
        "sender_full_name": "Felix Weilacher",
        "timestamp": 1730142723
    },
    {
        "content": "<p>^Analytic is defined but nothing further.</p>",
        "id": 479343657,
        "sender_full_name": "Felix Weilacher",
        "timestamp": 1730142743
    },
    {
        "content": "<p>Maybe not a huge deal, but the repo currently doesn't build in Reservoir: <a href=\"https://reservoir.lean-lang.org/@sven-manthe/borel_det\">https://reservoir.lean-lang.org/@sven-manthe/borel_det</a></p>",
        "id": 480262325,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1730593751
    },
    {
        "content": "<p>Thanks for the hint, hopefully fixed (lake build failed also locally since the main file was in the wrong place; I didn't realize this before using only VS Code)</p>",
        "id": 480286323,
        "sender_full_name": "Sven Manthe",
        "timestamp": 1730618528
    },
    {
        "content": "<p>For those interested into getting (parts of) this into mathlib: It would be helpful if some of my PRs get reviewed (e.g., <a href=\"https://github.com/leanprover-community/mathlib4/pull/18458\">https://github.com/leanprover-community/mathlib4/pull/18458</a> is open for more than a week and required for my definition of trees and thus of games)</p>",
        "id": 481149905,
        "sender_full_name": "Sven Manthe",
        "timestamp": 1730994755
    },
    {
        "content": "<p>I am handicapped from a crisis of RSI, so I won't suggest you ask for my review, but in usual times please ask for my review</p>",
        "id": 481150436,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730994935
    },
    {
        "content": "<p>Anyone can do that, by the way. It's a lot easier for reviewers and maintainers if anyone (especially someone familiar with the mathematics or working on related things) has given the PR a first review pass</p>",
        "id": 481150608,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1730994986
    },
    {
        "content": "<p>I wanted to ask whether there are people with a strong interest of getting Borel determinacy into mathlib (lately, reviewing times are rather long, see <a href=\"https://github.com/leanprover-community/mathlib4/pull/18763\">https://github.com/leanprover-community/mathlib4/pull/18763</a>, <a href=\"https://github.com/leanprover-community/mathlib4/pull/19546\">https://github.com/leanprover-community/mathlib4/pull/19546</a>). To be fair, I don't think that there are many interesting intermediate results in my project, but the main result should definitely be appropriate. I'm not sure at the moment whether I'll continue trying to get it into mathlib.</p>",
        "id": 492919232,
        "sender_full_name": "Sven Manthe",
        "timestamp": 1736504681
    },
    {
        "content": "<p>Paper is out: <a href=\"https://arxiv.org/abs/2502.03432\">https://arxiv.org/abs/2502.03432</a> ^_^</p>",
        "id": 498040625,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1738820526
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"651332\">@Sven Manthe</span> I was curious to know what you meant by the sentence:</p>\n<blockquote>\n<p>It also demonstrates that using consistency-wise strong fragments of ZFC does not pose an obstruction to formalizing in itself.</p>\n</blockquote>\n<p>Is this because of the usual claim that (instances of) Replacement are needed for Borel Determinacy? I do know that having the existence of P^alpha(|N)—for alpha a countable ordinal—is enough on top of (roughly) Zermelo set theory as a base theory.</p>\n<p>From skimming the paper, I was wondering if your statement</p>\n<blockquote>\n<p>Furthermore, we replace the use of transfinite induction to show unravelability by a direct induction on the construction of Borel sets. This requires a strengthening of unravelability, which we term “universal unravelability”</p>\n</blockquote>\n<p>amounts to the use of induction along countable ordinals as mentioned, in Martin's proof.</p>",
        "id": 498041121,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1738820810
    },
    {
        "content": "<p>Oh, I see you said more or less what I asked, at the end of section 3.2. I was searching for the wrong terms so didn't see that.</p>\n<p>Also, I would gently push back on the claim</p>\n<blockquote>\n<p>Thus, Borel determinacy, which is famous for requiring a <strong>much larger fragment</strong> of ZFC than most usual theorems [citing Friedman 1971] ... [emphasis added]</p>\n</blockquote>\n<p>It's not a <em>much</em> larger fragment, the single axiom that \"all beths exist\" is very mild and more than suffices (one might instead ask that arbitrarily-iterated power sets exist). And asking that merely countable-ordinal-iterated powersets exist is likewise weaker again.</p>\n<p>It took me years to understand that experts know, but don't really say, that what BD needs to a lot weaker than what is usually said in print (including when citing Friedman's famous result), and eventually we get this: <a href=\"https://golem.ph.utexas.edu/category/2021/07/borel_determinacy_does_not_require_replacement.html\">https://golem.ph.utexas.edu/category/2021/07/borel_determinacy_does_not_require_replacement.html</a></p>",
        "id": 498044312,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1738822744
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130272\">David Michael Roberts</span> <a href=\"#narrow/channel/113488-general/topic/Discussions.20.22Borel.20determinacy.22/near/498041121\">said</a>:</p>\n<blockquote>\n<p>amounts to the use of induction along countable ordinals as mentioned, in Martin's proof.</p>\n</blockquote>\n<p>Exactly - I replace this by showing that the universally unravelable sets form a σ-algebra, which I called \"direct induction\" here</p>",
        "id": 498095795,
        "sender_full_name": "Sven Manthe",
        "timestamp": 1738840519
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130272\">David Michael Roberts</span> <a href=\"#narrow/channel/113488-general/topic/Discussions.20.22Borel.20determinacy.22/near/498044312\">said</a>:</p>\n<blockquote>\n<p>It's not a <em>much</em> larger fragment, the single axiom that \"all beths exist\" is very mild and more than suffices (one might instead ask that arbitrarily-iterated power sets exist). And asking that merely countable-ordinal-iterated powersets exist is likewise weaker again.</p>\n</blockquote>\n<p>I agree that the word \"much\" here is very dependent on the perspective. My intention was more along the lines of: \"most usual theorems\" are even provable in fragments of higher order arithmetic, which do not suffice to even talk about infinite beth numbers literally. (I'm aware of Leinster's article.)</p>",
        "id": 498096774,
        "sender_full_name": "Sven Manthe",
        "timestamp": 1738840850
    },
    {
        "content": "<p>OK, thanks for clarifying the baseline: HOA, not, eg ETCS. I was making an assumption about that.</p>",
        "id": 498111188,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1738845497
    },
    {
        "content": "<p>BTW, I'm very happy this has been done (I didn't see the announcement of the formalisation earlier, just learned it from the arXiv posting).</p>",
        "id": 498111364,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1738845552
    }
]