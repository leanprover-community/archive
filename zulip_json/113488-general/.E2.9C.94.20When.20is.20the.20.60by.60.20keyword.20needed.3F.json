[
    {
        "content": "<p>I have two proofs of the same lemma, one using the <code>by</code> keyword and the other not. Both of them compile, however, so I'm curious when exactly that keyword is necessary to use. Here are the two proofs:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">assumption</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">calc</span>\n<span class=\"w\">    </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">assumption</span>\n</code></pre></div>",
        "id": 452362658,
        "sender_full_name": "Rick de Wolf",
        "timestamp": 1721313617
    },
    {
        "content": "<p><code>by</code> says that a tactic block is about to happen basically. Tactics are in a diffeerent syntactic category than normal terms and commands so you can't just write them everywhere.</p>",
        "id": 452365199,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1721314349
    },
    {
        "content": "<p>FYI this also works:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">calc</span>\n<span class=\"w\">    </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">assumption</span>\n</code></pre></div>",
        "id": 452365388,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1721314411
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"395550\">@Henrik Böving</span> so is the calc block in the second proof not considered to be a tactic and it is in the first?</p>",
        "id": 452365919,
        "sender_full_name": "Rick de Wolf",
        "timestamp": 1721314550
    },
    {
        "content": "<p>It would appear that <code>calc</code> has been registered both as a tactic and as a term. This is the case with multiple syntaxes such as <code>if</code> or <code>match</code>.</p>",
        "id": 452366101,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1721314584
    },
    {
        "content": "<p>Yeah. There are some words like <code>rfl</code> and <code>calc</code> that mean both a tactic and something else.</p>",
        "id": 452366176,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1721314602
    },
    {
        "content": "<p>Alright, that's confusing, but good to know. Thanks for the help everyone</p>",
        "id": 452366277,
        "sender_full_name": "Rick de Wolf",
        "timestamp": 1721314629
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"603023\">Rick de Wolf</span> has marked this topic as resolved.</p>",
        "id": 452366329,
        "sender_full_name": "Notification Bot",
        "timestamp": 1721314641
    },
    {
        "content": "<p>You can make sure you understand <code>by</code> by having a look at this example:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">A'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">A'</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>",
        "id": 452366883,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1721314753
    },
    {
        "content": "<p>That makes no sense to me, what's going on there?</p>",
        "id": 452368678,
        "sender_full_name": "Rick de Wolf",
        "timestamp": 1721315132
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"603023\">Rick de Wolf</span> has marked this topic as unresolved.</p>",
        "id": 452368758,
        "sender_full_name": "Notification Bot",
        "timestamp": 1721315147
    },
    {
        "content": "<p>This is implicitly parenthesized as <code>by exact (by exact (by exact (by exact h)))</code> so it says you can get a term that closes the goal by executing some tactic block. And that tactic block does the same and the same etc. until you get to the <code>h</code>.</p>",
        "id": 452369300,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1721315239
    },
    {
        "content": "<p><code>by</code> moves you to \"tactic mode\", and <code>exact</code> is a tactic that just returns the term again</p>",
        "id": 452369385,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1721315252
    },
    {
        "content": "<p>Ah, that's really interesting! So a good way to think about by blocks is that they 'return' a term. I'll make a note of that.</p>",
        "id": 452370417,
        "sender_full_name": "Rick de Wolf",
        "timestamp": 1721315420
    },
    {
        "content": "<p>Yes, tactic mode's job is to return a term of some type. It allows you to build this term incrementally by having holes in it which are the goals that you need to close. Each tactic call massages those holes a little until you are finished.</p>",
        "id": 452370652,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1721315477
    },
    {
        "content": "<p>The incrementally building by having holes in it is still unclear to me. Is understanding that important to getting a good grip on Lean?</p>",
        "id": 452371208,
        "sender_full_name": "Rick de Wolf",
        "timestamp": 1721315616
    },
    {
        "content": "<p>No, that's more of an implementation explanation for how exactly those terms are built. You can just close your goals and be happy.</p>",
        "id": 452371571,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1721315705
    },
    {
        "content": "<p>I'll take being happy then :P Thanks again!</p>",
        "id": 452371702,
        "sender_full_name": "Rick de Wolf",
        "timestamp": 1721315734
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"603023\">Rick de Wolf</span> has marked this topic as resolved.</p>",
        "id": 452371942,
        "sender_full_name": "Notification Bot",
        "timestamp": 1721315786
    },
    {
        "content": "<p>If you do want to see the incrementality in action, you can put <code>show_term</code> in front of a tactic to see what term it constructed.</p>\n<p>As a shorthand, <code>by?</code> is <code>show_term by</code>, if you want to see what the whole tactic script did.</p>",
        "id": 452391414,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1721321236
    }
]