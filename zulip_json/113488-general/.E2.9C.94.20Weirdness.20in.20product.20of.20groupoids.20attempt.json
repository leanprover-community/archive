[
    {
        "content": "<p>I'm trying to show that the product of groupoids is a groupoid. In words, this is because for groupoids <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span>, if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo>∈</mo><mi>X</mi><mo>×</mo><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">x,y \\in X\\times Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> are objects and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo separator=\"true\">,</mo><mi>g</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(f, g)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mclose\">)</span></span></span></span> a morphism between them, then <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo separator=\"true\">,</mo><mi>g</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(f, g)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mclose\">)</span></span></span></span> has an inverse, namely <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msup><mi>f</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo separator=\"true\">,</mo><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(f^{-1}, g^{-1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>.</p>\n<p>This is a very simple fact, and it might already be in mathlib. In any case, I'm (re)proving it, and I have this so far (which works correctly):</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">universe</span> <span class=\"n\">u</span>\n\n<span class=\"kd\">abbreviation</span> <span class=\"n\">inv</span> <span class=\"o\">:=</span> <span class=\"bp\">@</span><span class=\"n\">category_theory.groupoid.inv</span>\n\n<span class=\"kd\">instance</span> <span class=\"n\">groupoid_prod</span> <span class=\"o\">{</span><span class=\"n\">X</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">category_theory.groupoid.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"n\">X</span><span class=\"o\">]</span>\n                    <span class=\"o\">{</span><span class=\"n\">Y</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">category_theory.groupoid.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"n\">Y</span><span class=\"o\">]</span>\n                  <span class=\"o\">:</span> <span class=\"n\">category_theory.groupoid.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">X</span> <span class=\"bp\">×</span> <span class=\"n\">Y</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span>\n  <span class=\"n\">inv</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"n\">y</span> <span class=\"o\">:</span> <span class=\"n\">X</span> <span class=\"bp\">×</span> <span class=\"n\">Y</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"n\">x.1</span> <span class=\"bp\">⟶</span> <span class=\"n\">y.1</span><span class=\"o\">)</span> <span class=\"bp\">×</span> <span class=\"o\">(</span><span class=\"n\">x.2</span> <span class=\"bp\">⟶</span> <span class=\"n\">y.2</span><span class=\"o\">)),</span>\n            <span class=\"o\">(</span><span class=\"n\">inv</span> <span class=\"n\">f.1</span><span class=\"o\">,</span> <span class=\"n\">inv</span> <span class=\"n\">f.2</span><span class=\"o\">),</span>\n  <span class=\"n\">inv_comp'</span> <span class=\"o\">:=</span>\n  <span class=\"kd\">begin</span>\n    <span class=\"n\">intros</span> <span class=\"n\">x</span> <span class=\"n\">y</span> <span class=\"n\">f</span><span class=\"o\">,</span>\n    <span class=\"c1\">-- change ((inv f.1, inv f.2) : y ⟶ x) ≫ ((f.1, f.2) : x ⟶ y) = 𝟙 y,</span>\n    <span class=\"k\">let</span> <span class=\"n\">inv_f</span> <span class=\"o\">:</span> <span class=\"n\">y</span> <span class=\"bp\">⟶</span> <span class=\"n\">x</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">inv</span> <span class=\"n\">f.1</span><span class=\"o\">,</span> <span class=\"n\">inv</span> <span class=\"n\">f.2</span><span class=\"o\">),</span>\n    <span class=\"k\">let</span> <span class=\"n\">f_hom</span> <span class=\"o\">:</span> <span class=\"n\">x</span> <span class=\"bp\">⟶</span> <span class=\"n\">y</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">f.1</span><span class=\"o\">,</span> <span class=\"n\">f.2</span><span class=\"o\">),</span>\n    <span class=\"n\">change</span> <span class=\"n\">inv_f</span> <span class=\"bp\">≫</span> <span class=\"n\">f_hom</span> <span class=\"bp\">=</span> <span class=\"mi\">𝟙</span> <span class=\"n\">y</span><span class=\"o\">,</span>\n    <span class=\"k\">have</span> <span class=\"n\">prodcomp</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"n\">inv_f</span> <span class=\"bp\">≫</span> <span class=\"n\">f_hom</span> <span class=\"bp\">=</span> <span class=\"n\">_</span><span class=\"o\">)</span>\n    <span class=\"o\">:=</span> <span class=\"bp\">@</span><span class=\"n\">category_theory.prod_comp</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span>\n      <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">inv_f</span> <span class=\"n\">f_hom</span><span class=\"o\">,</span>\n    <span class=\"n\">rw</span> <span class=\"n\">prodcomp</span><span class=\"o\">,</span>\n    <span class=\"n\">simpa</span><span class=\"o\">,</span>\n  <span class=\"kd\">end</span><span class=\"o\">,</span>\n\n  <span class=\"n\">comp_inv'</span> <span class=\"o\">:=</span>\n  <span class=\"kd\">begin</span>\n    <span class=\"c1\">-- Removed for clarity, essentially the same as inv_comp'</span>\n  <span class=\"kd\">end</span><span class=\"o\">,</span>\n<span class=\"o\">}</span>\n</code></pre></div>\n<p>This works, but it feels very clunky. For example, I wanted to use the line <code>change ((inv f.1, inv f.2) : y ⟶ x) ≫ ((f.1, f.2) : x ⟶ y) = 𝟙 y</code>,<br>\nbut for some reason Lean gives a type error. My workaround (after lots of tinkering) was to use two let statements with explicit types. I don't understand why this works but the other way doesn't.</p>\n<p>Next, something even more mysterious (to me). I wanted to use something like:<br>\n<code>rw category_theory.prod_comp  inv_f f_hom</code></p>\n<p>Unfortunately, the only way I could make it work was as shown in the original code. Specifically, I had to move it to a variable <code>prodcomp</code>, which also has to have an explicit type, and use <code>@</code> even though all the parameters are underscores. If I don't give it an explicit type, Lean infers the correct type (in fact, the type doesn't change at all!), but the rewrite fails for some reason.</p>\n<p>Can anyone explain what's going on?</p>\n<p>Also, I noticed that if I put enough blank lines after the begin statement, the goal randomly changes according to VS Code (to <code>∀ {X_1 Y_1 : X × Y} (f : X_1 ⟶ Y_1), 𝟙 X_1 ≫ f = f</code>, which I guess is easier to prove). This doesn't help in proving the theorem, because as soon as you do a tactic like <code>intro</code>, it changes back to what it was supposed to be, so this is probably a small bug in Lean/VS Code. Still, it's not helping my suspicion that my version of Lean is haunted.</p>",
        "id": 264962309,
        "sender_full_name": "Praneeth Kolichala",
        "timestamp": 1639540482
    },
    {
        "content": "<p>I'm able to reproduce the blank lines bug in the online WebAssembly version of Lean <a href=\"https://leanprover-community.github.io/lean-web-editor/#code=import%20category_theory.groupoid%0Aimport%20category_theory.products.basic%0A%0A%0A%0A%0A%0A%0A%0Auniverse%20u%0A%0Aabbreviation%20inv%20%3A%3D%20%40category_theory.groupoid.inv%0A%0Ainstance%20groupoid_prod%20%7BX%20%3A%20Type%20u%7D%20%5Bcategory_theory.groupoid.%7Bu%7D%20X%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7BY%20%3A%20Type%20u%7D%20%5Bcategory_theory.groupoid.%7Bu%7D%20Y%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20category_theory.groupoid.%7Bu%7D%20%28X%20%C3%97%20Y%29%20%3A%3D%20%0A%7B%0A%20%20inv%20%3A%3D%20%CE%BB%20%28x%20y%20%3A%20X%20%C3%97%20Y%29%20%28f%20%3A%20%28x.1%20%E2%9F%B6%20y.1%29%20%C3%97%20%28x.2%20%E2%9F%B6%20y.2%29%29%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%28inv%20f.1%2C%20inv%20f.2%29%2C%0A%20%20inv_comp'%20%3A%3D%0A%20%20begin%0A%0A%0A%0A%0A%0A%0A%0A%0A%20%20%20%20skip%2C%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%20%20%20%20intros%20x%20y%20f%2C%0A%20%20%20%20--%20change%20%28%28inv%20f.1%2C%20inv%20f.2%29%20%3A%20y%20%E2%9F%B6%20x%29%20%E2%89%AB%20%28%28f.1%2C%20f.2%29%20%3A%20x%20%E2%9F%B6%20y%29%20%3D%20%F0%9D%9F%99%20y%2C%0A%20%20%20%20let%20inv_f%20%3A%20y%20%E2%9F%B6%20x%20%3A%3D%20%28inv%20f.1%2C%20inv%20f.2%29%2C%0A%20%20%20%20let%20f_hom%20%3A%20x%20%E2%9F%B6%20y%20%3A%3D%20%28f.1%2C%20f.2%29%2C%0A%20%20%20%20change%20inv_f%20%E2%89%AB%20f_hom%20%3D%20%F0%9D%9F%99%20y%2C%0A%20%20%20%20have%20prodcomp%20%3A%20%28inv_f%20%E2%89%AB%20f_hom%20%3D%20_%29%20%0A%20%20%20%20%3A%3D%20%40category_theory.prod_comp%20_%20_%20_%20_%0A%20%20%20%20%20%20_%20_%20_%20_%20_%20_%20inv_f%20f_hom%2C%0A%20%20%20%20rw%20prodcomp%2C%0A%20%20%20%20simpa%2C%0A%20%20end%2C%0A%20%20%0A%20%20comp_inv'%20%3A%3D%0A%20%20begin%0A%20%20%20%20intros%20x%20y%20f%2C%0A%20%20%20%20let%20inv_f%20%3A%20y%20%E2%9F%B6%20x%20%3A%3D%20%28inv%20f.1%2C%20inv%20f.2%29%2C%0A%20%20%20%20let%20f_hom%20%3A%20x%20%E2%9F%B6%20y%20%3A%3D%20%28f.1%2C%20f.2%29%2C%0A%20%20%20%20change%20f_hom%20%E2%89%AB%20inv_f%20%3D%20%F0%9D%9F%99%20x%2C%0A%20%20%20%20have%20prodcomp%20%3A%20%28f_hom%20%E2%89%AB%20inv_f%20%3D%20_%29%20%0A%20%20%20%20%3A%3D%20%40category_theory.prod_comp%20_%20_%20_%20_%0A%20%20%20%20%20%20_%20_%20_%20_%20_%20_%20f_hom%20inv_f%2C%0A%20%20%20%20rw%20prodcomp%2C%0A%20%20%20%20simpa%2C%0A%20%20end%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%7D%0A%0A%0A%0A\">here</a>.</p>\n<p>You have to use the exact number of blank lines; no more, no less. The <code>skip</code> is not necessary, it just illustrates the goal change. Any tactic which creates a new node in the syntax tree will do I think.</p>",
        "id": 264963136,
        "sender_full_name": "Praneeth Kolichala",
        "timestamp": 1639541518
    },
    {
        "content": "<p>Could you provide a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> so I could paste your source code into my editor?</p>",
        "id": 264963961,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1639542322
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"243562\">@Adam Topaz</span> The code with the blank lines bug also has the rest of the code: <a href=\"https://leanprover-community.github.io/lean-web-editor/#code=import%20category_theory.groupoid%0Aimport%20category_theory.products.basic%0A%0A%0A%0A%0A%0A%0A%0Auniverse%20u%0A%0Aabbreviation%20inv%20%3A%3D%20%40category_theory.groupoid.inv%0A%0Ainstance%20groupoid_prod%20%7BX%20%3A%20Type%20u%7D%20%5Bcategory_theory.groupoid.%7Bu%7D%20X%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7BY%20%3A%20Type%20u%7D%20%5Bcategory_theory.groupoid.%7Bu%7D%20Y%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20category_theory.groupoid.%7Bu%7D%20%28X%20%C3%97%20Y%29%20%3A%3D%20%0A%7B%0A%20%20inv%20%3A%3D%20%CE%BB%20%28x%20y%20%3A%20X%20%C3%97%20Y%29%20%28f%20%3A%20%28x.1%20%E2%9F%B6%20y.1%29%20%C3%97%20%28x.2%20%E2%9F%B6%20y.2%29%29%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%28inv%20f.1%2C%20inv%20f.2%29%2C%0A%20%20inv_comp'%20%3A%3D%0A%20%20begin%0A%0A%0A%0A%0A%0A%0A%0A%0A%20%20%20%20skip%2C%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%20%20%20%20intros%20x%20y%20f%2C%0A%20%20%20%20--%20change%20%28%28inv%20f.1%2C%20inv%20f.2%29%20%3A%20y%20%E2%9F%B6%20x%29%20%E2%89%AB%20%28%28f.1%2C%20f.2%29%20%3A%20x%20%E2%9F%B6%20y%29%20%3D%20%F0%9D%9F%99%20y%2C%0A%20%20%20%20let%20inv_f%20%3A%20y%20%E2%9F%B6%20x%20%3A%3D%20%28inv%20f.1%2C%20inv%20f.2%29%2C%0A%20%20%20%20let%20f_hom%20%3A%20x%20%E2%9F%B6%20y%20%3A%3D%20%28f.1%2C%20f.2%29%2C%0A%20%20%20%20change%20inv_f%20%E2%89%AB%20f_hom%20%3D%20%F0%9D%9F%99%20y%2C%0A%20%20%20%20have%20prodcomp%20%3A%20%28inv_f%20%E2%89%AB%20f_hom%20%3D%20_%29%20%0A%20%20%20%20%3A%3D%20%40category_theory.prod_comp%20_%20_%20_%20_%0A%20%20%20%20%20%20_%20_%20_%20_%20_%20_%20inv_f%20f_hom%2C%0A%20%20%20%20rw%20prodcomp%2C%0A%20%20%20%20simpa%2C%0A%20%20end%2C%0A%20%20%0A%20%20comp_inv'%20%3A%3D%0A%20%20begin%0A%20%20%20%20intros%20x%20y%20f%2C%0A%20%20%20%20let%20inv_f%20%3A%20y%20%E2%9F%B6%20x%20%3A%3D%20%28inv%20f.1%2C%20inv%20f.2%29%2C%0A%20%20%20%20let%20f_hom%20%3A%20x%20%E2%9F%B6%20y%20%3A%3D%20%28f.1%2C%20f.2%29%2C%0A%20%20%20%20change%20f_hom%20%E2%89%AB%20inv_f%20%3D%20%F0%9D%9F%99%20x%2C%0A%20%20%20%20have%20prodcomp%20%3A%20%28f_hom%20%E2%89%AB%20inv_f%20%3D%20_%29%20%0A%20%20%20%20%3A%3D%20%40category_theory.prod_comp%20_%20_%20_%20_%0A%20%20%20%20%20%20_%20_%20_%20_%20_%20_%20f_hom%20inv_f%2C%0A%20%20%20%20rw%20prodcomp%2C%0A%20%20%20%20simpa%2C%0A%20%20end%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%7D%0A%0A%0A%0A\">this is the link</a></p>\n<p>The full code is</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">category_theory.groupoid</span>\n<span class=\"kn\">import</span> <span class=\"n\">category_theory.products.basic</span>\n\n\n\n\n\n\n\n<span class=\"kd\">universe</span> <span class=\"n\">u</span>\n\n<span class=\"kd\">abbreviation</span> <span class=\"n\">inv</span> <span class=\"o\">:=</span> <span class=\"bp\">@</span><span class=\"n\">category_theory.groupoid.inv</span>\n\n<span class=\"kd\">instance</span> <span class=\"n\">groupoid_prod</span> <span class=\"o\">{</span><span class=\"n\">X</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">category_theory.groupoid.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"n\">X</span><span class=\"o\">]</span>\n                    <span class=\"o\">{</span><span class=\"n\">Y</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">category_theory.groupoid.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"n\">Y</span><span class=\"o\">]</span>\n                  <span class=\"o\">:</span> <span class=\"n\">category_theory.groupoid.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">X</span> <span class=\"bp\">×</span> <span class=\"n\">Y</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span>\n  <span class=\"n\">inv</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"n\">y</span> <span class=\"o\">:</span> <span class=\"n\">X</span> <span class=\"bp\">×</span> <span class=\"n\">Y</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"n\">x.1</span> <span class=\"bp\">⟶</span> <span class=\"n\">y.1</span><span class=\"o\">)</span> <span class=\"bp\">×</span> <span class=\"o\">(</span><span class=\"n\">x.2</span> <span class=\"bp\">⟶</span> <span class=\"n\">y.2</span><span class=\"o\">)),</span>\n            <span class=\"o\">(</span><span class=\"n\">inv</span> <span class=\"n\">f.1</span><span class=\"o\">,</span> <span class=\"n\">inv</span> <span class=\"n\">f.2</span><span class=\"o\">),</span>\n  <span class=\"n\">inv_comp'</span> <span class=\"o\">:=</span>\n  <span class=\"kd\">begin</span>\n\n\n\n\n\n\n\n\n    <span class=\"n\">skip</span><span class=\"o\">,</span>\n\n\n\n\n\n\n\n\n\n    <span class=\"n\">intros</span> <span class=\"n\">x</span> <span class=\"n\">y</span> <span class=\"n\">f</span><span class=\"o\">,</span>\n    <span class=\"c1\">-- change ((inv f.1, inv f.2) : y ⟶ x) ≫ ((f.1, f.2) : x ⟶ y) = 𝟙 y,</span>\n    <span class=\"k\">let</span> <span class=\"n\">inv_f</span> <span class=\"o\">:</span> <span class=\"n\">y</span> <span class=\"bp\">⟶</span> <span class=\"n\">x</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">inv</span> <span class=\"n\">f.1</span><span class=\"o\">,</span> <span class=\"n\">inv</span> <span class=\"n\">f.2</span><span class=\"o\">),</span>\n    <span class=\"k\">let</span> <span class=\"n\">f_hom</span> <span class=\"o\">:</span> <span class=\"n\">x</span> <span class=\"bp\">⟶</span> <span class=\"n\">y</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">f.1</span><span class=\"o\">,</span> <span class=\"n\">f.2</span><span class=\"o\">),</span>\n    <span class=\"n\">change</span> <span class=\"n\">inv_f</span> <span class=\"bp\">≫</span> <span class=\"n\">f_hom</span> <span class=\"bp\">=</span> <span class=\"mi\">𝟙</span> <span class=\"n\">y</span><span class=\"o\">,</span>\n    <span class=\"k\">have</span> <span class=\"n\">prodcomp</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"n\">inv_f</span> <span class=\"bp\">≫</span> <span class=\"n\">f_hom</span> <span class=\"bp\">=</span> <span class=\"n\">_</span><span class=\"o\">)</span>\n    <span class=\"o\">:=</span> <span class=\"bp\">@</span><span class=\"n\">category_theory.prod_comp</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span>\n      <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">inv_f</span> <span class=\"n\">f_hom</span><span class=\"o\">,</span>\n    <span class=\"n\">rw</span> <span class=\"n\">prodcomp</span><span class=\"o\">,</span>\n    <span class=\"n\">simpa</span><span class=\"o\">,</span>\n  <span class=\"kd\">end</span><span class=\"o\">,</span>\n\n  <span class=\"n\">comp_inv'</span> <span class=\"o\">:=</span>\n  <span class=\"kd\">begin</span>\n    <span class=\"n\">intros</span> <span class=\"n\">x</span> <span class=\"n\">y</span> <span class=\"n\">f</span><span class=\"o\">,</span>\n    <span class=\"k\">let</span> <span class=\"n\">inv_f</span> <span class=\"o\">:</span> <span class=\"n\">y</span> <span class=\"bp\">⟶</span> <span class=\"n\">x</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">inv</span> <span class=\"n\">f.1</span><span class=\"o\">,</span> <span class=\"n\">inv</span> <span class=\"n\">f.2</span><span class=\"o\">),</span>\n    <span class=\"k\">let</span> <span class=\"n\">f_hom</span> <span class=\"o\">:</span> <span class=\"n\">x</span> <span class=\"bp\">⟶</span> <span class=\"n\">y</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">f.1</span><span class=\"o\">,</span> <span class=\"n\">f.2</span><span class=\"o\">),</span>\n    <span class=\"n\">change</span> <span class=\"n\">f_hom</span> <span class=\"bp\">≫</span> <span class=\"n\">inv_f</span> <span class=\"bp\">=</span> <span class=\"mi\">𝟙</span> <span class=\"n\">x</span><span class=\"o\">,</span>\n    <span class=\"k\">have</span> <span class=\"n\">prodcomp</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"n\">f_hom</span> <span class=\"bp\">≫</span> <span class=\"n\">inv_f</span> <span class=\"bp\">=</span> <span class=\"n\">_</span><span class=\"o\">)</span>\n    <span class=\"o\">:=</span> <span class=\"bp\">@</span><span class=\"n\">category_theory.prod_comp</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span>\n      <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">f_hom</span> <span class=\"n\">inv_f</span><span class=\"o\">,</span>\n    <span class=\"n\">rw</span> <span class=\"n\">prodcomp</span><span class=\"o\">,</span>\n    <span class=\"n\">simpa</span><span class=\"o\">,</span>\n  <span class=\"kd\">end</span><span class=\"o\">,</span>\n<span class=\"o\">}</span>\n</code></pre></div>",
        "id": 264964179,
        "sender_full_name": "Praneeth Kolichala",
        "timestamp": 1639542494
    },
    {
        "content": "<p>It would be easier if you just paste it into zulip</p>",
        "id": 264964203,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1639542515
    },
    {
        "content": "<p>Anyway, this works for me:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">category_theory.products</span>\n<span class=\"kn\">import</span> <span class=\"n\">category_theory.groupoid</span>\n\n<span class=\"kd\">universe</span> <span class=\"n\">u</span>\n\n<span class=\"kn\">open</span> <span class=\"n\">category_theory</span>\n\n<span class=\"kd\">instance</span> <span class=\"n\">groupoid_prod</span> <span class=\"o\">{</span><span class=\"n\">X</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">category_theory.groupoid.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"n\">X</span><span class=\"o\">]</span>\n  <span class=\"o\">{</span><span class=\"n\">Y</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">category_theory.groupoid.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"n\">Y</span><span class=\"o\">]</span> <span class=\"o\">:</span>\n  <span class=\"n\">category_theory.groupoid.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">X</span> <span class=\"bp\">×</span> <span class=\"n\">Y</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">inv</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">A</span> <span class=\"n\">B</span> <span class=\"n\">f</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">groupoid.inv</span> <span class=\"n\">f.fst</span><span class=\"o\">,</span> <span class=\"n\">groupoid.inv</span> <span class=\"n\">f.snd</span><span class=\"o\">)</span> <span class=\"o\">}</span>\n</code></pre></div>",
        "id": 264964249,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1639542572
    },
    {
        "content": "<p>The <code>auto_param</code>s in the required proofs is able to close the goals.</p>",
        "id": 264964266,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1639542596
    },
    {
        "content": "<p><del>Your code is missing imports btw.</del></p>",
        "id": 264964322,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1639542619
    },
    {
        "content": "<p>The strange behavior you noticed is probably some minor bug in the vscode extension, if I had to guess... Why do you want all the blank lines anyway?</p>",
        "id": 264964431,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1639542742
    },
    {
        "content": "<p>It can't be the VS Code extension because the problem is reproduced online as well, right?<br>\nI don't want the blank lines, it was just something weird that I noticed.</p>",
        "id": 264964484,
        "sender_full_name": "Praneeth Kolichala",
        "timestamp": 1639542822
    },
    {
        "content": "<p>I agree it's strange.</p>",
        "id": 264964588,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1639542911
    },
    {
        "content": "<p>It looks like somehow the <code>id_comp'</code> field is picked up after the skip.</p>",
        "id": 264964624,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1639542960
    },
    {
        "content": "<p>Even though <code>id_comp'</code> was omitted because it's part of the category theory structure which is inferred.</p>",
        "id": 264964678,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1639542984
    },
    {
        "content": "<p>Also, could someone explain why in the original proofs, the <code>change</code> wasn't working originally, and the <code>prodcomp</code> had to be moved to its own variable? I'm just substituting equal things for other things that are equal. Specifically, why doesn't this work:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">inv_comp'</span> <span class=\"o\">:=</span>\n  <span class=\"kd\">begin</span>\n    <span class=\"n\">intros</span> <span class=\"n\">x</span> <span class=\"n\">y</span> <span class=\"n\">f</span><span class=\"o\">,</span>\n    <span class=\"n\">change</span> <span class=\"o\">((</span><span class=\"n\">inv</span> <span class=\"n\">f.1</span><span class=\"o\">,</span> <span class=\"n\">inv</span> <span class=\"n\">f.2</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">y</span> <span class=\"bp\">⟶</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"bp\">≫</span> <span class=\"o\">((</span><span class=\"n\">f.1</span><span class=\"o\">,</span> <span class=\"n\">f.2</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">x</span> <span class=\"bp\">⟶</span> <span class=\"n\">y</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">𝟙</span> <span class=\"n\">y</span><span class=\"o\">,</span>\n    <span class=\"n\">rw</span> <span class=\"bp\">@</span><span class=\"n\">category_theory.prod_comp</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span>\n      <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">inv_f</span> <span class=\"n\">f_hom</span><span class=\"o\">,</span>\n    <span class=\"n\">simpa</span><span class=\"o\">,</span>\n  <span class=\"kd\">end</span><span class=\"o\">,</span>\n</code></pre></div>\n<p>(which is what I originally wanted to write).</p>",
        "id": 264965166,
        "sender_full_name": "Praneeth Kolichala",
        "timestamp": 1639543507
    },
    {
        "content": "<p>because <code>f</code> is not defeq to <code>(f.fst,f.snd)</code>. If you first do <code>cases f</code>, then the change should work.</p>",
        "id": 264965500,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1639543852
    },
    {
        "content": "<p>Oh wait, that's not quite the issue. one sec</p>",
        "id": 264965538,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1639543914
    },
    {
        "content": "<p>The goal showing up different is the \"line 65 character 33\" bug, it's solely visual, not the actual goal. It exists not just in VSCode but all other editors.</p>",
        "id": 264965598,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1639543952
    },
    {
        "content": "<p><a href=\"#narrow/stream/113488-general/topic/Extension.20showing.20goal.20for.20a.20separate.20lemma\">https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extension.20showing.20goal.20for.20a.20separate.20lemma</a>, <a href=\"https://github.com/leanprover-community/lean/issues/468\">https://github.com/leanprover-community/lean/issues/468</a></p>",
        "id": 264965815,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1639544184
    },
    {
        "content": "<p>It looks like lean is having a hard time seeing that the morphisms in the product category are indeed terms of the product of the hom types.</p>",
        "id": 264965818,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1639544193
    },
    {
        "content": "<p>That and what I said above: <code>f</code> is not definitionally equal to the pair <code>(f.fst, f.snd)</code>.</p>",
        "id": 264965837,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1639544236
    },
    {
        "content": "<p><code>change</code> is a tactic that converts some expression to another expression which is definitionally equal to it.</p>",
        "id": 264965850,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1639544254
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"437861\">Praneeth Kolichala</span> has marked this topic as resolved.</p>",
        "id": 264966599,
        "sender_full_name": "Notification Bot",
        "timestamp": 1639545074
    }
]