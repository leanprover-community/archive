[
    {
        "content": "<p>mdbook is useful for documentation. mdbook will still be a popular tool in Lean project until verso becomes more popular.</p>\n<p>I have customised the mdbook for Lean for myself. It supports Lean syntax highlight and MathJax, as well as the ability to jump to the Lean Playground. Various other functions are also supported.</p>\n<p>Source of my template is available here. I would be happy if it is useful to someone.<br>\n<a href=\"https://github.com/Seasawher/lean-book\">https://github.com/Seasawher/lean-book</a></p>",
        "id": 426655292,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1710464124
    },
    {
        "content": "<p>The links in <a href=\"https://github.com/Seasawher/lean-book/blob/main/md/SUMMARY.md\">/md/SUMMARY.md</a> seem incorrect? </p>\n<p>And when I follow the instructions in <a href=\"https://github.com/Seasawher/lean-book/blob/main/Src/HowToUse.lean\">/Src/HowToUse.lean</a> and run <code>lake build</code> and <code>mdbook serve --open</code>, I get the following error:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"m\">2024</span>-03-20<span class=\"w\"> </span><span class=\"m\">21</span>:35:46<span class=\"w\"> </span><span class=\"o\">[</span>ERROR<span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span>mdbook::utils<span class=\"o\">)</span>:<span class=\"w\"> </span>Error:<span class=\"w\"> </span>Chapter<span class=\"w\"> </span>file<span class=\"w\"> </span>not<span class=\"w\"> </span>found,<span class=\"w\"> </span>./README.md\n<span class=\"m\">2024</span>-03-20<span class=\"w\"> </span><span class=\"m\">21</span>:35:46<span class=\"w\"> </span><span class=\"o\">[</span>ERROR<span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span>mdbook::utils<span class=\"o\">)</span>:<span class=\"w\">    </span>Caused<span class=\"w\"> </span>By:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span><span class=\"o\">(</span>os<span class=\"w\"> </span>error<span class=\"w\"> </span><span class=\"m\">2</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>I did modify the links by hand to check what happens, but then I still don't get the same rendering as in the template. The highlighting, in particular, is not working for me <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 428012745,
        "sender_full_name": "Florent Schaffhauser",
        "timestamp": 1710967476
    },
    {
        "content": "<p>OK, sorry, I understood my mistake. And I managed to fix it by running successively:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>lake<span class=\"w\"> </span>exe<span class=\"w\"> </span>mdgen<span class=\"w\"> </span><span class=\"s2\">\"Src\"</span><span class=\"w\"> </span><span class=\"s2\">\"md\"</span>\nlake<span class=\"w\"> </span>exe<span class=\"w\"> </span>import_all<span class=\"w\"> </span><span class=\"s2\">\"Src\"</span>\nmdbook<span class=\"w\"> </span>build\nmdbook<span class=\"w\"> </span>serve<span class=\"w\"> </span>--open\n</code></pre></div>\n<p>But somehow, if I try <code>lake run build</code> instead, I get the message:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>could<span class=\"w\"> </span>not<span class=\"w\"> </span>execute<span class=\"w\"> </span>external<span class=\"w\"> </span>process<span class=\"w\"> </span><span class=\"s1\">'lake exe mdgen'</span>\n</code></pre></div>",
        "id": 428022749,
        "sender_full_name": "Florent Schaffhauser",
        "timestamp": 1710972185
    },
    {
        "content": "<p>I don’t know why “external process” error occurs. But I have seen the same error when running ‘lake run build’ in GitHub action. What’s your OS?</p>",
        "id": 428044661,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1710985992
    },
    {
        "content": "<p>macOS</p>",
        "id": 428068410,
        "sender_full_name": "Florent Schaffhauser",
        "timestamp": 1711005338
    },
    {
        "content": "<p>\"could not execute external process\" error may mean that elan in your environment is broken. Why don't you <code>elan self update</code>, delete the <code>.lake</code> directory and try again?</p>",
        "id": 428094764,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1711016310
    },
    {
        "content": "<p>Thanks for looking into this! I tried what you suggested and I now have <code>elan 3.1.1</code> but, even after removing the <code>.lake</code> directory, the problem persists <span aria-label=\"oh no\" class=\"emoji emoji-1f615\" role=\"img\" title=\"oh no\">:oh_no:</span></p>",
        "id": 428120025,
        "sender_full_name": "Florent Schaffhauser",
        "timestamp": 1711025217
    },
    {
        "content": "<p>However, if nobody else reports a similar issue, it may indeed be a problem with my installation, I just don't know what it is. In any case, I can still generate the html files from the template, I just have to input <code>lake exe mdgen \"Src\" \"md\"</code> manually.</p>",
        "id": 428120436,
        "sender_full_name": "Florent Schaffhauser",
        "timestamp": 1711025338
    },
    {
        "content": "<p>Hi <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span> </p>\n<p>Here is the same error that I get on my machine but reproduced on <em>Codespaces</em> and directly from the <a href=\"https://github.com/Seasawher/lean-book\">lean-book repo</a> after installing <code>elan</code> and <code>lean</code>:</p>\n<p><a href=\"/user_uploads/3121/wyr8dZEb7l6je0s1bZS544KX/Image-22-03-2024-at-15.04.jpeg\">Image-22-03-2024-at-15.04.jpeg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/wyr8dZEb7l6je0s1bZS544KX/Image-22-03-2024-at-15.04.jpeg\" title=\"Image-22-03-2024-at-15.04.jpeg\"><img src=\"/user_uploads/3121/wyr8dZEb7l6je0s1bZS544KX/Image-22-03-2024-at-15.04.jpeg\"></a></div><p>If I try to comment out the first line of the script in <a href=\"https://github.com/Seasawher/lean-book/blob/main/lakefile.lean\">lakefile.lean</a></p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">runCmd</span> <span class=\"o\">(</span><span class=\"n\">cmd</span> <span class=\"o\">:</span> <span class=\"n\">String</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">args</span> <span class=\"o\">:</span> <span class=\"n\">Array</span> <span class=\"n\">String</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">ScriptM</span> <span class=\"n\">Bool</span> <span class=\"o\">:=</span> <span class=\"k\">do</span>\n  <span class=\"k\">let</span> <span class=\"n\">out</span> <span class=\"bp\">←</span> <span class=\"n\">IO.Process.output</span> <span class=\"o\">{</span>\n    <span class=\"n\">cmd</span> <span class=\"o\">:=</span> <span class=\"n\">cmd</span>\n    <span class=\"n\">args</span> <span class=\"o\">:=</span> <span class=\"n\">args</span>\n  <span class=\"o\">}</span>\n  <span class=\"k\">let</span> <span class=\"n\">hasError</span> <span class=\"o\">:=</span> <span class=\"n\">out.exitCode</span> <span class=\"bp\">!=</span> <span class=\"mi\">0</span>\n  <span class=\"k\">if</span> <span class=\"n\">hasError</span> <span class=\"k\">then</span>\n    <span class=\"n\">IO.eprint</span> <span class=\"n\">out.stderr</span>\n  <span class=\"n\">return</span> <span class=\"n\">hasError</span>\n\n<span class=\"n\">script</span> <span class=\"n\">build</span> <span class=\"k\">do</span>\n<span class=\"c1\">--  if ← runCmd \"lake exe mdgen\" #[\"Src\", \"md\"] then return 1  -- I commented this line out</span>\n  <span class=\"k\">if</span> <span class=\"bp\">←</span> <span class=\"n\">runCmd</span> <span class=\"s2\">\"lake exe import_all\"</span> <span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"Src\"</span><span class=\"o\">]</span> <span class=\"k\">then</span> <span class=\"n\">return</span> <span class=\"mi\">1</span>\n  <span class=\"k\">if</span> <span class=\"bp\">←</span> <span class=\"n\">runCmd</span> <span class=\"s2\">\"mdbook build\"</span> <span class=\"bp\">#</span><span class=\"o\">[]</span> <span class=\"k\">then</span> <span class=\"n\">return</span> <span class=\"mi\">1</span>\n  <span class=\"n\">return</span> <span class=\"mi\">0</span>\n</code></pre></div>\n<p>then the error becomes</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>could<span class=\"w\"> </span>not<span class=\"w\"> </span>execute<span class=\"w\"> </span>external<span class=\"w\"> </span>process<span class=\"w\"> </span><span class=\"s1\">'lake exe import_all'</span>\n</code></pre></div>\n<p>so maybe the problem is related to the way the script is interpreted by the machine?</p>",
        "id": 428339308,
        "sender_full_name": "Florent Schaffhauser",
        "timestamp": 1711117040
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"626349\">@Asei Inoue</span> Are you on Windows? Putting arguments like <code>exe</code> in <code>cmd</code> is definitely wrong on Unix platforms</p>",
        "id": 428342686,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1711117947
    },
    {
        "content": "<p>Oooh, I see the issue now <span aria-label=\"face palm\" class=\"emoji emoji-1f926\" role=\"img\" title=\"face palm\">:face_palm:</span>  Here's a fix that works for me then:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>script<span class=\"w\"> </span>build<span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span>←<span class=\"w\"> </span>runCmd<span class=\"w\"> </span><span class=\"s2\">\"lake\"</span><span class=\"w\"> </span><span class=\"c1\">#[\"exe\", \"mdgen\", \"Src\", \"md\"] then return 1</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span>←<span class=\"w\"> </span>runCmd<span class=\"w\"> </span><span class=\"s2\">\"lake\"</span><span class=\"w\"> </span><span class=\"c1\">#[\"exe\", \"import_all\", \"Src\"] then return 1</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span>←<span class=\"w\"> </span>runCmd<span class=\"w\"> </span><span class=\"s2\">\"mdbook\"</span><span class=\"w\"> </span><span class=\"c1\">#[\"build\"] then return 1</span>\n<span class=\"w\">  </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"m\">0</span>\n</code></pre></div>",
        "id": 428377853,
        "sender_full_name": "Florent Schaffhauser",
        "timestamp": 1711128215
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span> Yes, I use Windows.</p>",
        "id": 428433143,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1711158928
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"513540\">@Flo (Florent Schaffhauser)</span> Thank you very much!</p>\n<p>I had not noticed this mistake for a long time ... Thanks for correcting it.</p>\n<p>I made the same mistake in the metaprogramming book. I have corrected it.</p>",
        "id": 428433233,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1711158998
    }
]