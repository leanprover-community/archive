[
    {
        "content": "<p>My go-to template for the three things I want to tell undergraduates about installing projects is the <code>README</code> from my IISc repo <a href=\"https://github.com/kbuzzard/IISc-experiments\">here</a>. I wrote notes to myself explaining how I set all this stuff up, and took screenshots which were specific to that project etc so it's going to be a pain updating them. But what I'm really worried about is whether those files are now out of date. </p>\n<p>1) Local installation.</p>\n<p>Right now my instructions say to use the command line. This is no good for my clients today (1st year maths undergrads). Is there yet a safe command-line-free path to installing everything needed to painlessly run a random Lean repo which depends on mathlib? I think there surely should be now is but where do I read about it? The <a href=\"https://leanprover-community.github.io/install/project.html#working-on-an-existing-project\">community page</a> tells me to use the command line, and the <a href=\"https://docs.lean-lang.org/lean4/doc/quickstart.html\">official instructions on the Lean website</a> doesn't mention projects which depend on mathlib. If I follow the Lean website instructions and click on upside-down-A-&gt;documentation-&gt;show setup guide and then \"Set up Lean 4 project\" and then \"Download an existing project\" and then I type <code>https://github.com/ImperialCollegeLondon/IUM/</code> into the box, hitting enter does nothing. Is this somehow the wrong format? It looks like the same format that mathlib and MIL are using. <code>git@github.com:ImperialCollegeLondon/IUM.git</code> doesn't work either. What am I doing wrong? I cannot figure out a command-line free path to getting the repo <a href=\"https://github.com/ImperialCollegeLondon/IUM/\">https://github.com/ImperialCollegeLondon/IUM/</a> running locally.</p>\n<p>2) Running remotely.</p>\n<p>The files which I seem to have to add to my project are <code>.gitpod.yml</code> and <code>.docker/gitpod/Dockerfile</code> (for gitpod) and <code>.devcontainer/devcontainer.json</code> and <code>.devcontainer/Dockerfile</code> (for codespaces), and I just tend to copy these files around, changing what needs to be changed. I'm a bit unhappy about this because I might not have the \"latest version\" and I don't really understand any of these files. Where is a safe place to get possibly updated versions of these files?</p>",
        "id": 474577370,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1727958221
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113488-general/topic/gitpod.2Fcodespaces.2Flocal.20installation.20for.20Lean.20repo/near/474577370\">said</a>:</p>\n<blockquote>\n<p>If I follow the Lean website instructions and click on upside-down-A-&gt;documentation-&gt;show setup guide and then \"Set up Lean 4 project\" and then \"Download an existing project\" and then I type <code>https://github.com/ImperialCollegeLondon/IUM/</code> into the box, hitting enter does nothing.</p>\n</blockquote>\n<p>It should open a file selection dialog that you can use to select the location of where the project should be downloaded to. It seems to work for me. Can anyone else confirm this issue?</p>",
        "id": 474582989,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1727959670
    },
    {
        "content": "<p>Did you select the \"Git repository URL\" entry?</p>",
        "id": 474583310,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1727959749
    },
    {
        "content": "<p>Worked beautifully for me, I have a new copy of IUM now.</p>",
        "id": 474585626,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1727960427
    },
    {
        "content": "<p>Actually there was one problem: while <code>lake</code> is cloning Mathlib, which takes quite a while, there is no visual feedback.</p>",
        "id": 474585686,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1727960450
    },
    {
        "content": "<p>i.e. <code>lake exe cache get</code> prints nothing for almost a minute while the clone happens.</p>",
        "id": 474585741,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1727960466
    },
    {
        "content": "<p>For Codespaces, I believe it is possible to add these files to a public index where they can be versioned and easily be added to a workspace using \"Dev Containers: Add Dev Container Configuration Files\": <a href=\"https://containers.dev/features\">https://containers.dev/features</a></p>",
        "id": 474585788,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1727960483
    },
    {
        "content": "<p>We need to fix that --- ideally <code>lake</code> could make a shallow clone?</p>",
        "id": 474585804,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1727960486
    },
    {
        "content": "<p>Otherwise perhaps it can special case cloning Mathlib and print something before it starts, so there is <em>some</em> indication that the user really should wait --- the cancel button becomes very tempting with no feedback.</p>",
        "id": 474585981,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1727960525
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110024\">Sebastian Ullrich</span> <a href=\"#narrow/stream/113488-general/topic/gitpod.2Fcodespaces.2Flocal.20installation.20for.20Lean.20repo/near/474585788\">said</a>:</p>\n<blockquote>\n<p>For Codespaces, I believe it is possible to add these files to a public index where they can be versioned and easily be added to a workspace using \"Dev Containers: Add Dev Container Configuration Files\": <a href=\"https://containers.dev/features\">https://containers.dev/features</a></p>\n</blockquote>\n<p>And Gitpod is working on supporting the same files as well: <a href=\"https://github.com/gitpod-io/gitpod/issues/7721#issuecomment-2187465251\">https://github.com/gitpod-io/gitpod/issues/7721#issuecomment-2187465251</a></p>",
        "id": 474586614,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1727960726
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/113488-general/topic/gitpod.2Fcodespaces.2Flocal.20installation.20for.20Lean.20repo/near/474585686\">said</a>:</p>\n<blockquote>\n<p>Actually there was one problem: while <code>lake</code> is cloning Mathlib, which takes quite a while, there is no visual feedback.</p>\n</blockquote>\n<p>Is there no progress bar in the bottom right?</p>",
        "id": 474587581,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1727961004
    },
    {
        "content": "<p>Ah, I see, you're referring to the initial part of <code>lake exe cache get</code> not yielding output for a long time? I.e. this part?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">mhuisi</span><span class=\"bp\">/</span><span class=\"n\">Lean</span><span class=\"bp\">/</span><span class=\"n\">MathlibTest</span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">batteries</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">batteries</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">batteries'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Qq</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">quote4</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Qq'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">aesop</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">aesop</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">aesop'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">proofwidgets</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">ProofWidgets4</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">proofwidgets'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">importGraph</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"kn\">import</span><span class=\"bp\">-</span><span class=\"n\">graph</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">importGraph'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LeanSearchClient</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">LeanSearchClient</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">LeanSearchClient'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cli</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">cli</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Cli'</span>\n</code></pre></div>",
        "id": 474588681,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1727961362
    },
    {
        "content": "<p>Oops, I missed that this comment was about IUM, not Mathlib, sorry. Yes, that indeed shows no progress for a while.</p>",
        "id": 474589409,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1727961594
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113488-general/topic/gitpod.2Fcodespaces.2Flocal.20installation.20for.20Lean.20repo/near/474577370\">said</a>:</p>\n<blockquote>\n<p>The files which I seem to have to add to my project are <code>.gitpod.yml</code> and <code>.docker/gitpod/Dockerfile</code> (for gitpod) and <code>.devcontainer/devcontainer.json</code> and <code>.devcontainer/Dockerfile</code> (for codespaces), and I just tend to copy these files around, changing what needs to be changed.</p>\n</blockquote>\n<p>I have a solution to the middle file: Make your <code>.gitpod.yml</code> file be</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"w\"> </span><span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">when</span><span class=\"w\"> </span><span class=\"n\">starting</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">Gitpod</span><span class=\"w\"> </span><span class=\"n\">workspace</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">repository</span>\n\n<span class=\"n\">image</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">leanprovercommunity</span><span class=\"bp\">/</span><span class=\"n\">gitpod4</span>\n\n<span class=\"n\">vscode</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">extensions</span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">.</span><span class=\"n\">lean4</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"w\"> </span><span class=\"n\">install</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"n\">VS</span><span class=\"w\"> </span><span class=\"n\">Code</span><span class=\"w\"> </span><span class=\"n\">extension</span>\n\n<span class=\"n\">tasks</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">|</span>\n<span class=\"w\">      </span><span class=\"n\">elan</span><span class=\"w\"> </span><span class=\"n\">self</span><span class=\"w\"> </span><span class=\"n\">update</span>\n<span class=\"w\">      </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get</span>\n</code></pre></div>",
        "id": 474607295,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1727966420
    },
    {
        "content": "<p><code>leanprovercommunity/gitpod4</code> is the name of one the community-curated docker images hosted on dockerhub (and I am the one maintaining those image up to date), precisely the one meant to be used in gitpod with Lean 4. That image plays the same role as your <code>.docker/gitpod/Dockerfile</code>, except that it's hosted online.</p>",
        "id": 474607766,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1727966553
    },
    {
        "content": "<p>The default gitpod file is not tied to any specific version of mathlib</p>",
        "id": 474616143,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727968186
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113488-general/topic/gitpod.2Fcodespaces.2Flocal.20installation.20for.20Lean.20repo/near/474577370\">said</a>:</p>\n<blockquote>\n<p>I'm a bit unhappy about this because I might not have the \"latest version\"</p>\n</blockquote>\n<p>Depending your goal, this may be a good thing. Having the latest version in a git repo where everything else is fixed can lead to things no longer working in the long run.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"466334\">Shreyas Srinivas</span> <a href=\"#narrow/stream/113488-general/topic/gitpod.2Fcodespaces.2Flocal.20installation.20for.20Lean.20repo/near/474616143\">said</a>:</p>\n<blockquote>\n<p>The default gitpod file is not tied to any specific version of mathlib</p>\n</blockquote>\n<p>This is true for now, but may not remain true forever. For instance, I believe the current container includes a partial python installation to enable <code>polyrith</code>. If a future version of mathlib implements polyrith from scratch, then this dependency might end up dropped from the container (using every dependency that mathlib ever once had is messy and hard to enforce).</p>",
        "id": 474624331,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1727970604
    },
    {
        "content": "<p>I think the point re: \"latest version\" is more that there should be a place that hosts templates/documentation, which are kept up to date and you can follow/copy when creating a new project</p>",
        "id": 474633971,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1727972793
    },
    {
        "content": "<p>I want to suggest adding some template repos in the community repository (ideally organised under one project or something similar). Example:  tagged math project template where each git tag is pinned to a corresponding  toolchain and whose gitpod and devcontainer files use a local docker image working with that toolchain version</p>",
        "id": 474691347,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727994759
    },
    {
        "content": "<p>A similar idea came up on the coq zulip a few weeks ago</p>",
        "id": 474691390,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727994785
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/stream/113488-general/topic/gitpod.2Fcodespaces.2Flocal.20installation.20for.20Lean.20repo/near/474589409\">said</a>:</p>\n<blockquote>\n<p>Oops, I missed that this comment was about IUM, not Mathlib, sorry. Yes, that indeed shows no progress for a while.</p>\n</blockquote>\n<p>I created an issue to track this at <a href=\"https://github.com/leanprover/lean4/pull/5615\">lean#5615</a>.</p>",
        "id": 474705908,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1728004262
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/113488-general/topic/gitpod.2Fcodespaces.2Flocal.20installation.20for.20Lean.20repo/near/474585626\">said</a>:</p>\n<blockquote>\n<p>Worked beautifully for me, I have a new copy of IUM now.</p>\n</blockquote>\n<p>Thanks a lot Kim for taking the time -- this is clear evidence that the problem is at my end. Sounds like I might be doing something bone-headed.</p>\n<p>Right now I'm opening VS Code in an empty directory, hitting ctrl-N to make a new file (this making the upside-down A appear), then upside-down A -&gt; open project -&gt; download project -&gt; type <code>https://github.com/ImperialCollegeLondon/IUM/</code> into the text box that appears -&gt; now I'm stuck.</p>\n<p><a href=\"/user_uploads/3121/smGY09cYDHKgjga6r6RzusZU/stuck.png\">stuck.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/smGY09cYDHKgjga6r6RzusZU/stuck.png\" title=\"stuck.png\"><img data-original-dimensions=\"1920x1080\" src=\"/user_uploads/thumbnail/3121/smGY09cYDHKgjga6r6RzusZU/stuck.png/840x560.webp\"></a></div><p>Enter/return/whatever that key is called nowadays does nothing, and the box is greyed out as if to indicate \"you didn't put something I recognise in that box yet\".</p>",
        "id": 474783261,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1728034959
    },
    {
        "content": "<p>Indeed, typing in <code>https://github.com/leanprover-community/mathlib/</code> manually into that box gives me the same result (no ability to progress). Selecting mathlib from the dropdown tool (rather than typing in the URL manually)  works fine, I get a popup window asking me where I want to download the repo and then, as I think has been pointed out already, I get a very long pause where it's not at all clear that anything is happening, but things are happening. This is on Ubuntu 20.04, I could update if necessary, my instinct with older laptops is \"don't upgrade OS unless necessary\" but this is based on experiences from 20 years ago where I've hugely degraded performance by upgrading.</p>",
        "id": 474784170,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1728035285
    },
    {
        "content": "<p>The trick is to click on \"Git repository URL\" while the text box is empty and <em>then</em> paste in the URL and then hit the Enter key. This is indeed confusing, I'll open an issue to make it less confusing.</p>",
        "id": 474784731,
        "sender_full_name": "Markus Himmel",
        "timestamp": 1728035505
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/vscode-lean4/issues/530\">https://github.com/leanprover/vscode-lean4/issues/530</a></p>",
        "id": 474786147,
        "sender_full_name": "Markus Himmel",
        "timestamp": 1728036013
    },
    {
        "content": "<p>Indeed this was exactly my error: I was just dumping the URL straight into the text box. Sorry for the noise and thanks!</p>",
        "id": 474786661,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1728036190
    }
]