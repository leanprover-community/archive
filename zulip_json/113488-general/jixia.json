[
    {
        "content": "<p>This is a thread to discuss jixia. See the <a href=\"#narrow/stream/113486-announce/topic/Announcing.20jixia.2C.20a.20static.20analysis.20tool\">announcement</a>.</p>",
        "id": 448297160,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1719831802
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"652127\">@Tony Beta Lambda</span> can this tool be used to visualize a dependency graph of a given declaration?</p>",
        "id": 448297286,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1719831832
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/stream/113488-general/topic/jixia/near/448297286\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"652127\">Tony Beta Lambda</span> can this tool be used to visualize a dependency graph of a given declaration?</p>\n</blockquote>\n<p>It can generate all the data needed for such visualization.  For the actual visualization I recommend <a href=\"https://github.com/patrik-cihal/lean-graph\">lean-graph</a>.</p>",
        "id": 448376360,
        "sender_full_name": "Tony Beta Lambda",
        "timestamp": 1719850332
    },
    {
        "content": "<p>Hmm, that might be an interesting use case for distinguishing theorems from lemmas</p>",
        "id": 448381716,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1719851547
    },
    {
        "content": "<p>I am still looking for something that makes easy to find <em>unused</em> declaration in a project (wrt to a final goal). Maybe this can help...</p>",
        "id": 448611759,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1719928299
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"492774\">@Sky Wilshaw</span> has written that something</p>",
        "id": 448651034,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1719937669
    },
    {
        "content": "<p>I wrote some stuff here: <a href=\"https://github.com/leanprover-community/con-nf/blob/main/DependencyGraph.lean\">https://github.com/leanprover-community/con-nf/blob/main/DependencyGraph.lean</a></p>",
        "id": 448651471,
        "sender_full_name": "Sky Wilshaw",
        "timestamp": 1719937780
    },
    {
        "content": "<p>I didn't intend for this to be used outside of the Con(NF) project so some tweaking will need to be done before it's usable</p>",
        "id": 448651615,
        "sender_full_name": "Sky Wilshaw",
        "timestamp": 1719937807
    },
    {
        "content": "<p>Thanks!! I am having a look</p>",
        "id": 448655409,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1719939093
    },
    {
        "content": "<p>Can you explain (briefly) how to use it?</p>",
        "id": 448659358,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1719940169
    },
    {
        "content": "<p>The way it currently works is that if you replace <code>import ConNF</code> with <code>import &lt;your_project&gt;</code> and write <code>#unseen</code> at the end of the file, it'll do all the calculations and tell you what's not currently used.</p>",
        "id": 448659638,
        "sender_full_name": "Sky Wilshaw",
        "timestamp": 1719940223
    },
    {
        "content": "<p>This isn't ideal, but works enough for my purposes - I have a CI step that manually appends <code>#unseen</code> to that file and reads off its output.</p>",
        "id": 448659700,
        "sender_full_name": "Sky Wilshaw",
        "timestamp": 1719940247
    },
    {
        "content": "<p>It's not written in there by default because computing unseen defs takes quite a long time, so I didn't want to have it run unless it really needs to.</p>",
        "id": 448659775,
        "sender_full_name": "Sky Wilshaw",
        "timestamp": 1719940269
    },
    {
        "content": "<p>I guess I have to replace <code>ConNF</code> with the name of my project everywhere in the script, right?</p>",
        "id": 448660149,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1719940368
    },
    {
        "content": "<p>I think so, yes.</p>",
        "id": 448660177,
        "sender_full_name": "Sky Wilshaw",
        "timestamp": 1719940379
    },
    {
        "content": "<p>It seems it works, thanks a lot!!</p>",
        "id": 448665753,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1719942010
    },
    {
        "content": "<p>I am not an expert but I am sure this is something can be useful for a lot of people.</p>",
        "id": 448665899,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1719942064
    },
    {
        "content": "<p>Are you interested in improving it? For example I think it lists declarations generated by <code>simps</code>, that cannot be removed. Note that I am not complaining (quite the opposite!), but if you or someone else is interested we can make it an \"official\" mathlib script.</p>",
        "id": 448668326,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1719942746
    },
    {
        "content": "<p>I don't think I know enough yet about Lean meta stuff to do a good job of cleaning this up and making it more generally usable - I just haven't really had the time to learn it properly. In the meantime, if anyone else with more knowledge is interested, feel free to give it a shot.</p>",
        "id": 448668747,
        "sender_full_name": "Sky Wilshaw",
        "timestamp": 1719942866
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span>, <span class=\"user-mention\" data-user-id=\"492774\">@Sky Wilshaw</span>, it would be lovely if this functionality could be added to the existing <a href=\"https://github.com/leanprover-community/import-graph\"><code>import-graph</code></a> repository, which Mathlib already depends on.</p>",
        "id": 448714843,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1719959664
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/stream/113488-general/topic/jixia/near/448611759\">said</a>:</p>\n<blockquote>\n<p>I am still looking for something that makes easy to find <em>unused</em> declaration in a project (wrt to a final goal). Maybe this can help...</p>\n</blockquote>\n<p>Yes, it is possible with the data provided by jixia.  The dependency relation is computed per \"symbol\", which can be linked to \"declaration\" by the equation <code>symbol.name == declaration.fullname</code>.</p>\n<ol>\n<li>Find your declaration's <code>fullname</code>.</li>\n<li>Compute its transitive dependencies with data in .sym.json files.</li>\n<li>Find all relevant declarations.</li>\n</ol>\n<p>We are limiting the scope of jixia to extracting info from a lean project for interoperability with other tools, so this won't be part of jixia.  But we are planning to write a set of useful scripts (most likely in python) to work with data generated by jixia, and this can be one of them.</p>",
        "id": 450349637,
        "sender_full_name": "Tony Beta Lambda",
        "timestamp": 1720590338
    }
]