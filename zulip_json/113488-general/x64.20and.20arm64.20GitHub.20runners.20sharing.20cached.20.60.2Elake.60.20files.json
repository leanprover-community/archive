[
    {
        "content": "<p>Is it correct that x64 and arm64 systems cannot share cached <code>.lake</code> files?</p>\n<p>For context, currently <code>lean-action</code> uses this cache key: <code>lake-${{ runner.os }}-${{ hashFiles('lean-toolchain') }}-${{ hashFiles('lake-manifest.json') }}-${{ github.sha }}</code></p>\n<p>With the current cache key an ubuntu runner will never use the cache from a macos runner. However an x64 ubuntu runner could potentially use a cache from an arm64 ubuntu runner. <a href=\"https://github.com/leanprover/lean-action/issues/116\">This is potentially leading to problems.</a></p>\n<p>My thought was to modify the <code>lean-action</code> key to also include the <code>{{ runner.arch }}</code> context variable so that runners with different architectures do not share cache entries.</p>",
        "id": 500241397,
        "sender_full_name": "Austin Letson",
        "timestamp": 1739811657
    },
    {
        "content": "<p>Yes, I don't think these can be shared across platforms</p>",
        "id": 500241511,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1739811695
    },
    {
        "content": "<p>Especially if one is a GMP-enabled platform and the other is not</p>",
        "id": 500241547,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1739811705
    },
    {
        "content": "<p>Though what you _can_ cache is the output of <code>lake exe cache pack</code>, which is platform independent</p>",
        "id": 500241676,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1739811733
    },
    {
        "content": "<p>Okay, thanks for the confirmation.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/113488-general/topic/x64.20and.20arm64.20GitHub.20runners.20sharing.20cached.20.60.2Elake.60.20files/near/500241676\">said</a>:</p>\n<blockquote>\n<p>Though what you _can_ cache is the output of <code>lake exe cache pack</code>, which is platform independent</p>\n</blockquote>\n<p>Interesting. I may look into if we could leverage this.</p>",
        "id": 500243379,
        "sender_full_name": "Austin Letson",
        "timestamp": 1739812222
    }
]