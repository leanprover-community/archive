[
    {
        "content": "<p>Hi all, in VSCode, is there a way to _always_ \"Restart Lean server for file\" in open editor tabs when their dependencies change? Sometimes I'm working on one file <code>Foo.lean</code> with a library function/tactic and another <code>Bar.lean</code> that calls that function/tactic. It'd be nice if I could have a mode where I didn't need to manually open <code>Bar.lean</code> and run the \"Restart Lean server for file\" action to see if my change in <code>Foo</code> actually had the intended effect.</p>\n<p>This has been a frustration for me for a while, but it's especially annoying for me now that I'm playing around with using an AI agent to edit code — the agent often reads LSP output from a file I haven't reloaded in a while and concludes that a change it made didn't work, even though the issue is really just that the file needs to be reloaded.</p>",
        "id": 548141981,
        "sender_full_name": "Harry Goldstein",
        "timestamp": 1761913040
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"686704\">@Harry Goldstein</span> , could you please open an issue against the vscode extension repository asking for this feature?</p>",
        "id": 560276761,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1764117518
    },
    {
        "content": "<p>By the way is there currently a setting to prevent Lean from automatically starting when I open the editor (VSCode)? I have 8 windows of Lean repos in VSCode and every time I open VSCode I need to manually kill all lean processes in Task Manager, otherwise they'll eat up too much resource.</p>",
        "id": 560387917,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1764163067
    },
    {
        "content": "<p>When I open VSCode I have to wait for Lean to start before I can kill it to prevent it from messing with <code>lake exe cache get</code>, so the option to not have it start automatically would be useful</p>",
        "id": 560388375,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1764163198
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> Yes, happy to open an issue on the VSCode extension. I’m guessing the other question here about the lean server should also be a separate issue there?</p>",
        "id": 560389634,
        "sender_full_name": "Harry Goldstein",
        "timestamp": 1764163571
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113488-general/topic/Mode.20for.20automatically.20updating.20downstream.20files.3F/near/560388375\">said</a>:</p>\n<blockquote>\n<p>When I open VSCode I have to wait for Lean to start before I can kill it to prevent it from messing with <code>lake exe cache get</code>, so the option to not have it start automatically would be useful</p>\n</blockquote>\n<p>Yes, if I run <code>lake exe cache get</code> (or <code>unpack</code>) on Windows without stopping the server I frequently get messages like these:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>...\nC:\\Users\\xujys\\.cache\\mathlib\\00c02fda1f066809.ltar: The requested operation cannot be performed on a file with a user-mapped section open. (os error 1224)\nC:\\Users\\xujys\\.cache\\mathlib\\4cb013cffafd46a7.ltar: The requested operation cannot be performed on a file with a user-mapped section open. (os error 1224)\nC:\\Users\\xujys\\.cache\\mathlib\\9b446276c801ca6a.ltar: The requested operation cannot be performed on a file with a user-mapped section open. (os error 1224)\nuncaught exception: leantar failed with error code 1\n</code></pre></div>\n<p>and it's a waste of time to stop and restart the server manually. I guess this is something to report to the lean4 repo, since <code>lake</code> is a part of it.</p>",
        "id": 560390793,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1764163915
    },
    {
        "content": "<p>It's now also very easy to randomly trigger these pop-ups in VSCode (not sure which key combination triggers it):<br>\n<a href=\"/user_uploads/3121/UEUIv_a1ciTLvH0PfBkTdlU8/image.png\">image.png</a><br>\nThis should be handled by <code>lake</code> so why is it necessary to spam the user like this? It's not like I can randomly update Lean version when working on mathlib.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/UEUIv_a1ciTLvH0PfBkTdlU8/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"696x227\" src=\"/user_uploads/thumbnail/3121/UEUIv_a1ciTLvH0PfBkTdlU8/image.png/840x560.webp\"></a></div><p>Sorry for hijacking the topic, just found this a good opportunity to summarize some recently encountered issues.</p>",
        "id": 560400550,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1764166436
    },
    {
        "content": "<p>Couldn't you fix this by just pinning your Lean version to a particular Lean release, rather than <code>stable</code>? It seems reasonable that Lean might update its notion of \"stable\" before a compatible version of Mathlib is released.</p>",
        "id": 560417479,
        "sender_full_name": "Harry Goldstein",
        "timestamp": 1764170661
    }
]