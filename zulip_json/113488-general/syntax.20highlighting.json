[
    {
        "content": "<p>William Stein says:</p>\n<p>\"Kevin - which of the modes listed here is closest to working for lean code?</p>\n<p><a href=\"https://codemirror.net/mode/index.html\" target=\"_blank\" title=\"https://codemirror.net/mode/index.html\">https://codemirror.net/mode/index.html</a></p>\n<p>I can modify an existing syntax highlighting mode to make it work properly...\"</p>",
        "id": 128609810,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1529944957
    },
    {
        "content": "<p>More details from someone else at cocalc:</p>",
        "id": 128610110,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1529945303
    },
    {
        "content": "<p>\"Regarding code editor syntax highlighting, I haven't found a good highlighting. Maybe we can create one for codemirror, though. Is there a simple language definition, where we for example can get a concise list of all keywords? I also checked what they are doing for that online live \"lean\" editor. This interface is based on the \"monaco\" editor [1]. They seem to have written their own plugins for it. CoCalc doesn't use Monco, but CodeMirror, though.\"</p>",
        "id": 128610116,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1529945314
    },
    {
        "content": "<p>I know that this is four years old, but I was hoping that we could revisit this topic. There are several applications that use CodeMirror for syntax highlighting. We already have syntax highlighting files for VS Code and NVIM. It should be fairly straightforward to configure a CodeMirror syntax highlighting file. It's essentially just a rewrite of the NVIM syntax highlighting configuration into JavaScript. Has this been revisited in the last four years?</p>",
        "id": 313322132,
        "sender_full_name": "Ian Riley",
        "timestamp": 1669912958
    },
    {
        "content": "<p>A word of warning about codemirror from another topic:</p>\n<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/113488-general/topic/.E2.9C.94.20VSCode.20puts.20error.20lines.20in.20the.20wrong.20place/near/282852819\">said</a>:</p>\n<blockquote>\n<p>Apparently its editor, CodeMirror, doesn't handle things that use two UTF-16 code units</p>\n</blockquote>\n<p>So some lean files contain characters that CodeMirror doesn't support</p>",
        "id": 313330053,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1669914993
    },
    {
        "content": "<p>That's good to know. So my interest in CM is actually because of this <a href=\"https://github.com/deathau/cm-editor-syntax-highlight-obsidian\">https://github.com/deathau/cm-editor-syntax-highlight-obsidian</a> I'd like to start putting Lean code into my Obsidian notes. I have an active PR atm to add lean support to the execute code plugin so that lean snippets can be executed in Obsidian MD but they don't have syntax highlighting without CM support.</p>",
        "id": 313423447,
        "sender_full_name": "Ian Riley",
        "timestamp": 1669954136
    },
    {
        "content": "<p>On both github and in VS Code I'm getting funny syntax highlighting with this piece of code from a PR I'm reviewing:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">deprecated</span><span class=\"w\"> </span><span class=\"s2\">\"Use `[Semiring α] [LinearOrder α] [IsStrictOrderedRing α]` instead.\"</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">since</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"2025-01-05\"</span><span class=\"o\">)</span><span class=\"kd\">]</span>\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">LinearOrderedSemiring</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">StrictOrderedSemiring</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span>\n<span class=\"w\">  </span><span class=\"n\">LinearOrderedAddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">α</span>\n</code></pre></div>",
        "id": 511231579,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744220466
    },
    {
        "content": "<p>Oh, it seems to have worked fine in Zulip; here are the screenshots for what I'm seeing in github and VS Code:</p>\n<p><a href=\"/user_uploads/3121/_k94oB0djY6T2F5Sr05ElAFo/Screenshot-2025-04-09-at-18.42.09.png\">Screenshot 2025-04-09 at 18.42.09.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/_k94oB0djY6T2F5Sr05ElAFo/Screenshot-2025-04-09-at-18.42.09.png\" title=\"Screenshot 2025-04-09 at 18.42.09.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"2344x422\" src=\"/user_uploads/thumbnail/3121/_k94oB0djY6T2F5Sr05ElAFo/Screenshot-2025-04-09-at-18.42.09.png/840x560.webp\"></a></div><p><a href=\"/user_uploads/3121/EPJLyrOGzIXx3eCKABlQ78UK/Screenshot-2025-04-09-at-18.42.33.png\">Screenshot 2025-04-09 at 18.42.33.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/EPJLyrOGzIXx3eCKABlQ78UK/Screenshot-2025-04-09-at-18.42.33.png\" title=\"Screenshot 2025-04-09 at 18.42.33.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"2344x422\" src=\"/user_uploads/thumbnail/3121/EPJLyrOGzIXx3eCKABlQ78UK/Screenshot-2025-04-09-at-18.42.33.png/840x560.webp\"></a></div>",
        "id": 511231848,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744220565
    },
    {
        "content": "<p>(Semiring is a different colour to LinearOrder)</p>",
        "id": 511231928,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744220595
    },
    {
        "content": "<p>Zulip uses the pygments highlighter, github and vscode use the textmate highlighter (and so the behavior is expected to not always be the same)</p>",
        "id": 511232283,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744220719
    },
    {
        "content": "<p>It's possible github is using the lean 3 textmate highlighter; in theory <a href=\"https://github.com/github-linguist/linguist/pull/6616/files#diff-c2d2d7946540ab501a5ef7a7f54a57c530d8da599e41c2beb0fd2f5635d2fd50R393-R396\">these lines</a> are supposed to stop it, but maybe github doesn't use them.</p>",
        "id": 511232365,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744220749
    },
    {
        "content": "<p>I'm happy to accept PRs to improve the vscode-lean4 TextMate grammar, but I hope that we can just replace it with a Tree-sitter grammar in the future that isn't horrible to maintain. <br>\nThe VS Code team has recently started working on the <a href=\"https://github.com/microsoft/vscode/issues/210475\">implementation of tree-sitter</a> again, and it is <a href=\"https://github.com/microsoft/vscode/pull/246183\">being evaluated</a> in several of the built-in VS Code extensions at the moment.</p>",
        "id": 511360166,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1744277767
    },
    {
        "content": "<p>Are you working on a Tree-sitter grammar?</p>",
        "id": 511362373,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1744278429
    },
    {
        "content": "<p>No, but I probably will be once VS Code supports it :-)</p>",
        "id": 511362479,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1744278468
    },
    {
        "content": "<p>Does github support tree-sitter grammars?</p>",
        "id": 511366692,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744279741
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/113488-general/topic/syntax.20highlighting/near/511366692\">said</a>:</p>\n<blockquote>\n<p>Does github support tree-sitter grammars?</p>\n</blockquote>\n<p><a href=\"https://github.com/github-linguist/linguist/blob/main/vendor/README.md\">https://github.com/github-linguist/linguist/blob/main/vendor/README.md</a></p>",
        "id": 511375061,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1744282688
    }
]