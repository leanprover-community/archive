[
    {
        "content": "<p>The following type definition gives me a universe error (<a href=\"https://live.lean-lang.org/#codez=JYOwJgrgxgLsBuBTABAMQPboFzIDLAGcZkAVATwAcUBaAPlMpQHcALRAJ0QCgAfZAQRwZ0yANoBdXsgBCACgDKOfEQZUAlEMzJ5XLqEiwEKYYCCCJYWLkqyOquZtOUuYrwW7GtJhPauQA\">see in editor</a>)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"o\">[]</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"n\">S</span>\n</code></pre></div>\n<p>Why is this a problem? Is it that the constructor <code>B</code> has type <code>(s:List Type) -&gt; Foo S</code> and <code>List Type</code> is a <code>Type</code>, same with <code>Foo S</code>,  so <code>B</code> has type <code>Type 1</code> and this prevents it from being defined in <code>Foo</code>? </p>\n<p>More generally, I have trouble reasoning about universes. Any recommendations on resources on the topic, beyond the <a href=\"https://lean-lang.org/functional_programming_in_lean/functor-applicative-monad/universes.html\">Functional Programming in Lean</a> chapter, which I've already read and will read again</p>",
        "id": 490515644,
        "sender_full_name": "Ayhon",
        "timestamp": 1734959111
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"o\">[]</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"n\">S</span>\n</code></pre></div>\n<p>is fine</p>",
        "id": 490516003,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1734959233
    },
    {
        "content": "<p>Huh... Ok, let me try to incorporate it into my actualy code and see if that fixes it. I swear I tried that before</p>",
        "id": 490516080,
        "sender_full_name": "Ayhon",
        "timestamp": 1734959282
    },
    {
        "content": "<p>For now, this is closer to what I'm actually trying to model. It still doesn't work.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">Eff</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">inM</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"w\">  </span><span class=\"n\">outM</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n\n<span class=\"c1\">-- EDITED: inductive P(A: Type): List ArrowEffect -&gt; (Type 1) where</span>\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Eff</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">[]</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Bar</span><span class=\"o\">{</span><span class=\"n\">E</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Eff</span><span class=\"o\">}{</span><span class=\"n\">S</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Eff</span><span class=\"o\">}{</span><span class=\"n\">B</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">input</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">inM</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">cont</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">outM</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">S</span>\n</code></pre></div>",
        "id": 490516924,
        "sender_full_name": "Ayhon",
        "timestamp": 1734959601
    },
    {
        "content": "<p>What is <code>ArrowEffect</code> there?</p>",
        "id": 490517219,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1734959724
    },
    {
        "content": "<p>Sorry, that's supposed to be <code>Eff</code>. Let me see if that fixes it</p>",
        "id": 490517272,
        "sender_full_name": "Ayhon",
        "timestamp": 1734959742
    },
    {
        "content": "<p>Different error, so progress, but still have an error<br>\n<code>(kernel) arg #6 of 'P.Bar' contains a non valid occurrence of the datatypes being declared</code><br>\n<a href=\"https://live.lean-lang.org/#codez=MYGwhgzhAECiBm9oHcAWBTATugUNaAlgHYCyAXPgCoCeADutALQB80N9e0A9gK4Au5NnQYshHHMQAmPYHwIA3BgAUAFAEEK7dAEoKAGQIQ+cRE1Yqt0AIzaUGbDgA+0AGJcuKsBTW7oS6GrQANoAuk7QAEJgmADesBQI8AC+MQDK+obGiSkRmsJJnCrEtPwJAHTEJAHahcBcRHzlvAIBZn6R0Kk1+BT+galAA\">See code</a></p>",
        "id": 490517398,
        "sender_full_name": "Ayhon",
        "timestamp": 1734959782
    },
    {
        "content": "<p>the issue is that you're not allowed to change <code>A</code> in this inductive, since it's to the left of the colon. you do change it, however, when you write <code>P B S</code> in the type of the <code>cont</code> argument</p>",
        "id": 490517748,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1734959920
    },
    {
        "content": "<p>this is an example fix:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Eff</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">[]</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Bar</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Eff</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Eff</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">B</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">input</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">inM</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cont</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">outM</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">S</span>\n</code></pre></div>",
        "id": 490517825,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1734959959
    },
    {
        "content": "<p>I see thanks! I never would have thought that the <code>P B S</code> was the issue. Why does this restriction exist? What property does it compromise?</p>",
        "id": 490518048,
        "sender_full_name": "Ayhon",
        "timestamp": 1734960041
    }
]