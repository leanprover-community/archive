[
    {
        "content": "<p>Hi, I'm using <code>leanprover/lean-action@v1</code> in my project. Currently it only checks the files that are imported in the main project file. I wanted to ask if it is possible to get it to check all Lean files in the repository instead of only those?<br>\nAnd in case that is not possible, is it at least possible to make it check that all lean files are imported in the main file (as it happens in Mathlib)?</p>",
        "id": 569599837,
        "sender_full_name": "Iván Renison",
        "timestamp": 1769120729
    },
    {
        "content": "<p>Have you seen the <code>mk_all-check</code> input? Not sure if this is what you mean.</p>",
        "id": 569601024,
        "sender_full_name": "Chris Henson",
        "timestamp": 1769121210
    },
    {
        "content": "<p>IIUC, this is something you need to set up properly in your lakefile. If you have a <code>lean_lib Foo</code> you can add globs that will become part of the library. The default behavior is that <code>lean_lib Foo</code> means that <code>Foo.lean</code> in the same directory is the entrypoint for the library. You will also need to set up default targets so that the libraries you want to build are built when you call <code>lake build</code>. It would be easier to help if you post your lakefile here.</p>\n<p>Edit: I didn't know about <code>mk_all-check</code>. Curious to see if that works!</p>",
        "id": 569601113,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1769121240
    },
    {
        "content": "<p>I didn't see <code>mk_all-check</code> before, sorry, it helps, thank you</p>",
        "id": 569601646,
        "sender_full_name": "Iván Renison",
        "timestamp": 1769121491
    },
    {
        "content": "<p>I have the default lakefile:</p>\n<div class=\"codehilite\" data-code-language=\"TOML\"><pre><span></span><code><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"LeanOJProblems\"</span>\n<span class=\"n\">version</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"0.1.0\"</span>\n<span class=\"n\">keywords</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s2\">\"math\"</span><span class=\"p\">]</span>\n<span class=\"n\">defaultTargets</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s2\">\"LeanOJProblems\"</span><span class=\"p\">]</span>\n\n<span class=\"k\">[leanOptions]</span>\n<span class=\"n\">pp</span><span class=\"p\">.</span><span class=\"n\">unicode</span><span class=\"p\">.</span><span class=\"n\">fun</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span><span class=\"w\"> </span><span class=\"c1\"># pretty-prints `fun a ↦ b`</span>\n<span class=\"n\">relaxedAutoImplicit</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">false</span>\n<span class=\"n\">weak</span><span class=\"p\">.</span><span class=\"n\">linter</span><span class=\"p\">.</span><span class=\"n\">mathlibStandardSet</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"n\">maxSynthPendingDepth</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">3</span>\n\n<span class=\"k\">[[require]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"mathlib\"</span>\n<span class=\"n\">scope</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"leanprover-community\"</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"v4.26.0\"</span>\n\n<span class=\"k\">[[lean_lib]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"LeanOJProblems\"</span>\n</code></pre></div>",
        "id": 569601650,
        "sender_full_name": "Iván Renison",
        "timestamp": 1769121493
    },
    {
        "content": "<p>Can I make the defaultTargets to be all files? (with out listing each file)</p>",
        "id": 569601752,
        "sender_full_name": "Iván Renison",
        "timestamp": 1769121536
    },
    {
        "content": "<p>Add globs to the <code>lean_lib</code>. I assume all your files are inside the LeanOJProblems directory?</p>",
        "id": 569601801,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1769121559
    },
    {
        "content": "<p>IIRC, this is the syntax:</p>\n<div class=\"codehilite\" data-code-language=\"YAML\"><pre><span></span><code><span class=\"p p-Indicator\">[[</span><span class=\"nv\">lean_lib</span><span class=\"p p-Indicator\">]]</span>\n<span class=\"l l-Scalar l-Scalar-Plain\">name = \"LeanOJProblems\"</span>\n<span class=\"l l-Scalar l-Scalar-Plain\">globs = [\"LeanOJProblems.*\"]</span>\n</code></pre></div>",
        "id": 569601980,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1769121653
    },
    {
        "content": "<p>Yes, I my files are in the LeanOJProblems, I will try the globs thing</p>",
        "id": 569602108,
        "sender_full_name": "Iván Renison",
        "timestamp": 1769121725
    },
    {
        "content": "<p>Is there documentation about the lakefile somewhere? I'm not able to find it</p>",
        "id": 569602141,
        "sender_full_name": "Iván Renison",
        "timestamp": 1769121747
    },
    {
        "content": "<p>I usually add the glob and also to be explicit have the action run <code>lake exe mk_all --check</code> (enabled by the input I mentioned above)</p>",
        "id": 569602163,
        "sender_full_name": "Chris Henson",
        "timestamp": 1769121764
    },
    {
        "content": "<p><a href=\"https://lean-lang.org/doc/reference/latest/Build-Tools-and-Distribution/Lake/\">https://lean-lang.org/doc/reference/latest/Build-Tools-and-Distribution/Lake/</a></p>",
        "id": 569602269,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1769121824
    },
    {
        "content": "<p>The globs option worked. Thank you very much!</p>",
        "id": 569602432,
        "sender_full_name": "Iván Renison",
        "timestamp": 1769121908
    }
]