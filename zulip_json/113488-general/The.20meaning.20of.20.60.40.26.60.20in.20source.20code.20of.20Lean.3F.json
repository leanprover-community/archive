[
    {
        "content": "<p>In <code>./src/Lean/Environment.lean</code>, we have:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/--</span>\n<span class=\"sd\">  Evaluate the given declaration under the given environment to a value of the given type.</span>\n<span class=\"sd\">  This function is only safe to use if the type matches the declaration's type in the environment</span>\n<span class=\"sd\">  and if `enableInitializersExecution` has been used before importing any modules. -/</span>\n<span class=\"kd\">@[</span><span class=\"n\">extern</span><span class=\"w\"> </span><span class=\"s2\">\"lean_eval_const\"</span><span class=\"kd\">]</span>\n<span class=\"n\">unsafe</span><span class=\"w\"> </span><span class=\"kn\">opaque</span><span class=\"w\"> </span><span class=\"n\">evalConst</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">@&amp;</span><span class=\"w\"> </span><span class=\"n\">Environment</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">opts</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">@&amp;</span><span class=\"w\"> </span><span class=\"n\">Options</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">constName</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">@&amp;</span><span class=\"w\"> </span><span class=\"n\">Name</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Except</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"n\">α</span>\n</code></pre></div>\n<p>What's the meaning of <code>@&amp;</code> in the code given above?</p>",
        "id": 478830670,
        "sender_full_name": "White Chen",
        "timestamp": 1729823714
    },
    {
        "content": "<p>Hi White, from the FFI docs, in the <a href=\"https://lean-lang.org/lean4/doc/dev/ffi.html#borrowing\">borrowing section</a>, it says:</p>\n<blockquote>\n<p>To reduce reference counting overhead, parameters can be marked as <em>borrowed</em> by prefixing their type with <code>@&amp;</code>.</p>\n</blockquote>",
        "id": 478832879,
        "sender_full_name": "Derek Rhodes",
        "timestamp": 1729825515
    },
    {
        "content": "<p>If you hover over it, the docstring has an explanation.</p>",
        "id": 478832882,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729825518
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>Indicates that an argument to a function marked @[extern] is borrowed.\n\nBeing borrowed only affects the ABI and runtime behavior of the function when compiled or interpreted. From the perspective of Lean's type system, this annotation has no effect. It similarly has no effect on functions not marked @[extern].\n\nWhen a function argument is borrowed, the function does not consume the value. This means that the function will not decrement the value's reference count or deallocate it, and the caller is responsible for doing so.\n\nPlease see https://lean-lang.org/lean4/doc/dev/ffi.html#borrowing for a complete description.\n</code></pre></div>",
        "id": 478832890,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729825533
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> <br>\nI'm currently reading the <code>lean</code> source code directly after <code>git clone</code>, and there's no such support since the Lean server hasn't even started. Previously, I was using <code>#check foo</code> in a <code>lean</code> project and then using <code>F12</code> to jump to the corresponding source code section in Lean to read it, which allowed me to get docstrings through mouse hover. However, I feel this method is both stupid and cumbersome. Is there a better way?</p>",
        "id": 478833609,
        "sender_full_name": "White Chen",
        "timestamp": 1729826144
    },
    {
        "content": "<p>The experience is nice once you've built it (be sure to set up the lean4 and lean4-dev toolchains in elan like the dev docs say to do, and to open the workspace file in VS Code)</p>",
        "id": 478833976,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729826435
    },
    {
        "content": "<p>There's also using the mathlib docs, which contain all the Lean docs too <a href=\"https://leanprover-community.github.io/mathlib4_docs/\">https://leanprover-community.github.io/mathlib4_docs/</a></p>",
        "id": 478833996,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729826459
    },
    {
        "content": "<p>I use <code>#check</code> too, but the mathlib docs are convenient</p>",
        "id": 478834020,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729826487
    },
    {
        "content": "<p>Thank you very much, I'll try it.</p>",
        "id": 478834148,
        "sender_full_name": "White Chen",
        "timestamp": 1729826601
    }
]