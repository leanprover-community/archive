[
    {
        "content": "<p><a href=\"https://github.com/ValorZard/sdl3-lean-test\">https://github.com/ValorZard/sdl3-lean-test</a><br>\nExperimenting with making SDL3 bindings for Lean here. <br>\nHowever this is linux only for now until i can figure out a way to build this on windows. And, I'm also not sure how to process. SDL gives you a set of callbacks that it wants you to set, and I'm not really sure how to set a c callback with a Lean function?</p>",
        "id": 536528960,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1756355536
    },
    {
        "content": "<p>Explanation on how SDL3 callbacks work: <a href=\"https://wiki.libsdl.org/SDL3/README-main-functions\">https://wiki.libsdl.org/SDL3/README-main-functions</a></p>",
        "id": 536528994,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1756355569
    },
    {
        "content": "<p>Running into a weird error when trying to run lean exe </p>\n<p>sraya@Penelope:~/sdl3-test$ lake exe sdl3-test<br>\n/home/sraya/sdl3-test/.lake/build/bin/sdl3-test: error while loading shared libraries: libSDL3.so.0: cannot open shared object file: No such file or directory</p>",
        "id": 536544172,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1756365253
    },
    {
        "content": "<p>It can’t find libSDL3 even though it exists (I’m using guix for packages)</p>\n<p><code>sraya@Penelope:~/sdl3-test$ sudo find / -name libSDL3.so.0\n/gnu/store/k07f8wq9zrgngqn73vp0rhmbsyl6nx5i-profile/lib/libSDL3.so.0\n/gnu/store/851kyaim7vd5p69hnwisg357rsb5wshd-profile/lib/libSDL3.so.0\n/gnu/store/zrgafc6kc0n3gl6s0zssx5111qvxk09w-sdl3-3.2.10/lib/libSDL3.so.0\n/gnu/store/khwamrygp99pkyrwkb6f42g5qxnb82aa-profile/lib/libSDL3.so.0\n/gnu/store/lyajh49gks1hn3w8j4idv5ggr5pbry2b-sdl3-3.2.10/lib/libSDL3.so.0\n/gnu/store/azv7f4kz2p833rmfs5m4d1q70407rnbf-profile/lib/libSDL3.so.0\n/gnu/store/v85cayxw2snplwdcbqmcsnpl94glgn17-profile/lib/libSDL3.so.0</code></p>",
        "id": 536544277,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1756365307
    },
    {
        "content": "<p>I have also been playing around with the FFI and SDL2 bindings. This is just an experiment, maybe it helps:<br>\n<a href=\"https://github.com/oOo0oOo/LeanDoomed\">https://github.com/oOo0oOo/LeanDoomed</a></p>\n<p>Also ran into some similar build issues, w linking etc. Currently the build works but uses very specific paths to my system... Let me know if you figure out a nicer build than this.</p>",
        "id": 536549080,
        "sender_full_name": "Oliver Dressler",
        "timestamp": 1756367447
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"802311\">@Oliver Dressler</span> what would probably be nicer if you just statically link sdl3 with lean. See: <a href=\"https://github.com/DSLstandard/Lean4-FFI-Programming-Tutorial-GLFW/issues/3\">https://github.com/DSLstandard/Lean4-FFI-Programming-Tutorial-GLFW/issues/3</a></p>\n<p>Lowkey, do you wanna team up? it would be nice to have two people on the same project.</p>",
        "id": 536640898,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1756397217
    },
    {
        "content": "<p>Yes, this looks similar to the issues I encountered. Was considering a vendored approach but ultimately I just wanted to implement some raycasting in Lean. I saw you were working on a PR to improve the build, I will merge if it runs on my system.</p>\n<p>I am happy to work a bit on some more generic SDL bindings. However, I am too busy to take on proper development and maintenance of the library. If you get started I am happy to contribute some PRs..</p>",
        "id": 536749848,
        "sender_full_name": "Oliver Dressler",
        "timestamp": 1756459352
    },
    {
        "content": "<p>Yeah my plan is to get it working without any hardcoded paths and stuff, and then once everything is working, we could probably extract out a library from this repo</p>",
        "id": 536815273,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1756481931
    },
    {
        "content": "<p>if anyone is curious what i've been up to, i finally got standalone windows exectuables building for LeanDoomed<br>\n<span class=\"user-mention\" data-user-id=\"802311\">@Oliver Dressler</span>  <a href=\"https://github.com/ValorZard/LeanDoomed/tree/main\">https://github.com/ValorZard/LeanDoomed/tree/main</a></p>",
        "id": 538703457,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757524725
    },
    {
        "content": "<p>Great news! I'll test it on my machine and merge it tomorrow.</p>",
        "id": 538709324,
        "sender_full_name": "Oliver Dressler",
        "timestamp": 1757526791
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"802311\">@Oliver Dressler</span> Note that the windows build only works on Windows itself, you can't cross compile.<br>\nHowever, I made it so that all of the binaries get copied to the bin folder, so you can zip it and share it on <a href=\"http://itch.io\">itch.io</a> if you'd like.</p>\n<p>I still need some help figuring out how to do the same thing on Linux, though after talking with <span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span> seems like I would need to </p>\n<ol>\n<li>Figure out the rpath stuff on Linux</li>\n<li>Copy over all the SDL binaries from the vendor folder into /bin</li>\n<li>Copy over all of the lean binaries from wherever its stored on linux into /bin<br>\nAnd presto, we got a distributable cross platform game in Lean!</li>\n</ol>\n<p>I have no idea how to abstract out the bindings into a reusable library though <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 538764827,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757559393
    },
    {
        "content": "<p>Cross Compiling itself seems like something the Lean team isnt interested in, so you'd probably need to use Github Actions or something to generate binaries</p>",
        "id": 538764867,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757559445
    },
    {
        "content": "<p>Also make sure you read the readme, I updated it with new build instructions</p>",
        "id": 538764927,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757559507
    },
    {
        "content": "<p>Also to be clear it works on Linux too, you just cant redistribute it to another computer yet cuz of the rpath stuff</p>",
        "id": 538765556,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757560127
    },
    {
        "content": "<p>Ok, the possibility of deploying to <a href=\"http://itch.io\">itch.io</a> is nice. I think proper cross-compilation is ambitious for this example project. The current state where you can build and run on Unix and Windows is already great!</p>\n<p>I have tested on Unix and it works like a charm. Merged your PR <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span> </p>\n<p>Will take some time today and try adding texture support, since you have included SDL_image in the dependencies. Hopefully we can keep the framerate up <span aria-label=\"fingers crossed\" class=\"emoji emoji-1f91e\" role=\"img\" title=\"fingers crossed\">:fingers_crossed:</span></p>",
        "id": 538796779,
        "sender_full_name": "Oliver Dressler",
        "timestamp": 1757578680
    },
    {
        "content": "<p>Let’s go! Thanks for merging! I have put …. Wayyy too much time into making this work. Do you have any ideas on how to set the rpath stuff correctly <span class=\"user-mention\" data-user-id=\"802311\">@Oliver Dressler</span> ? I’d love to be able to zip up the /bin folder for Linux and share it around. We could even probably use github actions to publish releases</p>",
        "id": 538903196,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757608420
    },
    {
        "content": "<p>Oh also, there was a minor mistake in the cloning instructions, since it uses my git repo instead of yours. I will change that in a PR real quick</p>",
        "id": 538913870,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757612142
    },
    {
        "content": "<p>I GOT THE BINARIES WORKING STANDALONE<br>\nALL I NEEDED TO DO WAS COPY ALL THE BINARIES FOR LEAN AND SDL AND NOW IT <em>JUST WORKS</em><br>\nLETS GOOO<br>\n<a href=\"https://github.com/oOo0oOo/LeanDoomed/pull/5\">https://github.com/oOo0oOo/LeanDoomed/pull/5</a></p>",
        "id": 538918706,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757614302
    },
    {
        "content": "<p>Also here's my README fix PR <a href=\"https://github.com/oOo0oOo/LeanDoomed/pull/4\">https://github.com/oOo0oOo/LeanDoomed/pull/4</a></p>",
        "id": 538918739,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757614318
    },
    {
        "content": "<p>I get the following error when trying to run LeanDoomed:</p>\n<div class=\"codehilite\" data-code-language=\"Fish\"><pre><span></span><code>chabulhwi@desktop ~/l/LeanDoomed <span class=\"o\">(</span>main<span class=\"o\">)&gt;</span> lake build\n✖ <span class=\"o\">[</span>8/9<span class=\"o\">]</span> Building LeanDoomed/sdl.o\ntrace: .&gt; cc -c -o /home/chabulhwi/lean-projects/LeanDoomed/.lake/build/c/sdl.o /home/chabulhwi/lean-projects/LeanDoomed/c/sdl.c -fPIC -Ivendor/SDL/include/ -Ivendor/SDL_image/include/ -D_REENTRANT -I/home/chabulhwi/.elan/toolchains/leanprover--lean4---v4.22.0/include\ninfo: stderr:\n/home/chabulhwi/lean-projects/LeanDoomed/c/sdl.c: In <span class=\"k\">function</span> ‘sdl_get_key_state’:\n/home/chabulhwi/lean-projects/LeanDoomed/c/sdl.c:97:28: error: initialization of ‘const uint8_t *’ <span class=\"err\">{</span>aka ‘const unsigned char *’<span class=\"err\">}</span> from incompatible pointer <span class=\"nb\">type</span> ‘const _Bool *’ <span class=\"o\">[</span>-Wincompatible-pointer-types<span class=\"o\">]</span>\n   <span class=\"m\">97</span> <span class=\"o\">|</span>     const uint8_t* <span class=\"nv\">state</span><span class=\"w\"> </span><span class=\"o\">=</span> SDL_GetKeyboardState<span class=\"o\">(</span>NULL<span class=\"o\">)</span><span class=\"p\">;</span>\n      <span class=\"o\">|</span>                            <span class=\"o\">^</span>~~~~~~~~~~~~~~~~~~~\nerror: external <span class=\"nb\">command</span> <span class=\"s1\">'cc'</span> exited with code 1\nℹ <span class=\"o\">[</span>10/11<span class=\"o\">]</span> Ran LeanDoomed/libleansdl\ninfo: stdout/stderr:\nCopying Lake binaries from /home/chabulhwi/.elan/toolchains/leanprover--lean4---v4.22.0/lib\nSome required builds logged failures:\n- LeanDoomed/sdl.o\nerror: build failed\n</code></pre></div>",
        "id": 538973741,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1757645162
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"417769\">@Bulhwi Cha</span> are you on linux or windows?</p>",
        "id": 538973889,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757645252
    },
    {
        "content": "<p>I'm on Slackware Linux.</p>",
        "id": 538973967,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1757645283
    },
    {
        "content": "<p>If you are on linux: make sure you have build-essential or whatever llvm compiler is on your distro installed<br>\nif you are on windows: check the link in the readme about MSYS2</p>",
        "id": 538973970,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757645286
    },
    {
        "content": "<p>like, if you type <code>clang</code> in your terminal, something should pop up</p>",
        "id": 538973983,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757645305
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Fish\"><pre><span></span><code>chabulhwi@desktop ~/l/LeanDoomed <span class=\"o\">(</span>main<span class=\"o\">)</span> <span class=\"o\">[</span>1<span class=\"o\">]&gt;</span> clang --version\nclang version 21.1.1\nTarget: x86_64-unknown-linux-gnu\nThread model: posix\nInstalledDir: /usr/bin\n</code></pre></div>",
        "id": 538974061,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1757645368
    },
    {
        "content": "<p>Ah, i see the issue<br>\n<span class=\"user-mention\" data-user-id=\"417769\">@Bulhwi Cha</span> </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">sraya</span><span class=\"bp\">@</span><span class=\"n\">Penelope</span><span class=\"o\">:</span><span class=\"bp\">~/</span><span class=\"n\">LeanDoomed</span><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">LeanDoomed</span>\n<span class=\"n\">ℹ</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">8</span><span class=\"bp\">/</span><span class=\"mi\">9</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Replayed</span><span class=\"w\"> </span><span class=\"n\">LeanDoomed</span><span class=\"bp\">/</span><span class=\"n\">sdl</span><span class=\"bp\">.</span><span class=\"n\">o</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stderr</span><span class=\"o\">:</span>\n<span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">sraya</span><span class=\"bp\">/</span><span class=\"n\">LeanDoomed</span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">sdl</span><span class=\"bp\">.</span><span class=\"n\">c</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">In</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"bp\">‘</span><span class=\"n\">sdl_get_key_state</span><span class=\"bp\">’</span><span class=\"o\">:</span>\n<span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">sraya</span><span class=\"bp\">/</span><span class=\"n\">LeanDoomed</span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">sdl</span><span class=\"bp\">.</span><span class=\"n\">c</span><span class=\"o\">:</span><span class=\"mi\">98</span><span class=\"o\">:</span><span class=\"mi\">28</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">initialization</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"bp\">‘</span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"n\">uint8_t</span><span class=\"w\"> </span><span class=\"bp\">*’</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">aka</span><span class=\"w\"> </span><span class=\"bp\">‘</span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"n\">unsigned</span><span class=\"w\"> </span><span class=\"n\">char</span><span class=\"w\"> </span><span class=\"bp\">*’</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">incompatible</span><span class=\"w\"> </span><span class=\"n\">pointer</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"bp\">‘</span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">Bool</span><span class=\"w\"> </span><span class=\"bp\">*’</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">-</span><span class=\"n\">Wincompatible</span><span class=\"bp\">-</span><span class=\"n\">pointer</span><span class=\"bp\">-</span><span class=\"n\">types</span><span class=\"o\">]</span>\n<span class=\"w\">   </span><span class=\"mi\">98</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\">     </span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"n\">uint8_t</span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">state</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">SDL_GetKeyboardState</span><span class=\"o\">(</span><span class=\"n\">NULL</span><span class=\"o\">)</span><span class=\"bp\">;</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\">                            </span><span class=\"bp\">^~~~~~~~~~~~~~~~~~~~</span>\n<span class=\"n\">ℹ</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">10</span><span class=\"bp\">/</span><span class=\"mi\">11</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Replayed</span><span class=\"w\"> </span><span class=\"n\">LeanDoomed</span><span class=\"bp\">/</span><span class=\"n\">libleansdl</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stdout</span><span class=\"bp\">/</span><span class=\"n\">stderr</span><span class=\"o\">:</span>\n<span class=\"n\">Copying</span><span class=\"w\"> </span><span class=\"n\">Lake</span><span class=\"w\"> </span><span class=\"n\">binaries</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">sraya</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---v4.22.0/lib</span>\n<span class=\"n\">Use</span><span class=\"w\"> </span><span class=\"n\">WASD</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">move</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"bp\">/</span><span class=\"n\">D</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">turn</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ESC</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">quit</span>\n<span class=\"bp\">^</span><span class=\"n\">C</span>\n<span class=\"n\">sraya</span><span class=\"bp\">@</span><span class=\"n\">Penelope</span><span class=\"o\">:</span><span class=\"bp\">~/</span><span class=\"n\">LeanDoomed</span><span class=\"bp\">$</span>\n</code></pre></div>",
        "id": 538974266,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757645537
    },
    {
        "content": "<p>That's a warning on my computer, but an error on yours</p>",
        "id": 538974284,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757645548
    },
    {
        "content": "<p>Yes, this was a warning for me as well. I have removed it by doing an explicit cast. Hopefully it works now?</p>",
        "id": 538978685,
        "sender_full_name": "Oliver Dressler",
        "timestamp": 1757649884
    },
    {
        "content": "<p>Ah! i got ninjaed, yes it should work <span class=\"user-mention\" data-user-id=\"417769\">@Bulhwi Cha</span> does it work for you?</p>",
        "id": 538980744,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757651632
    },
    {
        "content": "<p>I wonder how one can extract out a library out of this...<br>\nThe big problem i can think of is currently this requires running a bash script. It SHOULD be possible to convert the batch script into a section of the lakefile, but then I wonder how the git sub modules would work.<br>\nIf you were to get the sdl3 bindings by using <a href=\"https://lean-lang.org/doc/reference/4.19.0/Build-Tools-and-Distribution/Lake/#Lake___Dependency-git\">https://lean-lang.org/doc/reference/4.19.0/Build-Tools-and-Distribution/Lake/#Lake___Dependency-git</a> does that handle git sub modules as well?<br>\nMany questions....</p>",
        "id": 538981851,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1757652629
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"950553\">Srayan Jana</span> <a href=\"#narrow/channel/113488-general/topic/Making.20SDL3.20bindings.20for.20Lean.204/near/538980744\">said</a>:</p>\n<blockquote>\n<p>Ah! i got ninjaed, yes it should work <span class=\"user-mention silent\" data-user-id=\"417769\">Bulhwi Cha</span> does it work for you?</p>\n</blockquote>\n<p>It works! <a href=\"/user_uploads/3121/U9g5JonC5ZgOVFpe8bfxwjrP/2025-09-12_20-58-17_resized.webm\">2025-09-12_20-58-17_resized.webm</a></p>\n<div class=\"message_inline_image message_inline_video\"><a href=\"/user_uploads/3121/U9g5JonC5ZgOVFpe8bfxwjrP/2025-09-12_20-58-17_resized.webm\" title=\"2025-09-12_20-58-17_resized.webm\"><video preload=\"metadata\" src=\"/user_uploads/3121/U9g5JonC5ZgOVFpe8bfxwjrP/2025-09-12_20-58-17_resized.webm\"></video></a></div>",
        "id": 539046696,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1757678438
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"802311\">@Oliver Dressler</span> Sent a new PR, MASSIVELY simplified how the build process works.<br>\nNow you just have the one lakefile that does everything for you, no sketchy bash script required! <br>\nAND no git submodules<br>\n<a href=\"https://github.com/oOo0oOo/LeanDoomed/pull/7\">https://github.com/oOo0oOo/LeanDoomed/pull/7</a></p>",
        "id": 540563932,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758349134
    },
    {
        "content": "<p>Thinking that next steps will be:</p>\n<ul>\n<li>splitting out the sdl bindings into a seperate project</li>\n<li>make a simple Pong or Flappy Bird clone to show off how you can make a simple game in Lean</li>\n<li>maybe write a tutorial on how to do it?</li>\n</ul>",
        "id": 540638595,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758439577
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"802311\">@Oliver Dressler</span> split out the sdl bindings into their own repository:<br>\n<a href=\"https://github.com/ValorZard/lean-sdl3/tree/master\">https://github.com/ValorZard/lean-sdl3/tree/master</a><br>\nTest project/Fork where I got it working: <a href=\"https://github.com/ValorZard/lean-sdl-test/tree/master\">https://github.com/ValorZard/lean-sdl-test/tree/master</a><br>\nMASSIVE thanks to <span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span> for walking me through this.<br>\nI need to go for a walk and not stare at the computer anymore lol</p>",
        "id": 540708637,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758516664
    },
    {
        "content": "<p>If im not totally mentally exhausted I'll submit a PR, but hopefully its pretty obvious how to use them and replace what is currently there with this</p>",
        "id": 540708694,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758516703
    },
    {
        "content": "<p>Sounds great! I think I would like to keep the LeanDoomed repo as a self-contained example case.<br>\nBut we can obviously create a new repo based on it and also use it as an example for how to use this library.</p>\n<p>In general it would be nice, if the library covered some more SDL functions, e.g. mouse interaction.</p>\n<p>I am also happy to provide another simple example game for the library; the more the better. Let me know what your plans are, some variety of examples would be great. 2D, 3D, UI-heavy, ...</p>",
        "id": 540725237,
        "sender_full_name": "Oliver Dressler",
        "timestamp": 1758525938
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"802311\">@Oliver Dressler</span> <a class=\"stream-topic\" data-stream-id=\"113486\" href=\"/#narrow/channel/113486-announce/topic/SDL3.20Bindings.20Alpha.20Release.21/with/540892012\">#announce &gt; SDL3 Bindings Alpha Release!</a>  made an annoucement releasing it to the public and future plans.<br>\nI REALLY want to do a sample project and write a tutorial on how to make your own game with it.<br>\nI can also turn the lean-sdl-test repo into its own standalone thing, and probably add your license back lol. It was originally just a private repo meant for testing out the bindings, but I'm down to make it more official</p>",
        "id": 540892176,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758573825
    },
    {
        "content": "<p>Wow, this is exciting.</p>",
        "id": 541165520,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1758700817
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"950553\">Srayan Jana</span> <a href=\"#narrow/channel/113488-general/topic/Making.20SDL3.20bindings.20for.20Lean.204/near/540892176\">said</a>:</p>\n<blockquote>\n<p>I can also turn the lean-sdl-test repo into its own standalone thing, and probably add your license back lol. It was originally just a private repo meant for testing out the bindings, but I'm down to make it more official</p>\n</blockquote>\n<p>You don't have to worry about the license. LeanDoomed is MIT-licensed, which means you can use it very freely (commercial, without attribution, change license etc).  I saw that both lean-sdl3 and lean-sdl-test licenses are copied and still include my name. That's fine with me, since I wrote some of the code, but you can also change it to yours.</p>\n<p>Only thing that's important to me is to include attribution for the creator of the wall texture, even though it is not strictly required (CC0). I saw it is in lean-sdl-test but not in lean-sdl3, which currently includes the texture in assets/. Although I would consider removing the assets/ altogether from the bindings if possible. Assets should be provided by the users of the library.</p>\n<p>Regarding examples: I have a game concept, that I couldn't implement in lean4game, as it deviates too much from its structure. It's quite UI-heavy, so it definietly requires the ttf support you are working on.</p>\n<p>What I miss is mouse support. Can I provide a PR?</p>",
        "id": 541173953,
        "sender_full_name": "Oliver Dressler",
        "timestamp": 1758703416
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"802311\">@Oliver Dressler</span> yeah I added a license in assets in lean-sdl3 for stuff like text and walls<br>\n<a href=\"https://github.com/ValorZard/lean-sdl3/blob/master/assets/LICENSE.md\">https://github.com/ValorZard/lean-sdl3/blob/master/assets/LICENSE.md</a><br>\nThe assets are strictly for the test app, which I could probably remove at some point. Still, I wanted some sort of minimal example to show off all the features, which requires some assets to do so.<br>\nFeel free to submit as many PRs as you want! I'm kinda flying by the seat of my pants here. <br>\nI'm trying to refactor the SDL bindings as much as I can to make them as flexible as possible</p>",
        "id": 541340036,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758753293
    },
    {
        "content": "<p>Also, I added SDL_Mixer support so now all four main SDL libraries are now in lean-SDL3! I don't anticipate adding any more libraries, since this is more than enough to start making games lol</p>",
        "id": 541340128,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758753358
    },
    {
        "content": "<p>You can run the test app by doing <code>lake exe test-app</code></p>",
        "id": 541340212,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758753400
    },
    {
        "content": "<p>If you could, I'd really appreciate a PR at some point that updates \"lean-sdl-test\" to the latest version of the SDL3 bindings. I did a bunch of refactoring that breaks a bunch of code, since it was still assuming you were doing the raycasting stuff. I figure it would be better for the bindings to expose the low level C stuff, and you just do all the high level stuff in Lean</p>",
        "id": 541343252,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758755590
    },
    {
        "content": "<p>Also, quoting this from DMs,<br>\nCurrently, we have a single mutable variable <a href=\"https://github.com/ValorZard/lean-sdl3/blob/9b4b7602d1ad96730dbe26c5eeea02aa588b7934/c/sdl.c#L10\">g_texture</a> that stores the texture once created.</p>\n<div class=\"codehilite\" data-code-language=\"C\"><pre><span></span><code><span class=\"n\">lean_obj_res</span><span class=\"w\"> </span><span class=\"nf\">sdl_load_texture</span><span class=\"p\">(</span><span class=\"n\">lean_obj_arg</span><span class=\"w\"> </span><span class=\"n\">filename</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">lean_obj_arg</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"k\">const</span><span class=\"w\"> </span><span class=\"kt\">char</span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">filename_str</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">lean_string_cstr</span><span class=\"p\">(</span><span class=\"n\">filename</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"n\">SDL_Surface</span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">surface</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">IMG_Load</span><span class=\"p\">(</span><span class=\"n\">filename_str</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">!</span><span class=\"n\">surface</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"n\">SDL_Log</span><span class=\"p\">(</span><span class=\"s\">\"C: Failed to load texture: %s</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">SDL_GetError</span><span class=\"p\">());</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">lean_io_result_mk_ok</span><span class=\"p\">(</span><span class=\"n\">lean_box</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">));</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">g_texture</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">SDL_DestroyTexture</span><span class=\"p\">(</span><span class=\"n\">g_texture</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"n\">g_texture</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">SDL_CreateTextureFromSurface</span><span class=\"p\">(</span><span class=\"n\">g_renderer</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">surface</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"n\">SDL_DestroySurface</span><span class=\"p\">(</span><span class=\"n\">surface</span><span class=\"p\">);</span>\n\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">!</span><span class=\"n\">g_texture</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"n\">SDL_Log</span><span class=\"p\">(</span><span class=\"s\">\"C: Failed to create texture: %s</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">SDL_GetError</span><span class=\"p\">());</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">lean_io_result_mk_ok</span><span class=\"p\">(</span><span class=\"n\">lean_box</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">));</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">lean_io_result_mk_ok</span><span class=\"p\">(</span><span class=\"n\">lean_box</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">));</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>I'd rather for that to be stored in Lean itself</p>\n<blockquote>\n<p>For the texture, you would want to register a texture class with <code>register_external_class</code> (that runs <code>SDL_DestroyTexture</code> in the finalizer) and and then wrap the texture via <code>alloc_external</code> using that class.</p>\n</blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"315577\">Mac Malone</span> <a href=\"#narrow/dm/315577,950553-dm/near/541343194\">said</a>:</p>\n<blockquote>\n<p>An opaqur type would be either:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">opaque</span><span class=\"w\"> </span><span class=\"n\">SDL</span><span class=\"bp\">.</span><span class=\"n\">Texture</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n</code></pre></div>\n<p>or, if you want it to provably nonempty (which you probably do):</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">SDL</span>\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">opaque</span><span class=\"w\"> </span><span class=\"n\">Texture</span><span class=\"bp\">.</span><span class=\"n\">nonemptyType</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NonemptyType</span><span class=\"bp\">.</span><span class=\"o\">)</span><span class=\"mi\">0</span><span class=\"o\">{</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Texture</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Texture</span><span class=\"bp\">.</span><span class=\"n\">nonemptyType</span><span class=\"bp\">.</span><span class=\"n\">type</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">Texture</span><span class=\"bp\">.</span><span class=\"n\">instNonempty</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"n\">Texture</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Texture</span><span class=\"bp\">.</span><span class=\"n\">nonemptyType</span><span class=\"bp\">.</span><span class=\"n\">property</span>\n<span class=\"kn\">end</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>This would probably be a solution to all of the global mutable variables floating around</p>",
        "id": 541350294,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758761162
    },
    {
        "content": "<p>We would need to use<br>\n<code>lean_register_external_class</code> and <code>lean_alloc_external</code><br>\n<a href=\"https://github.com/leanprover/lean4/blob/90db9ef006467ae5998f8707e420a392a88a05b8/src/include/lean/lean.h#L303\">https://github.com/leanprover/lean4/blob/90db9ef006467ae5998f8707e420a392a88a05b8/src/include/lean/lean.h#L303</a><br>\n<a href=\"https://github.com/leanprover/lean4/blob/90db9ef006467ae5998f8707e420a392a88a05b8/src/runtime/object.cpp#L2636\">https://github.com/leanprover/lean4/blob/90db9ef006467ae5998f8707e420a392a88a05b8/src/runtime/object.cpp#L2636</a><br>\n<a href=\"https://github.com/leanprover/lean4/blob/90db9ef006467ae5998f8707e420a392a88a05b8/src/include/lean/lean.h#L1228\">https://github.com/leanprover/lean4/blob/90db9ef006467ae5998f8707e420a392a88a05b8/src/include/lean/lean.h#L1228</a></p>",
        "id": 541350395,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758761246
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"950553\">Srayan Jana</span> <a href=\"#narrow/channel/113488-general/topic/Making.20SDL3.20bindings.20for.20Lean.204/near/541350294\">said</a>:</p>\n<blockquote>\n<p>This would probably be a solution to all of the global mutable variables floating around</p>\n</blockquote>\n<p>Yes, this major refactor is absolutely required for the library. The current asset handling was only good enough for LeanDoomed but we definitely want to support multiple textures/fonts/etc with proper memory management.<br>\nI'll do a PR the next few days.</p>",
        "id": 541378880,
        "sender_full_name": "Oliver Dressler",
        "timestamp": 1758782157
    },
    {
        "content": "<p><a href=\"https://github.com/ValorZard/lean-sdl3/pull/6\">https://github.com/ValorZard/lean-sdl3/pull/6</a><br>\nOkay this seems easier than I thought, just really tedious</p>",
        "id": 541520494,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758824671
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"802311\">@Oliver Dressler</span> did the PR, it was suprsingly easy to return SDL Objects as Lean Objects</p>",
        "id": 541540369,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758832426
    },
    {
        "content": "<p>The one thing tripping me up is that you can't pass any signed integers, so we basically have to cast from int64 to uint64 and then back to Int64 in lean, which feels .. gross</p>",
        "id": 541540431,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758832458
    },
    {
        "content": "<p>Could you open an issue for this? Signed integers are a relatively late addition to Lean.</p>",
        "id": 541574842,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1758855988
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> <a href=\"https://github.com/leanprover/lean4/issues/10561\">https://github.com/leanprover/lean4/issues/10561</a><br>\nhere you go!</p>",
        "id": 541577386,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758857836
    },
    {
        "content": "<p><a href=\"https://github.com/ValorZard/lean-sdl-test\">https://github.com/ValorZard/lean-sdl-test</a><br>\nTurned this into a (sorta) flappy bird clone<br>\nLet me know what your guys high score is! It's pretty hard <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 541774356,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758948117
    },
    {
        "content": "<p><a href=\"https://valorzard.itch.io/lean-sdl-test\">https://valorzard.itch.io/lean-sdl-test</a><br>\nUploaded the windows version on itch in case anyone doesn't want to compile it themselves</p>",
        "id": 541774874,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1758948749
    },
    {
        "content": "<p>Adding proper graphics and audio to the game.<br>\nThe jumping noise is pretty annoying though, lol</p>",
        "id": 541857163,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1759029444
    },
    {
        "content": "<p>Okay, so I should probably talk about where my mind is at currently.<br>\nFor now, I'm probably not going to add any more features to the SDL bindings<br>\nHowever, I will continue to maintain it and try to fix any new build issues that pop up.<br>\nThis is because I'm not really sure if people really want to use it <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span> <br>\nRecently, I went to UC Berkley to take part in the Lean for PDEs conference thing, and after talking to the people there, I came to the conclusion that the stuff im working on, while fun, just isn't very useful for the Lean community right now.<br>\nThere were some interesting ideas I got, like maybe using SDL to model temperature PDEs or whatever, but ultimately none of them were super compelling to me.<br>\nThere's a couple of other projects I want to pursue, so I'll go do that instead for now.<br>\nHowever, this NOT to say I'm abandoning this or anything. If anyone needs help or if they want to add a new feature or whatever, feel free to ping me on here or file an issue on Github and I'll try to take care of it straight away!</p>",
        "id": 544831575,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1760473789
    },
    {
        "content": "<p>Thanks for creating these SDL bindings! I have a few Lean project ideas that involve using SDL but I've been too busy recently to work on them. I'm also interested in creating SQLite bindings for Lean but have no idea where to start, so your project might be useful as reference.</p>\n<p>I think here on the Lean Zulip and at conferences, most people are interested in math and proofs rather than software development, so thus they might not be as interested in SDL bindings. However, there are also Lean users outside of those circles and a small but increasing number of people trying to use Lean for writing other kinds of programs, for which your bindings could be useful for.</p>",
        "id": 544852848,
        "sender_full_name": "Anthony Wang",
        "timestamp": 1760485098
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"910779\">@Anthony Wang</span> thank you so much! <br>\nYeah I went back and tried to learn Haskell, and I won’t lie, using Lean feels so much better haha.<br>\nAgain, I’d love to work on more stuff for lean, but maybe it’s best to wait a bit before doing so,<br>\nHAVING SAID THAT:<br>\nI would be super down to work on SQlite bindings for Lean. I learned a lot from the sdl bindings</p>",
        "id": 544881786,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1760507724
    },
    {
        "content": "<p>If you’d like to collaborate on such a project, I’ll be all ears</p>",
        "id": 544881854,
        "sender_full_name": "Srayan Jana",
        "timestamp": 1760507764
    },
    {
        "content": "<p>Sure! My idea for the project is that in most programming languages, SQL queries are just strings, but in Lean we can do better and make it type safe by embedding the SQLite syntax and semantics in Lean. There's already a <a href=\"https://github.com/FWuermse/lean-postgres\">similar project for PostgreSQL</a> but it didn't get very far.</p>",
        "id": 544995325,
        "sender_full_name": "Anthony Wang",
        "timestamp": 1760541139
    },
    {
        "content": "<p>Please consider starting a new thread for the SQLite bindings discussion. I have a strong interest in SQLite integration with Lean 4, and I think a dedicated topic would help future readers interested in this specific aspect locate the conversation more easily.</p>\n<hr>\n<p>Some of my ideas/needs include</p>\n<ul>\n<li>Proofs with the code.</li>\n<li><a href=\"https://en.wikipedia.org/wiki/Hoare_logic\">Hoare</a> pre/post conditions.</li>\n<li>Use of <a href=\"https://www.sqlite.org/lang_createview.html\">views</a> instead of free form text for queries.</li>\n<li>Having more than one SQLite module that would require proofs versus a binding that does not require proofs.</li>\n</ul>",
        "id": 545007558,
        "sender_full_name": "Eric Taucher",
        "timestamp": 1760544394
    },
    {
        "content": "<p>Thanks Anthony for creating the SQLite binding topic.</p>\n<p><a class=\"stream-topic\" data-stream-id=\"113488\" href=\"/#narrow/channel/113488-general/topic/SQLite.20bindings.20for.20Lean/with/545013411\">#general &gt; SQLite bindings for Lean</a></p>",
        "id": 545015593,
        "sender_full_name": "Eric Taucher",
        "timestamp": 1760546796
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"366057\">Eric Taucher</span> <a href=\"#narrow/channel/113488-general/topic/Making.20SDL3.20bindings.20for.20Lean.204/near/545007558\">said</a>:</p>\n<blockquote>\n<p>Please consider starting a new thread for the SQLite bindings discussion. I have a strong interest in SQLite integration with Lean 4, and I think a dedicated topic would help future readers interested in this specific aspect locate the conversation more easily.</p>\n<hr>\n<p>Some of my ideas/needs include</p>\n<ul>\n<li>Proofs with the code.</li>\n<li><a href=\"https://en.wikipedia.org/wiki/Hoare_logic\">Hoare</a> pre/post conditions.</li>\n<li>Use of <a href=\"https://www.sqlite.org/lang_createview.html\">views</a> instead of free form text for queries.</li>\n<li>Having more than one SQLite module that would require proofs versus a binding that does not require proofs.</li>\n</ul>\n</blockquote>\n<p>there's a rust project that does something kind of similar to this, that I've used in production before: <a href=\"https://github.com/launchbadge/sqlx\">https://github.com/launchbadge/sqlx</a></p>",
        "id": 565262452,
        "sender_full_name": "Greg Shuflin",
        "timestamp": 1766568451
    }
]