[
    {
        "content": "<p>I'm trying to understand Lean's syntax extension mechanisms a little better. Is it possible to add a new <code>Parser</code> that will be recognized by the <code>syntax</code> command without modifying lean's core?</p>",
        "id": 496203307,
        "sender_full_name": "Graham Leach-Krouse",
        "timestamp": 1738008395
    },
    {
        "content": "<p>So far, I've noticed that <code>@[term_parser]</code> can be used to designate a <code>Parser</code>as eligible for use with <code>syntax</code>. I'm a bit unclear, though, on how to define parser combinators like <code>withPosition</code> - it might have something to do with <code>@[combinator_parenthesizer ..]</code>?</p>",
        "id": 496215190,
        "sender_full_name": "Graham Leach-Krouse",
        "timestamp": 1738013504
    },
    {
        "content": "<p>OK, it appears that the trick is to either:</p>\n<ol>\n<li>Apply <code>@[run_parser_attribute_hooks]</code> to <code>myparser</code></li>\n<li>Or, use both <code>@[combinator_formatter myparser]</code> and <code>@[combinator_parenthesizer myparser]</code> to declare a <code>Parenthesizer</code> and a <code>Formatter</code>more carefully</li>\n</ol>\n<p>and then use <code>initialize register_parser_alias myparser</code>. The new parser appears to only be recognized in files that import the file where it is registered, not in the registering file. (This restriction appears not to apply to <code>@[term_parser]</code> for some reason.)</p>\n<p>I wonder, is this written down anywhere? A paper, a blog post?</p>",
        "id": 496223819,
        "sender_full_name": "Graham Leach-Krouse",
        "timestamp": 1738017604
    },
    {
        "content": "<p>Maybe this is helpful? <a class=\"message-link\" href=\"/#narrow/channel/113488-general/topic/How.20can.20I.20parse.20custom.20tokens.20with.20the.20Lean.20Parser.3F/near/491949141\">#general &gt; How can I parse custom tokens with the Lean Parser? @ ðŸ’¬</a></p>",
        "id": 496466939,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738123475
    },
    {
        "content": "<p>Thanks! I saw that - the example from verso is helpful. </p>\n<p>Another example I found was:</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/blob/master/Mathlib/Util/Superscript.lean\">https://github.com/leanprover-community/mathlib4/blob/master/Mathlib/Util/Superscript.lean</a></p>\n<p>Both of them, I think, suggest that the approach above (<code>@[run_parser_attribute_hooks]</code> or <code>@[combinator_*]</code> plus <code>register_parser_alias</code>) is not completely an abuse of something that's intended to be an internal interface. It would be nice to be able to understand this a little bit more though!</p>",
        "id": 496546481,
        "sender_full_name": "Graham Leach-Krouse",
        "timestamp": 1738156778
    }
]