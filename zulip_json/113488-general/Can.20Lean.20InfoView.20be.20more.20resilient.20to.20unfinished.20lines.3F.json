[
    {
        "content": "<p>I'm relatively new to Lean but if I may complain about something, the experience of typing the line while trying to resolve the goal is very distracting and somewhat unpleasant.</p>\n<p><a href=\"/user_uploads/3121/9Tli-t17FEFiPmFSmo4DBKne/notfun.mov\">notfun.mov</a></p>\n<p>In particular, the moment I start typing, the goal \"shifts away\" from under me â€” initially it disappears due to \"unknown tactic\", then it says I have no goals (but still some unsolved goals), then it displays a parser error, then a type mismatch (my goal is still gone), then unknown identifier, etc. Of course by this point I have completely forgotten what my goal was.</p>\n<p>What behavior I'd expect:</p>\n<ul>\n<li>I'd expect parsing to be more permissive, similar as in other modern language servers. I.e. it shouldn't completely give up just because I haven't finished typing the line</li>\n<li>Ideally, I'd like to keep seeing my goal (or the last successfully parsed goal) while I'm in the middle of typing. The fact that it jumps around (between \"current goal\", \"no current goal + unsolved goals\", \"parser error\") is very distracting.</li>\n</ul>\n<p>I was wondering if this is something that's on the roadmap or is being considered. I think it would be a very significant improvement if this \"current state\" pane was a tiny bit more resilient and forgiving to ongoing typing â€” at least while I'm still in the middle of a word.</p>\n<p>Thank you!</p>",
        "id": 499621135,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1739498320
    },
    {
        "content": "<p>Not exactly a solution, but you can use the pause button to prevent the goal from changing; there is also a corresponding command, 'Toggle Updating'. Of course it's not ideal to have to keep pause-unpausing, and maybe a better UX would be to add another 'Update Once' command. Then you could keep it paused forever, and only see new information when it's desirable.</p>\n<p>But I broadly agree with you that e.g. on typing <code>us</code>, the goal should still show up.</p>",
        "id": 499621860,
        "sender_full_name": "ğš ğš˜ğš“ğšŒğš’ğšğšŒğš‘ ğš—ğšŠğš ğš›ğš˜ğšŒğš”ğš’",
        "timestamp": 1739498695
    },
    {
        "content": "<p>This is maybe just a workaround for what you really want, but there is a \"Pause updating\" button in the upper right corner of the infoview which will freeze the contents of the infoview; you can also bind a keyboard shortcut to <code>lean4.infoView.toggleUpdating</code> which makes using it slightly more ergonomic.</p>",
        "id": 499621928,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1739498744
    },
    {
        "content": "<p>Would it be hard to have a setting where the infoview updates only when the <code>Syntax</code> of the command was successfully parsed?  I feel like that could be a good compromise.</p>",
        "id": 499627749,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1739502184
    },
    {
        "content": "<p>Not sure settings are the way to go (this is most useful to beginners â€” who wouldn't know to turn the setting on).</p>\n<p>I wonder if it would be possible to display the previous state on parser error but fade it out or dim it, while displaying the parser error below. So that you see the last successful state, but its staleness is communicated and the error is clearly visible. I think this could be decent until it's possible to make parsing itself more resilient.</p>\n<p>Thanks for the suggestions re: pausing.</p>",
        "id": 499628313,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1739502544
    },
    {
        "content": "<p>I do think that \"pausing\" (while handy in the meantime) is not the right way to think about this. It's a known problem in many other languages / IDEs, and I'm sure it has been satisfactorily solved by now for those. E.g. it's worth looking at how Visual Studio handles half-valid C# lines, or how VS Code handles half-valid TS. I would expect it to not choke on it. (As I'm sure the Lean team knows there's plenty of <a href=\"https://matklad.github.io/2023/05/21/resilient-ll-parsing-tutorial.html\">prior art</a> in this area.)</p>\n<p>So my broader point is that I as a user shouldn't need to manually direct the tool's attention. If the architecture is right, the tool should be able to just \"do the right thing\", ofc with some question of what the \"right thing\" is in each incomplete state.</p>",
        "id": 499628607,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1739502746
    },
    {
        "content": "<p>Btw, what I sometimes do in this situation, is to toggle between commenting/uncommenting the current line.  This, combined with sprinkling sorries and underscores in the \"right places\" is usually enough for me.</p>",
        "id": 499628698,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1739502834
    },
    {
        "content": "<p>related: <a href=\"https://github.com/leanprover/lean4/pull/4181\">lean4#4181</a> (please upvote that issue if you find this annoying)</p>",
        "id": 499670752,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1739521647
    },
    {
        "content": "<p>This topic was moved here from <a class=\"stream-topic\" data-stream-id=\"341532\" href=\"/#narrow/channel/341532-lean4-dev/topic/Can.20Lean.20InfoView.20be.20more.20resilient.20to.20unfinished.20lines.3F\">#lean4 dev &gt; Can Lean InfoView be more resilient to unfinished lines?</a> by <span class=\"user-mention silent\" data-user-id=\"110024\">Sebastian Ullrich</span>.</p>",
        "id": 499688647,
        "sender_full_name": "Notification Bot",
        "timestamp": 1739526426
    },
    {
        "content": "<p>I moved this thread since it's a feature request of interest to general users</p>",
        "id": 499688711,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1739526443
    },
    {
        "content": "<p>I think that improving this would be a great idea. Having the infoview paused the majority of the time is so ingrained in my workflow that it hadn't occurred to me that things could be better some other way.</p>",
        "id": 500388050,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1739881466
    },
    {
        "content": "<p>Would it be crazy if Lean only fired (and updated the InfoView) when I saved the file? That's what my LaTeX compiler does, and I like it.</p>",
        "id": 500412022,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1739888363
    },
    {
        "content": "<p>As long as you don't make me work like that :)</p>",
        "id": 500415196,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1739889197
    },
    {
        "content": "<p>If you write your Lean code in notepad, this is (almost) the default behavior! :)</p>",
        "id": 500416228,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1739889466
    }
]