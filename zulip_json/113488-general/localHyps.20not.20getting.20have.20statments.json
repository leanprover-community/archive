[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"n\">run_tac</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">womp</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">getMainGoal</span>\n<span class=\"w\">    </span><span class=\"c1\">-- IO.println (← Lean.getLocalHyps).size</span>\n<span class=\"w\">    </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">MonadLCtx</span><span class=\"bp\">.</span><span class=\"n\">getLCtx</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">size</span>\n<span class=\"w\">    </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">hyp</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">getLocalHyps</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">      </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">println</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">hyp</span><span class=\"bp\">.</span><span class=\"n\">fvarId!</span><span class=\"bp\">.</span><span class=\"n\">getType</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"c1\">-- Nat</span>\n\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">this</span>\n</code></pre></div>\n<p>as you can see in the above the <code>x = x</code> have statement isn't showing up in the getLocalHyps call</p>",
        "id": 570915054,
        "sender_full_name": "Frederick Pu",
        "timestamp": 1769729613
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Elab.Tactic.withMainContext#doc\">docs#Lean.Elab.Tactic.withMainContext</a></p>",
        "id": 570915292,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1769729759
    },
    {
        "content": "<p>oh thanks</p>",
        "id": 570915312,
        "sender_full_name": "Frederick Pu",
        "timestamp": 1769729769
    },
    {
        "content": "<p>Without that you get the local context at the very start of the <code>by</code> block</p>",
        "id": 570915336,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1769729787
    },
    {
        "content": "<p>also how do you print an expr in raw form</p>",
        "id": 570915363,
        "sender_full_name": "Frederick Pu",
        "timestamp": 1769729811
    },
    {
        "content": "<p>so i can see which constructors are being applied and stuff</p>",
        "id": 570915383,
        "sender_full_name": "Frederick Pu",
        "timestamp": 1769729823
    },
    {
        "content": "<p><del><code>s!\"{e}\"</code> or <code>e.dbgToString</code>.</del></p>",
        "id": 570915499,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1769729900
    },
    {
        "content": "<p><code>m!\"{repr e}\"</code> I think?</p>",
        "id": 570915777,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1769730062
    },
    {
        "content": "<p>thanks so much!!!</p>",
        "id": 570915850,
        "sender_full_name": "Frederick Pu",
        "timestamp": 1769730107
    }
]