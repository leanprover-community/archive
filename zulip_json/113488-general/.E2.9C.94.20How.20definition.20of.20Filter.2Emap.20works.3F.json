[
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Order/Filter/Defs.html#Filter.map\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Order/Filter/Defs.html#Filter.map</a></p>\n<p>The definition of <code>Filter.map</code> is like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">sets</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">preimage</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">⁻¹'</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">sets</span>\n<span class=\"w\">  </span><span class=\"n\">univ_sets</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">univ_mem</span>\n<span class=\"w\">  </span><span class=\"n\">sets_of_superset</span><span class=\"w\"> </span><span class=\"n\">hs</span><span class=\"w\"> </span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">mem_of_superset</span><span class=\"w\"> </span><span class=\"n\">hs</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">hx</span>\n<span class=\"w\">  </span><span class=\"n\">inter_sets</span><span class=\"w\"> </span><span class=\"n\">hs</span><span class=\"w\"> </span><span class=\"n\">ht</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">inter_mem</span><span class=\"w\"> </span><span class=\"n\">hs</span><span class=\"w\"> </span><span class=\"n\">ht</span>\n</code></pre></div>\n<p>However, I cannot understand how definitions of <code>univ_sets</code>, <code>sets_of_superset</code> and <code>inter_sets</code> works. In this code, <code>univ_mem</code> is actually same as <code>f.univ_sets</code>. But how can this be proof of <code>univ_sets</code> of new Filter <code>Filter β</code>, even the term have different type? I think there is coercion or definitional equality that I don't know.</p>",
        "id": 491272412,
        "sender_full_name": "lunuy",
        "timestamp": 1735559054
    },
    {
        "content": "<p>The trick here is that <code>univ ∈ preimage m ⁻¹' f.sets</code> is <em>defined as</em> <code>preimage m univ ∈ f.sets</code>, which is <em>defined as</em> <code>univ ∈ f.sets</code>, so <code>f.univ_sets</code> is a valid proof</p>",
        "id": 491272632,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1735559213
    },
    {
        "content": "<p>Thank you so much, I understand now!</p>",
        "id": 491275463,
        "sender_full_name": "lunuy",
        "timestamp": 1735561019
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"815149\">lunuy</span> has marked this topic as resolved.</p>",
        "id": 491275827,
        "sender_full_name": "Notification Bot",
        "timestamp": 1735561276
    }
]