[
    {
        "content": "<p>Does <a href=\"https://github.com/leanprover-community/docgen-action\">docgen-action</a> support providing a <code>references.bib</code> file? I couldn't find any mention of this in the docs or code.</p>",
        "id": 556605775,
        "sender_full_name": "Chris Henson",
        "timestamp": 1763213438
    },
    {
        "content": "<p>I think <code>doc-gen4</code> itself has the hardcoded path <code>docs/references.bib</code> and does not need any additional arguments to pick it up, as long as it is in the right place. I recently got it working for my project <a href=\"#narrow/channel/518132-combinatorial-games/topic/References/near/553728097\">as discussed here</a>.</p>",
        "id": 556680585,
        "sender_full_name": "Malvin Gattinger",
        "timestamp": 1763294063
    },
    {
        "content": "<p>Thanks, we'll try that!</p>",
        "id": 556681991,
        "sender_full_name": "Chris Henson",
        "timestamp": 1763295722
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"238446\">@Anne Baanen</span> would a PR be welcome that adds an optional <code>references</code> input to the action? It would take a path and copy it to the appropriate location.</p>",
        "id": 556682017,
        "sender_full_name": "Chris Henson",
        "timestamp": 1763295743
    },
    {
        "content": "<p>Wouldn't the \"right\" place to add such an option be a cli argument or config setting for doc-gen4 itself? Or why do you not want to put the file in <code>docs/references.bib</code>? Is it because you have other things (latex documents) using the file too?</p>\n<p>(Part of my reasoning here is that I like to be able to build docs locally too, not only in github actions CI.)</p>",
        "id": 556682560,
        "sender_full_name": "Malvin Gattinger",
        "timestamp": 1763296394
    },
    {
        "content": "<p>Yes it could be set higher up, I had just thought of configuration of the action as a good first step. Regardless of where it is set, it is undesirable for a user to need hardcoded paths from two tools (<code>docbuild</code> from the action, then <code>docs/references.bib</code> from from doc-gen4) to make this work.</p>\n<p>I had hoped to eliminate having a directory for the docs at all in the repo and it just be made in CI, with <code>references.bib</code> copied over from the root of the repo. I don't like the maintenance of having an extra toolchain/manifest/lakefile. For our project (CSLib), I considered the tradeoff of needing to make that directory yourself to build docs locally acceptable.</p>",
        "id": 556683731,
        "sender_full_name": "Chris Henson",
        "timestamp": 1763297675
    },
    {
        "content": "<p>Oh, that makes sense, I also often forgot to update stuff inside <code>docbuild</code> when updating to a newer lean, and it would be great if this could be autogenerated.</p>",
        "id": 556683798,
        "sender_full_name": "Malvin Gattinger",
        "timestamp": 1763297773
    },
    {
        "content": "<p>Yeah I consider the action <a href=\"https://github.com/leanprover-community/docgen-action/blob/deed0cdc44dd8e5de07a300773eb751d33e32fc8/scripts/build_docs.sh#L62-L77\">making the docs lakefile</a> for you a big advantage. It seems in line that it should be able to (by whatever mechanism) do the equivalent for the references file.</p>",
        "id": 556684215,
        "sender_full_name": "Chris Henson",
        "timestamp": 1763298225
    },
    {
        "content": "<p>I think this is a good idea, I am very much against hardcoding paths. Since the bibliography processing passes are being run from the docgen lakefile, it seems somewhat hard to modify this directly. So instead I think the right thing to do is for the action to copy a user-specified path to <code>docbuild/docs/references.bib</code>.</p>\n<p>Would you like to open a PR implementing this?</p>",
        "id": 556810693,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1763380704
    },
    {
        "content": "<p>There've been several requests to funnel options into doc-gen over the years but its still unclear to me how/if that's possible. <span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span> is there a recommended way to pass options into a facet?</p>",
        "id": 556815134,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1763381945
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"238446\">Anne Baanen</span> <a href=\"#narrow/channel/113488-general/topic/references.2Ebib.20with.20docgen-action/near/556810693\">said</a>:</p>\n<blockquote>\n<p>I think this is a good idea, I am very much against hardcoding paths. Since the bibliography processing passes are being run from the docgen lakefile, it seems somewhat hard to modify this directly. So instead I think the right thing to do is for the action to copy a user-specified path to <code>docbuild/docs/references.bib</code>.</p>\n<p>Would you like to open a PR implementing this?</p>\n</blockquote>\n<p>I have opened <a href=\"https://github.com/leanprover-community/docgen-action/pull/15\">https://github.com/leanprover-community/docgen-action/pull/15</a>  to do this.</p>",
        "id": 556838844,
        "sender_full_name": "Chris Henson",
        "timestamp": 1763388443
    },
    {
        "content": "<p>(While this is an improvement, I do agree that it would be nice if we could pass an option to the facet)</p>",
        "id": 556839294,
        "sender_full_name": "Chris Henson",
        "timestamp": 1763388553
    },
    {
        "content": "<p>Small bug (I think) with the implementation of the references: <a href=\"https://github.com/leanprover-community/docgen-action/issues/18\">https://github.com/leanprover-community/docgen-action/issues/18</a></p>",
        "id": 567999093,
        "sender_full_name": "Aayush Rajasekaran",
        "timestamp": 1768400755
    },
    {
        "content": "<p>And (hopefully) the fix <a href=\"https://github.com/leanprover-community/docgen-action/pull/19\">https://github.com/leanprover-community/docgen-action/pull/19</a> cc <span class=\"user-mention\" data-user-id=\"687698\">@Chris Henson</span></p>",
        "id": 567999754,
        "sender_full_name": "Aayush Rajasekaran",
        "timestamp": 1768400914
    },
    {
        "content": "<p>The fix looks reasonable to me. I'll let <span class=\"user-mention\" data-user-id=\"238446\">@Anne Baanen</span> take a look before merging though.</p>",
        "id": 568000941,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1768401201
    },
    {
        "content": "<p>BTW, while we wait for Anne to have time to take a look, note that you should be able to test the fix out by changing the workflow file that uses <code>docgen-action</code> to point to <code>leanprover-community/docgen-action@b1386934261c959c460288378384ce7ade57298e</code> (the commit from your PR).</p>",
        "id": 568212678,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1768484148
    },
    {
        "content": "<p>On my proetale repository the <code>docgen-action</code> CI is failing with the following error message:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Documentation</span><span class=\"w\"> </span><span class=\"n\">indexing</span>\n<span class=\"n\">trace</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.&gt;</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">runner</span><span class=\"bp\">/</span><span class=\"n\">work</span><span class=\"bp\">/</span><span class=\"n\">proetale</span><span class=\"bp\">/</span><span class=\"n\">proetale</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"w\"> </span><span class=\"n\">index</span><span class=\"w\"> </span><span class=\"c1\">--build /home/runner/work/proetale/proetale/docbuild/.lake/build</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">file</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">runner</span><span class=\"bp\">/</span><span class=\"n\">work</span><span class=\"bp\">/</span><span class=\"n\">proetale</span><span class=\"bp\">/</span><span class=\"n\">proetale</span><span class=\"bp\">/</span><span class=\"n\">docbuild</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">/</span><span class=\"n\">references</span><span class=\"bp\">.</span><span class=\"n\">bib</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">targets</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">proetale</span><span class=\"bp\">/</span><span class=\"n\">Proetale</span><span class=\"o\">:</span><span class=\"n\">docs</span>\n</code></pre></div>\n<p>(<a href=\"https://github.com/chrisflav/proetale/actions/runs/21265263494/job/61202755102\">full log</a>).<br>\nI have tried to add an empty <code>references.bib</code>, which temporarily gave a green check (see the run <a href=\"https://github.com/chrisflav/proetale/actions/runs/21187436972/job/60945688230\">https://github.com/chrisflav/proetale/actions/runs/21187436972/job/60945688230</a>), but on the next commit it started failing again.<br>\nCould this be related to the changes discussed in this thread?</p>",
        "id": 569721746,
        "sender_full_name": "Christian Merten",
        "timestamp": 1769176775
    },
    {
        "content": "<p>This has been discussed elsewhere, but there is currently a bug in docgen-action. The temporary fix is to downgrade to a commit from October. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">docgen</span><span class=\"bp\">-</span><span class=\"n\">action</span><span class=\"bp\">@</span><span class=\"n\">deed0cdc44dd8e5de07a300773eb751d33e32fc8</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"w\"> </span><span class=\"mi\">2025</span><span class=\"bp\">-</span><span class=\"mi\">10</span><span class=\"bp\">-</span><span class=\"mi\">26</span>\n</code></pre></div>\n<p>Is the one I have in my GitHub workflow now and it succeeds.</p>",
        "id": 569753702,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1769184886
    },
    {
        "content": "<p>I was not aware that this is a bug with docgen-action! Not sure exactly what is going on here, though, based on the log line it is happening outside of any code that docgen-action added...</p>",
        "id": 570063629,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1769425666
    },
    {
        "content": "<p>Yes, I've encountered the same issue in PNT+, FLT, etc. (e.g. see <a class=\"message-link\" href=\"/#narrow/channel/423402-PrimeNumberTheorem.2B/topic/CI.20issues/near/569041527\">#PrimeNumberTheorem+ &gt; CI issues @ ðŸ’¬</a>)</p>",
        "id": 570199918,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1769466411
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/doc-gen4/pull/354\">https://github.com/leanprover/doc-gen4/pull/354</a></p>",
        "id": 570463064,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1769571561
    },
    {
        "content": "<p>I think we also need to have docgen-action actually cache references -- opened a PR <a href=\"https://github.com/leanprover-community/docgen-action/pull/22\">here</a>.</p>",
        "id": 572005477,
        "sender_full_name": "Aayush Rajasekaran",
        "timestamp": 1770237779
    }
]