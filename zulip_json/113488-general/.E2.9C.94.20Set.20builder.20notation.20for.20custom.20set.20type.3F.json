[
    {
        "content": "<p>tl;dr is there some way to make set builder notation work for my custom set type?</p>\n<p>As background on why I want this: I'm reading through an analysis textbook with the goal of proving all the results they do and completing all the exercises, in Lean. The book start with all the axioms and so so shall I. I've successfully completed the chapter on natural numbers but I have now arrived at the chapter on sets. </p>\n<p>I looked at core for inspiration on how to define sets but it would of course be really nice to be able to use the set builder notation. As far as I can tell this isn't done use an instance as the operators I defined previously are but instead some custom notation wizardry in mathlib. I am happy to try and learn how custom notations work but I wanted to ask first because I had some concerns:</p>\n<p>Won't the notation I define just conflict with the one in mathlib.  Unless there is a way to avoid importing that? Really all I want from mathlib is the tactics and the helper theorems about <code>Eq</code> and <code>Iff</code> and so forth. </p>\n<p>Is this going to be super difficult to do? I don't know how complicated notations are. Or perhaps I can just copy and past the code from mathlib? I don't know how difficult it would be to tell what code I need to copy.</p>\n<p>This is roughly what I have so far: <a href=\"https://live.lean-lang.org/#codez=HYQwtgpgzgDiDGEAEBhArlALgezAKDzWAEsA3CAJymTQIBMIAzJAZQkyQApBG4CQC4kAFQCeMGgEp+AXiS9ASYRIAChWwwCoSLATI2mAqRAViIAEYAbZAG9eAkWKRoAvvSZJIYLlH6t2syZxBvbkkBZVVpJC8QAgBaGKEAC2IvZKQAdwSQDgBJdOw0MzokM2IAa2QcPIpSvjwGZihiYABzCxxgLkCBYO9dWQjLEyQAHyQhmRBnPAhgIt0CGaL0LFwgA\">playground</a></p>\n<p>I suppose if the custom notation isn't possible I can just use lots of <code>Set.setOf</code> though that would be kind of irritating. Thanks for your help!</p>",
        "id": 489893059,
        "sender_full_name": "Daniel James",
        "timestamp": 1734588697
    },
    {
        "content": "<p>I'm a bit confused why you don't want to use Lean's <code>Set</code> type since what you have so far in your playground link is exactly the same... is there some point of divergence where you want your custom type to behave differently?</p>",
        "id": 489894448,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1734589656
    },
    {
        "content": "<p>there is a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Sep#doc\">docs#Sep</a> typeclass that should, in theory, allow you to use set builder notation with your custom type</p>\n<p><strong>Edit:</strong> Actually that might only work for creating subsets of an existing set...</p>",
        "id": 489894618,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1734589771
    },
    {
        "content": "<p>I understand that what is there so far is exactly the same as it is defined in core. The goal is not necessarily for it to be defined differently but instead to prove all the relevant theorems myself. And furthermore to prove the specific theorems as they come up in the book.</p>",
        "id": 489895741,
        "sender_full_name": "Daniel James",
        "timestamp": 1734590510
    },
    {
        "content": "<p>So the point is that the built in lean set already has all those theorem's proved and I want the exercise of proving them myself.</p>",
        "id": 489895829,
        "sender_full_name": "Daniel James",
        "timestamp": 1734590559
    },
    {
        "content": "<p>just to be clear are you talking about ZFC set theory where sets can only contain other sets? or just generic sets of elements?</p>",
        "id": 489895905,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1734590624
    },
    {
        "content": "<p>Generic sets.</p>",
        "id": 489896023,
        "sender_full_name": "Daniel James",
        "timestamp": 1734590695
    },
    {
        "content": "<p>The book doesn't use exactly ZFC or even a pure set theory</p>",
        "id": 489896051,
        "sender_full_name": "Daniel James",
        "timestamp": 1734590713
    },
    {
        "content": "<p>I sort of get the impulse to want to start from a complete blank slate, but at the same time I don't see why using Lean's existing <code>Set</code> type prevents you in any way from re-proving all the theorems about sets.</p>",
        "id": 489896262,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1734590867
    },
    {
        "content": "<p>Well I suppose I could but a) all the names are going to conflict b) all the original theorems are still going to be there for me to accidentally use c) it feels much less cool than defining it myself</p>",
        "id": 489896466,
        "sender_full_name": "Daniel James",
        "timestamp": 1734590989
    },
    {
        "content": "<p>Hmm, and I suppose you'd like to define intersection, union, etc. for yourself. That makes sense.</p>",
        "id": 489896557,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1734591040
    },
    {
        "content": "<p>Yeah exactly. I know it doesn't have a \"purpose\" per se but I enjoy doing this sort of thing</p>",
        "id": 489896591,
        "sender_full_name": "Daniel James",
        "timestamp": 1734591066
    },
    {
        "content": "<p>no I understand that... anyway like I said Lean has <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Sep#doc\">docs#Sep</a> and it also has other symbol-related typeclasses like <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Membership#doc\">docs#Membership</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Union#doc\">docs#Union</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Inter#doc\">docs#Inter</a>, and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SDiff#doc\">docs#SDiff</a></p>",
        "id": 489896789,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1734591185
    },
    {
        "content": "<p>Hmm ok. And the list notations like <code>{}</code> and <code>{a}</code> are also typeclasses I think</p>",
        "id": 489896924,
        "sender_full_name": "Daniel James",
        "timestamp": 1734591253
    },
    {
        "content": "<p>So it is really only <code>{a : \\alpha | p a}</code> that doesn't work</p>",
        "id": 489896943,
        "sender_full_name": "Daniel James",
        "timestamp": 1734591274
    },
    {
        "content": "<p>yeah there's <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Singleton#doc\">docs#Singleton</a> for those notations... <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Sep#doc\">docs#Sep</a> should do what you're asking for set builder notation</p>",
        "id": 489897070,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1734591354
    },
    {
        "content": "<p>but for some reason it didn't work when I tried it with your code... perhaps someone else can come along and explain why</p>",
        "id": 489897139,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1734591381
    },
    {
        "content": "<p>I'm not sure that that is what <code>Sep</code> does? That look's like notation for subsets to me.</p>",
        "id": 489897303,
        "sender_full_name": "Daniel James",
        "timestamp": 1734591506
    },
    {
        "content": "<p>ah yeah, nvm then</p>",
        "id": 489897328,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1734591530
    },
    {
        "content": "<p>Making set builder notation for your custom type is not exceedingly hard, but it's definitely on the harder end of the scale of notations.</p>",
        "id": 489914049,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734598603
    },
    {
        "content": "<p>Ok I did it!</p>\n<p>You were right <strong>Yaël Dillies</strong>, it wasn't too hard.</p>\n<p><a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAGQKYEMB2AoDaUiQZzBQGMk4BhAV3xghC0rWADckp8zKsATJAMzgBlJPAAUgRuA4ALjgAVAJ5hOASmkBeOJMBJhHAAKUCGB784HGAHkBAb0kyFSuJQC+cUWBna9BsKpnD4thpGGPjyaDAoAB5wIPIAQsBovFDqiKhoAHQARonJAJK84a4ARNJwpTBsIMoA/CFhEdGiOHipAO7+cZTAADbJqm5QwNDAMPKpABbAAOYTqsVW5THxuWxwSwA+S5VQIEtOpTI79BgAAgDaxwD6SD0oWXAdIl29yQC6GLwCt/cA6p3dPprGTIdAZACidyyGVkVRhVUh9ww6y2AANRIsACSRKTAQrwLaYsBwJzKAA0cCQkSUxEq3HsSBqcDUAD44NwIMj1tzQZlEdDYbsMj8soK9qJAAmEcHRZkscD4jDg2Nx+LggDLCJU+VRUml0hl1FHSjFKnF4pBFGSYgmaknkynUpC0pD0xSM5lsjlc7lpMH8+FCkVi1xSmUiOUKtCuZVmi1KmCqDVE5Tah1Ol1KA1wLZXClXd0+vlQjIwCYGNoAVTQ+EoYEgsGdggaUSwFxQtaujB16GSpjDfA+X17Fj4GU71O7wILGX0IjG+kSOwyla7STYXLRokxeYjJpV5vgiZ8+fRWNNqsJxNJ66NW/lis3Z/3ZSt8ikxwTmtUrKNp73sZfb5VFmNpXoaebfiWZauMoWAAMTEBMjoANZwIsKBlAAcig1roRoADMJIYPBiHEChsoCDu6EyFhB5wLhcB4Vg5rcBQ1C0CAQA\">playground</a></p>\n<p>I still don't fully understand everything happening here but I think I get enough of it.</p>",
        "id": 490022982,
        "sender_full_name": "Daniel James",
        "timestamp": 1734631919
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"607797\">Daniel James</span> has marked this topic as resolved.</p>",
        "id": 490060576,
        "sender_full_name": "Notification Bot",
        "timestamp": 1734647932
    }
]