[
    {
        "content": "<p>This is a discussion thread for <a class=\"stream-topic\" data-stream-id=\"113486\" href=\"/#narrow/channel/113486-announce/topic/Announcing.20Project.20VD.20--.20Value.20Distribution.20Theory\">#announce &gt; Announcing Project VD -- Value Distribution Theory</a></p>",
        "id": 493942814,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1736952102
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"679664\">@Stefan Kebekus</span> there was quite some discussion of meromorphic functions here on zulip. How was your experience formalizing them? Because on the one hand you want to treat them as honest functions that you can evaluate at points, and on the other hand, they are equivalence classes, and they aren't defined everywhere...</p>",
        "id": 493943478,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1736952249
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> I wanted to keep them as functions because I need to integrate. So, I wrote some API for \"continuous extension\". The process takes a meromorphic function f and delivers a function F such that</p>\n<ul>\n<li><code>f</code> and <code>F</code> agree away from a codiscrete set (<code>Filter.codiscreteWithin</code> is the word)</li>\n<li>Near every point <code>x</code>, the function <code>F</code> is either constant zero, or looks like <code>(z-x)^n·g</code>, where <code>g</code> is analytic without zero at <code>z</code>.</li>\n</ul>\n<p>That's what all the source files \"strictlyMeromorphic_…\" are for.</p>\n<p>And then one proves that integrability and value of integrals does not see changes on a codiscrete set.</p>",
        "id": 493944862,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1736952606
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> One trivial thing that I found amazingly difficult is the 'pole/zero order' of a meromorphic function. The order of an analytic function is in ℕ∞, for which there is good API. The order of a meromorphic function is in <code>WithTop ℤ</code>, for which there is hardly any API at all. I lost substantial time before I got things right there. </p>\n<p>We have a meeting with <span class=\"user-mention\" data-user-id=\"385895\">@Jon Eugster</span> and some members of the FRO next week, where I would like to bring this up. There must be a way to automatise things: if you add TOP to an ordered/whatever (semi)ring/whatever, then the WithTop type should inherit some structure that makes life bearable.</p>",
        "id": 493946033,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1736952901
    },
    {
        "content": "<p>Wow, if I'd known about all this I would have asked you to speak at LT2025 :-)</p>",
        "id": 493946691,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1736953055
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> That's another thing: I would really like to have that functions that are mermorphicOn a given set form a ring, so I can talk about units, localization, etc. I plan to also discuss that next week.</p>",
        "id": 493946749,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1736953066
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> Thank you so much (blushing). I am very much a beginner, though … so I thought I better take my time before I embarrass myself stepping into the limelight.</p>",
        "id": 493947131,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1736953153
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"679664\">Stefan Kebekus</span> <a href=\"#narrow/channel/113488-general/topic/Project.20VD.20--.20Value.20Distribution.20Theory/near/493946033\">said</a>:</p>\n<blockquote>\n<p>We have a meeting with @Jon Eugster and some members of the FRO next week, where I would like to bring this up. There must be a way to automatise things: if you add TOP to an ordered/whatever (semi)ring/whatever, then the WithTop type should inherit some structure that makes life bearable.</p>\n</blockquote>\n<p>Why talk to the FRO here? It looks like this is a mathlib problem (quite possibly <em>my</em> problem <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span>)</p>",
        "id": 493952029,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1736954456
    },
    {
        "content": "<p>Because the FRO people are using the Seminar in Freiburg as an excuse to hang out and meet in person and get some free snacks in the tea time, and once we are there I expect there is little that can stop from Stefan from talking to us :-D</p>\n<p>But indeed I expect I’d have little to respond, besides “ask Yaël” :-)</p>",
        "id": 493956039,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1736955548
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> I guess the honest answer to your question is \"Because I joined only recently and have no clue who is in charge of what.\" I am a bit worried that I might have stepped on your toes here. That wasn't my intention, so please accept my apologies if I did.  Do I understand correctly that you are the person I should be talking to when it comes to <code>ℕ∞</code>and <code>WithTop ℤ</code>? I would love to discuss these matters with an expert, as I am struggling to implement the relevant improvements myself.</p>",
        "id": 494076320,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1737009750
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"679664\">@Stefan Kebekus</span>, there's not really any one \"in charge\" of particular pieces of Mathlib. The \"Authors\" line in each file is some combination of \"people you can go to for help\" and \"whoever originally wrote the file\".</p>\n<p>The Mathlib maintainers have final say on whether PRs go in, but they rely extensively on reviewing done by many people. And everyone is welcome, indeed encouraged, to be bold and suggest changes throughout the library. (Of course, if you're new it helps to discuss changes here on zulip ahead of making PRs, and please try to keep PRs to a manageable, reviewable size; we're perpetually bottlenecked by reviewing capacity.)</p>\n<p>Yaël's comment above doesn't mean at all that you are stepping on their toes. Only that they would like to help with this sort of problem. Yaël has done lots of great work refactoring the interactions between the algebra and order hierarchies, so your question is right in their expertise.</p>",
        "id": 494113958,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1737024171
    },
    {
        "content": "<p>It's not that Yaël is necessarily in charge of anything in mathlib in particular, but <code>ask_yael</code> is one of our most cutting-edge general-purpose tactics we have for mathlib. Some would even claim <span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> is a real person<span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span></p>\n<p>In any case, they'd probably have a good insight about what would be the best step to improve the API around <code>WithTop</code>. I have a hunch that it could be a slimple refactor vonsisting of just generalising some lemmas about <code>\\N_\\infty</code>  to a general <code>WithTop</code>, but haven't looked at the code at all yet</p>",
        "id": 494115409,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1737024624
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/113488-general/topic/Project.20VD.20--.20Value.20Distribution.20Theory/near/494113958\">said</a></p>\n<blockquote>\n<p>Yaël's comment above doesn't mean at all that you are stepping on their toes. Only that they would like to help with this sort of problem. Yaël has done lots of great work refactoring the interactions between the algebra and order hierarchies, so your question is right in their expertise.</p>\n</blockquote>\n<p>Yes, exactly. Sorry for being evasive. My toes are safe <span aria-label=\"relieved\" class=\"emoji emoji-1f60c\" role=\"img\" title=\"relieved\">:relieved:</span></p>",
        "id": 494118162,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737025497
    },
    {
        "content": "<p>I am very busy this week (which is why you won't have seen me at Lean Together), but feel free to explain your problems (here or in DM) and I will aim to answer next week</p>",
        "id": 494118529,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737025616
    },
    {
        "content": "<p>Thanks for all your encouraging comments. <span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> I would love to discuss these matters here with you. Please give me a day or two, my day job is calling.</p>",
        "id": 494127648,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1737028832
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span>  Dear Yaël, dear all,</p>\n<p>Thank you for offering to help. As I wrote above, I am a beginner with Lean and just started my first real-world project. Working with analytic and meromorphic functions, I was struck by the difference between <code>ℕ∞</code>and <code>WithTop ℤ</code> (the first appears as the vanishing order of analytic functions, the second as the vanishing/pole order of meromorphic function).  While <code>ℕ∞</code> and <code>ENat.toNat</code>was typically easy to work with, I got stuck with <code>WithTop ℤ</code> where I have to use <code>untop</code> and <code>untop</code>. Typically, I ended up with workarounds that I might do the job but should better not be shown in public. I append a few examples below, but you can also look at the file <code>FLUG/kebekus-Item4.lean</code> in <a href=\"http://FLUG/kebekus-Item4.lean\">this GitHub repo</a> for easier access. Any help is greatly appreciated! Am I overlooking something terribly simple or obvious?</p>\n<p>More conceptually, I wonder if one should implement a method <code>.toBase</code> on any <code>WithTop A</code> where <code>A</code> is an algebraic structure with zero, emulating precisely what <code>toNat</code> does for <code>ℕ∞</code>. Maybe that could even replace <code>toNat</code> entirely? Implementing such a change is perhaps a bit drastic, so I thought I might bring this up here. I'd love to hear your opinion. </p>\n<p>Thanks again · Best wishes,</p>\n<p>Stefan.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">SpecialFunctions</span><span class=\"bp\">.</span><span class=\"n\">Exp</span>\n\n\n<span class=\"c1\">-- # ENat und WithTop ℤ</span>\n\n<span class=\"c1\">-- ## Example 1</span>\n\n<span class=\"c1\">-- I am puzzled. Is it really that complicated?</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">WithTopCoe</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">WithTop</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rcases</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">|</span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"n\">contradiction</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h₁</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">WithTop</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h₁</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Int</span><span class=\"bp\">.</span><span class=\"n\">ofNat_eq_zero</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">WithTop</span><span class=\"bp\">.</span><span class=\"n\">coe_eq_zero</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"n\">h₁</span><span class=\"o\">)]</span>\n<span class=\"w\">    </span><span class=\"n\">rfl</span>\n\n\n<span class=\"c1\">-- ## Example 2</span>\n\n<span class=\"c1\">-- Easy</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">toNat_add</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ENat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">ENat</span><span class=\"bp\">.</span><span class=\"n\">toNat_add</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"n\">hb</span>\n\n\n<span class=\"c1\">-- Complicated. Even the formulation needs a lemma</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">ne_top_add_ne_top</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">tauto</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">untop_add</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">untop</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ne_top_add_ne_top</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"n\">hb</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">untop</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"bp\">.</span><span class=\"n\">untop</span><span class=\"w\"> </span><span class=\"n\">hb</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">WithTop</span><span class=\"bp\">.</span><span class=\"n\">untop_eq_iff</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">WithTop</span><span class=\"bp\">.</span><span class=\"n\">coe_add</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">WithTop</span><span class=\"bp\">.</span><span class=\"n\">coe_untop</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">WithTop</span><span class=\"bp\">.</span><span class=\"n\">coe_untop</span><span class=\"o\">]</span>\n\n\n<span class=\"c1\">-- Unclear to me. Is this easy?</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">untop'_add</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">untop'</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">untop'</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">.</span><span class=\"n\">untop'</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n\n<span class=\"c1\">-- ## Example 3</span>\n\n<span class=\"c1\">-- Easy</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">toNat'_of_ne_top_eq_coe</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ENat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simpa</span>\n\n\n<span class=\"c1\">-- Easy</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">untop_of_ne_top_eq_coe</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">untop</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n\n\n<span class=\"c1\">-- Complicated. Isn't there an easier proof?</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">untop'_of_ne_top_eq_coe</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">WithTop</span><span class=\"bp\">.</span><span class=\"n\">untop'</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">b</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hb</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"bp\">.</span><span class=\"n\">ne_top_iff_exists</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">ha</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">hb</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n\n\n<span class=\"c1\">-- ## Example 4</span>\n\n<span class=\"c1\">-- Unclear to me. Is there an easy proof?</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">untop'_and_untop</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ENat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">untop</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">untop'</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n\n<span class=\"c1\">-- ## Example 5</span>\n\n<span class=\"c1\">-- Easy</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">add_mul_enat</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ENat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">add_one_mul</span><span class=\"o\">]</span>\n\n\n<span class=\"c1\">-- Unclear to me. Is there an easy proof?</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">add_mul_withTop</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 495263162,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1737546378
    },
    {
        "content": "<p>I think a <code>toBase</code> might make sense.</p>\n<p>Here is a proof of the sorry in your codeblock:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">untop'_add</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">untop'</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">untop'</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">.</span><span class=\"n\">untop'</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">WithTop</span><span class=\"bp\">.</span><span class=\"n\">ne_top_iff_exists</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"n\">hb</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ha</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">b</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hb</span>\n<span class=\"w\">  </span><span class=\"n\">norm_cast</span>\n</code></pre></div>",
        "id": 495423608,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1737607767
    },
    {
        "content": "<p>Note that in the <code>obtain</code>, I use a <code>rfl</code> pattern to automatically substitute the old variable. You could use that to slighly simplify the proof of <code>untop'_of_ne_top_eq_coe</code></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">untop'_of_ne_top_eq_coe</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">WithTop</span><span class=\"bp\">.</span><span class=\"n\">untop'</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">b</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"bp\">.</span><span class=\"n\">ne_top_iff_exists</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">ha</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n</code></pre></div>",
        "id": 495423873,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1737607933
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> Thanks! I will come back to you about <code>toBase</code> soon.</p>",
        "id": 495464171,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1737626581
    },
    {
        "content": "<p>It might make sense to assume <code>Inhabited X</code>, which will provide a \"canonical\" element <code>default : X</code>. This will be a bit more agnostic than assuming <code>Zero X</code> and using <code>0 :X</code>.<br>\nFor <code>Nat</code> and <code>Int</code>, the default value is in fact <code>0</code>.</p>",
        "id": 495467989,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1737627614
    },
    {
        "content": "<p>It could be called <code>untopI</code>, or <code>getI</code> (I don't understand the name <code>untop</code>)</p>",
        "id": 495468876,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737627857
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> <span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> Before coming back to <code>toBase</code> (or whatever it will eventually be called), I thought about Example <a href=\"https://github.com/leanprover-community/mathlib4/pull/5\">#5</a> from my little list:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- Easy</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">add_mul_enat</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ENat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">add_one_mul</span><span class=\"o\">]</span>\n\n<span class=\"c1\">-- Unclear to me. Is there an easy proof?</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">add_mul_withTop</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Any attempt to prove the second statement by <code>add_one_mul</code>fails because <code>WithTop ℤ</code> is not known to lean as an instance of <code>RightDistribClass</code>. Looking at the code of mathlib, I was not able to figure out why <code>ENat</code> is an instance and <code>WithTop ℤ</code> is not. Do you have any insight here? Is there an easy fix that declares in instance in all reasonable cases?</p>",
        "id": 495519854,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1737644566
    },
    {
        "content": "<p>The issue is that multiplication in <code>WithTop ℤ</code> has to be badly-behaved: how do you define <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>∗</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">(-1) * \\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span> given that it has to be either an integer, or <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>? The current version in mathlib defines it to be <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span> (while <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>∗</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">0 * \\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span> is defined to be <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>). This means that the identity <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>∗</mo><mi>b</mi><mo>+</mo><mi>b</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>a</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">a * b + b = (a + 1) * b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4653em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> is not true for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">a=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi><mo>=</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">b=\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>, so it's not possible to register a nice typeclass involving multiplication on <code>WithTop ℤ</code>.</p>",
        "id": 495523542,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1737645539
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span> Understood. How upsetting. I should have guessed that. Thanks for your help!</p>",
        "id": 495529667,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1737647088
    },
    {
        "content": "<p>Note that for your use case, where <code>a</code> is a natural number, the lemma is true. But I'm not surprised there is something to prove, and it can not follow from abstract nonsense.</p>",
        "id": 495530030,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1737647164
    },
    {
        "content": "<p>Right. I guess I should spend some thought finding the correct formulation of the lemma I need to prove.</p>",
        "id": 495530333,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1737647242
    },
    {
        "content": "<p>You need <code>WithTop ℤ</code> for the type of pole orders, right? But do you need to multiply those? Usually <code>&lt;</code> and <code>+</code> are what you need, right? There is a whole theory of valuations, and I guess we can try to plug that in here.<br>\nOr am I missing a requirement?</p>",
        "id": 495541998,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1737650321
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> Thanks for coming back to this. Essentially, I need to do arithmetic in <code>WithTop ℤ</code> because I want to multiply/factor/add meromorphic functions and discuss their pole order. That ends up evaluating polynomials  <code>ℤ[x]</code> on <code>x : WithTop ℤ</code>. The simplest example comes up when taking powers of meromorphic functions.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">MeromorphicAt</span><span class=\"bp\">.</span><span class=\"n\">order_pow</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MeromorphicAt</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">z₀</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">pow</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction'</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">hn</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"bp\">.</span><span class=\"n\">coe_zero</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">MeromorphicAt</span><span class=\"bp\">.</span><span class=\"n\">order_eq_int_iff</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">analyticAt_const</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">add_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">pow_add</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">pow</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">order_mul</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Here, <code>MeromorphicAt.add_mul</code> is the following theorem, <a href=\"https://github.com/leanprover-community/mathlib4/pull/21015\">currently submitted as a PR</a>.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Analytic</span><span class=\"bp\">.</span><span class=\"n\">Meromorphic</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">𝕜</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NontriviallyNormedField</span><span class=\"w\"> </span><span class=\"n\">𝕜</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedSpace</span><span class=\"w\"> </span><span class=\"n\">𝕜</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">𝕜</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">𝕜</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">z₀</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">𝕜</span><span class=\"o\">}</span>\n\n<span class=\"sd\">/-- Helper lemma for `MeromorphicAt.order_mul` -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">MeromorphicAt</span><span class=\"bp\">.</span><span class=\"n\">order_of_locallyZero_mul_meromorphic</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MeromorphicAt</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">z₀</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MeromorphicAt</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">z₀</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h'f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"n\">hg</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeromorphicAt</span><span class=\"bp\">.</span><span class=\"n\">order_eq_top_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">eventually_nhdsWithin_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">eventually_nhds_iff</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"bp\">*</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₁t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₂t</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h'f</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">h₁y</span><span class=\"w\"> </span><span class=\"n\">h₂y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Pi</span><span class=\"bp\">.</span><span class=\"n\">mul_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₁t</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">h₁y</span><span class=\"w\"> </span><span class=\"n\">h₂y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">zero_mul</span><span class=\"o\">])</span>\n\n<span class=\"sd\">/-- The order is additive when multiplying meromorphic functions -/</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">MeromorphicAt</span><span class=\"bp\">.</span><span class=\"n\">order_mul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MeromorphicAt</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">z₀</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MeromorphicAt</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">z₀</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"n\">hg</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">hg</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- Trivial cases: one of the functions vanishes around z₀</span>\n<span class=\"w\">  </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h₂f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⊤</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">order_of_locallyZero_mul_meromorphic</span><span class=\"w\"> </span><span class=\"n\">hg</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₂f</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h₂g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">hg</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⊤</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mul_comm</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hg</span><span class=\"bp\">.</span><span class=\"n\">order_of_locallyZero_mul_meromorphic</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₂g</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"c1\">-- Non-trivial case: both functions do not vanish around z₀</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₃f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"bp\">.</span><span class=\"n\">coe_untop</span><span class=\"w\"> </span><span class=\"n\">h₂f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₃g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hg</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"bp\">.</span><span class=\"n\">coe_untop</span><span class=\"w\"> </span><span class=\"n\">h₂g</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h₃f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₃g</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"bp\">.</span><span class=\"n\">coe_add</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">MeromorphicAt</span><span class=\"bp\">.</span><span class=\"n\">order_eq_int_iff</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">F</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₁F</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₂F</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₃F</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">order_eq_int_iff</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"bp\">.</span><span class=\"n\">untop</span><span class=\"w\"> </span><span class=\"n\">h₂f</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">h₃f</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₁G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₂G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₃G</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hg</span><span class=\"bp\">.</span><span class=\"n\">order_eq_int_iff</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hg</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"bp\">.</span><span class=\"n\">untop</span><span class=\"w\"> </span><span class=\"n\">h₂g</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">h₃g</span>\n<span class=\"w\">  </span><span class=\"n\">clear</span><span class=\"w\"> </span><span class=\"n\">h₃f</span><span class=\"w\"> </span><span class=\"n\">h₃g</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₁F</span><span class=\"bp\">.</span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"n\">h₁G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">tauto</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">eventually_nhdsWithin_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">eventually_nhds_iff</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"bp\">*</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₁s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₂s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₃s</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h₃F</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₁t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₂t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₃t</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h₃G</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∩</span><span class=\"w\"> </span><span class=\"n\">t</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">h₁y</span><span class=\"w\"> </span><span class=\"n\">h₂y</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h₁s</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">h₁y</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">h₂y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₁t</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">h₁y</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">h₂y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">zpow_add'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">left</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">sub_ne_zero_of_ne</span><span class=\"w\"> </span><span class=\"n\">h₂y</span><span class=\"o\">)]</span>\n<span class=\"w\">    </span><span class=\"n\">group</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">IsOpen</span><span class=\"bp\">.</span><span class=\"n\">inter</span><span class=\"w\"> </span><span class=\"n\">h₂s</span><span class=\"w\"> </span><span class=\"n\">h₂t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">mem_inter</span><span class=\"w\"> </span><span class=\"n\">h₃s</span><span class=\"w\"> </span><span class=\"n\">h₃t</span><span class=\"bp\">⟩</span>\n</code></pre></div>",
        "id": 495648608,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1737703137
    },
    {
        "content": "<p>Understood. And I agree that it makes sense to multiply <code>n : Nat</code> with <code>x : WithTop Int</code>. But here <code>n</code> is not playing the role of a pole order, it is really a natural number.<br>\nSo it makes sense to define <code>SMul Nat (WithTop Int)</code> (and probably this already exists).<br>\nMy (more precise, hopefully) question is whether one ever needs to multiply two pole orders. My algebraic mind says that this never happens...</p>",
        "id": 495654425,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1737705700
    },
    {
        "content": "<p>Agreed, I cannot think of a setting where one wants to multiply a pole order with infinity. I will come back to the <code>SMul</code> suggestion, but now I have to rush to setup my presentation for our FLUG meeting.</p>",
        "id": 495654720,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1737705836
    },
    {
        "content": "<p>In your first lemma, you're writing <code>(hf.pow n).order = n * hf.order</code>. Here, there is first a cast of the integer <code>n</code> to <code>WithTop ℤ</code>, and the use of the weird multiplication on it. But what you're really using is just that there is an addition on <code>WithTop ℤ</code> (from which an action of natural numbers follows). So I'd try to avoid completely the bogus multiplication on <code>WithTop ℤ</code>, and write your statement instead as <code>(hf.pow n).order = n • hf.order</code>. Hopefully the nat action is always well behaved on <code>WithTop</code> of something, so useful API lemmas should come in.</p>",
        "id": 495654820,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1737705863
    },
    {
        "content": "<p>Johan has been quicker to say the same thing.</p>",
        "id": 495654946,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1737705924
    },
    {
        "content": "<p>Would it make things easier to work in EInt, with in infinities on both sides, for a nicer algebraic structure, and invoking explicit theorems when one needs the fact that -inf is not possible? (A bit like PMFs go to EReal despite guaranteed to be finite)</p>",
        "id": 495655512,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1737706169
    },
    {
        "content": "<p>PMFs don't go to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=EReal#doc\">docs#EReal</a> (?)</p>",
        "id": 495708888,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737723695
    },
    {
        "content": "<p>Ah, my bad then, maybe I misremembered (there was something I tried to do a while ago but abandoned in <a href=\"https://github.com/leanprover-community/mathlib4/pull/7155\">https://github.com/leanprover-community/mathlib4/pull/7155</a>)</p>",
        "id": 495717677,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1737726281
    },
    {
        "content": "<p>Dear all, I am trying to write down the standard estimate for <code>log⁺</code> of a sum of reals, where <code>log⁺</code> is the positive part of the logarithm. There are, however, many ways to say \"(Finset|Fintype).sum\" in Mathlib, and I do not fully understand their differences and pros/cons. Is there a best practice? A formulation that is the easiest to apply? Any hint is greatly appreciated. <span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span> <span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span>: You probably have lots of experience with this; I'd love to hear your opinion.</p>\n<p>Three formulations come to my mind, but I am sure there will be many others.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">logpos_sum₀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">log</span><span class=\"bp\">⁺</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∑</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">∑</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">log</span><span class=\"bp\">⁺</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">logpos_sum₁</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">log</span><span class=\"bp\">⁺</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∑</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">∑</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">log</span><span class=\"bp\">⁺</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">logpos_sum₂</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">log</span><span class=\"bp\">⁺</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∑</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">∑</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">log</span><span class=\"bp\">⁺</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 496941800,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1738307732
    },
    {
        "content": "<p>I would definitely go for the third one, as the other two are particular cases of this one (well, straightforward consequences, rather).</p>",
        "id": 496947114,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1738310242
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span> Thanks, I will follow your advice. See you soon on the PR channel <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 496952886,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1738312499
    },
    {
        "content": "<p>I guess it is high time I come back to <code>WithTop.toBase</code> that we discussed earlier, here and during the last meeting of the Freiburg Lean User Group. To get the subject off the ground, I have made a draft <a href=\"https://github.com/leanprover-community/mathlib4/pull/22821\">PR #22821</a> where you will find the relevant code in <code>Mathlib/Algebra/Order/ToBase.lean</code> [many more simplifier lemmas need to be added. of course]. I guess there will be three main points to discuss:</p>\n<ol>\n<li>Is my draft PR the start of a reasonable implementation, or should I do something else entirely?</li>\n<li>What should the method eventually be called?</li>\n<li>Where should the material eventually be located?</li>\n</ol>\n<p>To keep the discussion from getting confused, I would like to suggest concentrating on Question (1) for now and come back to the other questions once this is settled. Would that be ok?</p>\n<p><span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> <span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span> <span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> (and others) you have so much more experience ... is this a reasonable start?</p>",
        "id": 504781261,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1741684556
    },
    {
        "content": "<p>(Thanks for the flattering ping, but I’ll excuse myself from this, I am really not an expert in mathlib api design.)</p>",
        "id": 504781720,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1741684677
    },
    {
        "content": "<p>To me the design in that PR looks fine. Happy to also hear what <span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> thinks.</p>",
        "id": 504845687,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1741700667
    },
    {
        "content": "<p>Will look tomorrow</p>",
        "id": 504846193,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1741700776
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> <span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span>  Thanks for looking at the PR.I take it from your detailed comments that you feel this is the start of a reasonable implementation. Yaël already suggested a place in math lib where the material could eventually live.</p>",
        "id": 505472343,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1741883995
    },
    {
        "content": "<p>This leaves the question „What should the method be called?“. I suggested <code>WithTop.toBase</code> in analogy to the method <code>ENat.toNat</code> that I have gotten used to. The name is not too long and reasonably descriptive: it maps elements of <code>WithTop BaseType</code> to <code>BaseType</code> in a natural manner.</p>\n<p>Other names that came to my mind were <code>WithTop.toBaseType</code> (too long), or yet another variant of <code>WithTop.untopX</code>. I did not favor the last one because I was not able to come up with a letter X that is descriptive and easy to remember (I never understood what the „D“ is for in <code>untopD</code>). A web search suggests that „to untop“ could be understood as „beheadding“.</p>\n<p>I am sure you have other suggestions, and I would be glad to hear them!</p>",
        "id": 505472903,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1741884129
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"679664\">Stefan Kebekus</span> <a href=\"#narrow/channel/113488-general/topic/Project.20VD.20--.20Value.20Distribution.20Theory/near/505472903\">said</a>:</p>\n<blockquote>\n<p>(I never understood what the „D“ is for in <code>untopD</code>)</p>\n</blockquote>\n<p>The <code>D</code> is for <code>default</code>, and is used a lot (<a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Option.getD#doc\">docs#Option.getD</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.getD#doc\">docs#List.getD</a>, etc.)</p>",
        "id": 505473933,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741884405
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"679664\">Stefan Kebekus</span> <a href=\"#narrow/channel/113488-general/topic/Project.20VD.20--.20Value.20Distribution.20Theory/near/505472903\">said</a>:</p>\n<blockquote>\n<p>it maps elements of <code>WithTop BaseType</code> to <code>BaseType</code> in a natural manner.</p>\n</blockquote>\n<p>isn't <code>BaseType</code> a variable here? I don't think it's a good idea to name a method after an arbitrary variable name... we might just as well name it <code>toX</code>, <code>toFoo</code> or <code>toMyFavouriteTypeVariableName</code> (all of which we shouldn't do, imo.)</p>",
        "id": 505475291,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1741884774
    },
    {
        "content": "<p>How about <code>untop0</code>?</p>",
        "id": 505475468,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741884807
    },
    {
        "content": "<p>Yes, what I personally had in mind was <code>untop₀</code></p>",
        "id": 505476651,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1741885073
    },
    {
        "content": "<p>Thanks for all your help and to <span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span>  for the explanation. I will wait for a little while, at least until this afternoon. If no one speaks up, I will then change the name to <code>untop₀</code> and change the status from \"draft PR\" to \"PR.\"</p>",
        "id": 505597107,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1741934426
    },
    {
        "content": "<p>Done. The PR is ready for final review now. Thanks again.</p>",
        "id": 505691631,
        "sender_full_name": "Stefan Kebekus",
        "timestamp": 1741963123
    }
]