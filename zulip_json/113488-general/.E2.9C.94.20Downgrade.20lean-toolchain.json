[
    {
        "content": "<p>I have a lean repo with lean-toolchain at <code>leanprover/lean4:v4.16.0-rc2</code>. I want to downgrade to <code>v4.15.0</code>. What are the steps to do this? I already tried changing the <code>lean-toolchain</code> by hand and got some scary errors.</p>",
        "id": 496457981,
        "sender_full_name": "Vasily Ilin",
        "timestamp": 1738117347
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 496459029,
        "sender_full_name": "Vasily Ilin",
        "timestamp": 1738118155
    },
    {
        "content": "<ul>\n<li>edit <code>lean-toolchain</code></li>\n<li>make sure that if any dependencies in your lakefile.toml are pinned to tags, those tags are compatible with the new toolchain</li>\n<li>run <code>lake update</code></li>\n</ul>\n<p>(and generally, tell us what the \"scary errors\" actually are :-)</p>",
        "id": 496471795,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1738126995
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"414458\">Vasily Ilin</span> has marked this topic as resolved.</p>",
        "id": 496591344,
        "sender_full_name": "Notification Bot",
        "timestamp": 1738168809
    },
    {
        "content": "<p>I am trying this with a clean repository depending only on Mathlib, where the <code>lean-toolchain</code> version is <code>leanprover/lean4:v4.17.0-rc1</code>. I want to downgrade it to 4.15.0, but whenever I run <code>lake update</code>, it automatically upgrades it back to the original one. There is no lakefile.toml here, so I'm not super sure how to diagnose this. Thanks!</p>",
        "id": 497766660,
        "sender_full_name": "Alex Gu",
        "timestamp": 1738707266
    },
    {
        "content": "<p>Do you have <code>lakefile.lean</code> then?</p>",
        "id": 497766730,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738707304
    },
    {
        "content": "<p>Yeah, it is like this. Do I need to modify it?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lake</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lake</span><span class=\"w\"> </span><span class=\"n\">DSL</span>\n\n<span class=\"n\">package</span><span class=\"w\"> </span><span class=\"bp\">«</span><span class=\"n\">my_project</span><span class=\"bp\">»</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"c1\">-- Settings applied to both builds and interactive editing</span>\n<span class=\"w\">  </span><span class=\"n\">leanOptions</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span>\n<span class=\"w\">    </span><span class=\"bp\">⟨</span><span class=\"ss\">`pp.unicode.fun</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"c1\">-- pretty-prints `fun a ↦ b`</span>\n<span class=\"w\">  </span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"c1\">-- add any additional package configuration options here</span>\n\n<span class=\"n\">require</span><span class=\"w\"> </span><span class=\"n\">mathlib</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">git</span>\n<span class=\"w\">  </span><span class=\"s2\">\"https://github.com/leanprover-community/mathlib4.git\"</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">default_target</span><span class=\"kd\">]</span>\n<span class=\"n\">lean_lib</span><span class=\"w\"> </span><span class=\"bp\">«</span><span class=\"n\">MyProject</span><span class=\"bp\">»</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"c1\">-- add any library configuration options here</span>\n</code></pre></div>",
        "id": 497767557,
        "sender_full_name": "Alex Gu",
        "timestamp": 1738707676
    },
    {
        "content": "<p>Replace the relevant part by</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">require</span><span class=\"w\"> </span><span class=\"n\">mathlib</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">git</span>\n<span class=\"w\">  </span><span class=\"s2\">\"https://github.com/leanprover-community/mathlib4.git\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"s2\">\"v4.15.0\"</span>\n</code></pre></div>\n<p>then run <code>lake update</code> again</p>",
        "id": 497767834,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738707803
    },
    {
        "content": "<p>I see, so without this @ symbol does it automatically require the latest form of Lean?</p>",
        "id": 497767910,
        "sender_full_name": "Alex Gu",
        "timestamp": 1738707841
    },
    {
        "content": "<p>*the form of Lean used by the latest mathlib</p>",
        "id": 497768094,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738707912
    },
    {
        "content": "<p>(they are the same thing except every first few days of the month)</p>",
        "id": 497768140,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738707932
    }
]