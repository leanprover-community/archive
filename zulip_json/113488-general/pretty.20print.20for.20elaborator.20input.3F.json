[
    {
        "content": "<p>We're wondering whether Lean4 has found a solution to the following problem: when copy-pasting pretty printed terms back into a Lean file, they frequently won't resolve (due to missing casts etc). Are there settings for unelaborator and elaborator that make them inverses?<br>\ncc <span class=\"user-mention\" data-user-id=\"411224\">@Amaury Hayat</span> <span class=\"user-mention\" data-user-id=\"715297\">@gwennl</span></p>",
        "id": 459509382,
        "sender_full_name": "Fabian Glöckle",
        "timestamp": 1723218216
    },
    {
        "content": "<p>You could try setting <code>set_option pp.analyze true</code>, which adds in type ascriptions and <code>@</code> annotations. It's not perfect though.</p>",
        "id": 459509781,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1723218347
    },
    {
        "content": "<p>Of course, you can set <code>set_option pp.all true</code>, which should always work, at the cost of having very large terms.</p>",
        "id": 459509942,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1723218402
    },
    {
        "content": "<p>In Lean3 I remember that even <code>pp.all true</code> wouldn't parse back the same; does it now?</p>",
        "id": 459510148,
        "sender_full_name": "Fabian Glöckle",
        "timestamp": 1723218460
    },
    {
        "content": "<p>No, it still doesn't:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"bp\">«</span><span class=\"k\">forall</span><span class=\"bp\">»</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">all</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"bp\">«</span><span class=\"k\">forall</span><span class=\"bp\">»</span><span class=\"w\"> </span><span class=\"c1\">-- forall</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"k\">forall</span><span class=\"w\"> </span><span class=\"c1\">-- error</span>\n</code></pre></div>",
        "id": 459511715,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723218966
    },
    {
        "content": "<p>That's a bug Eric, it's planned to be fixed.</p>",
        "id": 459518311,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1723220872
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"210057\">@Fabian Glöckle</span> I remember there were some bugs in the Lean 3 pretty printer, and it's possible you ran into them.</p>\n<p>In principle, <code>pp.all true</code> should work. Please report any examples where it doesn't.</p>",
        "id": 459518924,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1723221033
    },
    {
        "content": "<p>Also, if <code>pp.analyze true</code> doesn't work, it might be helpful having examples. It's drifted a bit, surely has issues, and has been getting very little attention, but reporting issues about it could help put resources into improving it.</p>",
        "id": 459519526,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1723221236
    },
    {
        "content": "<p>cool, thanks so much!</p>",
        "id": 459521457,
        "sender_full_name": "Fabian Glöckle",
        "timestamp": 1723221919
    }
]