[
    {
        "content": "<p>When I run</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">18</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"w\"> </span><span class=\"n\">new</span><span class=\"w\"> </span><span class=\"n\">WithMathlibFourEighteen</span><span class=\"w\"> </span><span class=\"n\">math</span>\n</code></pre></div>\n<p>I get a repo with toolchain <code>leanprover/lean4:v4.19.0-rc3</code></p>\n<p>Is this right? Is there a way to install a mathlib 4.18 from <code>lake new</code>?</p>",
        "id": 514585785,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1745709843
    },
    {
        "content": "<p>My understanding is that that is indeed \"right\" in the sense that the <code>+leanprover/lean4:v4.18.0</code> is used to decide which version of Lean is being run by Lake when it's being run to make the project, but then <code>math</code> decides that you must mean \"give me bleeding edge mathlib in my project\" and so it makes the project with bleeding edge lean.</p>",
        "id": 514586500,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1745710491
    },
    {
        "content": "<p>Ok, makes sense, still worth fixing IMHO. I opened <a href=\"https://github.com/leanprover/lean4/pull/8123\">lean4#8123</a>. (Notice that it gives the intended toolchain if <code>math</code> isn't provided)</p>",
        "id": 514586629,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1745710598
    },
    {
        "content": "<p>FWIW I think the trick to sort your project out is</p>\n<div class=\"codehilite\" data-code-language=\"Diff\"><pre><span></span><code><span class=\"w\"> </span>[[require]]\n<span class=\"w\"> </span>name = \"mathlib\"\n<span class=\"w\"> </span>scope = \"leanprover-community\"\n<span class=\"gi\">+rev = \"v4.18.0\"</span>\n</code></pre></div>\n<p>(i.e. add <code>rev = ...</code> in your <code>lakefile.toml</code>) and then <code>lake update mathlib</code></p>",
        "id": 514587041,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1745710987
    },
    {
        "content": "<p>oh no that's not right, looks like you also have to manually edit <code>lean-toolchain</code> to <code>leanprover/lean4:v4.18.0</code> before <code>lake update mathlib</code> will work</p>",
        "id": 514587270,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1745711216
    },
    {
        "content": "<p>I've tried it and indeed it looks like the project now has mathlib on tag v4.18.0 (from 1st April)</p>",
        "id": 514587301,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1745711259
    }
]