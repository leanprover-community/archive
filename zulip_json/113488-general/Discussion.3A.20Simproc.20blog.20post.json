[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> and I are <a href=\"#narrow/channel/113486-announce\">currently writing a series of blog posts about simprocs</a> - we'd love to hear if people have suggestions/things they would like to see in the next two posts (which will  1) cover a bit of the internals of <code>simp</code>and  2) give some demos of how to write simprocs). <br>\nThe current drafts are <a href=\"https://github.com/leanprover-community/blog/pull/98\">here</a> and <a href=\"https://github.com/leanprover-community/blog/pull/100\">here</a>.</p>",
        "id": 520537286,
        "sender_full_name": "Paul Lezeau",
        "timestamp": 1748297629
    },
    {
        "content": "<p>Are there any plans for Verso usage in community blogposts?</p>",
        "id": 520641967,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1748344704
    },
    {
        "content": "<p>I suspect people would be happy to switch and write new posts with verso, but no one is excited to take on the work of switching the current site over</p>",
        "id": 520642146,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1748344763
    },
    {
        "content": "<p>(probably adapting the existing posts is easy, it's setting up the CI and boilerplate which is tedious)</p>",
        "id": 520642239,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1748344792
    },
    {
        "content": "<p>I'd be happy to try and set up Verso for the community blog / website but last I looked there wasn't yet enough documentation for me to easily get started. Are there now (public, open-source) examples of Verso sites that we could reference?</p>",
        "id": 520647956,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1748346510
    },
    {
        "content": "<p>Sometimes I'm surprised with how <code>rw</code> is able to perform some rewrites that <code>simp only</code> isn't. Admittedly I haven't read the drafts yet, but I'd be interested to know why if they don't answer this already.</p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>Example</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<p>Consider the following proof.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Vector</span><span class=\"bp\">.</span><span class=\"n\">getElem!_mk</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}[</span><span class=\"n\">Inhabited</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"bp\">.</span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Vector</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"n\">size</span><span class=\"o\">)[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"bp\">!</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"bp\">!</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">getElem!_pos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">size</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Vector</span><span class=\"bp\">.</span><span class=\"n\">getElem_mk</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"k\">else</span>\n<span class=\"w\">      </span><span class=\"c1\">-- simp only [getElem!_neg, h, size]</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">getElem!_neg</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">assumption</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">getElem!_neg</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>\n<p>I would expect that <code>simp only</code> with the necessary information would be able to finish the proof. However, it does not, I need to use <code>rw</code>'s independently.</p>\n</div></div>",
        "id": 520691607,
        "sender_full_name": "Ayhon",
        "timestamp": 1748358393
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"690100\">@Ayhon</span> There are cases where <code>rw</code> works and <code>simp</code> doesn't, related to matching. But in this case it's just that <code>simp</code> cannot prove the hypothesis by <code>simp</code>. Using <code>simp only [not_false_eq_true, getElem!_neg, h, size]</code> works</p>",
        "id": 520692952,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1748358754
    },
    {
        "content": "<p>(which I found using <code>simp? [getElem!_neg, *]</code>)</p>",
        "id": 520693026,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1748358776
    },
    {
        "content": "<p>Hmm, interesting. I assumed that since <code>not_false_eq_true</code> was not used in my previous proof it was not actually needed</p>",
        "id": 520693182,
        "sender_full_name": "Ayhon",
        "timestamp": 1748358827
    },
    {
        "content": "<p>I think it's because of this behavior:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"c1\">-- `P` is rewritten to `False`.</span>\n</code></pre></div>\n<p><code>simp</code> doesn't use <code>¬i &lt; n</code> to rewrite <code>¬i &lt; n</code> to <code>True</code>, but to rewrite <code>i &lt; n</code> to <code>False</code>.</p>",
        "id": 520697752,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1748360035
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"376152\">@Paul Lezeau</span> and <span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span>,  thank you so much for this to the both of you, I'm eagerly awaiting the next ones! If I try to run the examples on the web editor though, I get two problems: <code>Finset.Icc_ofNat_ofNat</code> doesn't seem to exist (I can't find it by grepping mathlib either), and I can't get this one to reduce: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- Works since `simp` can simplify `P ∨ ¬ P` to `True`.</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">↓</span><span class=\"n\">reduceIte</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>(regardless of whether I add <code>[Decidable P]</code> or <code>open Classical</code> to make the decidablity error go away). Here <code>simp only [↓reduceIte]</code> makes no progress.</p>",
        "id": 520699372,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1748360478
    },
    {
        "content": "<p>By default <code>simp</code> does not know <code>P \\/ not P</code> to be true. You need to add something like <code>Decidable.em</code>.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)[</span><span class=\"n\">Decidable</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- Works since `simp` can simplify `P ∨ ¬ P` to `True`.</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">↓</span><span class=\"n\">reduceIte</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Decidable</span><span class=\"bp\">.</span><span class=\"n\">em</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>That works for me</p>",
        "id": 520699665,
        "sender_full_name": "Ayhon",
        "timestamp": 1748360576
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"690100\">Ayhon</span> <a href=\"#narrow/channel/113488-general/topic/Discussion.3A.20Simproc.20blog.20post/near/520699665\">said</a>:</p>\n<blockquote>\n<p>By default <code>simp</code> does not know <code>P \\/ not P</code> to be true.</p>\n</blockquote>\n<p>I know that, hence my surprise. Funnily enough vanilla <code>simp</code> <em>can</em> close the goal, which undermines one of the points of the blog post somewhat</p>",
        "id": 520699796,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1748360624
    },
    {
        "content": "<p>Aaah, sorry, you were copy-pasting from the article</p>",
        "id": 520700129,
        "sender_full_name": "Ayhon",
        "timestamp": 1748360729
    },
    {
        "content": "<p>Yes, I know the goal is provable in general ; )</p>",
        "id": 520700356,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1748360794
    },
    {
        "content": "<p>I had assumed that far, I just thought you were stating that Lean was able to deduce <code>P ∨ ¬ P</code> automatically. However, it's not you but the article which is stating this. There's something amiss then</p>",
        "id": 520701718,
        "sender_full_name": "Ayhon",
        "timestamp": 1748361187
    },
    {
        "content": "<p>Oups, we definitely wanted <code>Decidable.em</code> in the <code>simp only</code> call - thanks for flagging this!<br>\nFor <code>Finset.Icc_ofNat_ofNat</code>, I think we were assuming that <a href=\"https://github.com/leanprover-community/mathlib4/pull/22039\">#22039</a> would get merged before the blog post. <br>\nI'll fix both issues tonight:)</p>",
        "id": 520701745,
        "sender_full_name": "Paul Lezeau",
        "timestamp": 1748361193
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"376152\">Paul Lezeau</span> <a href=\"#narrow/channel/113488-general/topic/Discussion.3A.20Simproc.20blog.20post/near/520701745\">said</a>:</p>\n<blockquote>\n<p>we were assuming that <a href=\"https://github.com/leanprover-community/mathlib4/pull/22039\">#22039</a> would get merged before the blog post.</p>\n</blockquote>\n<p>No one will ever accuse you of being a pessimist <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span></p>",
        "id": 520702161,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1748361306
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"376152\">Paul Lezeau</span> <a href=\"#narrow/channel/113488-general/topic/Discussion.3A.20Simproc.20blog.20post/near/520701745\">said</a>:</p>\n<blockquote>\n<p>we were assuming that <a href=\"https://github.com/leanprover-community/mathlib4/pull/22039\">#22039</a> would get merged before the blog post.</p>\n</blockquote>\n<p>Maybe a maintainer can step in and get it merged? <span aria-label=\"innocent\" class=\"emoji emoji-1f607\" role=\"img\" title=\"innocent\">:innocent:</span></p>",
        "id": 520807427,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1748410719
    },
    {
        "content": "<p>Thanks for writing the blog post!  I did not even know about the existence of simproc before reading this post.  (Simproc is not mentioned in the standard introductory Lean books.)  Is there a way to search for available simproc's?  Searching for \"simproc\" at <a href=\"https://leanprover-community.github.io/mathlib4_docs/\">https://leanprover-community.github.io/mathlib4_docs/</a> returns mostly irrelevant results.</p>",
        "id": 521201335,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1748569153
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"376152\">@Paul Lezeau</span> There seem to be a number of formatting issues in the rendered blog post</p>",
        "id": 561660719,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1764770934
    },
    {
        "content": "<p>Indeed - fixing those now:)</p>",
        "id": 561660856,
        "sender_full_name": "Paul Lezeau",
        "timestamp": 1764770959
    },
    {
        "content": "<p>(it seems like the markdown render I have on my personal laptop doesn't work in the same way as the blog one)</p>",
        "id": 561661111,
        "sender_full_name": "Paul Lezeau",
        "timestamp": 1764771018
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/blog/pull/121\">leanprover-community/blog#121</a> should hopefully fix things</p>",
        "id": 561663378,
        "sender_full_name": "Paul Lezeau",
        "timestamp": 1764771519
    },
    {
        "content": "<p>Probably the <code>lean</code> above <code>structure Simp.State</code> is also unintentional</p>",
        "id": 561678651,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1764774782
    },
    {
        "content": "<p>Indeed, and some of the bullet point lists have gone astray! Will push some more fixes</p>",
        "id": 561702748,
        "sender_full_name": "Paul Lezeau",
        "timestamp": 1764780133
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"123965\">Bryan Gin-ge Chen</span> <a href=\"#narrow/channel/113488-general/topic/Discussion.3A.20Simproc.20blog.20post/near/520647956\">said</a>:</p>\n<blockquote>\n<p>I'd be happy to try and set up Verso for the community blog / website but last I looked there wasn't yet enough documentation for me to easily get started. Are there now (public, open-source) examples of Verso sites that we could reference?</p>\n</blockquote>\n<p>Great Bryan ! I'd be happy to help if that's within my skills; I'd suggest opening a separate topic for that discussion.</p>\n<p>There are some examples of Verso websites at:</p>\n<ul>\n<li><a href=\"https://github.com/leanprover/verso-templates\">https://github.com/leanprover/verso-templates</a></li>\n<li><a href=\"https://github.com/leanprover/verso/tree/main/examples\">https://github.com/leanprover/verso/tree/main/examples</a></li>\n<li><a href=\"https://github.com/leanprover/reference-manual\">https://github.com/leanprover/reference-manual</a></li>\n<li><a href=\"https://github.com/teorth/analysis\">https://github.com/teorth/analysis</a></li>\n</ul>",
        "id": 561707157,
        "sender_full_name": "Emilio Jesús Gallego Arias",
        "timestamp": 1764781165
    },
    {
        "content": "<p>Unfortunately I didn't have enough time for this before I got busy with other things... If I come back to this, I will make a new thread though, thanks!</p>",
        "id": 561712041,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1764782284
    }
]