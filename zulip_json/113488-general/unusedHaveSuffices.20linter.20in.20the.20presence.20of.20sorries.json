[
    {
        "content": "<p>Suppose I have a lemma whose proof uses sorry: then I would like to silence the unusedHaveSuffices linter. MWE:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Batteries</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"w\"> </span><span class=\"c1\">-- Imagine some useful intermediate step.</span>\n<span class=\"w\">  </span><span class=\"c1\">-- Imagine a long and complicated proof, which may depend on other sorries.</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"bp\">#</span><span class=\"n\">lint</span><span class=\"w\"> </span><span class=\"n\">unusedHavesSuffices</span><span class=\"w\"> </span><span class=\"c1\">-- This complains about `this` being unused.</span>\n</code></pre></div>\n<p>This comes up in large projects, like FLT or Carleson: while the project is ongoing, many lemmas will depend on some <code>sorry</code>. At the same time, having intermediate states as a <code>have</code> can be useful (e.g., to check that an intermediate lemma you wrote actually applies in the setting you want it to). If the proof is not yet complete, such have's may be unused.<br>\nI'd argue this is not a useful warning yet: if a lemma is sorry-free, I'd like to see it, but not yet.<br>\n<strong>Impact.</strong> This causes false positives and warning spam when running <code>#lint</code> (or <code>runLinter</code>) in downstream projects like FLT or Carleson. It is one reason I'd not run linters by default. But that means I'm missing out on e.g. the <code>defLemma</code> linter, which is very useful to have.</p>\n<p>(There could be other ways to fix this, such as making runLinter more configurable, allowing to enable or disable specific linters. I'd argue that is orthogonal to this change, and both changes should be made.)</p>",
        "id": 514084716,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1745491394
    },
    {
        "content": "<p>The unused variables linter deactivates itself in the presence of sorries, similar linters should likely all do the same</p>",
        "id": 514093564,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1745493347
    },
    {
        "content": "<p>I think this is a regression, and previously these did silence themselves?</p>",
        "id": 514101751,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1745495797
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110024\">Sebastian Ullrich</span> <a href=\"#narrow/channel/113488-general/topic/unusedHaveSuffices.20linter.20in.20the.20presence.20of.20sorries/near/514093564\">said</a>:</p>\n<blockquote>\n<p>The unused variables linter deactivates itself in the presence of sorries, similar linters should likely all do the same</p>\n</blockquote>\n<p>A similar thing for errors doesn't work correctly anymore in the current release candidate.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/--</span>\n<span class=\"sd\">error: unknown identifier 'bar'</span>\n<span class=\"sd\">---</span>\n<span class=\"sd\">error: unsolved goals</span>\n<span class=\"sd\">hf : 1 = 1</span>\n<span class=\"sd\">‚ä¢ 2 = 2</span>\n<span class=\"sd\">---</span>\n<span class=\"sd\">warning: unused variable `hf`</span>\n<span class=\"sd\">note: this linter can be disabled with `set_option linter.unusedVariables false`</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">bar</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 514127273,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1745501559
    },
    {
        "content": "<p>Thanks for the reports, this should be fixed in <a href=\"https://github.com/leanprover/lean4/pull/8101\">lean#8101</a></p>",
        "id": 514391975,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1745591130
    }
]