[
    {
        "content": "<p>From what I can tell, this type class only appears in <code>Prelude.lean</code>, and no structures are actually ever registered as instances of the class, in <code>lean4</code> or in <code>mathlib</code>. The <code>MonadBacktrack</code> class seems to be completely independent machinery.</p>",
        "id": 489120709,
        "sender_full_name": "Derrik Petrin",
        "timestamp": 1734302112
    },
    {
        "content": "<p>Do you mean the <code>EStateM.Backtrackable</code>? I know it is at least used in <code>EStateM.tryCatch</code> and <code>EStateM.orElse</code> but the only instance of it is the dummy default instance <code>EStateM.nonBacktrackable</code></p>",
        "id": 489121280,
        "sender_full_name": "Niels Voss",
        "timestamp": 1734302591
    },
    {
        "content": "<p>It seems that for any T, we could define an instance <code>EStateM.Backtrackable T T</code> quite easily, but maybe that isn't done for performance reasons, or because it would break <code>IO</code> by causing time-travelling <code>IO.RealWorld</code> tokens</p>",
        "id": 489121490,
        "sender_full_name": "Niels Voss",
        "timestamp": 1734302788
    },
    {
        "content": "<p>Yes, sorry, I meant <code>EStateM.Backtrackable</code>. I wonder if this was something implemented with the idea that it would be used at some point in the future, but that never happened?</p>",
        "id": 489121807,
        "sender_full_name": "Derrik Petrin",
        "timestamp": 1734303131
    },
    {
        "content": "<p>What you describe is what I understood from the code as well.</p>",
        "id": 489121839,
        "sender_full_name": "Derrik Petrin",
        "timestamp": 1734303184
    },
    {
        "content": "<p>It's described <a href=\"https://lean-lang.org/doc/reference/latest/find/?domain=Verso.Genre.Manual.doc&amp;name=EStateM\">in this section of the language reference</a></p>",
        "id": 489264818,
        "sender_full_name": "David Thrane Christiansen",
        "timestamp": 1734362431
    },
    {
        "content": "<p>Is EStateM supposed to be a lean implementation detail, or is it fair game for user code?</p>",
        "id": 489265851,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1734362690
    },
    {
        "content": "<p>Fair game for use code :)</p>",
        "id": 489265926,
        "sender_full_name": "David Thrane Christiansen",
        "timestamp": 1734362705
    },
    {
        "content": "<p>Excellent, that makes <a href=\"https://github.com/leanprover/lean4/pull/3010\">lean4#3010</a> a little more justifiable then :)</p>",
        "id": 489266019,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1734362729
    }
]