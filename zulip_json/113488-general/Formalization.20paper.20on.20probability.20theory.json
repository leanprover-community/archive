[
    {
        "content": "<p>Hi everyone! Last year I formalized the Ionescu-Tulcea theorem and the product of infinitely many probability measures, which is a direct consequence, during an internship with <span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span>. The final piece of code made it to Mathlib this week. I wrote a paper about it, if you have some time to look at it I would be very grateful to have some feedback. This is the first paper I have ever written so I am happy to take any kind of comments.</p>\n<p>Abstract: \"We describe the formalization of the Ionescu-Tulcea theorem, showing the existence of a probability measure on the space of trajectories of a Markov chain, in the proof assistant Lean using the integrated library mathlib. We first present a mathematical proof before exposing the difficulties which arise when trying to formalize it, and how they were overcome. We then build on this work to formalize the construction of the product of an arbitrary family of probability measures.\"</p>\n<p><a href=\"/user_uploads/3121/UEhE0aP2BUrfJU30EkOpWAC8/Etienne-MARION_Ionescu-Tulcea.pdf\">Etienne-MARION_Ionescu-Tulcea.pdf</a></p>",
        "id": 508911550,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1743245798
    },
    {
        "content": "<p>That's great! I will update GibbsMeasure to use your arbitrary product of probability measures</p>",
        "id": 508913399,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1743247391
    },
    {
        "content": "<p>You may also be interested in <a href=\"https://github.com/IBM/FormalML/tree/1bfa4da3e0e88b8d700e96117a3316a189a3b45c/coq/ProbTheory\">this formalization of probability theory</a>, including product measures, in Coq by my previous colleagues <span class=\"user-mention\" data-user-id=\"489369\">@Avi Shinnar</span> and <span class=\"user-mention\" data-user-id=\"497839\">@Barry Trager</span> at IBM.   I think this is the paper: <a href=\"https://ieeexplore.ieee.org/document/9833555\">https://ieeexplore.ieee.org/document/9833555</a></p>\n<p>One reason I mention it is that the authors also formalize a notion of <a href=\"https://github.com/IBM/FormalML/blob/1bfa4da3e0e88b8d700e96117a3316a189a3b45c/coq/ProbTheory/ProductSpaceDep.v\">dependent product measure</a> on a dependent product sigma algebra, which is something interesting you can do in dependent type theory.  (I realize I don't know the details, in particular how you manage the measurability condition on the dependent sum.)</p>",
        "id": 509025846,
        "sender_full_name": "Jason Rute",
        "timestamp": 1743341330
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/113488-general/topic/Formalization.20paper.20on.20probability.20theory/near/509025846\">said</a>:</p>\n<blockquote>\n<p>You may also be interested in <a href=\"https://github.com/IBM/FormalML/tree/1bfa4da3e0e88b8d700e96117a3316a189a3b45c/coq/ProbTheory\">this formalization of probability theory</a>, including product measures, in Coq by my previous colleagues <span class=\"user-mention silent\" data-user-id=\"489369\">Avi Shinnar</span> and <span class=\"user-mention silent\" data-user-id=\"497839\">Barry Trager</span> at IBM.   I think this is the paper: <a href=\"https://ieeexplore.ieee.org/document/9833555\">https://ieeexplore.ieee.org/document/9833555</a></p>\n<p>One reason I mention it is that the authors also formalize a notion of <a href=\"https://github.com/IBM/FormalML/blob/1bfa4da3e0e88b8d700e96117a3316a189a3b45c/coq/ProbTheory/ProductSpaceDep.v\">dependent product measure</a> on a dependent product sigma algebra, which is something interesting you can do in dependent type theory.  (I realize I don't know the details, in particular how you manage the measurability condition on the dependent sum.)</p>\n</blockquote>\n<p>Thank you for the pointer! Indeed it is interesting, the only formalization I had heard of was the one in Isabelle/HOL where there are no dependent types. The main difference of course is that they build a product measure directly instead of proving the more powerful Ionescu-Tulcea theorem first. Unfortunately I cannot access the paper.</p>",
        "id": 509027429,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1743342485
    },
    {
        "content": "<p>The condition that we required in the dependent case can be seen here: <a href=\"https://github.com/IBM/FormalML/blob/master/coq/ProbTheory/ProductSpaceDep.v#L37\">https://github.com/IBM/FormalML/blob/master/coq/ProbTheory/ProductSpaceDep.v#L37</a></p>",
        "id": 509028005,
        "sender_full_name": "Avi Shinnar",
        "timestamp": 1743342869
    },
    {
        "content": "<p>Can you explain a bit more what that line is doing? I have trouble parsing the code.</p>",
        "id": 509028178,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1743342978
    },
    {
        "content": "<p>I think it's saying: given <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi><mo>:</mo><mo stretchy=\"false\">(</mo><mi>i</mi><mo>:</mo><mi>ι</mi><mo stretchy=\"false\">)</mo><mo>→</mo><mi>S</mi><mi>e</mi><mi>t</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">b : (i : \\iota) \\to Set (X_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ι</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>, we require <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>↦</mo><msub><mi>P</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">i \\mapsto P_i(b_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6705em;vertical-align:-0.011em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">↦</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> to be measurable, where <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">P_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> is a probability measure over <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">X_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> (and each <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">b_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> has to be measurable).</p>",
        "id": 509028771,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1743343417
    },
    {
        "content": "<p>Here is also a talk, but I think it only covers the non-dependent versions of the definitions (but it might help for the definitions in that line): <a href=\"https://www.youtube.com/watch?v=TxmWPuki1NI\">https://www.youtube.com/watch?v=TxmWPuki1NI</a></p>\n<div class=\"youtube-video message_inline_image\"><a data-id=\"TxmWPuki1NI\" href=\"https://www.youtube.com/watch?v=TxmWPuki1NI\"><img src=\"https://uploads.zulipusercontent.net/6af7bfe0609c9339208d074ae6943c50934c5d38/68747470733a2f2f692e7974696d672e636f6d2f76692f54786d5750756b69314e492f6d7164656661756c742e6a7067\"></a></div>",
        "id": 509028900,
        "sender_full_name": "Jason Rute",
        "timestamp": 1743343508
    },
    {
        "content": "<p>I wrote the following up just now, but I think <span class=\"user-mention\" data-user-id=\"703970\">@Etienne Marion</span> did a better job summarizing succinctly :-) </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">given</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">space</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">family</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">spaces</span><span class=\"w\"> </span><span class=\"n\">indexed</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">elements</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">X</span>\n<span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">sigma</span><span class=\"w\"> </span><span class=\"n\">algebra</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">over</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">family</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">B</span><span class=\"o\">:</span><span class=\"k\">forall</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">:</span><span class=\"n\">X</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">SigmaAlgebra</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">))</span>\n<span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">probability</span><span class=\"w\"> </span><span class=\"n\">spaces</span><span class=\"w\"> </span><span class=\"n\">psA</span><span class=\"w\"> </span><span class=\"n\">over</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">family</span><span class=\"w\"> </span><span class=\"n\">psB</span><span class=\"w\"> </span><span class=\"n\">over</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">corresponding</span><span class=\"w\"> </span><span class=\"n\">family</span><span class=\"w\"> </span><span class=\"n\">B</span>\n\n<span class=\"n\">we</span><span class=\"w\"> </span><span class=\"n\">require</span><span class=\"w\"> </span><span class=\"n\">that</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">every</span><span class=\"w\"> </span><span class=\"s2\">\"event family\"</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">:</span><span class=\"n\">X</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">event</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)))</span>\n<span class=\"c1\">-- read this as a family of events in the dependent family B indexed by elements in X</span>\n<span class=\"c1\">-- so given a point a in X, it returns the corresponding event in the dependent space (B a)</span>\n<span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">points</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">probability</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">corresponding</span><span class=\"w\"> </span><span class=\"n\">member</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">event</span><span class=\"w\"> </span><span class=\"n\">family</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">B</span>\n<span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">measurable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">domain</span><span class=\"w\"> </span><span class=\"n\">sigma</span><span class=\"w\"> </span><span class=\"n\">algebra</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">provided</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">codomain</span><span class=\"w\"> </span><span class=\"n\">sigma</span><span class=\"w\"> </span><span class=\"n\">algebra</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">borel</span><span class=\"w\"> </span><span class=\"n\">sigma</span><span class=\"w\"> </span><span class=\"n\">algebra</span><span class=\"w\"> </span><span class=\"n\">over</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 509029125,
        "sender_full_name": "Avi Shinnar",
        "timestamp": 1743343672
    },
    {
        "content": "<p>If I understand correctly, you have probability measures for all the <code>Y a</code>, indexed by <code>a : X</code>, and you suppose that they are the values of a <a href=\"https://en.wikipedia.org/wiki/Markov_kernel\">Markov kernel</a>.</p>",
        "id": 509029734,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1743344131
    },
    {
        "content": "<p>However I'm not sure I understand why there is this hypothesis. Does it give you something more general than just having no measurability structure on the index type? (which would amount to pick the discrete <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>-algebra in your code).</p>",
        "id": 509029736,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1743344135
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"350992\">Rémy Degenne</span> <a href=\"#narrow/channel/113488-general/topic/Formalization.20paper.20on.20probability.20theory/near/509029734\">said</a>:</p>\n<blockquote>\n<p>If I understand correctly, you have probability measures for all the <code>Y a</code>, indexed by <code>a : X</code>, and you suppose that they are the values of a <a href=\"https://en.wikipedia.org/wiki/Markov_kernel\">Markov kernel</a>.</p>\n</blockquote>\n<p>So that would be some kind of \"dependent Markov kernel\".</p>",
        "id": 509029877,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1743344278
    },
    {
        "content": "<p>I think the construction in that file is the measure obtained by composing a measure on X and that dependent Markov kernel.</p>",
        "id": 509029954,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1743344333
    }
]