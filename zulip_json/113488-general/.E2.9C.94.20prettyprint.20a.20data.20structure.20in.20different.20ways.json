[
    {
        "content": "<p>Imagine I have a structure that I want to prettyprint in different ways. Alternative serializations (codecs). Is it possible using the Format type?</p>",
        "id": 464025116,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1724240331
    },
    {
        "content": "<p>In the meantime, I found this <a href=\"https://github.com/leanprover/lean4/blob/0edf1bac392f7e2fe0266b28b51c498306363a84/src/Init/Data/Format/Basic.lean#L33-L38\">https://github.com/leanprover/lean4/blob/0edf1bac392f7e2fe0266b28b51c498306363a84/src/Init/Data/Format/Basic.lean#L33-L38</a></p>\n<p>Why having the <code>open Format in</code> before the actual creation of the type Format that would create the namespace?</p>",
        "id": 464489308,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1724364869
    },
    {
        "content": "<p>If you want different ways of printing, you could use:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">MyType</span><span class=\"bp\">.</span><span class=\"n\">toFormat1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MyType</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Format</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">f!</span><span class=\"s2\">\"format 1: {x.whatever}\"</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">MyType</span><span class=\"bp\">.</span><span class=\"n\">toFormat2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MyType</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Format</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">f!</span><span class=\"s2\">\"format 2: {x.whatever}\"</span>\n</code></pre></div>\n<p>etc, or similarly for <code>String</code> and <code>s!</code> if the auto-intelligent-linewrapping provided by <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Std.Format#doc\">docs#Std.Format</a> isn't something you care about</p>",
        "id": 464490100,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1724365283
    },
    {
        "content": "<p>The the auto-intelligent-linewrapping is what I really care about, and I want that for all different serializations. So far, I basically had instantiate <code>ToFormat</code> for my structures.  So it seems the best is to remove the instances and make make one the default used to the <code>Repr</code> instance:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Repr</span><span class=\"w\"> </span><span class=\"n\">MRS</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\"> </span><span class=\"n\">reprPrec</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">f!</span><span class=\"s2\">\"{m.toFormat1}\"</span>\n</code></pre></div>",
        "id": 464510930,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1724372131
    },
    {
        "content": "<p>That sounds sensible to me</p>",
        "id": 464563274,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1724396466
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"121542\">Alexandre Rademaker</span> has marked this topic as resolved.</p>",
        "id": 464759914,
        "sender_full_name": "Notification Bot",
        "timestamp": 1724455047
    }
]