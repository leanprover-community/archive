[
    {
        "content": "<p>Suppose we want to prove a theorem of the form <code>âˆƒx, p x</code>, where <code>DecidablePred p</code>. A proof could be <code>by use solution; decide</code>, where <code>solution</code> is some earlier <code>def</code>. However, this requires the kernel to evaluate <code>solution</code>, which could be really slow in some cases, while the kernel only has to care about its value, not the definition.<br>\nIs there some way to have <code>solution</code> evaluated in native code, and then only give its value to the kernel? I don't want to just hardcode it.</p>",
        "id": 464930541,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1724557558
    },
    {
        "content": "<p>Do you have an example? What's slow: the evaluation of the solution in the kernel, or the decision procedure?</p>",
        "id": 464943382,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1724562737
    },
    {
        "content": "<p>I'm the former case, try %eval</p>",
        "id": 464943417,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1724562793
    },
    {
        "content": "<p>Never used it myself</p>",
        "id": 464943424,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1724562802
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/113488-general/topic/Efficient.20certificate.20generation/near/464943417\">said</a>:</p>\n<blockquote>\n<p>I'm the former case, try %eval</p>\n</blockquote>\n<p>How do you use it? I can't find anything about it</p>",
        "id": 464943500,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1724562855
    },
    {
        "content": "<p>An example is a generation of Pratt primality certificates. <a href=\"https://github.com/leanprover-community/mathlib4/blob/6439ce3f194a2acd309af6831d753e560c46bcf6/Mathlib/NumberTheory/LucasPrimality.lean#L567\">https://github.com/leanprover-community/mathlib4/blob/6439ce3f194a2acd309af6831d753e560c46bcf6/Mathlib/NumberTheory/LucasPrimality.lean#L567</a> uses a special tactic to do this, but I wonder if there's a more general method</p>",
        "id": 464943680,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1724563073
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">Eval</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">eval</span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">3</span>\n<span class=\"w\">  </span><span class=\"c1\">-- now you have `n : Nat := 5`</span>\n</code></pre></div>",
        "id": 465016738,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1724595403
    }
]