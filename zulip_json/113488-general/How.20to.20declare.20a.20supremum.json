[
    {
        "content": "<p>I'm new to Lean. Teaching myself by working through basic theorems with the help of the documentation and CoPilot.</p>\n<p>I'm trying to write a proof for the Nested Interval Property from analysis. This requires identifying the supremum and infinitum of two different sets. I am trying to work with the supremum. I've got this far.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"c1\">--1.4 Consequences of Completeness</span>\n\n<span class=\"c1\">--Theorem 1.4.1</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">}</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">nested_interval_property</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">nested</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">b0_upper_bound</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"o\">):</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"bp\">⋂</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">A_nonempty</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"bp\">.</span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">A_bounded</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BddAbove</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">      </span><span class=\"n\">rintro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">b0_upper_bound</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">a'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">sSup</span><span class=\"w\"> </span><span class=\"n\">A</span>\n</code></pre></div>\n<p>The last line has a \"failed to synthesize\" error. I think that means that Lean doesn't think I have proved that <code>A</code> has a supremum despite the two previous <code>have</code> blocks.</p>\n<p>Usually CoPilot can get me past these syntax errors, but it's going in circles, telling me to import packages and then telling me to remove them again.</p>\n<ol>\n<li>How do I make this line work?</li>\n<li>How could I go about debugging this problem besides asking CoPilot?</li>\n</ol>\n<p>Thanks.</p>",
        "id": 535932249,
        "sender_full_name": "W.P. McNeill",
        "timestamp": 1756076836
    },
    {
        "content": "<p>You can resolve the error by importing the entire mathlib</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"bp\">...</span>\n</code></pre></div>",
        "id": 535932431,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1756077055
    },
    {
        "content": "<p>When initially exploring, it is often a good idea to import the whole thing, because instances might be scattered at places that you are not familiar with yet. Later you can use #min_imports to minimize the import</p>",
        "id": 535932486,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1756077111
    },
    {
        "content": "<p>Oh, and the error isn't because the lean thinks you didn't prove certain things in this case. It is just because it doesn't know how to do sup with Real by only looking at <code>Mathlib.Data.Real.Basic</code>. That operation is defined somewhere else</p>",
        "id": 535932582,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1756077214
    },
    {
        "content": "<p>It should be also noted that <code>sSup</code> is a \"total function with junk value\", meaning that it doesn't require hypothesis to use (non-emptiness or boundedness), but it will give junk output for those edge cases (I think it is 0 for those)</p>",
        "id": 535932671,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1756077341
    },
    {
        "content": "<p><code>import Mathlib</code> fixed it.</p>\n<p>As a rule of thumb, does \"failed to synthesize\" mean I'm missing an import?</p>",
        "id": 535932683,
        "sender_full_name": "W.P. McNeill",
        "timestamp": 1756077358
    },
    {
        "content": "<p>On paper I would write <code>a' = sup A</code>. Is there a best way to write this in Lean at this point?</p>",
        "id": 535932729,
        "sender_full_name": "W.P. McNeill",
        "timestamp": 1756077422
    },
    {
        "content": "<p>\"failed to synthesize\" usually is one of the following things</p>\n<ul>\n<li>Missing import</li>\n<li>It is defined as a <code>def</code> but not and <code>instance</code>, meaning you need to declare the instance locally</li>\n<li>Someone hasn't added it to Mathlib yet</li>\n<li>It is mathematically incorrect</li>\n</ul>",
        "id": 535932744,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1756077449
    },
    {
        "content": "<p>Re imports: No, it might mean that what you want isn't there at all. For example if you try to apply a theorem about groups to the natural numbers then you'll fail to synthesise the fact that they're a group no matter what you import</p>",
        "id": 535932746,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1756077451
    },
    {
        "content": "<p>And as far as Lean in concerned, something is mathematically incorrect if I haven't pulled in the import that tells it that it is correct. That makes sense.</p>",
        "id": 535932822,
        "sender_full_name": "W.P. McNeill",
        "timestamp": 1756077572
    },
    {
        "content": "<p>No I'm not saying that, I'm saying that if Lean's typeclass inference system can't find a claim then this might be because it's not imported and it might be because it's not true.</p>",
        "id": 535933081,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1756077980
    },
    {
        "content": "<p>I should have been more precise. If I get \"failed to synthesize\" for a statement that I'm certain is mathematically correct, one explanation is that it <em>is</em> mathematically correct, but Lean doesn't know that it is because I haven't done the import that allows Lean to know this.</p>",
        "id": 535933213,
        "sender_full_name": "W.P. McNeill",
        "timestamp": 1756078148
    },
    {
        "content": "<p>Regardless, a while ago an <code>AI</code> told me to start with <code>import Mathlib</code> and I forgot. Thanks for reminding me. That's got me unstuck.</p>",
        "id": 535933664,
        "sender_full_name": "W.P. McNeill",
        "timestamp": 1756078695
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"951231\">W.P. McNeill</span> <a href=\"#narrow/channel/113488-general/topic/How.20to.20declare.20a.20supremum/near/535933213\">said</a>:</p>\n<blockquote>\n<p>I should have been more precise. If I get \"failed to synthesize\" for a statement that I'm certain is mathematically correct, one explanation is that it <em>is</em> mathematically correct, but Lean doesn't know that it is because I haven't done the import that allows Lean to know this.</p>\n</blockquote>\n<p>Another explanation is that it is not mathematically correct because the definitions don't mean what you think they mean</p>",
        "id": 535936972,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1756082251
    }
]