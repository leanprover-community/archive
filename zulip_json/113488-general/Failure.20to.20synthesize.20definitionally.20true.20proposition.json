[
    {
        "content": "<p>In the following code, Lean correctly infers the second argument to <code>congrFun</code> but fails to infer the first argument, which is definitionally true and provable with <code>rfl</code>. How come argument inference fails in this case? Is there anything we can do to help Lean infer it?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">WType</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"w\">  </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">ListP</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WType</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">Nat</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"o\">)</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">zW</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">ListP</span><span class=\"bp\">.</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">congrFun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n</code></pre></div>",
        "id": 485698265,
        "sender_full_name": "nrs",
        "timestamp": 1733169131
    },
    {
        "content": "<p>Yes, you write <code>congrFun rfl _</code></p>",
        "id": 485698594,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1733169295
    },
    {
        "content": "<p>There's no algorithm in Lean to try filling in placeholders with arbitrary terms — placeholders only get solved for through unification.</p>",
        "id": 485698730,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1733169358
    },
    {
        "content": "<p>There's no need for <code>congrFun</code> here, <code>theorem zW : Fin n = ListP.p n := rfl</code> suffices.</p>",
        "id": 485698813,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1733169384
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/113488-general/topic/Failure.20to.20synthesize.20definitionally.20true.20proposition/near/485698730\">said</a>:</p>\n<blockquote>\n<p>There's no algorithm in Lean to try filling in placeholders with arbitrary terms — placeholders only get solved for through unification.</p>\n</blockquote>\n<p>ah I see, thank you! Are all cases of successfully inferred arguments in Lean purely due to unification?</p>",
        "id": 485698923,
        "sender_full_name": "nrs",
        "timestamp": 1733169445
    },
    {
        "content": "<p>Yes, for <code>_</code>'s and implicit arguments.</p>",
        "id": 485699076,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1733169510
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/113488-general/topic/Failure.20to.20synthesize.20definitionally.20true.20proposition/near/485699076\">said</a>:</p>\n<blockquote>\n<p>Yes, for <code>_</code>'s and implicit arguments.</p>\n</blockquote>\n<p>I see, thank you for the help!</p>",
        "id": 485699109,
        "sender_full_name": "nrs",
        "timestamp": 1733169531
    },
    {
        "content": "<p>Instance implicit arguments (from square brackets) use typeclass synthesis instead.</p>",
        "id": 485699112,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1733169532
    }
]