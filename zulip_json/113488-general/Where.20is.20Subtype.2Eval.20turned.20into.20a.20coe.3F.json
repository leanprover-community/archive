[
    {
        "content": "<p>For a PR I'm working on, I need to figure out where Subtype.val is turned into a coe. And I realised that I don't know how to answer that question...<br>\nWhat's the tool for that?</p>",
        "id": 451682432,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1721106736
    },
    {
        "content": "<p>Can you <code>#synth Coe (Subtype Nat)</code> or something similar?  (On mobile)</p>",
        "id": 451685045,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1721108561
    },
    {
        "content": "<p>I have not managed to trick <code>#synth</code> into giving me this info</p>",
        "id": 451691864,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1721112871
    },
    {
        "content": "<p>What do you mean by \"turn into a coe\"? It could mean two things</p>",
        "id": 451692121,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1721113000
    },
    {
        "content": "<p>Right -- there's the attribute and the instance</p>",
        "id": 451692159,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1721113023
    },
    {
        "content": "<p>Where is <code>\\u</code> first made to work for <code>Subtype.val</code>.</p>",
        "id": 451692186,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1721113040
    },
    {
        "content": "<p>I know there are two things, but that still doesn't help me figure out where those things are...</p>",
        "id": 451692351,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1721113100
    },
    {
        "content": "<p>It also doesn't help me to figure out which of those things is what you're looking for because I still don't understand the lean 4 coercion system :-) Do you need both for the up arrow to work?</p>",
        "id": 451692439,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1721113166
    },
    {
        "content": "<p>You need the instance to be able to type <code>↑</code>, and the attribute for lean to output the <code>↑</code> back to you</p>",
        "id": 451696437,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1721114786
    },
    {
        "content": "<p>It's <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=subtypeCoe#doc\">docs#subtypeCoe</a> and it uses <code>CoeOut</code> instead of <code>Coe</code></p>",
        "id": 451696540,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1721114840
    },
    {
        "content": "<p>I don't understand the difference</p>",
        "id": 451696562,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1721114847
    },
    {
        "content": "<p>According to my superficial understanding, <code>Coe (Subtype p) α</code> looks at <code>α</code> and finds <code>Subtype p</code>, and <code>CoeOut (Subtype p) α</code> looks at <code>Subtype p</code> and finds <code>α</code>. But the former isn't possible, so the latter it is.</p>",
        "id": 451697669,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1721115200
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/stream/113488-general/topic/Where.20is.20Subtype.2Eval.20turned.20into.20a.20coe.3F/near/451696540\">said</a>:</p>\n<blockquote>\n<p>It's <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=subtypeCoe#doc\">docs#subtypeCoe</a> and it uses <code>CoeOut</code> instead of <code>Coe</code></p>\n</blockquote>\n<p>Awesome! Thanks for finding this for me</p>",
        "id": 451698626,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1721115539
    },
    {
        "content": "<p>I used loogle <code>\"Coe\", Subtype</code></p>",
        "id": 451698679,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1721115567
    },
    {
        "content": "<p>My next question is: why is this coe not found in <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/9945993507/job/27475513441?pr=14769\">https://github.com/leanprover-community/mathlib4/actions/runs/9945993507/job/27475513441?pr=14769</a></p>",
        "id": 451699144,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1721115737
    },
    {
        "content": "<p>That's not the issue</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">mono_coe</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Preorder</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Monotone</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"bp\">↑</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"c1\">-- works</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">id</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">mono_coe'</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Preorder</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Monotone</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"bp\">↑</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"c1\">-- fails</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">id</span>\n</code></pre></div>",
        "id": 451702355,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1721116990
    },
    {
        "content": "<p>And  the docstring for <code>Mathlib.Tactic.Coe</code> has</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Defines</span><span class=\"w\"> </span><span class=\"n\">notations</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">coercions</span><span class=\"bp\">.</span>\n<span class=\"mf\">1.</span><span class=\"w\"> </span><span class=\"bp\">`↑</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">defined</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">core</span><span class=\"bp\">.</span>\n<span class=\"mf\">2.</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"bp\">↑</span><span class=\"o\">)</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">equivalent</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">eta</span><span class=\"bp\">-</span><span class=\"n\">reduction</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"bp\">↑</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"o\">)</span><span class=\"bp\">`</span>\n</code></pre></div>",
        "id": 451702417,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1721117028
    },
    {
        "content": "<p>I pushed the import</p>",
        "id": 451702635,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1721117099
    },
    {
        "content": "<p>Aah, very good find!</p>",
        "id": 451705243,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1721118030
    },
    {
        "content": "<p>Awesome! CI is now happy with</p>\n<blockquote>\n<p>chore(Data/Bool): merge Init.Data.Bool.* into Data.Bool.Basic <a href=\"https://github.com/leanprover-community/mathlib4/pull/14769\">#14769</a></p>\n</blockquote>",
        "id": 451722193,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1721123238
    }
]