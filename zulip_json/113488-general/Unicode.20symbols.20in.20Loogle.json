[
    {
        "content": "<p>One thing I've noticed using loogle is that I often want to search for expressions using special characters, as in <code>_ \\in _</code> or <code>_ \\le _</code> or <code>_\\inv</code>. Is there any mechanism for including such characters in loogle? Failing that, is there an easy way to look up the actual (ASCII) function for a special character?</p>",
        "id": 433123200,
        "sender_full_name": "Jeremy Kahn",
        "timestamp": 1713090241
    },
    {
        "content": "<p>I just write stuff in VS Code and then copy-paste.</p>",
        "id": 433124151,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1713091148
    },
    {
        "content": "<p>Or <a href=\"http://live.lean-lang.org\">live.lean-lang.org</a> if you don't have a browser.<br>\nI doubt it's easy to add that functionality to the Loogle webpage. One argument in favor of vscode-integrated Loogle search, so you might try that extension!</p>",
        "id": 433124674,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1713091774
    },
    {
        "content": "<p>You might want to try <a href=\"https://github.com/arthurpaulino/chrome-lean-unicode\">https://github.com/arthurpaulino/chrome-lean-unicode</a></p>",
        "id": 433124774,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1713091882
    },
    {
        "content": "<p>Yes, <span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> 's suggestion is pure genius! I don't know why I didn't think of that. Maybe it's a matter of learning to look for workarounds. <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span></p>",
        "id": 433124839,
        "sender_full_name": "Jeremy Kahn",
        "timestamp": 1713091950
    },
    {
        "content": "<p>Oh, nice. <span class=\"user-mention\" data-user-id=\"451983\">@Arthur Paulino</span> , do you think you could make a variant of that that websites could embed and enable for specific text input fields?</p>",
        "id": 433124872,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1713092005
    },
    {
        "content": "<p>Also you can spell out <code>Inv.inv</code>, for example</p>",
        "id": 433125612,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1713092725
    },
    {
        "content": "<p>Is there a nice way to look up the official name for a function from its unicode infix or suffix?</p>",
        "id": 433125720,
        "sender_full_name": "Jeremy Kahn",
        "timestamp": 1713092820
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> <span class=\"user-mention\" data-user-id=\"451983\">@Arthur Paulino</span> I installed the extension, and now I can get ∈ and α in the Zulip chat. I added \"<a href=\"https://loogle.lean-lang.org\">https://loogle.lean-lang.org</a>\" to the list of covered websites, and the icon appears as green, but it doesn't seem to work in the loogle entry field.</p>",
        "id": 433125984,
        "sender_full_name": "Jeremy Kahn",
        "timestamp": 1713093036
    },
    {
        "content": "<p>Would it be useful if the lean elaborator simply understood <code>\\in</code> just like corresponding symbol, so that ASCII input works? Would require the parser or elaborator to know the list of abbreviations, and is a bit of a layering violation, but would be useful in a few places (e.g. on the command line).  (Not sure, just thinking out loudly)</p>",
        "id": 433125996,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1713093045
    },
    {
        "content": "<p>Maybe the extension only works in text areas, not input fields?</p>",
        "id": 433126020,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1713093063
    },
    {
        "content": "<p>the leader key isn't always <code>\\</code></p>",
        "id": 433126276,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1713093325
    },
    {
        "content": "<p>plus, that would cause problems for string escapes like <code>\\n</code> (which I always have to convince the extension to not replace with <code>¬</code>)</p>",
        "id": 433126356,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1713093384
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"432565\">Jeremy Kahn</span> <a href=\"#narrow/stream/113488-general/topic/Unicode.20symbols.20in.20Loogle/near/433125720\">said</a>:</p>\n<blockquote>\n<p>Is there a nice way to look up the official name for a function from its unicode infix or suffix?</p>\n</blockquote>\n<p>If you just type <code>#check x \\in y</code> or similar in the editor you can ctrl-click on the symbol to go to the definition</p>",
        "id": 433126466,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1713093502
    },
    {
        "content": "<p>ditto if you see it in existing code in either docgen or mathlib</p>",
        "id": 433126501,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1713093556
    },
    {
        "content": "<p>I tried adding that feature in the extension. But it is painful to get it right</p>",
        "id": 433159673,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1713123648
    },
    {
        "content": "<p>On the positive side, I do the copy paste thing easily because I am already in vscode</p>",
        "id": 433159694,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1713123675
    },
    {
        "content": "<p>If someone's willing to contribute this feature, PRs to the loogle extension repo are welcome</p>",
        "id": 433159762,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1713123729
    },
    {
        "content": "<p>Sorry, I don't have the time to debug <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span></p>",
        "id": 433184711,
        "sender_full_name": "Arthur Paulino",
        "timestamp": 1713145955
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span> I do think it would be helpful for loogle to understand escape sequences in the input field. But not really necessary given the cut-and-paste option and other workarounds (including the loogle bot in Zulip).</p>",
        "id": 433789758,
        "sender_full_name": "Jeremy Kahn",
        "timestamp": 1713364833
    },
    {
        "content": "<p>I fully agree! I think the best course of action is if someone can generalize <a href=\"https://github.com/arthurpaulino/chrome-lean-unicode\">https://github.com/arthurpaulino/chrome-lean-unicode</a> to a library that a website can embed, then loogle can use it.</p>",
        "id": 433819869,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1713368578
    },
    {
        "content": "<p>I would like to make a bug report, if you go to <a href=\"https://loogle.lean-lang.org\">https://loogle.lean-lang.org</a> and type <code>\\|- Fact (Nat.Prime 2)</code>, then you'll find the result, but then if you go back and delete <code>⊢ </code> and then type it again (<code>\\|- </code>), then you'll find <code>&lt;input&gt;:1:1: expected token</code> because somehow a NBSP (U+00A0) was inserted</p>",
        "id": 528515531,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752397007
    },
    {
        "content": "<p>Hmm, couldn’t reproduce with Firefox on Linux</p>",
        "id": 528515821,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1752397331
    },
    {
        "content": "<p>I think you could probably use this: <a href=\"https://github.com/leanprover/vscode-lean4/tree/master/lean4-unicode-input-component\">https://github.com/leanprover/vscode-lean4/tree/master/lean4-unicode-input-component</a></p>",
        "id": 528517431,
        "sender_full_name": "Alexander Bentkamp",
        "timestamp": 1752399207
    },
    {
        "content": "<p>Loogle is using <a href=\"https://www.npmjs.com/package/@leanprover/unicode-input-component\">https://www.npmjs.com/package/@leanprover/unicode-input-component</a> (but an old version it seems)</p>",
        "id": 528518463,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1752400440
    },
    {
        "content": "<p>I get this nbsp bug in about 50% of my loogle queries (chrome on windows)</p>",
        "id": 528518588,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1752400582
    },
    {
        "content": "<p>I get it always when copy-pasting from somewhere else. I've learned to delete all dots and writing them back</p>",
        "id": 528518648,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1752400639
    },
    {
        "content": "<p>by dots do you mean spaces?</p>",
        "id": 528518663,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1752400653
    },
    {
        "content": "<p>Yes, sorry</p>",
        "id": 528518676,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1752400667
    },
    {
        "content": "<p>I don’t expect updating will change anything around that:<br>\n<a href=\"https://github.com/leanprover/vscode-lean4/commits/master/lean4-unicode-input\">https://github.com/leanprover/vscode-lean4/commits/master/lean4-unicode-input</a></p>\n<p>I know about an issue with pasting NBSP, but <span class=\"user-mention\" data-user-id=\"110064\">@Kenny Lau</span> describes typing, so it's probably different?</p>",
        "id": 528518730,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1752400727
    },
    {
        "content": "<p>Can't reproduce in Firefox, but can reproduce in Chromium:</p>\n<ol>\n<li>Type or paste <code>Fact (Nat.Prime 2)</code> into the text box</li>\n<li>Move cursor to the beginning</li>\n<li>Type <code>\\|-&lt;spacebar&gt;</code></li>\n<li>The space will be a <code>&amp;nbsp;</code></li>\n</ol>\n<p>As far as I can tell, Chromium turns a trailing space in the contexteditable div into a <code>&amp;nbsp;</code>. Typing further characters after the <code>&amp;nbsp;</code> turns it into a normal space again. However, this doesn't always work properly. Firefox, on the other hand, doesn't use <code>&amp;nbsp;</code> in the first place. You can observe this by inspecting the contenteditable div in the dev tools and seeing it update as you type.</p>\n<p>Maybe the reason for the in-line <code>&amp;nbsp;</code> is the following:</p>\n<ol>\n<li>User starts typing unicode input with <code>\\</code></li>\n<li>The unicode input characters are wrapped in a <code>&lt;ul&gt;</code></li>\n<li>When the user enters a space to complete the input sequence, it's a trailing space inside the <code>&lt;ul&gt;</code> element, so chrome turns it into a <code>&amp;nbsp;</code></li>\n<li>However, the unicode input characters are now replaced with the corresponding unicode character, and the <code>&lt;ul&gt;</code> removed</li>\n<li>The <code>&amp;nbsp;</code> at the end of the <code>&lt;ul&gt;</code> now finds itself in the middle of the original <code>&lt;div&gt;</code>, but is not promoted into a space because that only happens when the user inserts or removes a character</li>\n</ol>",
        "id": 528522669,
        "sender_full_name": "Joscha Mennicken",
        "timestamp": 1752405157
    },
    {
        "content": "<p>In short, inserting a unicode character using <code>\\</code> before any existing text will trigger the bug, and continuing to type immediately after will remove the NBSP again.</p>",
        "id": 528522793,
        "sender_full_name": "Joscha Mennicken",
        "timestamp": 1752405273
    },
    {
        "content": "<p>is this why loogle randomly rejects my input sometimes?</p>",
        "id": 528529622,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752413055
    },
    {
        "content": "<p>My suggestion is, in the preprocess code of Loogle, just replace every Unicode character categorized as space (including but not limited to <code>\\r</code>, <code>\\n</code>, <code>\\t</code>) to <code>\\x20</code>.</p>",
        "id": 528540005,
        "sender_full_name": "Jz Pan",
        "timestamp": 1752423722
    },
    {
        "content": "<p>I think a weaker approach of</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">doLoogle</span><span class=\"w\"> </span><span class=\"n\">origStr</span><span class=\"w\"> </span><span class=\"bp\">&lt;|&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">do</span><span class=\"w\"> </span><span class=\"n\">doLoogle</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">replaceNbsp</span><span class=\"w\"> </span><span class=\"n\">origStr</span><span class=\"o\">)</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"s2\">\"warning: ignoring nbsp\"</span>\n</code></pre></div>\n<p>would be safer</p>",
        "id": 528540135,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1752423834
    },
    {
        "content": "<p>I don't think there's any need to replace any other space characters</p>",
        "id": 528540172,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1752423856
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"421885\">Joscha Mennicken</span> <a href=\"#narrow/channel/113488-general/topic/Unicode.20symbols.20in.20Loogle/near/528522669\">said</a>:</p>\n<blockquote>\n<p>but can reproduce in Chromium:</p>\n</blockquote>\n<p>This is <a href=\"https://issues.chromium.org/issues/41067523\">https://issues.chromium.org/issues/41067523</a></p>",
        "id": 528540285,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1752423928
    },
    {
        "content": "<p>Somehow this rings a bell. I vaguely remember that <span class=\"user-mention\" data-user-id=\"221921\">@Marc Huisinga</span> dealt with this at some point?</p>",
        "id": 528675856,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1752503500
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"366779\">Jz Pan</span> <a href=\"#narrow/channel/113488-general/topic/Unicode.20symbols.20in.20Loogle/near/528540005\">schrieb</a>:</p>\n<blockquote>\n<p>My suggestion is, in the preprocess code of Loogle, just replace every Unicode character categorized as space (including but not limited to <code>\\r</code>, <code>\\n</code>, <code>\\t</code>) to <code>\\x20</code>.</p>\n</blockquote>\n<p>This may be the easiest, maybe somewhere near<br>\n<a href=\"https://github.com/nomeata/loogle/blob/e086424b48662fc2473ebe697099f710ff4b737e/server.py#L302\">https://github.com/nomeata/loogle/blob/e086424b48662fc2473ebe697099f710ff4b737e/server.py#L302</a></p>",
        "id": 528676125,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1752503574
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/113488-general/topic/Unicode.20symbols.20in.20Loogle/near/528518588\">said</a>:</p>\n<blockquote>\n<p>I get this nbsp bug in about 50% of my loogle queries (chrome on windows)</p>\n</blockquote>\n<p>and I thought this was just me doing something wrong <span aria-label=\"face palm\" class=\"emoji emoji-1f926\" role=\"img\" title=\"face palm\">:face_palm:</span></p>",
        "id": 528678690,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1752504342
    },
    {
        "content": "<p>I have another similar bug report (this time might not be only on Chromium!):</p>\n<ol>\n<li>Copy the string \"Nat.Prime,  ZMod\" (with two spaces in the middle)</li>\n<li>Go to <a href=\"https://loogle.lean-lang.org\">https://loogle.lean-lang.org</a></li>\n<li>Paste the string and search</li>\n<li>Notice that how it says <code>&lt;input&gt;:1:10: expected token</code>, and that the URL magically now contains <code>%C2%A0</code> (nbsp) again</li>\n</ol>",
        "id": 528858735,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752585334
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/channel/113488-general/topic/Unicode.20symbols.20in.20Loogle/near/528676125\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"366779\">Jz Pan</span> <a href=\"#narrow/channel/113488-general/topic/Unicode.20symbols.20in.20Loogle/near/528540005\">schrieb</a>:</p>\n<blockquote>\n<p>My suggestion is, in the preprocess code of Loogle, just replace every Unicode character categorized as space (including but not limited to <code>\\r</code>, <code>\\n</code>, <code>\\t</code>) to <code>\\x20</code>.</p>\n</blockquote>\n<p>This may be the easiest, maybe somewhere near<br>\n<a href=\"https://github.com/nomeata/loogle/blob/e086424b48662fc2473ebe697099f710ff4b737e/server.py#L302\">https://github.com/nomeata/loogle/blob/e086424b48662fc2473ebe697099f710ff4b737e/server.py#L302</a></p>\n</blockquote>\n<p>Maybe we can just do it on the client side using js</p>",
        "id": 528860039,
        "sender_full_name": "Jz Pan",
        "timestamp": 1752585661
    },
    {
        "content": "<p>I’ll just do it in <code>server.py</code>, or anything wrong with that?</p>",
        "id": 528860166,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1752585700
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/channel/113488-general/topic/Unicode.20symbols.20in.20Loogle/near/528860166\">said</a>:</p>\n<blockquote>\n<p>I’ll just do it in <code>server.py</code>, or anything wrong with that?</p>\n</blockquote>\n<p>That's also OK but you need to deploy it, which is a little bit more involved IMHO</p>",
        "id": 528860985,
        "sender_full_name": "Jz Pan",
        "timestamp": 1752585901
    },
    {
        "content": "<p>I’d have to deploy the frontend as well, but also touch JS :-)</p>",
        "id": 528868348,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1752587978
    },
    {
        "content": "<p>Pushed a fix, mostly untested. Better now?</p>",
        "id": 528874440,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1752589698
    },
    {
        "content": "<p>thanks!</p>",
        "id": 528891232,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752594423
    },
    {
        "content": "<p>Thank you! It works.</p>",
        "id": 528897901,
        "sender_full_name": "Jz Pan",
        "timestamp": 1752596509
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/channel/113488-general/topic/Unicode.20symbols.20in.20Loogle/near/528675856\">said</a>:</p>\n<blockquote>\n<p>Somehow this rings a bell. I vaguely remember that <span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> dealt with this at some point?</p>\n</blockquote>\n<p>That was another issue on Firefox IIRC</p>",
        "id": 529872970,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1753098225
    }
]