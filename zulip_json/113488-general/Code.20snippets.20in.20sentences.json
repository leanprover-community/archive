[
    {
        "content": "<p>How can we make code snippets look good in sentences? Example:</p>\n<p>We write <code>f x</code> because we ...</p>\n<p>It somehow looks good here in Zulip, but when I write a similar thing in Word or LaTeX, it ends up looking horrible. Instead of \"f x\" looking connected, it optically groups \"write f\" together and \"x because\" together. Absolutely disgusting!</p>\n<p>The problem is, obviously, that spaces in a monospace font are wider than spaces in normal text.<br>\nWhat can we do about it? A few options came to my mind...</p>\n<ol>\n<li>Make the space before/after a code snippet at least as wide as a monospace space.</li>\n<li>Not use a true monospace for code snippets in text but modify the font to have a narrower space. Keep true monospace only for code in a display mode.</li>\n<li>Add a background color (probably very light gray) to the code snippets. To be effective, however, the background color must extend slightly to the sides of the code snippets (and only the white part of the space before/after a code snippet is a standard space), which partially includes the first suggestion (results in a wider gap in total).</li>\n<li>Add a frame (rectangle) around the code snippet.</li>\n</ol>\n<p>A disadvantage of (1) and (4) is that it looks weird. I don't know if I would get used to it if I saw it often.</p>\n<p>A disadvantage of (2) is that it make code snippets look differently in sentence vs in display mode, and most texts need to combine both versions. As long as the font looks identical otherwise, it is hopefully acceptable?</p>\n<p>A disadvantage of (3) is that it limits how we can use lexical highlighting inside a code block because we have less available contrast between the color of the background and possible colors that we can use for characters (without adding white as a feasible option for characters). Moreover, certain combinations of placement of code snippets in consecutive lines start to look slightly weird.</p>\n<p>What do you think?</p>",
        "id": 540572526,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1758360126
    },
    {
        "content": "<p>These are solutions waiting for a problem.</p>",
        "id": 540586941,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1758376015
    },
    {
        "content": "<p>This is what I did in my thesis:<br>\n<a href=\"/user_uploads/3121/M-KdddPbe6fgJtWAebCJdWtF/da7c2241-19c5-4a38-8b02-9a5fffb044a2.png\">da7c2241-19c5-4a38-8b02-9a5fffb044a2.png</a><br>\n<a href=\"/user_uploads/3121/2rxz0iM1WXS0pTW8hwsYbXab/b2d6bc20-36ff-46b5-a1f2-edcb5bb4b1ec.png\">b2d6bc20-36ff-46b5-a1f2-edcb5bb4b1ec.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/M-KdddPbe6fgJtWAebCJdWtF/da7c2241-19c5-4a38-8b02-9a5fffb044a2.png\" title=\"da7c2241-19c5-4a38-8b02-9a5fffb044a2.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1080x245\" src=\"/user_uploads/thumbnail/3121/M-KdddPbe6fgJtWAebCJdWtF/da7c2241-19c5-4a38-8b02-9a5fffb044a2.png/840x560.webp\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/2rxz0iM1WXS0pTW8hwsYbXab/b2d6bc20-36ff-46b5-a1f2-edcb5bb4b1ec.png\" title=\"b2d6bc20-36ff-46b5-a1f2-edcb5bb4b1ec.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1080x606\" src=\"/user_uploads/thumbnail/3121/2rxz0iM1WXS0pTW8hwsYbXab/b2d6bc20-36ff-46b5-a1f2-edcb5bb4b1ec.png/840x560.webp\"></a></div><p>(I needed two colors, one for Lean 3 and one for Lean 4)</p>",
        "id": 540591971,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1758381093
    },
    {
        "content": "<p>But along the lines of what Jireh says, this is ultimately not that interesting a question, because either a journal will have thought of this and made their own decision, or will not and will mangle code snippets horribly whatever you do.</p>",
        "id": 540592046,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1758381175
    },
    {
        "content": "<p>Well, sometimes we are in charge of our own typesetting (in my case, for my Ph.D. thesis).</p>",
        "id": 540599779,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1758388607
    },
    {
        "content": "<p>Have you considered using Typst?</p>",
        "id": 540617362,
        "sender_full_name": "Gavin Zhao",
        "timestamp": 1758408997
    },
    {
        "content": "<p>No. Should I?</p>\n<p>Does it have better defaults for code snippets? Or is it easier to setup the style I want to have?</p>",
        "id": 540664836,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1758468613
    },
    {
        "content": "<p>Yes, you should definitely try it out! You write it like Markdown with backticks and it automatically renders code snippets as you expect how it would render in Markdown, example here: <a href=\"https://typst.app/docs/reference/text/raw/\">https://typst.app/docs/reference/text/raw/</a></p>",
        "id": 540695115,
        "sender_full_name": "Gavin Zhao",
        "timestamp": 1758501932
    },
    {
        "content": "<p>(also with reasonable syntax highlighting for Lean snippets)</p>",
        "id": 540695131,
        "sender_full_name": "Gavin Zhao",
        "timestamp": 1758501951
    },
    {
        "content": "<p>I don't think the example they provided looks good.</p>",
        "id": 540718266,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1758523160
    },
    {
        "content": "<p>As far as I know, typst has no easy way for inline code blocks with all three of these properties:</p>\n<ul>\n<li>background color</li>\n<li>rounded corners</li>\n<li>line wrapping</li>\n</ul>\n<p>mostly due to <a href=\"https://github.com/typst/typst/issues/2939\">https://github.com/typst/typst/issues/2939</a>. Sacrificing rounded corners or line wrapping makes the other two properties possible. Adding extra space around inline code blocks is easy.</p>",
        "id": 540750851,
        "sender_full_name": "Joscha Mennicken",
        "timestamp": 1758533261
    },
    {
        "content": "<p>I never use automatic line wrapping, but thanks for the info.<br>\nThank you for further reïnforcing my decision to not use Typst.</p>",
        "id": 540759517,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1758535692
    },
    {
        "content": "<p>By line wrapping, I mean an inline code block that wraps over one or more line breaks.</p>",
        "id": 540759875,
        "sender_full_name": "Joscha Mennicken",
        "timestamp": 1758535803
    },
    {
        "content": "<p>Yes — in such a case, I either rephrase the sentence so that it stays in a single line, or I change it to display mode.</p>",
        "id": 540760662,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1758536065
    },
    {
        "content": "<p>As opposed to inserting a continuation zigzag as I do above?</p>",
        "id": 540761030,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1758536184
    },
    {
        "content": "<p>Yes.</p>",
        "id": 540761076,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1758536200
    },
    {
        "content": "<p>In that case, typst is easy to make look good.</p>",
        "id": 540761250,
        "sender_full_name": "Joscha Mennicken",
        "timestamp": 1758536262
    },
    {
        "content": "<p>Oh!</p>",
        "id": 540761294,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1758536276
    },
    {
        "content": "<p>See <a href=\"https://typst.app/project/rcn8LqfZSSvQYGohluxTAA\">https://typst.app/project/rcn8LqfZSSvQYGohluxTAA</a> for a few possible ways to style code blocks in typst</p>",
        "id": 540761799,
        "sender_full_name": "Joscha Mennicken",
        "timestamp": 1758536450
    },
    {
        "content": "<p>Looks good! Thanks.</p>",
        "id": 540762435,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1758536661
    },
    {
        "content": "<p>One things I noticed is that Zulip still makes the space inside a code snippet wider than the space before/after a code snippet, but thanks to the gray background, it doesn't look too disturbing. Behold (zoomed in):<br>\n<a href=\"/user_uploads/3121/mwJRZlrkJwsinzHnqPJZnFtS/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/mwJRZlrkJwsinzHnqPJZnFtS/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1286x337\" src=\"/user_uploads/thumbnail/3121/mwJRZlrkJwsinzHnqPJZnFtS/image.png/840x560.webp\"></a></div><p>For my Ph.D. thesis, however, I didn't want a non-white background, so I essentially followed the approach (2). Tweaking the font would be difficult; instead, I made the font <em>size</em> smaller for spaces (but only in inlined code).</p>\n<p>PM me if you want to hear more thoughts on this topic.</p>",
        "id": 542003259,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1759143082
    },
    {
        "content": "<p>I'm surprised it's not possible to invoke the standard tex glue machinery here</p>",
        "id": 542031795,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1759150679
    },
    {
        "content": "<p>In which setting? I am writing my Ph.D. thesis in MS Word.</p>",
        "id": 542033025,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1759150947
    },
    {
        "content": "<p>By \"glue machinery\", I'm referring to how regular spaces in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>TeX</mtext></mrow><annotation encoding=\"application/x-tex\">\\TeX</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8988em;vertical-align:-0.2155em;\"></span><span class=\"mord text\"><span class=\"mord textrm\">T</span><span class=\"mspace\" style=\"margin-right:-0.1667em;\"></span><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4678em;\"><span style=\"top:-2.7845em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord textrm\">E</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2155em;\"><span></span></span></span></span><span class=\"mspace\" style=\"margin-right:-0.125em;\"></span><span class=\"mord textrm\">X</span></span></span></span></span> are resized to adjust the line width. Monospace spaces in <code>\\verb</code> are not by default, because a) this would make them not match the letter widths, and b) I think this glue machinery does not permit multiple adjacent spaces.</p>",
        "id": 542035534,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1759151518
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"417654\">Martin Dvořák</span> <a href=\"#narrow/stream/113488-general/topic/Code.20snippets.20in.20sentences/near/542003259\">said</a>:</p>\n<blockquote>\n<p>instead, I made the font <em>size</em> smaller for spaces</p>\n</blockquote>\n<p>Doing this in word for a thesis-sized document with more than 10 code snippets sounds absolutely insane to me; are you really going to inspect every space to check you applied the right font size to it, which I assume you will do via clicking on each one in turn?</p>",
        "id": 542036192,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1759151674
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/113488-general/topic/Code.20snippets.20in.20sentences/near/542035534\">said</a>:</p>\n<blockquote>\n<p>By \"glue machinery\", I'm referring to how regular spaces in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>TeX</mtext></mrow><annotation encoding=\"application/x-tex\">\\TeX</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8988em;vertical-align:-0.2155em;\"></span><span class=\"mord text\"><span class=\"mord textrm\">T</span><span class=\"mspace\" style=\"margin-right:-0.1667em;\"></span><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4678em;\"><span style=\"top:-2.7845em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord textrm\">E</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2155em;\"><span></span></span></span></span><span class=\"mspace\" style=\"margin-right:-0.125em;\"></span><span class=\"mord textrm\">X</span></span></span></span></span> are resized to adjust the line width. Monospace spaces in <code>\\verb</code> are not by default, because a) this would make them not match the letter widths, and b) I think this glue machinery does not permit multiple adjacent spaces.</p>\n</blockquote>\n<p>Ah yes, I know how glue works in TeX. I suppose you can hack <code>\\verb</code> to do it the same way glue works in normal text?</p>",
        "id": 542036526,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1759151748
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/113488-general/topic/Code.20snippets.20in.20sentences/near/542036192\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"417654\">Martin Dvořák</span> <a href=\"#narrow/stream/113488-general/topic/Code.20snippets.20in.20sentences/near/542003259\">said</a>:</p>\n<blockquote>\n<p>instead, I made the font <em>size</em> smaller for spaces</p>\n</blockquote>\n<p>Doing this in word for a thesis-sized document with more than 10 code snippets sounds absolutely insane to me; are you really going to inspect every space to check you applied the right font size to it, which I assume you will do via clicking on each one in turn?</p>\n</blockquote>\n<p>Of course! Moreover, I adjust the width of the space according to the semantics of given code snippet and the line breaks in my paragraph.</p>",
        "id": 542036786,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1759151805
    },
    {
        "content": "<p>I suppose if you wrote a visual basic macro to do this space resizing automatically for you this would be a little less of a time sink, though still mad in its own way</p>",
        "id": 542037081,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1759151873
    },
    {
        "content": "<p>Maybe if you built a whole suite of macros you'd end up with a document preparation system that looks perfect algorithmically...</p>",
        "id": 542037281,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1759151919
    },
    {
        "content": "<p>It isn't such a horrible time sink. When compared to how long it takes me to compose a good English sentence, the extra work to do three additional clicks for every inline-code spacebar press is small.</p>",
        "id": 542037555,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1759151984
    },
    {
        "content": "<p>I'm amazed you can write your thesis in MS Word and survive in the end. (I never looked back after switching to LaTeX, only sideways to markdown :-))</p>",
        "id": 542112369,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1759170727
    },
    {
        "content": "<p>Well, let's talk about survival when I am done with it!</p>",
        "id": 542114538,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1759171419
    },
    {
        "content": "<p>Who forced you to do that?</p>",
        "id": 542121997,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1759173678
    },
    {
        "content": "<p>Nobody. Do I sound like I'm complaining?</p>",
        "id": 542123667,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1759174164
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/stream/113488-general/topic/Code.20snippets.20in.20sentences/near/542112369\">said</a>:</p>\n<blockquote>\n<p>I'm amazed you can write your thesis in MS Word and survive in the end. (I never looked back after switching to LaTeX, only sideways to markdown :-))</p>\n</blockquote>\n<p>I was very sympathetic to <span class=\"user-mention\" data-user-id=\"121918\">@Edward Ayers</span>' take that LaTeX sucked and html was the right way to write a thesis, but ultimately chickened out once I remembered the university wanted pagination in a physical book</p>",
        "id": 542125309,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1759174607
    },
    {
        "content": "<p>To be fair, I did sound like I was complaining in the beginning, because I was really complaining — I was complaining about something I didn't know how to solve in any of the two programs. But now that I have a working solution in MS Word (and moreover, I believe that a good solution in TeX exists as well), so I am completely happy now!</p>",
        "id": 542126605,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1759175037
    },
    {
        "content": "<p>My bachelor's is written in LaTeX and my master's in Typst. Luckily, my uni didn't have strict requirements on the exact format for the master's thesis :)</p>",
        "id": 542130997,
        "sender_full_name": "Joscha Mennicken",
        "timestamp": 1759176617
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/113488-general/topic/Code.20snippets.20in.20sentences/near/542125309\">said</a>:</p>\n<blockquote>\n<p>html was the right way to write a thesis</p>\n</blockquote>\n<p>I enjoy HTML as a typesetting system too, but it seems to be an unpopular opinion. <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span> </p>\n<p>HTML/CSS does have systems for typesetting for print that are quite useful, but I'm sure LaTeX or Typst are better suited for it.</p>",
        "id": 542131680,
        "sender_full_name": "Julia Scheaffer",
        "timestamp": 1759176897
    }
]