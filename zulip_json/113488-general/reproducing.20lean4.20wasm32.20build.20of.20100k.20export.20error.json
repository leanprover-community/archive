[
    {
        "content": "<p>Currently, I can not even reproduce the lean4 wasm32 100k export error. Here are my build attempts</p>\n<ol>\n<li>\n<p>x86_64 build of lean4 from git works fine. Proof: <a href=\"https://www.youtube.com/watch?v=y3jyCaoru-A\">https://www.youtube.com/watch?v=y3jyCaoru-A</a></p>\n<div class=\"youtube-video message_inline_image\"><a data-id=\"y3jyCaoru-A\" href=\"https://www.youtube.com/watch?v=y3jyCaoru-A\"><img src=\"https://uploads.zulipusercontent.net/4f560d25d0e7dee0ddc4d2661fd3db8e6c0b22c9/68747470733a2f2f692e7974696d672e636f6d2f76692f79336a7943616f72752d412f6d7164656661756c742e6a7067\"></a></div></li>\n<li>\n<p>following doc/make/emscripten.md for wasm32 build fails much earlier than 100k export issue (first it complains about STAGE not being set; after setting it, it looks for mimalloc in wrong loc; perhaps the CMakefile is out of date?). Proof: <a href=\"https://www.youtube.com/watch?v=WWs3F2ToU6c\">https://www.youtube.com/watch?v=WWs3F2ToU6c</a></p>\n<div class=\"youtube-video message_inline_image\"><a data-id=\"WWs3F2ToU6c\" href=\"https://www.youtube.com/watch?v=WWs3F2ToU6c\"><img src=\"https://uploads.zulipusercontent.net/8c874f69406c93277dd57314d3b6b71989fc7624/68747470733a2f2f692e7974696d672e636f6d2f76692f575773334632546f5536632f6d7164656661756c742e6a7067\"></a></div></li>\n</ol>\n<p>If anyone could offer insight on this, it would be great. Between (1) <a class=\"message-link\" href=\"/#narrow/channel/113488-general/topic/what.20is.20lean.2Ejs/near/561574916\">#general &gt; what is lean.js @ ðŸ’¬</a>  showing it is barely over 100k and <a class=\"message-link\" href=\"/#narrow/channel/113488-general/topic/what.20is.20lean.2Ejs/near/561987508\">#general &gt; what is lean.js @ ðŸ’¬</a>  showing the new limit is 1M, I am hoping this can be made to work with a little linux/emscripten hacking.</p>\n<p>Thanks!</p>",
        "id": 562023331,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764911733
    },
    {
        "content": "<p>I hope this does not come off as entitled -- the most helpful response would be if someone has</p>\n<ol>\n<li>a 5-10 line bash script</li>\n<li>to be run from <code>.../lean4</code>, after the x86_64 lean4 stage1 build</li>\n<li>and will get me to the point where it complains about the 100k wasm export error</li>\n</ol>",
        "id": 562023645,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764912031
    },
    {
        "content": "<p>The \"reason\" I'm being so stubborn on this is that</p>\n<ol>\n<li>after <a class=\"message-link\" href=\"/#narrow/channel/113488-general/topic/what.20is.20lean.2Ejs/near/561987508\">#general &gt; what is lean.js @ ðŸ’¬</a>  's link to <a href=\"https://chromium.googlesource.com/v8/v8/+/285bfe195f7918f623ee6d0f138774ec003f2262%5E%21/#F0\">https://chromium.googlesource.com/v8/v8/+/285bfe195f7918f623ee6d0f138774ec003f2262%5E%21/#F0</a> ; I'm quite convinced Chrome itself supports 1M.</li>\n<li>Which means the only issue is the \"intermediate tooling\" (which can probably be patched in 2-3 lines). </li>\n<li>And from <a class=\"stream-topic\" data-stream-id=\"113488\" href=\"/#narrow/channel/113488-general/topic/what.20is.20lean.2Ejs/with/561987508\">#general &gt; what is lean.js</a>  , I'm not aware of any other \"blockers\"</li>\n</ol>\n<p>So it seems like if we just push through this one obstacle, we can restore lean4 on wasm32 again.</p>",
        "id": 562024009,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764912370
    },
    {
        "content": "<p>You may have to do the archaeology yourself here, e.g. bisecting in the git history to find where things changed and/or identifying points in time when the non-wasm build changed (and the wasm build want updated because it was turned off!)</p>",
        "id": 562025241,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1764913372
    },
    {
        "content": "<p>I'm not familiar with the Lean4 codebase yet, but sounds reasonable.</p>\n<ol>\n<li>\n<p>If we had to guess, <a href=\"https://github.com/leanprover/lean4/commits/master/src/CMakeLists.txt\">https://github.com/leanprover/lean4/commits/master/src/CMakeLists.txt</a> -- somewhere between 4.14.0 and 4.26.0-rc2 is probably where things got broken right ?</p>\n</li>\n<li>\n<p>Would a reasonable first step be trying to get the wasm build to work on git tag 4.14.0 ? To binary search for this, I need a working state and a failure state. I know 4.26.0-rc2 fails; and 4.14.0 is supposedly the last working state ?</p>\n</li>\n</ol>",
        "id": 562025726,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764913670
    },
    {
        "content": "<p>Even on 4.14.0(supposed to work, since 4.15 is when wasm was dropped), I can't get a working emscripten/wasm build.</p>\n<ol>\n<li>Proof 4.14 x86_64 builds fine: <a href=\"https://www.youtube.com/watch?v=LSvOZClvuaI\">https://www.youtube.com/watch?v=LSvOZClvuaI</a><div class=\"youtube-video message_inline_image\"><a data-id=\"LSvOZClvuaI\" href=\"https://www.youtube.com/watch?v=LSvOZClvuaI\"><img src=\"https://uploads.zulipusercontent.net/72d2acc154dc084843a24859610d24be69e89ac4/68747470733a2f2f692e7974696d672e636f6d2f76692f4c53764f5a436c767561492f6d7164656661756c742e6a7067\"></a></div></li>\n<li>Proof 4.14 emscripten/wasm build fails: <a href=\"https://www.youtube.com/watch?v=d3Auop5nXo4\">https://www.youtube.com/watch?v=d3Auop5nXo4</a><div class=\"youtube-video message_inline_image\"><a data-id=\"d3Auop5nXo4\" href=\"https://www.youtube.com/watch?v=d3Auop5nXo4\"><img src=\"https://uploads.zulipusercontent.net/f09b1992ab5cdc7085323ee966f5a6a28c877a8d/68747470733a2f2f692e7974696d672e636f6d2f76692f643341756f70356e586f342f6d7164656661756c742e6a7067\"></a></div></li>\n</ol>\n<p>At this point, it is pretty clear I am mis-interpreting doc/make/emscripten.md -- appears to be same instrs on 4.26.0-rc2 and 4.14.0 -- and I'm getting what appears to be same error in both cases.</p>\n<p>It's not obvious to me how to do a emscripten/wasm build on 4.14.0. Are there CI wasm scripts somewhere I can copy/paste from for 4.14.0 ?</p>",
        "id": 562027849,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764915108
    },
    {
        "content": "<p><a class=\"message-link\" href=\"/#narrow/channel/270676-lean4/topic/wasm.20build/near/472415068\">#lean4 &gt; wasm build @ ðŸ’¬</a>  is interesting</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">wget</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">toolchains</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">releases</span><span class=\"bp\">/</span><span class=\"n\">download</span><span class=\"bp\">/</span><span class=\"n\">v</span><span class=\"bp\">$</span><span class=\"n\">LEAN_VERSION</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-$</span><span class=\"n\">LEAN_VERSION</span><span class=\"bp\">-</span><span class=\"n\">linux_wasm32</span><span class=\"bp\">.</span><span class=\"n\">tar</span><span class=\"bp\">.</span><span class=\"n\">zst</span>\n</code></pre></div>\n<p>^-- especially this line here. How / where in the CI is this file built ?</p>",
        "id": 562033031,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764918437
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">make</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">1</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Performing</span><span class=\"w\"> </span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">libuv'</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">2</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Performing</span><span class=\"w\"> </span><span class=\"n\">patch</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">libuv'</span>\n<span class=\"n\">HEAD</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">now</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">e9f29cb9</span><span class=\"w\"> </span><span class=\"mf\">2024.02</span><span class=\"bp\">.</span><span class=\"m\">07</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Version</span><span class=\"w\"> </span><span class=\"mf\">1.48</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Stable</span><span class=\"o\">)</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">2</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Performing</span><span class=\"w\"> </span><span class=\"n\">configure</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">libuv'</span>\n<span class=\"c1\">-- summary of build options:</span>\n<span class=\"w\">    </span><span class=\"n\">Install</span><span class=\"w\"> </span><span class=\"kn\">prefix</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">202</span><span class=\"n\">rpslcjhwax183ahrf54xf46kvp1li</span><span class=\"bp\">-</span><span class=\"n\">emscripten</span><span class=\"bp\">-</span><span class=\"mf\">4.0</span><span class=\"bp\">.</span><span class=\"m\">10</span><span class=\"bp\">/</span><span class=\"n\">share</span><span class=\"bp\">/</span><span class=\"n\">emscripten</span><span class=\"bp\">/</span><span class=\"n\">cache</span><span class=\"bp\">/</span><span class=\"n\">sysroot</span>\n<span class=\"w\">    </span><span class=\"n\">Target</span><span class=\"w\"> </span><span class=\"n\">system</span><span class=\"o\">:</span><span class=\"w\">   </span><span class=\"n\">Emscripten</span>\n<span class=\"w\">    </span><span class=\"n\">Compiler</span><span class=\"o\">:</span>\n<span class=\"w\">      </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">compiler</span><span class=\"o\">:</span><span class=\"w\">    </span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">202</span><span class=\"n\">rpslcjhwax183ahrf54xf46kvp1li</span><span class=\"bp\">-</span><span class=\"n\">emscripten</span><span class=\"bp\">-</span><span class=\"mf\">4.0</span><span class=\"bp\">.</span><span class=\"m\">10</span><span class=\"bp\">/</span><span class=\"n\">share</span><span class=\"bp\">/</span><span class=\"n\">emscripten</span><span class=\"bp\">/</span><span class=\"n\">emcc</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Clang</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"n\">CFLAGS</span><span class=\"o\">:</span><span class=\"w\">         </span><span class=\"bp\">-</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">ALLOW_MEMORY_GROWTH</span><span class=\"bp\">=</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">fwasm</span><span class=\"bp\">-</span><span class=\"n\">exceptions</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">pthread</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">flto</span>\n\n<span class=\"c1\">-- Configuring done (1.2s)</span>\n<span class=\"c1\">-- Generating done (0.0s)</span>\n<span class=\"c1\">-- Build files have been written to: /home/y/tst/lean4/build/emscripten/libuv/src/libuv</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">3</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Performing</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">libuv'</span>\n<span class=\"o\">[</span><span class=\"mi\">100</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">uv_a</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">4</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">No</span><span class=\"w\"> </span><span class=\"n\">install</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">libuv'</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">5</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Completed</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">libuv'</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">6</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">libuv</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">7</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">initialize</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">7</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">leaninitialize</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">9</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">leanshell</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">26</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">compiler</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">37</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">util</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">48</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">kernel</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">59</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">library</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">62</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">constructions</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">63</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Linking</span><span class=\"w\"> </span><span class=\"n\">CXX</span><span class=\"w\"> </span><span class=\"n\">static</span><span class=\"w\"> </span><span class=\"n\">library</span><span class=\"w\"> </span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">temp</span><span class=\"bp\">/</span><span class=\"n\">libleancpp_1</span><span class=\"bp\">.</span><span class=\"n\">a</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">63</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">leancpp_1</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">64</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Linking</span><span class=\"w\"> </span><span class=\"n\">CXX</span><span class=\"w\"> </span><span class=\"n\">static</span><span class=\"w\"> </span><span class=\"n\">library</span><span class=\"w\"> </span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">libleancpp</span><span class=\"bp\">.</span><span class=\"n\">a</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">64</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">leancpp</span>\n<span class=\"n\">bash</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">line</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cd</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">y</span><span class=\"bp\">/</span><span class=\"n\">tst</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">src</span><span class=\"bp\">/../</span><span class=\"n\">stdlib</span><span class=\"bp\">/</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">No</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span>\n<span class=\"n\">bash</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">line</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cd</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">y</span><span class=\"bp\">/</span><span class=\"n\">tst</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">src</span><span class=\"bp\">/../</span><span class=\"n\">stdlib</span><span class=\"bp\">/</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">No</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">4</span><span class=\"o\">]:</span><span class=\"w\"> </span><span class=\"bp\">***</span><span class=\"w\"> </span><span class=\"n\">No</span><span class=\"w\"> </span><span class=\"n\">rule</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">make</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"bp\">'../</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">emscripten</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">Init</span><span class=\"bp\">/</span><span class=\"n\">Simproc</span><span class=\"bp\">.</span><span class=\"n\">olean'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">needed</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">objs'</span><span class=\"bp\">.</span><span class=\"w\">  </span><span class=\"n\">Stop</span><span class=\"bp\">.</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">3</span><span class=\"o\">]:</span><span class=\"w\"> </span><span class=\"bp\">***</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">y</span><span class=\"bp\">/</span><span class=\"n\">tst</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">emscripten</span><span class=\"bp\">/</span><span class=\"n\">stdlib</span><span class=\"bp\">.</span><span class=\"n\">make</span><span class=\"o\">:</span><span class=\"mi\">37</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Init</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Error</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">2</span><span class=\"o\">]:</span><span class=\"w\"> </span><span class=\"bp\">***</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">make_stdlib</span><span class=\"bp\">.</span><span class=\"n\">dir</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">.</span><span class=\"n\">make</span><span class=\"o\">:</span><span class=\"mi\">70</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">make_stdlib</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Error</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">]:</span><span class=\"w\"> </span><span class=\"bp\">***</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">Makefile2</span><span class=\"o\">:</span><span class=\"mi\">1145</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">make_stdlib</span><span class=\"bp\">.</span><span class=\"n\">dir</span><span class=\"bp\">/</span><span class=\"n\">all</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Error</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">***</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Makefile</span><span class=\"o\">:</span><span class=\"mi\">146</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">all</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Error</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n</code></pre></div>\n<p>(building emscripten lean4 on 4.14.0)</p>\n<p>I think this is closer; but I can't figure out wtf <code>stdlib</code> is supposed to be. C stdlib? C++ stdlib? Some lean stdlib?</p>",
        "id": 562049742,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764925155
    },
    {
        "content": "<p>4.14.0 wasm build is making progress. But I can't figure out wtf this <code>Simproc.olean</code> is:</p>\n<p>error:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">make</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">1</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Performing</span><span class=\"w\"> </span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">libuv'</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">2</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Performing</span><span class=\"w\"> </span><span class=\"n\">patch</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">libuv'</span>\n<span class=\"n\">HEAD</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">now</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">e9f29cb9</span><span class=\"w\"> </span><span class=\"mf\">2024.02</span><span class=\"bp\">.</span><span class=\"m\">07</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Version</span><span class=\"w\"> </span><span class=\"mf\">1.48</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Stable</span><span class=\"o\">)</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">2</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Performing</span><span class=\"w\"> </span><span class=\"n\">configure</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">libuv'</span>\n<span class=\"c1\">-- summary of build options:</span>\n<span class=\"w\">    </span><span class=\"n\">Install</span><span class=\"w\"> </span><span class=\"kn\">prefix</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">202</span><span class=\"n\">rpslcjhwax183ahrf54xf46kvp1li</span><span class=\"bp\">-</span><span class=\"n\">emscripten</span><span class=\"bp\">-</span><span class=\"mf\">4.0</span><span class=\"bp\">.</span><span class=\"m\">10</span><span class=\"bp\">/</span><span class=\"n\">share</span><span class=\"bp\">/</span><span class=\"n\">emscripten</span><span class=\"bp\">/</span><span class=\"n\">cache</span><span class=\"bp\">/</span><span class=\"n\">sysroot</span>\n<span class=\"w\">    </span><span class=\"n\">Target</span><span class=\"w\"> </span><span class=\"n\">system</span><span class=\"o\">:</span><span class=\"w\">   </span><span class=\"n\">Emscripten</span>\n<span class=\"w\">    </span><span class=\"n\">Compiler</span><span class=\"o\">:</span>\n<span class=\"w\">      </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">compiler</span><span class=\"o\">:</span><span class=\"w\">    </span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">202</span><span class=\"n\">rpslcjhwax183ahrf54xf46kvp1li</span><span class=\"bp\">-</span><span class=\"n\">emscripten</span><span class=\"bp\">-</span><span class=\"mf\">4.0</span><span class=\"bp\">.</span><span class=\"m\">10</span><span class=\"bp\">/</span><span class=\"n\">share</span><span class=\"bp\">/</span><span class=\"n\">emscripten</span><span class=\"bp\">/</span><span class=\"n\">emcc</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Clang</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"n\">CFLAGS</span><span class=\"o\">:</span><span class=\"w\">         </span><span class=\"bp\">-</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">ALLOW_MEMORY_GROWTH</span><span class=\"bp\">=</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">fwasm</span><span class=\"bp\">-</span><span class=\"n\">exceptions</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">pthread</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">flto</span>\n\n<span class=\"c1\">-- Configuring done (1.4s)</span>\n<span class=\"c1\">-- Generating done (0.0s)</span>\n<span class=\"c1\">-- Build files have been written to: /home/y/tst/lean4/build/emscripten/libuv/src/libuv</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">3</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Performing</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">libuv'</span>\n<span class=\"o\">[</span><span class=\"mi\">100</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">uv_a</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">4</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">No</span><span class=\"w\"> </span><span class=\"n\">install</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">libuv'</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">5</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Completed</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">libuv'</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">6</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">libuv</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">7</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">initialize</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">7</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">leaninitialize</span>\n<span class=\"o\">[</span><span class=\"w\">  </span><span class=\"mi\">9</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">leanshell</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">26</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">compiler</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">37</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">util</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">48</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">kernel</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">59</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">library</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">62</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">constructions</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">63</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">leancpp_1</span>\n<span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">64</span><span class=\"bp\">%</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">leancpp</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">4</span><span class=\"o\">]:</span><span class=\"w\"> </span><span class=\"bp\">***</span><span class=\"w\"> </span><span class=\"n\">No</span><span class=\"w\"> </span><span class=\"n\">rule</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">make</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"bp\">'../</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">emscripten</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">Init</span><span class=\"bp\">/</span><span class=\"n\">Simproc</span><span class=\"bp\">.</span><span class=\"n\">olean'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">needed</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">objs'</span><span class=\"bp\">.</span><span class=\"w\">  </span><span class=\"n\">Stop</span><span class=\"bp\">.</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">3</span><span class=\"o\">]:</span><span class=\"w\"> </span><span class=\"bp\">***</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">y</span><span class=\"bp\">/</span><span class=\"n\">tst</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">emscripten</span><span class=\"bp\">/</span><span class=\"n\">stdlib</span><span class=\"bp\">.</span><span class=\"n\">make</span><span class=\"o\">:</span><span class=\"mi\">37</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Init</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Error</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">2</span><span class=\"o\">]:</span><span class=\"w\"> </span><span class=\"bp\">***</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">make_stdlib</span><span class=\"bp\">.</span><span class=\"n\">dir</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">.</span><span class=\"n\">make</span><span class=\"o\">:</span><span class=\"mi\">70</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">make_stdlib</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Error</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">]:</span><span class=\"w\"> </span><span class=\"bp\">***</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">Makefile2</span><span class=\"o\">:</span><span class=\"mi\">1145</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">make_stdlib</span><span class=\"bp\">.</span><span class=\"n\">dir</span><span class=\"bp\">/</span><span class=\"n\">all</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Error</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">***</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Makefile</span><span class=\"o\">:</span><span class=\"mi\">146</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">all</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Error</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n</code></pre></div>\n<p>I don't understand where this Simproc is referenced:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">[</span><span class=\"n\">y</span><span class=\"bp\">@</span><span class=\"n\">c240</span><span class=\"o\">:</span><span class=\"bp\">~/</span><span class=\"n\">tst</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">emscripten</span><span class=\"o\">]</span><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">rg</span><span class=\"w\"> </span><span class=\"n\">Simproc</span><span class=\"w\"> </span><span class=\"bp\">../../</span><span class=\"n\">CMakeLists</span><span class=\"bp\">.</span><span class=\"n\">txt</span><span class=\"w\"> </span><span class=\"bp\">../../</span><span class=\"n\">src</span><span class=\"bp\">/</span><span class=\"n\">CMakeLists</span><span class=\"bp\">.</span><span class=\"n\">txt</span>\n\n<span class=\"o\">[</span><span class=\"n\">y</span><span class=\"bp\">@</span><span class=\"n\">c240</span><span class=\"o\">:</span><span class=\"bp\">~/</span><span class=\"n\">tst</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">emscripten</span><span class=\"o\">]</span><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">rg</span><span class=\"w\"> </span><span class=\"n\">Simproc</span><span class=\"w\"> </span><span class=\"bp\">.</span>\n<span class=\"bp\">./</span><span class=\"n\">shell</span><span class=\"bp\">/</span><span class=\"n\">CTestTestfile</span><span class=\"bp\">.</span><span class=\"n\">cmake</span>\n<span class=\"mi\">427</span><span class=\"o\">:</span><span class=\"n\">add_test</span><span class=\"o\">([</span><span class=\"bp\">=</span><span class=\"o\">[</span><span class=\"n\">leantest_builtinSimprocTrace</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">]</span><span class=\"bp\">=</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"s2\">\"bash\"</span><span class=\"w\"> </span><span class=\"s2\">\"-c\"</span><span class=\"w\"> </span><span class=\"s2\">\"PATH=/home/y/tst/lean4/build/emscripten/bin:</span><span class=\"err\">\\</span><span class=\"s2\">$PATH LEAN_CC=/nix/store/202rpslcjhwax183ahrf54xf46kvp1li-emscripten-4.0.10/share/emscripten/emcc CXX='/nix/store/202rpslcjhwax183ahrf54xf46kvp1li-emscripten-4.0.10/share/emscripten/em++  ' LEANC_OPTS=' ' ./test_single.sh builtinSimprocTrace.lean\"</span><span class=\"o\">)</span>\n<span class=\"mi\">428</span><span class=\"o\">:</span><span class=\"n\">set_tests_properties</span><span class=\"o\">([</span><span class=\"bp\">=</span><span class=\"o\">[</span><span class=\"n\">leantest_builtinSimprocTrace</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">]</span><span class=\"bp\">=</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">PROPERTIES</span><span class=\"w\">  </span><span class=\"n\">WORKING_DIRECTORY</span><span class=\"w\"> </span><span class=\"s2\">\"/home/y/tst/lean4/src/../tests/lean\"</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">BACKTRACE_TRIPLES</span><span class=\"w\"> </span><span class=\"s2\">\"/home/y/tst/lean4/src/shell/CMakeLists.txt;67;add_test;/home/y/tst/lean4/src/shell/CMakeLists.txt;0;\"</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 562056104,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764926941
    },
    {
        "content": "<p>I'm not sure you're going to get too much support here trying to build 4.14 unfortunately</p>",
        "id": 562058058,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1764927564
    },
    {
        "content": "<p>Sorry for not being clear:</p>\n<ol>\n<li>My goal is not to build 4.14.</li>\n<li>My goal is to get 4.26.0-rc2 to get to a point I can replicate the 100k wasm-export limit error.</li>\n<li>I can't get 4.26.0-rc2 to replicate that error, I suspect something in the CMakeList.txt or build process has bit-rotted after wasm was turned off in 4.15.0</li>\n<li>So I'm trying to get a version where lean4 compiles to wasm, then bisect through the commits to get to a point where 4.26.0-rc2 tries to do the wasm32 build (and fails at the 100k wasm-export limit).</li>\n</ol>\n<p>If this sounds convoluted -- it's because I'm not familiar with the codebase and have no other attack.</p>\n<p>Again, my goal is  <strong>NOT</strong> to build 4.14.0 to use in wasm. My goal is to get 4.26.0-rc2 to get to the point where I can replicate the 100k wasm-export issue. But I can't do that right now, as it appears the lean4/4.26.0-rc2/doc/make/emscripten.md may have bit rotted.</p>",
        "id": 562060047,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764928148
    },
    {
        "content": "<p>I'm trying to build 4.14 because</p>\n<ol>\n<li>I read somewhere in 4.15.0, wasm support was dropped</li>\n<li>So I'm trying to get the latest still-working-wasm-build to run, just to see what the Makefile / CMake is supposed to look for a successful/working wasm build.</li>\n</ol>",
        "id": 562060305,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764928232
    },
    {
        "content": "<p>Phrased another way:</p>\n<ol>\n<li>\n<p>I believe 4.26.0-rc2 fails to build on wasm32 for two reasons: (a) 100k export limit, (b) wasm32 build scripts have bit rotted.</p>\n</li>\n<li>\n<p>I am trying to build 4.14, not because I want to use the 4.14-wasm in Chrome; but because I am trying to find what a successful \"(b)\" -- working wasm32 build script -- is supposed to look like, so I can \"un-bit-rot\" the 4.26.0-rc2 to the point I can replicate the 100k wasm-export limit.</p>\n</li>\n</ol>",
        "id": 562061048,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764928443
    },
    {
        "content": "<p>Thanks for your clear answers. I shouldn't really be contributing here at all, I understand nothing of all this, I just wanted to warn you that often when people come along saying \"I am trying to get this old version working\" people's instincts are usually \"just get a new version working\". But this case does seem to be different to the usual one.</p>",
        "id": 562071134,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1764931669
    }
]