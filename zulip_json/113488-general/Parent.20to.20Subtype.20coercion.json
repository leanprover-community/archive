[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">Subtype</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">isDigit</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Is it possible to define a coercion such that the following will typecheck?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">myDigit</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">5</span><span class=\"bp\">'</span>\n</code></pre></div>",
        "id": 478797971,
        "sender_full_name": "nrs",
        "timestamp": 1729803237
    },
    {
        "content": "<p>Option 1: define a Coe instance, and if the data is invalid, replace it with a default value. Maybe use <code>panic!</code> too so you get a runtime error that this happened.</p>\n<p>Option 2: define a term elaborator <code>toDigit</code> and write <code>toDigit '5'</code>, where the elaborator synthesizes a proof that <code>Char.isDigit</code> holds.</p>",
        "id": 478798313,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729803374
    },
    {
        "content": "<p>Any particular reason you didn't write it in the following more canonical way?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">isDigit</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>",
        "id": 478798398,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729803413
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/113488-general/topic/Parent.20to.20Subtype.20coercion/near/478798313\">said</a>:</p>\n<blockquote>\n<p>Option 1: define a Coe instance, and if the data is invalid, replace it with a default value. Maybe use <code>panic!</code> too so you get a runtime error that this happened.</p>\n<p>Option 2: define a term elaborator <code>toDigit</code> and write <code>toDigit '5'</code>, where the elaborator synthesizes a proof that <code>Char.isDigit</code> holds.</p>\n</blockquote>\n<p>I've been attempting the <code>Coe</code> instance path, but how do I suspend evaluation of the proof until the actual coercion? e.g. the following will fail because the proof evaluates immediately</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Coe</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">isDigit</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 478798557,
        "sender_full_name": "nrs",
        "timestamp": 1729803482
    },
    {
        "content": "<p>That fails also because <code>(fun c =&gt; c.isDigit)</code> is not a proof of <code>c.isDigit</code></p>",
        "id": 478798683,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729803542
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/113488-general/topic/Parent.20to.20Subtype.20coercion/near/478798398\">said</a>:</p>\n<blockquote>\n<p><code>def Digit := { c : Char // c.isDigit }</code></p>\n</blockquote>\n<p>ah this is neat! ty</p>",
        "id": 478798701,
        "sender_full_name": "nrs",
        "timestamp": 1729803550
    },
    {
        "content": "<p>but in any case, you have to think about the fact that a coercion is a function <code>Char -&gt; Digit</code>. It has to succeed on <em>all</em> <code>Char</code>s</p>",
        "id": 478798727,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729803566
    },
    {
        "content": "<p>(I figured you might have known about this syntax given <a href=\"#narrow/channel/113488-general/topic/Sigma.20type.20definition.20vs.20definition.20through.20constructors/near/478561394\">your question</a> yesterday.)</p>",
        "id": 478798871,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729803618
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/113488-general/topic/Parent.20to.20Subtype.20coercion/near/478798727\">said</a>:</p>\n<blockquote>\n<p>but in any case, you have to think about the fact that a coercion is a function <code>Char -&gt; Digit</code>. It has to succeed on <em>all</em> <code>Char</code>s</p>\n</blockquote>\n<p>so necessarily even <code>'a'</code> and <code>'b'</code> will need to coerce to a <code>Digit</code>?</p>",
        "id": 478799127,
        "sender_full_name": "nrs",
        "timestamp": 1729803729
    },
    {
        "content": "<p>Yes, that's the contract for <code>Coe</code></p>",
        "id": 478799180,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729803755
    },
    {
        "content": "<p>Here's an example:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">isDigit</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Inhabited</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨'</span><span class=\"mi\">0</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"bp\">.</span><span class=\"n\">ofChar</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">isDigit</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">    </span><span class=\"bp\">⟨</span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"k\">else</span>\n<span class=\"w\">    </span><span class=\"n\">panic!</span><span class=\"w\"> </span><span class=\"s2\">\"not a digit\"</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Coe</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"bp\">.</span><span class=\"n\">ofChar</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">myDigit</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">5</span><span class=\"bp\">'</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">myDigit</span>\n<span class=\"c1\">-- '5'</span>\n</code></pre></div>",
        "id": 478799201,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729803767
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/113488-general/topic/Parent.20to.20Subtype.20coercion/near/478799201\">said</a>:</p>\n<blockquote>\n<p>Here's an example:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">isDigit</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Inhabited</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨'</span><span class=\"mi\">0</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"bp\">.</span><span class=\"n\">ofChar</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">isDigit</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">    </span><span class=\"bp\">⟨</span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"k\">else</span>\n<span class=\"w\">    </span><span class=\"n\">panic!</span><span class=\"w\"> </span><span class=\"s2\">\"not a digit\"</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Coe</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"bp\">.</span><span class=\"n\">ofChar</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">myDigit</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">5</span><span class=\"bp\">'</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">myDigit</span>\n<span class=\"c1\">-- '5'</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>ah I see! thank you very much for the example!</p>",
        "id": 478799249,
        "sender_full_name": "nrs",
        "timestamp": 1729803794
    },
    {
        "content": "<p>Then</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">myBadDigit</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">A'</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">myBadDigit</span>\n<span class=\"c\">/-</span>\n<span class=\"cm\">PANIC at Digit.ofChar lean.run.foo:65:4: not a digit</span>\n<span class=\"cm\">'0'</span>\n<span class=\"cm\">-/</span>\n</code></pre></div>",
        "id": 478799258,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729803798
    },
    {
        "content": "<p>Or you can use <code>CoeDep</code> for <em>specific</em> characters:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CoeDep</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">0</span><span class=\"bp\">'</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"bp\">.</span><span class=\"n\">ofChar</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">0</span><span class=\"bp\">'</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CoeDep</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">1</span><span class=\"bp\">'</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"bp\">.</span><span class=\"n\">ofChar</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">1</span><span class=\"bp\">'</span>\n<span class=\"c1\">-- ...</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CoeDep</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">5</span><span class=\"bp\">'</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"bp\">.</span><span class=\"n\">ofChar</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">5</span><span class=\"bp\">'</span>\n<span class=\"c1\">-- ...</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">myDigit</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">5</span><span class=\"bp\">'</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">myDigit</span>\n<span class=\"c1\">-- '5'</span>\n</code></pre></div>",
        "id": 478799385,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729803864
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/113488-general/topic/Parent.20to.20Subtype.20coercion/near/478799385\">said</a>:</p>\n<blockquote>\n<p>Or you can use <code>CoeDep</code> for <em>specific</em> characters:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CoeDep</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">0</span><span class=\"bp\">'</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"bp\">.</span><span class=\"n\">ofChar</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">0</span><span class=\"bp\">'</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CoeDep</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">1</span><span class=\"bp\">'</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"bp\">.</span><span class=\"n\">ofChar</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">1</span><span class=\"bp\">'</span>\n<span class=\"c1\">-- ...</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CoeDep</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">5</span><span class=\"bp\">'</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"bp\">.</span><span class=\"n\">ofChar</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">5</span><span class=\"bp\">'</span>\n<span class=\"c1\">-- ...</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">myDigit</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">5</span><span class=\"bp\">'</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">myDigit</span>\n<span class=\"c1\">-- '5'</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>oh this is a neat solution! maybe there is a way to make a recursive definition here that will work?</p>",
        "id": 478799511,
        "sender_full_name": "nrs",
        "timestamp": 1729803929
    },
    {
        "content": "<p>No this is very limited, it looks for (more-or-less) the specific syntax. The <code>'5'</code> here must be a literal.</p>",
        "id": 478799679,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729804006
    },
    {
        "content": "<p>Here's the 'metaprogramming' approach.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Char</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">isDigit</span><span class=\"w\"> </span><span class=\"o\">}</span>\n\n<span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"s2\">\"toDigit \"</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"o\">)</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">myDigit</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Digit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">toDigit</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">5</span><span class=\"bp\">'</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">myDigit</span>\n<span class=\"c1\">-- '5'</span>\n</code></pre></div>",
        "id": 478799728,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729804037
    },
    {
        "content": "<p>This only works if <code>rfl</code> is a proof of <code>c.isDigit = true</code> (recall: <code>c.isDigit</code> is a <code>Bool</code>, so when it appears where a <code>Prop</code> is expected it is coerced to <code>c.isDigit = true</code>)</p>",
        "id": 478799889,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729804124
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/113488-general/topic/Parent.20to.20Subtype.20coercion/near/478799889\">said</a>:</p>\n<blockquote>\n<p>This only works if <code>rfl</code> is a proof of <code>c.isDigit = true</code> (recall: <code>c.isDigit</code> is a <code>Bool</code>, so when it appears where a <code>Prop</code> is expected it is coerced to <code>c.isDigit = true</code>)</p>\n</blockquote>\n<p>I see, thank you very much for the examples, these are very useful!</p>",
        "id": 478799923,
        "sender_full_name": "nrs",
        "timestamp": 1729804148
    }
]