[
    {
        "content": "<p>Am I reïnventing the wheel?</p>\n<p>I started developing API for fractional operations:<br>\n<a href=\"https://github.com/madvorak/fractional/\">https://github.com/madvorak/fractional/</a></p>\n<p>At this point, I should ask whether I am reïnventing the wheel.<br>\nDo we already have these notions in Mathlib?<br>\nDo we have this kind of theorems for them (such as I prove for my definitions) in Mathlib?</p>",
        "id": 475555167,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1728391996
    },
    {
        "content": "<p>Do you really want to define this only for Fintypes?</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Distr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">theFun</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span>\n<span class=\"w\">  </span><span class=\"n\">nonNeg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">theFun</span>\n<span class=\"w\">  </span><span class=\"n\">sumOne</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">univ</span><span class=\"bp\">.</span><span class=\"n\">sum</span><span class=\"w\"> </span><span class=\"n\">theFun</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 475555917,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1728392243
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PMF#doc\">docs#PMF</a> looks like the same thing</p>",
        "id": 475556117,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1728392301
    },
    {
        "content": "<p>Thanks for pointing it out! I didn't know about the definition in Mathlib.</p>",
        "id": 475559133,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1728393123
    },
    {
        "content": "<p>There is also <span class=\"user-mention\" data-user-id=\"514145\">@Geoffrey Irving</span>'s <a href=\"https://github.com/google-deepmind/debate/blob/main/Prob/Pmf.lean\">https://github.com/google-deepmind/debate/blob/main/Prob/Pmf.lean</a>, which argues that the builtin PMF is (or at least, was) hard to work with</p>",
        "id": 475560688,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1728393569
    },
    {
        "content": "<p>I think PMF will always be harder to work with than finitely supported probability for a lot of applications, mostly because you can’t take a real expectation without knowing integrability. Sometimes you can’t deal only in ENNReal expectations, but then you don’t have a ring.</p>",
        "id": 475561752,
        "sender_full_name": "Geoffrey Irving",
        "timestamp": 1728393868
    },
    {
        "content": "<p>I would guess you could get a long way with something like a <code>lift myPmf to FinsuppPmf</code> in the middle of a proof or similar</p>",
        "id": 475569204,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1728395812
    },
    {
        "content": "<blockquote>\n<p>mostly because you can’t take a real expectation without knowing integrability.</p>\n</blockquote>\n<p>Hopefully this is a single theorem saying \"for finite support, all PMFs are integrable\"</p>",
        "id": 475569512,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1728395883
    },
    {
        "content": "<p>If I want <code>simp</code> to apply 10 lemmas that rely on 6 things having finite support, including intermediate things that only exist in the middle of the simp, would that single theorem suffice?</p>",
        "id": 475571284,
        "sender_full_name": "Geoffrey Irving",
        "timestamp": 1728396288
    },
    {
        "content": "<p>If you also passed that theorem to <code>simp</code>, then yes</p>",
        "id": 475575706,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1728397218
    },
    {
        "content": "<p>I'm wondering whether I should use the Mathlib definition <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PMF#doc\">docs#PMF</a> for everything.<br>\nFor example, I have a theorem saying that the total variational distance cannot increase if you map both distributions by the same function:<br>\n<a href=\"https://github.com/madvorak/fractional/blob/f4ef8d0018dab67b9c7dda0b5f1939cdeeb783cb/Fractional/Distance.lean#L134\">https://github.com/madvorak/fractional/blob/f4ef8d0018dab67b9c7dda0b5f1939cdeeb783cb/Fractional/Distance.lean#L134</a><br>\nWould it be more difficult to prove analogical theorem for the Mathlib definitions?</p>",
        "id": 475862086,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1728480120
    }
]