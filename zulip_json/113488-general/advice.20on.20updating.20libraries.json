[
    {
        "content": "<p>Keep updating to new toolchains, and creating a tag <code>v4.X.0</code> every time you update, so downstream libraries can pin to a compatible version. There are some automatic tools to create these tags for you.</p>\n<p>See <a href=\"https://github.com/leanprover-community/mathlib-update-action/blob/HEAD/README.md\">https://github.com/leanprover-community/mathlib-update-action/blob/HEAD/README.md</a> and<br>\n<a href=\"https://github.com/leanprover-community/lean-release-tag/blob/HEAD/README.md\">https://github.com/leanprover-community/lean-release-tag/blob/HEAD/README.md</a></p>",
        "id": 534794051,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1755394867
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Cryptographic.20Hash.20Functions/near/534794051\">said</a>:</p>\n<blockquote>\n<p>Keep updating to new toolchains, and creating a tag <code>v4.X.0</code> every time you update, so downstream libraries can pin to a compatible version. There are some automatic tools to create these tags for you.</p>\n<p>See <a href=\"https://github.com/leanprover-community/mathlib-update-action/blob/HEAD/README.md\">https://github.com/leanprover-community/mathlib-update-action/blob/HEAD/README.md</a> and<br>\n<a href=\"https://github.com/leanprover-community/lean-release-tag/blob/HEAD/README.md\">https://github.com/leanprover-community/lean-release-tag/blob/HEAD/README.md</a></p>\n</blockquote>\n<p>Thanks for pointing out those CI actions, they're useful when you're dealing with actively maintained libraries or when a project only depends on batteries and/or mathlib.</p>\n<p>Where I've felt the pain most is in the less-maintained parts of the ecosystem. For example, when I tried to port my Haskell Advent of Code solutions to Lean recently, I wanted to use Megaparsec, a monadic parser combinator library, which was stuck on v4.0.0 and depended on 3 other unmaintained libraries. I ended up forking and migrating all those dependencies for several releases (v4.21.0-rc3 -&gt; ... -&gt; v4.22.0-rc4 -&gt; v4.23.0-rc2), just so I could keep moving forward. While it was a good learning exercise, it's obviously not something that scales well for casual contributors...</p>\n<p>I completely understand that Lean is still evolving, and stability isn't promised yet as stated in leanprover/lean4:RELEASES.md. That's part of the deal to play with cutting-edge tools.<br>\nMy concern is more about the sustainability: how to keep contributors from burning out on upgrade work while still staying aligned with the latest toolchain.</p>\n<p>Maybe the answer is some mix of: some tooling to patch common import breakages across version upgrades (might require some form of explicit marking on commits) and/or having some shim packages to bridge versions like six in python?</p>\n<p>I would be curious to hear what others think... especially about lightweight ways to reduce the upgrade tax without dragging the momentum of lean moving forward</p>",
        "id": 534799156,
        "sender_full_name": "Leo Sin",
        "timestamp": 1755403404
    },
    {
        "content": "<p>We have talked about these issues before - the main thing we've set up so far is somewhat consistent deprecation warnings for removed decorations and files that stay around at least one release but usually 6 months. So if you bump once a month to the new stable version, it's <em>usually</em> pretty smooth. There's also GitHub actions that keep trying to update mathlib more frequently and file an issue as soon as something goes wrong, but that's probably not going to work if you have multiple dependencies that need updating in tandem</p>",
        "id": 534808050,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1755416278
    },
    {
        "content": "<p>There's also been discussions about tooling that will automate downstream changes even further, but I don't know if that's on anyone's roadmap right now</p>",
        "id": 534808106,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1755416346
    },
    {
        "content": "<p>In a thread far far away, <span class=\"user-mention\" data-user-id=\"947624\">@Leo Sin</span> asked:</p>\n<p><span class=\"user-mention silent\" data-user-id=\"947624\">Leo Sin</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Cryptographic.20Hash.20Functions/near/534791947\">said</a>:</p>\n<blockquote>\n<p>Btw just wondering are there any tips/prescriptions/best practices in terms of managing lean-toolchain versions to keep forward compatibility for third-party library maintainers?<br>\nBecause some libraries with old toolchain version seems do not play well with new versions of batteries and/or mathlib...</p>\n</blockquote>",
        "id": 534811542,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1755421654
    },
    {
        "content": "<p>A message was moved from this topic to <a class=\"stream-topic\" data-stream-id=\"113488\" href=\"/#narrow/channel/113488-general/topic/advice.20on.20updating.20libraries/with/534811542\">#general &gt; advice on updating libraries</a> by <span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span>.</p>",
        "id": 534811559,
        "sender_full_name": "Notification Bot",
        "timestamp": 1755421681
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/113488-general/topic/advice.20on.20updating.20libraries/near/534794051\">said</a>:</p>\n<blockquote>\n<p>Keep updating to new toolchains, and creating a tag <code>v4.X.0</code> every time you update, so downstream libraries can pin to a compatible version. There are some automatic tools to create these tags for you.</p>\n</blockquote>\n<p>The tag <code>v4.X.0</code> conflicts with using semver for a project. I think <code>lean-v4.X.0</code> would be a better alternative for these tags on downstream projects.</p>",
        "id": 534823923,
        "sender_full_name": "Fran√ßois G. Dorais",
        "timestamp": 1755437459
    },
    {
        "content": "<p>Indeed. Mathlib does not follow semver, but downstream projects could.</p>",
        "id": 534831357,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1755446209
    },
    {
        "content": "<p>I'd argue that for projects depending on mathlib, most of the benefits of semver are already harnessed by following these rallying points, and that compatibility with the Lean core version is more important. Yet, semver is (as I understand it), <em>incredibly</em> useful in (e.g.) the Rust ecosystem, and not obstructing that unnecessarily sounds useful.</p>",
        "id": 534831416,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1755446287
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/113488-general/topic/advice.20on.20updating.20libraries/near/534794051\">said</a>:</p>\n<blockquote>\n<p>Keep updating to new toolchains, and creating a tag <code>v4.X.0</code> every time you update, so downstream libraries can pin to a compatible version. There are some automatic tools to create these tags for you.</p>\n<p>See <a href=\"https://github.com/leanprover-community/mathlib-update-action/blob/HEAD/README.md\">https://github.com/leanprover-community/mathlib-update-action/blob/HEAD/README.md</a> and<br>\n<a href=\"https://github.com/leanprover-community/lean-release-tag/blob/HEAD/README.md\">https://github.com/leanprover-community/lean-release-tag/blob/HEAD/README.md</a></p>\n</blockquote>\n<p>This looks very useful, thanks!<br>\nIt means making projects downstream live on the bleeding edge to upgrade, but this seems ok given how quickly the Lean ecosystem is still evolving.</p>\n<p>What is Lean's release/tag cadence? This becomes relevant info as soon as one considers the action. Might be worth putting a link to that in the action's documentation.</p>",
        "id": 534835889,
        "sender_full_name": "Fabrizio Montesi",
        "timestamp": 1755451413
    },
    {
        "content": "<p>Monthly stable releases</p>",
        "id": 534836105,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1755451627
    }
]