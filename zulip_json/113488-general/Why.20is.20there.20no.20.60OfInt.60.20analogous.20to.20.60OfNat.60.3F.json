[
    {
        "content": "<p>I am not able to find such a thing, but it would be convenient. In particular I would like to be able to do the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">sliceix</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">OfNat</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">ofNat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">sliceix</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"c1\">-- This doesn't seem to have any effect:</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Coe</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">sliceix</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"test[\"</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"o\">,</span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"s2\">\"]\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span>\n<span class=\"kn\">macro_rules</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"bp\">$</span><span class=\"n\">ix</span><span class=\"o\">,</span><span class=\"bp\">*</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">$</span><span class=\"n\">ix</span><span class=\"o\">,</span><span class=\"bp\">*</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"o\">)</span>\n\n<span class=\"c1\">-- This works fine:</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">.</span><span class=\"n\">sliceix</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n\n<span class=\"c1\">-- Want to support negative indexing a la numpy, but these fail</span>\n<span class=\"c1\">-- \"failed to synthesize Neg SliceTerm\"</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">diagnostics</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">.</span><span class=\"n\">sliceix</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">.</span><span class=\"n\">sliceix</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>is there another way that i'm missing? how does one use Int's like this?</p>",
        "id": 544655058,
        "sender_full_name": "samuela",
        "timestamp": 1760414993
    },
    {
        "content": "<p>Define a new <code>GetElem</code> instance that takes <code>Int</code> as the index type.</p>",
        "id": 544660506,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1760418429
    },
    {
        "content": "<p>IIUC the connection with GetElem here is mostly coincidental. This is a snippet extracted from a larger bit of code designed to support indexing on multiple axes of an array which I believe goes beyond what GetElem allows:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">NonEllipsisSliceTerm</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Singleton</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">NonEllipsisSliceTerm</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">NewAxis</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NonEllipsisSliceTerm</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Colon</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NonEllipsisSliceTerm</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">BEq</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Other</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NonEllipsisSliceTerm</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Ellipsis</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">BEq</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">OfNat</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">ofNat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">Other</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">Singleton</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Coe</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">Other</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">Singleton</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"...\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span>\n<span class=\"kn\">macro_rules</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"bp\">...</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">SliceTerm</span><span class=\"bp\">.</span><span class=\"n\">Ellipsis</span><span class=\"o\">)</span>\n\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"newaxis\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span>\n<span class=\"kn\">macro_rules</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">newaxis</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">Other</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">NewAxis</span><span class=\"o\">)</span>\n\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\":\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span>\n<span class=\"kn\">macro_rules</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(:)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">Other</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">Colon</span><span class=\"o\">)</span>\n\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"test[\"</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"o\">,</span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"s2\">\"]\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span>\n\n<span class=\"kn\">macro_rules</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"bp\">$</span><span class=\"n\">ix</span><span class=\"o\">,</span><span class=\"bp\">*</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">$</span><span class=\"n\">ix</span><span class=\"o\">,</span><span class=\"bp\">*</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"o\">)</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"bp\">...</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">.</span><span class=\"n\">Ellipsis</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"bp\">...</span><span class=\"o\">]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">:,</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">:,</span><span class=\"w\"> </span><span class=\"o\">:,</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">:,</span><span class=\"w\"> </span><span class=\"o\">:,</span><span class=\"w\"> </span><span class=\"o\">:,</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">:,</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">:,</span><span class=\"w\"> </span><span class=\"o\">:,</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"bp\">...</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">newaxis</span><span class=\"o\">]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"bp\">...</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">newaxis</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"o\">]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">)]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">]</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"bp\">-</span><span class=\"mi\">6</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>Would GetElem support comma-separated values as keys/indices? If so, that would be great. I was under the impression that was not possible</p>",
        "id": 544856773,
        "sender_full_name": "samuela",
        "timestamp": 1760488247
    },
    {
        "content": "<p>No, <code>GetElem</code> is already complicated enough and we don't intend to add features like this.</p>",
        "id": 544856931,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1760488384
    },
    {
        "content": "<p>Alternatively you can add a <code>Neg</code> instance <a href=\"https://live.lean-lang.org/#codez=JYOwJgrgxgLsBuBTABAOQPYgKIBsfAAcBnYIgZXykQBVEAnAW2QHcALexAKGWQB9kyoAOY5EMTMgBcyAJIgYyALQA+NJlz5ipCsCq1G3PmkTMAggA9SUtdjyES5SjXoND/AMLocE6RluaHHT0XTjB6BGFkACEsAEdOTlBIWAQUIOdGFnY6Lh5+AHkYbOs/DXttJ30mFQFKkLzkMq0ia3Sq0PD4SJj4xJAiGABDECprfIAzVEGFNpdkECyOQ3RJ6akAXmQAOkLigAotwRARMQkQAEoE0AHh0elPFDkZusy2JZ4odBRJTfGIBYW61UOyK9GQByOJ3EAMufRuI2+xiEtV0GSYbxyhhAiGRP2QfwWhgaIP2h2Eomh83OPCB212YIh5NOCz2igulx4DXQzFIKFp3N5CSIAE95INzMgAERbGWS6wwEIMQZQOjoAD6dAgoiInH4AAMDjLqbSDbNGFsmg5YSKxRLJdjmOLSHLpAqDEqVerNdrdcgDQ6nURjaoDSSwVtUCYLKRraKhnbJC7kG7XB7VRqtYgdfq9pJg36DvS6NtPN4LkK4+KpQqBgBtOUpgA0ACopQBdJMphJpr2Z7MFmswWsAEmA5hbbfzBop+PQ6GsABlSM9UVUNsgR2OJwBuWfoWGIcyDBgEUTyrNDmVbNvITa1i12Zo3vF0cY4BIAYig7CgAGtkxe94ym2nBfj+/6DrWACMjbbMBoHfogf4AXWMFSLBV4gWBSEQYBaGSLBBFwdeCHgShQ74YRVHEVhiHIZBaGYaROHkdB1FMdh9F4dRREcXRuGoRhMqwQAbLRZGQQADEJWywdJxFyeJLGQVesEBpYRBKVxdaqcg8nqaQinMdpQ6SVpAlDqyUHnOZrGKFBtmQYoYmcIex6noiTkObeG5hsWjLHBSEhWecNnrq+75uSeZ6uoBigAExybB9mwYxwE+feRbgmSgXMuCCWhRhWUBVCEiSecRWgv5OWlSy9mFXSVXZZCQULNZGGWqQz6bBFnBAA\">example</a>.</p>",
        "id": 544858139,
        "sender_full_name": "Chris Bailey",
        "timestamp": 1760489399
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"378466\">samuela</span> <a href=\"#narrow/stream/113488-general/topic/Why.20is.20there.20no.20.60OfInt.60.20analogous.20to.20.60OfNat.60.3F/near/544856773\">said</a>:</p>\n<blockquote>\n<p>Would GetElem support comma-separated values as keys/indices? If so, that would be great. I was under the impression that was not possible</p>\n</blockquote>\n<p>This seems RFC worthy to me, especially if you compare to how other languages support this in that RFC. Perhaps now is not the time for Lean to start working on this, an RFC would be something to link next time this comes up</p>",
        "id": 544905500,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1760516830
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"228466\">Chris Bailey</span> <a href=\"#narrow/channel/113488-general/topic/Why.20is.20there.20no.20.60OfInt.60.20analogous.20to.20.60OfNat.60.3F/near/544858139\">said</a>:</p>\n<blockquote>\n<p>Alternatively you can add a <code>Neg</code> instance <a href=\"https://live.lean-lang.org/#codez=JYOwJgrgxgLsBuBTABAOQPYgKIBsfAAcBnYIgZXykQBVEAnAW2QHcALexAKGWQB9kyoAOY5EMTMgBcyAJIgYyALQA+NJlz5ipCsCq1G3PmkTMAggA9SUtdjyES5SjXoND/AMLocE6RluaHHT0XTjB6BGFkACEsAEdOTlBIWAQUIOdGFnY6Lh5+AHkYbOs/DXttJ30mFQFKkLzkMq0ia3Sq0PD4SJj4xJAiGABDECprfIAzVEGFNpdkECyOQ3RJ6akAXmQAOkLigAotwRARMQkQAEoE0AHh0elPFDkZusy2JZ4odBRJTfGIBYW61UOyK9GQByOJ3EAMufRuI2+xiEtV0GSYbxyhhAiGRP2QfwWhgaIP2h2Eomh83OPCB212YIh5NOCz2igulx4DXQzFIKFp3N5CSIAE95INzMgAERbGWS6wwEIMQZQOjoAD6dAgoiInH4AAMDjLqbSDbNGFsmg5YSKxRLJdjmOLSHLpAqDEqVerNdrdcgDQ6nURjaoDSSwVtUCYLKRraKhnbJC7kG7XB7VRqtYgdfq9pJg36DvS6NtPN4LkK4+KpQqBgBtOUpgA0ACopQBdJMphJpr2Z7MFmswWsAEmA5hbbfzBop+PQ6GsABlSM9UVUNsgR2OJwBuWfoWGIcyDBgEUTyrNDmVbNvITa1i12Zo3vF0cY4BIAYig7CgAGtkxe94ym2nBfj+/6DrWACMjbbMBoHfogf4AXWMFSLBV4gWBSEQYBaGSLBBFwdeCHgShQ74YRVHEVhiHIZBaGYaROHkdB1FMdh9F4dRREcXRuGoRhMqwQAbLRZGQQADEJWywdJxFyeJLGQVesEBpYRBKVxdaqcg8nqaQinMdpQ6SVpAlDqyUHnOZrGKFBtmQYoYmcIex6noiTkObeG5hsWjLHBSEhWecNnrq+75uSeZ6uoBigAExybB9mwYxwE+feRbgmSgXMuCCWhRhWUBVCEiSecRWgv5OWlSy9mFXSVXZZCQULNZGGWqQz6bBFnBAA\">example</a>.</p>\n</blockquote>\n<p>My concern here is that this allows negating things like newaxis: <a href=\"https://live.lean-lang.org/#codez=JYOwJgrgxgLsBuBTABAOQPYgKIBsfAAcBnYIgZXykQBVEAnAW2QHcALexAKGWQB9kyoAOY5EMTMgBcyAJIgYyALQA+NJlz5ipCsCq1G3PmkTMAggA9SUtdjyES5SjXoND/AMLocE6RluaHHT0XTjB6BGFkACEsAEdOTlBIWAQUIOdGFnY6Lh5+AHkYbOs/DXttJ30mFQFKkLzkMq0ia3Sq0PD4SJj4xJAiGABDECprfIAzVEGFNpdkECyOQ3RJ6akAXmQAOkLigAotwRARMQkQAEoE0AHh0elPFDkZusy2JZ4odBRJTfGIBYW61UOyK9GQByOJ3EAMufRuI2+xiEtV0GSYbxyhhAiGRP2QfwWhgaIP2h2Eomh83OPCB212YIh5NOCz2igulx4DXQzFIKFp3N5CSIAE95INzMgAERbGWS6wwEIMQZQOjoAD6dAgoiInH4AAMDjLqbSDbNGFsmg5YSKxRLJdjmOLSHLpAqDEqVerNdrdcgDQ6nURjaoDSSwVtUCYLKRraKhnbJC7kG7XB7VRqtYgdfq9pJg36DvS6NtPN4LkK4+KpQqBgBtOUpgA0ACopQBdJMphJpr2Z7MFmswWsAEmA5hbbfzBop+PQ6GsABlSM9UVUNsgR2OJwBuWfoWGIcyDBgEUTyrNDmVbNvITa1i12Zo3vF0cY4BKKRTIADqpmonAAYigdgoAAa2TC9azZExAzbQDgMQMCILrRRJDgoA\">example</a></p>\n<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/113488-general/topic/Why.20is.20there.20no.20.60OfInt.60.20analogous.20to.20.60OfNat.60.3F/near/544905500\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"378466\">samuela</span> <a href=\"#narrow/stream/113488-general/topic/Why.20is.20there.20no.20.60OfInt.60.20analogous.20to.20.60OfNat.60.3F/near/544856773\">said</a>:</p>\n<blockquote>\n<p>Would GetElem support comma-separated values as keys/indices? If so, that would be great. I was under the impression that was not possible</p>\n</blockquote>\n<p>This seems RFC worthy to me, especially if you compare to how other languages support this in that RFC. Perhaps now is not the time for Lean to start working on this, an RFC would be something to link next time this comes up</p>\n</blockquote>\n<p>This is the sort of thing I would happily updoot. Not sure how the powers that be feel towards the current GetElem. Personally I don't mind the hassle of defining custom syntax, so long as it's possible to get that custom syntax to work with integers</p>",
        "id": 545112037,
        "sender_full_name": "samuela",
        "timestamp": 1760556110
    },
    {
        "content": "<p>Another option is to not use a minus sign at all and instead use something like <code>arr[←1]</code> to access from the end of the array. Maybe there's some advantage to negative numbers I'm not aware of, but it seems like it can cause arithmetic bugs to lead to accessing random elements of the array rather than crashing, which is better.</p>",
        "id": 545847698,
        "sender_full_name": "Niels Voss",
        "timestamp": 1760897701
    },
    {
        "content": "<p>There's a fair amount of numpy code that does arithmetic to access things on the \"negative\" side of the array, eg arr[-i-1]. I suppose it's debatable whether this is good or not</p>",
        "id": 545853809,
        "sender_full_name": "samuela",
        "timestamp": 1760904248
    },
    {
        "content": "<p>You could consider writing a more interesting custom elaborator here that first tries to elaborate the argument as an <code>Int</code> before falling back on the general setting</p>",
        "id": 545857302,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1760908424
    },
    {
        "content": "<p>That would allow <code>-1</code> to just work</p>",
        "id": 545857324,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1760908449
    },
    {
        "content": "<p>I like Niels' suggestion. Julia has a similar thing where you write <code>arr[end-i]</code> for what Python calls <code>arr[-i]</code>. I think a lot of people agree that Numpy's indexing was a bit of hack that had to work with the syntax Python had available to overload; other languages have tried to do better, and I think Lean should be one such.</p>\n<p>Allowing /negative integers/ to just happen to wrap around like that, is really responsible for a ton of logic bugs in software these days. Often vulnerabilities too. And yes, Lean has proofs, but I think it would be a big easy thing to mess up on the spec.</p>",
        "id": 546359456,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1761104270
    },
    {
        "content": "<p>I agree, to me negative indexing seems like a lot of work for buggier code that adds no new functionality.</p>",
        "id": 547943713,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1761832939
    },
    {
        "content": "<p>we have <code>Fin.rev</code> you know...</p>",
        "id": 547946090,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1761833486
    },
    {
        "content": "<p>To clarify: the goal is not to design a \"good\" array indexing system. The goal is to model numpy in lean, warts and all</p>",
        "id": 547962354,
        "sender_full_name": "samuela",
        "timestamp": 1761836898
    }
]