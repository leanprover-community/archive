[
    {
        "content": "<p>For a variety of reasons, I'm trying to typecheck individual, stand-alone Lean4 files from the command line. In particular, I don't want a project file. I've found various things (mostly through search engines, the documentation is not written with this use-case in mind !) but I'm not sure if any of them are even close to 'idiomatic'. [I'm eventually going to do some benchmarking, so I want to minimize pointless overhead.]</p>",
        "id": 527588803,
        "sender_full_name": "Jacques Carette",
        "timestamp": 1751936879
    },
    {
        "content": "<p><code>lean foo.lean</code> is pretty much the way, is there a specific issue you're asking about?</p>",
        "id": 527589085,
        "sender_full_name": "Julian Berman",
        "timestamp": 1751937168
    },
    {
        "content": "<p>Oh, that's odd -- it's working perfectly now. Earlier, when I tried that, it complained about packages.</p>",
        "id": 527589616,
        "sender_full_name": "Jacques Carette",
        "timestamp": 1751937601
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"326322\">Jacques Carette</span> has marked this topic as resolved.</p>",
        "id": 527589636,
        "sender_full_name": "Notification Bot",
        "timestamp": 1751937623
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"326322\">Jacques Carette</span> <a href=\"#narrow/channel/113488-general/topic/.E2.9C.94.20Command-line.20Lean/near/527589616\">said</a>:</p>\n<blockquote>\n<p>Oh, that's odd -- it's working perfectly now. Earlier, when I tried that, it complained about packages.</p>\n</blockquote>\n<p>Is it possible that you were trying <code>lake build foo.lean</code>?</p>",
        "id": 527590786,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1751938705
    },
    {
        "content": "<p>I tried a great many things, including that, yes. And variants on that. Because that's what I found out there when I searched.</p>",
        "id": 527591015,
        "sender_full_name": "Jacques Carette",
        "timestamp": 1751938926
    },
    {
        "content": "<p>Amazing how it's the simplest things that work.</p>",
        "id": 527591033,
        "sender_full_name": "Jacques Carette",
        "timestamp": 1751938942
    },
    {
        "content": "<p>The difficulties mainly start when you want to import non-core things when using <code>lean foo.lean</code> to build the file. The exact way that package information is passed to lean has changed a bit and is not really stable, and the latest design is likely to not be very human friendly (you have to pass every module and its location in an environment variable)</p>",
        "id": 527591534,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1751939399
    },
    {
        "content": "<p><code>lake env lean foo.lean</code> is a pretty generic way to get lake to compute the environment you need to run <code>lean</code> with</p>",
        "id": 527591610,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1751939458
    },
    {
        "content": "<p>Again, weird: I tried <code>lake env lean</code> too! Ah well, seems my setup is now fixed, all these things work.</p>",
        "id": 527591768,
        "sender_full_name": "Jacques Carette",
        "timestamp": 1751939583
    },
    {
        "content": "<p>If I'm benchmarking, I probably should go with raw <code>lean</code>, right? I guess I can probably do both, the overhead will only matter for micro-benchmarks.</p>",
        "id": 527591831,
        "sender_full_name": "Jacques Carette",
        "timestamp": 1751939647
    },
    {
        "content": "<p>you can insert a <code>perf</code> call in the middle to avoid profiling lake btw, i.e. <code>lake env perf stat lean foo.lean</code></p>",
        "id": 527592054,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1751939813
    },
    {
        "content": "<p>We're trying to benchmark multiple ITPs in a uniform way, so we need to use \"external means\" to do that. (We are removing the start-up overhead of each system.)</p>",
        "id": 527592284,
        "sender_full_name": "Jacques Carette",
        "timestamp": 1751940007
    }
]