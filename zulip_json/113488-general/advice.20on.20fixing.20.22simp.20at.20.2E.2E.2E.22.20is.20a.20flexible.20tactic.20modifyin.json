[
    {
        "content": "<p>At <a href=\"https://github.com/tkxue/func_algo/blob/main/FuncAlgo/C01_Sort.lean\">https://github.com/tkxue/func_algo/blob/main/FuncAlgo/C01_Sort.lean</a> I have a port of <a href=\"https://softwarefoundations.cis.upenn.edu/vfa-current/Sort.html\">https://softwarefoundations.cis.upenn.edu/vfa-current/Sort.html</a></p>\n<p>It's a Lean4 translation of (1) defining insertion sort, (2) two defs of what \"sorted\" means, and (3) proving InsertSort satisfies both defs of \"sorted\", (4) both defs of sorted are equal.</p>\n<p>I am mostly okay with the proof, except for this warning:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">cat</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"bp\">.</span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">grep</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">grep</span><span class=\"w\"> </span><span class=\"s2\">\"is a flexible\"</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">wc</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">l</span>\n<span class=\"mi\">19</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">cat</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"bp\">.</span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">grep</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">grep</span><span class=\"w\"> </span><span class=\"s2\">\"is a flexible\"</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">100</span><span class=\"o\">:</span><span class=\"mi\">20</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv</span><span class=\"w\"> </span><span class=\"n\">h_jv'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h_iv'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">100</span><span class=\"o\">:</span><span class=\"mi\">20</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv</span><span class=\"w\"> </span><span class=\"n\">h_jv'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h_jv'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">121</span><span class=\"o\">:</span><span class=\"mi\">9</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h_iv'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">122</span><span class=\"o\">:</span><span class=\"mi\">11</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h_iv'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">133</span><span class=\"o\">:</span><span class=\"mi\">16</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h_iv'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">133</span><span class=\"o\">:</span><span class=\"mi\">50</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h3'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h3'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">134</span><span class=\"o\">:</span><span class=\"mi\">18</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h_iv'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">138</span><span class=\"o\">:</span><span class=\"mi\">13</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h_iv'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">138</span><span class=\"o\">:</span><span class=\"mi\">46</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h3'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h3'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">139</span><span class=\"o\">:</span><span class=\"mi\">46</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h3'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h3'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">139</span><span class=\"o\">:</span><span class=\"mi\">13</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h_iv'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">140</span><span class=\"o\">:</span><span class=\"mi\">15</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h_iv'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">140</span><span class=\"o\">:</span><span class=\"mi\">52</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h3'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h3'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">165</span><span class=\"o\">:</span><span class=\"mi\">14</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv</span><span class=\"w\"> </span><span class=\"n\">h_jv'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h_iv'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">165</span><span class=\"o\">:</span><span class=\"mi\">14</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv</span><span class=\"w\"> </span><span class=\"n\">h_jv'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h_jv'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">167</span><span class=\"o\">:</span><span class=\"mi\">6</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv</span><span class=\"w\"> </span><span class=\"n\">h_jv'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h_jv'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">167</span><span class=\"o\">:</span><span class=\"mi\">6</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv</span><span class=\"w\"> </span><span class=\"n\">h_jv'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h_iv'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">214</span><span class=\"o\">:</span><span class=\"mi\">9</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hi'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">hi'</span><span class=\"bp\">…</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FuncAlgo</span><span class=\"bp\">/</span><span class=\"n\">C01_Sort</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">261</span><span class=\"o\">:</span><span class=\"mi\">12</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv'</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">flexible</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">h_iv'</span><span class=\"bp\">…</span>\n</code></pre></div>\n<p>There's three questions here:</p>\n<ol>\n<li>Why am I using simp in the first place ?</li>\n<li>Why is this bad ?</li>\n<li>How do we fix this ?</li>\n</ol>\n<h2>Why am I using <code>simp</code> in the first place ?</h2>\n<p>The reason I'm using <code>simp</code> is that in \"walking through the code/spec symbolically of InsertSort\", we often get things like:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lst</span><span class=\"o\">[</span><span class=\"n\">idx</span><span class=\"o\">]</span><span class=\"bp\">?</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">t</span>\n</code></pre></div>\n<p>then we do do some cases, and this becomes</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">x0</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">x1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">+</span><span class=\"mi\">2</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">t</span>\n</code></pre></div>\n<p>and we need <code>simp</code> to get one of <code>x0 = t</code>, <code>x1 = t</code>, or <code>xs[i] = t</code></p>\n<h2>Why is this bad ?</h2>\n<p>I have no idea. My suspicion is that maybe <code>simp</code> has its code changed over time, and this might cause <code>simp</code> to do different things, or simplify in different ways, which then causes the proof to break? [Not sure].</p>\n<h2>How do we fix this ?</h2>\n<p>I have no clue. I'm asking for advice here. It is not obvious to me at all how to fix all the <code>sim at h#</code>'s.</p>\n<p>Thanks!</p>",
        "id": 561806999,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764832287
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span>, <span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span>, could we make fixing this a high priority (possibly removing it from the standard linter set right now?) It's really unkind to users to give them non-actionable warnings like this.</p>",
        "id": 561810729,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1764834053
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"1001511\">@TongKe Xue</span>, in the meantime, try replacing each such <code>simp</code> with <code>simp?</code>, and then using the \"Try this:\" suggestion that appears in the InfoView.</p>",
        "id": 561810806,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1764834089
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/113488-general/topic/advice.20on.20fixing.20.22simp.20at.20.2E.2E.2E.22.20is.20a.20flexible.20tactic.20modifyin/near/561810729\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span>, <span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span>, could we make fixing this a high priority (possibly removing it from the standard linter set right now?) It's really unkind to users to give them non-actionable warnings like this.</p>\n</blockquote>\n<p>Yes, let's revert enabling the linter until we have better warnings.</p>",
        "id": 561814707,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1764835613
    },
    {
        "content": "<p>Do we want to revert the linter in mathlib or enabling the linter in other projects? I do think we want it in mathlib, for instance.</p>",
        "id": 561815084,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1764835765
    },
    {
        "content": "<p>Disabled the linter in <a href=\"https://github.com/leanprover-community/mathlib4/pull/32420\">#32420</a></p>",
        "id": 561816856,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1764836405
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> </p>\n<ol>\n<li>\n<p>Thank you for the simp  -&gt; simp? -&gt; info view \"apply fix\" advice. Very cool feature. It explicitly lists out the rules simp uses for simplifying.</p>\n</li>\n<li>\n<p>I have a followup issue. Captured screencast: <a href=\"https://www.youtube.com/watch?v=MIbHfvDxorM\">https://www.youtube.com/watch?v=MIbHfvDxorM</a></p>\n<div class=\"youtube-video message_inline_image\"><a data-id=\"MIbHfvDxorM\" href=\"https://www.youtube.com/watch?v=MIbHfvDxorM\"><img src=\"https://uploads.zulipusercontent.net/50da054fd5989c18a6d85d7a192e1aae006bc0c3/68747470733a2f2f692e7974696d672e636f6d2f76692f4d496248667644786f724d2f6d7164656661756c742e6a7067\"></a></div></li>\n<li>\n<p>In text: I'm running into a followup issue regarding readability (perhaps this is due to poor structuring of the proof). The issue is as follows -- I'm not sure getting rid of the linter error makes the proof more readable</p>\n</li>\n</ol>\n<p>before:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">      </span><span class=\"c1\">-- | 0 =&gt; simp at h_iv; have h3 := h 1 iv; simp at h3; apply h3 h_iv</span>\n<span class=\"w\">      </span><span class=\"c1\">-- | 1 =&gt; simp at h_iv; have h3 := h 0 iv; simp at h3; apply h3 h_iv</span>\n<span class=\"w\">      </span><span class=\"c1\">-- | i+2 =&gt; simp at h_iv; have h3 := h (i+2) iv; simp at h3; apply h3 h_iv</span>\n</code></pre></div>\n<p>after:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">     </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">          </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">length_cons</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">lt_add_iff_pos_left</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">add_pos_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">ofNat_pos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">or_true</span><span class=\"o\">,</span>\n<span class=\"w\">            </span><span class=\"n\">getElem?_pos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">getElem_cons_zero</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"bp\">.</span><span class=\"n\">some</span><span class=\"bp\">.</span><span class=\"n\">injEq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h3</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">iv</span><span class=\"bp\">;</span>\n<span class=\"w\">          </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">length_cons</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">lt_add_iff_pos_left</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">add_pos_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">zero_lt_one</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">or_true</span><span class=\"o\">,</span>\n<span class=\"w\">            </span><span class=\"n\">getElem?_pos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">getElem_cons_succ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">getElem_cons_zero</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"bp\">.</span><span class=\"n\">some</span><span class=\"bp\">.</span><span class=\"n\">injEq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h3</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h3</span><span class=\"w\"> </span><span class=\"n\">h_iv</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">          </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">length_cons</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">lt_add_iff_pos_left</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">add_pos_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">zero_lt_one</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">or_true</span><span class=\"o\">,</span>\n<span class=\"w\">            </span><span class=\"n\">getElem?_pos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">getElem_cons_succ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">getElem_cons_zero</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"bp\">.</span><span class=\"n\">some</span><span class=\"bp\">.</span><span class=\"n\">injEq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h3</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">iv</span><span class=\"bp\">;</span>\n<span class=\"w\">          </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">length_cons</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">lt_add_iff_pos_left</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">add_pos_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">ofNat_pos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">or_true</span><span class=\"o\">,</span>\n<span class=\"w\">            </span><span class=\"n\">getElem?_pos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">getElem_cons_zero</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"bp\">.</span><span class=\"n\">some</span><span class=\"bp\">.</span><span class=\"n\">injEq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h3</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h3</span><span class=\"w\"> </span><span class=\"n\">h_iv</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">+</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">          </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">getElem?_cons_succ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h_iv</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h3</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"bp\">+</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">iv</span><span class=\"bp\">;</span>\n<span class=\"w\">          </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">getElem?_cons_succ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h3</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h3</span><span class=\"w\"> </span><span class=\"n\">h_iv</span>\n<span class=\"bp\">```</span>\n\n<span class=\"n\">So</span><span class=\"w\"> </span><span class=\"n\">my</span><span class=\"w\"> </span><span class=\"s2\">\"updated\"</span><span class=\"w\"> </span><span class=\"n\">problem</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"o\">:</span>\n\n<span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"simp at ...\"</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">warning</span>\n<span class=\"o\">(</span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"simp only [...] at ...\"</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">imho</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">proof</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">less</span><span class=\"w\"> </span><span class=\"n\">readable</span>\n\n<span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">suspect</span><span class=\"w\"> </span><span class=\"n\">I'm</span><span class=\"w\"> </span><span class=\"n\">doing</span><span class=\"w\"> </span><span class=\"n\">something</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"n\">wrong</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">perhaps</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">overall</span><span class=\"w\"> </span><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">proof?</span><span class=\"o\">)</span>\n\n<span class=\"n\">Advice</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">however</span><span class=\"w\"> </span><span class=\"n\">crazy</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">appreciated</span><span class=\"bp\">.</span>\n\n<span class=\"o\">(</span><span class=\"n\">Aside</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Is</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">good</span><span class=\"w\"> </span><span class=\"n\">time</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">invest</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">.</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">io</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">metaprogramming</span><span class=\"bp\">-</span><span class=\"n\">book</span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">try</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">roll</span><span class=\"w\"> </span><span class=\"n\">my</span><span class=\"w\"> </span><span class=\"n\">own</span><span class=\"w\"> </span><span class=\"n\">mini</span><span class=\"w\"> </span><span class=\"n\">tactics</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">handling</span><span class=\"w\"> </span><span class=\"n\">these</span><span class=\"w\"> </span><span class=\"s2\">\"verifying functional algorithm\"</span><span class=\"w\"> </span><span class=\"n\">program</span><span class=\"w\"> </span><span class=\"n\">proofs?</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">feels</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">bit</span><span class=\"w\"> </span><span class=\"n\">early</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">sure</span><span class=\"o\">])</span>\n\n<span class=\"n\">Thanks!</span>\n</code></pre></div>",
        "id": 561819699,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764837397
    },
    {
        "content": "<p>One trick you need to learn is the <code>simpa</code> tactic.</p>",
        "id": 561820163,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1764837565
    },
    {
        "content": "<p>I was able to change</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">      </span><span class=\"c1\">-- | 0 =&gt; simp at h_iv; have h3 := h 1 iv; simp at h3; apply h3 h_iv</span>\n<span class=\"w\">      </span><span class=\"c1\">-- | 1 =&gt; simp at h_iv; have h3 := h 0 iv; simp at h3; apply h3 h_iv</span>\n<span class=\"w\">      </span><span class=\"c1\">-- | i+2 =&gt; simp at h_iv; have h3 := h (i+2) iv; simp at h3; apply h3 h_iv</span>\n</code></pre></div>\n<p>to</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">      </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">iv</span><span class=\"o\">)</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">h_iv</span><span class=\"bp\">;</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">iv</span><span class=\"o\">)</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">h_iv</span><span class=\"bp\">;</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">+</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"bp\">+</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">iv</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">h_iv</span><span class=\"bp\">;</span>\n</code></pre></div>\n<p>My understanding here is:</p>\n<ul>\n<li>simpa is simp + assumption; but requires we close goal; and does not trigger linter warning</li>\n<li>it's not clear if we can reduce this to 1 line; the goal state at the start is:</li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">goal</span>\n<span class=\"n\">l1</span><span class=\"w\"> </span><span class=\"n\">l2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n<span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n<span class=\"n\">lst</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n<span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List_fa</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">lst</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">f</span>\n<span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">iv</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n<span class=\"n\">h_iv</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">lst</span><span class=\"o\">)[</span><span class=\"mi\">0</span><span class=\"o\">]</span><span class=\"bp\">?</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">iv</span>\n<span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">iv</span>\n</code></pre></div>",
        "id": 561826983,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764839492
    },
    {
        "content": "<p><a href=\"https://github.com/tkxue/func_algo/commit/bf516c3c952bf49185d55c3e7ad686bd45132514\">https://github.com/tkxue/func_algo/commit/bf516c3c952bf49185d55c3e7ad686bd45132514</a></p>\n<p>Using <code>simpa</code> (and rearranging some stuff) solved all the \"simp ... flexible tactic\" linter errors.</p>\n<p>This was instructive. Thanks!</p>",
        "id": 561830844,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764840672
    },
    {
        "content": "<p>My $0.02, after having gone through the issue.</p>\n<ol>\n<li>I think having the linter warning is great. It forced me to re-org the proof, which improved quality.</li>\n<li>I would recommend appending to the linter warning msg something like:</li>\n</ol>\n<p>Two common ways to fix this are:</p>\n<ol>\n<li>change 'simp ..' to 'simp only [...] ...' by (1) changing simp to simp? and (2) using the 'apply fix' button in infoview</li>\n<li>restructure the section using <code>have</code>, <code>apply</code>, <code>suffices</code>, so we can conclude the goal with a single <code>simpa</code></li>\n</ol>",
        "id": 561834221,
        "sender_full_name": "TongKe Xue",
        "timestamp": 1764841807
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/channel/113488-general/topic/advice.20on.20fixing.20.22simp.20at.20.2E.2E.2E.22.20is.20a.20flexible.20tactic.20modifyin/near/561816856\">said</a>:</p>\n<blockquote>\n<p>Disabled the linter in <a href=\"https://github.com/leanprover-community/mathlib4/pull/32420\">#32420</a></p>\n</blockquote>\n<p>I appreciate you keeping it available for downstream projects, we find it very useful already in CSLib!</p>",
        "id": 561867238,
        "sender_full_name": "Chris Henson",
        "timestamp": 1764851971
    },
    {
        "content": "<p>My hope is that after <a href=\"https://github.com/leanprover-community/mathlib4/pull/32421\">#32421</a> lands, the linter can be re-enabled.</p>",
        "id": 561884533,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1764856810
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/32577\">#32577</a> re-enables the linter; the error messages now suggest one way to fix this.<br>\n(It is not always clear which fix is the best; this will require judgement on a case-by-case basis. If all possible fixes are truly worse than the other options, disabling the linter with a comment is also fine.)</p>",
        "id": 562421360,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1765186386
    },
    {
        "content": "<p>The flexible linter comes at a <a href=\"#narrow/channel/116290-rss/topic/Significant.20commits.20to.20mathlib4/near/562535359\">+2.3%</a> overall instruction penalty.</p>",
        "id": 562813409,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1765319413
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"548935\">@Thomas Murrills</span> mentioned the following idea, which hopefully can be implemented at some point. Linters like these would not run by default when working on Mathlib, but at some point you flip a switch and go into \"PR preparation mode\". Then several of these linters kick in, and help you improve your branch to get it PR-ready.</p>\n<p>The linters would also still run in CI, of course. So the performance cost is still there for CI. But not during the authoring phase, where most people spend their time.</p>",
        "id": 562859644,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1765341679
    }
]