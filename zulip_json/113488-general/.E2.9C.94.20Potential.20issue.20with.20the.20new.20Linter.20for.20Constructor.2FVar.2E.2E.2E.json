[
    {
        "content": "<p>I ran into this behavior of the new Linter for Constructor/Variable Confusion introduced in 4.10.0. In the following code sample <code>beq a b </code> sets off the new linter and it suggests </p>\n<blockquote>\n<p>Local variable 'a' resembles constructor 'Test.a' - write '.a' (with a dot) or 'Test.a' to use the constructor.<br>\nnote: this linter can be disabled with <code>set_option linter.constructorNameAsVariable false</code></p>\n</blockquote>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">inductive</span><span class=\"w\"> </span><span class=\"n\">Test</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">b</span>\n\n<span class=\"kd\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BEq</span><span class=\"w\"> </span><span class=\"n\">Test</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">beq</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Test.a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Test.a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Test.b</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Test.b</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">false</span>\n</code></pre></div>\n<p>Note, I know it would be better style to avoid reusing the variable names, but following the lint's advice here leads to a syntax error in a program that did work.</p>\n<p>Is this an issue or am I missing something?</p>",
        "id": 455917306,
        "sender_full_name": "Austin Letson",
        "timestamp": 1722600109
    },
    {
        "content": "<p>In this case</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BEq</span><span class=\"w\"> </span><span class=\"n\">Test</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">beq</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Test</span><span class=\"bp\">.</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Test</span><span class=\"bp\">.</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Test</span><span class=\"bp\">.</span><span class=\"n\">b</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Test</span><span class=\"bp\">.</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">false</span>\n</code></pre></div>\n<p>would be more idiomatic anyway</p>",
        "id": 455920123,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722601194
    },
    {
        "content": "<p>Regarding the message; it should also offer a recommendation to use a different variable name</p>",
        "id": 455920225,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722601221
    },
    {
        "content": "<p>That is; the correct fix to the message is <code>beq x y := match x, y with</code></p>",
        "id": 455920289,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722601243
    },
    {
        "content": "<p>Also, for idiomatic style, we usually do not repeat the the constructor type's name:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BEq</span><span class=\"w\"> </span><span class=\"n\">Test</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">beq</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">b</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">false</span>\n</code></pre></div>\n<p>Additionally, the prurpose of the linter is to avoid clashes between variable names and constructors. The primary problem with this toy example is that the constructors should be name something more meaningful than <code>a</code> and <code>b</code>, which would likely avoid a clash in practice.</p>",
        "id": 455948667,
        "sender_full_name": "Mac Malone",
        "timestamp": 1722609203
    },
    {
        "content": "<p>Got it. I came across this with a toy example. I see how it is unlikely to be an issue in practice. Thanks for the info</p>",
        "id": 456055905,
        "sender_full_name": "Austin Letson",
        "timestamp": 1722639679
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"699684\">Austin Letson</span> has marked this topic as resolved.</p>",
        "id": 456055910,
        "sender_full_name": "Notification Bot",
        "timestamp": 1722639682
    }
]