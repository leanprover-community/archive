[
    {
        "content": "<p>Recently, I moved the correctness proofs in my library into a separate Lake package in a subdirectory like this (<a href=\"https://github.com/pandaman64/lean-regex\">repo</a>):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">regex</span>\n<span class=\"bp\">├</span><span class=\"w\"> </span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">toml</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"w\"> </span><span class=\"n\">Implementation</span><span class=\"w\"> </span><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">without</span><span class=\"w\"> </span><span class=\"n\">any</span><span class=\"w\"> </span><span class=\"n\">dependencies</span>\n<span class=\"bp\">├</span><span class=\"w\"> </span><span class=\"n\">Regex</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"w\">    </span><span class=\"bp\">#</span><span class=\"w\"> </span><span class=\"n\">Root</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">implementation</span>\n<span class=\"bp\">└</span><span class=\"w\"> </span><span class=\"n\">correctness</span>\n<span class=\"w\">     </span><span class=\"bp\">├</span><span class=\"w\"> </span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">toml</span><span class=\"w\">         </span><span class=\"bp\">#</span><span class=\"w\"> </span><span class=\"n\">Package</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">correctness</span><span class=\"w\"> </span><span class=\"n\">proofs</span>\n<span class=\"w\">     </span><span class=\"bp\">└</span><span class=\"w\"> </span><span class=\"n\">RegexCorrectness</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"w\"> </span><span class=\"n\">Root</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">proofs</span>\n</code></pre></div>\n<p>The <code>lake</code> commands work without issues when running at the repository root/in the <code>correctness</code> directory, but I found that the VSCode extension only recognizes packages declared in the root <code>lakefile.toml</code>. In other words, when I opened a file in <code>correctness</code> from a VSCode (launched at the repository root), I got an error like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">unknown</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"kn\">prefix</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">RegexCorrectness'</span>\n\n<span class=\"n\">No</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">RegexCorrectness'</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">RegexCorrectness</span><span class=\"bp\">.</span><span class=\"n\">olean'</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">search</span><span class=\"w\"> </span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"n\">entries</span><span class=\"o\">:</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span>\n<span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span>\n<span class=\"bp\">/</span><span class=\"n\">path</span><span class=\"bp\">/</span><span class=\"n\">to</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---v4.16.0-rc2/lib/lean</span>\n<span class=\"bp\">/</span><span class=\"n\">path</span><span class=\"bp\">/</span><span class=\"n\">to</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---v4.16.0-rc2/lib/lean</span>\n</code></pre></div>\n<p>I could work this issue around by opening a separate VSCode at the <code>correctness</code> directory, but it's a bit inconvenient to switch between two VSCode windows. Is there any way to make the VSCode extension work seamlessly between the two packages in a repository?</p>",
        "id": 493566362,
        "sender_full_name": "pandaman",
        "timestamp": 1736854978
    },
    {
        "content": "<p>Nested Lake packages are currently not supported by the VS Code extension due to a limitation of the VS Code language client library.</p>",
        "id": 493571305,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1736856637
    },
    {
        "content": "<p>What should however work is having one top-level repository that contains multiple disjoint Lake projects.</p>",
        "id": 493571634,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1736856753
    },
    {
        "content": "<p>Thanks! Do you know if Reservoir can find it if I move <code>Regex.lean</code> and its <code>lakefile.toml</code> into a separate directory as well (assuming disjoint Lake project means this)?</p>",
        "id": 493571989,
        "sender_full_name": "pandaman",
        "timestamp": 1736856879
    },
    {
        "content": "<p>Looks like no: <a href=\"https://github.com/leanprover/reservoir/issues/13\">https://github.com/leanprover/reservoir/issues/13</a></p>",
        "id": 493573609,
        "sender_full_name": "pandaman",
        "timestamp": 1736857417
    },
    {
        "content": "<p>Separating all Lake packages into individual directories fixed the issue. Thanks!</p>\n<p>Lake seems to have a notion of workspace as a collection of packages, so I hope I can use it to group my packages and Reservoir recognize them in the future.</p>",
        "id": 493916020,
        "sender_full_name": "pandaman",
        "timestamp": 1736944561
    }
]