[
    {
        "content": "<p>How to get unused declarations by given <code>X</code>?</p>",
        "id": 544357653,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1760225927
    },
    {
        "content": "<p>I want a linter for \"raise a warning against function or constants not used by <code>main</code> function\"</p>",
        "id": 544357681,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1760225977
    },
    {
        "content": "<p>That's probably possible?</p>",
        "id": 544358840,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760227766
    },
    {
        "content": "<p>lots of metaprogramming</p>",
        "id": 544358845,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760227775
    },
    {
        "content": "<p>and I can't promise it will be fast</p>",
        "id": 544358849,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760227794
    },
    {
        "content": "<p>I have ever seen such a command.<br>\nIt is possible to make such a command.<br>\nbut I can’t remember where to see…</p>",
        "id": 544359336,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1760228660
    },
    {
        "content": "<p>yeah I was talking about making a command</p>",
        "id": 544359524,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760228909
    },
    {
        "content": "<p>Unused relative to what, the file, namespace, project?</p>",
        "id": 544359971,
        "sender_full_name": "Chris Bailey",
        "timestamp": 1760229595
    },
    {
        "content": "<p>file or project</p>",
        "id": 544359998,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1760229646
    },
    {
        "content": "<p>Something like <a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAGQKYEMB2AoDExLY1fAUQBsUAjOAYQhBHQBMsGkAzOFgYxIGcBJNABUAFsB4AxYCSRwAXNWhIAsnAByKEEgDKSeLIC8HCBjhwA9AFo4AuCEVwoSTnngA3JFB7AIaHnAjs0uhwMKJ+YnAoJI4oDACeHE5kjgwAdHAWZiZw0vBifODQMEgMNL7wABR4rnJwRGiuwFA+mmgwAJRwFVwk6pq1fUid8gBCEBAkcvrZptWpAOa6ShAMAK7SfAwAHuLQAPyJ3INwAD4AfKliWrRI2blw1XCACYRwizD1rne6tqvwEL9TNQabS6VJIcAwOLZVjQLpoAA0cAA+p1gPg5pwfDwYOgYH4GMZTKZgOwAIQVfKFWAlMrYh4NOBoTqhPAzIkkuCktCXfhtDxoKIAeSgqlWIBCwlZROl/gBBllMEuvg88EwpkcMFWUHw/xgzDYcEx5QEMPEzRAmxcXWADFqgi0cTaKC2cAABjaXMMFI4VLScW0TRBAQSvqrng4kDwJu4AOIkCDkKJ+1QQQXuKDx2JwG2h+k1F5vD7ZegwTjCPOpVhohgHfAAd2AoWyJzgUf6nGAcH0ZzgYC1Mg7zcZPhkRO7EuadaIUGaUFbpIARABvG0AX2H8BhqzQDAXWDAKFgwCiiXYbz9PAAqmgYSQGGj5l0erU/bjA16aD6gZodHpDCHTHuEAARgFYID8eUegWXRLx4GksX9PEAEEeF/VJQKQmcUDiVI+x4csoIFTRc2Av45W/EE/wotDwTASFskcXAUHgAD2XYUCCR4HkiAhKFpRZfANS1HVfjZJBeFuGUcm+TgtUBDjwNSRNOAAa1JABuEIwIgwwFK4yAwDZYl2FkqAeQEYptSFEUxVOFtdVSI0cTRPxTKMiUpSkw0fBgNFVkkmVxLg9zTF1QEHJclVDS1ELbGYssugqAtdA+dpK2rA5TLS8hqy6V8AxvCBUlcKJ/L2ToGybLzTlbG44BKyZu1i0wYTnfA0XqqJoJgWD4PKXF8UJaq2M5BynJQFzGTgAAyabOW5fI+SskhhVFEBmqJAStM4+TtNw1Z8MZWKWzQEcux7Jy/ICoTtQVLAMB4R0cRdCoiJkeUq2ka8DpKToFwAYk+pBvrg3dsxYNpakxOhGCwAABABtaH6B3JFxIoOAgZBkoAF0MBYdh0fILG0B+215BoGGd1ICgMBbV0KmRxgW0BqRgdJ0G4AAEh6Q9Bk6ccSBJGBP2UIxcyiEgLwESRpHDHpeREMRZYC+5bReI1sUDM1aEtSHeZFYEJZIKWEN5AARJJw3PM3r1ve80EfJhAO+ML5Ul6W0BV9KSEsrpWG3OAXXHUkPbNgRLe4RyfIm3wg/aO4IHmQN5wXA2SmzfAgbgcgAW3MnM8OZJASXByMKwuJVz3dVdGEunkXOicICnGdYR4RdE1tR6nS2Pd8YNWIGCRQF1EVQf+/YAAvDwIGH+VR9Safmgn/w0CQOfDAXnhVk4Tg4CX2eV5gOtZ8BQfh5HC+16RLBLFX9fEWP2fEXPjIslZr6OYzg+b7vp+kRfgwIeb8MAf3ZgXS+oCSYF3/hgIAA\">this</a> maybe.</p>\n<p>You can do this more efficiently, but in terms of where you get the stuff. The project level one I think you would just filter based on whether a declaration is from a module that's not from your project (or is in the current file).</p>",
        "id": 544362836,
        "sender_full_name": "Chris Bailey",
        "timestamp": 1760233576
    },
    {
        "content": "<p>The painful part is going to be going through the values if that's the degree of search you're talking about.</p>",
        "id": 544362879,
        "sender_full_name": "Chris Bailey",
        "timestamp": 1760233625
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"228466\">@Chris Bailey</span> Thank you</p>",
        "id": 544378185,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1760253495
    },
    {
        "content": "<p>I think something similar is done in <a href=\"https://github.com/leanprover-community/import-graph\">import-graph</a> although I don't know the details. I think Kim implemented that.</p>\n<p>A PR adding such a tool to that package for others to use would be very welcome and desirable :)</p>",
        "id": 544378446,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1760253881
    },
    {
        "content": "<p>I did something like this recently.  I wanted to know how many of the results in the Math-inc proof of PNT were not actually being used.  I used <a href=\"https://github.com/patrik-cihal/lean-graph\">https://github.com/patrik-cihal/lean-graph</a> which can graph the dependencies of a result or everything in a namespace.  It was a bit hacky because I had to put everything in the project in a namespace but then I was able to use a simple Python script to analyze the dependency graph for unused parts.  This motivated my issue <a href=\"https://github.com/patrik-cihal/lean-graph/issues/4\">https://github.com/patrik-cihal/lean-graph/issues/4</a> because that would make it easier to see what's in the current project and avoid putting everything into a namespace.</p>",
        "id": 544386788,
        "sender_full_name": "Alastair Irving",
        "timestamp": 1760262831
    },
    {
        "content": "<p>There's code to do similar things in import graph as I recall</p>",
        "id": 544397474,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1760272554
    },
    {
        "content": "<p>e.g. <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Name.transitivelyUsedConstants#doc\">docs#Lean.Name.transitivelyUsedConstants</a>.</p>",
        "id": 544716490,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1760439373
    },
    {
        "content": "<p>Mathlib also has a <code>#show_unused</code> command:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">trivial</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">trivial</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">X</span>\n\n<span class=\"bp\">#</span><span class=\"n\">show_unused</span><span class=\"w\"> </span><span class=\"n\">Z</span>\n</code></pre></div>",
        "id": 545980241,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1760967256
    },
    {
        "content": "<p>I don't remember who wrote <a href=\"https://github.com/leanprover-community/flt-regular/blob/master/unseen.lean\">this</a> script, but in practice it works (it's not super fast).</p>",
        "id": 545982441,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1760967788
    }
]