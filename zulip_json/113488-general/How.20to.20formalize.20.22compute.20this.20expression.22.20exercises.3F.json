[
    {
        "content": "<p>I encountered the following question while trying to formalize various exercises in my real analysis textbook.</p>\n<p>It is clear how to formalize an exercise asking to prove that some proposition <code>Statement1</code> is true:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- Exercise 1: Prove `Statement1 : Prop` -/</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Exercise1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Statement1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>(or one could use the <code>example</code> or <code>proof_wanted</code> keywords).  I also figured out a reasonable way to formalize a \"prove or disprove\" exercise:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- Exercise 2: Prove or disprove `Statement2 : Prop` -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Exercise2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Decidable</span><span class=\"w\"> </span><span class=\"n\">Statement2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- The first line of the construction should be `apply isTrue` or `apply isFalse`.</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>But I am wondering how to formalize a \"compute this expression\" type exercise.   The best I can come up with is</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Expression3</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span><span class=\"w\"> </span><span class=\"c1\">-- replace with the expression to be computed</span>\n\n<span class=\"sd\">/-- Exercise 3(a): Compute `Expression3`.</span>\n<span class=\"sd\">    You are not permitted to use the `noncomputable` keyword. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Answer3</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"sd\">/-- Exercise 3(b): Justify your answer. -/</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Exercise3</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Expression3</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Answer3</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>But this is a bit clunky.  Is there a better solution?</p>",
        "id": 525189577,
        "sender_full_name": "Terence Tao",
        "timestamp": 1750559268
    },
    {
        "content": "<p>this is actually a hard problem which has been discussed before, I think there is no perfect solution</p>",
        "id": 525190078,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1750560284
    },
    {
        "content": "<p>Your phrasing of Exercise3 is indeed one of the \"standard\" ways to ask to determine an unknown result of a computation. (In fact yours is even better, using <code>noncomputable</code> to avoid tautology!) I don't think it's all that clunky in practice; students seem to pick it up?</p>",
        "id": 525191490,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1750563155
    },
    {
        "content": "<p>actually, i don't think that the <code>noncomputable</code> bits will always work for this? In particular, this will hardly ever work for any \"computation\" on <code>Real</code> since a lot of operations on the reals are noncomputable in mathlib</p>",
        "id": 525199799,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1750578000
    },
    {
        "content": "<p>so you can't require <code>Answer3</code> to be computable in general</p>",
        "id": 525199836,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1750578073
    },
    {
        "content": "<p>Why not <code>exists Answer3, Expression3 = Answer3</code>?</p>",
        "id": 525202904,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1750583334
    },
    {
        "content": "<p>Because you can solve that with <code>use Expression3</code></p>",
        "id": 525202931,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1750583382
    },
    {
        "content": "<p>You could also do that in Alex‚Äôs setup</p>",
        "id": 525204347,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1750585620
    },
    {
        "content": "<p>It might be worth adding e.g. <code>#eval Answer3</code> to verify it really does compute. In principle it's possible to make a \"computable\" function that doesn't terminate.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">partial</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">loop</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">loop</span><span class=\"w\"> </span><span class=\"n\">i</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">ohno</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">loop</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ohno</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">ohno</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- loops forever</span>\n</code></pre></div>",
        "id": 525204732,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1750586346
    },
    {
        "content": "<p>#eval isn't the answer because a completely reasonable analysis question is \"what is the limit of this ratio of trig functions as x tends to zero\" and a perfectly reasonable answer is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>œÄ</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\pi.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">œÄ</span><span class=\"mord\">.</span></span></span></span></p>",
        "id": 525206636,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1750589587
    },
    {
        "content": "<p>Wait, are you saying that œÄ is <code>computable</code>?</p>",
        "id": 525206828,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1750589895
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"479299\">@Jovan Gerbscheid</span> pi is certainly computable if you follow the logicians' definition</p>",
        "id": 525207124,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750590246
    },
    {
        "content": "<p>If you think about what your question actually means, and try to formalise it... What do you mean when you say \"compute lim[x-&gt;0] sin(x)/x\"?</p>\n<p>You actually mean, reduce it to an expression in terms of natural numbers, some constants (e, pi), and some standard operations (+-x/, exp, ln), etc.</p>",
        "id": 525207263,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750590389
    },
    {
        "content": "<p>so... one brute force way might be to define an inductive type <code>RealExpr</code> <span aria-label=\"melt\" class=\"emoji emoji-1fae0\" role=\"img\" title=\"melt\">:melt:</span></p>",
        "id": 525207284,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750590411
    },
    {
        "content": "<p>and a \"middle way\" of this would be to define the type of \"computable reals\" (I think this has been done before)</p>",
        "id": 525207347,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750590466
    },
    {
        "content": "<p>I guess the <code>RealExpr</code> is actually the closest to formalizing the difference between what you'd mark as correct / incorrect in a pen-and-paper exercise</p>",
        "id": 525208844,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1750592645
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ofRat</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">pi</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ln</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\">  </span><span class=\"c1\">-- try not to put something &lt;= 0 :)</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ofRat</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">q</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">pi</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">pi</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÇ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÇ</span><span class=\"bp\">.</span><span class=\"n\">eval</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÇ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÇ</span><span class=\"bp\">.</span><span class=\"n\">eval</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">eval</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ln</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">eval</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Answer3</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"n\">pi</span>\n\n<span class=\"c1\">-- lim[n‚Üí‚àû] (1+œÄ/n)^n = ?</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">Asymptotics</span><span class=\"w\"> </span><span class=\"n\">Topology</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Exercise3</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Tendsto</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">œÄ</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">atTop</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ùìù</span><span class=\"w\"> </span><span class=\"n\">Answer3</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">tendsto_one_add_div_pow_exp</span><span class=\"w\"> </span><span class=\"n\">œÄ</span>\n</code></pre></div>",
        "id": 525210124,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750594630
    },
    {
        "content": "<p>It's too convoluted to do division here<br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mi mathvariant=\"normal\">/</mi><mi>b</mi><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mo stretchy=\"false\">(</mo><mo>‚àí</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>‚àó</mo><mi>l</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>b</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">a / b = exp(ln(a) + (-1) * ln(b))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">‚àí</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">‚àó</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">))</span></span></span></span></p>",
        "id": 525210730,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750595574
    },
    {
        "content": "<p>I guess we can add <code>div : RealExpr -&gt; RealExpr -&gt; RealExpr</code></p>",
        "id": 525212200,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750597464
    },
    {
        "content": "<p>... and <code>sub</code> and <code>pow</code> and <code>zpow</code> and perhaps <code>rpow</code> for rational exponents...</p>",
        "id": 525212513,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1750597862
    },
    {
        "content": "<p>Could you make it extensible?</p>",
        "id": 525212521,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750597871
    },
    {
        "content": "<p>by the students? <span aria-label=\"smiley\" class=\"emoji emoji-1f603\" role=\"img\" title=\"smiley\">:smiley:</span></p>",
        "id": 525212534,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1750597889
    },
    {
        "content": "<p>Maybe <span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span></p>",
        "id": 525212561,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750597940
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113488-general/topic/How.20to.20formalize.20.22compute.20this.20expression.22.20exercises.3F/near/525212521\">said</a>:</p>\n<blockquote>\n<p>Could you make it extensible?</p>\n</blockquote>\n<p>I think the real answer is to automatically generate <code>RealExpr</code> with some metaprogramming for a given exercise. The exercise would specify: \"compute <code>foo</code> using +, -, /, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>œÄ</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">œÄ</span></span></span></span>, etc.\", then some meta code would generate a corresponding <code>Exercise3.RealExpr</code> and <code>Exercise3.RealExpr.eval</code> and <code>Exercise3 : Prop</code>.</p>",
        "id": 525215466,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1750601629
    },
    {
        "content": "<p>I don't know meta stuff, we can approximate it quite well using notation and instances</p>",
        "id": 525215489,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750601679
    },
    {
        "content": "<p>I'm envisioning having some generic mechanism to allow for both \"compute <code>bar</code> using <code>+,-,0,1</code>\" and \"compute <code>foo</code> using <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>œÄ</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">œÄ</span></span></span></span>, <code>+,*</code>\" without requiring the teacher to manually define types for each such exercise.</p>",
        "id": 525215579,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1750601790
    },
    {
        "content": "<p>That would be nice, but Kenny's proposal already looks like it meets my core requirements, which is to create an assessment that can be graded automatically by computer with essentially 100% accuracy, and without any evident \"exploits\" that either an unscrupulous student or a reinforcement learning-driven AI could take advantage of.  For instance, one could have</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"bp\">/!-</span>\n<span class=\"n\">Instructions</span><span class=\"o\">:</span>\n\n<span class=\"n\">You</span><span class=\"w\"> </span><span class=\"n\">may</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"n\">modify</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">text</span><span class=\"w\"> </span><span class=\"n\">inside</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"w\"> </span><span class=\"n\">statements</span><span class=\"bp\">.</span>\n\n<span class=\"n\">When</span><span class=\"w\"> </span><span class=\"n\">modifying</span><span class=\"w\"> </span><span class=\"n\">each</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">you</span><span class=\"w\"> </span><span class=\"n\">may</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">leave</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">scope</span>\n<span class=\"n\">or</span><span class=\"w\"> </span><span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">that</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"bp\">.</span>\n<span class=\"bp\">-/</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ofRat</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñö</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">pi</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ln</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ofRat</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">q</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">pi</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">pi</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÇ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÇ</span><span class=\"bp\">.</span><span class=\"n\">eval</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÇ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÇ</span><span class=\"bp\">.</span><span class=\"n\">eval</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">eval</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ln</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"c1\">-- explicitly document junk logarithm behavior</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"sd\">/-- Exercise 3(a) (1 point):  Evaluate `lim[n‚Üí‚àû] (1+œÄ/n)^n`. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Answer3</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RealExpr</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"c1\">-- Double-check that `Answer3` is indeed computable</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">Answer3</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"w\"> </span><span class=\"n\">Filter</span><span class=\"w\"> </span><span class=\"n\">Asymptotics</span><span class=\"w\"> </span><span class=\"n\">Topology</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"sd\">/-- Exercise 3(b) (9 points): Justify your answer. -/</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Exercise3</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">Tendsto</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">œÄ</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">atTop</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ùìù</span><span class=\"w\"> </span><span class=\"n\">Answer3</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"c1\">-- Ensure that only approved axioms are used to establish this exercise</span>\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">axioms</span><span class=\"w\"> </span><span class=\"n\">Exercise3</span>\n</code></pre></div>\n<p>An exploit-seeking student or AI could still grab 1 point out of 10 by putting in a junk answer for <code>Answer3</code>, but would there be any other possible exploits for such a framework?</p>",
        "id": 525216194,
        "sender_full_name": "Terence Tao",
        "timestamp": 1750602563
    },
    {
        "content": "<p>While it may not be a perfect solution, there are a few standards already.  Some AI benchmarks have problems of this kind including <a href=\"https://arxiv.org/abs/2407.11214\">PutnamBench</a> (\"no answer\" version which no one has attempted), <a href=\"https://arxiv.org/abs/2505.03171\">CombiBench</a> (\"without solution\" version), and some of the variants in <a href=\"https://arxiv.org/abs/2505.04528\">Beyond Theorem Proving</a>.  There are two challenges here.</p>\n<ol>\n<li>Checking the formal correctness of the answer and proof</li>\n<li>Checking that the answer is reasonably precise and not just a restatement of the question.</li>\n</ol>\n<p>Requirement (2) is really hard.  Some of the above papers have attempted solutions.  None, as far as I can tell, are perfect.  The above approach of <span class=\"user-mention\" data-user-id=\"110064\">@Kenny Lau</span>  is pretty good too for situations where it applies.</p>\n<p>As for (1), it is also not quite as trivial as you might think.  It depends on how trusting you are.  An unscrupulous student (or AI) could do very subtle things to trick Lean.  For example, it could modify your code to make the problem easier.  Some AIs, for example, have been known to comment out problems they can't solve. <span aria-label=\"smiling devil\" class=\"emoji emoji-1f608\" role=\"img\" title=\"smiling devil\">:smiling_devil:</span>  Also, there are many known ways to trick Lean into accepting a bad proof.  Using <code>native_decide</code>, <code>set_option debug.skipKernelTC true</code>, local instances, redefining keywords, or exploiting front-end Lean bugs (which cause a theorem to skip being added to the environment) are known exploits  <code>print_axioms</code> can find some of these.  <code>lean4checker</code> can find others.  The best tool I've seen is <a href=\"https://github.com/GasStationManager/SafeVerify\">SafeVerify</a> by <span class=\"user-mention\" data-user-id=\"776090\">@GasStationManager</span>.  It uses the metaprogramming tools from <code>print_axioms</code> to check axioms and <code>lean4checker</code> to check the proof, but also checks that the term of the reference theorem statement (which you wrote) is equivalent to the term of the filled-in theorem (which the student wrote).  (There is also <span class=\"user-mention\" data-user-id=\"110596\">@Rob Lewis</span>'s <a href=\"https://github.com/robertylewis/lean4-autograder-main\">lean-autograder</a>, which is similar.)  SafeVerify has some support for fill-in-the-answer problems.</p>",
        "id": 525220380,
        "sender_full_name": "Jason Rute",
        "timestamp": 1750607971
    },
    {
        "content": "<p>If recursors were tracked by the axiom system, it would be easy.</p>",
        "id": 525220536,
        "sender_full_name": "Chase Norman",
        "timestamp": 1750608107
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"346696\">@Chase Norman</span> What would be easy?</p>",
        "id": 525220561,
        "sender_full_name": "Jason Rute",
        "timestamp": 1750608139
    },
    {
        "content": "<p>It would be easy to determine whether an expression is a \"literal\" answer to a question vs. copying the computation or writing some other equivalent computation</p>",
        "id": 525220587,
        "sender_full_name": "Chase Norman",
        "timestamp": 1750608189
    },
    {
        "content": "<p>One way to formalize what we mean by \"compute this expression\" is to eliminate recursors.</p>",
        "id": 525220605,
        "sender_full_name": "Chase Norman",
        "timestamp": 1750608223
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"346696\">@Chase Norman</span>  You still need answer types that have a normal form, right?  I think that is much of the challenge.  Take <code>Real</code> for example, there is no legitimate <code>Real</code> answer which doesn't have recursors, right?  In the case of <code>Real</code>, maybe you can use Kenny's trick to get a good set of constructors for common real numbers.  Another example, common in competition problems, is to ask for \"the set of integers n such that P(n)\".  This isn't a computable object either, and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><mi>n</mi><mo>‚àà</mo><mi mathvariant=\"double-struck\">Z</mi><mo>‚à£</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{n \\in \\mathbb{Z} \\mid P(n)\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚àà</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">Z</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚à£</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)}</span></span></span></span> is certainly not a valid answer.  I think it would be hard to make a restricted language like in Kenny's trick, that is not giving too much of a hint for such problems.</p>",
        "id": 525221214,
        "sender_full_name": "Jason Rute",
        "timestamp": 1750608928
    },
    {
        "content": "<p>Right now Kenny's trick suffers from the problem that someone could just use a recursor to construct elements of the type. My suggestion was designed to patch that. But if you define it right, I don't see why the issue exists with <code>Real</code> intrinsically. If I define a Real number 0 as a Cauchy sequence that returns 0 on every input, I don't see where the recursor is coming in.</p>",
        "id": 525221427,
        "sender_full_name": "Chase Norman",
        "timestamp": 1750609219
    },
    {
        "content": "<p>You can define <code>0</code> just fine, but good luck defining any irrational without recursors</p>",
        "id": 525221495,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750609296
    },
    {
        "content": "<p>Sets of integers are just functions <code>‚Ñ§ ‚Üí Prop</code>. If your function uses recursion, it's not a true normal-form answer to the question, under this idea.</p>",
        "id": 525221503,
        "sender_full_name": "Chase Norman",
        "timestamp": 1750609308
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113488-general/topic/How.20to.20formalize.20.22compute.20this.20expression.22.20exercises.3F/near/525221495\">said</a>:</p>\n<blockquote>\n<p>You can define <code>0</code> just fine, but good luck defining any irrational without recursors</p>\n</blockquote>\n<p>This is true, but my solution to this is giving Reals computational structure, so that there is a clear equivalent for recursors on Reals. But I don't expect mathlib to do this.</p>",
        "id": 525221594,
        "sender_full_name": "Chase Norman",
        "timestamp": 1750609440
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"346696\">Chase Norman</span> <a href=\"#narrow/channel/113488-general/topic/How.20to.20formalize.20.22compute.20this.20expression.22.20exercises.3F/near/525221503\">said</a>:</p>\n<blockquote>\n<p>Sets of integers are just functions <code>‚Ñ§ ‚Üí Prop</code>. If your function uses recursion, it's not a true normal-form answer to the question, under this idea.</p>\n</blockquote>\n<p>I think \"every positive odd prime integer\" is a reasonable normal form. How do you expect to express this without any recursors?</p>",
        "id": 525221650,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750609493
    },
    {
        "content": "<p>If primality doesn't involve any computation, then axiomatize it.</p>",
        "id": 525221700,
        "sender_full_name": "Chase Norman",
        "timestamp": 1750609557
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"346696\">@Chase Norman</span> Evaluating the answer using <code>#eval</code> seems like a fine solution to reducing the answer to normal form.  I think you are saying that if the problem is add all the numbers between 1 and 100000 that the student may just write the sum expression and Lean would happily compute it, while you would hope the student doesn't do it this way.  But once the student can use Lean, they could also just evaluate it themselves separately in Lean anyway. <span aria-label=\"smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 525221723,
        "sender_full_name": "Jason Rute",
        "timestamp": 1750609591
    },
    {
        "content": "<p>Avoiding the use of calculators from students is beyond the scope of this question, I think.</p>",
        "id": 525221769,
        "sender_full_name": "Chase Norman",
        "timestamp": 1750609651
    },
    {
        "content": "<p>Exactly, so if they have access to calculators, just check their answer with <code>#eval</code> as above.  It doesn't have to be in normal form.  It just has to be specific enough to compute.</p>",
        "id": 525221800,
        "sender_full_name": "Jason Rute",
        "timestamp": 1750609699
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"346696\">Chase Norman</span> <a href=\"#narrow/channel/113488-general/topic/How.20to.20formalize.20.22compute.20this.20expression.22.20exercises.3F/near/525221427\">said</a>:</p>\n<blockquote>\n<p>Kenny's trick suffers from the problem that someone could just use a recursor to construct elements of the type</p>\n</blockquote>\n<p>I'm a bit confused, how do you recurse on Real?</p>",
        "id": 525221802,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750609707
    },
    {
        "content": "<p>You can recurse on Nat and use it to build a complex RealExpr</p>",
        "id": 525221825,
        "sender_full_name": "Chase Norman",
        "timestamp": 1750609738
    },
    {
        "content": "<p>If you don't track recursors, then they can introduce computation at any point.</p>",
        "id": 525221853,
        "sender_full_name": "Chase Norman",
        "timestamp": 1750609792
    },
    {
        "content": "<p>but how will you use that to solve my problem?</p>",
        "id": 525221854,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750609793
    },
    {
        "content": "<p>my problem's answer is e^pi</p>",
        "id": 525221875,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750609809
    },
    {
        "content": "<p>and my question isn't even stated as an expression</p>",
        "id": 525221889,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750609834
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"346696\">Chase Norman</span> <a href=\"#narrow/channel/113488-general/topic/How.20to.20formalize.20.22compute.20this.20expression.22.20exercises.3F/near/525221853\">said</a>:</p>\n<blockquote>\n<p>If you don't track recursors, then they can introduce computation at any point.</p>\n</blockquote>\n<p>I would also like to see a concrete example of how this is an issue that <code>#eval</code> doesn't already solve.</p>",
        "id": 525221928,
        "sender_full_name": "Jason Rute",
        "timestamp": 1750609875
    },
    {
        "content": "<p>I'm not exactly sure how Tendsto is defined, but I'd try to reimplement Tendsto <span class=\"user-mention\" data-user-id=\"110064\">@Kenny Lau</span></p>",
        "id": 525221942,
        "sender_full_name": "Chase Norman",
        "timestamp": 1750609897
    },
    {
        "content": "<p>I'm not sure how that is possible</p>",
        "id": 525221964,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750609921
    },
    {
        "content": "<p>i mean, suppose i use the epsilon-delta definition (in this case delta is N instead)</p>",
        "id": 525221989,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750609945
    },
    {
        "content": "<p>I'm sorry if this remark is not so specific, but the original question reminded me of discussions of what constitutes a \"closed form number/expression\". Timothy Chow wrote a nice essay on this some years ago, which was published in <em>The American Mathematical Monthly</em>:</p>\n<blockquote>\n<p>What is a closed-form number? (<a href=\"https://arxiv.org/abs/math/9805045\">arXiv</a> 1998, <a href=\"http://*%20https://doi.org/10.1080/00029890.1999.12005066\">AMM</a> 1999, <a href=\"https://timothychow.net/closedform.pdf\">web</a>)</p>\n</blockquote>\n<p>Perhaps eventually formalizing Chow's idea would give a nice target type for the answer to a \"compute this\" exercise.</p>",
        "id": 525222238,
        "sender_full_name": "Igor Khavkine",
        "timestamp": 1750610291
    },
    {
        "content": "<p>I'm not sure how that is different from what I suggested</p>",
        "id": 525222426,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750610547
    },
    {
        "content": "<p>If Mathlib can construct irrational Reals as a sequence of rationals using recursors, I don't see why we wouldn't be able to create an irrational RealExpr as a sequence of ofRat using recursors.</p>",
        "id": 525222566,
        "sender_full_name": "Chase Norman",
        "timestamp": 1750610718
    },
    {
        "content": "<p>But I must admit that I don't have a concrete construction</p>",
        "id": 525222595,
        "sender_full_name": "Chase Norman",
        "timestamp": 1750610743
    },
    {
        "content": "<p>I guess RealExpr creates some kind of data bottleneck. You can't put a lambda inside a RealExpr</p>",
        "id": 525222666,
        "sender_full_name": "Chase Norman",
        "timestamp": 1750610831
    },
    {
        "content": "<p>what do you actually mean by recursors? I'm very confused</p>",
        "id": 525222752,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750610972
    },
    {
        "content": "<p>I suspect you're using it to mean two different things when you said \"construct irrational Reals as a sequence of rationals using recursors\" vs. when you said \"recurse on Nat\"</p>",
        "id": 525222796,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750611039
    },
    {
        "content": "<p>Similar to Kenny's and Timothy Chow's proposals, there are people in computer science who have created term languages for a significant portion of the commonly used real numbers, with the goal of exact algebraic computation.  I think you need Schanuel's conjecture to show that equality (of the reals represented by the terms) is computable, but for our setting, that isn't an issue since Lean will check that the term is correct without having to check it is equal to the ground truth.  (I'm struggling to find a reference however.)</p>",
        "id": 525222808,
        "sender_full_name": "Jason Rute",
        "timestamp": 1750611056
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/113488-general/topic/How.20to.20formalize.20.22compute.20this.20expression.22.20exercises.3F/near/525222808\">said</a>:</p>\n<blockquote>\n<p>equality</p>\n</blockquote>\n<p>We don't need computable equality here because of how I defined <code>eval</code> recursively, and the goal is not for <code>by decide</code> to work.</p>",
        "id": 525222846,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750611120
    },
    {
        "content": "<p>Even for Nat you still can't cheat the system if the question is phrased implicitly (i.e. \"find n such that ...\" rather than \"compute this expression\")</p>",
        "id": 525222944,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750611256
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/113488-general/topic/How.20to.20formalize.20.22compute.20this.20expression.22.20exercises.3F/near/525222846\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/113488-general/topic/How.20to.20formalize.20.22compute.20this.20expression.22.20exercises.3F/near/525222808\">said</a>:</p>\n<blockquote>\n<p>equality</p>\n</blockquote>\n<p>We don't need computable equality here</p>\n</blockquote>\n<p>That is what I said. <span aria-label=\"smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 525223025,
        "sender_full_name": "Jason Rute",
        "timestamp": 1750611378
    },
    {
        "content": "<p>ah, you followed it with \"I'm struggling to find a reference\" so I thought you were hesitating</p>",
        "id": 525223048,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750611420
    },
    {
        "content": "<p>I'm struggling to find a reference to such a specific, exact real arithmetic proposal intended for actual practice.</p>",
        "id": 525223281,
        "sender_full_name": "Jason Rute",
        "timestamp": 1750611691
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"346696\">Chase Norman</span> <a href=\"#narrow/channel/113488-general/topic/How.20to.20formalize.20.22compute.20this.20expression.22.20exercises.3F/near/525221853\">said</a>:</p>\n<blockquote>\n<p>If you don't track recursors, then they can introduce computation at any point.</p>\n</blockquote>\n<p>You can still do quite a lot without recursors</p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>Characterizing Collatz Without Recursors</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">collatzStep</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">‚à£</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">collatzIterate</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeat</span><span class=\"w\"> </span><span class=\"n\">collatzStep</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">CollatzTerminates</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">collatzIterate</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"c1\">-- now let's do it without recursors :)</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">IsMulTwo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsMulTwo</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">zero</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsMulTwo</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">IsMulTwo</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"bp\">.</span><span class=\"n\">succ</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">IsMulThreeAddOne</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsMulThreeAddOne</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">zero</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsMulThreeAddOne</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">IsMulThreeAddOne</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"bp\">.</span><span class=\"n\">succ</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">CollatzReachable</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CollatzReachable</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"bp\">.</span><span class=\"n\">succ</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">even</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CollatzReachable</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">IsMulTwo</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">CollatzReachable</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">odd</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CollatzReachable</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">¬¨</span><span class=\"n\">IsMulTwo</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span>\n<span class=\"w\">    </span><span class=\"n\">IsMulThreeAddOne</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">CollatzReachable</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"c1\">-- now to prove them equivalent</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">isMulTwo_iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsMulTwo</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ih</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">rintro</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">    </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">zero</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">isMulThreeAddOne_iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsMulThreeAddOne</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ih</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">rintro</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">    </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">one</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">collatzTerminates_iff_collatzReachable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">CollatzTerminates</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">CollatzReachable</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hi</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">    </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">generalizing</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">subst</span><span class=\"w\"> </span><span class=\"n\">hi</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">one</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">collatzIterate</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeat_eq_repeatTR</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeatTR</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeatTR</span><span class=\"bp\">.</span><span class=\"n\">loop</span><span class=\"o\">,</span>\n<span class=\"w\">        </span><span class=\"n\">collatzStep</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeatTR</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeat_eq_repeatTR</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">collatzIterate</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hi</span>\n<span class=\"w\">      </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">‚à£</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">      </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">if_pos</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hi</span>\n<span class=\"w\">        </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">even</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"n\">hi</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">isMulTwo_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">mul_div_cancel'</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">if_neg</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hi</span>\n<span class=\"w\">        </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">odd</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"n\">hi</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"w\">        </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">isMulTwo_iff</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hn</span>\n<span class=\"w\">          </span><span class=\"n\">subst</span><span class=\"w\"> </span><span class=\"n\">hn</span>\n<span class=\"w\">          </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">dvd_mul_right</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span>\n<span class=\"w\">        </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">isMulThreeAddOne_iff</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">even</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">hnk</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">isMulTwo_iff</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hnk</span>\n<span class=\"w\">      </span><span class=\"n\">subst</span><span class=\"w\"> </span><span class=\"n\">hnk</span>\n<span class=\"w\">      </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hi</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n<span class=\"w\">      </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_‚ü©</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">collatzIterate</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeat_eq_repeatTR</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeatTR</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeatTR</span><span class=\"bp\">.</span><span class=\"n\">loop</span><span class=\"o\">,</span>\n<span class=\"w\">        </span><span class=\"n\">collatzStep</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeatTR</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeat_eq_repeatTR</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">collatzIterate</span><span class=\"o\">,</span>\n<span class=\"w\">        </span><span class=\"n\">if_pos</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">dvd_mul_right</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">mul_div_cancel_left</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">decide</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">hi</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">odd</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">hne</span><span class=\"w\"> </span><span class=\"n\">hnk</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">isMulThreeAddOne_iff</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hnk</span>\n<span class=\"w\">      </span><span class=\"n\">subst</span><span class=\"w\"> </span><span class=\"n\">hnk</span>\n<span class=\"w\">      </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hi</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n<span class=\"w\">      </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_‚ü©</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">collatzIterate</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeat_eq_repeatTR</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeatTR</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeatTR</span><span class=\"bp\">.</span><span class=\"n\">loop</span><span class=\"o\">,</span>\n<span class=\"w\">        </span><span class=\"n\">collatzStep</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeatTR</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">repeat_eq_repeatTR</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">collatzIterate</span><span class=\"o\">,</span>\n<span class=\"w\">        </span><span class=\"n\">if_neg</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hc</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">hne</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">isMulTwo_iff</span><span class=\"bp\">.</span><span class=\"n\">mpr</span><span class=\"w\"> </span><span class=\"n\">hc</span><span class=\"o\">)),</span><span class=\"w\"> </span><span class=\"n\">hi</span><span class=\"o\">]</span>\n</code></pre></div>\n</div></div>",
        "id": 525223302,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750611711
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"c1\">-- this is not a good answer checker</span>\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">NatExpr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NatExpr</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NatExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">NatExpr</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">NatExpr</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NatExpr</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">NatExpr</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">answer1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NatExpr</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"c1\">-- fill in this sorry</span>\n<span class=\"w\">  </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">recOn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"o\">)</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">answer1</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">theorem1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">answer1</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- fill in this sorry</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n\n<span class=\"c1\">-- but you still can't hack this one:</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">NatExpr</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">answer2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NatExpr</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"c1\">-- fill in this sorry</span>\n<span class=\"w\">  </span><span class=\"n\">zero</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"bp\">.</span><span class=\"n\">succ</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">answer2</span>\n\n<span class=\"sd\">/-- Find a natural number n such that every natural number is the sum of n squares. -/</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">theorem2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">answer2</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- fill in this sorry</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"n\">rcases</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">sum_four_squares</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">‚ü®!</span><span class=\"o\">[</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"bp\">?_‚ü©</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">sum_univ_succ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">answer2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">add_assoc</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 525223426,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750611890
    },
    {
        "content": "<p>^ for what I mean by you still can't hack it if the question is phrased implicitly</p>",
        "id": 525223434,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750611905
    },
    {
        "content": "<p>Maybe a more syntactic approach could work?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">checkBinderAnnotations</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ofNat</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"n\">ofNat</span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">pi</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">pi</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">div</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">neg</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">‚Åª¬π</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">log</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">attribute</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"kn\">instance</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">ofNat</span><span class=\"w\"> </span><span class=\"n\">pi</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"w\"> </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"n\">div</span><span class=\"w\"> </span><span class=\"n\">neg</span><span class=\"w\"> </span><span class=\"n\">inv</span><span class=\"w\"> </span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"n\">log</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">question</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">answer</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">pi</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">question_eq_answer</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">question</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">answer</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleRealExpression</span><span class=\"w\"> </span><span class=\"n\">answer</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">answer</span>\n<span class=\"w\">  </span><span class=\"n\">infer_instance</span>\n</code></pre></div>",
        "id": 525223458,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1750611930
    },
    {
        "content": "<p>that's a nice approach too!</p>",
        "id": 525223511,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750612016
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> every one of those \"induction\" is a recursor</p>",
        "id": 525223615,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750612158
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/stream/113488-general/topic/How.20to.20formalize.20.22compute.20this.20expression.22.20exercises.3F/near/525223615\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> every one of those \"induction\" is a recursor</p>\n</blockquote>\n<p>That's part of the proof of equivalence. There aren't any recursors in my claimed solution.</p>",
        "id": 525223661,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750612204
    },
    {
        "content": "<p>If the answer to a question is <code>0</code>, should <code>1 - 1 + 1 - 1 + 1 - 1 + 1 - 1 + sin 37 - sin 37</code> be considered correct?</p>",
        "id": 525223750,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750612309
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> My thought is if they have access to Lean, and it computes with <code>#eval</code> (which this one doesn't), then it is fine, since they could have just plugged it in to <code>#eval</code> themselves.  But maybe this is a way of sneaking in <code>native_decide</code> without actually relying on it in the proof.  <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span>  Would <code>#reduce</code> be better?</p>",
        "id": 525223998,
        "sender_full_name": "Jason Rute",
        "timestamp": 1750612604
    },
    {
        "content": "<p>I guess my remark is off topic, and more relevant to questions of the form \"<em>simplify</em> this expression\"</p>",
        "id": 525224065,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750612698
    },
    {
        "content": "<p>But for instance, if the question is \"compute the last digit of bignum!\", expanding the factorial notation into a very large product and writing <code>... % 10</code> would surely not count</p>",
        "id": 525224236,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750612910
    },
    {
        "content": "<p>One could require that any #eval of the answer terminate within N seconds for some small N</p>",
        "id": 525224285,
        "sender_full_name": "Terence Tao",
        "timestamp": 1750612987
    },
    {
        "content": "<p>This unfortunately excludes noncomputable real numbers</p>",
        "id": 525224314,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750613043
    },
    {
        "content": "<p>#eval of the <code>RealExpr</code> or <code>SimpleRealExpression</code> instance, then</p>",
        "id": 525224334,
        "sender_full_name": "Terence Tao",
        "timestamp": 1750613083
    },
    {
        "content": "<p><code>SimpleRealExpression</code> is a prop above, so evaluation is always a no-op</p>",
        "id": 525224574,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750613386
    },
    {
        "content": "<p>I guess in that case you could mean typeclass inference</p>",
        "id": 525224606,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750613410
    },
    {
        "content": "<p>well, the <code>infer_instance</code> step above should terminate</p>",
        "id": 525224609,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750613413
    },
    {
        "content": "<p>I think there's actually a depth limit by default</p>",
        "id": 525224632,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750613450
    },
    {
        "content": "<p>I would guess it already rejects <code>1 + 1 + ...</code> for an answer that should be <code>100</code></p>",
        "id": 525224660,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750613480
    },
    {
        "content": "<p>for a nice example, consider 3^3^3^3^3^3%10 which I haven't found a simp lemma for</p>",
        "id": 525224725,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750613597
    },
    {
        "content": "<p>it seems like we don't have the simp lemma <code>Coprime a n -&gt; a^b%n = a^(b%Phi(n))%n</code></p>",
        "id": 525224778,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750613678
    },
    {
        "content": "<p>I think for this specific question, the resolution is that <code>%</code> (or floor)  is not always a legal operator in the answer, depending on the question</p>",
        "id": 525224785,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750613683
    },
    {
        "content": "<p>I think for this specific question, doesn't Lean actually have a checker to check if a given expression is a natural number literal?</p>",
        "id": 525224836,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750613741
    },
    {
        "content": "<p>If we are going to look at the length of time to evaluate the answer, why not, as an alternative, look at the length of the code needed to express the answer? We could allow the \"determine\" answer to take any form, but only give credit when the length in bytes of the lean expression we replace the <code>sorry</code> with is no longer than, say, 2x the same length in the reference solution. This would also let us avoid having to define a new inductive type.</p>",
        "id": 525224878,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1750613798
    },
    {
        "content": "<p>well for this question in particular you could even restrict the answer to have one byte!</p>",
        "id": 525224899,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750613834
    },
    {
        "content": "<p>May I ask a stupid question? Why do we care if students can cheat the answer? They can already cheat in a million different ways (especially with LLMs). (They could also cheat for the last ~20 years on their calc homework with WolframAlpha. And for the last ~60 years on their times tables with a calculator...) I plan on telling mine: if you're not interested in learning a skill, please go ahead and cheat; you'll learn nothing, and fail the (in class, timed, handwritten on paper) final exam. I also plan on having a TA grade the homework sets (in particular because I won't insist on students using Lean; I'll be using it, but if they don't find it easier to work with Lean, they're welcome to hand in their homeworks the old fashioned way).</p>",
        "id": 525243763,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1750641416
    },
    {
        "content": "<p>Personally I'm interested more in designing tests that AI cannot cheat on, in order to get useful benchmarking and hillclimbing, but since assessing human math homework is such a familiar framework, I stated things largely in that language.</p>",
        "id": 525244024,
        "sender_full_name": "Terence Tao",
        "timestamp": 1750641820
    },
    {
        "content": "<p>I think it's more up to whomever is letting the AI solve problems to ensure it cannot cheat on them.</p>",
        "id": 525246019,
        "sender_full_name": "Justin Asher",
        "timestamp": 1750644387
    },
    {
        "content": "<p>DeepMind claimed that their IMO solver filled in solutions automatically and then proved they were correct, but there was no independent judge of this. The IMO 2025 people seem to have shown no interest in making a framework for testing formal solutions. So I might be in the position next month of having to decide whether the IMO grand challenge has been achieved and the only data I'll have is blog posts from tech companies claiming that their system magically came up with the solutions to the \"what is this number\" questions.</p>",
        "id": 525267421,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1750662624
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/113488-general/topic/How.20to.20formalize.20.22compute.20this.20expression.22.20exercises.3F/near/525267421\">said</a>:</p>\n<blockquote>\n<p>DeepMind claimed that their IMO solver filled in solutions automatically and then proved they were correct, but there was no independent judge of this. The IMO 2025 people seem to have shown no interest in making a framework for testing formal solutions. So I might be in the position next month of having to decide whether the IMO grand challenge has been achieved and the only data I'll have is blog posts from tech companies claiming that their system magically came up with the solutions to the \"what is this number\" questions.</p>\n</blockquote>\n<p>Sadly that's the state of AI research across many domains today. All the \"awesome\" results are not published entirely openly. Much like VLSI papers.</p>",
        "id": 525309340,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1750677912
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"466334\">Shreyas Srinivas</span> <a href=\"#narrow/channel/113488-general/topic/How.20to.20formalize.20.22compute.20this.20expression.22.20exercises.3F/near/525309340\">said</a>:</p>\n<blockquote>\n<p>Sadly that's the state of AI research across many domains today. All the \"awesome\" results are not published entirely openly. Much like VLSI papers.</p>\n</blockquote>\n<p>The fun part is if they do publish their solutions, then it is typically pretty easy to infer how they arrived at them just based off of how they are written. I can understand why labs would want to hide them. Maybe we all need to be a bit more generous.</p>",
        "id": 525331883,
        "sender_full_name": "Justin Asher",
        "timestamp": 1750685194
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/113488-general/topic/How.20to.20formalize.20.22compute.20this.20expression.22.20exercises.3F/near/525267421\">said</a>:</p>\n<blockquote>\n<p>DeepMind claimed that their IMO solver filled in solutions automatically and then proved they were correct, but there was no independent judge of this. The IMO 2025 people seem to have shown no interest in making a framework for testing formal solutions. So I might be in the position next month of having to decide whether the IMO grand challenge has been achieved and the only data I'll have is blog posts from tech companies claiming that their system magically came up with the solutions to the \"what is this number\" questions.</p>\n</blockquote>\n<p>I thought they said that they told Gemini (or something like it) to \"suggest\" 100 possible answers, and then went to work proving/disproving the resulting claims. I think in practice they managed to disprove ~98 possibilities quickly, and then had to wait a while longer for the last few to be proved...</p>",
        "id": 525355207,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1750691624
    },
    {
        "content": "<p>If you believe in blog posts then yes this is something like what happened</p>",
        "id": 525356718,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1750692104
    },
    {
        "content": "<p>Thomas also gave some public talks which I believe align with that commentary</p>",
        "id": 525356780,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750692126
    },
    {
        "content": "<p>I'm not doubting that this happened, but as a mathematician I feel uncomfortable that there's no proof that this happened. And who knows what will happen at 2025 IMO.</p>",
        "id": 525358960,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1750692825
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 525358963,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1750692826
    }
]