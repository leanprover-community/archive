[
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"395550\">Henrik Böving</span> <a href=\"#narrow/channel/113488-general/topic/Updating.20to.204.2E15.2E0/near/491913348\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/113488-general/topic/Updating.20to.204.2E15.2E0/near/491911829\">said</a>:</p>\n<blockquote>\n<p>Actually, maybe this is really a question for <span class=\"user-mention silent\" data-user-id=\"699684\">Austin Letson</span> --- could we change the default for <code>lean-action</code> to fail if there are warning during the build?</p>\n</blockquote>\n<p>I made the change to doc-gen in <a href=\"https://github.com/leanprover/doc-gen4/pull/257\">https://github.com/leanprover/doc-gen4/pull/257</a>, unfortunately, unlike it should, the CI does not error on building doc-gen itself as it recovers the build from a cache, this seems to be an indicator to me that the cache key used to compute build results is not taking into accounts things like change of arguments etc. This should probably also be addressed <span class=\"user-mention silent\" data-user-id=\"699684\">Austin Letson</span>. Alternatively maybe this is not an issue with lean-action itself but with <code>lake</code>, I can't quite tell.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"395550\">@Henrik Böving</span> I made a new thread to respond to this since the other thread is actively discussing other things.</p>\n<p>I think this is an issue with <code>lake</code>. I pulled this branch of docgen locally and ran <code>lake build --wfail</code> and the build succeeded:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">[</span><span class=\"n\">I</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">➜</span><span class=\"w\">  </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"o\">:(</span><span class=\"n\">warning</span><span class=\"bp\">-</span><span class=\"n\">ci</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"c1\">--wfail</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cli</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">mhuisi</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">cli</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cli</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">0</span><span class=\"n\">c8ea32a15a4f74143e4e1e107ba2c412adb90fd'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">UnicodeBasic</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">fgdorais</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">unicode</span><span class=\"bp\">-</span><span class=\"n\">basic</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">UnicodeBasic</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">470</span><span class=\"n\">c41643209208d325a5a7315116f293c7443fb'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BibtexQuery</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">dupuisf</span><span class=\"bp\">/</span><span class=\"n\">BibtexQuery</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BibtexQuery</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">46376</span><span class=\"n\">bc3c8f46ac1a1fd7712856b0f7bd6166098'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MD4Lean</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">acmepjz</span><span class=\"bp\">/</span><span class=\"n\">md4lean</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MD4Lean</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">f8ed91f3a9d806648ae6a03ab98c8b87e8bedc7e'</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">MD4Lean</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">13</span><span class=\"o\">:</span><span class=\"mi\">61</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.BuildJob</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">MD4Lean</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">26</span><span class=\"o\">:</span><span class=\"mi\">45</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.BuildJob</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">Build</span><span class=\"w\"> </span><span class=\"n\">completed</span><span class=\"w\"> </span><span class=\"n\">successfully</span><span class=\"bp\">.</span>\n</code></pre></div>\n<p>I am not sure what is going on here. It seems like the build should fail. Since the warning is logged for<code>MD4Lean</code>as opposed to <code>doc-gen4</code> it isn't causing <code>lake build --wfail</code> to fail?</p>",
        "id": 491973586,
        "sender_full_name": "Austin Letson",
        "timestamp": 1736089351
    },
    {
        "content": "<p>Interesting,  in that case it's probably something for <span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span> to look into next week.</p>",
        "id": 491973625,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1736089392
    },
    {
        "content": "<p>Unfortunately, configuration warnings (and workspace load warnings more generally) are not currently covered by <code>--wfail</code>.</p>",
        "id": 491977688,
        "sender_full_name": "Mac Malone",
        "timestamp": 1736092742
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/pull/6540\">lean#6540</a></p>",
        "id": 491999021,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736111620
    }
]