[
    {
        "content": "<p>I'm planning to do Advent of Code in Lean this year for the first time, so I decided to go back and rewrite the 2019 <a href=\"https://esolangs.org/wiki/Intcode\">Intcode machine</a> as a bit of practice. Thought I'd post here in case others are curious or have feedback for me, here's the code: <a href=\"https://github.com/chenson2018/advent-of-code/blob/main/2019/LeanIntcode/LeanIntcode/Intcode.lean\">https://github.com/chenson2018/advent-of-code/blob/main/2019/LeanIntcode/LeanIntcode/Intcode.lean</a></p>",
        "id": 483983773,
        "sender_full_name": "Chris Henson",
        "timestamp": 1732306270
    },
    {
        "content": "<p><code>match Nat.decLt</code> should just be a plain <code>if</code> statement using <code>&lt;</code>. Matching on the decidable instance yourself is just obfuscatory.</p>",
        "id": 484019444,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732325984
    },
    {
        "content": "<p>I'd use <code>[i]?</code> instead of <code>get?</code> everywhere.</p>",
        "id": 484019516,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732326027
    },
    {
        "content": "<p>The <code>data ++ mkArray</code> looks a bit smelly, but is probably fine.</p>",
        "id": 484019542,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732326062
    },
    {
        "content": "<p>If you wanted to prove things about this, you'd probably avoid <code>partial</code> and instead use a fuel parameter or fuel monad state.</p>",
        "id": 484019907,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732326380
    },
    {
        "content": "<p>If you wanted to be fancy with your monads, <code>silent</code> seems a bit out of place in the VM state, and instead could be stored in a monad context for running the VM.</p>",
        "id": 484019973,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732326449
    },
    {
        "content": "<p>Thanks for the feedback! For the <code>match Nat.decLt</code>, I didn't know how to use an if statement and be able to construct something of type <code>Fin</code> based on the condition, is that possible?</p>",
        "id": 484020328,
        "sender_full_name": "Chris Henson",
        "timestamp": 1732326758
    },
    {
        "content": "<p><code>if h : a &lt; b then</code> gives you the proposition inside the branches</p>",
        "id": 484020695,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1732327128
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/113488-general/topic/Advent.20of.20Code.20-.20Intcode/near/484020695\">said</a>:</p>\n<blockquote>\n<p><code>if h : a &lt; b then</code> gives you the proposition inside the branches</p>\n</blockquote>\n<p>Ah thanks. I'd tried that, but with parenthesis which doesn't work.</p>",
        "id": 484021009,
        "sender_full_name": "Chris Henson",
        "timestamp": 1732327342
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/113488-general/topic/Advent.20of.20Code.20-.20Intcode/near/484019973\">said</a>:</p>\n<blockquote>\n<p>If you wanted to be fancy with your monads, <code>silent</code> seems a bit out of place in the VM state, and instead could be stored in a monad context for running the VM.</p>\n</blockquote>\n<p>Yeah, this makes sense. For this (and informative error messages) I guess <code>StateT IO</code> would be more appropriate.</p>",
        "id": 484021334,
        "sender_full_name": "Chris Henson",
        "timestamp": 1732327647
    },
    {
        "content": "<p>I guess you could also argue that the input/output fields should be held in state too. They are not really aspects of the machine, but implementation details of how something external interacts with its effects.</p>",
        "id": 484022710,
        "sender_full_name": "Chris Henson",
        "timestamp": 1732328917
    }
]