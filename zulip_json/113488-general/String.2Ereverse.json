[
    {
        "content": "<p>Not sure if I'm posting this in the right channel...</p>\n<p>The last example in <a href=\"https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___map\"><code>List.map</code></a> and <a href=\"https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___map\"><code>List.mapTr</code></a> use <code>String.reverse</code> but the latest version of Lean (lean4:v4.26.0) doesn't seem to have such function. I ended up implementing it myself using <code>List.reverse</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">reverse</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">String</span><span class=\"bp\">.</span><span class=\"n\">ofList</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">toList</span><span class=\"bp\">.</span><span class=\"n\">reverse</span>\n</code></pre></div>",
        "id": 565583060,
        "sender_full_name": "Maris Ozols",
        "timestamp": 1766945986
    },
    {
        "content": "<p>You could potentially use <code>String.revChars</code>  instead.</p>",
        "id": 565583838,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1766947100
    },
    {
        "content": "<p><code>revChars</code> and <code>List.reverse</code> seems to break uft8 composed emojis :</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"bp\">.</span><span class=\"n\">ofList</span><span class=\"w\"> </span><span class=\"s2\">\"1️⃣2️⃣3️⃣4️⃣5️⃣6️⃣7️⃣0️⃣\"</span><span class=\"bp\">.</span><span class=\"n\">revChars</span><span class=\"bp\">.</span><span class=\"n\">toList</span><span class=\"w\"> </span><span class=\"c1\">-- \"⃣️0⃣️7⃣️6⃣️5⃣️4⃣️3⃣️2⃣️1\"</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"bp\">.</span><span class=\"n\">ofList</span><span class=\"w\"> </span><span class=\"s2\">\"1️⃣2️⃣3️⃣4️⃣5️⃣6️⃣7️⃣0️⃣\"</span><span class=\"bp\">.</span><span class=\"n\">toList</span><span class=\"bp\">.</span><span class=\"n\">reverse</span><span class=\"w\"> </span><span class=\"c1\">--  \"⃣️0⃣️7⃣️6⃣️5⃣️4⃣️3⃣️2⃣️1\"</span>\n</code></pre></div>\n<p>does lean support graphemes splitting ?<br>\nHere a working js solution :</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"kd\">function</span><span class=\"w\"> </span><span class=\"nx\">reverseString</span><span class=\"p\">(</span><span class=\"nx\">str</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">  </span><span class=\"kd\">const</span><span class=\"w\"> </span><span class=\"nx\">segmenter</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"ow\">new</span><span class=\"w\"> </span><span class=\"nb\">Intl</span><span class=\"p\">.</span><span class=\"nx\">Segmenter</span><span class=\"p\">(</span><span class=\"kc\">undefined</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"nx\">granularity</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s1\">'grapheme'</span><span class=\"w\"> </span><span class=\"p\">})</span>\n<span class=\"w\">  </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"p\">[...</span><span class=\"nx\">segmenter</span><span class=\"p\">.</span><span class=\"nx\">segment</span><span class=\"p\">(</span><span class=\"nx\">str</span><span class=\"p\">)]</span>\n<span class=\"w\">    </span><span class=\"p\">.</span><span class=\"nx\">map</span><span class=\"p\">(</span><span class=\"nx\">s</span><span class=\"w\"> </span><span class=\"p\">=&gt;</span><span class=\"w\"> </span><span class=\"nx\">s</span><span class=\"p\">.</span><span class=\"nx\">segment</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"p\">.</span><span class=\"nx\">reverse</span><span class=\"p\">()</span>\n<span class=\"w\">    </span><span class=\"p\">.</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"s1\">''</span><span class=\"p\">)</span>\n<span class=\"p\">}</span>\n<span class=\"nx\">reverseString</span><span class=\"p\">(</span><span class=\"s2\">\"1️⃣2️⃣3️⃣4️⃣5️⃣6️⃣7️⃣0️⃣\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"c1\">// '0️⃣7️⃣6️⃣5️⃣4️⃣3️⃣2️⃣1️⃣'</span>\n</code></pre></div>\n<p>Is this also possible with Lean API ?</p>",
        "id": 565584922,
        "sender_full_name": "Alfredo Moreira-Rosa",
        "timestamp": 1766948687
    },
    {
        "content": "<p>This kind of unicode problem is always a nightmare in any programming language. It boils down to one question \"what is a character\"</p>",
        "id": 565585114,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1766949049
    },
    {
        "content": "<p>Maybe it's just an API issue and behind the scene Lean <code>understand</code> unicode graphemes (composition of many code points that represent a single visual element)?</p>",
        "id": 565585308,
        "sender_full_name": "Alfredo Moreira-Rosa",
        "timestamp": 1766949410
    },
    {
        "content": "<p>No, Lean, just like Rust's stdlib, decided to not support graphemes, the unit of character is a unicode scalar value.</p>",
        "id": 565585362,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1766949478
    },
    {
        "content": "<p>Thanks for the insight. Seems like a fun small project for a reservoir library :)</p>",
        "id": 565585525,
        "sender_full_name": "Alfredo Moreira-Rosa",
        "timestamp": 1766949842
    }
]