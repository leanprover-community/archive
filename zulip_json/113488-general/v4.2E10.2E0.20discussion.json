[
    {
        "content": "<blockquote>\n<p><code>Char.csize</code> is replaced by <code>Char.utf8Size</code> (<a href=\"https://github.com/leanprover/lean4/pull/4357\">#4357</a>).</p>\n</blockquote>\n<p>There are still some theorems in <code>Batteries.Data.String.Lemmas</code> whose name contains <code>csize</code>. I'll make a pull request that renames these theorems.</p>",
        "id": 455547575,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1722487277
    },
    {
        "content": "<p>When I right-click <code>Char.utf8Size</code> and try to go to its definition in VS Code, the Lean server responds that no definition is found for it.</p>",
        "id": 455550101,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1722488175
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"417769\">Bulhwi Cha</span> <a href=\"#narrow/stream/113488-general/topic/v4.2E10.2E0.20discussion/near/455547575\">said</a>:</p>\n<blockquote>\n<p>There are still some theorems in <code>Batteries.Data.String.Lemmas</code> whose name contains <code>csize</code>. I'll make a pull request that renames these theorems.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> Here's my PR: <a href=\"https://github.com/leanprover/std4/pull/901\">std#901</a>.</p>",
        "id": 455556908,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1722491462
    },
    {
        "content": "<p>I am very happy about the customizable <code>#reduce</code>! This update is great ^^</p>",
        "id": 455598276,
        "sender_full_name": "Max Nowak üêâ",
        "timestamp": 1722504069
    },
    {
        "content": "<p>About <code>List.get</code> vs <code>l[n]</code>. Am I right that <code>l[n]</code> is in fact <code>l[n]'[hn]</code>, so in some sense we're going back from <code>List.get l (n : Fin l.length)</code> to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.nthLe#doc\">docs#List.nthLe</a> with a new name/syntax? How do we call <code>l[n]</code> in lemma names?</p>",
        "id": 455772709,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722553755
    },
    {
        "content": "<p><code>getElem</code> is the name for the syntax</p>",
        "id": 455780874,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722557414
    },
    {
        "content": "<p>Do, do we restore <code>nthLe</code> lemmas with <code>getElem</code> names&amp;syntax now and deprecate <code>List.get</code>?</p>",
        "id": 455788114,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722559226
    },
    {
        "content": "<p>I think if there are useful deprecated lemmas with <code>nthLe</code> in their name, yes, it would be good to turn them into lemmas about <code>getElem</code>. I don't think we should systematically try to recover unused, deprecated lemmas.</p>",
        "id": 455858923,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722584744
    },
    {
        "content": "<p>This will happen automatically as we migrate from <code>List.get</code> to <code>getElem</code>.</p>",
        "id": 455926170,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722602894
    },
    {
        "content": "<p>Is <code>.get</code> going away, or should we keep around lemmas about it?</p>",
        "id": 455944640,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722608085
    },
    {
        "content": "<p>I'd argue we want to keep it, to act as an inverse to <code>List.ofFn</code></p>",
        "id": 455944768,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722608114
    },
    {
        "content": "<p>We can use <code>fun i : Fin l.length =&gt; l[i]</code></p>",
        "id": 455982381,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722616827
    },
    {
        "content": "<p><code>List.nthLe</code> is obsolete and must be deprecated in favor of <code>[*]</code> notation. When using <code>[*]</code> notation, theorem names should say <code>getElem</code> and not <code>get</code>. </p>\n<p><code>List.get</code> (which is in <code>Init.Prelude</code>) is not deprecated but it is low-level. Only a few theorems do need to use <code>get</code> explicitly instead of <code>getElem</code>, these theorem names should still use <code>get</code> where they do.</p>",
        "id": 456042937,
        "sender_full_name": "Fran√ßois G. Dorais",
        "timestamp": 1722633340
    },
    {
        "content": "<p><code>get</code> is staying around in core Lean. The \"programming API\" for Lean will treat it as low-level, and uniformly prefer <code>getElem</code>.</p>\n<p>That said, in combinatorial applications there are places where indexing over <code>Fin</code> really makes more sense, and then <code>get</code> is more ergonomic in some statements. My preference is that these places continue to use <code>get</code>, but resist the temptation to (re)build massive parallel API, and instead try to conduct most proofs by simplifying <code>get</code> back to <code>getElem</code> and using the API there.</p>",
        "id": 456054201,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722638469
    },
    {
        "content": "<p>(I think this is agreeing with <span class=\"user-mention\" data-user-id=\"119741\">@Fran√ßois G. Dorais</span> above!)</p>",
        "id": 456054224,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722638504
    },
    {
        "content": "<p>Indeed, I think we agree. To emphasize/rephrase in a very informal manner:  Lean \"noobs\" should only encounter <code>[*]</code> notation and use <code>getElem</code> theorems, unless they find themselves drowning in a situation they shouldn't be in to start with.</p>",
        "id": 456055594,
        "sender_full_name": "Fran√ßois G. Dorais",
        "timestamp": 1722639502
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> But if <code>i : Fin a.size</code> then <code>a[i]</code> is just <code>a.get i</code> so the applications you're thinking of just need a better <code>get_elem_tactic</code> (and perhaps other bells and whistles).</p>",
        "id": 456064360,
        "sender_full_name": "Fran√ßois G. Dorais",
        "timestamp": 1722644732
    },
    {
        "content": "<p>I'm going to try to cleanup Mathlib (<code>get</code>/<code>getElem</code>/<code>nthLe</code>) over the weekend (see <a href=\"https://github.com/leanprover-community/mathlib4/pull/15455\">#15455</a> for the current draft).</p>",
        "id": 456068986,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722648171
    },
    {
        "content": "<p>What should we do about <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Fin.instGetElemFinVal#doc\">docs#Fin.instGetElemFinVal</a> ?</p>",
        "id": 456069898,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722649011
    },
    {
        "content": "<p>Special case each lemma for <code>Fin</code>?</p>",
        "id": 456069916,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722649033
    },
    {
        "content": "<p><code>simp</code> to <code>Nat</code>?</p>",
        "id": 456069918,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722649039
    },
    {
        "content": "<p>Never mind, we already <code>simp</code> to <code>Nat</code>. I was debugging a <code>simp only</code> call.</p>",
        "id": 456069935,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722649077
    },
    {
        "content": "<p>I should've read 10 lines around the instance before posting here.</p>",
        "id": 456069983,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722649089
    },
    {
        "content": "<p>The following worked in v4.8.0, but in v4.10.0, <code>rfl</code> fails.  Anyone know why?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">gcd</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">mod_lt</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">succ_pos</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"n\">gcd</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"n\">termination_by</span><span class=\"w\"> </span><span class=\"n\">b</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">gcd</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 459550144,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1723228944
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">unseal</span><span class=\"w\"> </span><span class=\"n\">gcd</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">gcd</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>is one way to do it now.</p>",
        "id": 459550413,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1723229072
    },
    {
        "content": "<p>What does <code>unseal</code> mean?  Has <code>rfl</code> been changed so that it no longer looks at the definition of <code>gcd</code>?</p>",
        "id": 459550567,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1723229140
    },
    {
        "content": "<p>The attributes of <code>gcd</code> have changed so that <code>rfl</code> doesn't automatically unfold it</p>",
        "id": 459550649,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1723229164
    },
    {
        "content": "<blockquote>\n<p>Functionally, <code>unseal foo</code> is equivalent to <code>attribute [local semireducible] foo</code>.</p>\n</blockquote>",
        "id": 459550721,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1723229209
    },
    {
        "content": "<p>Note that I am using my own gcd function, not a built-in function (perhaps it should be called <code>my_gcd</code>).  What is it about my definition of my gcd function that causes <code>rfl</code> not to unfold it?</p>",
        "id": 459551216,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1723229418
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"453098\">Dan Velleman</span> <a href=\"#narrow/stream/113488-general/topic/v4.2E10.2E0.20discussion/near/459551216\">said</a>:</p>\n<blockquote>\n<p>What is it about my definition of my gcd function that causes <code>rfl</code> not to unfold it?</p>\n</blockquote>\n<p>This is explained in the <a href=\"https://lean-lang.org/blog/2024-7-1-lean-490/\">Lean v4.9.0 release blog post</a>:</p>\n<blockquote>\n<p>Functions defined by well-founded recursion are now irreducible by default. This eliminates performance gotchas [...]</p>\n<p>For such definitions, it's usually much better to explicitly rewrite using the equational lemmas that Lean generates, and the simplifier does this whenever the definition's name is specified as a¬†<code>simp</code>¬†rule. In Lean 4.9, these definitions are irreducible, which means that Lean will not unfold them unless explicitly asked to and the proofs no longer slow down computation.</p>\n</blockquote>",
        "id": 459551300,
        "sender_full_name": "Marcus Rossel",
        "timestamp": 1723229456
    },
    {
        "content": "<p>tldr: the fact that it is defined with WF-flavour recursion</p>",
        "id": 459551527,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723229547
    },
    {
        "content": "<p>Here's how you can permanently unseal it:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">semireducible</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">gcd</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">mod_lt</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">succ_pos</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"n\">gcd</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"n\">termination_by</span><span class=\"w\"> </span><span class=\"n\">b</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">gcd</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 459552206,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1723229792
    },
    {
        "content": "<p>Thanks.  For my purposes, that may be the best option.</p>",
        "id": 459552454,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1723229890
    },
    {
        "content": "<p>One more small issue.  I am in the habit of using <code>done</code> at the end of a tactic proof.  That now generates a warning, with the suggestion that <code>set_option linter.unusedTactic false</code> will suppress the warning.  That works, but I tried putting <code>moreGlobalServerArgs = [\"-Dlinter.unusedTactic=false\"]</code> in my lakefile.toml, and that doesn't work--Lean complains that <code>linter.unusedTactic</code> is an unknown configuration option.  Why?</p>",
        "id": 459557265,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1723231282
    },
    {
        "content": "<p>It looks like <span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span> included a way to make a blanket exception for a particular tactic.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">allow_unused_tactic</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Parser</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">done</span>\n</code></pre></div>",
        "id": 459557743,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1723231412
    },
    {
        "content": "<p>But is there a way to put something in my lakefile.toml that will fix the problem in all files in the project, rather than having to put a command at the top of every file?</p>",
        "id": 459558071,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1723231489
    },
    {
        "content": "<p>That's as far as I got looking into it, I'll leave it to <span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span>. I was thinking that you could potentially add it into a library file that everything else includes, but I don't know if it persists from one module to another.</p>",
        "id": 459558356,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1723231567
    },
    {
        "content": "<p>I was surprised that an option that works in <code>set_option</code> was not recognized when used in <code>moreGlobalServerArgs</code>.</p>",
        "id": 459558602,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1723231626
    },
    {
        "content": "<p>Oh right, <code>linter.unusedTactic</code> is defined within mathlib, so it can't be set from the command line ‚Äî until a recent version of Lean that is. It might be <code>-Dweak.linter.unusedTactic=false</code>, but I don't remember if mathlib currently is using the Lean with this feature. <em>Edit:</em> It looks like it is available on the master branch, but it's not in the 4.10.0 release.</p>",
        "id": 459559112,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1723231769
    },
    {
        "content": "<p>So it will be available in 4.11.0?</p>",
        "id": 459573718,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1723236234
    },
    {
        "content": "<p>Yes</p>",
        "id": 459573820,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1723236284
    },
    {
        "content": "<p>There is <a href=\"https://github.com/leanprover-community/mathlib4/pull/15616\">#15616</a> that systematically uses the new \"option framework\" in mathlib.</p>",
        "id": 459574094,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1723236434
    },
    {
        "content": "<p>I do not remember if the fix for excluding tactic from the unusedTactic linter would persist beyond the file with the exclusion: I hope that it would, but I am not sure that it has actually been tested.</p>",
        "id": 459574131,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1723236471
    },
    {
        "content": "<p>I just did a quick experiment, and it seems that <code>#allow_unused_tactic</code> does not persist.  With a current version of mathlib, you should be able to disable completely the unusedTactic linter, but I would have to think of an alternative solution to make the linter active, and yet have exceptions persist in imported files.</p>",
        "id": 459575672,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1723237196
    },
    {
        "content": "<p>Btw, when I teach, I also tell my students to start with a proof template <code>by sorry; done</code>.  I also like the linter to warn about unused tactics, so I would like to have a better solution to this issue.</p>",
        "id": 459576509,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1723237551
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"453098\">Dan Velleman</span> <a href=\"#narrow/stream/113488-general/topic/v4.2E10.2E0.20discussion/near/459573718\">said</a>:</p>\n<blockquote>\n<p>So it will be available in 4.11.0?</p>\n</blockquote>\n<p>It is already in <code>v4.11.0-rc1</code>.</p>",
        "id": 459612263,
        "sender_full_name": "Fran√ßois G. Dorais",
        "timestamp": 1723255584
    },
    {
        "content": "<p>Well, I updated to <code>v4.11.0-rc1</code> and I now no longer get an error message when I include \"-Dweak.linter.unusedTactic=false\" in <code>moreGlobalServerArgs</code>.  However, I still get the warning that <code>done</code> does nothing, so it doesn't seem to be setting the option.  Any ideas?</p>",
        "id": 459743536,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1723316277
    },
    {
        "content": "<p>\"-Dlinter.unusedTactic=false\" doesn't work either.</p>",
        "id": 459746034,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1723317271
    },
    {
        "content": "<p>I do not know from the command-line, but the PR above sets the lake-file.  The lakeOptions have <code>weak</code> and are relevant for <code>lake build</code>, while <code>moreServerArgs</code> (I think that the docs say something else, but this should be correct) set the options that you see highlighted in VSCode.</p>",
        "id": 459757600,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1723321968
    },
    {
        "content": "<p>Yes, that's what I thought.  So I thought that with <code>moreGlobalServerArgs = [\"-Dlinter.unusedTactic=false\"]</code> I would not see the warnings about <code>done</code> in VS Code.  But I still see the warnings.</p>",
        "id": 459763207,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1723325154
    },
    {
        "content": "<p>After a little more experimentation, I think using <code>moreServerOptions</code> works, but <code>moreServerArgs</code> doesn't.  Is the issue that <code>moreServerArgs</code> is applied at the command line, and (as <span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> commented earlier) this option can't be set at the command line?<br>\nNow my problem is that I really wanted to use <code>moreGlobalServerArgs</code>, but there's no <code>moreGlobalServerOptions</code>, is there?</p>",
        "id": 459908039,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1723393076
    },
    {
        "content": "<p>I'm pretty sure <code>moreGlobalServerArgs</code> and <code>moreServerArgs</code> are synonyms and the latter is deprecated. I don't understand why <code>moreServerOptions</code> is not sufficient to suppress all the warnings you care about? Where do you see undesired warnings?</p>",
        "id": 459927937,
        "sender_full_name": "Fran√ßois G. Dorais",
        "timestamp": 1723402488
    },
    {
        "content": "<p>it sounds to me like <code>moreServerOptions := #[‚ü®`linter.unusedTactic, false‚ü©]</code> is what you want</p>",
        "id": 459928190,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1723402747
    },
    {
        "content": "<p>As I understand it, <code>moreServerArgs</code> applies to all files that are in targets of the package, but <code>moreGlobalServerArgs</code> applies to all files that you open in VS Code, even if they are not in targets of the package.  My default target is a library, but I have some files that are not part of that library.  Those files contain exercises for students to do.  The student is supposed to prove some theorems in those files, but I don't see any reason for those files to ever get built, so I didn't put them in a target.  (In fact, a few exercises are incorrect theorems--the student is supposed to try to prove them and see where they get stuck.)  Arguments in <code>moreServerArgs</code> don't get applied to the student exercise files, but those in <code>moreGlobalServerArgs</code> do.<br>\nI'm not sure what the recommended configuration for this package is.  Perhaps I'm supposed to define a second target, put the student exercise files in that target, and then never build that target?</p>",
        "id": 459938429,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1723407173
    },
    {
        "content": "<p>Does setting <code>weakLeanArgs := #[\"-Dweak.linter.unusedTactic=false\"]</code> work? (The two \"weak\" mean different things!)</p>",
        "id": 459942087,
        "sender_full_name": "Fran√ßois G. Dorais",
        "timestamp": 1723408693
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"453098\">Dan Velleman</span> <a href=\"#narrow/stream/113488-general/topic/v4.2E10.2E0.20discussion/near/459938429\">said</a>:</p>\n<blockquote>\n<p>I'm not sure what the recommended configuration for this package is.  Perhaps I'm supposed to define a second target, put the student exercise files in that target, and then never build that target?</p>\n</blockquote>\n<p>That's probably the best option. <code>lake</code> doesn't know what to do with files that aren't in a target.</p>",
        "id": 459942534,
        "sender_full_name": "Fran√ßois G. Dorais",
        "timestamp": 1723408944
    },
    {
        "content": "<blockquote>\n<p>My default target is a library, but I have some files that are not part of that library. Those files contain exercises for students to do. The student is supposed to prove some theorems in those files, but I don't see any reason for those files to ever get built, so I didn't put them in a target.</p>\n</blockquote>\n<p>If you don't want a target to get built by default, just don't put <code>@[default_target]</code> on the library. I think this is probably better than just having them as loose files because then lake can apply settings to them and know how they fit into the project layout</p>",
        "id": 459942668,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1723409009
    },
    {
        "content": "<p>Thanks.  That seems to do what I want.</p>",
        "id": 459944397,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1723409953
    },
    {
        "content": "<p>Does this mean that <code>Archive</code> and <code>Counterexamples</code> should be marked as <code>@[default_target]</code>, so that the linters act on them as they do on <code>Mathlib</code> itself?</p>",
        "id": 459947603,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1723412841
    },
    {
        "content": "<p>No, they just need to be targets.</p>",
        "id": 459948356,
        "sender_full_name": "Fran√ßois G. Dorais",
        "timestamp": 1723413636
    },
    {
        "content": "<p>In the context of <a href=\"https://github.com/leanprover-community/mathlib4/pull/15616\">#15616</a>, Archive and Counterexamples are not linted by the Mathlib linters: how do I make them targets?</p>",
        "id": 459948543,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1723413768
    },
    {
        "content": "<p>They're already targets but the linter doesn't know about them.</p>",
        "id": 459956630,
        "sender_full_name": "Fran√ßois G. Dorais",
        "timestamp": 1723419729
    },
    {
        "content": "<p>The linter needs an update.</p>",
        "id": 459956808,
        "sender_full_name": "Fran√ßois G. Dorais",
        "timestamp": 1723419962
    },
    {
        "content": "<p>Actually, this is complicated. I have no idea why the Mathlib linter even works at all. Certainly, the makefile only runs it on Mathlib but is it still run through make?</p>",
        "id": 459957203,
        "sender_full_name": "Fran√ßois G. Dorais",
        "timestamp": 1723420418
    }
]