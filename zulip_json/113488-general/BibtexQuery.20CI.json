[
    {
        "content": "<p>The <a href=\"https://github.com/dupuisf/BibtexQuery\">BibtexQuery</a> repository is part of our essential infrastructure, as a dependency of <code>doc-gen4</code>.</p>\n<p>It currently doesn't have any CI set up. Would anyone be interested in jumping in and doing this? It is probably sufficient to just use the basic <code>lean-action</code> Github action that <code>lake init</code> provides.</p>",
        "id": 467105230,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1725336301
    },
    {
        "content": "<p>The repository belongs to <span class=\"user-mention\" data-user-id=\"311453\">@Frédéric Dupuis</span>. Also potentially interested in doing this would be <span class=\"user-mention\" data-user-id=\"366779\">@Jz Pan</span>, who introduced that dependency in doc-gen4.</p>\n<p>But all welcome. :-)</p>",
        "id": 467105598,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1725336423
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/113488-general/topic/BibtexQuery.20CI/near/467105230\">said</a>:</p>\n<blockquote>\n<p>The <a href=\"https://github.com/dupuisf/BibtexQuery\">BibtexQuery</a> repository is part of our essential infrastructure, as a dependency of <code>doc-gen4</code>.</p>\n<p>It currently doesn't have any CI set up. Would anyone be interested in jumping in and doing this? It is probably sufficient to just use the basic <code>lean-action</code> Github action that <code>lake init</code> provides.</p>\n</blockquote>\n<p>I think it's a good idea. However I'm not familiar with github CI infrastructure. Maybe we can copy some CI-related code from doc-gen4, since I remembered that there is a CI workflow.</p>",
        "id": 467213436,
        "sender_full_name": "Jz Pan",
        "timestamp": 1725361347
    },
    {
        "content": "<p>doc-gen's CI workflow is not using lean-action yet (though we could also change that if people want to)</p>",
        "id": 467225592,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1725364301
    },
    {
        "content": "<p>I wouldn't copy from doc-gen. Just run <code>lake new</code> to get a fresh repository, then mimic the CI setup provided there. It is minimal, but all that is needed for BibtexQuery.</p>",
        "id": 467374738,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1725405464
    },
    {
        "content": "<p>Done at <a href=\"https://github.com/dupuisf/BibtexQuery/pull/15\">BibtexQuery#15</a></p>",
        "id": 467377387,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1725407001
    },
    {
        "content": "<p>I just merged it, but I have no idea what this actually does. What sort of CI do we get here?</p>",
        "id": 467378394,
        "sender_full_name": "Frédéric Dupuis",
        "timestamp": 1725407628
    },
    {
        "content": "<p>Now, every time there is a push or PR or manually trigger it, a test build will be run. So now you can wait for the checkmark instead of trying it on your computer, for example.</p>",
        "id": 467378677,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1725407785
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"311453\">@Frédéric Dupuis</span>  I just created a dummy PR for you so you can see it in action.</p>",
        "id": 467379765,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1725408425
    },
    {
        "content": "<p>Is it possible to run a test after build finished? For example <code>lake exe bibtex-query l references.bib</code> on a fixed version of mathlib's references file, to see if it can be processed correctly.</p>",
        "id": 467463735,
        "sender_full_name": "Jz Pan",
        "timestamp": 1725439994
    },
    {
        "content": "<p>Yes, definitely. Have a look at the lakefile.lean / toml's of a few projects to see how it is done. <code>testDriver</code> and <code>testDriverArgs</code> are the relevant settings.</p>",
        "id": 467477916,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1725443268
    },
    {
        "content": "<p>You can arrange so that <code>lake test</code> either runs an arbitrary <code>lake exe ....</code>, or just compiles a separate library.</p>",
        "id": 467478075,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1725443304
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"395550\">Henrik Böving</span> <a href=\"#narrow/stream/113488-general/topic/BibtexQuery.20CI/near/467225592\">said</a>:</p>\n<blockquote>\n<p>doc-gen's CI workflow is not using lean-action yet (though we could also change that if people want to)</p>\n</blockquote>\n<p>I opened <a href=\"https://github.com/leanprover/doc-gen4/pull/218\">a PR</a> to use <code>lean-action</code> in <code>doc-gen</code></p>",
        "id": 467486671,
        "sender_full_name": "Austin Letson",
        "timestamp": 1725445250
    },
    {
        "content": "<p>We could also potentially wrap the <code>test_docs.sh</code> script in a <code>testDriver</code> to use <code>lake test</code>.</p>",
        "id": 467488151,
        "sender_full_name": "Austin Letson",
        "timestamp": 1725445639
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"699684\">Austin Letson</span> <a href=\"#narrow/stream/113488-general/topic/BibtexQuery.20CI/near/467488151\">said</a>:</p>\n<blockquote>\n<p>We could also potentially wrap the <code>test_docs.sh</code> script in a <code>testDriver</code> to use <code>lake test</code>.</p>\n</blockquote>\n<p>I think it's fine to keep it this way for now.</p>",
        "id": 467500425,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1725448620
    }
]