[
    {
        "content": "<p>I'm formalizing modal logic with neighborhood semantics and i have to deal <code>Set</code> operation with equality casting. Main point is that below code need to be proved. are they correct? Intuitively they might be right, but i dont how to prove.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Image</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"n\">Œ≤</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Œ≤</span><span class=\"o\">)</span>\n<span class=\"w\">         </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">}</span>\n<span class=\"w\">         </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Œ≤</span><span class=\"o\">}</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚àÖ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚àÖ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Œ≤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"bp\">;</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚à™</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">‚à™</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"bp\">;</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"bp\">·∂ú</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"bp\">·∂ú</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"bp\">;</span>\n</code></pre></div>\n<p><a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMB0ARFJHAZQFMYcBJEJAc1ICgGA3JKYJLdUuAb0EbgOICbgAL5wAFKQCOcAFxxBAXmEBKBnA2bNvJHCxy4ZePxHqtW3gA84ATwNHhphqUtJw3A+MCgRPfIKVcMrScIAdpBI+8g5CAbLKWHYAztBQNgDcTC5uYB7ykjJhSAGAVEQSwWFYAUH5ErolFXJxiclpGa7uPLllcIWAObiBpdXiSD0qMY1wSVApqUA\">https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMB0ARFJHAZQFMYcBJEJAc1ICgGA3JKYJLdUuAb0EbgOICbgAL5wAFKQCOcAFxxBAXmEBKBnA2bNvJHCxy4ZePxHqtW3gA84ATwNHhphqUtJw3A+MCgRPfIKVcMrScIAdpBI+8g5CAbLKWHYAztBQNgDcTC5uYB7ykjJhSAGAVEQSwWFYAUH5ErolFXJxiclpGa7uPLllcIWAObiBpdXiSD0qMY1wSVApqUA</a></p>",
        "id": 529522712,
        "sender_full_name": "SnO2WMaN",
        "timestamp": 1752870485
    },
    {
        "content": "<p>You shouldn't have <code>eq : Œ± = Œ≤</code> because it's really easy to stumble into a goal that's both \"obviously\" true and not possible to prove (and not possible to disprove either)</p>",
        "id": 529523012,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752870647
    },
    {
        "content": "<p>but yes in this case they are true</p>",
        "id": 529523028,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752870656
    },
    {
        "content": "<p>you can solve them by <code>cases eq; rfl</code></p>",
        "id": 529523085,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752870678
    },
    {
        "content": "<p>what led you to have these problems in the first place?</p>",
        "id": 529523106,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752870690
    },
    {
        "content": "<p>To tell why i have, i have to explain some modal logic / neighborhood semantics following textbook, but it's longer.<br>\nSo extract main point. I've define structure <code>Frame</code>, and <code>Frame.IsCanonical</code> as below. to prove <code>truthlemma</code>, we need to prove <code>eq_empty</code>, <code>eq_union</code>, <code>eq_comp</code> and <code>iff_mem</code>. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Frame</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">World</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">world_nonempty</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"n\">World</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">World</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">World</span><span class=\"o\">)</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">MaximalConsistentSet</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ùì¢</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FormulaSet</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Consistent</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">U</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">‚äÇ</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Inconsistent</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"o\">)}</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">Frame</span><span class=\"bp\">.</span><span class=\"n\">IsCanonical</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Frame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ùì¢</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">eq_world</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"bp\">.</span><span class=\"n\">World</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">MaximalConsistentSet</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span>\n<span class=\"w\">  </span><span class=\"n\">box_proofset</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">œÜ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"bp\">.</span><span class=\"n\">box</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">eq_world</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">proofset</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"w\"> </span><span class=\"n\">œÜ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">eq_world</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">proofset</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚ñ°</span><span class=\"n\">œÜ</span><span class=\"o\">))</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">eq_empty</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">canonical</span><span class=\"bp\">.</span><span class=\"n\">eq_world</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚àÖ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MaximalConsistentSet</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‚àÖ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">canonical</span><span class=\"bp\">.</span><span class=\"n\">eq_world</span><span class=\"bp\">;</span>\n<span class=\"w\">  </span><span class=\"c1\">--</span>\n<span class=\"w\">  </span><span class=\"c1\">-- rfl;</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">eq_union</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MaximalConsistentSet</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"o\">)}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">canonical</span><span class=\"bp\">.</span><span class=\"n\">eq_world</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">‚à™</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">canonical</span><span class=\"bp\">.</span><span class=\"n\">eq_world</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚à™</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">canonical</span><span class=\"bp\">.</span><span class=\"n\">eq_world</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span><span class=\"bp\">;</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">eq_comp</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MaximalConsistentSet</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"o\">)}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">canonical</span><span class=\"bp\">.</span><span class=\"n\">eq_world</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"bp\">·∂ú</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">canonical</span><span class=\"bp\">.</span><span class=\"n\">eq_world</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"bp\">·∂ú</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span><span class=\"bp\">;</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">iff_mem</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œì</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MaximalConsistentSet</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">canonical</span><span class=\"bp\">.</span><span class=\"n\">eq_world</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"n\">Œì</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">canonical</span><span class=\"bp\">.</span><span class=\"n\">eq_world</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span><span class=\"bp\">;</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">truthlemma</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">canonical</span><span class=\"bp\">.</span><span class=\"n\">eq_world</span><span class=\"w\"> </span><span class=\"bp\">‚ñ∏</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">proofset</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"w\"> </span><span class=\"n\">œÜ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">canonicalModel</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">truthset</span><span class=\"w\"> </span><span class=\"n\">œÜ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">œÜ</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">hatom</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">canonicalModel</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">hfalsum</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">canonicalModel</span><span class=\"o\">]</span><span class=\"bp\">;</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">himp</span><span class=\"w\"> </span><span class=\"n\">œÜ</span><span class=\"w\"> </span><span class=\"n\">œà</span><span class=\"w\"> </span><span class=\"n\">ihœÜ</span><span class=\"w\"> </span><span class=\"n\">ihœà</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">simp_all</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MaximalConsistentSet</span><span class=\"bp\">.</span><span class=\"n\">proofset</span><span class=\"bp\">.</span><span class=\"n\">eq_imp</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"n\">ihœÜ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"n\">ihœà</span><span class=\"o\">]</span><span class=\"bp\">;</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">hbox</span><span class=\"w\"> </span><span class=\"n\">œÜ</span><span class=\"w\"> </span><span class=\"n\">ihœÜ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Model</span><span class=\"bp\">.</span><span class=\"n\">truthset</span><span class=\"bp\">.</span><span class=\"n\">eq_box</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"n\">ihœÜ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"o\">(</span><span class=\"n\">canonical</span><span class=\"bp\">.</span><span class=\"n\">box_proofset</span><span class=\"w\"> </span><span class=\"n\">œÜ</span><span class=\"o\">)]</span><span class=\"bp\">;</span>\n<span class=\"w\">    </span><span class=\"n\">rfl</span><span class=\"bp\">;</span>\n</code></pre></div>",
        "id": 529525817,
        "sender_full_name": "SnO2WMaN",
        "timestamp": 1752872337
    },
    {
        "content": "<p>I can prove them by ‚ÜìÔºéthanks to hint.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">haveI</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">canonical</span><span class=\"bp\">.</span><span class=\"n\">eq_world</span><span class=\"bp\">;</span>\n<span class=\"n\">grind</span><span class=\"bp\">;</span>\n</code></pre></div>",
        "id": 529526078,
        "sender_full_name": "SnO2WMaN",
        "timestamp": 1752872482
    },
    {
        "content": "<p>Why are you bundling <code>World</code> in your <code>Frame</code>?</p>",
        "id": 529526375,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752872669
    },
    {
        "content": "<p>can you make it like <code>structure Frame (World : Type) where</code>, like how groups are <code>class Group (G : Type u) extends DivInvMonoid G where</code>?</p>",
        "id": 529526532,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752872759
    },
    {
        "content": "<p>we define class (set) of frame <code>def FrameClass := Set (Frame)</code> and operating with semantics. binding world is too much complex</p>",
        "id": 529526545,
        "sender_full_name": "SnO2WMaN",
        "timestamp": 1752872766
    },
    {
        "content": "<p>put the world as a parameter to your frames</p>",
        "id": 529526562,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752872776
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"543250\">Mashu Noguchi</span> <a href=\"#narrow/channel/113488-general/topic/Set.20operation.20with.20equality.20casting/near/529526545\">said</a>:</p>\n<blockquote>\n<p>we define class (set) of frame <code>def FrameClass := Set (Frame)</code> and operating with semantics. binding world is too much complex</p>\n</blockquote>\n<p>why do you want this?</p>",
        "id": 529526658,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752872844
    },
    {
        "content": "<p>This definition suits our (FormalizedFormalLogic) meta-logical semantics tools. Refer our codes (it's the case of Kripke semantics, not neighborhood one, but almost same)</p>\n<p><a href=\"https://github.com/FormalizedFormalLogic/Foundation/blob/8c5fc737bed001eef5eab12c68cc6477db53db9c/Foundation/Modal/Kripke/Basic.lean#L532-L558\">https://github.com/FormalizedFormalLogic/Foundation/blob/8c5fc737bed001eef5eab12c68cc6477db53db9c/Foundation/Modal/Kripke/Basic.lean#L532-L558</a></p>",
        "id": 529526893,
        "sender_full_name": "SnO2WMaN",
        "timestamp": 1752872999
    },
    {
        "content": "<p>Yes <code>structure Frame (World : Type) where</code> I considered once. but this def was harder to liftup for frameclass and don't have good idea, when  i tried (half years ago).</p>",
        "id": 529527088,
        "sender_full_name": "SnO2WMaN",
        "timestamp": 1752873119
    },
    {
        "content": "<p>this still feels like a bad idea</p>",
        "id": 529527298,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752873273
    },
    {
        "content": "<p>What is the usage of <code>Frame.IsCanonical</code>?</p>",
        "id": 529527374,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752873334
    },
    {
        "content": "<p>Why don't you just state your lemmas for <code>canonicalFrame</code> instead of having a typeclass?</p>",
        "id": 529527411,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752873361
    },
    {
        "content": "<p>I can't tell what you need here</p>",
        "id": 529527566,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752873482
    },
    {
        "content": "<p>plz wait a moment, I'll push current codes to our repo as PR. I'll refer the codes to explain.</p>",
        "id": 529527651,
        "sender_full_name": "SnO2WMaN",
        "timestamp": 1752873533
    },
    {
        "content": "<p>but bundling the type and using type equality just seems like a bad idea overall</p>",
        "id": 529527707,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752873567
    },
    {
        "content": "<p>Logical background:</p>\n<p>We use <code>Frame.IsCanonical</code> for prove completeness for usual proof. more precisely, if some frame that is canonical is exists in class of frame <code>C</code>, then logic is complete for <code>C</code>. (In normal modal logic with Kripke semantics, canonical frame is <em>defined</em> and exact one, but in neighborhood, defined \"frame is canonical\" and don't know if there's)</p>\n<p><a href=\"https://github.com/FormalizedFormalLogic/Foundation/blob/a5c8cb72b74855a7669e069b8f55748a73d14b4b/Foundation/Modal/Neighborhood/Completeness.lean#L147\">https://github.com/FormalizedFormalLogic/Foundation/blob/a5c8cb72b74855a7669e069b8f55748a73d14b4b/Foundation/Modal/Neighborhood/Completeness.lean#L147</a></p>\n<p>So to prove completeness, we have to find canonical frame. the minimal canonical frame (<code>minimalCanonicalFrame</code>) is defined and it can proved in canonicality. and all <code>FrameClass</code> (i.e. <code>Set.univ</code>) trivially contains it, so weakest modal logic <code>E</code> is complete.</p>\n<p><a href=\"https://github.com/FormalizedFormalLogic/Foundation/blob/a5c8cb72b74855a7669e069b8f55748a73d14b4b/Foundation/Modal/Neighborhood/Completeness.lean#L170-L172\">https://github.com/FormalizedFormalLogic/Foundation/blob/a5c8cb72b74855a7669e069b8f55748a73d14b4b/Foundation/Modal/Neighborhood/Completeness.lean#L170-L172</a></p>\n<p>but this is weak for (i.e. is not canonical for) more extended logics (e.g. <code>EM</code>,<code>EC</code>, <code>ET</code>, etc.). we need to supplementation of frame (it defined for all frame). it conserve the property reflexivity, transitivity. </p>\n<p><a href=\"https://github.com/FormalizedFormalLogic/Foundation/blob/a5c8cb72b74855a7669e069b8f55748a73d14b4b/Foundation/Modal/Neighborhood/Supplementation.lean#L10\">https://github.com/FormalizedFormalLogic/Foundation/blob/a5c8cb72b74855a7669e069b8f55748a73d14b4b/Foundation/Modal/Neighborhood/Supplementation.lean#L10</a></p>\n<p><a href=\"https://github.com/FormalizedFormalLogic/Foundation/blob/a5c8cb72b74855a7669e069b8f55748a73d14b4b/Foundation/Modal/Neighborhood/Supplementation.lean#L63-L89\">https://github.com/FormalizedFormalLogic/Foundation/blob/a5c8cb72b74855a7669e069b8f55748a73d14b4b/Foundation/Modal/Neighborhood/Supplementation.lean#L63-L89</a></p>\n<p>And the \"supplement of canonical frame\" is canonical in these extended logics <code>&gt;= EM</code>.</p>",
        "id": 529530089,
        "sender_full_name": "SnO2WMaN",
        "timestamp": 1752875298
    },
    {
        "content": "<p>interesting</p>",
        "id": 529531221,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752876322
    },
    {
        "content": "<p>and what was the problem using <code>structure Frame (World : Type) where</code>?</p>",
        "id": 529531253,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752876348
    },
    {
        "content": "<p>In this case we might have define frame class as <code>Set (W : Type) √ó  (Frame W)</code>, it cumbersome for our framework.</p>",
        "id": 529531368,
        "sender_full_name": "SnO2WMaN",
        "timestamp": 1752876441
    },
    {
        "content": "<p>what do you want frame classes for again?</p>",
        "id": 529531397,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752876475
    },
    {
        "content": "<p><code>Set ((W : Type) √ó (Frame W))</code> will probably run into the same type equality issues</p>",
        "id": 529531449,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752876514
    },
    {
        "content": "<p>in (purely) modal logic perspective, in following textbook or manner in set-based argument, frame class is for capturing \"frame is reflexive\", \"frame has only finite points\", \"frame is tree-like form\" etc. <br>\nHowever I can't say what means frame class in perspective implementing logic in type theory / theorem prover / lean4.  I implement the fact of modal logics followed straightforward the textbook and nothing change with big treatement. is it satisfy your question?</p>",
        "id": 529532020,
        "sender_full_name": "SnO2WMaN",
        "timestamp": 1752876980
    },
    {
        "content": "<p>then this might be reasonable</p>",
        "id": 529532247,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752877154
    },
    {
        "content": "<p>anyway i close this,. thanks</p>",
        "id": 529532340,
        "sender_full_name": "SnO2WMaN",
        "timestamp": 1752877215
    },
    {
        "content": "<p>Won't this be solved if you only claim that <code>F.World</code> is <em>equivalent</em> to <code>MaximalConsistentSet</code>? Then most of these casting lemmas are just normal set theory lemmas, I think...</p>",
        "id": 529557363,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752908266
    },
    {
        "content": "<p>That way you also stand a chance of <em>disproving</em> that a frame is canonical</p>",
        "id": 529557404,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752908338
    },
    {
        "content": "<p>Or that a frame is canonical in a nontrivial way</p>",
        "id": 529557424,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752908366
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/channel/113488-general/topic/Set.20operation.20with.20equality.20casting/near/529557363\">said</a>:</p>\n<blockquote>\n<p>Won't this be solved if you only claim that <code>F.World</code> is <em>equivalent</em> to <code>MaximalConsistentSet</code>? Then most of these casting lemmas are just normal set theory lemmas, I think...</p>\n</blockquote>\n<p>You mean <em>equivalent</em> to <code>F.World ‚âä MaximalConsistentSet ùì¢</code>? might be well, but it's cumbersome. I don't think <code>F.World = MaximalConsistentSet ùì¢</code> is not so problematic.  I don't need to prove the \"frame is <em>not</em> canonical\", it's not necessary. Sorry if i misunderstand your saying.</p>",
        "id": 529583964,
        "sender_full_name": "SnO2WMaN",
        "timestamp": 1752939437
    },
    {
        "content": "<p>no I think that's problematic, since it makes things more difficult</p>",
        "id": 529584308,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752939852
    },
    {
        "content": "<p>i was personally thinking <code>F.World ‚âÉ MaximalConsistentSet ùì¢</code></p>",
        "id": 529586001,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752941074
    },
    {
        "content": "<p>That would be data</p>",
        "id": 529588532,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752941439
    },
    {
        "content": "<p>ah, right.. then i guess something like <code>‚àÉ e : F.World ‚âÉ MaximalConsistentSet ùì¢, ‚àÄ œÜ, F.box (e '' (proofset ùì¢ œÜ)) = e '' (proofset ùì¢ (‚ñ°œÜ))</code> is the right thing?</p>",
        "id": 529591298,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752942703
    },
    {
        "content": "<p>i don't know how equality version <code>=</code> causes crucial problem so can't judge your concern. for proving <code>eq_world</code> in <code>miniCanonicalFrame</code> use simply <code>rfl</code> and <code>box_proofset</code>  is usual way. would you show me your simple example how break?</p>",
        "id": 529603326,
        "sender_full_name": "SnO2WMaN",
        "timestamp": 1752947676
    },
    {
        "content": "<p>my concern is that at some point you might have to state something like \"this frame is equivalent to a canonical one\" rather than \"this frame is a canonical one\", because you can't prove stuff like <code>{x:A // x = x} = A</code> or <code>{x:A // P x} ‚äï {x:A//¬¨P x} = A</code> in lean, whereas you <em>can</em> show that they're equivalent by giving an explicit bijection.</p>",
        "id": 529604291,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752948798
    },
    {
        "content": "<p>all right i understand your concern but currently equality is going well. canonicity is only needed to prove completeness and no longer needed when proved. if i have some problem, i'll change them. (for main point, it is good if truthlemma and 1 lemma is holded whatever defined canonicity)</p>",
        "id": 529604984,
        "sender_full_name": "SnO2WMaN",
        "timestamp": 1752949621
    }
]