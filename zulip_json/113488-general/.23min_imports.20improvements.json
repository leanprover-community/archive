[
    {
        "content": "<p>I have two small ideas of improvements to <code>#min_imports</code>:</p>\n<ol>\n<li>Could it sort its output alphabetically? Often I have to update the output myself.</li>\n<li>Could its message be a code action to replace the existing imports?</li>\n</ol>",
        "id": 455837136,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1722577328
    },
    {
        "content": "<p>I think that the minImports <em>linter</em> sorts the imports.</p>",
        "id": 455842017,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1722579757
    },
    {
        "content": "<p>It does not come with an action, though, but it flags the unnecessary/excessive ones.</p>",
        "id": 455842061,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1722579789
    },
    {
        "content": "<p>If you want to try it out, use</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">Linter</span><span class=\"bp\">.</span><span class=\"n\">MinImports</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">minImports</span><span class=\"w\"> </span><span class=\"n\">true</span>\n</code></pre></div>\n<p>at the beginning of the file.</p>",
        "id": 455842187,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1722579859
    },
    {
        "content": "<p>I am resurrecting this year-old thread to ask if it would be possible to improve the way git discusses with <code>min_imports</code>. When forgetting the line and pushing, the error message is inintellegible, see for instance<br>\n<a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/18542616069/job/52853566507\">https://github.com/leanprover-community/mathlib4/actions/runs/18542616069/job/52853566507</a></p>",
        "id": 545134923,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1760566157
    },
    {
        "content": "<p>I'm guessing this is a case where the only issue is that <code>#min_imports</code> caused lean to output some lines to stdout and this failed the build? I'm slightly surprised this wasn't caught earlier in the \"build mathlib\" step, but maybe we're letting this sort of thing through so that the cache can get uploaded. </p>\n<p>We also have a \"check for noisy stdout lines\" step which I guess is meant to catch this sort of thing but it looks like it got skipped due to this being caught in an earlier step. Maybe if we moved that step earlier you could have gotten a hint about the problem from the name of the failing step at least.</p>",
        "id": 545136178,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1760566778
    },
    {
        "content": "<p>Indeed, noisy output is intended to be caught later in the process, since it is not an issue to building the code.  It is unfortunate that testing does its own checking of noisiness, so that, importing a noisy file in a test will trigger that error, instead of the one that would tell you that there was a noisy output.</p>",
        "id": 546098798,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1760995527
    }
]