[
    {
        "content": "<p>I'm trying to create a proofwidget for game search trees but i cant get the repulsion between nodes working</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">ProofWidgets</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">ProofWidgets</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Html</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">ProofWidgets</span><span class=\"w\"> </span><span class=\"n\">GraphDisplay</span><span class=\"w\"> </span><span class=\"n\">Jsx</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mkRect</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">attrs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"bp\">Ã—</span><span class=\"w\"> </span><span class=\"n\">Json</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[])</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Html</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">&lt;</span><span class=\"n\">rect</span>\n<span class=\"w\">    </span><span class=\"n\">x</span><span class=\"bp\">=</span><span class=\"o\">{</span><span class=\"bp\">.</span><span class=\"n\">num</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">25</span><span class=\"o\">)}</span>\n<span class=\"w\">    </span><span class=\"n\">y</span><span class=\"bp\">=</span><span class=\"o\">{</span><span class=\"bp\">.</span><span class=\"n\">num</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">100</span><span class=\"o\">)}</span>\n<span class=\"w\">    </span><span class=\"n\">width</span><span class=\"bp\">=</span><span class=\"o\">{</span><span class=\"mi\">50</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"n\">height</span><span class=\"bp\">=</span><span class=\"o\">{</span><span class=\"mi\">100</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"n\">fill</span><span class=\"bp\">=</span><span class=\"s2\">\"var(--vscode-editor-background)\"</span>\n<span class=\"w\">    </span><span class=\"n\">stroke</span><span class=\"bp\">=</span><span class=\"s2\">\"var(--vscode-editor-foreground)\"</span>\n<span class=\"w\">    </span><span class=\"n\">strokeWidth</span><span class=\"bp\">=</span><span class=\"o\">{</span><span class=\"bp\">.</span><span class=\"n\">num</span><span class=\"w\"> </span><span class=\"mf\">1.5</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"bp\">...</span><span class=\"n\">attrs</span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"bp\">/&gt;</span>\n\n<span class=\"sd\">/-- Create a single cell at absolute (x, y) coordinates -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mkCell</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">content</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Html</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Html</span><span class=\"bp\">.</span><span class=\"n\">element</span><span class=\"w\"> </span><span class=\"s2\">\"g\"</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[]</span>\n<span class=\"w\">    </span><span class=\"bp\">#</span><span class=\"o\">[</span>\n<span class=\"w\">      </span><span class=\"c1\">-- rectangle background</span>\n<span class=\"w\">      </span><span class=\"n\">Html</span><span class=\"bp\">.</span><span class=\"n\">element</span><span class=\"w\"> </span><span class=\"s2\">\"rect\"</span>\n<span class=\"w\">        </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"s2\">\"x\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">num</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">),</span>\n<span class=\"w\">           </span><span class=\"o\">(</span><span class=\"s2\">\"y\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">num</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">),</span>\n<span class=\"w\">           </span><span class=\"o\">(</span><span class=\"s2\">\"width\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">num</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">),</span>\n<span class=\"w\">           </span><span class=\"o\">(</span><span class=\"s2\">\"height\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">num</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">),</span>\n<span class=\"w\">           </span><span class=\"o\">(</span><span class=\"s2\">\"fill\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">str</span><span class=\"w\"> </span><span class=\"s2\">\"var(--vscode-editor-background)\"</span><span class=\"o\">),</span>\n<span class=\"w\">           </span><span class=\"o\">(</span><span class=\"s2\">\"stroke\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">str</span><span class=\"w\"> </span><span class=\"s2\">\"var(--vscode-editor-foreground)\"</span><span class=\"o\">),</span>\n<span class=\"w\">           </span><span class=\"o\">(</span><span class=\"s2\">\"strokeWidth\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">num</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"bp\">#</span><span class=\"o\">[],</span>\n<span class=\"w\">      </span><span class=\"c1\">-- text centered inside cell</span>\n<span class=\"w\">      </span><span class=\"n\">Html</span><span class=\"bp\">.</span><span class=\"n\">element</span><span class=\"w\"> </span><span class=\"s2\">\"text\"</span>\n<span class=\"w\">        </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"s2\">\"x\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">num</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)),</span>\n<span class=\"w\">           </span><span class=\"o\">(</span><span class=\"s2\">\"y\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">num</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)),</span>\n<span class=\"w\">           </span><span class=\"o\">(</span><span class=\"s2\">\"text-anchor\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">str</span><span class=\"w\"> </span><span class=\"s2\">\"middle\"</span><span class=\"o\">),</span>\n<span class=\"w\">           </span><span class=\"o\">(</span><span class=\"s2\">\"dominant-baseline\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">str</span><span class=\"w\"> </span><span class=\"s2\">\"middle\"</span><span class=\"o\">),</span>\n<span class=\"w\">           </span><span class=\"o\">(</span><span class=\"s2\">\"class\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">str</span><span class=\"w\"> </span><span class=\"s2\">\"font-code\"</span><span class=\"o\">),</span>\n<span class=\"w\">           </span><span class=\"o\">(</span><span class=\"s2\">\"fill\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">str</span><span class=\"w\"> </span><span class=\"s2\">\"var(--vscode-editor-foreground)\"</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"w\"> </span><span class=\"n\">Html</span><span class=\"bp\">.</span><span class=\"n\">text</span><span class=\"w\"> </span><span class=\"n\">content</span><span class=\"w\"> </span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">]</span>\n\n\n<span class=\"sd\">/-- Build the 2Ã—3 grid using only for loops and get! -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mkGrid</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">grid</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cellW</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">50</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cellH</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">100</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">spacing</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">attrs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"bp\">Ã—</span><span class=\"w\"> </span><span class=\"n\">Json</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[])</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Html</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Id</span><span class=\"bp\">.</span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mut</span><span class=\"w\"> </span><span class=\"n\">children</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"n\">Html</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[]</span>\n<span class=\"w\">  </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">rowIdx</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">grid</span><span class=\"bp\">.</span><span class=\"n\">size</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">row</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">grid</span><span class=\"bp\">.</span><span class=\"n\">get!</span><span class=\"w\"> </span><span class=\"n\">rowIdx</span>\n<span class=\"w\">    </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">colIdx</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">row</span><span class=\"bp\">.</span><span class=\"n\">size</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">cell</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">row</span><span class=\"bp\">.</span><span class=\"n\">get!</span><span class=\"w\"> </span><span class=\"n\">colIdx</span>\n<span class=\"w\">      </span><span class=\"n\">children</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">children</span><span class=\"bp\">.</span><span class=\"n\">push</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mkCell</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">colIdx</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cellW</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">spacing</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rowIdx</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cellH</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">spacing</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">cellW</span><span class=\"w\"> </span><span class=\"n\">cellH</span><span class=\"w\"> </span><span class=\"n\">cell</span><span class=\"o\">)</span>\n\n<span class=\"w\">  </span><span class=\"c1\">-- total width and height of the grid</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">totalCols</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">grid</span><span class=\"bp\">.</span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"bp\">==</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"n\">grid</span><span class=\"bp\">.</span><span class=\"n\">get!</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">|&gt;.</span><span class=\"n\">size</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">totalWidth</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">totalCols</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cellW</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">spacing</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">spacing</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">totalHeight</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">grid</span><span class=\"bp\">.</span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cellH</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">spacing</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">spacing</span>\n\n<span class=\"w\">  </span><span class=\"c1\">-- wrap the cells in a &lt;g&gt; and shift so bottom middle is at (0,0)</span>\n<span class=\"w\">  </span><span class=\"n\">Html</span><span class=\"bp\">.</span><span class=\"n\">element</span><span class=\"w\"> </span><span class=\"s2\">\"g\"</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"bp\">#</span><span class=\"o\">[]</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">attrs</span><span class=\"w\"> </span><span class=\"bp\">++</span>\n<span class=\"w\">      </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"s2\">\"transform\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">str</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"translate({-(totalWidth / 2 : Int)}, {-(totalHeight : Int) / 2})\"</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">])</span>\n<span class=\"w\">    </span><span class=\"n\">children</span>\n\n<span class=\"sd\">/-- Single vertex containing the grid -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">gridVertex</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">GraphDisplay</span><span class=\"bp\">.</span><span class=\"n\">Vertex</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"A\"</span>\n<span class=\"w\">    </span><span class=\"n\">label</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">mkGrid</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"A\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\".\"</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"B\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"A\"</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\".\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"B\"</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"mi\">50</span><span class=\"w\"> </span><span class=\"mi\">50</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">boundingShape</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">rect</span><span class=\"w\"> </span><span class=\"mi\">50</span><span class=\"w\"> </span><span class=\"mi\">100</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n\n<span class=\"sd\">/-- Single vertex containing the grid -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">gridVertex1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">GraphDisplay</span><span class=\"bp\">.</span><span class=\"n\">Vertex</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"B\"</span>\n<span class=\"w\">    </span><span class=\"n\">label</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">mkGrid</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"A\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\".\"</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"B\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"A\"</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\".\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"B\"</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"mi\">50</span><span class=\"w\"> </span><span class=\"mi\">50</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">boundingShape</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">rect</span><span class=\"w\"> </span><span class=\"mi\">50</span><span class=\"w\"> </span><span class=\"mi\">100</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n\n<span class=\"sd\">/-- Single vertex containing the grid -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">gridVertex2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">GraphDisplay</span><span class=\"bp\">.</span><span class=\"n\">Vertex</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"C\"</span>\n<span class=\"w\">    </span><span class=\"n\">label</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">mkGrid</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"A\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\".\"</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"B\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"A\"</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\".\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"B\"</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"mi\">50</span><span class=\"w\"> </span><span class=\"mi\">50</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">boundingShape</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">rect</span><span class=\"w\"> </span><span class=\"mi\">50</span><span class=\"w\"> </span><span class=\"mi\">100</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n\n<span class=\"bp\">#</span><span class=\"n\">html</span><span class=\"w\"> </span><span class=\"n\">mkGrid</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"A\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\".\"</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"B\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"A\"</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\".\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"B\"</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">testGraph</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">GraphDisplay</span><span class=\"bp\">.</span><span class=\"n\">Props</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">vertices</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span>\n<span class=\"w\">      </span><span class=\"n\">gridVertex</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"n\">gridVertex1</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"n\">gridVertex2</span>\n<span class=\"w\">    </span><span class=\"o\">],</span>\n<span class=\"w\">    </span><span class=\"n\">edges</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span>\n<span class=\"w\">      </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">source</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"A\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"B\"</span><span class=\"w\"> </span><span class=\"o\">},</span>\n<span class=\"w\">      </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">source</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"A\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"C\"</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">forces</span><span class=\"o\">:=</span><span class=\"bp\">#</span><span class=\"o\">[</span>\n<span class=\"w\">        </span><span class=\"bp\">.</span><span class=\"n\">link</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">distance?</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Float</span><span class=\"bp\">.</span><span class=\"n\">ofNat</span><span class=\"w\"> </span><span class=\"mi\">50</span><span class=\"w\"> </span><span class=\"o\">},</span>\n<span class=\"w\">        </span><span class=\"bp\">.</span><span class=\"n\">collide</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">radius?</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Float</span><span class=\"bp\">.</span><span class=\"n\">ofNat</span><span class=\"w\"> </span><span class=\"mi\">15</span><span class=\"w\"> </span><span class=\"o\">},</span>\n<span class=\"w\">        </span><span class=\"bp\">.</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">strength?</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"mf\">0.05</span><span class=\"w\"> </span><span class=\"o\">},</span>\n<span class=\"w\">        </span><span class=\"bp\">.</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">strength?</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"mf\">0.05</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"w\">      </span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n\n<span class=\"bp\">#</span><span class=\"n\">widget</span><span class=\"w\"> </span><span class=\"n\">GraphDisplay</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">testGraph</span>\n</code></pre></div>",
        "id": 544450884,
        "sender_full_name": "Frederick Pu",
        "timestamp": 1760328135
    },
    {
        "content": "<p>Could you say more about what effect you want to achieve? The nodes are quite large, so you may need to adjust the force parameters to get the desired effect. I get a reasonable behaviour with link distance 200 and collide radius 100. In <a href=\"https://github.com/leanprover-community/ProofWidgets4/blob/556caed0eadb7901e068131d1be208dd907d07a2/ProofWidgets/Demos/Graph/ExprGraph.lean\">this demo</a> we set force parameters dynamically, based on node sizes.</p>",
        "id": 544656411,
        "sender_full_name": "ğš ğš˜ğš“ğšŒğš’ğšğšŒğš‘ ğš—ğšŠğš ğš›ğš˜ğšŒğš”ğš’",
        "timestamp": 1760415903
    },
    {
        "content": "<p>i endedup just using d3 tree <a href=\"https://github.com/FrederickPu/ProofWidgetExperiments/blob/gametree/widget/src/gametree.tsx\">https://github.com/FrederickPu/ProofWidgetExperiments/blob/gametree/widget/src/gametree.tsx</a></p>",
        "id": 544754409,
        "sender_full_name": "Frederick Pu",
        "timestamp": 1760449739
    },
    {
        "content": "<p>im still having some issues displaying the proof search metadata for the bottom nodes tho, it seems like they're getting clipped</p>",
        "id": 544754533,
        "sender_full_name": "Frederick Pu",
        "timestamp": 1760449761
    }
]