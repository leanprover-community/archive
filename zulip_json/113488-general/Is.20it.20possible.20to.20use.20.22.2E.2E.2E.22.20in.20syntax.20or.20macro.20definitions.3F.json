[
    {
        "content": "<p>I would like to support numpy-esque syntax like <code>arr[i, j, ...]</code>. so far i have not managed to find a way to do this in lean4. is it possible or is this just a locked down symbol?</p>\n<p><a href=\"https://live.lean-lang.org/#codez=LTAEEEBdIUwWwA6VARgFygKoGcCWA7Ac1ADozQDQBDUPRAGxlDioGMAnAe1AHddIAFqHYxCAV3pV2oAEbs2AaxiRsAKBYdOaFgA9QAIljZI+gwG1TBACa5WMbGljs4AGgDUBl6f1kS3gLqmGE5woAC8AHyqoKAABgAUZgAk1rb2LgBU/gCUqqogoAAq7ACeoJDcYthM/GiqAMSsAjCsCuX2kGYoLqAATD2+/vlgAKLsXOwYYvgwOggtsFblnEr4oADkvusA3KCz86yL7c55BVCwiMi9GDgExL68/ELTtpxWTHKKymoaXNpUekMHV63kAZ+SWfA2OwOELuTzeXzeQDn5EFjqFItE4okUpC0thMjlTmBimUKqAqjVIHVGs1Wu1jL1Qd0+gMyEjhqAxhMpjM5gsYEsKqsNltdvt+YKYCcOed4EhQABmDAAERaknYd1I5Co2GooFYVQqoWwJXwkABqhNZoBBkRoGCUrgeV+Wl0BiMkAV3gsFFx0Mcjrh+i8trIAVRIXCURiCWSqWhBNyHJJy3J1QoVIaTRabQ9Cq6rJIQwKXM4k1okFw9HooAAZlQq7qwNNxYcBcthet/Ds9ny20t1i51qogA\">MWE</a></p>",
        "id": 544611352,
        "sender_full_name": "samuela",
        "timestamp": 1760383897
    },
    {
        "content": "<p>we definitely have something like that for range</p>",
        "id": 544611638,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760384088
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110064\">@Kenny Lau</span> Interesting, perhaps I'm missing something in my usage? What would the range thing look like?</p>",
        "id": 544612069,
        "sender_full_name": "samuela",
        "timestamp": 1760384316
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"378466\">@samuela</span> i removed some spaces and it seem to work better:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">macro</span><span class=\"o\">:</span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"s2\">\"test\"</span><span class=\"w\"> </span><span class=\"s2\">\"[\"</span><span class=\"w\"> </span><span class=\"n\">indices</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"o\">,</span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"s2\">\",...]\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">  </span><span class=\"bp\">`</span><span class=\"o\">([</span><span class=\"bp\">$</span><span class=\"n\">indices</span><span class=\"o\">,</span><span class=\"bp\">*</span><span class=\"o\">])</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"bp\">...</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 544613839,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760385341
    },
    {
        "content": "<p>btw next time instead of posting a link it would be better to post the code in <a href=\"https://github.com/leanprover-community/mathlib/wiki/Code-in-backticks\">#backticks</a></p>",
        "id": 544613870,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760385358
    },
    {
        "content": "<p>it automatically generates a link on the top right corner of the box</p>",
        "id": 544613893,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760385369
    },
    {
        "content": "<p>ok figured this out:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Singleton</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Ellipsis</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">OfNat</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">ofNat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">SliceTerm</span><span class=\"bp\">.</span><span class=\"n\">Singleton</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"...\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span>\n<span class=\"kn\">macro_rules</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"bp\">...</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">SliceTerm</span><span class=\"bp\">.</span><span class=\"n\">Ellipsis</span><span class=\"o\">)</span>\n\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"test[\"</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"o\">,</span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"s2\">\"]\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span>\n<span class=\"kn\">macro_rules</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"bp\">$</span><span class=\"n\">indices</span><span class=\"o\">,</span><span class=\"bp\">*</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">([</span><span class=\"bp\">$</span><span class=\"n\">indices</span><span class=\"o\">,</span><span class=\"bp\">*</span><span class=\"o\">])</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>which i'm happy with now</p>",
        "id": 544631072,
        "sender_full_name": "samuela",
        "timestamp": 1760395766
    },
    {
        "content": "<p>actually this allows for <code>arr[1, ..., 2, ..., 3]</code> which i would like to avoid. it'd be nice to be able to write something to the effect of </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"test[\"</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"o\">,</span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"s2\">\"...\"</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"o\">,</span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"s2\">\"]\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span>\n</code></pre></div>\n<p>would something like that possible? eg could one match on a specific type of <code>term</code>, esp non-\"...\" terms?</p>",
        "id": 544631431,
        "sender_full_name": "samuela",
        "timestamp": 1760396138
    },
    {
        "content": "<p>If rejecting some syntax combinations during parsing is too hard, you can always do it in the macro/elaborator. That usually leads to better error messages anyway, e.g. \"Cannot combine multiple <code>...</code> in the same indexing operation\"</p>",
        "id": 544679832,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1760427804
    },
    {
        "content": "<p>Ah ok, thanks <span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span> ! I didn't realize you could handle that in elaboration</p>",
        "id": 544856866,
        "sender_full_name": "samuela",
        "timestamp": 1760488330
    }
]