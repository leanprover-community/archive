[
    {
        "content": "<p>Under <a href=\"https://hrmacbeth.github.io/math2001/02_Proofs_with_Structure.html#id4\">2.1.4 Example</a>, it says:</p>\n<blockquote>\n<p>You can only cancel a common factor from both sides of an equation if that common factor is known to be nonzero.</p>\n</blockquote>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- `cancel` works as expected here.</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">cancel</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hp</span>\n</code></pre></div>\n<p>Surprisingly, <code>cancel</code> also works in the following cases:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- `cancel` also works in the following two cases, perhaps a little surprisingly.</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">cancel</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hp</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">cancel</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">hp</span>\n</code></pre></div>\n<p>My understanding is that if <code>q = 0</code>,    then <code>hp : 0 &lt; p * q</code> becomes false, so the conclusion <code>p &gt; 0</code> would hold vacuously. However, this seems to contradict the original claim that<code>cancel</code> can only be used if the common factor is known to be <em>non-zero</em>.</p>\n<p>Furthermore, it seems some subsequent exercises (such as <a href=\"https://hrmacbeth.github.io/math2001/02_Proofs_with_Structure.html#id38\">Exercise 2.5.9.6</a>) rely on this behavior for the proof to work.  (Or perhaps I am missing some other tactics?)</p>\n<p>Another peculiarity is that <code>cancel</code> doesn't seem to work if the common factor is <em>negative</em>—in fact, it won't even compile.</p>\n<p>If that's correct, perhaps the claim should be revised to something like</p>\n<blockquote>\n<p>You can only cancel a common factor from both sides of an equation if that common factor is known to be greater than or equal to zero.</p>\n</blockquote>\n<p>Or perhaps this is an unintended behavior (a bug) in the tactic?</p>\n<p>Thoughts?</p>",
        "id": 527320439,
        "sender_full_name": "Hanson Char",
        "timestamp": 1751774403
    },
    {
        "content": "<p>I think I figured this out. The examples above are inequalities, i.e, they are not <em>equations</em> and therefore the claim above doesn't apply.</p>\n<p>In the case of inequalities, under <a href=\"https://hrmacbeth.github.io/math2001/02_Proofs_with_Structure.html#id5\">2.1.5 Example</a>:</p>\n<blockquote>\n<p>Notice that Lean is silently checking the condition for this to be valid (that <code>a ≥ 0</code>). Check that if you delete the hypothesis <code>h2 : a ≥ 0</code> then the cancellation step fails in Lean.</p>\n</blockquote>\n<p>which suggests the existing behavior is indeed the expected behavior.</p>\n<p>I wish there was better documentation on these custom tactics.</p>",
        "id": 527321172,
        "sender_full_name": "Hanson Char",
        "timestamp": 1751775440
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"711412\">Hanson Char</span> has marked this topic as resolved.</p>",
        "id": 527321175,
        "sender_full_name": "Notification Bot",
        "timestamp": 1751775450
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"711412\">@Hanson Char</span> I think you're misinterpreting the quote. The full quote is:</p>\n<blockquote>\n<p>There is a mathematical subtlety here. You can only cancel a common factor from both sides of an equation if that common factor is known to be nonzero. In this problem, Lean can deduce that the common factor, <code>t</code>, is nonzero. Why?</p>\n</blockquote>\n<p>If you read this correctly, the \"cancelling nonzero\" thing is talking about maths, and it's pretty clear from this paragraph that the tactic <code>cancel</code> itself tries to generate a nonzero hypothesis.</p>",
        "id": 527338353,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1751797724
    }
]