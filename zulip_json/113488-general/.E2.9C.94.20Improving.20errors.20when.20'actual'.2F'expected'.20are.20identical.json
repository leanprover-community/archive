[
    {
        "content": "<p>Under some circumstances, lean4 can give an error messages where the types in 'has type' and '<code>but is expected to have type</code>' are identical (e.g. <a href=\"#narrow/channel/270676-lean4/topic/.E2.9C.94.20type.20mismatch.20with.20identical.20types.20-.20no.20pattern.20matching\">https://leanprover.zulipchat.com/#narrow/channel/270676-lean4/topic/.E2.9C.94.20type.20mismatch.20with.20identical.20types.20-.20no.20pattern.20matching</a>)</p>\n<p>It's possible to manually work around this by turning off various pretty-printing settings to uncover the actual mismatch, but this is very tedious and time-consuming. My idea is for lean to do something like:</p>\n<ol>\n<li>Produce the rendered error message as normal</li>\n<li>Checked if the rendered 'actual' and 'expected' strings are identical. If so, turn off a pretty-printing setting (going through some predefined list of settings in a 'reasonable' order), and go back to step 1.</li>\n</ol>\n<p>This would terminate when the expressions are different (which in the worse case, would be the very verbose <code>pp.all true</code> output).</p>\n<p>Would this make sense as part of lean itself, or would it be better to implement this in vscode/neovim by repeatedly querying the language server?</p>",
        "id": 483109007,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1731958935
    },
    {
        "content": "<p>This was discussed several time, but I don’t think anything was really started.</p>",
        "id": 483110034,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1731959350
    },
    {
        "content": "<p>There are features to uncover differences in place -- do you have examples where it's not working? We can use that to improve the algorithm.</p>",
        "id": 483110105,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731959386
    },
    {
        "content": "<p>Make sure you're using Lean 4.14 (you can check with the <code>#version</code> command; if you don't have <code>#version</code>, then you're using a version definitely older than 4.14)</p>",
        "id": 483110501,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731959525
    },
    {
        "content": "<p>(The algorithm won't ever be perfect, so having a backup feature that could force a difference like you're describing could still be helpful!)</p>",
        "id": 483111076,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731959741
    },
    {
        "content": "<p>I'm currently using <code>Lean version 4.13.0-rc3</code> - let me see if I can get a reasonably minimized form of my issue</p>",
        "id": 483111862,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1731960004
    },
    {
        "content": "<p>The error message you're getting is fine, no need to minimize</p>",
        "id": 483112457,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731960190
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span>\n<span class=\"w\">  </span><span class=\"n\">second_eq</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"bp\">∑</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">digits</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">enum</span><span class=\"bp\">.</span><span class=\"n\">toFinset</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">count</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">digits</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">enum</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">uncurry</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"bp\">∑</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">digits</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">enum</span><span class=\"bp\">.</span><span class=\"n\">toFinset</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">count</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">digits</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">enum</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">uncurry</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n</code></pre></div>",
        "id": 483113918,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1731960665
    },
    {
        "content": "<p>in this case, the error is due to List.count</p>",
        "id": 483113976,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1731960691
    },
    {
        "content": "<p>in the infoview, the first term is <code>@List.count (ℕ × ℕ) instBEqOfDecidableEq m (Nat.digits 2 k).enum : ℕ</code><br>\nthe second term is                           <code>@List.count (ℕ × ℕ) instBEqProd m (Nat.digits 2 k).enum : ℕ</code></p>",
        "id": 483114101,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1731960724
    },
    {
        "content": "<p>when I first hit this, it was actually in the context of an <code>rw</code> failing to apply. I had to refactor things to in order to force a 'type mismatch' error, apply <code>set_option pp.all true</code>, and diff the output to discover the <code>instBEqOfDecidableEq</code> vs <code>instBEqProd</code> issue</p>",
        "id": 483114445,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1731960849
    },
    {
        "content": "<p>I expect this to show a difference in 4.14</p>",
        "id": 483115137,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731961108
    },
    {
        "content": "<p>If it's not a lot of work, would you mind testing it?</p>",
        "id": 483115203,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731961140
    },
    {
        "content": "<p><code>leanprover/lean4:v4.14.0-rc2</code>?</p>",
        "id": 483115326,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1731961186
    },
    {
        "content": "<p>Yeah</p>",
        "id": 483115404,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731961203
    },
    {
        "content": "<p>The problem pre-4.14 was that the difference-annotator wasn't navigating into lambda functions, which is necessary for summation notation to get differences annotated in their bodies</p>",
        "id": 483115598,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731961266
    },
    {
        "content": "<p>unfortunately, I can't easily test at the moment - this is part of a larger project, and updating my local toolchain causes a flood of errors from mathlib and other deps</p>",
        "id": 483115828,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1731961350
    },
    {
        "content": "<p>I'll see if I can extract out the relevant code - the actual thing that produced the error is pretty self-contained, fortunately</p>",
        "id": 483115888,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1731961371
    },
    {
        "content": "<p>Maybe you could check on a local branch?</p>",
        "id": 483116948,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1731961734
    },
    {
        "content": "<p>I managed to minimize it, and it does produce a nice error on lean 14: <a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQP0CmIIScAZhBHABQDWAXHIKiEAlIwCpQCuBc9AvHCwBPHHDiokAN14BnAgGMIAOwAmAfQIBHRtQAywWTAB0JMAElVADxpkuyuMDilAZYTO4AKjgAmOAD1HFhoAORRjVWAAc2AYWR84WhYWY1kuEDhBAAY+QRE4WWgoUXEoAHc4AG0DI1MkC2tNLU1lNPUzABo4ADFgZXkTVJB1TCM2uvUlexgAXWd4eSU1RrEJaV4yYChR7T4aQEQiOHTACCIQsIjo2PjE4wIWkGMYCB6+ghhO6pNJ5Xh06lCTc4xOK+a63NJwQBEBN17AoYMAVMYYVwoEVbPZHO43KQvL4AsAgiAglkcvlFCoNNoVjAoMApMAkOggA\">https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQP0CmIIScAZhBHABQDWAXHIKiEAlIwCpQCuBc9AvHCwBPHHDiokAN14BnAgGMIAOwAmAfQIBHRtQAywWTAB0JMAElVADxpkuyuMDilAZYTO4AKjgAmOAD1HFhoAORRjVWAAc2AYWR84WhYWY1kuEDhBAAY+QRE4WWgoUXEoAHc4AG0DI1MkC2tNLU1lNPUzABo4ADFgZXkTVJB1TCM2uvUlexgAXWd4eSU1RrEJaV4yYChR7T4aQEQiOHTACCIQsIjo2PjE4wIWkGMYCB6+ghhO6pNJ5Xh06lCTc4xOK+a63NJwQBEBN17AoYMAVMYYVwoEVbPZHO43KQvL4AsAgiAglkcvlFCoNNoVjAoMApMAkOggA</a></p>",
        "id": 483117574,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1731961929
    },
    {
        "content": "<p>By the way, this <code>instBEqOfDecidableEq</code> vs <code>instBEqProd</code> problem is very annoying. I made some extensions to <code>convert</code> to try to help with this in particular, though it still seems hit or miss. The <code>subsingleton</code> tactic, when applied to an equality between BEq instances, tries to synthesize LawfulBEq instances to prove  that they're equal.</p>",
        "id": 483117581,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731961931
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span>\n<span class=\"w\">  </span><span class=\"n\">second_eq</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"bp\">∑</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">digits</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">enum</span><span class=\"bp\">.</span><span class=\"n\">toFinset</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"bp\">@</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">count</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">instBEqOfDecidableEq</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">digits</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">enum</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">uncurry</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"bp\">∑</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">digits</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">enum</span><span class=\"bp\">.</span><span class=\"n\">toFinset</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"bp\">@</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">count</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">instBEqProd</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">digits</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">enum</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">uncurry</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n</code></pre></div>",
        "id": 483117640,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1731961952
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"753178\">Aaron Hill</span> has marked this topic as resolved.</p>",
        "id": 483117728,
        "sender_full_name": "Notification Bot",
        "timestamp": 1731961978
    },
    {
        "content": "<p>Thanks for testing!</p>",
        "id": 483117774,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731961995
    },
    {
        "content": "<p><code>convert</code> does reduce the problem to <code>⊢ instBEqProd = instBEqOfDecidableEq</code>, but sadly it can't prove it, and <code>subsingleton</code> fails to prove it too <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span></p>",
        "id": 483117851,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731962022
    },
    {
        "content": "<p>Ah, there's a missing instance?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">first_eq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∑</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">digits</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">enum</span><span class=\"bp\">.</span><span class=\"n\">toFinset</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">count</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">digits</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">enum</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">uncurry</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">second_eq</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">lawful_beq_subsingleton</span>\n<span class=\"w\">    </span><span class=\"c\">/-</span>\n<span class=\"cm\">    failed to synthesize</span>\n<span class=\"cm\">      LawfulBEq (ℕ × ℕ)</span>\n<span class=\"cm\">    -/</span>\n</code></pre></div>",
        "id": 483118113,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731962106
    },
    {
        "content": "<p>Though it could also be because the instances here are likely very tricky — diamonds break the assumption that instances are canonical, so all the instances are probably there, but just not applying.</p>",
        "id": 483118680,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731962300
    },
    {
        "content": "<p>a little off-topic - has there been any discussion about making 'rw' give a more detailed error message when the terms 'almost' match?</p>",
        "id": 483118687,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1731962302
    },
    {
        "content": "<p>I've thought a bit about a motive diagnostic message, but no, I think most discussions have been about getting rw to be better at rewriting.</p>",
        "id": 483118862,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731962368
    },
    {
        "content": "<p>in this example, my original code was more like <code>rw [first_eq] at second_eq</code>- in order to see the nicer error message on 0.14, I would have needed to do a more extensive refactor to get it into the form of an 'apply mismatch' error</p>",
        "id": 483119057,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1731962434
    },
    {
        "content": "<p>I guess it could at least say \"motive not type correct\" and then print the type error. Right now it just consumes the error.</p>",
        "id": 483119066,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731962436
    },
    {
        "content": "<p>I'm not sure the message would be very nice here, but it's probably better than nothing</p>",
        "id": 483119268,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731962509
    },
    {
        "content": "<p>Reframing, there's also the underlying problem that there's a diamond in the BEq instances — this really ought to be fixed one day!</p>",
        "id": 483119444,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731962560
    },
    {
        "content": "<p>one day: <a href=\"https://github.com/leanprover/lean4/pull/2038\">lean#2038</a></p>",
        "id": 483119632,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1731962633
    },
    {
        "content": "<p>if there's just one \"close\" mismatch, I would personally find a more detailed 'rw' message to be very helpful.</p>",
        "id": 483120129,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1731962795
    },
    {
        "content": "<p>and/or a 'diff these two terms' mode in vscode</p>",
        "id": 483120206,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1731962827
    },
    {
        "content": "<p>(<span class=\"user-mention\" data-user-id=\"753178\">@Aaron Hill</span> Just wanted to mention that I incorporated your error message idea into <a href=\"https://github.com/leanprover/lean4/pull/6168\">lean4#6168</a>)</p>",
        "id": 484092655,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1732392782
    }
]