[
    {
        "content": "<p>Consider the following example:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">try</span><span class=\"w\"> </span><span class=\"n\">repeat</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">mul_one</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>I expect this to do nothing since the <code>repeat</code> tactic will exceed maximum recursion depth and <code>try</code> is supposed to turn failures into no-ops.  However, what I get is an error message.  Is this exception somehow uncatchable?  How should we catch it programmatically?</p>",
        "id": 499897959,
        "sender_full_name": "Tony Beta Lambda",
        "timestamp": 1739610915
    },
    {
        "content": "<p>it's not uncatchable, but it's not caught by the default try-catch blocks used by <code>try</code> et al</p>",
        "id": 499917774,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1739629174
    },
    {
        "content": "<p>it is in a special category of resource exhaustion errors which are presumed not to be useful to catch without violating the purpose of the exception - if you want a computation to stop externally because it's been canceled then catching that is not helpful</p>",
        "id": 499917895,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1739629261
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/channel/239415-metaprogramming-.2F-tactics/topic/.22maximum.20recursion.20depth.20has.20been.20reached.22.20not.20catchable.3F/near/499917774\">said</a>:</p>\n<blockquote>\n<p>it's not uncatchable, but it's not caught by the default try-catch blocks used by <code>try</code> et al</p>\n</blockquote>\n<p>How do I catch them then?  It can be useful when implementing a search tactic that wants to backtrack when encountering any kind of error.</p>",
        "id": 499920904,
        "sender_full_name": "Tony Beta Lambda",
        "timestamp": 1739631655
    },
    {
        "content": "<p>There is a special function that is capable of catching them</p>",
        "id": 499924551,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1739634270
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Core.tryCatchRuntimeEx#doc\">docs#Lean.Core.tryCatchRuntimeEx</a></p>",
        "id": 499924567,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1739634290
    },
    {
        "content": "<p>Catching these things if you know what you're doing is fine, but having every <code>try catch</code> catch them can cause undesirable effects like:</p>\n<ul>\n<li>Resource limits being enforced by the OS instead, making your entire system die without diagnostics</li>\n<li>Programs becoming nondeterministic, depending on the resource constraints of the system</li>\n</ul>",
        "id": 499924710,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1739634385
    },
    {
        "content": "<p>Thanks!  I will use it with caution.</p>",
        "id": 499931579,
        "sender_full_name": "Tony Beta Lambda",
        "timestamp": 1739639528
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"652127\">Tony Beta Lambda</span> has marked this topic as resolved.</p>",
        "id": 500117808,
        "sender_full_name": "Notification Bot",
        "timestamp": 1739782083
    }
]