[
    {
        "content": "<p>I noticed that when we use <code>constructor</code> for an existential proposition like <code>∃ x : A, P x</code>, it creates two goals: the first is <code>⊢ P ?w</code> and the second is <code>⊢ A</code>. My question is, why does it put <code>⊢ P ?w</code> as the first goal? In the code of <code>constructor</code>, its config is set to <code>nonDependentFirst</code>, but it seems to be the opposite. Am I misunderstanding something?</p>",
        "id": 528643497,
        "sender_full_name": "Yiming Fu",
        "timestamp": 1752493945
    },
    {
        "content": "<p>I believe the terminology is the opposite of what you're expecting. A goal is \"nondependent\" if no other goal depends on it, which is the case for <code>P ?w</code> but not for <code>A</code> (which is <code>?w</code>).</p>",
        "id": 528648611,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1752495457
    },
    {
        "content": "<p>But <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Meta.ApplyNewGoals#doc\">docs#Lean.Meta.ApplyNewGoals</a> states:<br>\n'nonDependentFirst' : metavariables that don't depend on other goals appear first in the goal list.</p>",
        "id": 528651825,
        "sender_full_name": "Yiming Fu",
        "timestamp": 1752496435
    },
    {
        "content": "<p>I hope I'm not confused, but I believe the docstring is incorrect. <a href=\"https://github.com/leanprover/lean4/blob/7c3ca70e29a0806bd4bfc62eae7084bbaf1a303d/src/Lean/Meta/Tactic/Apply.lean#L130\">Here's the relevant code</a>, where the (also misnamed?) <code>dependsOnOthers</code> checks whether the current mvar occurs in another mvar; i.e., whether another mvar depends on the current mvar. If so, the current mvar is classified as \"dependent\".</p>",
        "id": 528653990,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1752497222
    },
    {
        "content": "<p>Thanks for your explanation! I agree – it seems that the docstring is indeed incorrect. Either way, I think it makes sense for the <code>constructor</code> tactic to prioritize goals that don't depend on other goals, since that ordering is usually more convenient when using the tactic.</p>",
        "id": 528695795,
        "sender_full_name": "Yiming Fu",
        "timestamp": 1752509372
    },
    {
        "content": "<p>Yeah, this is generally the 'correct' ordering. The Lean devs would probably be happy about a PR with doc improvements.</p>",
        "id": 528703524,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1752511933
    },
    {
        "content": "<p>Okay, I just open an issue <a href=\"https://github.com/leanprover/lean4/issues/9376\">https://github.com/leanprover/lean4/issues/9376</a></p>",
        "id": 528824043,
        "sender_full_name": "Yiming Fu",
        "timestamp": 1752574153
    }
]