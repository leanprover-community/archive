[
    {
        "content": "<p>I am expecting that <code>sum</code> and <code>sum_</code> should match with <code>iaggr_sum</code>, but it does not, and I do not understand why.<br>\nInstead of such syntax, I can add <code>sum_</code> <code>Sum_</code> <code>SUM_</code> ... symbols too, but I want to write short code</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n\n<span class=\"n\">declare_syntax_cat</span><span class=\"w\"> </span><span class=\"n\">iaggr_sum</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">iaggr_sum</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"s2\">\"sum\"</span><span class=\"w\"> </span><span class=\"bp\">&lt;|&gt;</span><span class=\"w\"> </span><span class=\"s2\">\"Sum\"</span><span class=\"w\"> </span><span class=\"bp\">&lt;|&gt;</span><span class=\"w\"> </span><span class=\"s2\">\"SUM\"</span>\n<span class=\"w\">       </span><span class=\"bp\">&lt;|&gt;</span><span class=\"w\"> </span><span class=\"s2\">\"summation\"</span><span class=\"w\"> </span><span class=\"bp\">&lt;|&gt;</span><span class=\"w\"> </span><span class=\"s2\">\"Summation\"</span><span class=\"w\"> </span><span class=\"bp\">&lt;|&gt;</span><span class=\"w\"> </span><span class=\"s2\">\"SUMMATION\"</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">noWs</span><span class=\"w\"> </span><span class=\"s2\">\"_\"</span><span class=\"o\">)</span><span class=\"bp\">?</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">iaggr_sum</span>\n\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"test(\"</span><span class=\"w\"> </span><span class=\"n\">iaggr_sum</span><span class=\"w\"> </span><span class=\"s2\">\")\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span>\n\n<span class=\"kn\">elab</span><span class=\"w\"> </span><span class=\"s2\">\"test(\"</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">:</span><span class=\"n\">iaggr_sum</span><span class=\"w\"> </span><span class=\"s2\">\")\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">mkStrLit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">toString</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">sum</span><span class=\"w\"> </span><span class=\"o\">)</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">sum_</span><span class=\"w\"> </span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 534450883,
        "sender_full_name": "nnarek",
        "timestamp": 1755167265
    },
    {
        "content": "<p><code>sum_</code> is a valid identifier</p>",
        "id": 534457625,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755170077
    },
    {
        "content": "<p>sorry, not sure that I correctly understood you. Do you mean that <code>sum_</code> gets parsed as <code>ident</code>?<br>\ncan you please explain why <code>sum_</code> does not match with syntax of <code>iaggr_sum</code> and what I can do to fix it</p>",
        "id": 534460282,
        "sender_full_name": "nnarek",
        "timestamp": 1755171111
    },
    {
        "content": "<p><code>sum_</code> gets parsed as an <code>ident</code></p>",
        "id": 534460530,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755171224
    },
    {
        "content": "<p>I don't think you can \"fix\" it</p>",
        "id": 534460645,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755171236
    },
    {
        "content": "<p>But it does not explain why <code>sum</code> is not parsed via parser of <code>ident</code>. Are there any doc that explain how parsers are picked and how they are prioritized against each other?</p>",
        "id": 534471125,
        "sender_full_name": "nnarek",
        "timestamp": 1755173981
    },
    {
        "content": "<p><code>sum</code> is a token, so it is invalid as an <code>ident</code></p>",
        "id": 534471696,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755174196
    },
    {
        "content": "<p>Thank you</p>",
        "id": 534472174,
        "sender_full_name": "nnarek",
        "timestamp": 1755174363
    }
]