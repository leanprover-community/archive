[
    {
        "content": "<p>What causes the extra spacing in this example?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">elabTerm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">term</span><span class=\"bp\">|Œª</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">none</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">stx</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">PrettyPrinter</span><span class=\"bp\">.</span><span class=\"n\">delab</span><span class=\"w\"> </span><span class=\"n\">z</span>\n<span class=\"w\">  </span><span class=\"n\">logInfo</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"{stx.raw.prettyPrint}\"</span>\n</code></pre></div>\n<p>which shows</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\">  </span><span class=\"n\">x</span><span class=\"w\">  </span><span class=\"bp\">=&gt;</span><span class=\"w\">  </span><span class=\"n\">x</span><span class=\"w\">   </span><span class=\"bp\">+</span><span class=\"w\">   </span><span class=\"mi\">1</span>\n</code></pre></div>",
        "id": 530038870,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1753163765
    },
    {
        "content": "<p><code>Syntax.prettyPrint</code> just prints the raw text contained in <code>stx</code>, including all trailing whitespace which might've been caused by certain syntax quotations in the delaborator containing them. You probably want <code>‚Üê PrettyPrinter.formatTerm stx</code> instead.</p>",
        "id": 530084299,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1753169434
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"873547\">Robin Arnez</span> <a href=\"#narrow/channel/239415-metaprogramming-.2F-tactics/topic/Extra.20spaces.20in.20prettyprinted.20term/near/530084299\">said</a>:</p>\n<blockquote>\n<p><code>Syntax.prettyPrint</code> just prints the raw text contained in <code>stx</code>, including all trailing whitespace which might've been caused by certain syntax quotations in the delaborator containing them. You probably want <code>‚Üê PrettyPrinter.formatTerm stx</code> instead.</p>\n</blockquote>\n<p>sometimes <code>PrettyPrinter.format</code> functions throw \"format: uncaught backtrack exception\". Is there a way to diagnose it?</p>",
        "id": 530176576,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1753199608
    },
    {
        "content": "<p><a class=\"message-link\" href=\"/#narrow/channel/270676-lean4/topic/format.3A.20uncaught.20backtrack.20exception/near/429966964\">#lean4 &gt; format: uncaught backtrack exception @ üí¨</a></p>",
        "id": 530177401,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1753199844
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/239415-metaprogramming-.2F-tactics/topic/Extra.20spaces.20in.20prettyprinted.20term/near/530177401\">said</a>:</p>\n<blockquote>\n<p><a class=\"message-link\" href=\"/#narrow/channel/270676-lean4/topic/format.3A.20uncaught.20backtrack.20exception/near/429966964\">#lean4 &gt; format: uncaught backtrack exception @ üí¨</a></p>\n</blockquote>\n<p>In this case I'm not using custom syntax, but I figured it out and it was because of malformed objects going into the prettyprinter.</p>",
        "id": 530434922,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1753305552
    },
    {
        "content": "<p>The issue there is about a syntax defined in mathlib, minimized to not mention it</p>",
        "id": 530436665,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1753306153
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/239415-metaprogramming-.2F-tactics/topic/Extra.20spaces.20in.20prettyprinted.20term/near/530436665\">said</a>:</p>\n<blockquote>\n<p>The issue there is about a syntax defined in mathlib, minimized to not mention it</p>\n</blockquote>\n<p>Ah I see, there doesn't seem to be a conclusive solution</p>",
        "id": 530437440,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1753306522
    }
]