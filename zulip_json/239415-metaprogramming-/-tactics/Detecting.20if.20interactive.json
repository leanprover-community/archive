[
    {
        "content": "<p>Is there a way to reliably detect whether the meta program is interactive (i.e., in the IDE)?</p>\n<p>I have a pre-caching task for an interactive tactic that I could launch in <a href=\"https://github.com/leanprover/lean4/blob/c474dff38c401723226277240cd3baec0437de15/src/Lean/Environment.lean#L435\"><code>PersistentEnvExtension.addImportedFn</code></a>, but I only want to do that if it's an interactive session since otherwise it would unnecessarily slow down the build.</p>",
        "id": 406684301,
        "sender_full_name": "Joe Hendrix",
        "timestamp": 1702014031
    },
    {
        "content": "<p>in theory that's what <code>(‚Üê getInfoState).enabled</code> is for</p>",
        "id": 406728317,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1702030743
    },
    {
        "content": "<p>but last I heard it is now always enabled because something breaks without it</p>",
        "id": 406728378,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1702030765
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/pull/1146\">https://github.com/leanprover/lean4/pull/1146</a></p>",
        "id": 406729082,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1702031022
    },
    {
        "content": "<p>One thing you could do is to use a <code>Thunk</code> to compute the data only when it is first requested. In a noninteractive build it never will be so it's a perf win</p>",
        "id": 406730528,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1702031530
    },
    {
        "content": "<p>This trick was recently used in <a href=\"https://github.com/leanprover-community/mathlib4/pull/8199\">#8199</a></p>",
        "id": 406730610,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1702031563
    },
    {
        "content": "<p>Thanks.  I was hoping to use this to experiment with starting cache initialization prior to needing the tactic, but that also means every interactive session would have work that isn't needed.<br>\nI'm going to see if I can further speed things up prior to exploring this further.</p>",
        "id": 407288821,
        "sender_full_name": "Joe Hendrix",
        "timestamp": 1702316097
    }
]