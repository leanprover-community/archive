[
    {
        "content": "<p>Hi, I'm trying to traverse an application (<code>Expr</code>) and apply a cast operator on each argument but I'm a bit confused with some results. This is in Lean 4 (not sure if this stream is for Lean 3 or 4).</p>\n<p>I was trying <code>Expr.traverseAppWithPos</code> to traverse the application, but without applying the function to the first position and so I thought I could simply do something like the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">foobar</span> <span class=\"o\">(</span><span class=\"n\">pos</span> <span class=\"o\">:</span> <span class=\"n\">SubExpr.Pos</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">e</span> <span class=\"o\">:</span> <span class=\"n\">Expr</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">TermElabM</span> <span class=\"n\">Expr</span> <span class=\"o\">:=</span>\n  <span class=\"k\">match</span> <span class=\"n\">SubExpr.Pos.asNat</span> <span class=\"n\">pos</span> <span class=\"k\">with</span>\n  <span class=\"bp\">|</span> <span class=\"mi\">0</span> <span class=\"bp\">=&gt;</span> <span class=\"c1\">-- ignore</span>\n  <span class=\"bp\">|</span> <span class=\"n\">_</span> <span class=\"bp\">=&gt;</span> <span class=\"c1\">-- do something else</span>\n</code></pre></div>\n<p>But somehow when applying <code>Pos.asNat</code> I'm getting indices like 4, 5, 16, etc. And I'm a bit confused why? <br>\nFor instance, using <code>dbg_trace</code> I get:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">dbg_trace</span> <span class=\"n\">pos</span> <span class=\"c1\">-- /0</span>\n<span class=\"n\">dbg_trace</span> <span class=\"o\">(</span><span class=\"n\">Pos.asNat</span> <span class=\"n\">pos</span><span class=\"o\">)</span> <span class=\"c1\">-- 4</span>\n</code></pre></div>\n<p>In any case, I'll probably just extract the args with <code>getAppArgs</code> and map it, but I was confused with those results. <br>\n(If there are better ways lmk, please :) )</p>",
        "id": 395577747,
        "sender_full_name": "Tomás Díaz",
        "timestamp": 1696800908
    }
]