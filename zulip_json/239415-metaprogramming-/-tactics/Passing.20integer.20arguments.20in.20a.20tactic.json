[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Term</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Quantum</span><span class=\"bp\">.</span><span class=\"n\">Essential_math_lemmas</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Term</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">Matrix</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Matrix</span>\n\n\n<span class=\"kn\">elab</span><span class=\"w\"> </span><span class=\"s2\">\"tactic_num \"</span><span class=\"w\"> </span><span class=\"s2\">\"(\"</span><span class=\"n\">n1</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"s2\">\",\"</span><span class=\"w\"> </span><span class=\"n\">n2</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"s2\">\") \"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">n1Expr</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">elabTerm</span><span class=\"w\"> </span><span class=\"n\">n1</span><span class=\"w\"> </span><span class=\"n\">none</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">iVal</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">n1Expr</span><span class=\"bp\">.</span><span class=\"n\">rawNatLit?</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"n\">v</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"w\">   </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">throwError</span><span class=\"w\"> </span><span class=\"s2\">\"tactic_num: first argument not a numeric literal {n1Expr}\"</span>\n<span class=\"w\">  </span><span class=\"c1\">-- elaborate second numeral and extract Nat</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">n2Expr</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">elabTerm</span><span class=\"w\"> </span><span class=\"n\">n2</span><span class=\"w\"> </span><span class=\"n\">none</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">jVal</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">n2Expr</span><span class=\"bp\">.</span><span class=\"n\">rawNatLit?</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"n\">v</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"w\">   </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">throwError</span><span class=\"w\"> </span><span class=\"s2\">\"tactic_num: second argument not a numeric literal\"</span>\n<span class=\"w\">  </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"o\">()</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"bp\">+</span><span class=\"mi\">2</span><span class=\"bp\">=</span><span class=\"mi\">3</span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">  </span><span class=\"n\">tactic_num</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"o\">}</span>\n</code></pre></div>\n<p>I want to pass integer arguments in my tactic which I want to get as a natural number. However, I am not able to do so with the rawNatLit?. Is there any other function or any other way I can do this so that I pass in the argument and then I am able to get the value as type \"Option Nat\" from it?</p>",
        "id": 522934740,
        "sender_full_name": "Anirudh Suresh",
        "timestamp": 1749356137
    },
    {
        "content": "<p>Can't you use <code>n1:num</code> directly?  I'm on mobile, so I can't test.</p>",
        "id": 522936174,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1749358230
    },
    {
        "content": "<p>No that isnt working. Even if I used num, I want to get it of type </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Nat</span>\n</code></pre></div>\n<p>to use it later in my tactic</p>",
        "id": 522936474,
        "sender_full_name": "Anirudh Suresh",
        "timestamp": 1749358609
    },
    {
        "content": "<p>Isn't there a <code>getNat</code>/<code>getNumLit</code> or similarly named lemma?</p>",
        "id": 522936536,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1749358712
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.TSyntax.getNat#doc\">docs#Lean.TSyntax.getNat</a>, maybe?</p>",
        "id": 522936817,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1749358893
    },
    {
        "content": "<p>So, something like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">elab</span><span class=\"w\"> </span><span class=\"s2\">\"tactic_num \"</span><span class=\"w\"> </span><span class=\"s2\">\"(\"</span><span class=\"n\">n1</span><span class=\"o\">:</span><span class=\"n\">num</span><span class=\"w\"> </span><span class=\"s2\">\",\"</span><span class=\"w\"> </span><span class=\"n\">n2</span><span class=\"o\">:</span><span class=\"n\">num</span><span class=\"w\"> </span><span class=\"s2\">\") \"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">n1Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">n1</span><span class=\"bp\">.</span><span class=\"n\">getNat</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">n2Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">n2</span><span class=\"bp\">.</span><span class=\"n\">getNat</span>\n<span class=\"w\">  </span><span class=\"n\">logInfo</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\"The first input is {n1Nat}, the second one is {n2Nat}.\"</span>\n</code></pre></div>",
        "id": 522938446,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1749361339
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"883479\">Anirudh Suresh</span> <a href=\"#narrow/channel/239415-metaprogramming-.2F-tactics/topic/Passing.20integer.20arguments.20in.20a.20tactic/near/522934740\">schrieb</a>:</p>\n<blockquote>\n<p>However, I am not able to do so with the rawNatLit?.</p>\n</blockquote>\n<p>If you want to do it with terms, then use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Meta.getNatValue%3F#doc\">docs#Lean.Meta.getNatValue?</a>.</p>",
        "id": 522950405,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1749368552
    },
    {
        "content": "<p>(or <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Meta.getIntValue%3F#doc\">docs#Lean.Meta.getIntValue?</a> below if that's what you want)</p>",
        "id": 522950599,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1749368595
    },
    {
        "content": "<p>You should not be elaborating a term here, if all you want to do is to pass a number</p>",
        "id": 522979321,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1749391596
    }
]