[
    {
        "content": "<p>I wrote some code that takes an implication between two equations, 1. sends it to an automated theorem prover, e.g., prover9, and 2. translates the returned proof into Lean code to prove the original implication.</p>\n<p>This work is based on the <a href=\"https://www.logic.at/gapt/\">gapt system</a>. You can find the code in the <a href=\"https://github.com/gapt/gapt/tree/eqthproject\">eqthproject branch</a> at <a href=\"https://github.com/gapt/gapt/blob/eqthproject/examples/eqthproject/eqthproject.scala\">examples/eqthproject/eqthproject.scala</a>.</p>\n<p>The import from various automated theorem provers into gapt exists since a long time and is quite stable. The system also provides a translation from resolution proofs to sequent calculus proofs. What I implemented now is a rather naive (line-by-line) translation of simple sequent calculus proofs (such as those of the implicaton of one equation by another) to Lean code.</p>\n<p>For example, it automatically generates code like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">eqimpl</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Magma</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"n\">G</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">)):</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"n\">G</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"n\">a2</span><span class=\"w\"> </span><span class=\"n\">a3</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- cut</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"c1\">-- refl</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h0</span><span class=\"w\"> </span><span class=\"c1\">-- c:l</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h3</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a3</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- cut</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h4</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a3</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- cut</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h5</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"c1\">-- ∀:l</span>\n<span class=\"w\">        </span><span class=\"n\">clear</span><span class=\"w\"> </span><span class=\"n\">h2</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h6</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a3</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h5</span><span class=\"w\"> </span><span class=\"c1\">-- ∀:l</span>\n<span class=\"w\">        </span><span class=\"n\">clear</span><span class=\"w\"> </span><span class=\"n\">h5</span>\n<span class=\"w\">        </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h6</span><span class=\"w\"> </span><span class=\"c1\">-- ax</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">nth_rw</span><span class=\"w\">  </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"n\">h4</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"c1\">-- eq:r</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h7</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a3</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"c1\">-- eq:l</span>\n<span class=\"w\">        </span><span class=\"n\">nth_rw</span><span class=\"w\">  </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"n\">h3</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h1</span>\n<span class=\"w\">        </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h1</span>\n<span class=\"w\">      </span><span class=\"n\">clear</span><span class=\"w\"> </span><span class=\"n\">h3</span><span class=\"w\"> </span><span class=\"c1\">-- w:l</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h8</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a2</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- cut</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h9</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a2</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- cut</span>\n<span class=\"w\">        </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h10</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h0</span><span class=\"w\"> </span><span class=\"c1\">-- ∀:l</span>\n<span class=\"w\">          </span><span class=\"n\">clear</span><span class=\"w\"> </span><span class=\"n\">h0</span>\n<span class=\"w\">          </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h11</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a2</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h10</span><span class=\"w\"> </span><span class=\"c1\">-- ∀:l</span>\n<span class=\"w\">          </span><span class=\"n\">clear</span><span class=\"w\"> </span><span class=\"n\">h10</span>\n<span class=\"w\">          </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h11</span><span class=\"w\"> </span><span class=\"c1\">-- ax</span>\n<span class=\"w\">        </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">nth_rw</span><span class=\"w\">  </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"n\">h9</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"c1\">-- eq:r</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h12</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a2</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">a1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a3</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"c1\">-- eq:l</span>\n<span class=\"w\">          </span><span class=\"n\">nth_rw</span><span class=\"w\">  </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"n\">h8</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">          </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h7</span>\n<span class=\"w\">        </span><span class=\"n\">clear</span><span class=\"w\"> </span><span class=\"n\">h8</span><span class=\"w\"> </span><span class=\"c1\">-- w:l</span>\n<span class=\"w\">        </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h12</span><span class=\"w\"> </span><span class=\"c1\">-- ax</span>\n</code></pre></div>\n<p>It also generates code for \"Proposition 1. Equation4 implies Equation7\" from Tao's original blog post. This is approx. 1460 lines of Lean code and I ran intro trouble with Lean recommending to increase maxHeartbeats. Obviously, there is a lot of potential to optimise the code. This is just a first attempt. But I believe that it should be possible to generate Lean proofs for most of the true implications this way.</p>",
        "id": 473481627,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727636074
    },
    {
        "content": "<p>It might scale better to write an elaborator that parses the output of the other took and generate the proof (as an <code>Expr</code>) directly, to avoid the detour through surface syntax. Not a trivial task though, with rewriting etc.</p>",
        "id": 473482360,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727636544
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span> Thanks for the suggestion! However, being a novice Lean user I don't think I could do that in a reasonable time frame.</p>\n<p>I also think there is lots to improve on a purely proof-theoretic level. In principle, it should be possible to automatically transform such proofs into, essentially, rewriting sequences and to export them as such. I would expect this to cut down the number of lines in the Lean code to about 20% of what it is now.</p>\n<p>Also, I am wondering: what is the best use of this code within this project? Do we have a list of equations we conjecture to be true? I had a look at the list of most wanted implications. Picking about a dozen at random, most of them seem to be false. Or should I run it over all implications in the subgraph?</p>",
        "id": 473653057,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727686980
    },
    {
        "content": "<p>Our most-wanted implications are false? Sounds like it’s time we get the counter examples in, and remove that where we already prove a counter-example.</p>",
        "id": 473654687,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727687351
    },
    {
        "content": "<p>For example, Equation5 implies Equation2 is stated in the <a href=\"https://github.com/teorth/equational_theories/blob/main/data/most_wanted.md\">most wanted list</a>. Mace4, when prompted with</p>\n<blockquote>\n<p>assign(max_seconds, 5).</p>\n<p>formulas(sos).</p>\n<p>x = y * x.</p>\n<p>end_of_list.</p>\n<p>formulas(goals).</p>\n<p>x = y.</p>\n<p>end_of_list.</p>\n</blockquote>\n<p>generates the two-element countermodel that satisfies x = y * x.</p>",
        "id": 473658187,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727687991
    },
    {
        "content": "<p>Ok, then I am sure we have that counter-example already in <code>SmallMagmas.lean</code>.</p>\n<p>That smells like a nice task: Write a tool that complains about any entry in the most wanted list that is  already solved either way, and let it run in CI. (Or if this list was created by a script, adjust the script to take new data into account.)</p>",
        "id": 473659646,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727688190
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"741612\">Stefan Hetzl</span> <a href=\"#narrow/stream/458659-Equational/topic/Using.20automated.20theorem.20provers/near/473653057\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> Thanks for the suggestion! However, being a novice Lean user I don't think I could do that in a reasonable time frame.</p>\n<p>I also think there is lots to improve on a purely proof-theoretic level. In principle, it should be possible to automatically transform such proofs into, essentially, rewriting sequences and to export them as such. I would expect this to cut down the number of lines in the Lean code to about 20% of what it is now.</p>\n<p>Also, I am wondering: what is the best use of this code within this project? Do we have a list of equations we conjecture to be true? I had a look at the list of most wanted implications. Picking about a dozen at random, most of them seem to be false. Or should I run it over all implications in the subgraph?</p>\n</blockquote>\n<p>You can generate the list of already proven/disproven conjectures if that's what you're asking. That gets rid of &gt;80% of conjectures at this point. I haven't used the tool to generate 'most wanted' implications though so I'm not sure it's current state.</p>",
        "id": 473945745,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727760450
    },
    {
        "content": "<p>To run an external theorem prover, do all the conversions, and output Lean code I would budget around 1 second per implication. So when I run this on my laptop over night I would estimate that I can deal with around 20.000-30.000 implications. My question is: how can I generate a list of unsolved implications of around this length? </p>\n<p>If I understand you correctly what you suggest would generate a list of length approx. 22M * 0,2 = 4,4M.</p>",
        "id": 473968172,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727767304
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"741612\">Stefan Hetzl</span> <a href=\"#narrow/stream/458659-Equational/topic/Using.20automated.20theorem.20provers/near/473968172\">said</a>:</p>\n<blockquote>\n<p>To run an external theorem prover, do all the conversions, and output Lean code I would budget around 1 second per implication. So when I run this on my laptop over night I would estimate that I can deal with around 20.000-30.000 implications. My question is: how can I generate a list of unsolved implications of around this length? </p>\n<p>If I understand you correctly what you suggest would generate a list of length approx. 22M * 0,2 = 4,4M.</p>\n</blockquote>\n<p>I could share a non-canonical way, but maybe there's a better way now. <span class=\"user-mention\" data-user-id=\"690858\">@Daniel Weber</span> does <a href=\"https://github.com/teorth/equational_theories/pull/126\">#126</a> offer a way to do this? I see <code>lake exe extract_implications</code> now offers a closure option, but what file am I supposed to give it? <code>lake exe extract_implications --closure --json equational_theories/Generated.lean</code> does nothing</p>",
        "id": 473974297,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727768879
    },
    {
        "content": "<p>Actually, I'm no longer sure how to pull out implications with <code>lake exe extract_implications</code> at all.</p>",
        "id": 473975020,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727769106
    },
    {
        "content": "<p>You need to use <code>equational_theories.Generated</code>, not <code>equational_theoties/Generated.lean</code>, and it also has to be after you've already built the files</p>",
        "id": 473978289,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727770056
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"741612\">Stefan Hetzl</span> <a href=\"#narrow/stream/458659-Equational/topic/Using.20automated.20theorem.20provers/near/473968172\">said</a>:</p>\n<blockquote>\n<p>To run an external theorem prover, do all the conversions, and output Lean code I would budget around 1 second per implication. So when I run this on my laptop over night I would estimate that I can deal with around 20.000-30.000 implications. My question is: how can I generate a list of unsolved implications of around this length? </p>\n<p>If I understand you correctly what you suggest would generate a list of length approx. 22M * 0,2 = 4,4M.</p>\n</blockquote>\n<p>Something to note is that as you prove/disprove implications other ones will be proved/disproved by transitivity. I'm not sure about strategies to choose what would be most beneficial to prove/disprove, but I think I could get something working to dynamically update the transitive closure</p>",
        "id": 473979111,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727770323
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"690858\">Daniel Weber</span> <a href=\"#narrow/stream/458659-Equational/topic/Using.20automated.20theorem.20provers/near/473978289\">said</a>:</p>\n<blockquote>\n<p>You need to use <code>equational_theories.Generated</code>, not <code>equational_theoties/Generated.lean</code>, and it also has to be after you've already built the files</p>\n</blockquote>\n<p>Or just pass nothing and it’ll use the top-level <code>equational_theoreis</code> by default, won’t it?</p>",
        "id": 473980497,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727770876
    },
    {
        "content": "<p>It doesn't seem like it. Also seems like the json format of <code>lake exe extract_implications --json equational_theories</code> is different than previously unless I'm supposed to be using a different invocation</p>",
        "id": 473983419,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727771879
    },
    {
        "content": "<p>It doesn't use <code>facts</code>, it's back to the previous <code>nonimplications</code></p>",
        "id": 473983592,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727771941
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"741612\">@Stefan Hetzl</span> Seems like the canonical answer is to run <code>lake exe extract_implications --closure --json equational_theories &gt; /tmp/foo.json</code> and pull out the entries from 'nonimplications'/'implications' keys, and then don't search those</p>",
        "id": 473984457,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727772232
    },
    {
        "content": "<p>I'm away from my usual setup but managed to create the lists using old versions of all scripts.</p>\n<p>These are at<br>\n<a href=\"https://github.com/amirlb/equational_theories/tree/unknown-implications\">https://github.com/amirlb/equational_theories/tree/unknown-implications</a></p>\n<p>The readme says which files exist in results.zip, you need to download and unzip it. The file only_strongest (with 24283 implications) is probably the most interesting for SMT provers</p>",
        "id": 473985921,
        "sender_full_name": "Amir Livne Bar-on",
        "timestamp": 1727772710
    },
    {
        "content": "<p>Since it was cobbled together in a hackish way, it would be useful if somebody can do a quick consistency test, like whether it's a subset of their local list of unknown implications</p>",
        "id": 473988746,
        "sender_full_name": "Amir Livne Bar-on",
        "timestamp": 1727773564
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"302984\">@Amir Livne Bar-on</span> This looks great! Thanks a lot!</p>",
        "id": 473998448,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727776757
    },
    {
        "content": "<p>I have to make some more adaptions to my code. I hope that I can run it on only_strongest tonight.</p>",
        "id": 473999991,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727777225
    },
    {
        "content": "<p>The run finished. I could generate 2491 Lean proofs. For 9586 implications, prover9 did not find a proof. The remaining cases were inconclusive, most of them likely due to the current state of the proof translation not being up to the task.</p>",
        "id": 474211113,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727852476
    },
    {
        "content": "<p>You can find the proofs in the gapt_generated branch of my fork at <a href=\"https://github.com/shetzl/equational_theories/tree/gapt_generated/equational_theories/Generated/Gapt\">equational_theories/Generated/Gapt</a>.</p>\n<p>The file with the lean proofs has a size of around 80MB. Some of the proofs are quite short, say, up to 40 lines which should be ok. Many proofs however are quite long and cannot be parsed by Lean in reasonable time.</p>",
        "id": 474212056,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727852675
    },
    {
        "content": "<p>In order to generate better Lean proofs I will start to look into exporting from resolution proofs directly, instead of going via the sequent calculus. This will require a more specialised algorithm, but the results should be significantly better.</p>",
        "id": 474245587,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727861648
    },
    {
        "content": "<p>On the Lean side, I could use some advice on what the best (most efficient) format for equality inference would be. <span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span>, you have mentioned to generate an an <code>Expr</code> directly. I am not sure I understand what you mean by that (I am a novice Lean user). Could you point me to some documentation and/or examples?</p>",
        "id": 474246224,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727861871
    },
    {
        "content": "<p>You could take a look at <a href=\"https://leanprover-community.github.io/lean4-metaprogramming-book/\">https://leanprover-community.github.io/lean4-metaprogramming-book/</a></p>",
        "id": 474246585,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727861985
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"741612\">@Stefan Hetzl</span> Are you computing their transitive reduction in combination with the base repository? That usually reduces the total number of proofs quite a bit, and may make your job a lot easier if the total number  of necessary proofs is fairly small</p>",
        "id": 474254029,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727864482
    },
    {
        "content": "<p>My problem is not which implications to check. I'll happily let others deal with this question <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span> </p>\n<p>My problem is that the proofs I generate for an individual implication are too long to be parsed by Lean.</p>",
        "id": 474254568,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727864692
    },
    {
        "content": "<p>Well, if reduction reduces the number of proofs by 95%, and that gets rid of the ones that are too long, then that solves your problem</p>",
        "id": 474254839,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727864780
    },
    {
        "content": "<p>On my branch, this is the theorems of yours that are necessary:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"mi\">276</span><span class=\"o\">,</span><span class=\"mi\">25</span>\n<span class=\"mi\">276</span><span class=\"o\">,</span><span class=\"mi\">361</span>\n<span class=\"mi\">276</span><span class=\"o\">,</span><span class=\"mi\">4382</span>\n<span class=\"mi\">292</span><span class=\"o\">,</span><span class=\"mi\">6</span>\n<span class=\"mi\">51</span><span class=\"o\">,</span><span class=\"mi\">9</span>\n<span class=\"mi\">54</span><span class=\"o\">,</span><span class=\"mi\">10</span>\n<span class=\"mi\">54</span><span class=\"o\">,</span><span class=\"mi\">309</span>\n<span class=\"mi\">54</span><span class=\"o\">,</span><span class=\"mi\">4432</span>\n<span class=\"mi\">54</span><span class=\"o\">,</span><span class=\"mi\">631</span>\n<span class=\"mi\">54</span><span class=\"o\">,</span><span class=\"mi\">9</span>\n<span class=\"mi\">57</span><span class=\"o\">,</span><span class=\"mi\">4</span>\n<span class=\"mi\">67</span><span class=\"o\">,</span><span class=\"mi\">89</span>\n<span class=\"mi\">74</span><span class=\"o\">,</span><span class=\"mi\">157</span>\n<span class=\"mi\">74</span><span class=\"o\">,</span><span class=\"mi\">16</span>\n<span class=\"mi\">74</span><span class=\"o\">,</span><span class=\"mi\">3416</span>\n<span class=\"mi\">74</span><span class=\"o\">,</span><span class=\"mi\">703</span>\n<span class=\"mi\">74</span><span class=\"o\">,</span><span class=\"mi\">704</span>\n</code></pre></div>\n<p>Note that I have some additional uncommitted theorems on my branch so it may be overly reducing them compared to what's on main right now</p>",
        "id": 474255395,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727864996
    },
    {
        "content": "<p>Note that this may be as small as it is because more implications were merged overnight that you may not have had when you started your run, so it may just be that there was overlap</p>",
        "id": 474255880,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727865159
    },
    {
        "content": "<p>Hmmm...  I'm not sure I understand: <code>276,25</code>means that I have proved Equation 276 implies Equation 25?</p>",
        "id": 474256030,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727865238
    },
    {
        "content": "<p>Well, I am foolish. I included one wrong path in the invocation and used data that wasn't yours. Re-calculating, sorry for the confusion.</p>",
        "id": 474256668,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727865472
    },
    {
        "content": "<p>ok, this took longer to figure out than expected. This workflow is slightly different and I had gotten to used to automatically doing my steps. 952 new theorems, so it doesn't make your life that much easier</p>",
        "id": 474258981,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727866330
    },
    {
        "content": "<p>Ok. Thanks!</p>",
        "id": 474264901,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727867805
    },
    {
        "content": "<p>I am also wondering if there is something useful I can / should do with these proofs now. Will it be easier for Lean if I split it in individual files? Is there a way to mark them as \"proved by an external program\" and comment out the tactic script? Should I throw away the long proofs and make a PR containing only the short proofs?</p>",
        "id": 474264988,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727867827
    },
    {
        "content": "<p>I plan to rewrite the export code to go from gapt resolution proofs to Lean proof terms directly, thus bypassing the sequent calculus in gapt and the tactics language in Lean. This should scale much better.</p>\n<p>My questions to the Lean experts are: Is what I do in the following code a good way to create proof terms? Will Lean like large nestings of these snippets? In particular, is there a way to avoid explicitely indicating the motive in ex_paramod_cw and ex_paramod_ccw (something like nth_rewrite on the proof term level)? Can I deal with blocks of quantifiers more efficiently than I do currently in ex_flipwithforall and ex_substwithforall?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">ex_substwithforall</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Magma</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">y</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">ex_flipwithforall</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Magma</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">Eq</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">ex_paramod_cw</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Magma</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Eq</span><span class=\"bp\">.</span><span class=\"n\">subst</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"n\">h2</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">ex_paramod_ccw</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Magma</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Eq</span><span class=\"bp\">.</span><span class=\"n\">subst</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Eq</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">h2</span>\n</code></pre></div>",
        "id": 474469974,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727929713
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span> Is that what you had in mind originally?</p>",
        "id": 474474182,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727931221
    },
    {
        "content": "<p>Can you not write the code as a lean metaprogram, i.e. a command or tactic that reads the gapt resolution proof terms?</p>\n<p>But a go program that produces lean expressions is also a good start, and having theorems corresponding to the primitives of that format is reasonable.</p>",
        "id": 474504088,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727939896
    },
    {
        "content": "<p><span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span> How would this be invoked? Something like the following?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Equation2_implies_Equation7</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Magma</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Equation2</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Equation7</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">gapt_import</span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"s2\">\"...some large string describing a resolution proof produced by gapt...\"</span><span class=\"w\"> </span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 474507817,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1727940721
    },
    {
        "content": "<p>I think it would make more sense as a DSL, not a string</p>",
        "id": 474507994,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727940763
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"741612\">Stefan Hetzl</span> <a href=\"#narrow/stream/458659-Equational/topic/Using.20automated.20theorem.20provers/near/474507817\">said</a>:</p>\n<blockquote>\n<p><span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span> How would this be invoked? Something like the following?</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Equation2_implies_Equation7</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Magma</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Equation2</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Equation7</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">gapt_import</span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"s2\">\"...some large string describing a resolution proof produced by gapt...\"</span><span class=\"w\"> </span><span class=\"o\">)</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Exactly. Or it could take a filename if the string is very large.</p>",
        "id": 474618125,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727968742
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"690858\">Daniel Weber</span> <a href=\"#narrow/stream/458659-Equational/topic/Using.20automated.20theorem.20provers/near/474507994\">said</a>:</p>\n<blockquote>\n<p>I think it would make more sense as a DSL, not a string</p>\n</blockquote>\n<p>Unless you want users to interactively write or inspect it I'm not sure I agree here. Maybe if implementing the parser is easier using lean's own parser, but otherwise I'd expect a plain string to be easier and more efficient.</p>",
        "id": 474618435,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727968827
    },
    {
        "content": "<p>I have now updated to code to generate Lean proof terms directly from resolution proofs. It avoids the large terms that caused the performance problems with the first translation to a very large extent. It now generates proofs like the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Equation53_implies_Equation1038</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Magma</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Equation53</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">Equation1038</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v0</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">h0</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"w\"> </span><span class=\"c1\">-- subst</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v0</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Eq</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- flip</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h3</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v100</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"n\">v100</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"w\"> </span><span class=\"c1\">-- subst</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h5</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v0</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">h4</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"w\"> </span><span class=\"c1\">-- subst</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h6</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v0</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Eq</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h5</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- flip</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h7</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v100</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">h6</span><span class=\"w\"> </span><span class=\"n\">v100</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"w\"> </span><span class=\"bp\">◇</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">v100</span><span class=\"w\"> </span><span class=\"bp\">◇</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- subst</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h8</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v100</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h7'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h7</span><span class=\"w\"> </span><span class=\"n\">v100</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">nth_rewrite</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h3</span><span class=\"w\"> </span><span class=\"n\">v100</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h7'</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h7'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- paramod</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h9</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">h8</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"c1\">-- subst</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h10</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Eq</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h9</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- flip</span>\n<span class=\"w\">  </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h10</span>\n</code></pre></div>",
        "id": 474871448,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1728063081
    },
    {
        "content": "<p>This is the same theorem as the one I mentioned at the beginning of this topic.</p>",
        "id": 474871514,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1728063117
    },
    {
        "content": "<p>What would be a set of suitable implications to apply it to now?</p>",
        "id": 474871885,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1728063259
    },
    {
        "content": "<p><a href=\"https://github.com/teorth/equational_theories/pull/270\">https://github.com/teorth/equational_theories/pull/270</a> I'd run it on top of main with <a href=\"https://github.com/teorth/equational_theories/pull/281\">https://github.com/teorth/equational_theories/pull/281</a> applied as that greatly reduces the search space</p>",
        "id": 474872188,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1728063369
    },
    {
        "content": "<p>With the size of the remaining theorems it may not matter to order them though</p>",
        "id": 474872331,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1728063428
    },
    {
        "content": "<p>I didn't find any new theorem in first 600 implications generated by <code>find_powerful_theorems</code>.</p>",
        "id": 474884211,
        "sender_full_name": "Stefan Hetzl",
        "timestamp": 1728068554
    }
]