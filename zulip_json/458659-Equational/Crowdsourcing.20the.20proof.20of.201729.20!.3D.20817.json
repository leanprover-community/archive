[
    {
        "content": "<p>Hello everyone!  In this post, I am hoping to start a push to finish off the last remaining task in the original EquationalTheories project, which is to show that 1729 does not imply 817.  This is the most complex proof of a single refutation in the entire project; see <a href=\"https://teorth.github.io/equational_theories/blueprint/1729-chapter.html\">the blueprint chapter</a>.</p>\n<p>The first step - Theorem 18.1 - is currently being worked on by <span class=\"user-mention\" data-user-id=\"466334\">@Shreyas Srinivas</span>.  This reduces matters to constructing some objects <code>SM</code>, <code>N</code>, <code>R'</code>, <code>L'</code>, <code>S'</code>, <code>op</code> obeying certain axioms.  The next steps are to construct some of these objects, and reduce to a fresh set of axioms.  Specifically, one has</p>\n<ul>\n<li><a href=\"https://github.com/teorth/equational_theories/pull/1105\">equational#1105</a> - establish the basic properties of<code>SM</code> - already defined in the repository</li>\n<li><a href=\"https://github.com/teorth/equational_theories/pull/1106\">equational#1106</a> - establish the basic properties of <code>N</code> - already defined in the repository</li>\n<li><a href=\"https://github.com/teorth/equational_theories/pull/1107\">equational#1107</a> - establish the basic properties of <code>R'</code> (and its inverse) - already defined in the repository.</li>\n<li><a href=\"https://github.com/teorth/equational_theories/pull/1108\">equational#1108</a> - express <code>L'</code> in terms of a single map <code>L₀'</code> and establish basic properties</li>\n<li><a href=\"https://github.com/teorth/equational_theories/pull/1109\">equational#1109</a> - rewrite axioms in terms of <code>L₀'</code></li>\n</ul>\n<p>The first three tasks are relatively easy and should be independent of each other.  The fourth task may possibly depend slightly on the third, and the fifth may depend on the fourth as well as <span class=\"user-mention\" data-user-id=\"466334\">@Shreyas Srinivas</span> 's task.  Anyway, I am hoping that people will be able to take up these tasks and complete them relatively soon.  Please feel free to \"claim\" one of these tasks on the Github issues page at <a href=\"https://github.com/teorth/equational_theories/issues\">https://github.com/teorth/equational_theories/issues</a></p>\n<p>This takes us about halfway to the proof; the second half is then to use a greedy algorithm construction to build objects <code>L₀'</code>, <code>S'</code>, <code>op</code> obeying the remaining axioms.  I'll make tasks for those shortly, but wanted to start with these (somewhat easier) tasks to make sure the workflow is adequate.</p>",
        "id": 507397066,
        "sender_full_name": "Terence Tao",
        "timestamp": 1742608482
    },
    {
        "content": "<p>The fourth task can be done without any further input from my side since only the ExtWithProps structure is needed to fetch the properties</p>",
        "id": 507397638,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742608835
    },
    {
        "content": "<p>It turns out that it was easy to establish that <code>SM</code> and <code>N</code> were <code>Countable</code> from Mathlib (essentially immediate from <code>instCountableDFinsupp</code> and <code>Quotient.countable</code>); I've uploaded the proof and removed those tasks from <a href=\"https://github.com/teorth/equational_theories/pull/1105\">equational#1105</a> and <a href=\"https://github.com/teorth/equational_theories/pull/1106\">equational#1106</a>, so one only needs to verify the purely algebraic facts about these two spaces now.</p>",
        "id": 507591470,
        "sender_full_name": "Terence Tao",
        "timestamp": 1742754900
    },
    {
        "content": "<p><a href=\"https://github.com/teorth/equational_theories/pull/1105\">equational#1105</a> and <a href=\"https://github.com/teorth/equational_theories/pull/1107\">equational#1107</a> were in fact rather easy and are now completed.  I've added tasks for all the remaining portions of the 1729 implication, feel free to claim any one of them!  (In principle they can all be worked on independently, provided that I have written all the definitions correctly...)</p>",
        "id": 507638921,
        "sender_full_name": "Terence Tao",
        "timestamp": 1742786510
    },
    {
        "content": "<p>I think I managed to do <a href=\"https://github.com/teorth/equational_theories/pull/1106\">equational#1106</a>. I also proved some instances of order properties that are implicitly used later in the proof (namely, every element of <code>N</code> has only finitely many predecessors, and the largest of them is the \"parent\"). I hope this is enough for the partial order on <code>N</code>, if something should be added at this part, please let me know!</p>",
        "id": 507763067,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1742822906
    },
    {
        "content": "<p>Thanks, this is great!  Good to see that the existing library on lists is extensive enough to make this task relatively straightforward.</p>\n<p>There might be two additional facts needed for Proposition 8.14: <code>parent x ≤ x</code> and <code>adjacent x y → x = parent y ∨ y = parent x</code>.  Also <code>adjacent x y ↔ adjacent y x</code> could be handy (and presumably very easy to show).  If these could be added (either with proofs, or with sorries to set a new task for) that would be helpful, thanks!</p>",
        "id": 507775400,
        "sender_full_name": "Terence Tao",
        "timestamp": 1742825276
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"466334\">@Shreyas Srinivas</span> I'm halfway through establishing <code>reduce_to_new_axioms</code> and am trying out your API.  Mostly it is going well, there are just a few technical issues I encountered:</p>\n<ul>\n<li>In <code>ExtOps</code> I think the <code>EM</code> field is unnecessary (and also a weird type, it is currently asking for a specific element of <code> SM ⊕ N</code>).  </li>\n<li>Your types <code>injective</code>, <code>surjective</code>, <code>bijective</code>, <code>Invertible</code> are largely covered by the existing types <code>Function.Injective</code>, <code>Function.Surjective</code>, <code>Function.Bijective</code>, <code>Equiv</code> respectively. Related to this, I think the <code>bij</code> component of <code>Invertible</code> is redundant (it is covered by <code>Equiv.bijective</code>).</li>\n</ul>",
        "id": 507793832,
        "sender_full_name": "Terence Tao",
        "timestamp": 1742828736
    },
    {
        "content": "<p>I added those because I am counting on sum types to get injectivity by default</p>",
        "id": 507794571,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742828882
    },
    {
        "content": "<p>At least some of those definitions were defined on set maps.</p>",
        "id": 507794664,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742828893
    },
    {
        "content": "<p>Yeah I can remove EM</p>",
        "id": 507795811,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742829134
    },
    {
        "content": "<p>Its' not necessary</p>",
        "id": 507795846,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742829141
    },
    {
        "content": "<p>However <code>SM ⊕ N</code> is just <code>Sum SM N</code></p>",
        "id": 507796219,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742829226
    },
    {
        "content": "<p>Which is the final magma that will satisfy 1729 and refute 817. It's the type theorists way of saying \"Here is a disjoint union of two types\"</p>",
        "id": 507796442,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742829265
    },
    {
        "content": "<p>I figured it would be much simpler to define extension functions on types than sets.</p>",
        "id": 507796495,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742829279
    },
    {
        "content": "<p>I think the Mathlib types <code>Function.Injective</code> etc. do not use <code>Set</code>.  I agree with the use of <code>Sum</code>.  Though I will point out that <code>ExtOpsWithProps.sqN_extends_sqM</code> is a tautology (it is proven <code>by intro _; aesop</code>) and does not need to be data (as with <code>Injective.bij</code>).</p>",
        "id": 507800162,
        "sender_full_name": "Terence Tao",
        "timestamp": 1742829983
    },
    {
        "content": "<p>It's the inverse that is set theoretic</p>",
        "id": 507800338,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742830016
    },
    {
        "content": "<p>The inverse map is basically mapping and <code>x</code> in the range to its pre-image (which is defined as a set).</p>",
        "id": 507800465,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742830042
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Logic/Equiv/Defs.html#Equiv\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Logic/Equiv/Defs.html#Equiv</a> also does not use <code>Set</code></p>",
        "id": 507800601,
        "sender_full_name": "Terence Tao",
        "timestamp": 1742830071
    },
    {
        "content": "<p>Ah I see you are talking about a different inverse definition. I'll quickly refactor to use that</p>",
        "id": 507800793,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742830099
    },
    {
        "content": "<p>Btw, I am filling out 18.1 here: <a href=\"https://github.com/teorth/equational_theories/pull/1133\">https://github.com/teorth/equational_theories/pull/1133</a></p>",
        "id": 507801055,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742830148
    },
    {
        "content": "<p>Hmm, I'm realizing I should refactor <code>R'_inv</code> and <code>L'_inv</code> using <code>Equiv</code> as well</p>",
        "id": 507802903,
        "sender_full_name": "Terence Tao",
        "timestamp": 1742830500
    },
    {
        "content": "<p>My main objection to use Equiv is that it is a statement that two types are equivalent without paying heed to what the function is</p>",
        "id": 507803159,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742830558
    },
    {
        "content": "<p><code>Equiv.toFun</code> is the function</p>",
        "id": 507803312,
        "sender_full_name": "Terence Tao",
        "timestamp": 1742830580
    },
    {
        "content": "<p>Since our claims are that N is equivalent to N, even the identity function will satisfy it</p>",
        "id": 507803344,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742830588
    },
    {
        "content": "<p>Whereas in my statement, I am claiming that f is invertible and there is a specific inverse for f</p>",
        "id": 507803437,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742830611
    },
    {
        "content": "<p>I don’t know how much difference this makes in the formalisation</p>",
        "id": 507803486,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742830625
    },
    {
        "content": "<p>Yeah that's <code>Equiv.toFun</code> and <code>Equiv.invFun</code>.  It's part of the data of <code>Equiv</code></p>",
        "id": 507803511,
        "sender_full_name": "Terence Tao",
        "timestamp": 1742830630
    },
    {
        "content": "<p>It's not just a <code>Prop</code>, it carries this information</p>",
        "id": 507803685,
        "sender_full_name": "Terence Tao",
        "timestamp": 1742830668
    },
    {
        "content": "<p>Okay. I'll push the refactoring to <a href=\"https://github.com/teorth/equational_theories/pull/1133\">equational#1133</a></p>",
        "id": 507803908,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742830708
    },
    {
        "content": "<p><code>Equiv</code> is basically identical to your <code>Invertible</code>, except that it already comes with a full API, and that <code>Injective.bij</code> has been moved out of the data of the type and become <code>Equiv.bijective</code> instead</p>",
        "id": 507805051,
        "sender_full_name": "Terence Tao",
        "timestamp": 1742830916
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"466334\">Shreyas Srinivas</span> <a href=\"#narrow/channel/458659-Equational/topic/Crowdsourcing.20the.20proof.20of.201729.20!.3D.20817/near/507803908\">said</a>:</p>\n<blockquote>\n<p>Okay. I'll push the refactoring to <a href=\"https://github.com/teorth/equational_theories/pull/1133\">equational#1133</a></p>\n</blockquote>\n<p>done</p>",
        "id": 507807167,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742831314
    },
    {
        "content": "<p>Basically the <code>ExtWithProps</code> structure only contains the axioms with the exception of the squaring_map, left_map and right_map properties.</p>",
        "id": 507807792,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1742831434
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"657719\">Terence Tao</span> <a href=\"#narrow/channel/458659-Equational/topic/Crowdsourcing.20the.20proof.20of.201729.20!.3D.20817/near/507775400\">said</a>:</p>\n<blockquote>\n<p>Thanks, this is great!  Good to see that the existing library on lists is extensive enough to make this task relatively straightforward.</p>\n<p>There might be two additional facts needed for Proposition 8.14: <code>parent x ≤ x</code> and <code>adjacent x y → x = parent y ∨ y = parent x</code>.  Also <code>adjacent x y ↔ adjacent y x</code> could be handy (and presumably very easy to show).  If these could be added (either with proofs, or with sorries to set a new task for) that would be helpful, thanks!</p>\n</blockquote>\n<p>I have added them as well with proofs</p>",
        "id": 507813693,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1742832538
    },
    {
        "content": "<p>Wow, that was fast!  One more subtask completed...</p>",
        "id": 507830198,
        "sender_full_name": "Terence Tao",
        "timestamp": 1742835910
    },
    {
        "content": "<p><a href=\"https://github.com/teorth/equational_theories/pull/1109\">equational#1109</a> is now completed (some slight refactoring will be needed when <a href=\"https://github.com/teorth/equational_theories/pull/1133\">equational#1133</a> lands, but it should be straightforward).</p>",
        "id": 507853222,
        "sender_full_name": "Terence Tao",
        "timestamp": 1742842213
    },
    {
        "content": "<p><a href=\"https://github.com/teorth/equational_theories/pull/1116\">equational#1116</a> (direct limit of an asymptotically complete chain of partial solutions is a complete solution) is now also completed.  I discovered numerous typos in my definition of a partial solution, but of course part of the point of formalization is to weed them out.  Also I found that <code>filter_upwards</code> was a convenient tactic to do these sort of direct limit arguments.</p>\n<p>I'll start on <a href=\"https://github.com/teorth/equational_theories/pull/1120\">equational#1120</a> (the endgame, using the three enlargement propositions to create an asymptotically complete chain of partial solutions) next.  After that, the only things that need to be established are Theorem 18.1 (which <a href=\"https://github.com/teorth/equational_theories/pull/1133\">equational#1133</a> is addressing) and the three enlargement propositions (<a href=\"https://github.com/teorth/equational_theories/pull/1117\">equational#1117</a> <a href=\"https://github.com/teorth/equational_theories/pull/1118\">equational#1118</a> <a href=\"https://github.com/teorth/equational_theories/pull/1119\">equational#1119</a>), which can be worked on independently.</p>",
        "id": 508163897,
        "sender_full_name": "Terence Tao",
        "timestamp": 1742955184
    },
    {
        "content": "<p><a href=\"https://github.com/teorth/equational_theories/pull/1120\">equational#1120</a> is completed.  <code>exists_greedy_chain</code> is well suited for greedy arguments with multiple different ways to extend the object (though I had to refactor the <code>use_chain</code> lemma to actually use chains, rather than enumerating by <code>Nat</code>).</p>",
        "id": 508382851,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743025256
    },
    {
        "content": "<p>one half of theorem 18.1 is done. I'll finish the other half tomorrow.</p>",
        "id": 508653187,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743128105
    },
    {
        "content": "<p>I might need to carefully look at some of the axioms again</p>",
        "id": 508653215,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743128125
    },
    {
        "content": "<p>quick question : what is reduce_to_new_axioms meant for?</p>",
        "id": 508748263,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743166551
    },
    {
        "content": "<p>I am refactoring that file to fix the breakages from changing the Ext structure to use Equiv</p>",
        "id": 508748374,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743166575
    },
    {
        "content": "<p>It formalizes Lemma 18.9, converting the axiom set in Theorem 18.1 to a slightly different axiom set in which all the left multiplications <code>L' a</code> are modeled by a single function <code>L₀'</code>.</p>",
        "id": 508770506,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743172443
    },
    {
        "content": "<p>Among other things it will need additional code to verify axiom vii</p>",
        "id": 508770614,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743172477
    },
    {
        "content": "<p>but the Equiv stuff should actually be shorter because <code>L'</code> and <code>R'</code> also use <code>Equiv</code></p>",
        "id": 508770795,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743172527
    },
    {
        "content": "<p>Can’t we just define L’_0 with the magma operation?</p>",
        "id": 508770895,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743172559
    },
    {
        "content": "<p>From 18.1</p>",
        "id": 508770963,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743172566
    },
    {
        "content": "<p>That would be circular.  Theorem 18.1 needs to specify <code>L'</code> as one of the inputs to build the magma operation, and <code>L'</code> is constructed using <code>L₀'</code>.  A posteriori, <code>L₀'</code> is leff multiplication by <code>0</code>, but we can't use that fact until after the magma is constructed.</p>",
        "id": 508771386,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743172687
    },
    {
        "content": "<p>the arrow of causality is (new axiom set (iii')-(vii')) =Lemma 18.9=&gt; (initial axiom set (i)-(vii)) =Theorem 18.1=&gt; (1729 counterexample magma)</p>",
        "id": 508771858,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743172806
    },
    {
        "content": "<p>Oh I see now 18.9 is dealing with our specific extension strategy</p>",
        "id": 508772012,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743172851
    },
    {
        "content": "<p>finished <a href=\"https://github.com/teorth/equational_theories/pull/1117\">equational#1117</a>.  A ridiculous amount of API was needed in order to formalize and then manipulate \"does not appear as a component of any index of any of the generators <code>e a</code> appearing anywhere in the partial solution\", but now this is in place, the two remaining tasks <a href=\"https://github.com/teorth/equational_theories/pull/1118\">equational#1118</a> <a href=\"https://github.com/teorth/equational_theories/pull/1119\">equational#1119</a> should be relatively straightforward.</p>",
        "id": 508864195,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743206695
    },
    {
        "content": "<p>That problem <a href=\"https://github.com/teorth/equational_theories/blob/244b739c661328ec5b3075edb6eaa2d304199927/equational_theories/Obelix.lean#L135\">sounds familiar</a>. <span aria-label=\"smiling face with tear\" class=\"emoji emoji-1f972\" role=\"img\" title=\"smiling face with tear\">:smiling_face_with_tear:</span></p>",
        "id": 508922599,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1743255015
    },
    {
        "content": "<p>It makes me wonder/wish if there was some better higher-level API for describing such a thing.</p>",
        "id": 508922733,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1743255123
    },
    {
        "content": "<p>finished <a href=\"https://github.com/teorth/equational_theories/pull/1119\">equational#1119</a>.  Tedious, and there were some minor issues that required updating the blueprint and doing some technical refactoring of other parts of the agument, but no major speedbumps.  Now down to just two tasks - Theorem 18.1 and Proposition 18.14!</p>",
        "id": 509107713,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743400646
    },
    {
        "content": "<p>I'm realizing that one of the final tasks, <a href=\"https://github.com/teorth/equational_theories/pull/1118\">equational#1118</a>, is actually rather massive.  As I think about how to formalize it, I see that I can spin off smaller subtasks that can be worked on separately by others.  I have created the first such task at <a href=\"https://github.com/teorth/equational_theories/pull/1140\">equational#1140</a>.  The task is to somehow use induction to get from</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">enlarge_S'_induction</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PartialSolution</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"n\">N</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hind</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">:</span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"bp\">.</span><span class=\"n\">Dom_S'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PartialSolution</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"bp\">.</span><span class=\"n\">Dom_S'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>to</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">enlarge_S'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PartialSolution</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PartialSolution</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"bp\">.</span><span class=\"n\">Dom_S'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p><span class=\"user-mention\" data-user-id=\"562819\">@Bernhard Reinke</span> has kindly supplied <code>instance : LocallyFiniteOrderBot N</code> already (and <code>PartialSolution</code> has an instance of <code>PreOrder</code>), so this should be straightforward, hopefully by an induction tool already present in Mathlib, but I haven't seriously attempted to locate it.  Anyway, this should be a bite-sized task that anyone who is somewhat familiar with the order-theoretic portion of Mathlib should be able to finish off without having to grapple with the hairy details of how to prove <code>enlarge_S'_induction</code>.</p>",
        "id": 509227281,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743433383
    },
    {
        "content": "<p>The second bite-size task is <a href=\"https://github.com/teorth/equational_theories/pull/1142\">equational#1142</a>.  Here, the task is to get from the already-formalized</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">enlarge_L₀'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PartialSolution</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\">  </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PartialSolution</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">fill</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"bp\">.</span><span class=\"n\">Predom_L₀'</span>\n</code></pre></div>\n<p>to</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">enlarge_L₀'_multiple</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PartialSolution</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\">  </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PartialSolution</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"bp\">.</span><span class=\"n\">toSet</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">fill</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"bp\">.</span><span class=\"n\">Predom_L₀'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>An induction on the cardinality of <code>A</code> should work here, and one does not need to know anything about <code>PartialSolution</code> or the proof of <code>enlarge_L₀'</code> other than that <code>PartialSolution</code> has an instance of <code>PreOrder</code>.  (So perhaps one could create a more abstract, Mathlib-suitable lemma to formalize the general induction argument, and then specialize to this particular setting.)</p>\n<p>It may also be possible to use the existing tool <a href=\"https://teorth.github.io/equational_theories/docs/equational_theories/Mathlib/Order/Greedy.html#exists_greedy_chain\">https://teorth.github.io/equational_theories/docs/equational_theories/Mathlib/Order/Greedy.html#exists_greedy_chain</a> .</p>",
        "id": 509262862,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743442009
    },
    {
        "content": "<p>A third bite-size task is <a href=\"https://github.com/teorth/equational_theories/pull/1144\">equational#1144</a>.  Here, the task is to use the two lemmas</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">enlarge_L₀'_multiple</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PartialSolution</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\">  </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"bp\">.</span><span class=\"n\">toSet</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">fill</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"bp\">.</span><span class=\"n\">Predom_L₀'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">enlarge_S'_induction_with_axioms</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PartialSolution</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"n\">N</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hind</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">:</span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"bp\">.</span><span class=\"n\">Dom_S'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hA</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">R'</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">parent</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">R'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sol</span><span class=\"bp\">.</span><span class=\"n\">S'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">parent</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"bp\">.</span><span class=\"n\">Dom_L₀'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hB</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">R'</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">R'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"bp\">.</span><span class=\"n\">S'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">parent</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"bp\">.</span><span class=\"n\">Dom_L₀'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hC</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"bp\">.</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"bp\">.</span><span class=\"n\">Dom_S'</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">R'</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">R'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sol</span><span class=\"bp\">.</span><span class=\"n\">S'</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"bp\">.</span><span class=\"n\">Dom_L₀'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"bp\">.</span><span class=\"n\">Dom_S'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>to obtain the conclusion</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">enlarge_S'_induction</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PartialSolution</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"n\">N</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hind</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">:</span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"bp\">.</span><span class=\"n\">Dom_S'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">sol'</span><span class=\"bp\">.</span><span class=\"n\">Dom_S'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Basically <code>enlarge_S'_induction_with_axioms</code> is the same as <code>enlarge_S'_induction</code> but with additional axioms about the domain <code>sol.Dom_L₀'</code> of the function <code>sol.L₀'</code>.  Once one verifies that the number of such axioms is finite, one should be able to directly appeal to <code>enlarge_L₀'_multiple</code> to conclude.  (The prior task <a href=\"https://github.com/teorth/equational_theories/pull/1142\">equational#1142</a>, which formalizes the proof of <code>enlarge_L₀'_multiple</code>, can be done independently of this one.)</p>",
        "id": 509287521,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743450463
    },
    {
        "content": "<p>I am belatedly realizing that much of the tedious nature of the already formalized portion of the proof here could have been alleviated if I had incorporated inductive types more systematically into the constructions (particularly with regards with all the times one extends various partial functions).  Well, at least I get to learn how to use inductive types properly now in the home stretch of the proof.</p>",
        "id": 509320830,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743462849
    },
    {
        "content": "<p>That comes with disadvantages if the blueprint is set up in a set theoretic way. It is easy to say that one “extends a map” in naive sets and that might look easy in inductive types, but over time, the objects in the set get buried under more and more constructors with each extension</p>",
        "id": 509367954,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743488558
    },
    {
        "content": "<p>In principle one could also use functions that map to option types, but extending them means adding a layer of if statements each time.</p>",
        "id": 509368061,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743488627
    },
    {
        "content": "<p>So far what inductive types have allowed me to do is to defer the most combinatiorially involved part of the verification, namely the \"no collision\" aspect of the extension, which basically comes down to a certain matching map from the inductive type to be injective.  Assuming that for now, I can define a preliminary extension on the inductive type, and use some combination of <code>Exists.choose</code> and <code>if _ then _ else</code> to then give a putative version of that extension on the original domain, and use the aforementioned injectivity properties to show that that extension behaves as expected.  It's possible that this could be streamlined with some API (I need to extend four separate functions, so it's almost worth it to abstract this out) but so far it is reasonably manageable.  </p>\n<p>I am slightly nervous about verifying the injectivity; after breaking up into cases, I am looking at dozens of statements to the effect that certain words in the free group cannot equal other words in the free group, with the main justification being that one of them involves a \"fresh\" generator that does not appear in the other.  But I'm working my way through the other parts of the verification now and at the end I should have an explicit list of all these sorts of statements that require proof, at which point it should be clearer how next to proceed.  (For instance, of the nine axioms I need the extension to verify, I have already established the three easiest ones, conditional on these sorts of injectivity properties and their basic consequences).</p>",
        "id": 509472243,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743518748
    },
    {
        "content": "<p>With inductive types you get injectivity for free upto constructors</p>",
        "id": 509472870,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743518895
    },
    {
        "content": "<p>there is the <code>injection</code> tactic to falsify equalities between objects built from different constructors</p>",
        "id": 509472955,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743518914
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 509473179,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743518971
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 509473244,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743518985
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 509473379,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743519005
    },
    {
        "content": "<p>you could try something like <code>cases h : &lt;object&gt; (try injection at &lt;equality hypothesis&gt;) with ...</code></p>",
        "id": 509473563,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743519049
    },
    {
        "content": "<p>This will attempt to apply injection to all the cases.</p>",
        "id": 509473614,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743519063
    },
    {
        "content": "<p>For <code>rcases</code> the syntax would be more like <code>rcases h : &lt;object&gt; &lt;;&gt; try injection at &lt;equality hypothesis&gt; ...</code></p>",
        "id": 509473788,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743519110
    },
    {
        "content": "<p>That might be useful, thanks.  For now I am focusing on developing some abstract API for editing  operations: given an initial function <code>f : X → Y</code>, an embedding <code>ι : X' ↪ X</code>, and a replacement function<br>\n<code>f' : X' → Y</code>, create a new function <code>edit f ι f' : X → Y</code> which replaces <code>f ι x'</code> with <code>f' x'</code> for all <code>x' : X'</code>.  In the applications, <code>X'</code> will be an inductive type which maps to the base type <code>X</code>; the no-collision aspect is then hidden in the embedding property.</p>",
        "id": 509498505,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743524986
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"657719\">@Terence Tao</span> : In type theory lingo you are extending f to a sum type</p>",
        "id": 509549003,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743542097
    },
    {
        "content": "<p>I have already done this my PR</p>",
        "id": 509549022,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743542104
    },
    {
        "content": "<p>It's at the very beginning</p>",
        "id": 509549037,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743542110
    },
    {
        "content": "<p>Specifically </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">extend_sum_inl</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">γ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">extend_sum_inr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">combine</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"n\">xl</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">xl</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"n\">xr</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">xr</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">extend_sum_both</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">δ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">δ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">extend_sum_inl</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">γ</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">g₁</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">extend_sum_inr</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">β</span>\n<span class=\"w\">  </span><span class=\"n\">combine</span><span class=\"w\"> </span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"n\">g₁</span>\n\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">is_left_extension_of</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">⊕</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f'</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">is_right_extension_of</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">⊕</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f'</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 509549102,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743542147
    },
    {
        "content": "<p>The embedding is injective by definition since on the respective domains and ranges it is the identity function</p>",
        "id": 509549326,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743542256
    },
    {
        "content": "<p>One can of course generalise these definitions to arbitrary embeddings</p>",
        "id": 509549399,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743542286
    },
    {
        "content": "<p>The generalised version of <code>extend_sum_inl</code> and <code>extend_sum_inr</code> would be something like:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">extend_sum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">embed</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">↪</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">embed</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>But I suspect this generality is excessive for our situation where we preserve existing mappings and merely extend them, and my definitions capture this whereas this general definition doesn't.</p>",
        "id": 509561810,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743548062
    },
    {
        "content": "<p>theorem 18_1 is down to its last sub case</p>",
        "id": 509711581,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743603648
    },
    {
        "content": "<p>It's possible that <code>combine</code> could be replaced by <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Sum.elim#doc\">docs#Sum.elim</a> to take advantage of the API in the latter.</p>\n<p>I ended up developing my own API for the ability to \"edit\" a function using an embedding, in <a href=\"https://github.com/teorth/equational_theories/blob/main/equational_theories/ManuallyProved/Equation1729/Edit.lean\">https://github.com/teorth/equational_theories/blob/main/equational_theories/ManuallyProved/Equation1729/Edit.lean</a> , which has made things relatively painless (subject to establishing the injectivity property <code>Function.Embedding.inj'</code> of various maps needed in the construction, which I have deferred for now).  Of the nine axioms I need the construction to verify, five verifications have been formalized modulo this injectivity; I will work on the other four next, and then finally get around to checking all the injectivity or \"no collision\" hypotheses.</p>",
        "id": 509715413,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743604532
    },
    {
        "content": "<p>I looked at that file and although I haven't tried this (so evidence is slim), I think the type theoretic versions of these definitions will be much easier to work with, lean-wise.</p>",
        "id": 509715866,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743604645
    },
    {
        "content": "<p>Also, I notice you are getting into the gnarly world of Finsets and Fintypes</p>",
        "id": 509716824,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743604892
    },
    {
        "content": "<p>After looking through Mathlib I see that I should probably have made the design choice at the beginning to use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PFun#doc\">docs#PFun</a> to model all the partial functions used in a partial solution.  The editing notion I was developing is then a combination of (a) the operation of pushing forward a partial function by an embedding, and (b) gluing together two partial functions with disjoint domains of definition.  But at this point I am a thousand lines of code into the proof, and this is the last time we will use these notions, so I am not inclined to do a major refactor at this point (I already had to do a number of smaller, but still quite time-consuming, refactors, to fix some typos in the blueprint, most annoyingly I had been inconsistent abut whether to use left multiplication or right multiplication on <code>N</code> to define various operations).</p>",
        "id": 509732113,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743608353
    },
    {
        "content": "<p>Completed the most delicate part of <a href=\"https://github.com/teorth/equational_theories/pull/1118\">equational#1118</a> - verifying that the construction (which I was finally able to describe in a civilized way using inductive types and some \"editing\" API) preserves the axioms, assuming that various \"no collision\" injectivity type statements are verified (which amounts to a large number of case checking that certain expressions in the free group do not evaluate to equal other certain expressions in the free group).  I am deferring all of these to the end, but am finding that some of them can be concatenated into a single claim.</p>\n<p>There were numerous typos in the blueprint that were picked up during this process, in a fashion that would not have been possible without extremely careful human line by line reading.  Some required nontrivial modfication to the setup (in particular, I discovered the need for a new axiom, which is now in the blueprint as \"axiom P'\", though it was fortunately preserved by the construction).  The most annoying one was that I realized that I had implemented the construction to use left multiplication on the free group for one half of the argument and right multiplication for the other half.  The refactoring was quite tedious (in particular, I made the wrong choice initially and attempted to refactor the part of the code that involved lists, which I only belatedly realized did not have a fully symmetric API with respect to heads vs. tails of the lists, so I reverted and instead refactored the part involving free groups, which was much more symmetric).</p>\n<p>When I first started coding this task, I placed everything inside one giant lemma, which eventually acquired quite a few <code>let</code> and <code>have</code> statements.  This was initially convenient, but VSCode started choking on my basic laptop after a couple hundred lines of code in, so I eventualy ended up spinning off most of the setup into external <code>abbrev</code> and <code>lemma</code> statements instead (I had resisted this initially because most of my constructions required bespoke parameters and hypotheses defined inside the giant lemma, but I finally realized that I should embrace polymorphism and extend the notion of a partial solution to incorporate this additional data, at which point all the setup could be moved outside without difficulty.)  This created a noticeable speedup in the Lean infoview response time, which was quite essential for me as I had to do some quite delicate parsing in order to close off the dozens of case checks required.</p>",
        "id": 509968387,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743693203
    },
    {
        "content": "<p>If I had to start over, I would have coded all partial functions, such as a partially defined squaring map <code>S: N → SM</code> on some domain <code>dom_S: Finset N</code> (with junk values outside of this domain), instead as a globally defined map <code>S: Option N → Option SM</code>, with an additional axiom <code>S ⊥ = ⊥</code> as well as a <code>Finsupp</code> type hypothesis, with some API to \"Optionize\" a globally defined function.  (There already is support for partial functions in <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Pfun#doc\">docs#Pfun</a>, but for this specific application, in which one is always composing together many partially defined functions, the above choice seems slightly more convenient.)  The current code has to keep track of whether various substrings of expressions live in their indicated domain, and the <code>Option</code> mechanism seems to track that quite neatly with less bookkeeping.  But at this stage I'm just going to go with the current framework as the refactor would likely be extremely massive and lead to no long-term time savings since this is the last of the \"Greedy algorithm\" arguments to be finalized.</p>",
        "id": 509971626,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743693939
    },
    {
        "content": "<p>On a much more minor note, I am appreciating the use of the symbol <code>$</code> to declutter a long string of compositions of functions, and am beginning to also take advantage of <code>▸</code> to declutter a long string of rewrites.</p>",
        "id": 509974725,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743694630
    },
    {
        "content": "<p>I prefer <code>&lt;| </code> for that purpose since it shows you that the right hand side is being applied to the left</p>",
        "id": 509974944,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743694681
    },
    {
        "content": "<p>A new bite-size task: <a href=\"https://github.com/teorth/equational_theories/pull/1151\">equational#1151</a>, which asks to prove that the free group is torsion-free.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">torsionfree</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Monoid</span><span class=\"bp\">.</span><span class=\"n\">IsTorsionFree</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>We already have the Nelson-Schreier theorem in <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/GroupTheory/FreeGroup/NielsenSchreier.html#subgroupIsFreeOfIsFree\">subgroupIsFreeOfIsFree</a>, so this should be a straightforward corollary once one understands the API for free groups and <code>IsTorsionFree</code>.</p>",
        "id": 509995659,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743700357
    },
    {
        "content": "<p>We proved this already in <code>ForMathlib/GroupTheory/FreeGroup/ReducedWords.lean</code>, you can either use <code>FreeGroup.infinite_order</code> or <code>FreeGroup.zpow_injective</code></p>",
        "id": 509998380,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1743701185
    },
    {
        "content": "<p>see <a href=\"https://github.com/teorth/equational_theories/pull/1153\">equational#1153</a></p>",
        "id": 510006691,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1743703676
    },
    {
        "content": "<p>Thanks, this is great!  In retrospect it makes sense that you would already have encountered this.</p>",
        "id": 510052756,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743722383
    },
    {
        "content": "<p>A somewhat annoying update: the process of verifying the non-collision properties required to finish off the 1729 argument revealed that, under the current axiom system of a partial solution, some bad collisions can in fact occur.  I can fix this, but only by adding three more axioms to the axiom system, which will greatly delay the completion of the formalization.  In a way, this is a win for formalization, as there were about 80 (!) or so non-collision cases to check and it is quite likely that a pen-and-paper verification would have missed the handful of bad cases; but it does mean I am going to spend a lot more time on this than I had expected.</p>",
        "id": 510257842,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743788534
    },
    {
        "content": "<p>as far as I can tell, axiom 5,6 and 7 don't seem to be a complete enough description of the rest_map</p>",
        "id": 510258072,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743788627
    },
    {
        "content": "<p>This is where 18.1 is stuck right now</p>",
        "id": 510258164,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743788658
    },
    {
        "content": "<p>axiom 7 should have an \\and instead of an \\implies:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">axiom_7</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"c1\">-- the condition for axiom 5 doesn't hold</span>\n<span class=\"w\">    </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"o\">(</span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SM</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">R'</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- the condition for axiom 6 doesn't hold</span>\n<span class=\"w\">    </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rest_map</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"c1\">-- for any `z` of this form</span>\n<span class=\"w\">      </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">rest_map</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">Sum</span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">L'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S'</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span>\n</code></pre></div>\n<p>one can then use <code>Exists.choose</code> to control <code>rest_map</code></p>",
        "id": 510259294,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743789057
    },
    {
        "content": "<p>Ah that makes more sense</p>",
        "id": 510259411,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743789106
    },
    {
        "content": "<p>Yeah that case was simple. I just have one niche sub sub sub case left</p>",
        "id": 510272390,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743793642
    },
    {
        "content": "<p><del>It can be \"solved\" by assuming the following : <code>((E.R a).symm (E.S' x')) = (E.L (E.S' x')).symm a)</code></del> Nvm, I had an idea by just writing it out</p>",
        "id": 510272672,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743793773
    },
    {
        "content": "<p>This assumption should work: <code>\\E.R a = E.L (E.S' x')</code></p>",
        "id": 510273452,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743794079
    },
    {
        "content": "<p>This is an odd condition.  What is the sub-case that is triggering it?</p>",
        "id": 510282930,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743797696
    },
    {
        "content": "<p>Oh crap I think there is a typo in axiom iii... I am double checking now but it looks like <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>R</mi><mrow><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mi>x</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">R_{S&#x27; x}^{-1} a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1478em;vertical-align:-0.2935em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8542em;\"><span style=\"top:-2.4065em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6828em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal mtight\">x</span></span></span></span><span style=\"top:-3.1031em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2935em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">a</span></span></span></span> should be <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>L</mi><mrow><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mi>x</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mi>a</mi></mrow><annotation encoding=\"application/x-tex\"> L_{S&#x27;x}^{-1} a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1478em;vertical-align:-0.2935em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8542em;\"><span style=\"top:-2.4065em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6828em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal mtight\">x</span></span></span></span><span style=\"top:-3.1031em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2935em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">a</span></span></span></span>.  This is going to cause a number of other issues in the rest of the proof, but let me first double check</p>",
        "id": 510284454,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743798269
    },
    {
        "content": "<p>OK It should be fine if one replaces <code>axiom_3</code> with</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">axiom_3</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">R'</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">L'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S'</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">L'</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S'</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>\n<p>Let me know if that works.  It will cause some local changes to the proof of <code>reduce_to_new_axioms</code> but it should not be bad because <code>SM</code> is commutative (in the model used there) and so <code>L</code> and <code>R</code> are in fact identical.</p>",
        "id": 510286483,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743798987
    },
    {
        "content": "<p>Again this is why we need formalization for this sort of project!</p>",
        "id": 510286549,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743799013
    },
    {
        "content": "<p>Just got back. I will check the new version</p>",
        "id": 510287275,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743799266
    },
    {
        "content": "<p>18.1 is done. All that remains is fixing the downstream consequences</p>",
        "id": 510306069,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743808603
    },
    {
        "content": "<p>in 18.9</p>",
        "id": 510306072,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743808606
    },
    {
        "content": "<p>Do you want to have a try at that, or you can instead put in relevant sorries in <code>reduce_to_new_axioms</code> to close out the PR and I can go through it later.</p>",
        "id": 510306490,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743808866
    },
    {
        "content": "<p>I think I can do it, but it makes sense to create a separate PR for it anyway</p>",
        "id": 510306514,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743808895
    },
    {
        "content": "<p>I'll just sorry out everything for now in this PR</p>",
        "id": 510306592,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743808930
    },
    {
        "content": "<p>OK so then you can merge your current PR as soon as it passes CI</p>",
        "id": 510306593,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743808931
    },
    {
        "content": "<p>Okay. This should make the Equiv based definitions available for downstream PRs right away</p>",
        "id": 510306873,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743809139
    },
    {
        "content": "<p>done</p>",
        "id": 510309983,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743811322
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"466334\">@Shreyas Srinivas</span> Did you push your entire Python virtual environment?</p>",
        "id": 510310342,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1743811567
    },
    {
        "content": "<p>Let me check</p>",
        "id": 510310359,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743811581
    },
    {
        "content": "<p>I should have the same gitignore as the main repo</p>",
        "id": 510310376,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743811599
    },
    {
        "content": "<p>There's a huge diff.</p>",
        "id": 510310385,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1743811611
    },
    {
        "content": "<p>Oh then that must be me</p>",
        "id": 510310393,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743811619
    },
    {
        "content": "<p>Isn't the python venv folder in .gitignore by default?</p>",
        "id": 510310428,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743811640
    },
    {
        "content": "<p>Sure, but it seems you added a <code>bin</code> folder.</p>",
        "id": 510310513,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1743811697
    },
    {
        "content": "<p>Please consider reverting the commit, restoring the merged branch, removing those unnecessary additions and merge the PR.</p>",
        "id": 510310599,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1743811786
    },
    {
        "content": "<p>alternatively I could <code>git rm</code> the bin folder</p>",
        "id": 510310688,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743811835
    },
    {
        "content": "<p>There is much more than that (see <a href=\"https://github.com/teorth/equational_theories/blob/main/lib64\">this</a>, <a href=\"https://github.com/teorth/equational_theories/blob/main/pyvenv.cfg\">this</a>, <a href=\"https://github.com/teorth/equational_theories/tree/main/lib/python3.12/site-packages\">this</a>). I think it's better to revert the commit to be 100% sure.</p>",
        "id": 510310723,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1743811871
    },
    {
        "content": "<p>I am currently not on my laptop. Could you do this fix for me? The PR needs to be re-merged after getting fixed since downstream PRs will depend on it</p>",
        "id": 510310802,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743811922
    },
    {
        "content": "<p>Ok, I'm going to revert the latest commit.</p>",
        "id": 510310879,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1743811967
    },
    {
        "content": "<p>Also, we need to update .gitignore and push it so that it ignores everything related to python venv</p>",
        "id": 510310912,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743811988
    },
    {
        "content": "<p>Reverted. I'm going to update the <code>.gitignore</code></p>",
        "id": 510311026,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1743812075
    },
    {
        "content": "<p>The most likely source of these files is me compiling the blueprint locally yesterday</p>",
        "id": 510311065,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743812112
    },
    {
        "content": "<p>Could you please just locally aggregate all those folders within the usual <code>.ven</code> folder?</p>",
        "id": 510311151,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1743812164
    },
    {
        "content": "<p>Sure</p>",
        "id": 510311198,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743812222
    },
    {
        "content": "<p>Great, so we don't need to add anything non-standard to our <code>.gitignore</code>. Thanks.</p>",
        "id": 510311223,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1743812250
    },
    {
        "content": "<p>I'm going to open a new PR with those additions then.</p>",
        "id": 510311858,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1743812742
    },
    {
        "content": "<p>no not necessary</p>",
        "id": 510311918,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743812769
    },
    {
        "content": "<p>we can simply reset to a few commits before</p>",
        "id": 510311931,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743812779
    },
    {
        "content": "<p>and then replay the changes from the local copy</p>",
        "id": 510311940,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743812790
    },
    {
        "content": "<p>Also, in general we should avoid re-PRing since we are using PRs for authorship descriptions</p>",
        "id": 510312041,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743812873
    },
    {
        "content": "<p>Ok, I restored the branch you used for the PR.</p>",
        "id": 510312147,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1743812941
    },
    {
        "content": "<p>okay I will redo it</p>",
        "id": 510312165,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743812964
    },
    {
        "content": "<p>Done : <a href=\"https://github.com/teorth/equational_theories/pull/1154\">https://github.com/teorth/equational_theories/pull/1154</a></p>",
        "id": 510312811,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743813533
    },
    {
        "content": "<p>Just replayed the history in a different branch and <code>git rm</code>ed the extraneous files. There are only four changed files now</p>",
        "id": 510312832,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1743813556
    },
    {
        "content": "<p>Merged.</p>",
        "id": 510321342,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1743819792
    },
    {
        "content": "<p>Just reviewed and merged <a href=\"https://github.com/teorth/equational_theories/pull/1155\">equational#1155</a> and <a href=\"https://github.com/teorth/equational_theories/pull/1156\">equational#1156</a> opened by <span class=\"user-mention\" data-user-id=\"753178\">@Aaron Hill</span>.</p>",
        "id": 510488247,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1743950148
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"753178\">@Aaron Hill</span> for the two PRs!</p>\n<p>I am closing in on completing <a href=\"https://github.com/teorth/equational_theories/pull/1118\">equational#1118</a>, which was significantly more complicated than I anticipated.  Part of the reason is due to a lot of subtle collision issues that I did not anticipate when writing the blueprint proof, which required multiple refactoring of the argument in which axioms were modified or introduced.  I did find a few minor simplifications to compensate though, and am learning how to use tactics such as <code>all_goals</code> to handle large numbers of case checks in an assembly-line fashion, as well as creating dozens of tiny lemmas.  Hopefully will be completely done in a day or two.</p>\n<p>While the setup was tedious, I can certainly say that refactoring a lengthy and convoluted proof is <em>much</em> nicer to do in a formalized setting than with pen and paper.  Making a fundamental change in the axioms and seeing within a minute the dozen or so precise lines of code that need to be changed is very pleasant compared to manual line-by-line verification!</p>",
        "id": 510494908,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743954945
    },
    {
        "content": "<p>OK, I have an embarrasingly simple request.  How does one prove</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">one_odd</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ZMod</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>?  I thought this would be a <code>decide</code> but I guess <code>decide</code> does not know how to enumerate over <code>ZMod 4</code> (or <code>Fin 4</code>).</p>",
        "id": 510506582,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743962996
    },
    {
        "content": "<p>if you <code>revert n</code>, <code>decide</code> should work, i think...</p>",
        "id": 510506946,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1743963244
    },
    {
        "content": "<p>alternatively, <code>fin_cases n &lt;;&gt; decide</code> is likely to work too</p>",
        "id": 510507000,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1743963297
    },
    {
        "content": "<p>Ah! that worked.  OK, good to know that <code>decide</code> can handle bounded quantifiers if one <code>revert</code>s first.</p>",
        "id": 510507010,
        "sender_full_name": "Terence Tao",
        "timestamp": 1743963302
    },
    {
        "content": "<p>Minor QoL improvement: <code>decide +revert</code></p>",
        "id": 510558747,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1744000752
    },
    {
        "content": "<p>Is this a recent modification to <code>decide</code>?  It doesn't seem to work on my build.</p>",
        "id": 510693245,
        "sender_full_name": "Terence Tao",
        "timestamp": 1744037310
    },
    {
        "content": "<p>It's been around for a while. This project is on a pretty recent version of Lean, right?</p>",
        "id": 510697138,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1744038226
    },
    {
        "content": "<p>It is likely. The format for tactic configurations used to be different.</p>",
        "id": 510697280,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744038252
    },
    {
        "content": "<p>We haven’t updated the toolchains for a while because one of the update PRs had an unresolved discussion about some upgrade issue.</p>",
        "id": 510697413,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744038281
    },
    {
        "content": "<p>Cc: <span class=\"user-mention\" data-user-id=\"556875\">@Pietro Monticone</span></p>",
        "id": 510697481,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744038295
    },
    {
        "content": "<p>We are still at 4.14.0-rc3</p>",
        "id": 510697826,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744038370
    },
    {
        "content": "<p>Yes, there are some remaining non-trivial issues to solve. <a href=\"https://github.com/teorth/equational_theories/pull/970\">equational#970</a></p>",
        "id": 510698103,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1744038446
    },
    {
        "content": "<p>Unfortunately I’m very busy at the moment so any help is appreciated</p>",
        "id": 510698389,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1744038522
    },
    {
        "content": "<p>I think we should hold off until all existing PRs are resolved.</p>",
        "id": 510698477,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744038548
    },
    {
        "content": "<p>The following should work on earlier toolchains as well as current ones:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">one_odd</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ZMod</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">decide</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">config</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">revert</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"o\">})</span>\n</code></pre></div>",
        "id": 510698615,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744038578
    },
    {
        "content": "<p>I think that you should aggressively bump mathlib always and rotten luck to the PRs which break. That's been my attitude with FLT. We bump weekly.</p>",
        "id": 510707271,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744040715
    },
    {
        "content": "<p>Basically the longer you leave it the more the errors pile up. Lean itself is not backwards compatible so after a while the entire config setup fails and you're left trying to solve problems which everyone else solved months ago. When things break with FLT after a bump there are always several other people on the Zulip saying \"my project just broke\" and explanations of how to fix them. Even the fixes might break if you leave it too long.</p>",
        "id": 510707677,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744040831
    },
    {
        "content": "<p>So normally I would agree but Pietro points out there are some breakages that need fixing in the lawful magma proofs. Pietro has said he will look into it. </p>\n<p>About your second point : the project will always compile on the current toolchain</p>",
        "id": 510707994,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744040916
    },
    {
        "content": "<p>That is to say the toolchain on which the project is currently being built.</p>",
        "id": 510708080,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744040941
    },
    {
        "content": "<p>If someone wishes to make a PR to update the toolchain to 4.19.0-rc2 this is most welcome</p>",
        "id": 510708357,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744041018
    },
    {
        "content": "<p>If it remains undone I will probably do it later this week.</p>",
        "id": 510708626,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744041097
    },
    {
        "content": "<p>Finally finished the proof of <a href=\"https://github.com/teorth/equational_theories/pull/1118\">equational#1118</a>!  It was significantly harder than expected.  There was one map <code>L₀'</code> which at one point basically was a piecewise defined function with ten pieces, and to verify noncollisions required about a hundred separate verifications, many of whom were broadly similar but with key parameters changed.  I finally figured out a way to do all of them in a somewhat civilized way through liberal use of <code>all_goals</code> and <code>simp</code> with a large number of very small lemmas.</p>\n<p>At several points in the process, I found that of the 100 or so noncollision statements to check, one or two actually could not be verified from the axioms I was using for a partial solution. So I had to go back and tweak one of the axioms to fix this, which of course broke other things, but thanks to the magic of Lean (and eventually myself realizing to avoid hardcoding various things into the lean proofs), in many cases only a relatively small number of lines of code needed to be changed for each such refactor.  It is interesting that a complex proof in Lean feels a lot less \"brittle\" than a corresponding pen-and-paper proof; past a certain point, I become afraid to tinker with any foundational detail of the latter, but with Lean one can much more confidently tweak the proof in one direction or another.</p>\n<p>A final stumbling block was to show that certain expressions in the free group <code>N</code> were not equal to each other.  A typical thing to show as that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>e</mi><mi>a</mi></msub><mi>x</mi><mo>=</mo><msubsup><mi>e</mi><mn>0</mn><mi>n</mi></msubsup><msub><mi>e</mi><mi>a</mi></msub><mi>y</mi></mrow><annotation encoding=\"application/x-tex\"> e_a x = e_0^n e_a y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9125em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> was only possible when <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">n=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>, assuming that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span> is non-zero and the generator <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>e</mi><mi>a</mi></msub></mrow><annotation encoding=\"application/x-tex\">e_a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> does not appear in the expansions of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> or <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>.  This looked tricky to do from the direct definition of a free group using reduced words, but I eventually figured out how to use enough of the representation theory API to construct a simple representation of the free group as two-dimensional linear transformations to rule out this sort of identity.  (For 90% of the identities needed, one could abelianize and basically count things like how often a given generator like <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>e</mi><mi>a</mi></msub></mrow><annotation encoding=\"application/x-tex\">e_a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> appeared on the left-hand side or right-hand side, but the above was one of the few cases where one could not proceed purely through abelian arguments and had to deploy some actual non-abelian representation, of which the simplest examples came from two dimensions.)</p>\n<p>Now I think the only sorry remaining in the entire project is <code>reduce_to_new_axioms</code>.  <span class=\"user-mention\" data-user-id=\"466334\">@Shreyas Srinivas</span> , are you still planning to close that one off?  If not, I can have a go at it instead.</p>",
        "id": 510787504,
        "sender_full_name": "Terence Tao",
        "timestamp": 1744070368
    },
    {
        "content": "<p>Congratulations! That sounds like a Herculean sprint to the finish line!</p>",
        "id": 510801263,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1744078133
    },
    {
        "content": "<p>I’ll work on the remaining sorries later today</p>",
        "id": 510853722,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744095840
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/458659-Equational/topic/Crowdsourcing.20the.20proof.20of.201729.20!.3D.20817/near/510801263\">said</a>:</p>\n<blockquote>\n<p>Congratulations! That sounds like a Herculean sprint to the finish line!</p>\n</blockquote>\n<p>In a way it was like a relay race and a triathlon.</p>",
        "id": 510949744,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744122445
    },
    {
        "content": "<p>Got rid of some sorries in the SmallMagma file.</p>",
        "id": 511044898,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744156274
    },
    {
        "content": "<p>More to follow tomorrow.</p>",
        "id": 511044905,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744156279
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"556875\">@Pietro Monticone</span>  : Yesterday's PR basically overrode all the fixes I made</p>",
        "id": 511137302,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744195540
    },
    {
        "content": "<p>I'll recover and redo it, but we should come up with a way to avoid this (point to note for the paper)</p>",
        "id": 511138816,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744196087
    },
    {
        "content": "<p>I think we are free of sorries now. Just <a href=\"https://github.com/teorth/equational_theories/actions/runs/14440437040/job/40489171848?pr=1162\">waiting on CI</a></p>",
        "id": 512012235,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744618362
    },
    {
        "content": "<p>Update : CI passes. We are free of sorries</p>",
        "id": 512019111,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1744620133
    },
    {
        "content": "<p>7 messages were moved from this topic to <a class=\"stream-topic\" data-stream-id=\"458659\" href=\"/#narrow/channel/458659-Equational/topic/Project.20language.20stats/with/512024337\">#Equational &gt; Project language stats</a> by <span class=\"user-mention silent\" data-user-id=\"466334\">Shreyas Srinivas</span>.</p>",
        "id": 512062430,
        "sender_full_name": "Notification Bot",
        "timestamp": 1744632472
    }
]