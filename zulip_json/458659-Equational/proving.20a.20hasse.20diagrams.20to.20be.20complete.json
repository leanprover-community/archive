[
    {
        "content": "<p>I think the process is something like:</p>\n<ul>\n<li>Maintain a set S of missing laws and a frontier F of the hasse diagram (working bottom up)</li>\n<li>Initialize S to the set of all laws and F to the empty set</li>\n<li>On each step you may do one of following:<ul>\n<li>Remove an element <code>a</code> of S, prove it is equivalent to an element <code>b</code> of F and drop <code>a</code></li>\n<li>Remove an element <code>a</code> of S and add it to <code>F</code></li>\n<li>Take an element <code>a</code> of <code>F</code>, prove <code>a -&gt; b</code> for some other <code>b</code> in F and <code>c !-&gt; a</code> for all other <code>c</code> in F and drop <code>a</code></li>\n</ul>\n</li>\n<li>The process stops when S is empty and <code>F</code> is the singleton {Law1}</li>\n</ul>\n<p>I claim that if this process can run to completion, then we have completeness</p>",
        "id": 477832777,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729366773
    },
    {
        "content": "<p>the invariant is that for every law, either it is in <code>S</code>, or it is below an element of <code>F</code> (call <code>B</code> the set of elements strictly below some element of <code>F</code>), and for any two laws, if both are in <code>B</code>, or if one is in <code>B</code> and the other is in <code>F</code>, then we have determined their implication or nonimplication</p>",
        "id": 477833000,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729367004
    },
    {
        "content": "<p>I must read the rules wrongly: I move all elements from S to F by rule 2, and then remove all but Law2 from it.</p>",
        "id": 477833603,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729367584
    },
    {
        "content": "<p>yeah no I'm missing a step, I think you also need to prove <code>c !-&gt; a</code> for all <code>c</code> in F when dropping <code>a</code> in rule 3</p>",
        "id": 477833692,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729367661
    },
    {
        "content": "<p>but this is too conservative</p>",
        "id": 477833701,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729367669
    },
    {
        "content": "<p>(typo, the top of the lattice is Law1 not Law2)</p>",
        "id": 477833818,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729367779
    },
    {
        "content": "<p>Thinking graphically, it seems sufficient to proof an anti implication from a node to all maximal nodes in the graph of unreachable nodes. And it seems that we only need to look at nodes that are not “below-dominated” by another node. (Sorry, this is still vague)</p>",
        "id": 477834167,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729368073
    },
    {
        "content": "<p>what is a maximal node in the graph of unreachable nodes?</p>",
        "id": 477834249,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729368147
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/channel/458659-Equational/topic/A.20final.20end-to-end.20theorem.20in.20Lean/near/477834249\">said</a>:</p>\n<blockquote>\n<p>what is a maximal node in the graph of unreachable nodes?</p>\n</blockquote>\n<p>Sorry, on the phone here, so hard to type a lot.</p>\n<p>The maximal elements of <code>A \\ { b |  a known to imply b }</code>. Because if we know that a does not imply these, it cannot imply anything else that we claim it doesn't imply.</p>",
        "id": 477834473,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729368385
    },
    {
        "content": "<p>Agreed. The trouble is that we don't want to actually compute that set for every node</p>",
        "id": 477834526,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729368464
    },
    {
        "content": "<p>nor figure out what its maximal elements are, at least explicitly</p>",
        "id": 477834577,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729368486
    },
    {
        "content": "<p>The idea with the \"frontier\" is that we can sweep an antichain across the graph and determine these properties \"on-line\" as they pass by</p>",
        "id": 477834600,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729368525
    },
    {
        "content": "<p>Is there a min-cut/max-flow argument we can make here, for a divide and conquer algorithm? :-D (ransom guess)</p>",
        "id": 477834717,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729368618
    },
    {
        "content": "<p>For a small example, consider the diagram</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"mi\">1</span>\n<span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"bp\">\\</span>\n<span class=\"n\">b</span><span class=\"w\">   </span><span class=\"bp\">|</span>\n<span class=\"bp\">|</span><span class=\"w\">   </span><span class=\"n\">c</span>\n<span class=\"n\">a</span><span class=\"w\">   </span><span class=\"bp\">|</span>\n<span class=\"bp\">\\</span><span class=\"w\">  </span><span class=\"bp\">/</span>\n<span class=\"w\">  </span><span class=\"mi\">0</span>\n</code></pre></div>\n<p>The minimal implications we need here are all the edges of the graph, plus the non-edges <code>a !-&gt; c</code> and <code>c !-&gt; b</code></p>",
        "id": 477834786,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729368715
    },
    {
        "content": "<p>And b! -&gt; a. Or are these implied?</p>",
        "id": 477834836,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729368738
    },
    {
        "content": "<p>for each edge of the graph we have to explicitly prove implication and reverse non-implication</p>",
        "id": 477834867,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729368772
    },
    {
        "content": "<p>Sounds like if we find a horizontal cut in the graph, prove the nodes on this cut to be mutual non-implied, then we can continue with the two halfs separately?</p>",
        "id": 477834931,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729368841
    },
    {
        "content": "<p>right, that's the role of the frontier F</p>",
        "id": 477834980,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729368857
    },
    {
        "content": "<p>For the invariant there are a few options for whether we should know implication and non-implication between two elements of F, between an element of B and an element of F, or between an element of F and an element of B</p>",
        "id": 477835105,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729368961
    },
    {
        "content": "<p>depending on which of those you pick you get different algorithms which have to assert things as they enter F or when they leave F</p>",
        "id": 477835170,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729368992
    },
    {
        "content": "<p>Ok, but maybe instead of sweeping, it makes sense to think of it as dividing and conquering? Recursively finding the smallest cut, and looking at both halfs? Maybe that's more efficient, or yields an inductive description of the graph that's easy to check?</p>",
        "id": 477835181,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729369001
    },
    {
        "content": "<p>I don't think it can be divided and conquered left-to-right, only top and bottom, so it ends up as a sweep in the end</p>",
        "id": 477835251,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729369070
    },
    {
        "content": "<p>you can break that proof into a tree shape of course</p>",
        "id": 477835303,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729369085
    },
    {
        "content": "<p>you just snapshot the state in the middle of the algorithm and use that for your divide and conquer</p>",
        "id": 477835330,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729369116
    },
    {
        "content": "<p>Not sure. If I have two unconnected graphs, then I can horizontally compose then after checking that rhe top elements of one graph don't imply the bottom elements of rhe other graph, and vice versa</p>",
        "id": 477835397,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729369162
    },
    {
        "content": "<p>hm, you might be on to something. But I think it gets a lot more complicated to figure out what elements to compare with what other elements if the two subgraphs are not unconnected</p>",
        "id": 477835798,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729369454
    },
    {
        "content": "<p>e.g. try doing this for the cube lattice</p>",
        "id": 477835806,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729369468
    },
    {
        "content": "<p>Then you maybe have to cut horizontally, ideally at a min-cut, until it's falls apart some more?</p>",
        "id": 477835940,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729369594
    },
    {
        "content": "<p>Maybe that ends up doing the sweep :-)</p>",
        "id": 477835970,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729369638
    },
    {
        "content": "<p>in particular there are no quadratic steps in the sweep algorithm, so it's clear how you can control things by keeping the frontier small</p>",
        "id": 477836084,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729369772
    },
    {
        "content": "<p>when you cut vertically you might have a quadratic number of things to check and so it's not clear you have really conquered with your dividing</p>",
        "id": 477836168,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729369826
    },
    {
        "content": "<p>(of course they are both worst case quadratic since in the totally disconnected graph there are no shortcuts)</p>",
        "id": 477836221,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729369886
    },
    {
        "content": "<p>I think the trouble with the frontier algorithm is that it is optimized for the case where the frontier is an antichain and it's not clear how to make use of implications inside the frontier. I think what you need instead is something like a high <code>H</code> and low <code>L</code> set for the frontier, where <code>L</code> contains the elements of <code>F</code> not above another element of <code>F</code>, and <code>H</code> contains the elements of <code>F</code> not below an element of <code>F</code>. Then, when removing an element from <code>F</code> it suffices to check that it is not above every element of <code>L</code> and not below every element of <code>H</code>. I'll have to think about how to make the steps in this refined algorithm more precise</p>",
        "id": 477837070,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729370818
    },
    {
        "content": "<p>(For example, in the 5 point lattice above, if F is <code>{a, b, c}</code> then <code>L</code> is <code>{a, c}</code> and <code>H</code> is <code>{b, c}</code>)</p>",
        "id": 477837094,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729370881
    },
    {
        "content": "<p>That sounds good</p>",
        "id": 477837597,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729371367
    },
    {
        "content": "<p>36 messages were moved here from <a class=\"stream-topic\" data-stream-id=\"458659\" href=\"/#narrow/channel/458659-Equational/topic/A.20final.20end-to-end.20theorem.20in.20Lean\">#Equational &gt; A final end-to-end theorem in Lean</a> by <span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span>.</p>",
        "id": 477837639,
        "sender_full_name": "Notification Bot",
        "timestamp": 1729371427
    },
    {
        "content": "<p>it's not yet clear to me whether elements sandwiched between <code>H</code> and <code>L</code>, e.g. if I added <code>a -&gt; a' -&gt; b</code> in the 5 point diagram, are done and dusted or whether we need to keep track of them for a while longer</p>",
        "id": 477838139,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729371928
    },
    {
        "content": "<p>How about this algorithm:<br>\nLet H be a Hasse diagram with more than one element. Let U and L be the maximal resp. minimal elements of H. Prove <code>a /-&gt; b</code> for <code>a ∈ U</code> and <code>b ∈ L</code>, <code>a ≠ b</code>. (It seems that these anti-implications are unavoidable to check, because there is no other anti-implication that we can check to prove them.). Now split the graph into its connected components, and then remove U and L from the graph, and repeat. (It seems important to split into connected components before removing the max and min elements.)</p>\n<p>In your example above it would prove <code>1 /→ 0</code> in the first step, and then <code>b /-&gt; c</code> <code>b /-&gt; a</code> <code>c /→ a</code> in the second step, seems legit, but maybe not optimal yet? Also I’m not sure if removing both U and L at the same time is ok? But it’s getting late and brain doesn’t work well anymore.</p>",
        "id": 477838662,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729372437
    },
    {
        "content": "<p>Hmm, probably bogus. It may be true that there anti implications are necessary to check, but not that we can then remove these maximum/minimum nodes.</p>",
        "id": 477839637,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729373434
    },
    {
        "content": "<p>Proving <code>1 !-&gt; 0</code> means it's not optimal</p>",
        "id": 477839854,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729373673
    },
    {
        "content": "<p>because that is definitely not in the transitive reduction</p>",
        "id": 477839861,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729373688
    },
    {
        "content": "<p>Depends on whether we assume the implications to be strict to begin with. But if we don't then the algorithm misses anti-implications it has to check. So nevermind.</p>\n<p>But the following is at least true, isn't it:<br>\nIf H is not connected, then proving anti-implications from every minimal element to every maximal element in a different component suffices and is necessary to then consider each component separately.</p>",
        "id": 477840238,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729374081
    },
    {
        "content": "<p>Because adding any implication between the components would contradict one of these anti-implications, and none of them entail any other?</p>",
        "id": 477840339,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729374180
    },
    {
        "content": "<p>Ah, related to this: If a is minimal and b is maximal in H without a path from a to b, then the anti-implications a /-&gt; b cannot be inferred by anything else, so it has to be proven.</p>\n<p>And proving it for all such bs entails all anti-implications from a, so we can drop a from the graph. But that's somehow throwing away information, because we actually proved all anti-implications between nodes above a to nodes below b. Does that mean we can then separate the subgraph above a and recourse on the two parts? Not quite, for that we need to show anti-implications to all elements that are maximal in H without the cone above a. And with that I ran into a circle of ideas.</p>\n<p>Although, if indeed</p>\n<ul>\n<li>the anti-implications from a minimal element to the maximal elements of H without the cone above are necessary (and it seems like they are), and </li>\n<li>if checking them allows me to cut away that cone and recurse (removing a in this step),</li>\n</ul>\n<p>then this would give an optional greedy algorithm, wouldn't it?</p>\n<p>Ah, but I can't quite cut yet. I know I don't need to look at any more edges from the cone to the outside of it, but I still need to check some edges from other remainder into the cone as well. Hmm. The first assumption may still hold and tell us a bunch of non-implications that we must check. Unclear only how to then proceed.</p>",
        "id": 477841292,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729375167
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/channel/458659-Equational/topic/proving.20a.20hasse.20diagrams.20to.20be.20complete/near/477840238\">said</a>:</p>\n<blockquote>\n<p>Depends on whether we assume the implications to be strict to begin with. But if we don't then the algorithm misses anti-implications it has to check. So nevermind.</p>\n</blockquote>\n<p>Just to be a bit more formal here, the criteria I am looking for in this (nondeterministic) algorithm is that if I have a Hasse diagram and give it a transitively reduced set of base facts whose transitive closure is complete, then there exists some accepting path which only requires the given base facts.</p>",
        "id": 477842726,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729376512
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/channel/458659-Equational/topic/proving.20a.20hasse.20diagrams.20to.20be.20complete/near/477840238\">said</a>:</p>\n<blockquote>\n<p>If H is not connected, then proving anti-implications from every minimal element to every maximal element in a different component suffices and is necessary to then consider each component separately.</p>\n</blockquote>\n<p>Yes, this is true, but it doesn't look like a general case to me. Maybe you have another trick?</p>",
        "id": 477843106,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729376843
    },
    {
        "content": "<p>I think it is better to think one element at a time instead of trying to cut the graph into sub-pieces, I don't think that's going to work because you don't know which base edges you need to check except in specific situations. The whole proof should still end up O(e log n) large and O(log n) deep if this is done right</p>",
        "id": 477843585,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729377303
    },
    {
        "content": "<p>No, it's not a general case, but it's always a useful move if H is not connected, in the sense that it's correct and not wasteful to look at each component separately.</p>\n<p>Another valid move is to remove unique top and unique bottom elements.</p>\n<p>Our graph with top and bottom removed, does that maybe fall into many small components?</p>\n<p>So maybe it helps to think about diagrams that are connected and have at multiple minimal and multiple maximal elements. For these I think can identify anti-implications that I have to check, but I don't see yet how to then continue.</p>\n<p>Anyways, bedtime</p>",
        "id": 477843622,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729377345
    },
    {
        "content": "<p>again, consider the cube graph, after you take off the top and bottom you end up with something that has a bunch of edges and no disconnection</p>",
        "id": 477843690,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729377393
    },
    {
        "content": "<p>Right, I'm not saying that this is a complete procedure. So far merely that taking off tops and bottoms and splitting into components, when possible, is never bad (as in wrong, or leading to checking more anti-implications than necessary).</p>",
        "id": 477844073,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729377788
    },
    {
        "content": "<p>The minimals-to-maximals-in-cocone rule in the capped cube says we have to check from lower corners to their opposite upper corner, so that's at least looks correct.</p>",
        "id": 477844202,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1729377920
    },
    {
        "content": "<p>taxi cab numbers, how do you figure?</p>",
        "id": 477845483,
        "sender_full_name": "Hugo Angulo",
        "timestamp": 1729379136
    },
    {
        "content": "<p>Here's an example sweep through the cube graph, together with the minimal base facts and approximately when they need to be asserted:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">      </span><span class=\"mi\">7</span>\n<span class=\"w\">    </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">\\</span>\n<span class=\"w\">  </span><span class=\"mi\">3</span><span class=\"w\">   </span><span class=\"mi\">5</span><span class=\"w\">   </span><span class=\"mi\">6</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\">   </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">|</span>\n<span class=\"w\">  </span><span class=\"mi\">1</span><span class=\"w\">   </span><span class=\"mi\">2</span><span class=\"w\">   </span><span class=\"mi\">4</span>\n<span class=\"w\">    </span><span class=\"bp\">\\</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">/</span>\n<span class=\"w\">      </span><span class=\"mi\">0</span>\n\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">},</span><span class=\"w\">        </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">},</span><span class=\"w\">        </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">},</span><span class=\"w\">        </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">},</span><span class=\"w\">     </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">},</span><span class=\"w\">        </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">},</span><span class=\"w\">        </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">}</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">},</span><span class=\"w\">     </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">},</span><span class=\"w\">     </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">4</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"mi\">6</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">4</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">},</span><span class=\"w\">     </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">!&gt;</span><span class=\"w\"> </span><span class=\"mi\">6</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">},</span><span class=\"w\">     </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">!&gt;</span><span class=\"w\"> </span><span class=\"mi\">3</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">!&gt;</span><span class=\"w\"> </span><span class=\"mi\">5</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">7</span><span class=\"o\">},</span><span class=\"w\">        </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"mi\">7</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">6</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">7</span><span class=\"o\">},</span><span class=\"w\">        </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">7</span><span class=\"o\">}</span>\n</code></pre></div>",
        "id": 477846260,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729379917
    },
    {
        "content": "<p>This isn't exactly an algorithm because I haven't said what the legal moves are, but the invariants it wants to preserve are:</p>\n<ol>\n<li>Every path from 0 to 7 intersects <code>U ∪ L</code> somewhere</li>\n<li>the downward closure of <code>U ∪ L</code> is monotonically increasing</li>\n<li><code>U</code> and <code>L</code> are antichains (although as you can tell from when facts are asserted, the algorithm doesn't prove this)</li>\n<li>Every element of <code>U</code> is above some element of <code>L</code> and every element of <code>L</code> is below some element of <code>U</code></li>\n<li>Every condition between elements strictly below <code>U ∪ L</code> has been checked</li>\n</ol>\n<p>There is an additional invariant I don't quite understand: at one point I tried to have <code>U = {3, 5}</code> and <code>L = {2, 4}</code>, but this is an invalid state because we will miss the chance to assert <code>1 !&gt; 6</code> non-implication if we pass through this state. I think we also need paths from 0 to 7 that include non-implication base facts to intersect <code>U ∪ L</code></p>",
        "id": 477846750,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729380389
    },
    {
        "content": "<p>Here's a variation where facts are asserted only when they leave the lower set, meaning that invariant 4 is also true but with deferred proof:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">},</span><span class=\"w\">        </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">},</span><span class=\"w\">        </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">},</span><span class=\"w\">     </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">},</span><span class=\"w\">     </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">}</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">},</span><span class=\"w\">     </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">}</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">}</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">},</span><span class=\"w\">     </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">!&gt;</span><span class=\"w\"> </span><span class=\"mi\">6</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">},</span><span class=\"w\">     </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">!&gt;</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">4</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">},</span><span class=\"w\">  </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">!&gt;</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">7</span><span class=\"o\">},</span><span class=\"w\">        </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"o\">}</span>\n<span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">7</span><span class=\"o\">},</span><span class=\"w\">        </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">7</span><span class=\"o\">},</span><span class=\"w\">        </span><span class=\"mi\">7</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">6</span>\n</code></pre></div>\n<p>This looks a bit more implementable, since now you can see the checks like <code>3 &gt; 1, 5 &gt; 1, 1 !&gt; 6</code> as being an iteration over <code>U</code></p>",
        "id": 477850007,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729383764
    }
]