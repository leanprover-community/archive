[
    {
        "content": "<p>I'm automatically generating some proofs of non-implications and I'd like to first filter out results that have already been established.</p>\n<p>What I'm doing so far is along the lines of</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">equational_theories</span><span class=\"bp\">.</span><span class=\"n\">Closure</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">extractResults</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CoreM</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">searchPathRef</span><span class=\"bp\">.</span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">compile_time_search_path</span><span class=\"bp\">%</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">importModules</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"ss\">`equational_theories</span><span class=\"w\"> </span><span class=\"o\">},</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"ss\">`equational_theories.Equations.All</span><span class=\"w\"> </span><span class=\"o\">}]</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">empty</span>\n<span class=\"w\">  </span><span class=\"n\">withEnv</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">eqnThms</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Result</span><span class=\"bp\">.</span><span class=\"n\">extractEquationalResults</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Closure</span><span class=\"bp\">.</span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">eqnThms</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">Entry</span><span class=\"bp\">.</span><span class=\"n\">variant</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">nonImplications</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">closure</span><span class=\"bp\">.</span><span class=\"n\">filterMap</span><span class=\"w\"> </span><span class=\"k\">fun</span>\n<span class=\"w\">        </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">implication</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">none</span>\n<span class=\"w\">        </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">nonimplication</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">e</span>\n</code></pre></div>\n<p>However, my outputs contain far more results than I'd expect, which makes me think that the filtering is not happening correctly (though it definitely seems to be happening to some extent). Am I extracting the results correctly, or is there some other function that I should be calling? Does the environment that I've chosen to run the computation in contain all the results proved in the project so far? Any help would be appreciated.</p>",
        "id": 476520530,
        "sender_full_name": "Anand Rao Tadipatri",
        "timestamp": 1728735853
    },
    {
        "content": "<p>Actually, I now have reason to believe that I'm gathering these results correctly after all, and that the high count is coming from considering equations that aren't a part of the initial set of 4694 equations.</p>",
        "id": 476521371,
        "sender_full_name": "Anand Rao Tadipatri",
        "timestamp": 1728736654
    },
    {
        "content": "<p>There are not many implications for the sporadic equations in the closure last time I checked. My local results are:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">egrep</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"s2\">\"(5105|28381|374794)\"</span><span class=\"w\"> </span><span class=\"bp\">../</span><span class=\"n\">equational_theories</span><span class=\"bp\">/</span><span class=\"n\">main_implications</span><span class=\"bp\">.</span><span class=\"n\">closure</span><span class=\"bp\">.</span><span class=\"n\">csv</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">wc</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">l</span>\n<span class=\"w\"> </span><span class=\"mi\">8173585</span>\n</code></pre></div>",
        "id": 476521544,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1728736817
    },
    {
        "content": "<p>Does that match what you see? Without filtering sporadic equations I see 8178144.</p>",
        "id": 476521575,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1728736863
    },
    {
        "content": "<p>how does this relate to <code>extract_implications.lean</code>?</p>",
        "id": 476522007,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1728737320
    },
    {
        "content": "<p>Actually I guess my closure data is slightly dated, 28381 was deleted from main on Thursday. Anyways extract_implications --closure (with or without --only-implications) should tell you the ground truth.</p>",
        "id": 476522754,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1728738043
    },
    {
        "content": "<p>I find the output of the <code>outcomes</code> sub-command useful, it's a large table that says whether an implication is known, whether it appears explicitly or through inference, and whether a conjecture is needed to know it</p>",
        "id": 476523538,
        "sender_full_name": "Amir Livne Bar-on",
        "timestamp": 1728738821
    }
]