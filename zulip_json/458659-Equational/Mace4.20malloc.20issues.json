[
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"761825\">Jose Brox</span> <a href=\"#narrow/channel/458659-Equational/topic/FINITE.3A.20677.20-.3E.20255/near/494043681\">said</a>:</p>\n<blockquote>\n<p>Here we find a wall I've been hitting a few times with Prover9/Mace4: no matter what memory limit you set up (even unlimited), it seems that it allows an absolute maximum of 1GB, and ignores any quantity above that.</p>\n</blockquote>\n<p>I'll look into this. IIRC Mace4 uses LADR's memory manager to allocate its assignments, and the latter has some default limitations, but setting <code>max_megs</code> explicitly should disable all that. Does <code>mace4</code> return with a <code>max_megs</code> error, or does it just silently never allocate above 1gig?</p>\n<p>First things that occured to me: some env weirdness (<code>ulimit</code>?); or if you're on Windows perhaps your <code>mace4.exe</code> is a 32-bit PE (which would cap your memory severely, but still above 1g). I'll have to see if I can reproduce it, can you send me a test file which should cause mace4 to allocate more than 1g?</p>",
        "id": 494092187,
        "sender_full_name": "Zoltan A. Kocsis (Z.A.K.)",
        "timestamp": 1737017217
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"763356\">Zoltan A. Kocsis (Z.A.K.)</span> <a href=\"#narrow/channel/458659-Equational/topic/FINITE.3A.20677.20-.3E.20255/near/494092187\">ha dicho</a>:</p>\n<blockquote>\n<p>I'll look into this.</p>\n</blockquote>\n<p>Sorry for not giving enough details yesterday (I'm extremely busy with paperwork this month <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span>). The phenomenon may be subtler: it feels like in Mace4 there may be an \"initialization\" memory limit (for the initial processing of non-clausal formulas, etc.), which is the one that seems to be fixed, and a \"running\" memory limit, which can be higher and controlled by the max_megs parameter, both in the GUI under Windows and the command line under Ubuntu (no virtual machine involved, I'm using two separate computers), but with differences. The exit error is always</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">palloc</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Max_megs</span><span class=\"w\"> </span><span class=\"n\">parameter</span><span class=\"w\"> </span><span class=\"n\">exceeded</span>\n</code></pre></div>\n<p>I hadn't looked enough into this, now I've made some checks: In Windows, looking at both the task manager and the performance monitor, the initialization error seems to happen around just 40-50MB of used RAM (although I also saw a 250MB spike in the task manager).<br>\n<a href=\"/user_uploads/3121/qA0xHDMxhuM6-drllIej4ZVE/Mace4-max-memory.JPG\">Mace4 max memory.JPG</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/qA0xHDMxhuM6-drllIej4ZVE/Mace4-max-memory.JPG\" title=\"Mace4 max memory.JPG\"><img data-original-content-type=\"image/jpeg\" data-original-dimensions=\"691x502\" src=\"/user_uploads/thumbnail/3121/qA0xHDMxhuM6-drllIej4ZVE/Mace4-max-memory.JPG/840x560.webp\"></a></div><p>In contrast, in Ubuntu the error seems to happen at 550MB. I think this is not a ulimit problem:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>josebrox:~$<span class=\"w\"> </span><span class=\"nb\">ulimit</span>\nunlimited\njosebrox:~$<span class=\"w\"> </span><span class=\"nb\">time</span><span class=\"w\"> </span>nice<span class=\"w\"> </span>LADR-2009-11A/bin/mace4<span class=\"w\"> </span>-b<span class=\"w\"> </span><span class=\"m\">20000</span><span class=\"w\"> </span>-c<span class=\"w\"> </span>-f<span class=\"w\"> </span><span class=\"s2\">\"MACE4 677 anti 255 translation-invariant all f explicited groups order 16\"</span><span class=\"w\"> </span><span class=\"p\">|</span><span class=\"w\"> </span>LADR-2009-11A/bin/interpformat<span class=\"w\"> </span>standard<span class=\"w\"> </span>&gt;<span class=\"w\"> </span><span class=\"s2\">\"MACE4 677 anti 255 translation-invariant all f explicited groups order 16.out\"</span>\n\nFatal<span class=\"w\"> </span>error:<span class=\"w\">  </span>palloc,<span class=\"w\"> </span>Max_megs<span class=\"w\"> </span>parameter<span class=\"w\"> </span>exceeded\n\nCommand<span class=\"w\"> </span>exited<span class=\"w\"> </span>with<span class=\"w\"> </span>non-zero<span class=\"w\"> </span>status<span class=\"w\"> </span><span class=\"m\">1</span>\n<span class=\"w\">    </span><span class=\"m\">0</span>:26.40<span class=\"w\"> </span>real,<span class=\"w\">   </span><span class=\"m\">26</span>.17<span class=\"w\"> </span>user,<span class=\"w\"> </span><span class=\"m\">0</span>.14<span class=\"w\"> </span>sys,<span class=\"w\">   </span><span class=\"m\">0</span><span class=\"w\"> </span>amem,<span class=\"w\"> </span><span class=\"m\">566060</span><span class=\"w\"> </span>mmem\n</code></pre></div>\n<p>Here in the last line, we see the maximum used memory was 566MB, while in the first line you see I called mace4 with max_megs = 2000MB.</p>\n<p>I have other Mace4 runs that, after initialization, have increased to 2GB of physical memory:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"w\">    </span>PID<span class=\"w\"> </span>USER<span class=\"w\">      </span>PR<span class=\"w\">  </span>NI<span class=\"w\">    </span>VIRT<span class=\"w\">    </span>RES<span class=\"w\">    </span>SHR<span class=\"w\"> </span>S<span class=\"w\">  </span>%CPU<span class=\"w\">  </span>%MEM<span class=\"w\">     </span>TIME+<span class=\"w\"> </span>COMMAND\n<span class=\"m\">1891056</span><span class=\"w\"> </span>josebrox<span class=\"w\">  </span><span class=\"m\">20</span><span class=\"w\">   </span><span class=\"m\">0</span><span class=\"w\"> </span><span class=\"m\">2136376</span><span class=\"w\">   </span><span class=\"m\">2</span>.0g<span class=\"w\">   </span><span class=\"m\">2076</span><span class=\"w\"> </span>R<span class=\"w\">  </span><span class=\"m\">99</span>.0<span class=\"w\">   </span><span class=\"m\">0</span>.4<span class=\"w\">  </span><span class=\"m\">41191</span>:08<span class=\"w\"> </span>mace4\n<span class=\"m\">1892869</span><span class=\"w\"> </span>josebrox<span class=\"w\">  </span><span class=\"m\">20</span><span class=\"w\">   </span><span class=\"m\">0</span><span class=\"w\"> </span><span class=\"m\">2133600</span><span class=\"w\">   </span><span class=\"m\">2</span>.0g<span class=\"w\">   </span><span class=\"m\">2104</span><span class=\"w\"> </span>R<span class=\"w\">  </span><span class=\"m\">99</span>.3<span class=\"w\">   </span><span class=\"m\">0</span>.4<span class=\"w\">  </span><span class=\"m\">41105</span>:48<span class=\"w\"> </span>mace4\n.\n.\n.\n</code></pre></div>\n<p>And the system has 500GB of RAM of which 275GB are free, so there is no problem there.</p>\n<p>For Prover9, the problem looks similar but is different: IIRC, it is a<br>\n<code>palloc, max_number_vars exceeded</code> error... but this parameter is set to -1 (so unlimited). Tends to happen with first-order formulas involving bijectivity (for finiteness assumptions).</p>\n<p>I attach the script that needs more than 556MB at the initialization process:<br>\n<a href=\"/user_uploads/3121/z-GgiJu0TaYPK3hp0Ry6OUWi/MACE4-677-anti-255-translation-invariant-all-f-explicited-groups-order-16\">MACE4 677 anti 255 translation-invariant all f explicited groups order 16</a></p>",
        "id": 494131065,
        "sender_full_name": "Jose Brox",
        "timestamp": 1737029912
    },
    {
        "content": "<p>2 messages were moved here from <a class=\"stream-topic\" data-stream-id=\"458659\" href=\"/#narrow/channel/458659-Equational/topic/FINITE.3A.20677.20-.3E.20255\">#Equational &gt; FINITE: 677 -&gt; 255</a> by <span class=\"user-mention silent\" data-user-id=\"763356\">Zoltan A. Kocsis (Z.A.K.)</span>.</p>",
        "id": 494131755,
        "sender_full_name": "Notification Bot",
        "timestamp": 1737030120
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"761825\">@Jose Brox</span>  I think I know why this happens. The search phase of Mace4 explicitly turns off the LADR memory allocator's built-in limits, but other passes may simply fail to do this. My first idea is to recompile LADR with the limit set to some high_number, and see if this fixes the issue.</p>",
        "id": 494132041,
        "sender_full_name": "Zoltan A. Kocsis (Z.A.K.)",
        "timestamp": 1737030193
    }
]