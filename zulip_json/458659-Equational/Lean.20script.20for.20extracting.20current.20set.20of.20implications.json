[
    {
        "content": "<p>I opened a PR adding a new Lean script <code>extract_implications.lean</code>: <a href=\"https://github.com/teorth/equational_theories/pull/22\">https://github.com/teorth/equational_theories/pull/22</a></p>",
        "id": 473150651,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727453557
    },
    {
        "content": "<p>The idea is to move the logic that's currently in <code>process_implications.py</code> into Lean, so that we can be much more precise about the analysis.</p>",
        "id": 473150809,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727453610
    },
    {
        "content": "<p>Ah, so basically what’s discussed in <a href=\"#narrow/stream/458659-Equational/topic/Refactoring.20the.20Lean.20file.20structure/near/473148427\">https://leanprover.zulipchat.com/#narrow/stream/458659-Equational/topic/Refactoring.20the.20Lean.20file.20structure/near/473148427</a>. Nice.</p>",
        "id": 473150873,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727453626
    },
    {
        "content": "<p>yeah, it's a minimal first step in that direction</p>",
        "id": 473151020,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727453652
    },
    {
        "content": "<p>Somehow running the script seems to require a working local rust installation, because of <code>egg</code>. Is it possible to set it up so that the script works without that?</p>",
        "id": 473351722,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727532427
    },
    {
        "content": "<p>See the discussion in <a class=\"stream-topic\" data-stream-id=\"458659\" href=\"/#narrow/stream/458659-Equational/topic/Adding.20the.20egg.20repository.20as.20a.20dependency\">#Equational &gt; Adding the egg repository as a dependency</a></p>",
        "id": 473352051,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727532647
    },
    {
        "content": "<p>Do you know how we can extract <code>proof_wanted</code> statements? They're run in <code>withoutModifyingEnv</code>, so I'm not sure how to see them</p>",
        "id": 473352254,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727532794
    },
    {
        "content": "<p>With a python script scraping the lean files <span aria-label=\"smiling devil\" class=\"emoji emoji-1f608\" role=\"img\" title=\"smiling devil\">:smiling_devil:</span></p>",
        "id": 473352285,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727532833
    },
    {
        "content": "<p>Or by writing out own <code>implication_wanted</code> command that stores the data in an environment extension.</p>",
        "id": 473352340,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727532850
    },
    {
        "content": "<p>(I think we might actually eventually want something like that in <code>proof_wanted</code> itself so that we could e.g. have a page with all <code>proof_wanted</code> statements in the mathlib docs.)</p>",
        "id": 473352466,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1727532958
    },
    {
        "content": "<p>I didn't expect that our first contribution to Mathlib from this project was an update to <code>proof_wanted</code> <span aria-label=\"joy\" class=\"emoji emoji-1f602\" role=\"img\" title=\"joy\">:joy:</span></p>",
        "id": 473352683,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727533115
    },
    {
        "content": "<p>I think it's in batteries, actually</p>",
        "id": 473352694,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727533135
    },
    {
        "content": "<p>indeed, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=proof_wanted#doc\">docs#proof_wanted</a></p>",
        "id": 473352757,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727533197
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/stream/458659-Equational/topic/Lean.20script.20for.20extracting.20current.20set.20of.20implications/near/473351722\">said</a>:</p>\n<blockquote>\n<p>Somehow running the script seems to require a working local rust installation, because of <code>egg</code>. Is it possible to set it up so that the script works without that?</p>\n</blockquote>\n<p>Is that only if you use <code>lake exe</code>? What if you run the executable directly?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">extract_implications</span>\n</code></pre></div>",
        "id": 473355089,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727534710
    },
    {
        "content": "<p>Ah, good idea! Away from the keyboard until tomorrow, but I'll try then.</p>",
        "id": 473357782,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727536761
    },
    {
        "content": "<p>Is there an easy way to add rust to the gitpod instance so that this just works?</p>",
        "id": 473364235,
        "sender_full_name": "Leo Shine",
        "timestamp": 1727541670
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/stream/458659-Equational/topic/Lean.20script.20for.20extracting.20current.20set.20of.20implications/near/473352340\">said</a>:</p>\n<blockquote>\n<p>Or by writing out own <code>implication_wanted</code> command that stores the data in an environment extension.</p>\n</blockquote>\n<p>I'm not sure what data should be saved there, and how to get it from the macro. Is someone able to do this?</p>",
        "id": 473366022,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727543090
    },
    {
        "content": "<p>Stashing a fully-qualified name should be straightforward.</p>",
        "id": 473366542,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727543427
    },
    {
        "content": "<p>I can do this, right now I feel stuck on naming, because <code>implication_wanted</code> seems not quite right.</p>",
        "id": 473366599,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727543470
    },
    {
        "content": "<p>The type is also needed to figure out what it implies/refutes</p>",
        "id": 473366630,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727543485
    },
    {
        "content": "<p>I was thinking we would make a new <code>command_elab</code> (i.e. not just a macro that expands to <code>proof_wanted</code>).</p>",
        "id": 473366705,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727543529
    },
    {
        "content": "<p>Then we should get full access to the environment and be able to grab type information.</p>",
        "id": 473366720,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727543545
    },
    {
        "content": "<p><code>conjecture</code> perhaps? I believe that's not already reserved in Lean.  Or <code>claim</code></p>",
        "id": 473366747,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727543581
    },
    {
        "content": "<p>or maybe just <code>proof_wanted'</code>, on the theory that eventually the functionality will get upstreamed.</p>",
        "id": 473366870,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727543665
    },
    {
        "content": "<p>OK, I'll choose one of these and prepare a PR.</p>",
        "id": 473366882,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727543674
    },
    {
        "content": "<p>Hi David, this tool currently only picks up implications in Subgraph.lean, but there are now also many auto-generated theorems that will be under .Generated once <a href=\"https://github.com/teorth/equational_theories/pull/73\">https://github.com/teorth/equational_theories/pull/73</a> lands, it would be nice to add those. It would also be nice to print the transitive closure of all implications, but that can probably be done externally.</p>",
        "id": 473373610,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727548942
    },
    {
        "content": "<p>New <code>conjecture</code> command added here: <a href=\"https://github.com/teorth/equational_theories/pull/85\">equational#85</a></p>",
        "id": 473381423,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727554020
    },
    {
        "content": "<p>Extracting the type of the declaration was trickier than I anticipated! It took me a while to figure out that I needed to <code>expandModifiers</code> and then <code>expandDeclId</code> to get a name that I could pass to <code>getConstInfo</code>.</p>",
        "id": 473381581,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727554117
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"761203\">@Vlad Tsyrklevich</span> yeah, adding those should be straightforward. I can see two options for how to specify which implications should be included:</p>\n<ol>\n<li>iterate through the whole environment, as proposed here: <a href=\"https://github.com/teorth/equational_theories/pull/22#issuecomment-2379778521\">https://github.com/teorth/equational_theories/pull/22#issuecomment-2379778521</a></li>\n<li>iterate through a given set of files</li>\n</ol>",
        "id": 473382140,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727554588
    },
    {
        "content": "<ol start=\"3\">\n<li>add another command like <code>conjecture</code> with a similar environment extension, to hold proven facts about implications. This feels like the nicest option to me.</li>\n</ol>",
        "id": 473384074,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727556406
    },
    {
        "content": "<p>Here's a proposal for option 3: <a href=\"https://github.com/teorth/equational_theories/pull/93\">https://github.com/teorth/equational_theories/pull/93</a></p>",
        "id": 473398302,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727571135
    },
    {
        "content": "<p>This feels to me like the right way to do it.</p>",
        "id": 473398306,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727571147
    },
    {
        "content": "<p>I'm not sure if <code>result</code> is the best name for the command; I'm interested in any other suggestions.</p>",
        "id": 473398340,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727571202
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243791\">David Renshaw</span> <a href=\"#narrow/stream/458659-Equational/topic/Lean.20script.20for.20extracting.20current.20set.20of.20implications/near/473398340\">said</a>:</p>\n<blockquote>\n<p>I'm not sure if <code>result</code> is the best name for the command; I'm interested in any other suggestions.</p>\n</blockquote>\n<p><code>proposition</code>, perhaps?</p>",
        "id": 473404330,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727577735
    },
    {
        "content": "<p>Maybe <code>edge_theorem</code>? There are theorems about edges in our graph of interest.</p>",
        "id": 473445800,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727613802
    },
    {
        "content": "<p>or <code>graph_theorem</code></p>",
        "id": 473446199,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727614094
    },
    {
        "content": "<p>Why is this an command and not an attribute? It seems that would fit the bill nicely, more compositional, and without having users learn new commands?</p>\n<p>As for the name, maybe <code>@[equational_theories]</code>, i.e. simply the name of the project?</p>",
        "id": 473446356,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727614235
    },
    {
        "content": "<p>Attributes are more limited than full commands... but maybe we can make it work.</p>",
        "id": 473446427,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727614293
    },
    {
        "content": "<p>In an attribute handler, we get access to the theorem name and the <em>attribute</em> syntax</p>",
        "id": 473446453,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727614315
    },
    {
        "content": "<p>so we could accumulate the theorem names, and then do <em>all</em> of the analysis later, I think</p>",
        "id": 473446526,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727614341
    },
    {
        "content": "<p>What do you have to do that you cannot do in an attribute? I'd expect you check the theorem  statement whether it's the given shape and then register it with a env extension to easily find it later?</p>",
        "id": 473446539,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727614355
    },
    {
        "content": "<p>that approach did not work for <code>conjecture</code>, because nothing was saved in the environment</p>",
        "id": 473446552,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727614365
    },
    {
        "content": "<p>but I think it can work here</p>",
        "id": 473446570,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727614378
    },
    {
        "content": "<p>As far as I know, it's not possible to check the type of a theorem via an attribute <em>before</em> it's added to an env extension</p>",
        "id": 473446683,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727614453
    },
    {
        "content": "<p>all logic would need to happen upon retrieval. Which is maybe fine.</p>",
        "id": 473446696,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727614464
    },
    {
        "content": "<p>I thought the attribute handler is the code that's adding something to the env extension. So you can do whatever you want there.</p>",
        "id": 473446724,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727614487
    },
    {
        "content": "<p>I can have a closer look later today when no longer at the phone. I hope I'm not misleading here :-)</p>",
        "id": 473446879,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727614591
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/blob/3a46fd0fde0f6ae8093e3303061d312e502cee82/src/Lean/Attributes.lean#L50-L54\">https://github.com/leanprover/lean4/blob/3a46fd0fde0f6ae8093e3303061d312e502cee82/src/Lean/Attributes.lean#L50-L54</a></p>",
        "id": 473446880,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727614591
    },
    {
        "content": "<p>ah, but there's context information in <code>AttrM</code>...</p>",
        "id": 473446928,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727614636
    },
    {
        "content": "<p>Right - use the name, look up the type in the environment, do your checks, add it to the env extension</p>",
        "id": 473446931,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727614639
    },
    {
        "content": "<p>Existing attributes like <code>ext</code> could serve as guidelines</p>",
        "id": 473447017,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727614695
    },
    {
        "content": "<p>Unclear to me that <code>AttributeApplicationTime.afterCompilation</code> definitely means \"the const is in the environment now\", but I can check experimentally.</p>",
        "id": 473447035,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727614712
    },
    {
        "content": "<p><code>FunProp</code> is a nice example for me to copy: <a href=\"https://github.com/leanprover-community/mathlib4/blob/62eccbcb33b8a9fc8e7cc61cd546298b52f0c29b/Mathlib/Tactic/FunProp/Attr.lean#L23-L40\">https://github.com/leanprover-community/mathlib4/blob/62eccbcb33b8a9fc8e7cc61cd546298b52f0c29b/Mathlib/Tactic/FunProp/Attr.lean#L23-L40</a></p>",
        "id": 473447737,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727615256
    },
    {
        "content": "<p>I remember how I got the wrong idea about attributes -- a while back I tried to write an attribute for Compfiles that would need access to syntax of the declaration <em>body</em>. That turned out to be impossible (as far as I could tell), and from that experience I internalized the lesson \"attributes are underpowered\".</p>",
        "id": 473452031,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727618533
    },
    {
        "content": "<p>I marked the PR as \"ready to review\": <a href=\"https://github.com/teorth/equational_theories/pull/93\">https://github.com/teorth/equational_theories/pull/93</a></p>",
        "id": 473457638,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727622846
    },
    {
        "content": "<p>I named the attribute <code>@[equational_result]</code>, which seems reasonable to me. Open to other suggestions, but it's probably best not to bikeshed too much.</p>",
        "id": 473457667,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727622878
    },
    {
        "content": "<p>I also added some justification in the PR summary for \"why not just scan the environment for theorems that have the right shape?\"</p>",
        "id": 473457724,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727622943
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243791\">David Renshaw</span> <a href=\"#narrow/stream/458659-Equational/topic/Lean.20script.20for.20extracting.20current.20set.20of.20implications/near/473457724\">said</a>:</p>\n<blockquote>\n<p>I also added some justification in the PR summary for \"why not just scan the environment for theorems that have the right shape?\"</p>\n</blockquote>\n<p>Maybe include it also in the module docstring of <code>equational_theories/EquationalResult.lean</code>, for posterity.</p>",
        "id": 473459382,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727624207
    },
    {
        "content": "<p>added: <a href=\"https://github.com/teorth/equational_theories/pull/93/commits/5a705fdca75fbf2246d3af7e3c4f9d43b52cb92c\">https://github.com/teorth/equational_theories/pull/93/commits/5a705fdca75fbf2246d3af7e3c4f9d43b52cb92c</a></p>",
        "id": 473465878,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727627288
    },
    {
        "content": "<p>In <a href=\"https://github.com/teorth/equational_theories/pull/130\">https://github.com/teorth/equational_theories/pull/130</a> I am adjusting the script to handle the (expanded form of the) <code>Facts</code> syntax. <span class=\"user-mention\" data-user-id=\"243791\">@David Renshaw</span>  do you want to review?</p>",
        "id": 473654877,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727687395
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 473706374,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727697799
    },
    {
        "content": "<p><code>lake exe extract_implications</code> is still blocked for others by egg failing to build, right? Should it be removed for now?</p>",
        "id": 473815313,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727719901
    },
    {
        "content": "<p>It works for me.</p>",
        "id": 473817345,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727720399
    },
    {
        "content": "<p>does it work if you don't use <code>lake exe</code>?<br>\nLike this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">extract_implications</span>\n<span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">extract_implications</span>\n</code></pre></div>",
        "id": 473817567,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727720459
    },
    {
        "content": "<p>ah, I understood you to be suggesting removal of <code>extract_implications</code>, but maybe you're suggesting removing <code>egg</code>?</p>",
        "id": 473817698,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727720507
    },
    {
        "content": "<p>Nono, removing egg if it's breaking the build</p>",
        "id": 473818487,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727720768
    },
    {
        "content": "<p>Is it expected that the output has duplicates, e.g.<br>\n  {\"rhs\": \"Equation856\", \"lhs\": \"Equation1004\"},<br>\n  {\"rhs\": \"Equation856\", \"lhs\": \"Equation1004\"},</p>",
        "id": 473822778,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727721666
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 473823114,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727721722
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"761203\">Vlad Tsyrklevich</span> <a href=\"#narrow/stream/458659-Equational/topic/Lean.20script.20for.20extracting.20current.20set.20of.20implications/near/473822778\">said</a>:</p>\n<blockquote>\n<p>Is it expected that the output has duplicates, e.g.<br>\n  {\"rhs\": \"Equation856\", \"lhs\": \"Equation1004\"},<br>\n  {\"rhs\": \"Equation856\", \"lhs\": \"Equation1004\"},</p>\n</blockquote>\n<p>This is obviously because two proofs exist in the code base, I hadn't thought of it.</p>",
        "id": 473825403,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727722256
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"761203\">Vlad Tsyrklevich</span> <a href=\"#narrow/stream/458659-Equational/topic/Lean.20script.20for.20extracting.20current.20set.20of.20implications/near/473818487\">said</a>:</p>\n<blockquote>\n<p>Nono, removing egg if it's breaking the build</p>\n</blockquote>\n<p>As long as it isn't used, I'd be in favor of removing it. (I tend to remove it locally, build, and try to remember to revert before committing something)</p>",
        "id": 473840278,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727726144
    },
    {
        "content": "<p>I added egg in the beginning because at that time it wasn't clear how the project would evolve and it still seemed like a lot of handproving would be involved. My hope was to get play around with egg. Looking at the list of forks, it seems the Rosser group's GitHub account has also forked the project. I wonder if they had the same idea. </p>\n<p>Nevertheless, since then we have moved on to massive sets of automatically generated networks of implications. I'd ask <span class=\"user-mention\" data-user-id=\"315434\">@Andrés Goens</span> and if he says so, removing it might be the right thing to do.</p>",
        "id": 473846230,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727727274
    },
    {
        "content": "<p>That being said, it could be one of the explorations carried out in parallel, if we can fix the build. I believe <span class=\"user-mention\" data-user-id=\"372804\">@Marcus Rossel</span> maintains the egg repository we use.</p>",
        "id": 473846561,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727727363
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/stream/458659-Equational/topic/Lean.20script.20for.20extracting.20current.20set.20of.20implications/near/473840278\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"761203\">Vlad Tsyrklevich</span> <a href=\"#narrow/stream/458659-Equational/topic/Lean.20script.20for.20extracting.20current.20set.20of.20implications/near/473818487\">said</a>:</p>\n<blockquote>\n<p>Nono, removing egg if it's breaking the build</p>\n</blockquote>\n<p>As long as it isn't used, I'd be in favor of removing it. (I tend to remove it locally, build, and try to remember to revert before committing something)</p>\n</blockquote>\n<p>Yeah, I am already maintaining a lot of local changes so the additional <code>git stash</code> / <code>git stash pop</code> to move around adds friction</p>",
        "id": 473849489,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1727728327
    },
    {
        "content": "<p>yeah, I think we should remove the dependency if we're not using it. Might be interesting to explore in the future, but then we can have a special target for that or something similar, so it doesn't break people's builds if they didn't have a rust toolchain</p>",
        "id": 473863538,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1727732020
    },
    {
        "content": "<p>it does seem like not ideal behavior for lake to pull the dependency when it's not used, but that's a separate point I guess</p>",
        "id": 473863646,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1727732050
    },
    {
        "content": "<p>If it's causing problems for people I'd just remove it. I think it's sufficient for people to add it locally if they want to play around with it.</p>\n<p>On that note, I've been working on improving the tactic for this project and as a small experiment managed to prove 80% of the theorems in <code>Subgraph.lean</code> using <code>by set_option egg.explosion true in egg [*]</code> (more improvements to come). I haven't been able to keep up with how the project is being handled at a larger scale, so I don't know how to put the <code>egg</code> tactic to better use - but if anyone has ideas let me know :)</p>",
        "id": 473863684,
        "sender_full_name": "Marcus Rossel",
        "timestamp": 1727732064
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243791\">David Renshaw</span> <a href=\"#narrow/stream/458659-Equational/topic/Lean.20script.20for.20extracting.20current.20set.20of.20implications/near/473817567\">schrieb</a>:</p>\n<blockquote>\n<p>does it work if you don't use <code>lake exe</code>?<br>\nLike this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">extract_implications</span>\n<span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">extract_implications</span>\n<span class=\"bp\">````</span>\n\n<span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">am</span><span class=\"w\"> </span><span class=\"n\">getting</span>\n<span class=\"bp\">`</span><span class=\"ss\">``v</span><span class=\"bp\">@</span><span class=\"n\">Fenek</span><span class=\"w\"> </span><span class=\"n\">equational_theories</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">extract_implications</span>\n<span class=\"bp\">✖</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">13</span><span class=\"bp\">/</span><span class=\"mi\">30</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">egg</span><span class=\"bp\">/</span><span class=\"n\">egg_for_lean</span><span class=\"bp\">.</span><span class=\"n\">static</span>\n<span class=\"n\">trace</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">egg</span><span class=\"bp\">/</span><span class=\"n\">Rust</span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">rustc</span><span class=\"w\"> </span><span class=\"c1\">--release -- -C relocation-model=pic</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stderr</span><span class=\"o\">:</span>\n<span class=\"n\">could</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">execute</span><span class=\"w\"> </span><span class=\"n\">external</span><span class=\"w\"> </span><span class=\"n\">process</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">cargo'</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">external</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">cargo'</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">255</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">egg</span><span class=\"bp\">/</span><span class=\"n\">egg_for_lean</span><span class=\"bp\">.</span><span class=\"n\">static</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n<span class=\"n\">v</span><span class=\"bp\">@</span><span class=\"n\">Fenek</span><span class=\"w\"> </span><span class=\"n\">equational_theories</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">extract_implications</span>\n<span class=\"bp\">✖</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">15</span><span class=\"bp\">/</span><span class=\"mi\">30</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">egg</span><span class=\"bp\">/</span><span class=\"n\">egg_for_lean</span><span class=\"bp\">.</span><span class=\"n\">static</span>\n<span class=\"n\">trace</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">egg</span><span class=\"bp\">/</span><span class=\"n\">Rust</span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">rustc</span><span class=\"w\"> </span><span class=\"c1\">--release -- -C relocation-model=pic</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stderr</span><span class=\"o\">:</span>\n<span class=\"n\">could</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">execute</span><span class=\"w\"> </span><span class=\"n\">external</span><span class=\"w\"> </span><span class=\"n\">process</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">cargo'</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">external</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">cargo'</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">255</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">egg</span><span class=\"bp\">/</span><span class=\"n\">egg_for_lean</span><span class=\"bp\">.</span><span class=\"n\">static</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n</code></pre></div>\n</blockquote>",
        "id": 474186826,
        "sender_full_name": "Michael Bucko",
        "timestamp": 1727842538
    },
    {
        "content": "<p>Oh, we still haven’t removed that unused dependency? Well, here we go: <a href=\"https://github.com/teorth/equational_theories/pull/190\">https://github.com/teorth/equational_theories/pull/190</a></p>",
        "id": 474218418,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727854193
    },
    {
        "content": "<p>Hmm, how do I have to call the script now if I want the raw data (no transitive closure, facts still as compact facts and no expanded into antiimplications)? The 33MB file I get from</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">extract_implications</span><span class=\"w\"> </span><span class=\"c1\">--json equational_theories</span>\n</code></pre></div>\n<p>is hard to use.</p>\n<p>(Adding a <code>--only-imlications</code> flag as a easy and possibly useful work-around, as I only care about those at the moment.)</p>",
        "id": 474222029,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727855219
    },
    {
        "content": "<p><a href=\"https://github.com/teorth/equational_theories/pull/192\">https://github.com/teorth/equational_theories/pull/192</a></p>",
        "id": 474223982,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727855791
    },
    {
        "content": "<p>If we still want the output in the old format, this PR adds a subcommand for it:<br>\n<a href=\"https://github.com/teorth/equational_theories/pull/194\">https://github.com/teorth/equational_theories/pull/194</a></p>",
        "id": 474239435,
        "sender_full_name": "Amir Livne Bar-on",
        "timestamp": 1727859905
    },
    {
        "content": "<p>Thanks! While you are at it, can you make <code>equational_theories</code> the default  filename if none is given?</p>",
        "id": 474240500,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727860170
    },
    {
        "content": "<p>Added to the same PR</p>",
        "id": 474247520,
        "sender_full_name": "Amir Livne Bar-on",
        "timestamp": 1727862266
    },
    {
        "content": "<p>That already works for me. Had to reinstall Rust.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"672170\">Michael Bucko</span> <a href=\"#narrow/stream/458659-Equational/topic/Lean.20script.20for.20extracting.20current.20set.20of.20implications/near/474186826\">schrieb</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"243791\">David Renshaw</span> <a href=\"#narrow/stream/458659-Equational/topic/Lean.20script.20for.20extracting.20current.20set.20of.20implications/near/473817567\">schrieb</a>:</p>\n<blockquote>\n<p>does it work if you don't use <code>lake exe</code>?<br>\nLike this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">extract_implications</span>\n<span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">extract_implications</span>\n<span class=\"bp\">````</span>\n\n<span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">am</span><span class=\"w\"> </span><span class=\"n\">getting</span>\n<span class=\"bp\">`</span><span class=\"ss\">``v</span><span class=\"bp\">@</span><span class=\"n\">Fenek</span><span class=\"w\"> </span><span class=\"n\">equational_theories</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">extract_implications</span>\n<span class=\"bp\">✖</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">13</span><span class=\"bp\">/</span><span class=\"mi\">30</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">egg</span><span class=\"bp\">/</span><span class=\"n\">egg_for_lean</span><span class=\"bp\">.</span><span class=\"n\">static</span>\n<span class=\"n\">trace</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">egg</span><span class=\"bp\">/</span><span class=\"n\">Rust</span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">rustc</span><span class=\"w\"> </span><span class=\"c1\">--release -- -C relocation-model=pic</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stderr</span><span class=\"o\">:</span>\n<span class=\"n\">could</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">execute</span><span class=\"w\"> </span><span class=\"n\">external</span><span class=\"w\"> </span><span class=\"n\">process</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">cargo'</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">external</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">cargo'</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">255</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">egg</span><span class=\"bp\">/</span><span class=\"n\">egg_for_lean</span><span class=\"bp\">.</span><span class=\"n\">static</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n<span class=\"n\">v</span><span class=\"bp\">@</span><span class=\"n\">Fenek</span><span class=\"w\"> </span><span class=\"n\">equational_theories</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">extract_implications</span>\n<span class=\"bp\">✖</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">15</span><span class=\"bp\">/</span><span class=\"mi\">30</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">egg</span><span class=\"bp\">/</span><span class=\"n\">egg_for_lean</span><span class=\"bp\">.</span><span class=\"n\">static</span>\n<span class=\"n\">trace</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">egg</span><span class=\"bp\">/</span><span class=\"n\">Rust</span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">rustc</span><span class=\"w\"> </span><span class=\"c1\">--release -- -C relocation-model=pic</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stderr</span><span class=\"o\">:</span>\n<span class=\"n\">could</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">execute</span><span class=\"w\"> </span><span class=\"n\">external</span><span class=\"w\"> </span><span class=\"n\">process</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">cargo'</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">external</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">cargo'</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">255</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">egg</span><span class=\"bp\">/</span><span class=\"n\">egg_for_lean</span><span class=\"bp\">.</span><span class=\"n\">static</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code>\n</code></pre></div>\n</blockquote>\n</blockquote>",
        "id": 474313551,
        "sender_full_name": "Michael Bucko",
        "timestamp": 1727879251
    },
    {
        "content": "<p>I'm having a somewhat hard time understanding the output of this script.</p>\n<p>If I run \"extract_implications outcomes --hist\" it tells me there are  2826 unknown.<br>\nIf I run \"extract_implications outcomes\" I get a list of lists, with 2826 entries tagged as \"unknown\". So far so good.<br>\nIf I run \"extract_implications unknowns\" then I get a list of length just 1696.</p>\n<p>Why is extracting unknowns smaller than outcomes and counting? Further, why are 1683 of these 'unknowns' involving Equation2315?</p>\n<p>Finally, if I look at the outcomes list of lists, why is outcomes[0][0] 'unknown' (as is [37,37], [61, 61] and a bunch other). Shouldn't the diagonal be always true?</p>",
        "id": 474429300,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727914736
    },
    {
        "content": "<p>Yes, arguably <code>Closure.lean</code> should mark the diagonal as implictly true. Currently it does not do that.</p>",
        "id": 474429674,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727914931
    },
    {
        "content": "<p>I'll open an issue for that...</p>",
        "id": 474429797,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727915018
    },
    {
        "content": "<p>Okay great. But these two lists are still different sizes even if I account for that</p>",
        "id": 474430045,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727915166
    },
    {
        "content": "<p><a href=\"https://github.com/teorth/equational_theories/pull/215\">equational#215</a></p>",
        "id": 474430121,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727915201
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"761294\">@Nicholas Carlini</span>  do you have a full command that I can run to see what you're seeing?</p>",
        "id": 474430265,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727915284
    },
    {
        "content": "<p>or is this on your own local branch?</p>",
        "id": 474430277,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727915294
    },
    {
        "content": "<p>No if I'm just running this on upstream main. Let me write a quick reproducer</p>",
        "id": 474430312,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727915325
    },
    {
        "content": "<p>what if you add the <code>--proven</code> flag to <code>unknowns</code>?</p>",
        "id": 474430349,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727915358
    },
    {
        "content": "<p>it looks like <code>outcomes</code> and <code>unknowns</code> have different default behavior with respect to conjectures</p>",
        "id": 474430384,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727915391
    },
    {
        "content": "<p>No if I add --proven then it goes to 1904808</p>",
        "id": 474430442,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727915427
    },
    {
        "content": "<p><code>lake exe extract_implications unknowns | grep -o \"Equation2315\" | wc</code> gives 1683, for example. This seems wrong</p>",
        "id": 474430533,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727915493
    },
    {
        "content": "<p>the help message of <code>unknowns</code> says something about \"modulo equivalence\"</p>",
        "id": 474430696,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727915593
    },
    {
        "content": "<p>Yeah, but if I look at the indexs of the unkonwns in outcomes, then I see exactly 1800 instances of Equation2990.</p>",
        "id": 474430829,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727915659
    },
    {
        "content": "<p>So the counts aren't lining up</p>",
        "id": 474430861,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727915690
    },
    {
        "content": "<p>It's very believable that there's a bug here, but I'm not following your argument. What are you expecting to line up to what, and why?</p>",
        "id": 474431162,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727915880
    },
    {
        "content": "<p>(And 'outcomes' in theory should be listing the entire N^2 set of equations. So modulo equivalence shouldn't matter here.)</p>",
        "id": 474431163,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727915881
    },
    {
        "content": "<p>if <code>outcomes</code> lists N^2 and <code>unknowns</code> reduces modulo equivalence, then it makes sense to me that <code>unknowns</code> reports a smaller number</p>",
        "id": 474431537,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727916111
    },
    {
        "content": "<p>Hm sorry I'm typing as I get more confused. Maybe here's the clearest question that's confusing to me right now.</p>\n<p>If I look at <code>extract_implications outcomes</code>, then I see the entire N^2 table. If I look at the major diagonal, I would expect either unknown or true. But I see a bunch of <code>implicit_conjecture_false</code>. This should not happen right?</p>",
        "id": 474431543,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727916117
    },
    {
        "content": "<p>i think that would mean that we have some bad conjectures</p>",
        "id": 474431682,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727916199
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">extract_implications</span><span class=\"w\"> </span><span class=\"n\">outcomes</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"bp\">.</span><span class=\"n\">json</span>\n<span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">python3</span>\n<span class=\"bp\">&gt;&gt;&gt;</span><span class=\"w\"> </span><span class=\"n\">json</span><span class=\"bp\">.</span><span class=\"n\">load</span><span class=\"o\">(</span><span class=\"kn\">open</span><span class=\"o\">(</span><span class=\"s2\">\"out.json\"</span><span class=\"o\">))[</span><span class=\"bp\">'</span><span class=\"n\">outcomes'</span><span class=\"o\">][</span><span class=\"mi\">5</span><span class=\"o\">][</span><span class=\"mi\">5</span><span class=\"o\">]</span>\n<span class=\"bp\">'</span><span class=\"n\">unknown'</span>\n<span class=\"bp\">&gt;&gt;&gt;</span><span class=\"w\"> </span><span class=\"n\">json</span><span class=\"bp\">.</span><span class=\"n\">load</span><span class=\"o\">(</span><span class=\"kn\">open</span><span class=\"o\">(</span><span class=\"s2\">\"out.json\"</span><span class=\"o\">))[</span><span class=\"bp\">'</span><span class=\"n\">outcomes'</span><span class=\"o\">][</span><span class=\"mi\">6</span><span class=\"o\">][</span><span class=\"mi\">6</span><span class=\"o\">]</span>\n<span class=\"bp\">'</span><span class=\"n\">implicit_conjecture_false'</span>\n</code></pre></div>",
        "id": 474431709,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727916214
    },
    {
        "content": "<p>And then of the 1815 'unknown' entries in the matrix, all but 1801 involve Equation 2990. Which I guess is possible? But that seems suspicious. (If I ignore entries on the the diagonal.)</p>",
        "id": 474431806,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727916278
    },
    {
        "content": "<p>yep, I'm seeing the same thing here</p>",
        "id": 474431833,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727916297
    },
    {
        "content": "<p>I was going to try and get started on (<a href=\"https://github.com/teorth/equational_theories/issues/209\">https://github.com/teorth/equational_theories/issues/209</a>) but before I claimed I wanted to make sure I knew how to read the dataset of what implies what....  and currently I do not</p>",
        "id": 474431925,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727916357
    },
    {
        "content": "<p>yeah, equation 2990 doesn't look all that special: <a href=\"https://github.com/teorth/equational_theories/blob/3b11388f8a933b00d92c6bb883ef2c0b458d564e/equational_theories/AllEquations.lean#L3011\">https://github.com/teorth/equational_theories/blob/3b11388f8a933b00d92c6bb883ef2c0b458d564e/equational_theories/AllEquations.lean#L3011</a></p>",
        "id": 474432259,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727916536
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">equation</span><span class=\"w\"> </span><span class=\"mi\">2990</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>",
        "id": 474432287,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727916549
    },
    {
        "content": "<p>my guess is that there may be some bad conjectures, and that there could possibly be a bug in the closure computation</p>",
        "id": 474432327,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727916581
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243791\">David Renshaw</span> <a href=\"#narrow/stream/458659-Equational/topic/Lean.20script.20for.20extracting.20current.20set.20of.20implications/near/474432327\">said</a>:</p>\n<blockquote>\n<p>my guess is that there may be some bad conjectures, and that there could possibly be a bug in the closure computation</p>\n</blockquote>\n<p>There's a bug in <a href=\"https://github.com/teorth/equational_theories/pull/206\">equational#206</a>, apologies. It should be reverted</p>",
        "id": 474432609,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727916725
    },
    {
        "content": "<p>I'll make <code>extract_implications</code> warn if there are inconsistent conjectures</p>",
        "id": 474432641,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727916749
    },
    {
        "content": "<p>Can we make the build break if that happens?</p>",
        "id": 474432711,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727916804
    },
    {
        "content": "<p>Preventing commits from introducing things that cause errors seems safer</p>",
        "id": 474432843,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727916867
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"761294\">Nicholas Carlini</span> <a href=\"#narrow/stream/458659-Equational/topic/Lean.20script.20for.20extracting.20current.20set.20of.20implications/near/474432711\">said</a>:</p>\n<blockquote>\n<p>Can we make the build break if that happens?</p>\n</blockquote>\n<p>That should be possible, but I don't know how to do CI</p>",
        "id": 474432891,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727916894
    },
    {
        "content": "<p>OK for now warn. I'll add an issue for making it break. I don't either :)</p>",
        "id": 474432927,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727916911
    },
    {
        "content": "<p>I think I'm still misunderstanding something about this tool.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">extract_implications</span><span class=\"w\"> </span><span class=\"n\">outcomes</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"bp\">.</span><span class=\"n\">json</span>\n<span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">python3</span>\n<span class=\"bp\">&gt;&gt;&gt;</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">json</span>\n<span class=\"bp\">&gt;&gt;&gt;</span><span class=\"w\"> </span><span class=\"n\">outcomes</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">json</span><span class=\"bp\">.</span><span class=\"n\">load</span><span class=\"o\">(</span><span class=\"kn\">open</span><span class=\"o\">(</span><span class=\"s2\">\"out.json\"</span><span class=\"o\">))[</span><span class=\"bp\">'</span><span class=\"n\">outcomes'</span><span class=\"o\">]</span>\n<span class=\"bp\">&gt;&gt;&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">outcomes</span><span class=\"o\">[</span><span class=\"mi\">461</span><span class=\"o\">][</span><span class=\"mi\">612</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">outcomes</span><span class=\"o\">[</span><span class=\"mi\">612</span><span class=\"o\">][</span><span class=\"mi\">461</span><span class=\"o\">])</span>\n<span class=\"o\">(</span><span class=\"bp\">'</span><span class=\"n\">implicit_proof_false'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">implicit_proof_false'</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Now I'm not sure which way the table is meant to be read (a=&gt;b or b=&gt;a) but this one is symmetric. So this seems to tell me that Equation462 =/&gt; Equation613 and Equation613 =/&gt; Equation 462.</p>\n<p>But we know that 613 =&gt; 462. So something's not right in my understanding of this tool.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Equation613_implies_Equation462</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Magma</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Equation613</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Equation462</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"n\">u</span>\n</code></pre></div>\n<p>Could someone help me out?</p>",
        "id": 474630970,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727971897
    },
    {
        "content": "<p><code>outcomes[461][612]</code> is the outcome of <code>json.load(open(\"out.json\"))['equations'][461]</code> and <code>json.load(open(\"out.json\"))['equations'][612]</code>, not necessarily <code>Equation462</code> and <code>Equation613</code></p>",
        "id": 474632158,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727972259
    },
    {
        "content": "<p>Oooohhhhhh</p>",
        "id": 474632263,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1727972287
    },
    {
        "content": "<p>That's a little unfortunate tbh, is this to be fixed?</p>",
        "id": 474706822,
        "sender_full_name": "Cody Roux",
        "timestamp": 1728004954
    },
    {
        "content": "<p>the idea is to allow for not all equations to be present, e.g. for Subraph.lean</p>",
        "id": 474707080,
        "sender_full_name": "David Renshaw",
        "timestamp": 1728005155
    },
    {
        "content": "<p>so there needs to be a mapping between array indices and equation indices</p>",
        "id": 474707133,
        "sender_full_name": "David Renshaw",
        "timestamp": 1728005172
    },
    {
        "content": "<p>Perhaps there could be a \"user-friendly\" output default that has {\"Equation5\": {\"Equation6\": \"A_IMPLIES_B\", \"Equation 7\": \"A_NOT_IMPLIES_B\"...}, ...} or something like that which is very hard to incorrectly understand. It will be a bit bigger (because you're duplicating keys) but easier to parse</p>",
        "id": 474707367,
        "sender_full_name": "Nicholas Carlini",
        "timestamp": 1728005325
    },
    {
        "content": "<p>Relatedly: here is a fix to index canonicalization in outcomes_to_image.py: <a href=\"https://github.com/teorth/equational_theories/pull/268\">equational#268</a></p>",
        "id": 474717010,
        "sender_full_name": "David Renshaw",
        "timestamp": 1728010047
    }
]