[
    {
        "content": "<p>I am golfing and upstreaming some of our code to Mathlib. </p>\n<p>I'm prefixing all the Mathlib branches with <code>EquationalTheories/</code> and adding the sentence \"Upstreamed from theÂ <a href=\"https://github.com/teorth/equational_theories\">EquationalTheories</a>Â project.\" to make sure they're findable when we need to mention them in the paper.</p>",
        "id": 477902911,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1729436711
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/17971\">#17971</a></p>",
        "id": 477902927,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1729436735
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/17973\">#17973</a></p>",
        "id": 477903613,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1729437378
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/17976\">#17976</a></p>",
        "id": 477905400,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1729438980
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/17977\">#17977</a></p>",
        "id": 477906025,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1729439489
    },
    {
        "content": "<p>Sounds like this should be brought up on the mathlib channel</p>",
        "id": 477906731,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1729440063
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 477906752,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1729440080
    },
    {
        "content": "<p>Here it is <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/Upstream.20from.20the.20EquationalTheories.20Project\">#mathlib4 &gt; Upstream from the EquationalTheories Project</a> .</p>\n<p>For archival purposes I'll keep posting here too.</p>",
        "id": 477906866,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1729440184
    },
    {
        "content": "<p>If you want to keep track of the ET-related Mathlib PRs, see <a href=\"https://github.com/leanprover-community/mathlib4/pulls?q=is%3Apr+EquationalTheories+\">here</a>.</p>\n<p>We have also added it to the <a href=\"https://github.com/teorth/equational_theories/wiki\">Wiki homepage</a> and in the <a href=\"https://github.com/teorth/equational_theories/wiki/Plan-of-paper#upstream-contributions\">plan of the paper</a> together with the LeanBlueprint ones.</p>",
        "id": 478169964,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1729553538
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"556875\">Pietro Monticone</span> <a href=\"#narrow/channel/458659-Equational/topic/Upstream.20to.20Mathlib/near/477902927\">schrieb</a>:</p>\n<blockquote>\n<p>Opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/17971\">#17971</a>.</p>\n</blockquote>\n<p>Can this be somehow seen as Set:Action:Modify:Preserve-Bijection? (or JS-wise OnSetModify (Preserve Bijection)?)</p>",
        "id": 478343801,
        "sender_full_name": "Michael Bucko",
        "timestamp": 1729621558
    },
    {
        "content": "<p>All of the above Mathlib PRs have been merged.</p>",
        "id": 478364278,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1729629755
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/19618\">#19618</a></p>",
        "id": 485713626,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1733175777
    },
    {
        "content": "<p>And opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/19695\">#19695</a></p>",
        "id": 485713643,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1733175783
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/22507\">#22507</a></p>",
        "id": 503089369,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1741024564
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/22510\">#22510</a></p>",
        "id": 503089466,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1741024591
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/22511\">#22511</a></p>",
        "id": 503089505,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1741024608
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/22513\">#22513</a></p>",
        "id": 503089555,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1741024626
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/22639\">#22639</a></p>",
        "id": 503806347,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1741270878
    },
    {
        "content": "<p>This one was a bit too big so I decided to split it into some smaller PRs, see <a class=\"message-link\" href=\"/#narrow/channel/144837-PR-reviews/topic/.2322639.20.28cyclically.29.20reduced.20words/near/508481815\">#PR reviews &gt; #22639 (cyclically) reduced words @ ðŸ’¬</a> here.</p>",
        "id": 508483613,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1743073057
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span>, could you maybe have a look at them? I get you as a suggested reviewer on GitHub</p>",
        "id": 508488369,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1743074453
    },
    {
        "content": "<p>Itâ€™s been a long time that I touched that code; Iâ€™d rather not get involved in mathlib pr reviewing at the moment, sorry.</p>",
        "id": 508489618,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1743074853
    },
    {
        "content": "<p>No worries!</p>",
        "id": 508500944,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1743078141
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 518811813,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747482645
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 518811823,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747482652
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 518813255,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747483746
    },
    {
        "content": "<p>Iâ€™ve just realised that some declarations had already been upstreamed. Please either add a comment with the <code>[UPSTREAMED]: PR LINK</code> tag or remove the declaration from the related <code>Mathlib</code> or <code>ForMathlib</code> subfolders. Thanks!</p>",
        "id": 518815422,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747485542
    },
    {
        "content": "<p>Oh, when I asked about this I was told it wasn't necessary  <a class=\"message-link\" href=\"/#narrow/channel/458659-Equational/topic/Finishing.20the.20formalization.20of.20anti-implications/near/503090110\">#Equational &gt; Finishing the formalization of anti-implications @ ðŸ’¬</a></p>\n<p>Where do you want it to be added? As a PR to the bump PR?</p>",
        "id": 518839231,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1747504319
    },
    {
        "content": "<p>Yes, as a PR to the bump PR would be totally fine. Thanks!</p>",
        "id": 518841529,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747505941
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"562819\">Bernhard Reinke</span> <a href=\"#narrow/stream/458659-Equational/topic/Upstream.20to.20Mathlib/near/518839231\">said</a>:</p>\n<blockquote>\n<p>Oh, when I asked about this I was told it wasn't necessary  <a class=\"message-link\" href=\"/#narrow/channel/458659-Equational/topic/Finishing.20the.20formalization.20of.20anti-implications/near/503090110\">#Equational &gt; Finishing the formalization of anti-implications @ ðŸ’¬</a></p>\n<p>Where do you want it to be added? As a PR to the bump PR?</p>\n</blockquote>\n<p>Back then we were still finishing the anti implications. Now it makes sense to keep the project toolchain up to date.</p>",
        "id": 518843351,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1747507106
    },
    {
        "content": "<p>Ok, here is <a href=\"https://github.com/teorth/equational_theories/pull/1226\">equational#1226</a>. There is one PR that is in up-to-date mathlib, but not in the one where we are bumping to. I marked the corresponding lemmas accordingly. In principle I could also try to make the version of <code>ReducedWords.lean</code> correspond more to the PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/23368\">#23368</a> that is still under review</p>",
        "id": 518905561,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1747560996
    },
    {
        "content": "<p>Thanks! Merged.</p>",
        "id": 518906408,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747561778
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 518928938,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1747580086
    },
    {
        "content": "<p>Opened bump PR (<a href=\"https://github.com/teorth/equational_theories/pull/1229\">equational#1229</a>) to remove the declarations and files upstreamed by <span class=\"user-mention\" data-user-id=\"562819\">@Bernhard Reinke</span> (<a href=\"https://github.com/leanprover-community/mathlib4/pull/23367\">#23367</a>).</p>",
        "id": 519386237,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747747947
    },
    {
        "content": "<p>The upstreaming of our lemmas for free groups is almost done, see <a href=\"https://github.com/leanprover-community/mathlib4/pull/27679\">#27679</a>. Once this is merged to mathlib, does it make sense to bump Mathlib again or should we keep it at v4.20?</p>",
        "id": 553800237,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1762334058
    },
    {
        "content": "<p>Iâ€™d personally avoid bumping Mathlib at this stage. It would probably be quite painful and bring very little, if any, concrete benefit.</p>",
        "id": 553835103,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1762344372
    },
    {
        "content": "<p>Yeah, makes sense</p>",
        "id": 553839858,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1762345425
    },
    {
        "content": "<p>In my experience, projects which depend on mathlib, once they are finished, sometimes go through a \"let's keep everything up to date\" phase where people try and keep up with mathlib, especially if there are things in the repo which people actively want to get into mathlib, but after a while people just lose interest if the project has achieved its main objective and the paper is written, and then the code rots (in the weak sense that bumping mathlib gets harder -- the code still compiles!). So perhaps the real question here is \"what (if any) code in this project should be in mathlib but isn't, and is there a plan to get it there\"? Once all the code which should be upstreamed is upstreamed, it's not clear (at least to me) what the motivation is to keep the code up to date with mathlib; the project will always compile (at least in theory) because the whole point of the system files like <code>lakefile.toml</code> and in paticular <code>lake-manifest.json</code> is to tell the system which versions of lean/mathlib to use if you want to compile locally.</p>",
        "id": 553855737,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1762349606
    },
    {
        "content": "<p>I am going to create an artefact out of whatever state the repository is in when we upload the preprint. If there are any updates that we want in the review artefact, it should ideally be done now (next 2 days)</p>",
        "id": 553856626,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1762349853
    },
    {
        "content": "<p>In the long term we do need to figure out a way to create cryptographic hashes or other condensed versions of formalized theorems that can actually be imported into other repositories that use a different version of Mathlib than the one used to prove the theorem, as per <a class=\"stream-topic\" data-stream-id=\"113488\" href=\"/#narrow/channel/113488-general/topic/Minimally.20exporting.20a.20theorem.20from.20a.20repository/with/540083456\">#general &gt; Minimally exporting a theorem from a repository</a> .  But for this particular repository the upside of further Mathlib maintainance is indeed low, though I could see the ETP being forked at some point for some further mathematical exploration, at which point it makes sense to bump the fork.</p>",
        "id": 553889242,
        "sender_full_name": "Terence Tao",
        "timestamp": 1762356810
    },
    {
        "content": "<p>Basically you would have to create a merkle tree for the theorem. The problem is, anything inferred (such as implicit args or typeclasses) would be hard to detect.</p>",
        "id": 553916685,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1762362647
    },
    {
        "content": "<p>This is, I suspect, a stupendously hard problem.</p>",
        "id": 554176954,
        "sender_full_name": "Cody Roux",
        "timestamp": 1762458423
    },
    {
        "content": "<p>I don't think it should be a \"stupendously hard problem\". In principle all you need is to add a hash to every constant added to the environment, that checks hashes of constants it depends on. This is actually quite similar to how <code>#print axioms</code> is propagated internally. Then you could <code>#print hash mainTheorem</code>. That would be pretty easy, and a way to check that the hashes of two constants match (they're the same mathematical content).</p>\n<p>Then you could make a very minified version of your result with only the necessary declarations to state it, and this would be a vastly more portable version. Automatically generating such a statement would be trickier but should be perfectly doable I think.</p>\n<p>What would be extremely hard would be adapting to any changes in the definitions. For instance, I recently split out <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AddZeroClass#doc\">docs#AddZeroClass</a> into <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AddZero#doc\">docs#AddZero</a>, in Mathlib. This means that (for instance) any mathematical statement about any additive monoid would now have a different signature after a Mathlib upgrade, so hashes would change. I don't see any feasible way to adapt to this.</p>",
        "id": 555456749,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1763067463
    }
]