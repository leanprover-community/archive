[
    {
        "content": "<p>This was discussed before, but maybe this wasn't considered: The syntax for <code>∘</code> clashes with the syntax for <code>Function.comp</code>. This is bad because it means at every <code>∘</code>, both are tried, leading to exponential(?) slow-down. See for your self:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">Magma</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- `a ∘ b` computes a binary operation of `a` and `b`. -/</span>\n<span class=\"w\">  </span><span class=\"n\">op</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">inherit_doc</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">infixl</span><span class=\"o\">:</span><span class=\"mi\">65</span><span class=\"w\"> </span><span class=\"s2\">\" ∘ \"</span><span class=\"w\">   </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Magma</span><span class=\"bp\">.</span><span class=\"n\">op</span>\n\n\n<span class=\"c1\">-- 48ms</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Equation374794_a</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Magma</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(((</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span>\n\n\n<span class=\"kd\">@[</span><span class=\"n\">inherit_doc</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">infixl</span><span class=\"o\">:</span><span class=\"mi\">65</span><span class=\"w\"> </span><span class=\"s2\">\" • \"</span><span class=\"w\">   </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Magma</span><span class=\"bp\">.</span><span class=\"n\">op</span>\n\n<span class=\"c1\">-- 2ms</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Equation374794_b</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Magma</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(((</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span>\n\n<span class=\"c1\">-- 1ms</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Equation374794__C</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inst</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Magma</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">inst</span><span class=\"bp\">.</span><span class=\"n\">op</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">inst</span><span class=\"bp\">.</span><span class=\"n\">op</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">inst</span><span class=\"bp\">.</span><span class=\"n\">op</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">inst</span><span class=\"bp\">.</span><span class=\"n\">op</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\">  </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">inst</span><span class=\"bp\">.</span><span class=\"n\">op</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">inst</span><span class=\"bp\">.</span><span class=\"n\">op</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>This is so slow that I built a custom elaborator for <code>AllEquations</code>, which is a bit silly. I conjecture that by using unambiguous notation, we can use normal lean syntax there, which is nicer, and makes it easier to copy’n’paste from there. </p>\n<p>Also this extra cost is paid everywhere where people type in equations  in lean.</p>\n<p>Is this bad enough to justify switching? Is <code>•</code> (<code>\\bu</code>) a good alternative?</p>",
        "id": 474069724,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727797868
    },
    {
        "content": "<p>I know that the project has explicitly avoided using <code>Mul</code>, and why. But using bundled objects was never discussed as a potential option. This would be an approach to avoid diamonds in examples (e.g. where the carrier is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">N</mi></mrow><annotation encoding=\"application/x-tex\">\\N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">N</span></span></span></span> and the operation is addition), and would allow reuse of standard stuff from mathlib. Since this discussion is already asking about changing notation, I figured it's worthwhile to bring it up. </p>\n<p>Of course, using bundled objects doesn't solve the psychological issue that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∗</mo></mrow><annotation encoding=\"application/x-tex\">*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4653em;\"></span><span class=\"mord\">∗</span></span></span></span> is usually expected to be associative, but I hope that's something we can deal with :)</p>",
        "id": 474070421,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1727798091
    },
    {
        "content": "<p>Note that we already have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MagmaCat#doc\">docs#MagmaCat</a> in mathlib</p>",
        "id": 474070616,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1727798158
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/stream/458659-Equational/topic/Symbol.20for.20.60Magma.2Eop.60/near/474069724\">said</a>:</p>\n<blockquote>\n<p>Is this bad enough to justify switching? Is <code>•</code> (<code>\\bu</code>) a good alternative?</p>\n</blockquote>\n<p>Would this not clash with scalar multiplication?</p>",
        "id": 474071167,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1727798326
    },
    {
        "content": "<p>At least not when using plain lean :-). But yes, probably not mathlib-compatible. Any available operator? Or just use <code>Mul</code> and be done with it ( <span aria-label=\"fingers crossed\" class=\"emoji emoji-1f91e\" role=\"img\" title=\"fingers crossed\">:fingers_crossed:</span>  that the <code>HMul</code>-indirection doesn’t hurt)</p>",
        "id": 474071576,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727798438
    },
    {
        "content": "<p>I have been wrestling with this question for a while. I found <code>\\oo</code> has not been used. But there has to be a better scoping solution for this</p>",
        "id": 474072873,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727798821
    },
    {
        "content": "<p>Is <code>∗</code> (\\ast) used (or <code>⁎</code> (\\asterisk); I guess one of them is multiplciation)? <code>⊙</code> (\\odot), <code>◆</code> (\\dlb), <code>◇</code> (\\diw) <code>◈</code> (\\di.) etc.</p>",
        "id": 474072940,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1727798841
    },
    {
        "content": "<p>Otherwise Mathlib just gobbles up all useful notation</p>",
        "id": 474073035,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727798867
    },
    {
        "content": "<p>grep finds</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"kn\">infix</span><span class=\"o\">:</span><span class=\"mi\">30</span><span class=\"w\"> </span><span class=\"s2\">\" ∗ \"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Coprod</span>\n</code></pre></div>",
        "id": 474073149,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727798894
    },
    {
        "content": "<p><code>\\oo</code> gives ⊚</p>",
        "id": 474073191,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727798910
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/stream/458659-Equational/topic/Symbol.20for.20.60Magma.2Eop.60/near/474073149\">said</a>:</p>\n<blockquote>\n<p>grep finds</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"kn\">infix</span><span class=\"o\">:</span><span class=\"mi\">30</span><span class=\"w\"> </span><span class=\"s2\">\" ∗ \"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Coprod</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>This is the free product construction (aka the coproduct in the category of monoids/groups)</p>",
        "id": 474073273,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1727798940
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">`⊙`</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">Hadamard</span><span class=\"w\"> </span><span class=\"n\">product</span><span class=\"w\"> </span><span class=\"ss\">`Matrix.hadamard</span><span class=\"bp\">`;</span>\n</code></pre></div>\n<p>The next two (<code>◆</code> and <code>◇</code>)seem to be available...</p>",
        "id": 474073482,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1727799009
    },
    {
        "content": "<p>\\oo has a small circle inside, instead of a dot in \\odot</p>",
        "id": 474073575,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727799040
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">./</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">/</span><span class=\"n\">Category</span><span class=\"bp\">/</span><span class=\"n\">Basic</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"bp\">⊚</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">:</span><span class=\"mi\">80</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">:</span><span class=\"mi\">80</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">category</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\">    </span><span class=\"c1\">-- type as \\oo</span>\n</code></pre></div>",
        "id": 474073859,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1727799134
    },
    {
        "content": "<p>But it is <code>local</code>, so should not be a problem...</p>",
        "id": 474073953,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1727799165
    },
    {
        "content": "<p>However, there is also stuff in <code>Data</code> and <code>Control</code>...</p>",
        "id": 474074120,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1727799223
    },
    {
        "content": "<p>Yes so I tried the following test : on live lean</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">⊚</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- Error. Yay</span>\n</code></pre></div>",
        "id": 474074258,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727799263
    },
    {
        "content": "<p>I wish notation was local by default</p>",
        "id": 474074334,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727799290
    },
    {
        "content": "<p>Alternatively an overload keyword that automatically found the right priority number and locally overloaded a global notation</p>",
        "id": 474074610,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727799368
    },
    {
        "content": "<p>One option is having elements of the magma coerce to a function <code>G -&gt; G</code></p>",
        "id": 474075757,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727799790
    },
    {
        "content": "<p>I just wanted to say that I am not strongly attached to the \\circ symbol as the Lean implementation for magmas (which need not be the same as the blueprint implementation), so if there is a consensus to shift to a different symbol, I would be fine to shift it now while the project is still small enough that a refactor is feasible.</p>\n<p>Certainly aligning with existing Mathlib notation makes sense to me as long as it does not deter casual Lean users from being able to contribute to the project. In the very early stages pf the project it was possible to display proofs in the Lean playground but we are probably well beyond that stage now (unless we can create a dedicated playground for this project)</p>",
        "id": 474077516,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727800425
    },
    {
        "content": "<p>/poll What is your preferred symbol for the magma operation?  Feel free to add an option not listed already<br>\n∘ (\\circ), the current implementation<br>\n*, so that [Magma] is essentially [Mul]<br>\nNo symbol (juxtaposition)</p>",
        "id": 474087091,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727802929
    },
    {
        "content": "<p>Ack, the * symbol in the second option got eaten, and I don't know how to edit the poll or even to remove it.  Is there a way to deal with this?</p>",
        "id": 474087545,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727803072
    },
    {
        "content": "<p>afaik polls can't be edited, and options can't be removed... so i'll add a new option</p>",
        "id": 474087761,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1727803135
    },
    {
        "content": "<p>I'm curious of option 3 (justaposition), how possible would that even be technically (because then there's no function application)?</p>",
        "id": 474116179,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1727812414
    },
    {
        "content": "<p>/poll ASSUMING the magma operation is changed to *, how should [Magma] and [Mul] be related?<br>\n[Magma] is an alias of [Mul] (e.g., using <code>abbrev</code>)<br>\n[Magma] is deleted, and [Mul] used exclusively<br>\n[Magma] is a separate class from [Mul], but constructors and API are in place to convert from one to the other</p>",
        "id": 474120106,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727813900
    },
    {
        "content": "<p>I voted for 3, but I'd there was an option, I would say that it depends on your end goal. If you are okay with piggy backing off mathlib theorems, then using Mul is the better choice. If you wish to track the chain of rewrites/implications in your proof and specific kinds of theorems you use (for e.g the theorems with equation_attribute), using your own version of Magma might be convenient</p>",
        "id": 474123602,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727815223
    },
    {
        "content": "<p>If you want to prove syntactic meta theorems then the FreeMagma and MagmaLaw approach is the best. </p>\n<p>Lastly, there is always the option of manually lifting between them. By manually, I mean not using coercion typeclasses implicitly.</p>",
        "id": 474123803,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727815306
    },
    {
        "content": "<p>I am more interested in maximizing the number of implications proven than trying to do meta analysis of the various proofs provided, but if there is a way to do have the best of both worlds that would be great. We are going to have many metatheorems piggybacking off of mathlib so it is going to be hard to have a purely mathlib free subset of proofs in any case. (But I imagine it should not be too difficult a posteriori to convert Mathlib-reliant proofs to Mathlib-free proofs in many if not all cases, given how simple each proof should be.)</p>",
        "id": 474124044,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727815407
    },
    {
        "content": "<p>We can set priority on notations, right? Can't we just set the priority for <code>Magma.op</code> higher than for <code>Function.comp</code> so that we only try the former? I think it's a tiny loss to not be able to use the notation for <code>Function.comp</code>.</p>",
        "id": 474124834,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1727815684
    },
    {
        "content": "<p>You could add that as another option to the first poll if that is your preferred solution.  This would keep the minor psychological advantage of not suggesting associativity, but be less compatible with [Mul]. (Or we can just assume that we would do this in the first option, as it seems like a no brainer)</p>",
        "id": 474125386,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727815903
    },
    {
        "content": "<p>I'm also fine with using <code>*</code>, it's just not necessary if all we want is to avoid overloading.</p>",
        "id": 474125898,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1727816092
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"111080\">Floris van Doorn</span> <a href=\"#narrow/stream/458659-Equational/topic/Symbol.20for.20.60Magma.2Eop.60/near/474125898\">said</a>:</p>\n<blockquote>\n<p>I'm also fine with using <code>*</code>, it's just not necessary if all we want is to avoid overloading.</p>\n</blockquote>\n<p>Actually * has worse overloading issues than \\circ. If eg you want to put an unusual magma structure on Nat you have to wrap Nat in another class to avoid a notation clash or instance diamond, especially if we identify Magma and Mul</p>",
        "id": 474126206,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727816199
    },
    {
        "content": "<p>Is using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MagmaCat#doc\">docs#MagmaCat</a> off the table?</p>",
        "id": 474126279,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1727816236
    },
    {
        "content": "<p>I guess that essentially falls under the second choice.</p>",
        "id": 474126361,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1727816271
    },
    {
        "content": "<p>ooh I forgot about that, you can add that as an additional poll option.  My one concern is whether this makes formalization more difficult for casual Lean users with no expertise in Categories, or whether it is mostly invisible at the front end.</p>",
        "id": 474126537,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727816333
    },
    {
        "content": "<p>I already used notation priority on one of the PRs I was helping with</p>",
        "id": 474126652,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727816392
    },
    {
        "content": "<p>The problem is ofc when you want to also use function composition notation as is</p>",
        "id": 474126766,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727816416
    },
    {
        "content": "<p>No category theory is necessary, you can still write</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MagmaCat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 474126871,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1727816455
    },
    {
        "content": "<p>And also </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MagmaCat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">→ₙ*</span><span class=\"w\"> </span><span class=\"n\">N</span>\n</code></pre></div>",
        "id": 474126970,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1727816497
    },
    {
        "content": "<p>In any case, I added it as an option</p>",
        "id": 474127132,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1727816545
    },
    {
        "content": "<p>Why not make a Mul instance of FreeMagma in a separate file and import it only when it is necessary to use Mathlib theorems of Mul?</p>",
        "id": 474127256,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727816583
    },
    {
        "content": "<p>If the <code>Cat</code> in <code>MagmaCat</code> is intimidating, we could add <code>alias Magma := MagmaCat</code> so that <code>Magma</code> would become the type of all Magmas</p>",
        "id": 474127333,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1727816615
    },
    {
        "content": "<p>Is there a chance that we are overthinking this? There exists a type class in Lean core that has exactly the operation we want, with a nice-looking and convenient to type symbol. Let's just use it and move on. We can still use the <code>Magma</code> abbrev to make nice theorem statements.</p>",
        "id": 474128339,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727816931
    },
    {
        "content": "<p>Are there any practical advantages of “G: MagmaCat” over “(G: Type *) [Mul G]”? (Sorry can’t do backticks on my phone)</p>",
        "id": 474129389,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727817424
    },
    {
        "content": "<p>The only real practical advantage is that it lets you avoid diamonds. For example here is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">N</mi></mrow><annotation encoding=\"application/x-tex\">\\N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">N</span></span></span></span> with the Magma structure given by addition:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MagmaCat</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n<span class=\"w\">  </span><span class=\"n\">str</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·+·</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 474130683,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1727818067
    },
    {
        "content": "<p>Of course it's possible to do this in an unbundled way as well, e.g. as follows:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n<span class=\"kd\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Mul</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">where</span><span class=\"w\"> </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·+·</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 474130905,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1727818159
    },
    {
        "content": "<p>But it can be cumbersome to define the <code>Mul</code> instance, as you can see.</p>",
        "id": 474130972,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1727818193
    },
    {
        "content": "<p>Perhaps a concrete example will help clarify the issue. Consider the following counterexample currently formalized in Subgraph.lean:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\"> </span><span class=\"kd\">@[</span><span class=\"n\">equational_result</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Equation43_not_implies_Equation4512</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Magma</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Equation43</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">Equation4512</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">hG</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Magma</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">op</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">ℕ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hG</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">  </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">dsimp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hG</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">ring</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">by_contra</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"n\">specialize</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hG</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>\n<ol>\n<li>\n<p>What would the analogous proof be if we used <code>Mul G</code> instead of <code>Magma G</code> (redefining Equation43 and Equation 4512 accordingly, of course)?  Note the potential instance diamond since <code>ℕ</code> already has an (incompatible) [Mul ℕ] structure, which is in fact being used to construct the magma.</p>\n</li>\n<li>\n<p>What would the analogous proof be if we used <code>MagmaCat</code> instead of <code>Magma G</code> (redefining Equation43 and Equation 4512 accordingly, of course)?</p>\n</li>\n</ol>",
        "id": 474141932,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727823553
    },
    {
        "content": "<p>this works:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Mul</span><span class=\"bp\">.</span><span class=\"n\">Equation43</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Mul</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Mul</span><span class=\"bp\">.</span><span class=\"n\">Equation4512</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Mul</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">z</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Mul</span><span class=\"bp\">.</span><span class=\"n\">Equation43_not_implies_Equation4512</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Mul</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Mul</span><span class=\"bp\">.</span><span class=\"n\">Equation43</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">Mul</span><span class=\"bp\">.</span><span class=\"n\">Equation4512</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">hG</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Mul</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">ℕ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hG</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">  </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">dsimp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hG</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">HMul</span><span class=\"bp\">.</span><span class=\"n\">hMul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">instHMul</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">mul_comm</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">mul_comm</span>\n<span class=\"w\">    </span><span class=\"n\">dsimp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HMul</span><span class=\"bp\">.</span><span class=\"n\">hMul</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">mul_comm</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mul_comm</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">by_contra</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"n\">specialize</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HMul</span><span class=\"bp\">.</span><span class=\"n\">hMul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">instHMul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hG</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>\n<p>Wouldn't claim it's nice though, it feels like an argument against <code>Mul</code>: <code>HMul</code> gets in the way a lot, and <code>ring</code> doesn't  pick up on the commutative ring  instance if we override <code>Mul</code>, and even stuff like commutativity of multiplication in <code>Nat</code> is stated using <code>Mul</code> so we have to \"unpack\" everything.</p>",
        "id": 474213009,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1727852938
    },
    {
        "content": "<p>The above commits the sin of endowing <code>ℕ</code> with two <code>Mul</code> instances. You can avoid doing this by operating in a type-correct way as follows:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Equation43_not_implies_Equation4512</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Mul</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">e</span><span class=\"bp\">⟩⟩</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">≃</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">ℕ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"bp\">_⟩⟩</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Mul</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">he</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">  </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">he</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_comm</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">push_neg</span>\n<span class=\"w\">    </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">he</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 474227352,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1727856784
    },
    {
        "content": "<p>Another option would be to provide some global</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Wrapper</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T</span>\n</code></pre></div>\n<p>and then use <code>Wrapper ℕ</code> whenever you want to define a theorem-local magma with a nat representation</p>",
        "id": 474229910,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1727857524
    },
    {
        "content": "<p>Then <code>e.symm</code> and <code>e</code> above become <code>.mk</code> and <code>.val</code> or <code>\\&lt;&gt;</code> and <code>.1</code></p>",
        "id": 474230186,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1727857565
    },
    {
        "content": "<p>the above was also type-correct btw, just ugly</p>",
        "id": 474262337,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1727867185
    },
    {
        "content": "<p>It seems that if we are to refactor <code>[Magma]</code> to <code>[Mul]</code> (or <code>MagmaCat</code>), we will need some consensus on what the best practices are for writing proofs and provide some examples.  The examples provided above are, I feel, a bit trickier for a casual Lean user to create than the <code>[Magma]</code> based proof, for instance many potential contributors may not know the nuances of <code>Equiv</code>.</p>\n<p>The fact that the move from <code>[Magma]</code> to <code>[Mul]</code> breaks tactics such as <code>ring</code> is a little concerning for me.  Does the <code>MagmaCat</code> refactor fare any better in this regard?</p>",
        "id": 474308446,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727878277
    },
    {
        "content": "<p>I just wanted to add that in the prehistory of this project (i.e., last week), I did initially start with <code>[Mul G]</code> but ran into all the instance diamond issues that <span class=\"user-mention\" data-user-id=\"315434\">@Andrés Goens</span> also encountered, which is why I ended up moving to a different class <code>[Magma G]</code> with a different operation symbol.</p>\n<p>I would like to offer two additional arguments to retain <code>[Magma G]</code> instead of <code>[Mul G]</code>.  One is speed: as <code>[Magma G]</code> has a lot less API than <code>[Mul G]</code>, there could be some small speed savings in compiling [Magma]-based proofs, which could add up as we collect millions of proofs of implications (although it seems right now the Lean compiler is not the bottleneck for the project.)</p>\n<p>The other is that I do think that while <code>[Magma G]</code> and <code>[Mul G]</code> are syntactically isomorphic, I would argue that they are conceptually distinct.  I already mentioned one distinction that <code>[Mul G]</code> operations would be expected to be associative, while <code>[Magma G]</code> operations have no such expectation.  But the other conceptual distinction is that <code>[Mul G]</code> is expected to be the canonical multiplication operation on <code>G</code>, if one exists.  In contrast, <code>[Magma G]</code> is not expected to be the canonical multiplication operation, and can then be used for some other operation not related to multiplication (though of course if one wants to study <em>two</em> such non-canonical operations, one still has instance diamond issues, but thankfully we are unlikely to encounter such a situation here, except possibly when studying duality in which it makes sense to reverse the order of the magma operation).  </p>\n<p>Perhaps a compromise is to leave <code>[Magma G]</code> largely in its current form, but include some API to coerce a <code>[Magma G]</code> type to a <code>[Mul G]</code> type and vice versa?</p>",
        "id": 474342087,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727886010
    },
    {
        "content": "<p>FWIW we do have non-associative <code>Mul</code>-bearing types in Matlhib already, e.g., <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FreeNonUnitalNonAssocAlgebra#doc\">docs#FreeNonUnitalNonAssocAlgebra</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FreeMagma#doc\">docs#FreeMagma</a></p>",
        "id": 474343235,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1727886388
    },
    {
        "content": "<p>If we stick to <code>Magma</code>, then we are maybe back to the original question: Which symbol to use?</p>",
        "id": 474343495,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727886443
    },
    {
        "content": "<p>to be fair, I don't find the (original) proof of <code>Equation43_not_implies_Equation4512</code> to be terribly accessible either, not sure if the casual Lean user would find that one so much better. That being said, I still think the other arguments are strong enough to keep <code>Magma</code> instead of <code>Mul</code> (in my opinion).</p>",
        "id": 474344688,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1727886655
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/stream/458659-Equational/topic/Symbol.20for.20.60Magma.2Eop.60/near/474343495\">said</a>:</p>\n<blockquote>\n<p>If we stick to <code>Magma</code>, then we are maybe back to the original question: Which symbol to use?</p>\n</blockquote>\n<p>I thought the proposal to retain <code>∘</code> but give it a higher priority than function composition seemed to cover most use cases.  There are very few situations I can think of where we would have a <code>[Magma G]</code> that (a) already has a native function composition operation, and (b) we would want to actually use that function composition operation.  In such rare cases we could do a wrapper-based solution similar to what has been proposed above for <code>[Mul G]</code>.</p>",
        "id": 474346921,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727887041
    },
    {
        "content": "<p>If that solves the technical issues with <code>\\circ</code>, then sounds good to me.</p>",
        "id": 474356694,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727890205
    },
    {
        "content": "<p>I didn't vote on the main issue; just one thing I want to say:<br>\nIn the current implementation of <code>Magma</code> we have <code>infix:65 \" ∘ \" =&gt; Magma.op</code> as the operator, which does not hide any parenthesis in the Infoview. If we switch to <code>Mul</code> from Mathlib, we will obtain <code>infixl</code> instead of <code>infix</code>, and I don't know if it can be overriden with the variant that preserves parentheses like <code>(x * y) * z</code> in the Infoview.</p>",
        "id": 474366645,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1727893259
    },
    {
        "content": "<p>It does not appear that we have consensus on how to perform the transition from <code>[Magma G]</code> to <code>[Mul G]</code> that minimizes technical challenges for future users.  As such, I am going to declare that we keep the status quo, though I have added <a href=\"https://github.com/teorth/equational_theories/pull/234\">equational#234</a> to create coercion API between [Magma] and [Mul] in case we need it and to elevate the priority of \\circ.  However, I will keep this thread open if there are people who wish to continue advocating for more drastic changes.</p>",
        "id": 474622117,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727969967
    },
    {
        "content": "<p>I believe that a big part of CI wait times is currently traceable to the <code>∘</code> symbol having slow elaboration.</p>",
        "id": 474674669,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727986459
    },
    {
        "content": "<p>My feeling is that we should use something that does not already have meaning, like the star symbol <code>⋆</code>.</p>",
        "id": 474675036,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727986652
    },
    {
        "content": "<p>When I try setting the priority higher like this</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">infix</span><span class=\"o\">:</span><span class=\"mi\">10000</span><span class=\"w\"> </span><span class=\"s2\">\" ∘ \"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Magma</span><span class=\"bp\">.</span><span class=\"n\">op</span>\n</code></pre></div>\n<p>that seems to break things</p>",
        "id": 474675412,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727986834
    },
    {
        "content": "<p>Isn't that precedence, not priority?</p>",
        "id": 474676534,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727987360
    },
    {
        "content": "<p>I.e. how to resolve <code>a * b + c</code>, not which syntax declaration to apply?</p>",
        "id": 474676680,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727987419
    },
    {
        "content": "<p>I think you are correct. How do I set priority then?</p>",
        "id": 474676789,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727987482
    },
    {
        "content": "<p>No idea, not my area of expertise I fear. Not even sure it exists, but I think someone else said it's possible?</p>",
        "id": 474677120,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1727987630
    },
    {
        "content": "<p>notation:precedence (priority:= 1200) ...</p>",
        "id": 474677274,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727987690
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">infixl</span><span class=\"o\">:</span><span class=\"mi\">65</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">priority</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">1100</span><span class=\"o\">)</span><span class=\"s2\">\" ∘ \"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Magma</span><span class=\"bp\">.</span><span class=\"n\">op</span>\n</code></pre></div>",
        "id": 474677350,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727987726
    },
    {
        "content": "<p>Hmm, if one can empirically test (say on some test branch) the hypothesis that changing the symbol to a unique symbol significantly improves CI run time then that for me is a good reason to refactor (even if it means changing a lot of the current code).</p>",
        "id": 474677454,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727987766
    },
    {
        "content": "<p>Whether priority can become a headache depends on how the parser uses priority. Does it check all notation defs for each occurrence of a symbol or does it precompute some notation table for each namespace?</p>",
        "id": 474677698,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727987883
    },
    {
        "content": "<p><code>Homomorphisms.lean</code> has some uses of \\circ as function composition, and they break if I do</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">infix</span><span class=\"o\">:</span><span class=\"mi\">65</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">priority</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">1100</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"s2\">\" ∘ \"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Magma</span><span class=\"bp\">.</span><span class=\"n\">op</span>\n</code></pre></div>",
        "id": 474678040,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727988072
    },
    {
        "content": "<p>Note that <a href=\"https://github.com/teorth/equational_theories/pull/234\">equational#234</a> is an open PR to elevate the priority of \\circ, and implemented these fixes.  I'm hoping this is a viable solution, but changing the operation symbol may be an even better fix perhaps.</p>",
        "id": 474678481,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727988286
    },
    {
        "content": "<p>hm, I see that <code>FreeMagma.lean</code> is <a href=\"https://github.com/teorth/equational_theories/blob/41f40e064d2a8ce8aeadd94e8226f2b257778006/equational_theories/FreeMagma.lean#L15\">already using the star symbol</a>.</p>",
        "id": 474679706,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727988822
    },
    {
        "content": "<p>I've gone ahead and approved <a href=\"https://github.com/teorth/equational_theories/pull/234\">equational#234</a> for now as a provisional solution at least, but keep the discussion going here for any improved solution.  Implementing star as the default magma operation (and making suitable adjustments to <code>FreeMagma</code> as a consequence) seems like a reasonable option; I assume star doesn't conflict with any existing global notation in Mathlib?</p>",
        "id": 474680188,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727989029
    },
    {
        "content": "<p>Here's an example of what using <code>Mul</code> could look like:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">ext</span><span class=\"kd\">]</span>\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">NewType</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span>\n\n<span class=\"sd\">/-- A helper to build a new `Mul` instance on an underlying representation -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Mul</span><span class=\"bp\">.</span><span class=\"n\">onNewType</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Mul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">NewType</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">⟩</span>\n\n<span class=\"sd\">/-- The reflexive law -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Equation1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Mul</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span>\n\n<span class=\"sd\">/-- The singleton law -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Equation2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Mul</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">Equation1</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">Equation2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">specialize</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">onNewType</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"n\">specialize</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"mi\">1</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"mi\">2</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>",
        "id": 474681997,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1727989801
    },
    {
        "content": "<p>I now have a branch that changes the op symbol from \\circ to \\di (diamond).</p>",
        "id": 474682200,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727989895
    },
    {
        "content": "<p>I observed the time for a fresh build to go down from ~8 minutes (before <a href=\"https://github.com/teorth/equational_theories/pull/240\">equational#240</a> was applied) to ~1 minute 20 seconds.</p>",
        "id": 474682326,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727989948
    },
    {
        "content": "<p>The merge of <a href=\"https://github.com/teorth/equational_theories/pull/240\">equational#240</a> broke the build.</p>",
        "id": 474682817,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727990201
    },
    {
        "content": "<p>that's a huge speedup! why would the symbol make such a difference?</p>",
        "id": 474682930,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1727990244
    },
    {
        "content": "<p>is it because of some typeclass in the background?</p>",
        "id": 474683034,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1727990283
    },
    {
        "content": "<p>\\circ already means Function.comp, so I guess unification has more possibilities to explore</p>",
        "id": 474683040,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727990286
    },
    {
        "content": "<p><a href=\"https://github.com/teorth/equational_theories/pull/249\">equational#249</a> is a big intrusive diff that changes the symbol everywhere to <code>◆</code></p>",
        "id": 474684759,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727991208
    },
    {
        "content": "<p>I chose that symbol because it does not appear in mathlib, but is easy to type (\"\\di\").</p>",
        "id": 474684853,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727991261
    },
    {
        "content": "<p>I don't want to just steam-roller this change without any buy-in, but it does appear to me to be a simple way to get a very noticeable performance increase.</p>",
        "id": 474684915,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727991302
    },
    {
        "content": "<p>... without breaking the existing Funciton.comp symbol</p>",
        "id": 474684950,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727991327
    },
    {
        "content": "<p>The reason that <a href=\"https://github.com/teorth/equational_theories/pull/240\">equational#240</a> broke the build is that some stuff in Homomorphism.lean started using Function.comp \\circ <em>after</em> <a href=\"https://github.com/teorth/equational_theories/pull/240\">equational#240</a> was created.</p>",
        "id": 474685378,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727991526
    },
    {
        "content": "<p>The more minimal change would be to fix up those instance to avoid \\circ.</p>",
        "id": 474685400,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727991539
    },
    {
        "content": "<p>heh, or just revert it</p>",
        "id": 474685555,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727991614
    },
    {
        "content": "<p>OK I have reverted <a href=\"https://github.com/teorth/equational_theories/pull/240\">equational#240</a> since it seems to likely be largely redundant (or need significant refactoring) after <a href=\"https://github.com/teorth/equational_theories/pull/249\">equational#249</a> .  It also had a separate component which was to create some scoped instances between [Add], [Mul], and [Magma] but those can be re-inserted later after we sort out the symbol issue</p>",
        "id": 474685556,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727991620
    },
    {
        "content": "<p>/poll What symbol should we use for the Magma operation?<br>\n∘ (\\circ) - current implementation, conflicts with function composition</p>\n<ul>\n<li>\n<ul>\n<li>conflicts with [Mul]<br>\n◆ (\\di)<br>\n⊙ (\\odot)<br>\n◇ (\\diw)<br>\n⊚ (\\oo)</li>\n</ul>\n</li>\n</ul>",
        "id": 474687279,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727992520
    },
    {
        "content": "<p>Starting a poll again.  And I see that I <em>again</em> messed up with the * option, though I think this option was unviable anyway.</p>",
        "id": 474687321,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727992546
    },
    {
        "content": "<p>There is also the smaller hollow diamond <code>⋄</code> (\\diamond), but that's a lot to type</p>",
        "id": 474687493,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727992615
    },
    {
        "content": "<p>It wasn't clear to me whether the Hadamard product use of \\odot gives it the same unification issue as \\circ</p>",
        "id": 474687587,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727992667
    },
    {
        "content": "<p>My vote for \\oo is because I am certain it isn't used globally in mathlib</p>",
        "id": 474688234,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727992993
    },
    {
        "content": "<p>I mean in a globally visible way</p>",
        "id": 474688255,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727993004
    },
    {
        "content": "<p>I have updated <a href=\"https://github.com/teorth/equational_theories/pull/249\">equational#249</a> to use <code>◇</code>, which I am reasonably happy with.</p>",
        "id": 474688296,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727993030
    },
    {
        "content": "<p>I found ◆ to be somewhat grating on the eyes.</p>",
        "id": 474688357,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727993052
    },
    {
        "content": "<ul>\n<li>◆ (\\di) <a href=\"/user_uploads/3121/-MIXeyQy_R4PVVP4kY77F1FP/Screenshot-from-2024-10-03-18-07-37.png\">Screenshot from 2024-10-03 18-07-37.png</a><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/-MIXeyQy_R4PVVP4kY77F1FP/Screenshot-from-2024-10-03-18-07-37.png\" title=\"Screenshot from 2024-10-03 18-07-37.png\"><img data-original-dimensions=\"842x754\" src=\"/user_uploads/thumbnail/3121/-MIXeyQy_R4PVVP4kY77F1FP/Screenshot-from-2024-10-03-18-07-37.png/840x560.webp\"></a></div></li>\n<li>⊙ (\\odot) <a href=\"/user_uploads/3121/AeJMpyna2q9Yd6dPDwj4PnVJ/Screenshot-from-2024-10-03-18-06-43.png\">Screenshot from 2024-10-03 18-06-43.png</a><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/AeJMpyna2q9Yd6dPDwj4PnVJ/Screenshot-from-2024-10-03-18-06-43.png\" title=\"Screenshot from 2024-10-03 18-06-43.png\"><img data-original-dimensions=\"842x754\" src=\"/user_uploads/thumbnail/3121/AeJMpyna2q9Yd6dPDwj4PnVJ/Screenshot-from-2024-10-03-18-06-43.png/840x560.webp\"></a></div></li>\n</ul>",
        "id": 474688812,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727993317
    },
    {
        "content": "<ul>\n<li>◇ (\\diw) <a href=\"/user_uploads/3121/mTNAzKQN7ExJw0a7dbvF9MQ-/Screenshot-from-2024-10-03-18-04-45.png\">Screenshot from 2024-10-03 18-04-45.png</a><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/mTNAzKQN7ExJw0a7dbvF9MQ-/Screenshot-from-2024-10-03-18-04-45.png\" title=\"Screenshot from 2024-10-03 18-04-45.png\"><img data-original-dimensions=\"842x754\" src=\"/user_uploads/thumbnail/3121/mTNAzKQN7ExJw0a7dbvF9MQ-/Screenshot-from-2024-10-03-18-04-45.png/840x560.webp\"></a></div></li>\n<li>⊚ (\\oo) <a href=\"/user_uploads/3121/S4kf05y3c11HZxJpC2wfANV8/Screenshot-from-2024-10-03-18-05-50.png\">Screenshot from 2024-10-03 18-05-50.png</a><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/S4kf05y3c11HZxJpC2wfANV8/Screenshot-from-2024-10-03-18-05-50.png\" title=\"Screenshot from 2024-10-03 18-05-50.png\"><img data-original-dimensions=\"842x754\" src=\"/user_uploads/thumbnail/3121/S4kf05y3c11HZxJpC2wfANV8/Screenshot-from-2024-10-03-18-05-50.png/840x560.webp\"></a></div></li>\n</ul>",
        "id": 474688875,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727993367
    },
    {
        "content": "<p>\\odot and \\oo are both used in mathlib, but qualfied as <code>local</code> or <code>scoped</code>, so there should be no issue. Neither \\di no \\diw show up in mathlib at all.</p>",
        "id": 474689579,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727993791
    },
    {
        "content": "<p>In <a href=\"https://github.com/teorth/equational_theories/pull/254\">equational#254</a> I recovered the part of <a href=\"https://github.com/teorth/equational_theories/pull/240\">equational#240</a> that doesn't break stuff</p>",
        "id": 474689942,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1727993986
    },
    {
        "content": "<p><a href=\"https://github.com/teorth/equational_theories/pull/249\">equational#249</a> passed CI. I think we should merge it. If any objections come up, it'll be easy enough to do another find and replace.</p>",
        "id": 474690315,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727994210
    },
    {
        "content": "<p>Okay I will do it now</p>",
        "id": 474690739,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727994434
    },
    {
        "content": "<p>If the CI fails we can revert it</p>",
        "id": 474690794,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727994481
    },
    {
        "content": "<p>I merged master in <a href=\"https://github.com/teorth/equational_theories/pull/254\">equational#254</a> 4 minutes ago and acquired a new (easy) merge conflict :-)</p>",
        "id": 474691223,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1727994702
    },
    {
        "content": "<p>(though most PRs just got merge conflicts, probably)</p>",
        "id": 474691328,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1727994744
    },
    {
        "content": "<p>I count 4 linked pull requests including yours</p>",
        "id": 474691627,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727994925
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243791\">David Renshaw</span> <a href=\"#narrow/stream/458659-Equational/topic/Symbol.20for.20.60Magma.2Eop.60/near/474682326\">said</a>:</p>\n<blockquote>\n<p>I observed the time for a fresh build to go down from ~8 minutes (before <a href=\"https://github.com/teorth/equational_theories/pull/240\">equational#240</a> was applied) to ~1 minute 20 seconds.</p>\n</blockquote>\n<p>Maybe that was just a caching thing? The latest build (with the new <code>Magma.op</code> symbol) takes 7 minutes.</p>",
        "id": 474691830,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1727995024
    },
    {
        "content": "<p>on CI? that's not going to have as much parallelism as I have here.</p>",
        "id": 474691859,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727995052
    },
    {
        "content": "<p>I did <code>git clean -xffd</code> and then <code>lake exe cache get</code> and then <code>time lake build</code></p>",
        "id": 474691884,
        "sender_full_name": "David Renshaw",
        "timestamp": 1727995068
    },
    {
        "content": "<p>Yes, this was CI: <a href=\"https://github.com/teorth/equational_theories/actions/runs/11170684792/job/31053976339\">https://github.com/teorth/equational_theories/actions/runs/11170684792/job/31053976339</a><br>\nDidn't realize you spoke about local build time.</p>",
        "id": 474691974,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1727995101
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"466334\">Shreyas Srinivas</span> <a href=\"#narrow/stream/458659-Equational/topic/Symbol.20for.20.60Magma.2Eop.60/near/474691627\">said</a>:</p>\n<blockquote>\n<p>I count 4 linked pull requests including yours</p>\n</blockquote>\n<p>It might be prudent for other PRs to also merge master if they changed any Lean. If they used the old <code>Magma.op</code> notation, the build will break after merging</p>",
        "id": 474692180,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1727995226
    },
    {
        "content": "<p>Will it be simpler to handle the merge conflict if they all rebase on master and squash?</p>",
        "id": 474692811,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727995557
    },
    {
        "content": "<p>it would be useful if they all merge (or rebase if you prefer) <del>master</del> main and see if CI still builds</p>",
        "id": 474692946,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1727995615
    },
    {
        "content": "<p>Yeah that I agree. But, especially if they are auto-generating large numbers of lemmas, I expect the merge conflict handling to be painful</p>",
        "id": 474693125,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727995743
    },
    {
        "content": "<p>Hopefully I can notify the authors by tagging them here</p>",
        "id": 474693231,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727995803
    },
    {
        "content": "<p>No that doesn't work. I don't know Jeremy Scanvic's zulip id</p>",
        "id": 474693460,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727995924
    },
    {
        "content": "<p>If the merge conflict is with just <a href=\"https://github.com/teorth/equational_theories/pull/249\">equational#249</a> it's easy. Just run <code>git merge origin -X ours</code> (if there is an actual merge conflict) and then do a single search+replace from ∘ to ◇</p>",
        "id": 474693464,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1727995927
    },
    {
        "content": "<p>If you want you could manually merge their PRs with main (assuming they enabled you to push to their PRs)</p>",
        "id": 474693520,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1727995971
    },
    {
        "content": "<p>It would be nice if Github would have a button \"merge with latest version\" that you could just press, instead of <code>git remote add</code> + <code>git checkout</code> + <code>git merge</code> + <code>git push</code>.</p>",
        "id": 474693599,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1727996035
    },
    {
        "content": "<p>No that doesn't work. I don't know Jeremy Scanvic's zulip id</p>",
        "id": 474693651,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727996044
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"557192\">@Franklin Pezzuti Dyer</span> : your PRs <a href=\"https://github.com/teorth/equational_theories/pull/122\">equational#122</a> and <a href=\"https://github.com/teorth/equational_theories/pull/155\">equational#155</a> are likely to have merge conflicts due to the notation change for the magma operation (tl Dr; CI runs much faster)</p>",
        "id": 474693884,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727996173
    },
    {
        "content": "<p>Could you try merging main into your PR branches and use Floris's suggestion above if you run into difficulties?</p>",
        "id": 474693979,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727996221
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"111080\">Floris van Doorn</span> <a href=\"#narrow/stream/458659-Equational/topic/Symbol.20for.20.60Magma.2Eop.60/near/474693599\">said</a>:</p>\n<blockquote>\n<p>It would be nice if Github would have a button \"merge with latest version\" that you could just press, instead of <code>git remote add</code> + <code>git checkout</code> + <code>git merge</code> + <code>git push</code>.</p>\n</blockquote>\n<p>That would leave the local repository still in its old state and users will still have to deal with the merge conflict there</p>",
        "id": 474694166,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727996324
    },
    {
        "content": "<p>Maybe a repo admin can set the <code>default commit message</code> when merging PRs to <code>pull request title and description</code>? Then I don't have to worry about my commit messages in my PRs. (as is the default for Mathlib.)<br>\nCan be toggled in <a href=\"https://github.com/teorth/equational_theories/settings\">https://github.com/teorth/equational_theories/settings</a><br>\n<a href=\"/user_uploads/3121/0PYlGCrNstV297LhbYi-UG0n/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/0PYlGCrNstV297LhbYi-UG0n/image.png\" title=\"image.png\"><img data-original-dimensions=\"537x151\" src=\"/user_uploads/thumbnail/3121/0PYlGCrNstV297LhbYi-UG0n/image.png/840x560.webp\"></a></div>",
        "id": 474694246,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1727996367
    },
    {
        "content": "<p>A secondary question: should we also change the human-readable portions of the project (the blueprint, README, some .txt files, etc.) to reflect this new notation change?</p>",
        "id": 474694278,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727996390
    },
    {
        "content": "<p>I think that's already the case?</p>",
        "id": 474694285,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727996394
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"466334\">Shreyas Srinivas</span> <a href=\"#narrow/stream/458659-Equational/topic/Symbol.20for.20.60Magma.2Eop.60/near/474694166\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"111080\">Floris van Doorn</span> <a href=\"#narrow/stream/458659-Equational/topic/Symbol.20for.20.60Magma.2Eop.60/near/474693599\">said</a>:</p>\n<blockquote>\n<p>It would be nice if Github would have a button \"merge with latest version\" that you could just press, instead of <code>git remote add</code> + <code>git checkout</code> + <code>git merge</code> + <code>git push</code>.</p>\n</blockquote>\n<p>That would leave the local repository still in its old state and users will still have to deal with the merge conflict there</p>\n</blockquote>\n<p>To add to this: github's git is no smarter than the local git, so users will have to resolve the merge conflict on GitHub as well</p>",
        "id": 474694385,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727996423
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"111080\">Floris van Doorn</span> <a href=\"#narrow/stream/458659-Equational/topic/Symbol.20for.20.60Magma.2Eop.60/near/474694246\">said</a>:</p>\n<blockquote>\n<p>Maybe a repo admin can set the <code>default commit message</code> when merging PRs to <code>pull request title and description</code>? Then I don't have to worry about my commit messages in my PRs. (as is the default for Mathlib.)<br>\nCan be toggled in <a href=\"https://github.com/teorth/equational_theories/settings\">https://github.com/teorth/equational_theories/settings</a><br>\n<a href=\"/user_uploads/3121/0PYlGCrNstV297LhbYi-UG0n/image.png\">image.png</a></p>\n</blockquote>\n<p>I think this is already the default?</p>",
        "id": 474694513,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727996465
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"466334\">Shreyas Srinivas</span> <a href=\"#narrow/stream/458659-Equational/topic/Symbol.20for.20.60Magma.2Eop.60/near/474694385\">said</a>:</p>\n<blockquote>\n<p>To add to this: github's git is no smarter than the local git, so users will have to resolve the merge conflict on GitHub as well</p>\n</blockquote>\n<p>Sure, but the button would be helpful for all PRs that have no git merge conflict (but might have a semantic merge conflict)</p>",
        "id": 474694515,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1727996465
    },
    {
        "content": "<p>I think I managed to change the default commit message.  Have to go offline now for about an hour</p>",
        "id": 474694615,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727996522
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"466334\">Shreyas Srinivas</span> <a href=\"#narrow/stream/458659-Equational/topic/Symbol.20for.20.60Magma.2Eop.60/near/474694513\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"111080\">Floris van Doorn</span> <a href=\"#narrow/stream/458659-Equational/topic/Symbol.20for.20.60Magma.2Eop.60/near/474694246\">said</a>:</p>\n<blockquote>\n<p>Maybe a repo admin can set the <code>default commit message</code> when merging PRs to <code>pull request title and description</code>? Then I don't have to worry about my commit messages in my PRs. (as is the default for Mathlib.)<br>\nCan be toggled in <a href=\"https://github.com/teorth/equational_theories/settings\">https://github.com/teorth/equational_theories/settings</a><br>\n<a href=\"/user_uploads/3121/0PYlGCrNstV297LhbYi-UG0n/image.png\">image.png</a></p>\n</blockquote>\n<p>I think this is already the default?</p>\n</blockquote>\n<p>Maybe; it wasn't the commit messages generated for <a href=\"https://github.com/teorth/equational_theories/commit/11a1831c8bf7cebb3391669afe102d693e96962a\">https://github.com/teorth/equational_theories/commit/11a1831c8bf7cebb3391669afe102d693e96962a</a></p>",
        "id": 474694688,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1727996544
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"657719\">Terence Tao</span> <a href=\"#narrow/stream/458659-Equational/topic/Symbol.20for.20.60Magma.2Eop.60/near/474694278\">said</a>:</p>\n<blockquote>\n<p>A secondary question: should we also change the human-readable portions of the project (the blueprint, README, some .txt files, etc.) to reflect this new notation change?</p>\n</blockquote>\n<p>I don't think the README is affected. The blueprint is likely to be the biggest place where change is needed. I suggest using a latex variable for the magma operation in the latex blueprint to ensure that future changes only have to happen at one place.</p>",
        "id": 474694823,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1727996614
    },
    {
        "content": "<p>OK, I have pushed a blueprint change (<a href=\"https://github.com/teorth/equational_theories/pull/257\">equational#257</a>) along the lines you indicated.  There are several legacy text files that use \\circ but changing them over is low priority (unless they are somehow used as input for various pieces of code that might now transfer over).</p>",
        "id": 474697340,
        "sender_full_name": "Terence Tao",
        "timestamp": 1727998120
    },
    {
        "content": "<p>Wow, this is a big speed-up. Previously I was worried about adding files that were 'too slow' and thought I should really prune away past theorems that are unused in the current transitive reduction, but this has removed that concern entirely.</p>",
        "id": 474837565,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1728052687
    },
    {
        "content": "<p>OK, I am glad that the temporary disruption was worth the long term gain!</p>",
        "id": 474839957,
        "sender_full_name": "Terence Tao",
        "timestamp": 1728053473
    },
    {
        "content": "<p>In order to balance the meta, we should invent a new mathematical structure and call it \"Aqua\".<br>\nObviously <code>💧</code> will be the infix operator.</p>",
        "id": 475094776,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1728216938
    },
    {
        "content": "<p>while we're at it, let's add Terra, Aer and Aether too <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span></p>",
        "id": 475097998,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1728218983
    }
]