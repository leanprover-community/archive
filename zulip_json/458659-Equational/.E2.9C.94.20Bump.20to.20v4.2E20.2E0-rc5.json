[
    {
        "content": "<p>I have finally found the time (and the courage <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span>) to start working on a draft PR (<a href=\"https://github.com/teorth/equational_theories/pull/1209\">equational#1209</a>) to bump the toolchain to the latest version (<code>v20.0-rc5</code>). Any help would be greatly appreciated, especially from the authors of individual files who are more familiar with their respective components.</p>",
        "id": 517715804,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747102551
    },
    {
        "content": "<p>I'm commenting with <code>[ERROR]</code> everything that I'm not sure how to fix and tagging the individual authors who might have suggestions (see <a href=\"https://github.com/teorth/equational_theories/pull/1209/files\">here</a>).</p>",
        "id": 517716020,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747102644
    },
    {
        "content": "<p>I can take a look at 1692</p>",
        "id": 517716412,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1747102812
    },
    {
        "content": "<p>9 crucial files (all those in <code>Equations</code> for example) depend directly on <code>equational_theories.Equations.Command</code> (and many more indirectly of course), but I'm not sure how to fix <a href=\"https://github.com/teorth/equational_theories/pull/1209/files#r2085803875\">this small bit</a> <span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span>.</p>",
        "id": 517717106,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747103115
    },
    {
        "content": "<p>All files in <code>Generated</code> will need to be reproduced after the imports are fixed and a few additional adjustments are made to the relevant scripts.</p>",
        "id": 517719601,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747104206
    },
    {
        "content": "<p><a href=\"https://github.com/teorth/equational_theories/pull/1210\">equational#1210</a></p>",
        "id": 517723435,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1747105832
    },
    {
        "content": "<p>Ok, I have fixed about 80 files and <a href=\"https://github.com/teorth/equational_theories/pull/1209#issuecomment-2875253142\">here</a> is the list of remaining files (or folders) to fix. I'll continue later today or tomorrow.</p>\n<p>In the meantime, if you would like to help me, please open a PR to the existing PR (<a href=\"https://github.com/teorth/equational_theories/pull/1209\">equational#1209</a>), as Mario did (<a href=\"https://github.com/teorth/equational_theories/pull/1210\">equational#1210</a>).</p>",
        "id": 517745450,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747117100
    },
    {
        "content": "<p>Nice work! I've put up changes FullSpectrum and a partial fix for for <code>*.Generated.Greedy*</code>. Unfortunately one file, Eq511.lean, needs a further heartbeats change for some <code>PartialSolution.counter*</code> defs that seems quite large, from 400k -&gt; ~1m and I suspect that there may be a simple change in how we are using aesop to get this under control,  but I'm not familiar with this code. tagging <span class=\"user-mention\" data-user-id=\"690858\">@Daniel Weber</span></p>",
        "id": 517760846,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1747122887
    },
    {
        "content": "<p>These parts should be faily trivial, they just verify that the given partial solution satisfies all the rules. I'll try writing a <code>Decidable</code> instance later instead of using <code>aesop</code> there</p>",
        "id": 517762253,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1747123277
    },
    {
        "content": "<p>I created <a href=\"https://github.com/teorth/equational_theories/pull/1215\">equational#1215</a></p>",
        "id": 517870653,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1747152441
    },
    {
        "content": "<p>All the generated <code>Refutation</code> files in <code>equational_theories.Generated.All4x4Tables</code> and in <code>equational_theories.Generated.FinSearch</code> are encountering the following error: </p>\n<div class=\"codehilite\" data-code-language=\"Bash Session\"><pre><span></span><code><span class=\"go\">declaration uses a prohibited axiom: Lean.ofReduceBool</span>\n</code></pre></div>\n<p>Not at all sure what's the best fix here. Obviously if I add <code>Lean.ofReduceBool</code> to the <code>equationalResultAttr</code> as follows it's going to work:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">initialize</span><span class=\"w\"> </span><span class=\"n\">equationalResultAttr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"bp\">←</span>\n<span class=\"w\">  </span><span class=\"n\">registerBuiltinAttribute</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"n\">name</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"ss\">`equational_result</span>\n<span class=\"w\">    </span><span class=\"n\">descr</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">equationalResultHelpString</span>\n<span class=\"w\">    </span><span class=\"n\">applicationTime</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">AttributeApplicationTime</span><span class=\"bp\">.</span><span class=\"n\">afterCompilation</span>\n<span class=\"w\">    </span><span class=\"n\">add</span><span class=\"w\">   </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">declName</span><span class=\"w\"> </span><span class=\"n\">stx</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">attrKind</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">       </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">ctx</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">read</span>\n<span class=\"w\">       </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">filename</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ctx</span><span class=\"bp\">.</span><span class=\"n\">fileName</span>\n<span class=\"w\">       </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">line</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">stx</span><span class=\"bp\">.</span><span class=\"n\">getPos?</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">pos</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">ctx</span><span class=\"bp\">.</span><span class=\"n\">fileMap</span><span class=\"bp\">.</span><span class=\"n\">toPosition</span><span class=\"w\"> </span><span class=\"n\">pos</span><span class=\"w\"> </span><span class=\"bp\">|&gt;.</span><span class=\"n\">line</span>\n<span class=\"w\">       </span><span class=\"n\">discard</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">MetaM</span><span class=\"bp\">.</span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">       </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mut</span><span class=\"w\"> </span><span class=\"n\">is_conjecture</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">false</span>\n<span class=\"w\">       </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">axioms</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">collectAxioms</span><span class=\"w\"> </span><span class=\"n\">declName</span>\n<span class=\"w\">       </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">axioms</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">         </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"ss\">`Conjecture.conjectureAx</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">           </span><span class=\"n\">is_conjecture</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"w\">         </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"ss\">``propext</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"ss\">``Classical.choice</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"ss\">``Quot.sound</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"ss\">``Lean.ofReduceBool</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">           </span><span class=\"n\">throwError</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"declaration uses a prohibited axiom: {a}\"</span>\n<span class=\"w\">    </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>but I'm not at all comfortable playing with axioms so I think it's better to ask here.</p>\n<p>Tagging contributors to these files <span class=\"user-mention\" data-user-id=\"761203\">@Vlad Tsyrklevich</span> <span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span> <span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span>.</p>\n<p>PS: For reproducibility purposes the <code>generate_lean.py</code> should be fixed and run again I suppose.</p>",
        "id": 517949736,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747185242
    },
    {
        "content": "<p>There is a <code>native_decide</code> in the implementation of <code>finOpTable</code></p>",
        "id": 517952338,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1747187051
    },
    {
        "content": "<p>which appears to have been added very recently by you <span class=\"user-mention\" data-user-id=\"556875\">@Pietro Monticone</span> ?</p>",
        "id": 517952374,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1747187087
    },
    {
        "content": "<p>I thought we decided not to use native_decide in this project</p>",
        "id": 517952445,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1747187127
    },
    {
        "content": "<p>I guess it was a reaction to <code>decide!</code> disappearing</p>",
        "id": 517952466,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1747187148
    },
    {
        "content": "<p>Ops, Mario is right. Let me fix it...</p>",
        "id": 517952467,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747187148
    },
    {
        "content": "<p>I think the replacement is <code>decide +kernel</code> although I'm not sure</p>",
        "id": 517952478,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1747187159
    },
    {
        "content": "<p><code>decide</code> compiles</p>",
        "id": 517952553,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747187190
    },
    {
        "content": "<p><code>decide +kernel</code> is more efficient for non-interactive and tool-generated uses</p>",
        "id": 517952577,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1747187212
    },
    {
        "content": "<p>Ok, I'll use that then. Thanks !</p>",
        "id": 517952612,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747187244
    },
    {
        "content": "<p>For reference (and iirc) <code>ofReduceBool</code> is the axiom that, by some convoluted way, means that we trust the compiler</p>",
        "id": 517952930,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1747187464
    },
    {
        "content": "<p>Aren’t there some other tactics that trust the compiler? some variant of simp? Was it csimp?</p>",
        "id": 517953031,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1747187533
    },
    {
        "content": "<p>Ok, here is the updated task list <a href=\"https://github.com/teorth/equational_theories/pull/1209#issuecomment-2875253142\">https://github.com/teorth/equational_theories/pull/1209#issuecomment-2875253142</a></p>",
        "id": 517953440,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747187832
    },
    {
        "content": "<p>I had a go a Equation 73, see <a href=\"https://github.com/teorth/equational_theories/pull/1216\">equational#1216</a>. I think many of the files in <code>ManuallyProved</code> can be adjusted in the same way</p>",
        "id": 518019626,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1747216076
    },
    {
        "content": "<p>Ok, the PR now contains more equations, namely <code>63, 73, 917, 1017, 1518, 1526</code></p>",
        "id": 518048606,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1747224683
    },
    {
        "content": "<p>Updated task list <a href=\"https://github.com/teorth/equational_theories/pull/1209#issuecomment-2880480354\">https://github.com/teorth/equational_theories/pull/1209#issuecomment-2880480354</a></p>",
        "id": 518083617,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747233250
    },
    {
        "content": "<p>Could someone with permissions move the discussion about <code>ofReduceBool</code> to another topic? It's a bit offtopic in this one</p>",
        "id": 518084465,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1747233447
    },
    {
        "content": "<p>I made <a href=\"https://github.com/teorth/equational_theories/pull/1217\">equational#1217</a>.</p>",
        "id": 518091554,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1747235078
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"562819\">@Bernhard Reinke</span> and <span class=\"user-mention\" data-user-id=\"690858\">@Daniel Weber</span>. Merged both.</p>",
        "id": 518092136,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747235207
    },
    {
        "content": "<p>Ok, we are <em>almost</em> done (115 / 118)! <a href=\"https://github.com/teorth/equational_theories/pull/1209\">equational#1209</a></p>\n<p>Here are the remaining files to fix (tagging the main file authors who, being more familiar, could be much more efficient than me): </p>\n<ul>\n<li><code>equational_theories.ManuallyProved.Equation1692</code> (<span class=\"user-mention\" data-user-id=\"753178\">@Aaron Hill</span>)</li>\n<li><code>equational_theories.Obelix</code> (<span class=\"user-mention\" data-user-id=\"448405\">@Alex Meiburg</span>)</li>\n<li><code>equational_theories.Equations.LawsComplete</code> (<span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span>)</li>\n</ul>",
        "id": 518183835,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747269267
    },
    {
        "content": "<p>I opened <a href=\"https://github.com/teorth/equational_theories/pull/1221\">https://github.com/teorth/equational_theories/pull/1221</a></p>",
        "id": 518840818,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1747505439
    },
    {
        "content": "<p>Great! We have two files left. I'll probably find some time next week in case the authors can't.</p>",
        "id": 518841399,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747505843
    },
    {
        "content": "<p>Which files are these? I can potentially make some progress tonight</p>",
        "id": 518843466,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1747507179
    },
    {
        "content": "<p>The two listed above (except the one just fixed by Aaron of course).</p>",
        "id": 518843571,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747507228
    },
    {
        "content": "<p>I should be able to do mine tonight</p>",
        "id": 518843783,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1747507370
    },
    {
        "content": "<p>Great! Thanks, Alex!</p>",
        "id": 518843837,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747507409
    },
    {
        "content": "<p>I <a href=\"https://github.com/teorth/equational_theories/pull/1224\">did a bit</a>  of the LawsComplete file. Mostly it all broke because <code>idxOf?</code> and <code>findIdx?</code> had their definitions completely changed, recently. Sadly messier to clean up than I hoped.</p>\n<p>Several of those lemmas should be upstreamed to Batteries when done.</p>",
        "id": 518883280,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1747541429
    },
    {
        "content": "<p>Bumped the other one :) <a href=\"https://github.com/teorth/equational_theories/pull/1227\">https://github.com/teorth/equational_theories/pull/1227</a></p>",
        "id": 518928961,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1747580108
    },
    {
        "content": "<p>Thanks, Alex! Merged.</p>",
        "id": 518929043,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747580167
    },
    {
        "content": "<p>Sorry about that -- I messed up slightly and there was a broken line that I missed in the commit. Should be this <a href=\"https://github.com/teorth/equational_theories/pull/1228\">https://github.com/teorth/equational_theories/pull/1228</a></p>",
        "id": 518929700,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1747580681
    },
    {
        "content": "<p>No problem, merged.</p>",
        "id": 518929752,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747580718
    },
    {
        "content": "<p>I’ve just pinned the  <code>v4.20.0-rc5</code> version for both Mathlib and DocGen and added the <code>create-release</code> workflow. Let’s wait for the CI to succeed and then we can go ahead and finally merge this thing (<a href=\"https://github.com/teorth/equational_theories/pull/1209\">equational#1209</a>).</p>",
        "id": 518932968,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747583164
    },
    {
        "content": "<p>Merged. Thanks to all those who contributed!</p>\n<p><a href=\"https://github.com/teorth/equational_theories/releases\">https://github.com/teorth/equational_theories/releases</a></p>",
        "id": 518952913,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1747598458
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"556875\">Pietro Monticone</span> has marked this topic as resolved.</p>",
        "id": 518952926,
        "sender_full_name": "Notification Bot",
        "timestamp": 1747598464
    }
]