[
    {
        "content": "<p>My general sense is that most of the projects discussed in this channel are custom, open-source models tuned for Lean specifically. However, the closed-source frontier LLMs are getting pretty good as agents these days. So:</p>\n<p>I'd be curious to see the best current attempt at making a VSCode plugin that iteratively asks asks an LLM to rewrite a proof, then shows it the tactic state, then iterates. In particular, I'm curious for the version that tries to use an unmodified, untuned frontier LLM via API, both for simplicity and so that it can easily be tried on new models without any update step.</p>\n<p>Ideally, this would involve stuffing most/all of the other files of the project into context-cached context. My main claim is that this kind of setup would often be useful out of the box, even without familiarity with the relevant other parts of Mathlib, because <strong>most projects have similar reasoning in other proofs that the model can attend over</strong>. If there is a particular theorem that the agent doesn't know how to use, you can put it in a prompt or in a comment above, and the system prompt could explain to the LLM how to use <code>#check</code> to see full types of such lemmas.</p>\n<p>Has anyone built such a VSCode plugin?</p>",
        "id": 501643912,
        "sender_full_name": "Geoffrey Irving",
        "timestamp": 1740429663
    },
    {
        "content": "<p><a href=\"https://github.com/GasStationManager/LeanTool\">LeanTool</a> does part of what you are asking. It does the LLM-Lean feedback loop. One of the interfaces it exports is an openAI-compatible proxy server, which you can then plug into a VS Code plugin coding assistant like Cline &amp; Continue, or a command line one like Aider.<br>\nAs for managing the context of the rest of the project, presumably these coding assistants can do some form of that, but I have not tested how well it works together with LeanTool.</p>",
        "id": 501645614,
        "sender_full_name": "GasStationManager",
        "timestamp": 1740430297
    },
    {
        "content": "<p>A while ago we built <a href=\"https://www.youtube.com/watch?v=CEwRMT0GpKo\">Sagredo</a>. It mostly did what you suggest, iterating on errors, except that I don't think we were including other files in the context (this was back when contexts were much shorter). <a href=\"https://github.com/lean-dojo/LeanCopilot\">LeanCopilot</a> also seems to have the capacity to run off-the-shelf LLMs.</p>\n<div class=\"youtube-video message_inline_image\"><a data-id=\"CEwRMT0GpKo\" href=\"https://www.youtube.com/watch?v=CEwRMT0GpKo\"><img src=\"https://uploads.zulipusercontent.net/334dd3177945ef6955a1e621087a23617632651b/68747470733a2f2f692e7974696d672e636f6d2f76692f434577524d543047704b6f2f64656661756c742e6a7067\"></a></div>",
        "id": 501645807,
        "sender_full_name": "ğš ğš˜ğš“ğšŒğš’ğšğšŒğš‘ ğš—ğšŠğš ğš›ğš˜ğšŒğš”ğš’",
        "timestamp": 1740430345
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"776090\">@GasStationManager</span>: To clarify, it <strong>could</strong> be plugged into VSCode, but isnâ€™t yet?</p>",
        "id": 501645815,
        "sender_full_name": "Geoffrey Irving",
        "timestamp": 1740430347
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"514145\">Geoffrey Irving</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/VSCode.20plugin.20that.20connects.20an.20agent.20to.20the.20tactic.20state/near/501645815\">said</a>:</p>\n<blockquote>\n<p>To clarify, it <strong>could</strong> be plugged into VSCode, but isnâ€™t yet?</p>\n</blockquote>\n<p>I have tested the set up to confirm that it works in Cline and Continue and Aider, at least the chat agent part. Have not tested more sophisticated code action features that these assistants have; more testing are welcome!</p>",
        "id": 501646430,
        "sender_full_name": "GasStationManager",
        "timestamp": 1740430553
    },
    {
        "content": "<p>LeanCopilot seems like it is trying to do something nontrivially different than direct agent iteration, including <code>aesop</code>-like iteration rather than whole proof rewriting. I think it is plausible that whole proof rewrites work better in some cases: certainly I often learn something from one part of the tactic tree that is helpful in some other part.</p>",
        "id": 501646875,
        "sender_full_name": "Geoffrey Irving",
        "timestamp": 1740430696
    },
    {
        "content": "<p>I have built an extension, <a href=\"https://github.com/oOo0oOo/lean-scribe\">Lean Scribe</a>, that fits some of your requirements.</p>\n<p>It allows you to define and render context-rich prompts. To include for example the tactic state at the cursor position, all diagnostic messages in the current file, or the the result of running a tactic at the cursor position.</p>\n<p>Lean Scribe also allows for easy use and configuration of models (API or ollama) and supports all state-of-the-art models. I have used it today with Claude 3.7, it performs OK on the simple problems I have tried.</p>\n<p>However, it is a manual tool for now. The iterative loop is planned but I want to get the human-in-control mode right first.</p>",
        "id": 501647470,
        "sender_full_name": "Oliver Dressler",
        "timestamp": 1740430900
    },
    {
        "content": "<p>Could be interesting to compare with how Claude is playing pokemon (live on twitch) . I think there they provided Claude with some scratch pad to log working knowledge/long term plan + some scaffolding to help it navigate &amp; not get stuck </p>\n<p>Btw how good is Claude computer control at doing lean proofs--have anyone tried?</p>",
        "id": 502007644,
        "sender_full_name": "Andy Jiang",
        "timestamp": 1740564729
    },
    {
        "content": "<p>VSCode Insiders (the bleeding edge version of VSCode) has released a native <a href=\"https://code.visualstudio.com/blogs/2025/02/24/introducing-copilot-agent-mode\">agent mode</a> end of Feb. This feature should arrive \"soon\" in stable VSCode.</p>\n<p>It allows VSCode to iteratively edit files, check diagnostics, and interact with <a href=\"https://modelcontextprotocol.io/introduction\">MCP servers</a>, similar to how Cursor works.</p>\n<p>Since LeanTool by <span class=\"user-mention\" data-user-id=\"776090\">@GasStationManager</span>  (see above) has an MCP mode it should be relatively straight forward to integrate with this new agent mode.</p>\n<p>I have also recently made an <a href=\"https://github.com/oOo0oOo/lean-lsp-mcp\">MCP server</a> that exposes various tools for the LLM agent: E.g. Query the tactic state or term goal at any position. With the new agent mode this became essentially a one-click install for VSCode Insiders.</p>",
        "id": 509222920,
        "sender_full_name": "Oliver Dressler",
        "timestamp": 1743432481
    },
    {
        "content": "<p>Very cool! I think tools that expose Lean's features to LLMs are greatly needed. And MCP seems to have emerged as a standard protocol for this, being adopted by multiple vendors.</p>",
        "id": 509234125,
        "sender_full_name": "GasStationManager",
        "timestamp": 1743434923
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"802311\">@Oliver Dressler</span> That's very cool! I had expected a similar functionality to be available for rust, but I cannot find an MCP interface for rust-analyzer yet...</p>",
        "id": 509473604,
        "sender_full_name": "Bas Spitters",
        "timestamp": 1743519060
    }
]