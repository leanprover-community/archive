[
    {
        "content": "<p>Im trying to get LeanCopilot running, in order to obtain some help when learning LEAN. <br>\nHowever I have some troubles to get it running. So my question is addressed at someone who is actually working with this CoPilot. </p>\n<p>My Environment.<br>\nOS: Fedora 41<br>\nEditor: neovim0.10.4<br>\nLean version: 4.18.0-rc1<br>\nLake version: 5.0.0-69a1d04</p>\n<p>When trying to build, I obtain following messages: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stderr</span><span class=\"o\">:</span>\n<span class=\"n\">libc</span><span class=\"bp\">++</span><span class=\"n\">abi</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">terminating</span><span class=\"w\"> </span><span class=\"n\">due</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">uncaught</span><span class=\"w\"> </span><span class=\"n\">exception</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"bp\">::</span><span class=\"n\">exception</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">loading</span><span class=\"w\"> </span><span class=\"n\">library</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">libctranslate2</span><span class=\"bp\">.</span><span class=\"n\">so</span><span class=\"bp\">.</span><span class=\"m\">4</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">shared</span><span class=\"w\"> </span><span class=\"n\">object</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">No</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">134</span>\n</code></pre></div>\n<p>I have included <br>\n<code>moreLinkArgs = [\"-L./.lake/packages/LeanCopilot/.lake/build/lib\", \"-lctranslate2\"]</code><br>\nat the top of my toml. It seams to me that this is the source of error.</p>\n<p>And get it using </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">[[</span><span class=\"n\">require</span><span class=\"o\">]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"LeanCopilot\"</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/lean-dojo/LeanCopilot.git\"</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"main\"</span>\n</code></pre></div>\n<p>The library libctranslate2.so.4, is present at /.lake/packages/LeanCopilot/.lake/build/lib/<br>\nBut a folder /.lake/packages/LeanCopilot/.lake/build/CTranslate2 is entirely missing. I dont know if this is the default.</p>",
        "id": 503818872,
        "sender_full_name": "Daniel Rehsmann",
        "timestamp": 1741273867
    },
    {
        "content": "<p>I see you found a solution to the problem—thanks, it helped me out!<br>\n<a href=\"https://github.com/lean-dojo/LeanCopilot/issues/153\">https://github.com/lean-dojo/LeanCopilot/issues/153</a></p>\n<p>By the way, when using LeanCopilot with mathlib4, do you also experience that Copilot somehow confuses the Lean cache?</p>",
        "id": 505610536,
        "sender_full_name": "Janos Wolosz",
        "timestamp": 1741940140
    },
    {
        "content": "<p>Hey no problem. In my fork I also incorporated cuda and cudnn acceleration, which was turned off by default. So you can use hardware acceleration if you want.</p>\n<p>How do you see this confusion?</p>",
        "id": 505716821,
        "sender_full_name": "Daniel Rehsmann",
        "timestamp": 1741969480
    },
    {
        "content": "<p>I am getting the following error message during the <code>lake exe cache get</code> step:<br>\n<code>Failed to connect to lakecache.blob.core.windows.net port 443 after 34 ms: Couldn't connect to server</code></p>\n<p>This never happens when my branch is independent of LeanCopilot.</p>\n<p>My setup method can be summarized as follows (assuming I am on a local branch that was branched off from <code>mathlib4</code>'s <code>master</code>):</p>\n<ol>\n<li>Merge my <a href=\"https://github.com/leanprover-community/mathlib4/compare/master...janos-wolosz/dojo\">dojo</a> branch.</li>\n<li>Run <code>lake update LeanCopilot</code>.</li>\n<li>Run <code>lake exe cache get</code>.</li>\n<li>Run <code>lake build</code>.</li>\n</ol>\n<p>If I forget to get the cache on the original branch before the merge, step 4 will take a very long time.</p>",
        "id": 505739633,
        "sender_full_name": "Janos Wolosz",
        "timestamp": 1741975862
    },
    {
        "content": "<p>You could <em>try</em> disabling your antivirus if you're on windows (antivirus is responsible for some network issues sometimes) but I'm not optimistic that this will solve your problem</p>",
        "id": 505741069,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1741976384
    },
    {
        "content": "<p>I see - but it seems to me that Lean Copilot is only supported on Windows WSL. In which step does this error occur? Building libraries? Downloading models?</p>\n<p>You can try to manually download the llms. <br>\nAlso make sure you have git-lfs installed.</p>",
        "id": 505774456,
        "sender_full_name": "Daniel Rehsmann",
        "timestamp": 1741990065
    },
    {
        "content": "<p>Thanks for your helpful attitude! Let me emphasize that after applying <span class=\"user-mention\" data-user-id=\"882077\">@Daniel Rehsmann</span> 's <a href=\"https://github.com/lean-dojo/LeanCopilot/issues/153\">fix</a>, LeanCopilot is working on my Ubuntu system—it’s just not very convenient to apply it to a new branch after branching off from the mathlib4 <code>master</code>.</p>\n<p>I’m attaching the log of my <code>lake exe cache get</code> step. To be honest, I already find it quite suspicious that some C++ compilation is taking place during a cache retrieval step.</p>\n<p>That said, my experience with LeanCopilot has been quite positive. While it can’t handle mathematically challenging steps for me, <code>search_proof</code> is quite useful for dealing with coercions, simp, and similar issues. In my experience, it’s definitely smarter than <code>apply?</code>, so as a beginner Lean user, I find it to be a really helpful tool.<br>\n<a href=\"/user_uploads/3121/h1dBBAyPYSHHgG3MW_Wi-g8g/lean_copilot_cache_get_log.txt\">lean_copilot_cache_get_log.txt</a></p>",
        "id": 505872229,
        "sender_full_name": "Janos Wolosz",
        "timestamp": 1742062607
    },
    {
        "content": "<p>It seems that you have troubles downloading mathlib4. ‘lake update’, does not incur errors?</p>",
        "id": 505950940,
        "sender_full_name": "Daniel Rehsmann",
        "timestamp": 1742126799
    },
    {
        "content": "<p>Exactly. I have trouble downloading the mathlib4 cache, but only when LeanCopilot is added to <code>lakefile.lean</code>. Without LeanCopilot, everything works fine, and I can get the repository running in a minute.</p>\n<p>Even with LeanCopilot, <code>lake update</code> completes without errors. I'm just curious if anyone else has encountered this. But since I have a workaround, I don't think this needs deep investigation.</p>",
        "id": 506467395,
        "sender_full_name": "Janos Wolosz",
        "timestamp": 1742301188
    }
]