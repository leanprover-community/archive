[
    {
        "content": "<p>Looks like Deepseek's new model set a new record on PutnamBench -&gt;https://x.com/zhs05232838/status/1917600755936018715</p>",
        "id": 515338707,
        "sender_full_name": "Andy Jiang",
        "timestamp": 1746027811
    },
    {
        "content": "<p>49 problems solved is a huge improvement over previous bests. I've reached out to the DeepSeek team so they can send me the proofs to validate, so I can add the model to the leaderboard. (Though I only sent to their service email, if any members of the team see this, reach out!)</p>",
        "id": 515339204,
        "sender_full_name": "George Tsoukalas",
        "timestamp": 1746027942
    },
    {
        "content": "<p>I like the super long Lean proof starting page 23 and ending page 32 of the <a href=\"https://github.com/deepseek-ai/DeepSeek-Prover-V2/blob/main/DeepSeek_Prover_V2.pdf\">report</a> <span aria-label=\"exploding head\" class=\"emoji emoji-1f92f\" role=\"img\" title=\"exploding head\">:exploding_head:</span></p>",
        "id": 515365833,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746035522
    },
    {
        "content": "<p>It has certainly learned how to break proofs into small steps!</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">[</span><span class=\"bp\">...</span><span class=\"o\">]</span>\n<span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h30</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">omega</span>\n<span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h31</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⩾</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">omega</span>\n<span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h32</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⩾</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">omega</span>\n<span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h33</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">−</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">−</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">−</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">−</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">linarith</span>\n<span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h34</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">omega</span>\n<span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h35</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⩾</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">omega</span>\n<span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h36</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⩾</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">omega</span>\n<span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h37</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">−</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">−</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">−</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">−</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">linarith</span>\n<span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h38</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">False</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h39</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">omega</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h40</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⩾</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">omega</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h41</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⩾</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">omega</span>\n<span class=\"o\">[</span><span class=\"bp\">...</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 515377690,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1746039521
    },
    {
        "content": "<p>But joking aside, the performance and these formal proofs look impressive! That is very different than some of the previous proofs that some models gave, which basically felt like \"we learned how to provide 2 useful arguments to <code>nlinarith</code>\".</p>",
        "id": 515377693,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1746039523
    },
    {
        "content": "<p>Maybe this should be its own topic?</p>",
        "id": 515377848,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746039601
    },
    {
        "content": "<p>6 messages were moved here from <a class=\"stream-topic\" data-stream-id=\"219941\" href=\"/#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/PutnamBench/with/452196205\">#Machine Learning for Theorem Proving &gt; PutnamBench</a> by <span class=\"user-mention silent\" data-user-id=\"111080\">Floris van Doorn</span>.</p>",
        "id": 515378257,
        "sender_full_name": "Notification Bot",
        "timestamp": 1746039737
    },
    {
        "content": "<p>This is impressive work!  I look forward to understanding it better, especially in relation to the recent Kimina work.</p>",
        "id": 515387467,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746042992
    },
    {
        "content": "<p>Does validation for PutnamBench include making sure that the proofs do solve the intended informal problem (rather than showing up incorrect formal statements in the benchmark)?</p>\n<p>The report also refers to solving 12 problems from CombiBench, which even more needs assessment of whether those problems have correct formal statements.</p>",
        "id": 515419949,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1746057595
    },
    {
        "content": "<p>Given this work, does DeepSeek intend to make formal-to-formal attempts at the problems from the next few IMOs, Putnams etc. when they come out (preferably with independent formal statements shared between all AIs making such attempts for better comparability than each AI having its own Lean versions of the problems)?</p>",
        "id": 515420407,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1746057775
    },
    {
        "content": "<p>One unfortunate thing I noticed from the paper is that it's evaluated using Lean 4.9 (which was released last July) and benchmark problems which are incompatible with Lean 4.9 are excluded. It's not clear to me whether this is due to model limitations or for better testing control (since DeepSeek-Prover-1.5 is also evaluated with Lean 4.9)</p>",
        "id": 515450770,
        "sender_full_name": "Li Xuanji",
        "timestamp": 1746077767
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"308587\">Li Xuanji</span> <a href=\"#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515450770\">said</a>:</p>\n<blockquote>\n<p>One unfortunate thing I noticed from the paper is that it's evaluated using Lean 4.9 (which was released last July) and benchmark problems which are incompatible with Lean 4.9 are excluded. It's not clear to me whether this is due to model limitations or for better testing control (since DeepSeek-Prover-1.5 is also evaluated with Lean 4.9)</p>\n</blockquote>\n<p>I just opened my phone to post the same point, but you were there first</p>",
        "id": 515457438,
        "sender_full_name": "Alok Singh",
        "timestamp": 1746082038
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515387467\">said</a>:</p>\n<blockquote>\n<p>This is impressive work!  I look forward to understanding it better, especially in relation to the recent Kimina work.</p>\n</blockquote>\n<p>They speak a bit to this  point in the <strong>Cold Start by Synthetic Data</strong> subsection of Section 2.2</p>",
        "id": 515465551,
        "sender_full_name": "Kelly Davis",
        "timestamp": 1746086669
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"308587\">Li Xuanji</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515450770\">said</a>:</p>\n<blockquote>\n<p>One unfortunate thing I noticed from the paper is that it's evaluated using Lean 4.9 (which was released last July) and benchmark problems which are incompatible with Lean 4.9 are excluded. It's not clear to me whether this is due to model limitations or for better testing control (since DeepSeek-Prover-1.5 is also evaluated with Lean 4.9)</p>\n</blockquote>\n<p>I would say it is probably neither about \"model limitations\" or \"better testing control\", but just about their technical setup. They are using <a href=\"https://github.com/xinhjBrant/mathlib4/tree/deepseek\">https://github.com/xinhjBrant/mathlib4/tree/deepseek</a> with a fixed version of a forked REPL. Their tooling and datasets are probably built around that.</p>",
        "id": 515465796,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746086782
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"644040\">George Tsoukalas</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515339204\">said</a>:</p>\n<blockquote>\n<p>49 problems solved is a huge improvement over previous bests. I've reached out to the DeepSeek team so they can send me the proofs to validate, so I can add the model to the leaderboard. (Though I only sent to their service email, if any members of the team see this, reach out!)</p>\n</blockquote>\n<p>Let me ask Zhihong about this.</p>",
        "id": 515485429,
        "sender_full_name": "Albert Jiang",
        "timestamp": 1746097195
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"258175\">@Albert Jiang</span> you may want to also point out all the mistakes people found in their benchmark: <a href=\"#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/ProverBench/\">https://leanprover.zulipchat.com/#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/ProverBench/</a></p>",
        "id": 515485898,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746097425
    },
    {
        "content": "<p>Well, I tried the 7B model locally, and it worked really great. But there's something I feel that I have to point out: In the Appendix B of the paper, both of the proofs there has used <code>apply?</code>, and the proof seems not to actually work? (Since aside from <code>apply?</code>, it seems that nothing non-trivial has been proved, so I'm wondering if they have mistaken that as having proved the problem?)</p>",
        "id": 515487837,
        "sender_full_name": "Wang Jingting",
        "timestamp": 1746098475
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"750070\">Wang Jingting</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515487837\">said</a>:</p>\n<blockquote>\n<p>Well, I tried the 7B model locally, and it worked really great. But there's something I feel that I have to point out: In the Appendix B of the paper, both of the proofs there has used <code>apply?</code>, and the proof seems not to actually work? (Since aside from <code>apply?</code>, it seems that nothing non-trivial has been proved, so I'm wondering if they have mistaken that as having proved the problem?)</p>\n</blockquote>\n<p>I agree it looks wrong.  The proof doesn't use most of the assumptions.  <span class=\"user-mention\" data-user-id=\"644040\">@George Tsoukalas</span> Please look at this one closely when you get a chance.   Is this problem wrong in PutnamBench, or do they have a buggy proof-checking harness?  If the latter, I'm worried that their numbers might be much too high due to bugs in their infrastructure.</p>",
        "id": 515499255,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746103674
    },
    {
        "content": "<p>A wrong <code>apply?</code> proof being accepted closely resembles to the <a href=\"https://github.com/leanprover-community/repl/issues/44\">bugs</a> of the tactic mode of the REPL that have been recently <a href=\"https://github.com/leanprover-community/repl/pull/63\">fixed</a> (second <a href=\"https://github.com/leanprover-community/repl/pull/82\">fix</a> specific to wrong self-application).<br>\nHowever, I would be surprised if they used the REPL tactic mode for DeepSeekProver-V2 given that they only used the command mode for DeepSeek-Prover v1.5 as far as I know. And from what I understand in their DeepSeek-Prover V2 report, they are also very likely using the command mode only.</p>",
        "id": 515499970,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746104010
    },
    {
        "content": "<p>It would be good to go through their miniF2F solutions and find proofs with <code>apply?</code>.  (And also to independently check all their solutions in Lean 4.9 or whatever it is that they use.)</p>",
        "id": 515501409,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746104617
    },
    {
        "content": "<p>There is another Putnam <a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQEwCmAdnAMoHwByKcAYgK5EDGMwEROOaB0BIcYejCJIQAfQBMABikB2MVgAsOABQkAXHECohAEo4ayAGc4mkgD44UvetUBvFQAUANHACK1/Q4joAnkQggwEjocIC4hHoA657efgFBIeFwAD5wDnAAenAScADUbhlZcAC8qTH+gcEAdAAaBSrZAFRwRHp5AIxwgOREqZUAJgQA5lAEBHBmOHBufYPDBAC+lcxIUL3F+ioAZozNxRbZmWq5cG06HlpwgEmE2notJiVYPhNwqEgAbqOoHZqAAEQ7mloucyWS76WyeFzuEzRXzleJhSLQ2IVBJ6FJpTLZPKuArZEpeGFxKq1A6NJ63dpdHr9IYjMZTamzOALJYrKG6Nb7fQkdrWe6PSaTYBEGBQCA7VAcAXPN4fKG/DTaQF0qQglRgxwQjyOMqElFwKLagnI+HJVI4o7YjFrfFI+I1OqNZo6J6TCndBzTGmjCyuT2M5lMZarf56Eqcw48u5wB4ugVCkVikgS2OTF7vZ5fUHgtxam2w4Img153UmtHmrHmvE65H2klwJrk45dFMCj0M2k+v20gNBtmhwoHbnHXnR/lSgVpj7ZTRq7OQmfF42JIvVuGJMtWitWqtGu3E/SOxsdTotqVtmYd+kX0ZzKHkeAqQ22gvLxH5lGnRaB1lhupDk5RjG47jlAADucAANoAMJBkKVQiDAMGGDAYhCgAVgAuqeApIGAYC+AA/NhBAAB5ICwYggBAvRiIGyHPBILakeR8CfLGzEsM84qStK6aoNOWYajmUJPu+hZviW65mpu+TbqUu5Eg69ZOkcx5Utesadu2N5fr2IYcn+qkjkBOF4b4GbsWRnFEEYTyGKAYBIJB/EYXA9D2UQAwMUAA\">problem</a> using <code>apply?</code> that only formalizes variations of the answer statement in <code>have</code> statements without proof and then uses the final one to close the goal. I am really use about the results of this paper now, I would speculate that their REPL is dodgy and allows for these proofs to pass. Just a quick mention that the Kimina Lean server (<a href=\"https://github.com/project-numina/kimina-lean-server\">https://github.com/project-numina/kimina-lean-server</a>) catches these proofs as incomplete.</p>",
        "id": 515510174,
        "sender_full_name": "Mantas Baksys",
        "timestamp": 1746108017
    },
    {
        "content": "<p>Yes, for example the first proof of Appendix B doesn't pass our verification with the <a href=\"https://arxiv.org/abs/2504.21230\">Kimina Lean Server</a>:<br>\n<code>{'has_error': False, 'is_valid_no_sorry': False, 'is_valid_with_sorry': True}</code><br>\nIt is a valid proof, but it counts as a proof using <code>sorry</code>.</p>",
        "id": 515510370,
        "sender_full_name": "Marco Dos Santos",
        "timestamp": 1746108075
    },
    {
        "content": "<p>This could be really bad for them.  Is anyone willing to check all there minif2f results?  (They haven’t posted the Putnam bench results yet.)</p>",
        "id": 515510636,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746108152
    },
    {
        "content": "<p>Let me try to validate their MiniF2F using Kimina Lean Server.</p>",
        "id": 515513137,
        "sender_full_name": "Mert Ünsal",
        "timestamp": 1746108974
    },
    {
        "content": "<p>(They officially use Lean 4.9 I think, so that may create issues.)</p>",
        "id": 515513322,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746109052
    },
    {
        "content": "<p>I tested both proofs published in Appendix B using Lean <code>v4.9.0</code> and I can confirm they're both incomplete.</p>",
        "id": 515513719,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1746109187
    },
    {
        "content": "<p>Just checked all their minif2f proofs using LeanInteract with Lean v4.9.0. Unless I made a mistake in my code, no issues to report. They probably just made a mistake in their appendix.</p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>Code</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">os</span>\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">concurrent.futures</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">ThreadPoolExecutor</span><span class=\"p\">,</span> <span class=\"n\">as_completed</span>\n\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">lean_interact</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">AutoLeanServer</span><span class=\"p\">,</span> <span class=\"n\">FileCommand</span><span class=\"p\">,</span> <span class=\"n\">LeanREPLConfig</span><span class=\"p\">,</span> <span class=\"n\">TempRequireProject</span>\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">lean_interact.interface</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">LeanError</span>\n\n<span class=\"n\">config</span> <span class=\"o\">=</span> <span class=\"n\">LeanREPLConfig</span><span class=\"p\">(</span><span class=\"n\">lean_version</span><span class=\"o\">=</span><span class=\"s2\">\"v4.9.0\"</span><span class=\"p\">,</span> <span class=\"n\">project</span><span class=\"o\">=</span><span class=\"n\">TempRequireProject</span><span class=\"p\">(</span><span class=\"s2\">\"mathlib\"</span><span class=\"p\">))</span>\n\n\n<span class=\"c1\"># Helper function to process a single file</span>\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">process_file</span><span class=\"p\">(</span><span class=\"n\">path</span><span class=\"p\">):</span>\n    <span class=\"n\">server</span> <span class=\"o\">=</span> <span class=\"n\">AutoLeanServer</span><span class=\"p\">(</span><span class=\"n\">config</span><span class=\"p\">)</span>\n    <span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"n\">server</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">(</span><span class=\"n\">FileCommand</span><span class=\"p\">(</span><span class=\"n\">path</span><span class=\"o\">=</span><span class=\"n\">path</span><span class=\"p\">))</span>\n    <span class=\"k\">if</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">response</span><span class=\"p\">,</span> <span class=\"n\">LeanError</span><span class=\"p\">)</span> <span class=\"ow\">or</span> <span class=\"ow\">not</span> <span class=\"n\">response</span><span class=\"o\">.</span><span class=\"n\">lean_code_is_valid</span><span class=\"p\">(</span><span class=\"n\">allow_sorry</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">):</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">\"Error in </span><span class=\"si\">{</span><span class=\"n\">path</span><span class=\"si\">}</span><span class=\"s2\">: </span><span class=\"si\">{</span><span class=\"n\">response</span><span class=\"si\">}</span><span class=\"s2\">\"</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"kc\">False</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"kc\">True</span>\n\n\n<span class=\"c1\"># run all the lean files inside the `test` and `valid` folders</span>\n<span class=\"n\">root_dir</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">dirname</span><span class=\"p\">(</span><span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">abspath</span><span class=\"p\">(</span><span class=\"vm\">__file__</span><span class=\"p\">))</span>\n<span class=\"k\">for</span> <span class=\"n\">split</span> <span class=\"ow\">in</span> <span class=\"p\">[</span><span class=\"s2\">\"test\"</span><span class=\"p\">,</span> <span class=\"s2\">\"valid\"</span><span class=\"p\">]:</span>\n    <span class=\"n\">files_to_run</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n    <span class=\"k\">for</span> <span class=\"n\">root</span><span class=\"p\">,</span> <span class=\"n\">dirs</span><span class=\"p\">,</span> <span class=\"n\">files</span> <span class=\"ow\">in</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">walk</span><span class=\"p\">(</span><span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">root_dir</span><span class=\"p\">,</span> <span class=\"n\">split</span><span class=\"p\">)):</span>\n        <span class=\"k\">for</span> <span class=\"n\">file</span> <span class=\"ow\">in</span> <span class=\"n\">files</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"n\">file</span><span class=\"o\">.</span><span class=\"n\">endswith</span><span class=\"p\">(</span><span class=\"s2\">\".lean\"</span><span class=\"p\">):</span>\n                <span class=\"n\">path</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">root_dir</span><span class=\"p\">,</span> <span class=\"n\">root</span><span class=\"p\">,</span> <span class=\"n\">file</span><span class=\"p\">)</span>\n                <span class=\"n\">files_to_run</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">path</span><span class=\"p\">)</span>\n\n    <span class=\"n\">counter_correct</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n    <span class=\"n\">counter_total</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n\n    <span class=\"k\">with</span> <span class=\"n\">ThreadPoolExecutor</span><span class=\"p\">()</span> <span class=\"k\">as</span> <span class=\"n\">executor</span><span class=\"p\">:</span>\n        <span class=\"n\">futures</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"n\">executor</span><span class=\"o\">.</span><span class=\"n\">submit</span><span class=\"p\">(</span><span class=\"n\">process_file</span><span class=\"p\">,</span> <span class=\"n\">path</span><span class=\"p\">):</span> <span class=\"n\">path</span> <span class=\"k\">for</span> <span class=\"n\">path</span> <span class=\"ow\">in</span> <span class=\"n\">files_to_run</span><span class=\"p\">}</span>\n        <span class=\"k\">for</span> <span class=\"n\">future</span> <span class=\"ow\">in</span> <span class=\"n\">as_completed</span><span class=\"p\">(</span><span class=\"n\">futures</span><span class=\"p\">):</span>\n            <span class=\"n\">counter_total</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n            <span class=\"k\">if</span> <span class=\"n\">future</span><span class=\"o\">.</span><span class=\"n\">result</span><span class=\"p\">():</span>\n                <span class=\"n\">counter_correct</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">\"Correct: </span><span class=\"si\">{</span><span class=\"n\">counter_correct</span><span class=\"si\">}</span><span class=\"s2\">/</span><span class=\"si\">{</span><span class=\"n\">counter_total</span><span class=\"si\">}</span><span class=\"s2\">\"</span><span class=\"p\">)</span>\n</code></pre></div>\n</div></div>",
        "id": 515516222,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746109965
    },
    {
        "content": "<p>Minor note: there is an <code>apply?</code>-incomplete proof in the valid set.</p>",
        "id": 515517209,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1746110255
    },
    {
        "content": "<p><code>algebra_amgm_prod1toneq1_sum1tongeqn.lean</code>? <del>It looks ok in the <a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQpKxwCCApgM4Rg45kkwD6lMwEAdnCEgB4ASJSsLPxhk4ABmqUS7AELAA5gHkwJKCmiiASv3RwAcijgAVShHQR5ATziaU1APQBaR3ADKqCAHc4aQwDNoOCRWaygdRwA3JHQAVxIAEzg/GNYAY2Y2OAASJCy4TLQSOFYUGLVdVhiQIShRMhjU1B9UQyyAHQDy3WA4NuB2Ns40LCwAbz0AXwAaIPoetvkSAEdxLJngP2ywKAh4+lHgAF4xCYA9UdZHAEYJ2Z7DuCu15uls+pB9o5Pzy5u73sWK1YWQAdI57DhCtASCAguhFlg1PQkCB5B9trsrjA2MsrvR3li2ID2AAKJBwABccEAqIRwQBJhPo9NpogBKOAk9hU6ksnBwdmoQABBJS4AAxfq0GAgjGJEli1gSkFqViLYps8kPK5sqlyhXvdk6uiK4Iq1hquCAUyJipSHlhLLy4C0IkUUfQ0XNWMsYtFgDBrFTAABE7K4wtpDL0TJ0bJJsK5LJm9r5Bsletl4sNSpVIDZwfsHAt+rTkulBfl6eNRSzcC4bNO7KucFzlYpNrtfL5jqKZBgJDAYmFgZJwa59MZzPQUZjNLjosLIJTSaNyor2YbectqdLRZ2MoXGeXVZrddXTZbCbb/RgOyrHDP7aQTodgECCfvGYVGSwqABUMyMI9Do50EdwzHa04FtW9z1YS8IGMCC+QvK8YDguAEJgkBkNQoJkJILgkHSLC2zbZxiDAMB0GsIgEEcABxBAUI9JYvUwX0fBgwo4FoRjpFSIo2hJKt6CuGYuHoAAmGY2nQeIIBEYT6FhNoeUIu8H1QQAggmFBd51nPcOBXRt8w3BViyMsslz0g84FrEl60bLVT2UtskFI8iAH4IJwvD4HUs8Ow47swHrAMgxDICI1ZdlJ25GYtKqEsFV0ysczXeLDRM3dyws6srKPOzQPAxzMODdDHOI7RPCgH0inY/pPW9Fj+iCDhoQ4YIkEWJAsHQIpOhK5SoG8ABtRY5j8Px6G6gBdCDiIAVVoF44HkYAnXYWrGPq6w/B2WF2IxLqYX8lAYWkJDHL81Bn21WdtM3RdM30lLTK3XZUslRLs0PGzj3s/yez7YqZpcABhNhUlieJqtQIoMQgTZbTgTAPQEIJKrQEA6GAVIILIfByRiXHlSfM9fPvTsAtEl9B1CsNwvHSKQ2nWLYWe+792S2F1wXdKdMypKvtsizmzA1tlKKm9zrJp9QK7f7rz6wiLo04XZcC+WcfwZF0HQEnCM8/DVYkPl7T8xYIAxy8sfk/hWHoZZGA9YVWZ5u7dNNIIBdXd2NXy0WVKKS7QJdN11qYn1rBJZJ2HoOBDgAPkeNkjbbJWg4+EOGLDljI5SOAY/jxPHlJ1TAGCCNPXQ+UPNvZKO89jhPNTgUTi4DwAQgnLjO6uYiPa/zhu2QAZhbh1AFCCDvK8z6uc+j+vC4AFjPXHwCCbzn3Uh0y9QdvUBHs8AB4AG4E9YaAPkqWFDED9fUE37fd8Iw+E6RgQfVQe0Tall/0cx1JreCV0SAOyKNdO6t0EqZXduSXM7BLRBQcinKWgcQG6jiqzN2ZpoH5jgSLIGcB5pQyKJRGidEq7dzgJ4V+i1lqrTgNKBo8BUhsHiD6FgrAIKp2FsHCeXdw5NTYZLUu493Q8Ozr3WeYgk7sMQe3Th6duEbTIdPOuBdG7J0VogsesiK7CIUbwpRfdC5XCkapQAYQRCNIXosRKi2TNwEQHQA4QTmMnooqx/c4BDzsQ6QAEQROJET3XOBjG4L08agQAkQS+N0aIgJs9G4AFZjEB0fEKLRndIn+JntYuAAA2BJT4roPC4TorO6TlFuIAOy5MusrApciilT1cYXAAHJUx8ZcUnyOKTXaJmSACcLSZE1O0RYqJGS3FXDUURFwrh8CYD8NYGqziWHkFYhxDw3h2KQ1xmERIYR6joDOspE+UAz5xUvhpG+Do74OjMagRxqAfFhKfEKS6a9HznNaU+VuEFH4cU1tEXQg1BQzDNhbSqv8Mb/3tjiaajkflHJOQrNsPzn5ozfnrXC+FLrv39hxKoAD6CchnKA1BGVzKQPzJyeBOKkGDNSZ0pR9w3ETI4bSjp9Tc6MsMcPC57S6lkPJPwhBqkBlBFqcMkpnLG62KFQHTRrK+WWI5TEwe3KzG8vFV0tayq4DBJlQ6Rx6rFkjJQtq+J6jVI+MNX4zVJrMk5PNQHcJVq0k2slWyCpDqnkRPpbXN1cBmmeped69lWrencrecGlxSrMnjMXvgFe0tr631Htc/V3iHThMus8x8ry1L7yPsUU+BLTmrwdOc5NO9U23PTY8rNeSnx5ofgW1gKLX7Yt+eAfGhN5C4vToA1gQA\">online Lean IDE</a>, although there is a weird message: <code>mathlib-demo.lean:8:0 AddConstAsyncResult.commitConst: constant has level params [u_1] but expected []</code></del></p>",
        "id": 515518241,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746110545
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321854\">Auguste Poiroux</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515518241\">said</a>:</p>\n<blockquote>\n<p><code>algebra_amgm_prod1toneq1_sum1tongeqn.lean</code>? <del>It looks ok in the <a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQpKxwCCApgM4Rg45kkwD6lMwEAdnCEgB4ASJSsLPxhk4ABmqUS7AELAA5gHkwJKCmiiASv3RwAcijgAVShHQR5ATziaU1APQBaR3ADKqCAHc4aQwDNoOCRWaygdRwA3JHQAVxIAEzg/GNYAY2Y2OAASJCy4TLQSOFYUGLVdVhiQIShRMhjU1B9UQyyAHQDy3WA4NuB2Ns40LCwAbz0AXwAaIPoetvkSAEdxLJngP2ywKAh4+lHgAF4xCYA9UdZHAEYJ2Z7DuCu15uls+pB9o5Pzy5u73sWK1YWQAdI57DhCtASCAguhFlg1PQkCB5B9trsrjA2MsrvR3li2ID2AAKJBwABccEAqIRwQBJhPo9NpogBKOAk9hU6ksnBwdmoQABBJS4AAxfq0GAgjGJEli1gSkFqViLYps8kPK5sqlyhXvdk6uiK4Iq1hquCAUyJipSHlhLLy4C0IkUUfQ0XNWMsYtFgDBrFTAABE7K4wtpDL0TJ0bJJsK5LJm9r5Bsletl4sNSpVIDZwfsHAt+rTkulBfl6eNRSzcC4bNO7KucFzlYpNrtfL5jqKZBgJDAYmFgZJwa59MZzPQUZjNLjosLIJTSaNyor2YbectqdLRZ2MoXGeXVZrddXTZbCbb/RgOyrHDP7aQTodgECCfvGYVGSwqABUMyMI9Do50EdwzHa04FtW9z1YS8IGMCC+QvK8YDguAEJgkBkNQoJkJILgkHSLC2zbZxiDAMB0GsIgEEcABxBAUI9JYvUwX0fBgwo4FoRjpFSIo2hJKt6CuGYuHoAAmGY2nQeIIBEYT6FhNoeUIu8H1QQAggmFBd51nPcOBXRt8w3BViyMsslz0g84FrEl60bLVT2UtskFI8iAH4IJwvD4HUs8Ow47swHrAMgxDICI1ZdlJ25GYtKqEsFV0ysczXeLDRM3dyws6srKPOzQPAxzMODdDHOI7RPCgH0inY/pPW9Fj+iCDhoQ4YIkEWJAsHQIpOhK5SoG8ABtRY5j8Px6G6gBdCDiIAVVoF44HkYAnXYWrGPq6w/B2WF2IxLqYX8lAYWkJDHL81Bn21WdtM3RdM30lLTK3XZUslRLs0PGzj3s/yez7YqZpcABhNhUlieJqtQIoMQgTZbTgTAPQEIJKrQEA6GAVIILIfByRiXHlSfM9fPvTsAtEl9B1CsNwvHSKQ2nWLYWe+792S2F1wXdKdMypKvtsizmzA1tlKKm9zrJp9QK7f7rz6wiLo04XZcC+WcfwZF0HQEnCM8/DVYkPl7T8xYIAxy8sfk/hWHoZZGA9YVWZ5u7dNNIIBdXd2NXy0WVKKS7QJdN11qYn1rBJZJ2HoOBDgAPkeNkjbbJWg4+EOGLDljI5SOAY/jxPHlJ1TAGCCNPXQ+UPNvZKO89jhPNTgUTi4DwAQgnLjO6uYiPa/zhu2QAZhbh1AFCCDvK8z6uc+j+vC4AFjPXHwCCbzn3Uh0y9QdvUBHs8AB4AG4E9YaAPkqWFDED9fUE37fd8Iw+E6RgQfVQe0Tall/0cx1JreCV0SAOyKNdO6t0EqZXduSXM7BLRBQcinKWgcQG6jiqzN2ZpoH5jgSLIGcB5pQyKJRGidEq7dzgJ4V+i1lqrTgNKBo8BUhsHiD6FgrAIKp2FsHCeXdw5NTYZLUu493Q8Ozr3WeYgk7sMQe3Th6duEbTIdPOuBdG7J0VogsesiK7CIUbwpRfdC5XCkapQAYQRCNIXosRKi2TNwEQHQA4QTmMnooqx/c4BDzsQ6QAEQROJET3XOBjG4L08agQAkQS+N0aIgJs9G4AFZjEB0fEKLRndIn+JntYuAAA2BJT4roPC4TorO6TlFuIAOy5MusrApciilT1cYXAAHJUx8ZcUnyOKTXaJmSACcLSZE1O0RYqJGS3FXDUURFwrh8CYD8NYGqziWHkFYhxDw3h2KQ1xmERIYR6joDOspE+UAz5xUvhpG+Do74OjMagRxqAfFhKfEKS6a9HznNaU+VuEFH4cU1tEXQg1BQzDNhbSqv8Mb/3tjiaajkflHJOQrNsPzn5ozfnrXC+FLrv39hxKoAD6CchnKA1BGVzKQPzJyeBOKkGDNSZ0pR9w3ETI4bSjp9Tc6MsMcPC57S6lkPJPwhBqkBlBFqcMkpnLG62KFQHTRrK+WWI5TEwe3KzG8vFV0tayq4DBJlQ6Rx6rFkjJQtq+J6jVI+MNX4zVJrMk5PNQHcJVq0k2slWyCpDqnkRPpbXN1cBmmeped69lWrencrecGlxSrMnjMXvgFe0tr631Htc/V3iHThMus8x8ry1L7yPsUU+BLTmrwdOc5NO9U23PTY8rNeSnx5ofgW1gKLX7Yt+eAfGhN5C4vToA1gQA\">online Lean IDE</a>, although there is a weird message: <code>mathlib-demo.lean:8:0 AddConstAsyncResult.commitConst: constant has level params [u_1] but expected []</code></del></p>\n</blockquote>\n<p>One of the messages is <code>declaration uses 'sorry'</code></p>",
        "id": 515518913,
        "sender_full_name": "Simon Sorg",
        "timestamp": 1746110742
    },
    {
        "content": "<p>Yes indeed, I read <code>apply?</code> as <code>exact?</code> in my head. Sorry for the confusion</p>",
        "id": 515519052,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746110775
    },
    {
        "content": "<p>Well, then it seems that the REPL is not reporting this <code>declaration uses 'sorry'</code> message. This might be the real issue here. Thanks for reporting this <span class=\"user-mention\" data-user-id=\"556875\">@Pietro Monticone</span>.</p>",
        "id": 515520257,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746111160
    },
    {
        "content": "<p><a href=\"https://huggingface.co/playground\">https://huggingface.co/playground</a><br>\n<a href=\"https://openrouter.ai/chat\">https://openrouter.ai/chat</a></p>\n<p>I found this model (deepseek-ai/DeepSeek-Prover-V2-671B) on Hugging Face Playground and OpenRouter! Hugging Face Playground should support free use of this model online. It seems like unlike previous Lean models, the API providers decided to add support for this one.</p>",
        "id": 515525332,
        "sender_full_name": "Deming Xu",
        "timestamp": 1746112679
    },
    {
        "content": "<p>I ran these tests:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib.Tactic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib.Data.Real.Basic</span>\n\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">Formalize and prove this in Lean:</span>\n\n<span class=\"sd\">\"A implies B\", if and only if \"either not A or B\"</span>\n<span class=\"sd\">-/</span>\n<span class=\"kd\">theorem</span><span class=\"w\"> </span><span class=\"n\">imp_iff_not_or'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Iff.intro</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"c1\">-- Prove the forward direction: (A → B) → (¬ A ∨ B)</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">hA</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"c1\">-- Case: A is true</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hB</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">hA</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Or.inr</span><span class=\"w\"> </span><span class=\"n\">hB</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"c1\">-- Case: A is false</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Or.inl</span><span class=\"w\"> </span><span class=\"n\">hA</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"c1\">-- Prove the backward direction: (¬ A ∨ B) → (A → B)</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">hA</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"n\">hnA</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"c1\">-- Case: ¬ A is true</span>\n<span class=\"w\">      </span><span class=\"n\">exfalso</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hnA</span><span class=\"w\"> </span><span class=\"n\">hA</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"n\">hB</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"c1\">-- Case: B is true</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hB</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">Formalize and prove this in Lean:</span>\n\n<span class=\"sd\">For a real number x != 0, abs(x + 1/x) &gt;= 2</span>\n<span class=\"sd\">-/</span>\n<span class=\"kd\">theorem</span><span class=\"w\"> </span><span class=\"n\">abs_x_plus_inv_x_ge_two</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">nlinarith</span>\n<span class=\"w\">    </span><span class=\"k\">calc</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">        </span><span class=\"c1\">-- Prove that (x + 1/x)^2 = (x - 1/x)^2 + 4</span>\n<span class=\"w\">        </span><span class=\"n\">field_simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hx</span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"n\">ring</span>\n<span class=\"w\">        </span><span class=\"bp\">&lt;;&gt;</span>\n<span class=\"w\">        </span><span class=\"n\">nlinarith</span>\n<span class=\"w\">      </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">nlinarith</span>\n<span class=\"w\">      </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">norm_num</span>\n<span class=\"w\">  </span><span class=\"c1\">-- Now we know (x + 1/x)^2 ≥ 4, so |x + 1/x| ≥ 2</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">    </span><span class=\"c1\">-- Use the fact that if y^2 ≥ 4, then |y| ≥ 2</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₃</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h₁</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₄</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">      </span><span class=\"c1\">-- Use the property of squares and absolute values</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₅</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">        </span><span class=\"n\">by_contra</span><span class=\"w\"> </span><span class=\"n\">h₅</span>\n<span class=\"w\">        </span><span class=\"c1\">-- If |x + 1/x| &lt; 2, then (x + 1/x)^2 &lt; 4</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₆</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">linarith</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₇</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">          </span><span class=\"k\">calc</span>\n<span class=\"w\">            </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">              </span><span class=\"c1\">-- Since (x + 1/x)^2 = |x + 1/x|^2</span>\n<span class=\"w\">              </span><span class=\"n\">nlinarith</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">abs_mul_abs_self</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)]</span>\n<span class=\"w\">            </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">              </span><span class=\"n\">gcongr</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">nlinarith</span>\n<span class=\"w\">            </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">norm_num</span>\n<span class=\"w\">        </span><span class=\"n\">linarith</span>\n<span class=\"w\">      </span><span class=\"n\">linarith</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h₄</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h₂</span>\n\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">Formalize and prove this in Lean:</span>\n\n<span class=\"sd\">For a real number b, if there is not x such that</span>\n<span class=\"sd\">x^2 + b * x + 1 = 0</span>\n<span class=\"sd\">then abs(b) &lt; 2</span>\n<span class=\"sd\">-/</span>\n<span class=\"kd\">theorem</span><span class=\"w\"> </span><span class=\"n\">no_real_root_implies_abs_lt_two</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">    </span><span class=\"n\">by_contra</span><span class=\"w\"> </span><span class=\"n\">h₂</span>\n<span class=\"w\">    </span><span class=\"c1\">-- If b² - 4 ≥ 0, then the quadratic has a real root, contradicting h.</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₃</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">linarith</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₄</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">      </span><span class=\"c1\">-- Use the quadratic formula to find a root.</span>\n<span class=\"w\">      </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">Real.sqrt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₅</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">linarith</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₆</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real.sqrt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Real.sqrt_nonneg</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"n\">nlinarith</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Real.sq_sqrt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">linarith</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">sq_nonneg</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Real.sqrt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">))]</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">h₄</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">    </span><span class=\"c1\">-- Prove that |b| &lt; 2 using h₁.</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₃</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">linarith</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₄</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">abs_lt</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">constructor</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">nlinarith</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">sq_nonneg</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sq_nonneg</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">sq_nonneg</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)]</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h₄</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h₂</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">Formalize and prove this in Lean:</span>\n\n<span class=\"sd\">For a real number x, if x^3 = 8, then x = 2.</span>\n<span class=\"sd\">-/</span>\n<span class=\"kd\">theorem</span><span class=\"w\"> </span><span class=\"n\">cube_root_of_eight</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">8</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">8</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">linarith</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₃</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">8</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">ring</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h₃</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">h₂</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h₂</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">eq_zero_or_eq_zero_of_mul_eq_zero</span><span class=\"w\"> </span><span class=\"n\">h₁</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₃</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">linarith</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h₃</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₃</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h₂</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₄</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">nlinarith</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₅</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">False</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">nlinarith</span>\n<span class=\"w\">    </span><span class=\"n\">exfalso</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h₅</span>\n</code></pre></div>",
        "id": 515533196,
        "sender_full_name": "Deming Xu",
        "timestamp": 1746115127
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/W-eqn43WHEFIgjkwyKabFQLQ/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/W-eqn43WHEFIgjkwyKabFQLQ/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"2704x1338\" src=\"/user_uploads/thumbnail/3121/W-eqn43WHEFIgjkwyKabFQLQ/image.png/840x560.webp\"></a></div>",
        "id": 515534060,
        "sender_full_name": "Deming Xu",
        "timestamp": 1746115366
    },
    {
        "content": "<p>Besides fixing REPL issues of not reporting the sorry, in my opinion the Lean side should also be changed: apply? shouldn't close a goal with sorry if no suggestions close the goal. (This was <a href=\"#narrow/channel/113488-general/topic/.E2.9C.94.20How.20can.20I.20see.20which.20tactic.20was.20chosen.20by.20.60apply.3F.60/near/499346735\">discussed</a>.)</p>",
        "id": 515541693,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746118172
    },
    {
        "content": "<p>I don't think we should make Lean less nice to use for humans for the sake of agents. There could be an opt-in option for agents though.</p>",
        "id": 515544141,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1746119129
    },
    {
        "content": "<p>I think there is some misunderstanding: I am suggesting that making apply? not admit the goal when no suggestions close the goal is beneficial both for human users and for LLMs. At least this is the impression I got from this thread and my linked thread.</p>",
        "id": 515547359,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746120338
    },
    {
        "content": "<p>Why is having tactics use sorry a problem?</p>",
        "id": 515553482,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746122544
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321854\">Auguste Poiroux</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515520257\">said</a>:</p>\n<blockquote>\n<p>Well, then it seems that the REPL is not reporting this <code>declaration uses 'sorry'</code> message. This might be the real issue here. Thanks for reporting this <span class=\"user-mention silent\" data-user-id=\"556875\">Pietro Monticone</span>.</p>\n</blockquote>\n<p>Coming back to this, it seems that it's not a REPL issue. In Lean v4.9.0, when <code>apply?</code> is used in a proof we don't get a sorry message. Do any of you know when it was introduced? Additionally, are there other tactics that should be reported as sorry? I will update LeanInteract to check for these tactics when looking for sorries.</p>",
        "id": 515556554,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746123703
    },
    {
        "content": "<p>I don't think this is a trustworthy way to determine if a proof is sorry-free (but this is a user-interface bug)</p>",
        "id": 515556711,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746123755
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515553482\">said</a>:</p>\n<blockquote>\n<p>Why is having tactics use sorry a problem?</p>\n</blockquote>\n<p>For one, it is frustrating to debug.  Where did the sorry come from?  It isn't like Lean will tell you which tactic was the cause of the sorry.  For a novice user, they may not even suspect the <code>?</code> tactics.  The above thread is an example of someone getting confused why <code>apply?</code> closes the goal.  Conversely, how does it help for a typical tactic?  (Obviously not <code>sorry</code> or a well-known synonym, although I would also love for <code>sorry</code> synonyms to be made more sorry-like in appearance, as well as tactics which introduce sorries, no?). But I'm not a Lean power-user.  Is there an advantage to using sorry in this case or similar tactics?</p>",
        "id": 515556876,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746123825
    },
    {
        "content": "<p>I think the argument for using <code>sorry</code> is to avoid:</p>\n<ul>\n<li>the user seeing an annoying \"unsolved goals\" error on a goal they are actively working on</li>\n<li>a warning that the <code>apply?</code> tactic does nothing</li>\n</ul>",
        "id": 515557220,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746123966
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515556711\">said</a>:</p>\n<blockquote>\n<p>I don't think this is a trustworthy way to determine if a proof is sorry-free (but this is a user-interface bug)</p>\n</blockquote>\n<p>This I absolutely agree. Would you say a more future proof way is to check the set of axioms used is a subset of the standard three?</p>",
        "id": 515558308,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746124362
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515556711\">said</a>:</p>\n<blockquote>\n<p>I don't think this is a trustworthy way to determine if a proof is sorry-free</p>\n</blockquote>\n<p>Well, yes, you are right, I agree with you. A better way would be to enhance the REPL command mode to do an explicit check then. It would probably reuse the <a href=\"https://github.com/leanprover-community/repl/blob/82f6657e6cddc9e9e0d070d5352604488a76497d/REPL/Main.lean#L182-L230\"><code>getProofStatus</code></a> method introduced to check proofs in tactic mode. What do you think? I might try to implement that in the coming weeks.</p>",
        "id": 515558336,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746124377
    },
    {
        "content": "<p>The two PutnamBench problems in Appendix B would not compile even without the <code>apply?</code> issue, right?</p>",
        "id": 515559038,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1746124613
    },
    {
        "content": "<p>In particular, as far as I can tell, </p>\n<ul>\n<li><code>putnam_2005_a4</code> would not compile even if you replaced <code>apply?</code> with <code>sorry</code>. The whole <code>calc</code> block is invalid.</li>\n<li><code>putnam_2007_b4</code> doesn’t compile because of an error in the <code>rw</code> preceding the <code>apply?</code>. Do you happen to know why it wasn’t detected?</li>\n</ul>",
        "id": 515559786,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1746124895
    },
    {
        "content": "<p>Pantograph can check whether there's a sorry immediately after a tactic finishes, so there is that</p>",
        "id": 515562256,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746125854
    },
    {
        "content": "<p>Can you use pantograph to check proofs like these?</p>",
        "id": 515562380,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746125897
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515562380\">said</a>:</p>\n<blockquote>\n<p>Can you use pantograph to check proofs like these?</p>\n</blockquote>\n<p>e.g.?</p>\n<p>We need to parse these text proofs into a proof tree if you want to do something like that</p>",
        "id": 515562444,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746125925
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"556875\">Pietro Monticone</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515559786\">said</a>:</p>\n<blockquote>\n<p>In particular, as far as I can tell, </p>\n<ul>\n<li><code>putnam_2005_a4</code> would not compile even if you replaced <code>apply?</code> with <code>sorry</code>. The whole <code>calc</code> block is invalid.</li>\n<li><code>putnam_2007_b4</code> doesn’t compile because of an error in the <code>rw</code> preceding the <code>apply?</code>. Do you happen to know why it wasn’t detected?</li>\n</ul>\n</blockquote>\n<p>I don't know what's happening with these PutnamBench proofs, I cannot manage to get them to compile, neither in VSCode or using the REPL...</p>",
        "id": 515562512,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746125951
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"599027\">@Leni Aniva</span>  Any of the proofs in: <a href=\"https://github.com/deepseek-ai/DeepSeek-Prover-V2/blob/main/minif2f-solutions.zip\">https://github.com/deepseek-ai/DeepSeek-Prover-V2/blob/main/minif2f-solutions.zip</a></p>",
        "id": 515562557,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746125969
    },
    {
        "content": "<p>Surely we should just be checking these proofs with <code>leanchecker</code> + an axioms check?</p>",
        "id": 515562718,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746126017
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515562557\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span>  Any of the proofs in: <a href=\"https://github.com/deepseek-ai/DeepSeek-Prover-V2/blob/main/minif2f-solutions.zip\">https://github.com/deepseek-ai/DeepSeek-Prover-V2/blob/main/minif2f-solutions.zip</a></p>\n</blockquote>\n<p>probably not, if you want the precise location of the tactics producing <code>sorry</code>s</p>",
        "id": 515562720,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746126018
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515562256\">said</a>:</p>\n<blockquote>\n<p>Pantograph can check whether there's a sorry immediately after a tactic finishes, so there is that</p>\n</blockquote>\n<p>Does it detect</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">rec</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">apply?</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">bar</span>\n</code></pre></div>",
        "id": 515562753,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746126033
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515562753\">said</a>:</p>\n<blockquote>\n<p>Pantogr</p>\n<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515562256\">said</a>:</p>\n<blockquote>\n<p>Pantograph can check whether there's a sorry immediately after a tactic finishes, so there is that</p>\n</blockquote>\n<p>Does it detect</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">rec</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">apply?</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">bar</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Yes, but you would have to run it with <code>goal_tactic</code> (what an agent would call when searching for the proof)</p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">pantograph.server</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">Server</span>\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">pantograph.expr</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">TacticHave</span>\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s1\">'__main__'</span><span class=\"p\">:</span>\n    <span class=\"n\">server</span> <span class=\"o\">=</span> <span class=\"n\">Server</span><span class=\"p\">(</span><span class=\"n\">imports</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">'Init'</span><span class=\"p\">])</span>\n    <span class=\"n\">state0</span> <span class=\"o\">=</span> <span class=\"n\">server</span><span class=\"o\">.</span><span class=\"n\">goal_start</span><span class=\"p\">(</span><span class=\"s2\">\"1 = 0\"</span><span class=\"p\">)</span>\n    <span class=\"n\">state1</span> <span class=\"o\">=</span> <span class=\"n\">server</span><span class=\"o\">.</span><span class=\"n\">goal_tactic</span><span class=\"p\">(</span><span class=\"n\">state0</span><span class=\"p\">,</span> <span class=\"n\">goal_id</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">tactic</span><span class=\"o\">=</span><span class=\"n\">TacticHave</span><span class=\"p\">(</span><span class=\"s2\">\"1 = 0\"</span><span class=\"p\">))</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">state1</span><span class=\"p\">)</span>\n    <span class=\"n\">state1b</span> <span class=\"o\">=</span> <span class=\"n\">server</span><span class=\"o\">.</span><span class=\"n\">goal_tactic</span><span class=\"p\">(</span><span class=\"n\">state1</span><span class=\"p\">,</span> <span class=\"n\">goal_id</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">tactic</span><span class=\"o\">=</span><span class=\"s2\">\"apply?\"</span><span class=\"p\">)</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">state1b</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>This fails on line -2.</p>",
        "id": 515562780,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746126044
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515562718\">said</a>:</p>\n<blockquote>\n<p>Surely we should just be checking these proofs with <code>leanchecker</code> + an axioms check?</p>\n</blockquote>\n<p>Someone needs to write a document for AI researchers telling them about common pitfalls, axioms, checking proofs, errors in benchmarks, and other things which would embarrass them if they don't handle correctly.</p>",
        "id": 515563136,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746126168
    },
    {
        "content": "<p>(Also because it wastes everyone's time.)</p>",
        "id": 515563481,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746126301
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515562753\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515562256\">said</a>:</p>\n<blockquote>\n<p>Pantograph can check whether there's a sorry immediately after a tactic finishes, so there is that</p>\n</blockquote>\n<p>Does it detect</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">rec</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">apply?</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">bar</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>If we switch to tactic mode, the REPL detect this issue. The output is a bit long, but you get <code>proof_status='Incomplete: contains metavariable(s)'</code>.</p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>Code</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">lean_interact</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">AutoLeanServer</span><span class=\"p\">,</span> <span class=\"n\">Command</span><span class=\"p\">,</span> <span class=\"n\">LeanREPLConfig</span><span class=\"p\">,</span> <span class=\"n\">ProofStep</span>\n\n<span class=\"n\">conf</span> <span class=\"o\">=</span> <span class=\"n\">LeanREPLConfig</span><span class=\"p\">(</span><span class=\"n\">lean_version</span><span class=\"o\">=</span><span class=\"s2\">\"v4.9.0\"</span><span class=\"p\">)</span>\n<span class=\"n\">server</span> <span class=\"o\">=</span> <span class=\"n\">AutoLeanServer</span><span class=\"p\">(</span><span class=\"n\">conf</span><span class=\"p\">)</span>\n\n<span class=\"n\">server</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">(</span><span class=\"n\">Command</span><span class=\"p\">(</span><span class=\"n\">cmd</span><span class=\"o\">=</span><span class=\"s2\">\"theorem foo : 1 = 0 := by sorry\"</span><span class=\"p\">))</span>\n<span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"n\">server</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">(</span>\n    <span class=\"n\">ProofStep</span><span class=\"p\">(</span>\n        <span class=\"n\">tactic</span><span class=\"o\">=</span><span class=\"s2\">\"(</span><span class=\"se\">\\n</span><span class=\"s2\">  let rec bar : 1 = 0 := by apply?</span><span class=\"se\">\\n</span><span class=\"s2\">  exact bar)\"</span><span class=\"p\">,</span>\n        <span class=\"n\">proof_state</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span>\n<span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">response</span><span class=\"p\">)</span>\n</code></pre></div>\n</div></div>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>Output</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"n\">ProofStepResponse</span><span class=\"p\">(</span><span class=\"n\">proof_status</span><span class=\"o\">=</span><span class=\"s1\">'Incomplete: contains metavariable(s)'</span><span class=\"p\">,</span> <span class=\"n\">messages</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.eq_zero_of_add_eq_zero_left ?h'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.eq_zero_of_le_zero ?h'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.le_zero.mp ?a✝'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.eq_zero_of_not_pos ?h'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Int.ofNat_eq_zero.mp ?a✝'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.eq_zero_of_zero_dvd ?h'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.zero_dvd.mp ?a✝'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.eq_zero_of_gcd_eq_zero_left ?H'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.eq_zero_of_gcd_eq_zero_right ?H'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.eq_zero_of_add_eq_zero_right ?h'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.eq_of_beq_eq_true ?a✝'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.le_antisymm ?h₁ ?h₂'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Lean.ofReduceNat 1 0 ?h'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s2\">\"Try this: refine Nat.succ_inj'.mp ?a✝\"</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.add_right_cancel ?h'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.pred_inj ?a✝ ?a✝¹ rfl'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.eq_of_mul_eq_mul_left ?hn ?h'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.eq_iff_le_and_ge.mpr ?a✝'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.add_left_cancel ?a✝'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.eq_of_mul_eq_mul_right ?hm ?h'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.eq_of_lt_succ_of_not_lt ?hmn ?h'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.eq_of_le_of_lt_succ ?h₁ ?h₂'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.le_antisymm_iff.mpr ?a✝'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Int.negSucc_inj.mp ?a✝'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Int.ofNat_inj.mp ?a✝'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.dvd_antisymm ?a✝ ?a✝¹'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.mul_left_cancel ?np ?h'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.add_right_cancel_iff.mp ?a✝'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.add_left_cancel_iff.mp ?a✝'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine (Nat.mul_right_cancel_iff ?p 1 0).mp ?a✝'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.mul_right_cancel ?mp ?h'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine (Nat.mul_left_cancel_iff ?p 1 0).mp ?a✝'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Fin.mk.inj_iff.mp ?a✝'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.eq_of_testBit_eq ?pred'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)),</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"s1\">'Try this: refine Nat.compare_eq_eq.mp ?a✝'</span><span class=\"p\">,</span> <span class=\"n\">severity</span><span class=\"o\">=</span><span class=\"s1\">'info'</span><span class=\"p\">,</span> <span class=\"n\">start_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">end_pos</span><span class=\"o\">=</span><span class=\"n\">Pos</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">column</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">))],</span> <span class=\"n\">goals</span><span class=\"o\">=</span><span class=\"p\">[],</span> <span class=\"n\">proof_state</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n</code></pre></div>\n</div></div>",
        "id": 515564251,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746126608
    },
    {
        "content": "<p>There's nothing wrong if a proof step contains mvars. Either the error message is misleading in the repl, or its being overeager in detecting errors.</p>",
        "id": 515564329,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746126652
    },
    {
        "content": "<p>Im not familiar with lean_interact. Does this example assume the proof is finished?</p>",
        "id": 515564454,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746126709
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515564329\">said</a>:</p>\n<blockquote>\n<p>There's nothing wrong if a proof step contains mvars. Either the error message is misleading in the repl, or its being overeager in detecting errors.</p>\n</blockquote>\n<p>The check is for expression metavariables with <code>hasExprMVar</code></p>",
        "id": 515564604,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746126761
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321854\">Auguste Poiroux</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515564604\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515564329\">said</a>:</p>\n<blockquote>\n<p>There's nothing wrong if a proof step contains mvars. Either the error message is misleading in the repl, or its being overeager in detecting errors.</p>\n</blockquote>\n<p>The check is for expression metavariables with <code>hasExprMVar</code></p>\n</blockquote>\n<p>so? What Im saying is unless we declare a proof to be fully complete, goals can have mvars, proof terms can have mvars, and these would not be a problem.</p>",
        "id": 515564631,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746126777
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515564454\">said</a>:</p>\n<blockquote>\n<p>Im not familiar with lean_interact. Does this example assume the proof is finished?</p>\n</blockquote>\n<p>This is not specific to LeanInteract, I am just using it for the interface to the REPL and for using Lean v4.9.0.<br>\nThis example assume the proof is finished because there are no goals left. But there is a hole, hence the <code>hasExprMvar</code> check that fails</p>",
        "id": 515565127,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746126972
    },
    {
        "content": "<p>11 messages were moved from this topic to <a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/.23print.20axioms.20does.20not.20report.20sorry/with/515566581\">#lean4 &gt; #print axioms does not report sorry</a> by <span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span>.</p>",
        "id": 515568645,
        "sender_full_name": "Notification Bot",
        "timestamp": 1746128333
    },
    {
        "content": "<p>Just so it is clear, that proof of <code>algebra_amgm_prod1toneq1_sum1tongeqn</code> is likely an example of an AI agent finding and exploiting a bug in Lean.  The bug is the one mentioned in the above message.  Even if DeepSeek were diligent and used <code>#print axioms ...</code> it would not have triggered anything suspicious.  (Maybe it is the same with the putnam problems when we see the actual code.  That could explain why the agent is using <code>Cardinal.toNat</code>.)  If this is the case, this is really interesting and should be made more well known!</p>",
        "id": 515574957,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746130778
    },
    {
        "content": "<p>(Edit: I'm calling it a bug now, not a \"soundness bug\".)</p>",
        "id": 515575086,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746130815
    },
    {
        "content": "<p>(Our graph2tac paper found aN issue, but that was just an axiom of False that didn't take care to check for.  This is much more crazy.)</p>",
        "id": 515576378,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746131299
    },
    {
        "content": "<p>Jason, I think it would be much wiser to remove that bold sentence and stick to facts.</p>",
        "id": 515576463,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1746131330
    },
    {
        "content": "<p>This is not at all what people call a soundness bug. This has a precise meaning.</p>",
        "id": 515576694,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1746131410
    },
    {
        "content": "<p>Is the precise meaning based on external checking?</p>",
        "id": 515576778,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746131446
    },
    {
        "content": "<p>Or the kernel?</p>",
        "id": 515576791,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746131450
    },
    {
        "content": "<p>Of is <code>#print axioms</code> also part of that?</p>",
        "id": 515576832,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746131470
    },
    {
        "content": "<p>Because there did seem to be a bug in <code>#print axioms</code>?</p>",
        "id": 515576879,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746131488
    },
    {
        "content": "<p>The kernel.</p>",
        "id": 515576891,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1746131492
    },
    {
        "content": "<p>What should I call it?  A student could use this same trick to cheat on a Lean assignment (if not using an extenal checker).</p>",
        "id": 515577082,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746131556
    },
    {
        "content": "<p><code>#print axiom</code> is a convenient command to quickly check something is axiom free, and it would indeed be nice to make it more reliable. But this has nothing to do with a soundness bug.</p>",
        "id": 515577117,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1746131569
    },
    {
        "content": "<p>You can call it a bug in a convenience command.</p>",
        "id": 515577157,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1746131586
    },
    {
        "content": "<p>\"Has nothing to do with\" is too strong.  There is a name for this.  Let me look it up.</p>",
        "id": 515577674,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746131771
    },
    {
        "content": "<p>I thought it was \"Pollack consistency\" but that is slightly different.  Okay, I'll just call it a \"bug in Lean\".</p>",
        "id": 515578413,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746132065
    },
    {
        "content": "<p>I commented on the non-severity in the other thread.</p>",
        "id": 515578583,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1746132130
    },
    {
        "content": "<p>Jason, you make it sound like the bug in this command is enough, but the main thing is the bug in the AI pipeline that simply doesn’t check the Lean kernel accepts the proof.</p>",
        "id": 515579099,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1746132356
    },
    {
        "content": "<p>My point is this.  It is well known you can trick Lean to make a bad proof look right.  You can mess with the tactic environment and such.  Sure, if you do external proof checking, it would be caught, but 99% of Lean users don't do that.  this is a case of an AI agent finding a very subtle bug in Lean such that #print axioms doesn't say sorry is used.  I think it is a big deal.  Lean's kernel is fine and external type checking still works, but for AI research it isn't enough to rely on Lean's command line + print axioms.  You have to export the proofs.  Is this balanced and fair?</p>",
        "id": 515579218,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746132397
    },
    {
        "content": "<p>The bug in the AI pipeline could have just been that they didn't use external type checking.</p>",
        "id": 515579390,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746132473
    },
    {
        "content": "<p>Oh, I see.  I should try to run this proof on the command line.  That apparently fails according to <span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span>.  Let me do that.</p>",
        "id": 515579646,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746132575
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515579390\">said</a>:</p>\n<blockquote>\n<p>The bug in the AI pipeline could have just been that they didn't use external type checking.</p>\n</blockquote>\n<p>Surely this is the most reasonable answer. Besides I'm not sure I agree that 99% of lean users don't know this. Anyone who uses lean mostly as a <em>human</em> will inevitably run into issues like these, and they come up all the time on Zulip. There's plenty of threads suggesting to use <code>done</code> at the end of proofs, etc... I think only people that interact with lean mostly via REPL will not have run into something similar.</p>",
        "id": 515580071,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1746132749
    },
    {
        "content": "<p>I think I have to disagree with <span class=\"user-mention\" data-user-id=\"115715\">@Jason Rute</span> here:</p>\n<ol>\n<li>There are two bugs: a Lean bug of <code>#print axioms</code> and a REPL bug of <code>apply?</code>.</li>\n<li>I wrote the <code>#print axioms</code> line myself to debug the seeming absence of squiggly lines of <code>apply?</code> (which turned out to be a VS Code issue)</li>\n<li><code>#print axioms</code> did break, but as far as I know, <code>#print axioms</code> is not used by DeepSeek's team to check correctness. The agent probably didn't find/exploit whatever bug I found.</li>\n<li>The original proof in the zip file released by DeepSeek was indeed incorrect, and some bug was exploited by the DeepSeek-Prover-V2 model. But this bug is the <code>apply?</code> bug: it is something like Lean REPL not reporting the sorry warning message in <code>apply?</code> (I have not read all the details above); and I don't have any evidence this <code>apply?</code> issue is at all related to the <code>#print axioms</code> issue. Since this is probably a REPL issue, this should be categorized as a bug in the AI pipeline and not a bug in Lean.</li>\n<li>DeepSeek-Prover-V2 did not use <code>apply?</code> on any other problem in miniF2F. I think their numbers on miniF2F are still broadly sound (except for this 0.4% difference on miniF2F-valid). But the proofs of PutnamBench should warrant a more detailed check.</li>\n<li>I would say this \"bug discovery\" is me trying to debug the <code>apply?</code> issue and (because DeepSeek-Prover-V2 wrote the <code>Type*</code>) accidentally triggering the <code>#print axioms</code> bug during debugging. It's interesting that besides the sorry warning, the <code>AddConstAsyncResult.commitConst: constant has level params [u] but expected []</code> <em>error</em> message was also not caught by DeepSeek-Prover-V2's checking (perhaps because there is also some message upper limit for REPL like VS Code?) but I don't expect DeepSeek-Prover to have put the <code>Type*</code> there to deliberately trigger the <code>#print axioms</code> bug for humans at all (see Appendix B of their paper).</li>\n</ol>",
        "id": 515581258,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746133244
    },
    {
        "content": "<p>Lean doesn't have a single message for \"this proof is not correct\", and the engineers at DeepSeek did not cover all of the cases where a proof fails. That is my impression about this problem</p>",
        "id": 515581459,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746133328
    },
    {
        "content": "<p>I would say it is impressive that DeepSeek-Prover-V2 cheated their pipeline (perhaps using REPL) of checking proofs. But reward cheating in RL happens all the time: it only takes the agent to write an <code>apply?</code> tactic once to find it.</p>",
        "id": 515581844,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746133493
    },
    {
        "content": "<blockquote>\n<p><code>#print axioms</code> did break, but as far as I know, <code>#print axioms</code> is not used by DeepSeek's team to check correctness. The agent probably didn't find/exploit whatever bug I found.</p>\n</blockquote>\n<p>Maybe.  But in that case, I'm surprised <code>apply?</code> wasn't used more by the AI.  You could solve everything with it.</p>",
        "id": 515581871,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746133503
    },
    {
        "content": "<p>they probably havent trained it enough to collapse its output distribution yet</p>",
        "id": 515582088,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746133581
    },
    {
        "content": "<p><a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/.23print.20axioms.20does.20not.20report.20sorry/with/515566581\">#lean4 &gt; #print axioms does not report sorry</a> </p>\n<p>Just to be clear, you mentioned in that thread that the error will not come up in Lean version <code>4.18.0</code>, and it might be \"an unintended side effect of parallelism\", which is probably a new feature? And you mentioned that DeepSeek was using Lean 4.9, so this <code>#print axioms</code> bug itself probably does not affect the DeepSeek team, right?</p>\n<p>I tested your code snippet on my machine. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span>\n\n<span class=\"c1\">-- declaration uses 'sorry'</span>\n<span class=\"c1\">-- AddConstAsyncResult.commitConst: constant has level params [u] but expected []</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">False</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">id</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"c1\">-- 'f' does not depend on any axioms</span>\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">axioms</span><span class=\"w\"> </span><span class=\"n\">f</span>\n\n<span class=\"c1\">-- Let's try using this `f`</span>\n<span class=\"c1\">-- (kernel) unknown constant 'f'</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">False</span><span class=\"bp\">.</span><span class=\"n\">elim</span><span class=\"w\"> </span><span class=\"n\">f</span>\n</code></pre></div>\n<p>When my <code>lean-toolchain</code> file is set to <code>leanprover/lean4:v4.19.0-rc3</code> it prints no axioms. When I change it to <code>leanprover/lean4:v4.18.0</code> it prints the usual <code>'f' depends on axioms: [sorryAx]</code>.</p>\n<p>In Lean 4 Web (<a href=\"https://live.lean-lang.org\">https://live.lean-lang.org</a>), it lets me change the version of Lean. The default \"Latest Mathlib\" version prints no axioms, while \"Mathlib stable\" prints the <code>sorryAx</code> axiom.</p>",
        "id": 515582434,
        "sender_full_name": "Deming Xu",
        "timestamp": 1746133727
    },
    {
        "content": "<p>In Lean v4.9.0, at least, I didn't get a sorry message for <code>apply?</code>. So I wouldn't say it is a REPL issue since the command mode is more or less mirroring what we get in the IDE. It was used with the belief that it does the type-checking. I agree that we should improve the REPL in this regard.</p>",
        "id": 515582571,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746133784
    },
    {
        "content": "<p>You are all correct that I'm making assumptions about how this arose.  Maybe it just happens to be that the one proof using <code>apply?</code> (which can solve any goal) was also the one proof for which <code>print axioms</code> won't point out that <code>apply?</code> introduces sorry.  (Well there are also the two putnam proofs using apply?, but we can't seem to get those to work, although they do have that weird cardinality stuff.)</p>",
        "id": 515582595,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746133795
    },
    {
        "content": "<p>Ok, there is a slight sarcasm there, but un-sarcastically, I think the best would be to get DeepSeek to explain more how this arose and give more details on the putnam stuff.  Also <span class=\"user-mention\" data-user-id=\"644040\">@George Tsoukalas</span> should make sure he uses external type checking for checking PutnamBench problems.</p>",
        "id": 515582940,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746133942
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515581871\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p><code>#print axioms</code> did break, but as far as I know, <code>#print axioms</code> is not used by DeepSeek's team to check correctness. The agent probably didn't find/exploit whatever bug I found.</p>\n</blockquote>\n<p>Maybe.  But in that case, I'm surprised <code>apply?</code> wasn't used more by the AI.  You could solve everything with it.</p>\n</blockquote>\n<p>I suspect: the bug in REPL (or whatever DeepSeek used) was similar to squiggly lines in VS Code in that there is an upper limit to the number of messages, so the <code>declaration uses sorry</code> and the <code>AddConstAsyncResult.commitConst</code> messages were not caught. This depends on <code>apply?</code> suggesting enough suggestions to exceed this upper limit. I suspect REPL will find that <code>example : False := by apply?</code> is wrong but won't find that <code>example : a very long untrue prop := by apply?</code> is wrong. (Edit: check below)</p>",
        "id": 515582945,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746133945
    },
    {
        "content": "<p>I think it's complete coincidence that the <code>apply?</code> REPL bug and <code>#print axioms</code> bug coincided in the same miniF2F problem. This is because of their two incorrect examples in Appendix B didn't add any <code>Type*</code> in the proof.</p>",
        "id": 515583127,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746134031
    },
    {
        "content": "<p>And (unsarcastically), I am being too sensationalist.  Sorry.</p>",
        "id": 515583189,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746134046
    },
    {
        "content": "<p>For Appendix B, I would like to see the original code and why they think it checks.</p>",
        "id": 515583352,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746134125
    },
    {
        "content": "<p>I think tactics should not rely on error messages to indicate they have failed. All tactics should fail via throwing exceptions.</p>",
        "id": 515583408,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746134153
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515583408\">said</a>:</p>\n<blockquote>\n<p>I think tactics should not rely on error messages to indicate they have failed. All tactics should fail via throwing exceptions.</p>\n</blockquote>\n<p>What's the difference between an error message and an exception?</p>",
        "id": 515583510,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1746134183
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"631691\">Thomas Zhu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515583127\">said</a>:</p>\n<blockquote>\n<p>I think it's complete coincidence that the <code>apply?</code> REPL bug and <code>#print axioms</code> bug coincided in the same miniF2F problem. This is because of their two incorrect examples in Appendix B didn't add any <code>Type*</code> in the proof.</p>\n</blockquote>\n<p>Would <code>Cardinality.toNat</code> add <code>Type*</code>?  (Both Putnam examples use this.)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"k\">calc</span>\n<span class=\"w\">    </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Cardinal</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">cast_inj</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Cardinal</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">apply?</span>\n<span class=\"w\">    </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">cast_inj</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h0</span>\n</code></pre></div>",
        "id": 515583542,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746134201
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515583510\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515583408\">said</a>:</p>\n<blockquote>\n<p>I think tactics should not rely on error messages to indicate they have failed. All tactics should fail via throwing exceptions.</p>\n</blockquote>\n<p>What's the difference between an error message and an exception?</p>\n</blockquote>\n<p>error messages are just strings in the message log. an exception forces whatever metaprogramming tool interacting with Lean to handle the error, and can't be silently ignored.</p>",
        "id": 515583615,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746134242
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515583542\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"631691\">Thomas Zhu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515583127\">said</a>:</p>\n<blockquote>\n<p>I think it's complete coincidence that the <code>apply?</code> REPL bug and <code>#print axioms</code> bug coincided in the same miniF2F problem. This is because of their two incorrect examples in Appendix B didn't add any <code>Type*</code> in the proof.</p>\n</blockquote>\n<p>Would <code>Cardinality.toNat</code> add <code>Type*</code>?</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"k\">calc</span>\n<span class=\"w\">    </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Cardinal</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">cast_inj</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Cardinal</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">apply?</span>\n<span class=\"w\">    </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">cast_inj</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h0</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>It introduces a universe metavariable <del>which gets converted into a universe parameter after the declaration finishes elaborating</del>. This causes the bug where something bad happens if a declaration has universe parameters not mentioned in its type.</p>",
        "id": 515583742,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1746134296
    },
    {
        "content": "<p>Is that bug related to either the apply? bug or the print axioms bug?</p>",
        "id": 515583996,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746134419
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515583615\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515583510\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515583408\">said</a>:</p>\n<blockquote>\n<p>I think tactics should not rely on error messages to indicate they have failed. All tactics should fail via throwing exceptions.</p>\n</blockquote>\n<p>What's the difference between an error message and an exception?</p>\n</blockquote>\n<p>error messages are just strings in the message log. an exception forces whatever metaprogramming tool interacting with Lean to handle the error, and can't be silently ignored.</p>\n</blockquote>\n<p>I think most tactics do this already. When a nested tactic failure happens, it propagates up the monad.</p>",
        "id": 515584026,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1746134437
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515584026\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515583615\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515583510\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515583408\">said</a>:</p>\n<blockquote>\n<p>I think tactics should not rely on error messages to indicate they have failed. All tactics should fail via throwing exceptions.</p>\n</blockquote>\n<p>What's the difference between an error message and an exception?</p>\n</blockquote>\n<p>error messages are just strings in the message log. an exception forces whatever metaprogramming tool interacting with Lean to handle the error, and can't be silently ignored.</p>\n</blockquote>\n<p>I think most tactics do this already. When a nested tactic failure happens, it propagates up the monad.</p>\n</blockquote>\n<p>but what if a tactic just sets the message log and silently returns. <code>ring_nf</code> behaves like this if it can't make progress.</p>",
        "id": 515584385,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746134607
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"631691\">Thomas Zhu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515582945\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515581871\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p><code>#print axioms</code> did break, but as far as I know, <code>#print axioms</code> is not used by DeepSeek's team to check correctness. The agent probably didn't find/exploit whatever bug I found.</p>\n</blockquote>\n<p>Maybe.  But in that case, I'm surprised <code>apply?</code> wasn't used more by the AI.  You could solve everything with it.</p>\n</blockquote>\n<p>I suspect: the bug in REPL (or whatever DeepSeek used) was similar to squiggly lines in VS Code in that there is an upper limit to the number of messages, so the <code>declaration uses sorry</code> and the <code>AddConstAsyncResult.commitConst</code> messages were not caught. This depends on <code>apply?</code> suggesting enough suggestions to exceed this upper limit. I suspect REPL will find that <code>example : False := by apply?</code> is wrong but won't find that <code>example : a very long untrue prop := by apply?</code> is wrong.</p>\n</blockquote>\n<p><del><code>example : False := by apply?</code> will not raise any warning (sorry message) when using Lean v4.9.0. Same happens for the REPL using this Lean version.</del><br>\n<del>However, when using more recent Lean versions, the REPL will complain that the declaration is using sorry. This whole discussion would have never happened if DeepSeek used Lean v4.15.0 for example.</del><br>\n<del>But this raised the important problem that we should type check the proof correctly and that the REPL is currently not doing it in command mode <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></del></p>",
        "id": 515584428,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746134630
    },
    {
        "content": "<p>Thanks for the fact check!</p>",
        "id": 515584622,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746134709
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515584385\">said</a>:</p>\n<blockquote>\n<p><code>ring_nf</code> behaves like this if it can't make progress.</p>\n</blockquote>\n<p>Can you provide an example? I can't seems to reproduce this.</p>",
        "id": 515584906,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1746134816
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515584906\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515584385\">said</a>:</p>\n<blockquote>\n<p><code>ring_nf</code> behaves like this if it can't make progress.</p>\n</blockquote>\n<p>Can you provide an example? I can't seems to reproduce this.</p>\n</blockquote>\n<p><a href=\"https://github.com/stanford-centaur/PyPantograph/issues/97\">https://github.com/stanford-centaur/PyPantograph/issues/97</a></p>",
        "id": 515585029,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746134865
    },
    {
        "content": "<p>So <code>ring_nf</code> doesn't throw a message.</p>",
        "id": 515585233,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1746134953
    },
    {
        "content": "<p>When using Lean <code>v4.9.0</code> this snippet: </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">False</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"bp\">?</span>\n</code></pre></div>\n<p>raises the following warning message: </p>\n<div class=\"codehilite\" data-code-language=\"Bash Session\"><pre><span></span><code><span class=\"go\">declaration uses 'sorry'</span>\n</code></pre></div>",
        "id": 515585295,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1746134997
    },
    {
        "content": "<p><del>@<strong>Thomas Zhu</strong> I wasn't testing your hypothesis about <code>example : a very long untrue prop := by apply?</code>. I was just testing if DeepSeek proof <code>apply?</code> issue is now caught with more recent Lean versions and the Lean REPL.</del><br>\n<del>I assumed the same would apply with <code>example : False := by apply?</code>, but your hypothesis is confirmed: in Lean v4.9.0 we have a <code>sorry</code> warning with <code>example : False := by apply?</code> but not with long enough declarations/proofs using <code>apply?</code>.</del></p>",
        "id": 515585735,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746135177
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"556875\">Pietro Monticone</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515585295\">said</a>:</p>\n<blockquote>\n<p>When using Lean <code>v4.9.0</code> this snippet: </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">False</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"bp\">?</span>\n</code></pre></div>\n<p>raises the following warning message: </p>\n<p><div class=\"codehilite\" data-code-language=\"Bash Session\"><pre><span></span><code><span class=\"go\">declaration uses 'sorry'</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Just to be clear: you mean Lean REPL v4.9.0, and not just Lean v4.9.0?</p>",
        "id": 515586025,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746135303
    },
    {
        "content": "<p>No, I mean Lean <code>v4.9.0</code>.</p>",
        "id": 515586208,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1746135385
    },
    {
        "content": "<p>Yes, I am sure that an unsuccessful <code>apply?</code> raises the <code>declaration uses 'sorry'</code> message in any proof in any Lean version. The question is whether this message will be caught by Lean REPL (and whatever DeepSeek uses to check their proofs). It appears from the above messages that it isn't (at least in some theorems) but I have not tested myself. Also, completely unrelatedly, the warning message doesn't have an orange squiggly line in VS Code due to the 500 message limit.</p>",
        "id": 515586851,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746135687
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"631691\">@Thomas Zhu</span> your hypothesis \"I suspect REPL will find that <code>example : False := by apply?</code> is wrong but won't find that <code>example : a very long untrue prop := by apply?</code> is wrong.\" is always true even in recent Lean versions. Sorry for the mix up, I added strikethrough to both my messages above. It seems that whenever we have a situation where we don't have the <code>sorry</code> squiggles in the IDE (i.e. no sorry message is raised), the same applies to the REPL</p>",
        "id": 515586956,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746135724
    },
    {
        "content": "<p>[PS: I think the undetected error <em>preceding</em> the <code>apply?</code> in <code>putnam_2007_b4</code> is at least as interesting]</p>",
        "id": 515587285,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1746135870
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"556875\">Pietro Monticone</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515587285\">said</a>:</p>\n<blockquote>\n<p>[PS: I think the undetected error <em>preceding</em> the <code>apply?</code> in <code>putnam_2007_b4</code> is at least as interesting]</p>\n</blockquote>\n<p>I think that is the same as the AddConstAsyncResult.commitConst error in algebra_amgm_prod1toneq1_sum1tongeqn: the error is detected, but the error message is somehow flooded by the many suggestions from <code>apply?</code></p>",
        "id": 515587721,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746136067
    },
    {
        "content": "<p>I'd encourage people in future to create new threads in other channels and link to them here when you find a weird Lean behavior; remember that many people very familiar with the internals of Lean may not bother reading threads in this channel.</p>",
        "id": 515588398,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746136406
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515585029\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515584906\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515584385\">said</a>:</p>\n<blockquote>\n<p><code>ring_nf</code> behaves like this if it can't make progress.</p>\n</blockquote>\n<p>Can you provide an example? I can't seems to reproduce this.</p>\n</blockquote>\n<p><a href=\"https://github.com/stanford-centaur/PyPantograph/issues/97\">https://github.com/stanford-centaur/PyPantograph/issues/97</a></p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/24529\">#24529</a></p>",
        "id": 515588512,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1746136447
    },
    {
        "content": "<p>Maybe DeepSeek-Prover V2 specifically learned through RL to generate <code>apply?</code> to flood messages with info messages to hide errors in preceding code. Since they are doing a recursive subgoal decomposition, it is possible that using <code>apply?</code> was the only way for the model to get unstuck.</p>",
        "id": 515588559,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746136472
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321854\">Auguste Poiroux</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515586956\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"631691\">Thomas Zhu</span> your hypothesis \"I suspect REPL will find that <code>example : False := by apply?</code> is wrong but won't find that <code>example : a very long untrue prop := by apply?</code> is wrong.\" is always true even in recent Lean versions. Sorry for the mix up, I added strikethrough to both my messages above. It seems that whenever we have a situation where we don't have the <code>sorry</code> squiggles in the IDE (i.e. no sorry message is raised), the same applies to the REPL</p>\n</blockquote>\n<p>That is very weird to me: the number 500 is <a href=\"https://github.com/microsoft/vscode/blob/3f0b857f7fd96e532df82c85614ebd08675bd8e4/src/vs/editor/common/services/markerDecorationsService.ts#L116\">hard-coded</a> by VS Code. (<a href=\"#narrow/channel/270676-lean4/topic/.23print.20axioms.20does.20not.20report.20sorry/near/515571523\">source</a>)</p>",
        "id": 515589946,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746137165
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321854\">@Auguste Poiroux</span> do you have an example of the \"very long untrue prop := by apply?\" that tricks REPL? Somehow I couldn't reproduce it</p>",
        "id": 515592319,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746138403
    },
    {
        "content": "<p>O_O thanks for looking into this. This makes me dig into the REPL. So:</p>\n<ul>\n<li>it turns out that the REPL outputs all the messages.</li>\n<li>On the <code>algebra_amgm_prod1toneq1_sum1tongeqn</code> problem, the <code>declaration use sorry</code> message is in the list of the messages for Lean v4.18.0, but not for Lean v4.9.0.</li>\n</ul>\n<p>This may explain also why I was confused in my previous messages (it is also late where I am, so I am increasingly making more mistakes as well ^^)</p>",
        "id": 515592438,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746138465
    },
    {
        "content": "<p>So if I understand correctly, this is a bug in REPL v4.9.0 that was fixed before v4.18.0?</p>",
        "id": 515592619,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746138573
    },
    {
        "content": "<p>And thanks for grounding my speculations by doing so many tests! There are many seemingly related issues here that aren't really related.</p>",
        "id": 515593167,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746138845
    },
    {
        "content": "<p>Well, I don't think so. This surely complicates things, but I am using a <a href=\"https://github.com/augustepoiroux/repl/tree/v1.0.7\">backport</a> of the recent REPL in Lean v4.9.0. So the REPL code between v4.18.0 and v4.9.0 should be very similar.<br>\nBut maybe we should check with the original v4.9.0 of the REPL to make sure that we are not dealing with other issues on top of the original ones. (although it is likely that the issue will be the same since DeepSeek has the same undetected <code>apply?</code> issue)</p>",
        "id": 515593237,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746138898
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"631691\">Thomas Zhu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515593167\">said</a>:</p>\n<blockquote>\n<p>And thanks for grounding my speculations by doing so many tests! There are many seemingly related issues here that aren't really related.</p>\n</blockquote>\n<p>You speculate quite well, hopefully we can fix this issue soon <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 515593359,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746138963
    },
    {
        "content": "<p>there should be an option for setting which axioms you allow or disallow. I feel like having to manually parse for sorries is a bit sketchy</p>",
        "id": 515594352,
        "sender_full_name": "Frederick Pu",
        "timestamp": 1746139518
    },
    {
        "content": "<p>Indeed, I am just trying to understand what's happening about these sorry messages right now.<br>\nBut we should implement something rigorous for proof checking in the REPL.</p>",
        "id": 515594829,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746139779
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321854\">Auguste Poiroux</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515594829\">said</a>:</p>\n<blockquote>\n<p>Indeed, I am just trying to understand what's happening about these sorry messages right now.<br>\nBut we should implement something rigorous for proof checking in the REPL.</p>\n</blockquote>\n<p>Could this be a separate package for benchmarking / automated theorem proving? I was already considering writing this but have been working on other things. Perhaps we should create a new thread to discuss creating a rigorous proof checking system in the REPL.</p>",
        "id": 515595093,
        "sender_full_name": "Justin Asher",
        "timestamp": 1746139927
    },
    {
        "content": "<p>we have this kind of proof checking system in pantograph</p>",
        "id": 515602944,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746144654
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515602944\">said</a>:</p>\n<blockquote>\n<p>we have this kind of proof checking system in pantograph</p>\n</blockquote>\n<p>Via sorry collection? E.g., <code>frontend.process</code></p>",
        "id": 515604732,
        "sender_full_name": "Justin Asher",
        "timestamp": 1746145681
    },
    {
        "content": "<p>Can you also check for axioms in pantograph? I am worried about LLMs cheating in more complicated, e.g., document based setups where they try to prove a theorem over many lines and declarations.</p>",
        "id": 515604983,
        "sender_full_name": "Justin Asher",
        "timestamp": 1746145807
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"780541\">Justin Asher</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515604732\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515602944\">said</a>:</p>\n<blockquote>\n<p>we have this kind of proof checking system in pantograph</p>\n</blockquote>\n<p>Via sorry collection? E.g., <code>frontend.process</code></p>\n</blockquote>\n<p>No. During proof search, tactics generating sorrys or unsafe definitions will be immediately rejected. At the end of a proof, if there are sorrys or unsafes the proof will be rejected as well.</p>",
        "id": 515608243,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746147103
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"780541\">Justin Asher</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515604983\">said</a>:</p>\n<blockquote>\n<p>Can you also check for axioms in pantograph? I am worried about LLMs cheating in more complicated, e.g., document based setups where they try to prove a theorem over many lines and declarations.</p>\n</blockquote>\n<p>The way I intended is that unfiltered inputs should never go into <code>frontend.process</code>. All LLM interactions need to be done via <code>goal.{tactic,continue}</code> functions, where we have more control over the environment.</p>",
        "id": 515608337,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746147152
    },
    {
        "content": "<p>If the LLM can interact with frontend.process, it is inherently unsafe, and the model can cheat by adding new axioms</p>",
        "id": 515608395,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746147194
    },
    {
        "content": "<p>I downloaded the minif2f solution folder they released.</p>\n<p><a href=\"https://github.com/deepseek-ai/DeepSeek-Prover-V2\">https://github.com/deepseek-ai/DeepSeek-Prover-V2</a></p>\n<p>With a grep search, I found a single file containing the <code>apply?</code>.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">rg</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">apply?'</span>\n<span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"mi\">23</span><span class=\"o\">:</span><span class=\"w\">        </span><span class=\"n\">apply?</span>\n<span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"w\"> </span><span class=\"bp\">%</span>\n</code></pre></div>\n<p>So I think it is not that bad for MiniF2F?</p>\n<p>The file <br>\n<code>minif2f-solutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean</code><br>\nlooks like this</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Aesop</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">maxHeartbeats</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">BigOperators</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"n\">Topology</span><span class=\"w\"> </span><span class=\"n\">Rat</span>\n\n<span class=\"sd\">/-- Show that for any real-valued function $a$ on the natural numbers such that $\\forall i \\in \\mathbb{N}, a_i \\geq 0$, if $prod_{i=0}^{n-1} a_i = 1$, then $sum_{i=0}^{n-1} a_i \\geq n$.-/</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">NNReal</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">h₀</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">prod</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">sum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">am_gm_inequality</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">NNReal</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">),</span>\n<span class=\"w\">    </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">sum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">prod</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">step0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">NNReal</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">sum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">prod</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">m</span>\n<span class=\"w\">      </span><span class=\"c1\">-- (Removed to prevent data leakage...)</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">sum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">prod</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">        </span><span class=\"c1\">-- NOTE: The `apply?` line is here</span>\n<span class=\"w\">        </span><span class=\"n\">apply?</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h₂</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">step1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">NNReal</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">sum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">prod</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"c1\">-- (Removed to prevent data leakage...)</span>\n</code></pre></div>",
        "id": 515612895,
        "sender_full_name": "Deming Xu",
        "timestamp": 1746149092
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"740877\">@Deming Xu</span> Yes, this is the one we extensively talked about above. The other solutions probably don't have this issue</p>",
        "id": 515613055,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746149152
    },
    {
        "content": "<p>I’m unclear.  Has someone put all the miniF2F solutions through leanchecker?  Is this that only one which fails?</p>",
        "id": 515615175,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746149716
    },
    {
        "content": "<p>Someone should definitely do that; I am saying other proofs don't have the <code>apply?</code> issue.</p>",
        "id": 515615317,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746149750
    },
    {
        "content": "<p>I know.  Sorry I started a new topic.</p>",
        "id": 515615454,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746149788
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lean_proj</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Canonical</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">repository</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Canonical'</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"n\">changes</span>\n<span class=\"n\">Try</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">NNReal</span><span class=\"bp\">.</span><span class=\"n\">le_div_iff'</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mpr</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"n\">Try</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">NNReal</span><span class=\"bp\">.</span><span class=\"n\">le_of_forall_lt_one_mul_le</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"n\">found</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">partial</span><span class=\"w\"> </span><span class=\"n\">proof</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">corresponding</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">NNReal</span><span class=\"bp\">.</span><span class=\"n\">div_le_div_left</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"n\">Try</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">NNReal</span><span class=\"bp\">.</span><span class=\"n\">le_of_forall_pos_le_add</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n\n<span class=\"bp\">...</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">about</span><span class=\"w\"> </span><span class=\"mi\">800</span><span class=\"w\"> </span><span class=\"n\">lines</span><span class=\"o\">)</span>\n\n<span class=\"n\">Try</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">WithUpperSet</span><span class=\"bp\">.</span><span class=\"n\">toUpperSet_specializes_toUpperSet</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"n\">Try</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">WithUpperSet</span><span class=\"bp\">.</span><span class=\"n\">toUpperSet_le_iff</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n\n<span class=\"o\">(</span><span class=\"n\">Look</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">following</span><span class=\"w\"> </span><span class=\"n\">line</span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">It</span><span class=\"w\"> </span><span class=\"n\">mentions</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"bp\">.</span><span class=\"o\">)</span>\n\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">9</span><span class=\"o\">:</span><span class=\"mi\">8</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">declaration</span><span class=\"w\"> </span><span class=\"n\">uses</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"gr\">sorry</span><span class=\"bp\">'</span>\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">10</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">unused</span><span class=\"w\"> </span><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"ss\">`h₀</span><span class=\"bp\">`</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unusedVariables</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">49</span><span class=\"o\">:</span><span class=\"mi\">8</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">never</span><span class=\"w\"> </span><span class=\"n\">executed</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unreachableTactic</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">50</span><span class=\"o\">:</span><span class=\"mi\">8</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">never</span><span class=\"w\"> </span><span class=\"n\">executed</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unreachableTactic</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">70</span><span class=\"o\">:</span><span class=\"mi\">10</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">never</span><span class=\"w\"> </span><span class=\"n\">executed</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unreachableTactic</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">71</span><span class=\"o\">:</span><span class=\"mi\">10</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">never</span><span class=\"w\"> </span><span class=\"n\">executed</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unreachableTactic</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">72</span><span class=\"o\">:</span><span class=\"mi\">10</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">never</span><span class=\"w\"> </span><span class=\"n\">executed</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unreachableTactic</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">89</span><span class=\"o\">:</span><span class=\"mi\">8</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">never</span><span class=\"w\"> </span><span class=\"n\">executed</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unreachableTactic</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">90</span><span class=\"o\">:</span><span class=\"mi\">8</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">never</span><span class=\"w\"> </span><span class=\"n\">executed</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unreachableTactic</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">49</span><span class=\"o\">:</span><span class=\"mi\">8</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">norm_num</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h₁</span><span class=\"w\"> </span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"n\">h₃</span><span class=\"w\"> </span><span class=\"n\">h₄</span><span class=\"w\"> </span><span class=\"n\">h₅'</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">nothing</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unusedTactic</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">50</span><span class=\"o\">:</span><span class=\"mi\">8</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">linarith'</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">nothing</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unusedTactic</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">70</span><span class=\"o\">:</span><span class=\"mi\">10</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp_all</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h₀</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">geometric_mean_eq_one</span><span class=\"o\">]</span><span class=\"bp\">'</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">nothing</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unusedTactic</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">71</span><span class=\"o\">:</span><span class=\"mi\">10</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">norm_num'</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">nothing</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unusedTactic</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">72</span><span class=\"o\">:</span><span class=\"mi\">10</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">linarith'</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">nothing</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unusedTactic</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">89</span><span class=\"o\">:</span><span class=\"mi\">8</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">norm_num</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h₁</span><span class=\"w\"> </span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"n\">h₃</span><span class=\"w\"> </span><span class=\"n\">h₄</span><span class=\"w\"> </span><span class=\"n\">h₅</span><span class=\"w\"> </span><span class=\"n\">h₆</span><span class=\"w\"> </span><span class=\"n\">h₇</span><span class=\"w\"> </span><span class=\"n\">h₈</span><span class=\"w\"> </span><span class=\"n\">h₉</span><span class=\"w\"> </span><span class=\"n\">h₁₀</span><span class=\"w\"> </span><span class=\"n\">h₁₁</span><span class=\"w\"> </span><span class=\"n\">h₁₂'</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">nothing</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unusedTactic</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">./</span><span class=\"n\">LeanProj</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">solutions</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">90</span><span class=\"o\">:</span><span class=\"mi\">8</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">nlinarith'</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">nothing</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unusedTactic</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n</code></pre></div>",
        "id": 515615972,
        "sender_full_name": "Deming Xu",
        "timestamp": 1746149912
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515615454\">said</a>:</p>\n<blockquote>\n<p>I know.  Sorry I started a new topic.</p>\n</blockquote>\n<p>No, it's definitely something that should be done in light of this error. Thanks for pointing out!</p>",
        "id": 515616201,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746150005
    },
    {
        "content": "<p>I ran <code>lake env lean xxx.lean</code>.<br>\nThe <code>warning: declaration uses 'sorry'</code> is in the output</p>",
        "id": 515617187,
        "sender_full_name": "Deming Xu",
        "timestamp": 1746150369
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"740877\">@Deming Xu</span> I meant run all of the proofs in Lean (using whatever lean version they used), and moreover use leanchecker and check for axioms.</p>",
        "id": 515617741,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746150619
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"740877\">@Deming Xu</span>  I notice the \"Canonical\" warning in your output; this probably means you are not using their Lean version of v4.9.0? And also you should use lean4checker instead of manually watching the warnings of lake env lean.</p>",
        "id": 515618203,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746150836
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4checker\">https://github.com/leanprover/lean4checker</a></p>",
        "id": 515618754,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746151031
    },
    {
        "content": "<p>I will try to run the check later. Thanks for your tips!</p>",
        "id": 515620350,
        "sender_full_name": "Deming Xu",
        "timestamp": 1746151449
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515617741\">said</a>:</p>\n<blockquote>\n<p>and moreover use leanchecker and check for axioms.</p>\n</blockquote>\n<p>I created <a class=\"message-link\" href=\"/#narrow/channel/270676-lean4/topic/Checking.20axioms.20with.20leanchecker/near/515616623\">#lean4 &gt; Checking axioms with leanchecker @ 💬</a>  regarding this</p>",
        "id": 515620556,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746151520
    },
    {
        "content": "<p>I'll mention <a href=\"https://github.com/GasStationManager/SafeVerify\">https://github.com/GasStationManager/SafeVerify</a><br>\nwhich was mostly based on lean4checker, but additionally: throws error if axioms other than the standard ones are used.</p>",
        "id": 515623695,
        "sender_full_name": "GasStationManager",
        "timestamp": 1746153155
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"776090\">@GasStationManager</span> can you put the message to the separate thread Eric posted? Thanks!</p>",
        "id": 515623774,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746153207
    },
    {
        "content": "<p>Wait, this really looks like a Lean v4.9.0 issue (fixed in recent versions). I am in a new v4.9.0 project with dependency on mathlib v4.9.0, and put DeepSeek's solutions to MiniF2FSolutions. Then I ran this:</p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>Header</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>$ lake env lean MiniF2FSolutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean\nTry this: refine (NNReal.le_div_iff' ?hr).mpr ?a✝\n... (many lines omitted)\nTry this: refine WithUpperSet.toUpperSet_le_iff.mp ?a✝\nMiniF2FSolutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean:49:8: warning: this tactic is never executed\nnote: this linter can be disabled with `set_option linter.unreachableTactic false`\nMiniF2FSolutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean:50:8: warning: this tactic is never executed\nnote: this linter can be disabled with `set_option linter.unreachableTactic false`\nMiniF2FSolutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean:70:10: warning: this tactic is never executed\nnote: this linter can be disabled with `set_option linter.unreachableTactic false`\nMiniF2FSolutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean:71:10: warning: this tactic is never executed\nnote: this linter can be disabled with `set_option linter.unreachableTactic false`\nMiniF2FSolutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean:72:10: warning: this tactic is never executed\nnote: this linter can be disabled with `set_option linter.unreachableTactic false`\nMiniF2FSolutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean:89:8: warning: this tactic is never executed\nnote: this linter can be disabled with `set_option linter.unreachableTactic false`\nMiniF2FSolutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean:90:8: warning: this tactic is never executed\nnote: this linter can be disabled with `set_option linter.unreachableTactic false`\nMiniF2FSolutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean:49:8: warning: 'norm_num at h₁ h₂ h₃ h₄ h₅' tactic does nothing\nnote: this linter can be disabled with `set_option linter.unusedTactic false`\nMiniF2FSolutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean:50:8: warning: 'linarith' tactic does nothing\nnote: this linter can be disabled with `set_option linter.unusedTactic false`\nMiniF2FSolutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean:70:10: warning: 'simp_all [h₀, geometric_mean_eq_one]' tactic does nothing\nnote: this linter can be disabled with `set_option linter.unusedTactic false`\nMiniF2FSolutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean:71:10: warning: 'norm_num' tactic does nothing\nnote: this linter can be disabled with `set_option linter.unusedTactic false`\nMiniF2FSolutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean:72:10: warning: 'linarith' tactic does nothing\nnote: this linter can be disabled with `set_option linter.unusedTactic false`\nMiniF2FSolutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean:89:8: warning: 'norm_num at h₁ h₂ h₃ h₄ h₅ h₆ h₇ h₈ h₉ h₁₀ h₁₁ h₁₂' tactic does nothing\nnote: this linter can be disabled with `set_option linter.unusedTactic false`\nMiniF2FSolutions/valid/algebra_amgm_prod1toneq1_sum1tongeqn.lean:90:8: warning: 'nlinarith' tactic does nothing\nnote: this linter can be disabled with `set_option linter.unusedTactic false`\n</code></pre></div>\n</div></div>\n<p>There is no <code>declaration uses 'sorry'</code> in the output messages at all. So this apply? issue is not a REPL bug, it's an older-Lean bug (if you expect a warning <code>declaration uses 'sorry'</code> in declarations that do use <code>sorry</code>, which there are good reasons not to).</p>",
        "id": 515629769,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746156819
    },
    {
        "content": "<p>Wait, I think I really underestimated the issue. The issue of <code>Type*</code> (which caused the <code>#print axioms</code> bug on Lean v4.19.0) and the issue of <code>apply?</code> are not related, but they interact in weird ways that really really looks like a Lean exploit (of course it isn't, this is just frontend issue, but it even tricks <code>lake build</code>). And <span class=\"user-mention\" data-user-id=\"115715\">@Jason Rute</span> was right that <code>Cardinal.toNat</code> indeed played a role in this in the Putnam solution; I was wrong. I will post in another thread.</p>",
        "id": 515638973,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746162175
    },
    {
        "content": "<p>Thread here: <a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/Lean.20v4.2E9.2E0.3A.20apply.3F.20might.20suppress.20other.20warnings.2Ferrors/with/515641973\">#lean4 &gt; Lean v4.9.0: apply? might suppress other warnings/errors</a></p>",
        "id": 515642003,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746164147
    },
    {
        "content": "<p>Given that the 7B model used <code>Cardinal.toNat</code> completely out of the blue, I am starting to think that it really actually discovered <em>and</em> exploited this bug/feature of Lean v4.9.0, where errors are not printed. Here, <code>Cardinal.toNat</code> has the same issue as <code>Type*</code> where it can't resolve the universe, but then this also seemed to trigger the weird behavior of apply? error suppression.  (See also <a href=\"https://github.com/hanwenzhu/lean-demo-20250502/blob/main/False2.lean\">https://github.com/hanwenzhu/lean-demo-20250502/blob/main/False2.lean</a> which passes CI)<br>\n<strong><em>I need to take back much of what I said earlier.</em></strong></p>",
        "id": 515648626,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746167483
    },
    {
        "content": "<p>DeepSpeech-Prover-V2.0 uses \"the same testing environment as DeepSpeech-Prover-V1.5\". This raises the question: Have these problems, e.g. apply?,  been observed in the DeepSpeech-Prover-V1.5 results?</p>",
        "id": 515657150,
        "sender_full_name": "Kelly Davis",
        "timestamp": 1746171604
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"631691\">@Thomas Zhu</span> for taking the time of looking into this.</p>",
        "id": 515658711,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746172256
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"900292\">Kelly Davis</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515657150\">said</a>:</p>\n<blockquote>\n<p>DeepSpeech-Prover-V2.0 uses \"the same testing environment as DeepSpeech-Prover-V1.5\". This raises the question: Have these problems, e.g. apply?,  been observed in the DeepSpeech-Prover-V1.5 results?</p>\n</blockquote>\n<p>I remember at some point that a LLM prover was frequently generating suspicious <code>inferInstance</code> in its proofs. But I don't remember which one was doing that, and I am not sure it is related to the issue we are discussing here.</p>",
        "id": 515658733,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1746172266
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"481527\">@Huajian Xin</span> can you say for DeepSeek-Prover v1.5 what Lean testing environment you used?  Did you double check the proofs after with lean4checker?   Did you observe any weird behavior of the model that might suggest it was bypassing your testing environment?  Like proofs with <code>apply?</code> or other suspicious stuff in the proofs?  Also I think this group here would love to know more about this same sort of information for v2, especially more examples of proofs that v2 found with <code>apply?</code>, if you have any connection to the current authors.</p>",
        "id": 515689277,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746183977
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515689277\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"481527\">Huajian Xin</span> can you say for DeepSeek-Prover v1.5 what Lean testing environment you used?  Did you double check the proofs after with lean4checker?   Did you observe any weird behavior of the model that might suggest it was bypassing your testing environment?  Like proofs with <code>apply?</code> or other suspicious stuff in the proofs?  Also I think this group here would love to know more about this same sort of information for v2, especially more examples of proofs that v2 found with <code>apply?</code>, if you have any connection to the current authors.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"115715\">@Jason Rute</span>  Hi Jason, v1.5 used a very straightforward method for checking (<a href=\"https://github.com/deepseek-ai/DeepSeek-Prover-V1.5/blob/main/prover/lean/verifier.py\">https://github.com/deepseek-ai/DeepSeek-Prover-V1.5/blob/main/prover/lean/verifier.py</a>) relying on warning messages. v2 should uses the same mechanism and I'll check these stuff with the current authors. I'm afraid that no update will be provided before May 6th because now Chinese are in hoilday time now :(</p>\n<p>Indeed in v1.5 I didn't observed the application of <code>apply?</code> in any generated proofs. They are new features in v2.</p>",
        "id": 515706169,
        "sender_full_name": "Huajian Xin",
        "timestamp": 1746190218
    },
    {
        "content": "<p>While, in general, personally I believe that we model trainers must cooperate with Lean community to tickle these unexpected behaviours.</p>",
        "id": 515707033,
        "sender_full_name": "Huajian Xin",
        "timestamp": 1746190462
    },
    {
        "content": "<p>By the way, this entire paragraph in DeepSeek-Prover-V2's paper also probably needs a rewrite: <br>\n<a href=\"/user_uploads/3121/cgeoPuf2SY-A_boQ-LoIbcc-/image.png\">image.png</a><br>\ngiven that I found that <code>Cardinal.toNat</code> is actually just a way the 7B model exploits the environment, at least in the first example of Appendix B. I strongly suspect all outputs by the 7B model of <code>Cardinal.toNat</code> are the same error. If true, it's still certainly \"skill discovery\" in some sense, but more like \"discovering the skill to exploit a bug in the proving environment\".</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/cgeoPuf2SY-A_boQ-LoIbcc-/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1814x566\" src=\"/user_uploads/thumbnail/3121/cgeoPuf2SY-A_boQ-LoIbcc-/image.png/840x560.webp\"></a></div>",
        "id": 515723450,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746195070
    },
    {
        "content": "<p>imo a feature like this would be helpful. After specifying an option of this form</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">set_option</span><span class=\"w\"> </span><span class=\"n\">forbid_new_axioms</span><span class=\"w\"> </span><span class=\"n\">true</span>\n</code></pre></div>\n<p>Lean would forbid the introduction of more axioms and sorrys for the rest of the current scope. This is like rust's forbid unsafe</p>",
        "id": 515729861,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746196756
    },
    {
        "content": "<p>This might not catch all errors, and I should try to use <code>lean4checker</code>, autograder, etc, but for now I managed to create a new Lean project with version <code>v4.9.0-rc2</code> from scratch. Then I made a <code>Basic.lean</code> file that imports all <code>minif2f_solutions</code> files and I ran <code>lake build &gt; out.txt 2&gt;&amp;1</code> with this lakefile: (I ran this on my laptop and left it overnight.)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lake</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lake</span><span class=\"w\"> </span><span class=\"n\">DSL</span>\n\n<span class=\"n\">package</span><span class=\"w\"> </span><span class=\"bp\">«</span><span class=\"n\">lean_proj2</span><span class=\"bp\">»</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n\n<span class=\"n\">require</span><span class=\"w\"> </span><span class=\"n\">mathlib</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">git</span>\n<span class=\"w\">  </span><span class=\"s2\">\"https://github.com/leanprover-community/mathlib4.git\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"s2\">\"v4.9.0-rc2\"</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">default_target</span><span class=\"kd\">]</span>\n<span class=\"n\">lean_lib</span><span class=\"w\"> </span><span class=\"bp\">«</span><span class=\"n\">LeanProj2</span><span class=\"bp\">»</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"c1\">-- add any library configuration options here</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">default_target</span><span class=\"kd\">]</span>\n<span class=\"n\">lean_exe</span><span class=\"w\"> </span><span class=\"n\">basic</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">root</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"ss\">`LeanProj2.Basic</span>\n<span class=\"w\">  </span><span class=\"n\">supportInterpreter</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">true</span>\n</code></pre></div>\n<p>The <code>out.txt</code> looks fine. </p>\n<p>These are the last few lines of the <code>out.txt</code>. It failed to build one file due to a timeout, but I realized that it is because I commented out the <code>set_option maxHeartbeats 0</code> line when browsing the files in VSCode...</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././././</span><span class=\"n\">LeanProj2</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">mathd_numbertheory_221</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">54</span><span class=\"o\">:</span><span class=\"mi\">6</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Used</span><span class=\"w\"> </span><span class=\"ss\">`tac1</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">tac2</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tac1</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">tac2</span><span class=\"o\">)</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">would</span><span class=\"w\"> </span><span class=\"n\">suffice</span>\n<span class=\"n\">note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unnecessarySeqFocus</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n<span class=\"bp\">✔</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">10348</span><span class=\"bp\">/</span><span class=\"mi\">10349</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Built</span><span class=\"w\"> </span><span class=\"n\">LeanProj2</span><span class=\"bp\">.</span><span class=\"n\">minif2f</span><span class=\"bp\">.</span><span class=\"n\">valid</span><span class=\"bp\">.</span><span class=\"n\">mathd_numbertheory_221</span><span class=\"o\">:</span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">o</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">LeanProj2</span><span class=\"bp\">.</span><span class=\"n\">minif2f</span><span class=\"bp\">.</span><span class=\"n\">valid</span><span class=\"bp\">.</span><span class=\"n\">numbertheory_sumkmulnckeqnmul2pownm1</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">✖</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">5273</span><span class=\"bp\">/</span><span class=\"mi\">10349</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Building</span><span class=\"w\"> </span><span class=\"n\">LeanProj2</span><span class=\"bp\">.</span><span class=\"n\">minif2f</span><span class=\"bp\">.</span><span class=\"n\">valid</span><span class=\"bp\">.</span><span class=\"n\">numbertheory_sumkmulnckeqnmul2pownm1</span>\n<span class=\"n\">trace</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.&gt;</span><span class=\"w\"> </span><span class=\"n\">LEAN_PATH</span><span class=\"bp\">=././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">batteries</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"w\"> </span><span class=\"bp\">......</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././././</span><span class=\"n\">LeanProj2</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">numbertheory_sumkmulnckeqnmul2pownm1</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">101</span><span class=\"o\">:</span><span class=\"mi\">4</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">simp'</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">nested</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span>\n<span class=\"o\">(</span><span class=\"n\">deterministic</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">timeout</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"ss\">`whnf</span><span class=\"bp\">`</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">maximum</span><span class=\"w\"> </span><span class=\"n\">number</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">heartbeats</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">200000</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">reached</span>\n<span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">maxHeartbeats</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"n\">num</span><span class=\"bp\">&gt;`</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">limit</span>\n<span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">diagnostics</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">get</span><span class=\"w\"> </span><span class=\"n\">diagnostic</span><span class=\"w\"> </span><span class=\"n\">information</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././././</span><span class=\"n\">LeanProj2</span><span class=\"bp\">/</span><span class=\"n\">minif2f</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">numbertheory_sumkmulnckeqnmul2pownm1</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">10</span><span class=\"o\">:</span><span class=\"mi\">67</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">deterministic</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">timeout</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"ss\">`whnf</span><span class=\"bp\">`</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">maximum</span><span class=\"w\"> </span><span class=\"n\">number</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">heartbeats</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">200000</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">reached</span>\n<span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">maxHeartbeats</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"n\">num</span><span class=\"bp\">&gt;`</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">limit</span>\n<span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">diagnostics</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">get</span><span class=\"w\"> </span><span class=\"n\">diagnostic</span><span class=\"w\"> </span><span class=\"n\">information</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>\n<p>For the <code>LeanProj2.minif2f.valid.algebra_amgm_prod1toneq1_sum1tongeqn</code> file you discussed above, indeed <code>lake build</code> did not print the <code>sorry</code> message. I only see the <code>Try this: ...</code> lines from the <code>apply?</code>. </p>\n<p>In VSCode, there are also no \"uses sorry\" warnings for this file, while if I type <code>example : False := by apply?</code> in this version of Lean it does show the yellow \"uses sorry\" warning. </p>\n<p>I also clicked into some other Lean files in VSCode and they look fine. With text search in VSCode I did not find other \"uses sorry\", \"error\",  \"Try this: refine ...\" warnings in <code>out.txt</code>. There are quite a lot of warnings about <br>\n<code>unused tactics, unused variables, ring -&gt; ring_nf, &lt;;&gt; -&gt; ;, simpa -&gt; simp, deprecated theorems</code>, etc.</p>\n<p>Also, there are 244 test problems and 244 validation problems in MiniF2F. The released folder contains solutions to 217 test problems and 222 validation problems (including the <code>apply?</code> one in the validation set), which means the pass rate is:</p>\n<ul>\n<li>Test: 217/244 =0.8893</li>\n<li>Valid: 222/244 = 0.9098<br>\nwhich matches the 88.9% in the paper.</li>\n</ul>",
        "id": 515740028,
        "sender_full_name": "David Xu",
        "timestamp": 1746199577
    },
    {
        "content": "<p>Just for visibility, I am crossposting this from another <a href=\"#narrow/channel/270676-lean4/topic/Lean.20v4.2E9.2E0.3A.20apply.3F.20might.20suppress.20other.20warnings.2Ferrors\">thread</a>, where with <span class=\"user-mention\" data-user-id=\"110596\">@Rob Lewis</span>'s quick help we have a demo of using his autograder to catch this problem, on either <code>v4.9.0</code> (where the declaration is missing) or on <code>v4.15.0</code> (where the declaration includes a sorry):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">clone</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">-</span><span class=\"n\">em</span><span class=\"bp\">/</span><span class=\"n\">autograder_false</span>\n<span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">autograder_false</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">checkout</span><span class=\"w\"> </span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span>\n<span class=\"bp\">./</span><span class=\"n\">autograder</span><span class=\"bp\">.</span><span class=\"n\">sh</span><span class=\"w\">    </span><span class=\"bp\">#</span><span class=\"w\"> </span><span class=\"n\">reports</span><span class=\"w\"> </span><span class=\"s2\">\"Proof contains sorry\"</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">checkout</span><span class=\"w\"> </span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">9</span><span class=\"bp\">.</span><span class=\"m\">0</span>\n<span class=\"bp\">./</span><span class=\"n\">autograder</span><span class=\"bp\">.</span><span class=\"n\">sh</span><span class=\"w\">   </span><span class=\"bp\">#</span><span class=\"w\"> </span><span class=\"n\">reports</span><span class=\"w\"> </span><span class=\"s2\">\"Declaration not found in submission\"</span>\n</code></pre></div>",
        "id": 515743601,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1746200671
    },
    {
        "content": "<p>Note the that version of the autograder being used on the <code>v4.9.0</code> tag is a hacked together version that Rob just prepared, and it really shouldn't be used!</p>\n<p>If you need the autograder functionality, you are recommended to upgrade to <code>v4.15.0</code>.</p>",
        "id": 515743777,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1746200721
    },
    {
        "content": "<p>How hard would it be to check all the minif2f proofs of DeepSeek?</p>",
        "id": 515743875,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746200748
    },
    {
        "content": "<p>Hard enough that I'm not interested in doing it. An afternoon?</p>",
        "id": 515744011,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1746200782
    },
    {
        "content": "<p>…With the hacked up 4.9.0 grader.</p>",
        "id": 515744014,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746200782
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515743777\">said</a>:</p>\n<blockquote>\n<p>Note the that version of the autograder being used on the <code>v4.9.0</code> tag is a hacked together version that Rob just prepared, and it really shouldn't be used!</p>\n<p>If you need the autograder functionality, you are recommended to upgrade to <code>v4.15.0</code>.</p>\n</blockquote>\n<p>(Hacked together in the sense that the file paths are hardcoded; this version of the autograder was designed specifically for Gradescope's directory layout. The \"checking\" logic isn't changed at all.)</p>",
        "id": 515744135,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1746200821
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515743875\">said</a>:</p>\n<blockquote>\n<p>How hard would it be to check all the minif2f proofs of DeepSeek?</p>\n</blockquote>\n<p>At the very least, you might want to backport the <a href=\"https://github.com/search?q=repo%3Arobertylewis%2Flean4-autograder-main+local&amp;type=commits\"><code>--local</code> flag</a> from more recent versions of the autograder, which lets you specify a local submission and reference file.</p>",
        "id": 515744738,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1746200992
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/DP6w3ZuvzAOkvvnFlXcbyXE8/image.png\">image.png</a><br>\nIndeed. In my Lean <code>v4.9.0-rc2</code>, running <code>#print axioms</code> for the <code>apply?</code> theorem just says <code>unknown constant</code>.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/DP6w3ZuvzAOkvvnFlXcbyXE8/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"2704x978\" src=\"/user_uploads/thumbnail/3121/DP6w3ZuvzAOkvvnFlXcbyXE8/image.png/840x560.webp\"></a></div>",
        "id": 515745775,
        "sender_full_name": "David Xu",
        "timestamp": 1746201297
    },
    {
        "content": "<p>But just so I’m clear, the three <code>apply?</code> non-proofs from DeepSeek-Prover V2 (1 minif2f, 2 putnambench), do they pass all these other common checks on 4.9.0, even though the proof is faulty?</p>\n<ul>\n<li>Lean REPL</li>\n<li>VsCode Infoview</li>\n<li>Lake Build</li>\n<li>Lean4checker</li>\n<li><del>#print axioms</del></li>\n</ul>\n<p>Which would mean we need to incorporate ideas from tools like Lean Autograder to properly catch such UI bugs in the future?</p>",
        "id": 515745829,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746201310
    },
    {
        "content": "<p>(That is what I think I got from the <a href=\"#narrow/stream/270676-lean4/topic/Lean.20v4.2E9.2E0.3A.20apply.3F.20might.20suppress.20other.20warnings.2Ferrors\">other thread</a> in <a class=\"stream\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4\">#lean4</a> .)</p>",
        "id": 515746131,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746201417
    },
    {
        "content": "<p>It won't pass #print because it's never added to the environment. But the other tests don't produce an error message; I checked them manually</p>",
        "id": 515750980,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746202967
    },
    {
        "content": "<p>Oh by the way there are some nuances: in particular I couldn't get the second Putnam problem in their Appendix B to work. It has a clear indentation issue</p>",
        "id": 515753568,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746203736
    },
    {
        "content": "<p>Maybe they didn't copy the indentation to LaTeX correctly, or maybe it's something specific to their setup, but the bug it exploited looks like the same apply? one</p>",
        "id": 515754383,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746203964
    },
    {
        "content": "<p>The miniF2F problem produced some warnings (unreached tactics) but none of the warnings were declaration uses 'sorry'. The first Putnam problem is \"purer\": wrong proof, no warnings, no errors</p>",
        "id": 515754957,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746204145
    },
    {
        "content": "<p>A few notes about the <code>apply?</code> false-positive issues.</p>\n<ol>\n<li>\n<p>There are 3 instances of  <code>apply?</code> false-positives, two from putnam and one from minif2f/valid: <a href=\"https://live.leanprover.cn:7000/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQODOApjAPoRgzAQB2cISAHgBKFKxasz5wAMBxZClVr0GAJUIBjACKEKqOAEYeKlXnKFaAZWJwAcijgAxAK7VJlGjgC01uADMzcWoDLCOACY4APTgAKWgDUSgCUOAD0tjgAMrq0HHBIcJD4wJQAboRwwNQwhADmhFAAdMbZACZwaJnUJiAcUHAQ9klIwFDcAAoANHAAio3NkOgAntQQIMBI6NwA7qkKUKzocJIQhPb2wJLAmlxw+CaSCmgoOAA6ANo4vh2+ABrBwV6eQb6994/PcAC8cHdeAG93NQAL5wIKKc4AXRwSGoFTK+TgHTgAD44Ii8n0ijYwjgqtBCCAkiYYNQkCASO4VAB2EhYAAsODgLL8tAAXHBAKiEwTZyTgnNo6J4vPZzNZvgBNx6vVFfg6EBGYwmUzggFxCXkAdflitG40myw1cAAPsjvB5wX1zZ5fgqlfqpkU7ubfJ4AFTOXkQuCAciJkUVMYtMujegH8kGQUVzGwKt9xRLfI5aK4LT5/JbFI8Bdy4IAkwm5vOoot+WGG4tQSAycFQgECCbOAACJnNmuT0hbw834AfKZXKbrrlQb1VqdfaVYbeaaUT4Xlbpz9kf2HegnS73Z6M77/YHCMHsdvMpHo1AKpyefPPGnAiEBSWy6ysjkoBAm6hqPHq5XMgpOY2OdzW2i7b5pK3Z9L2dp6mOQ5wNqfajoORqTtalr9HOtqLmOK5pmuRYbn6HRhnkQaAaG+5wIekgxs2vK/BebIZsWcClu+LLZDAT4vm+94shWVa1tmIHSmBAkQQOqpGrBolLtBSFzkEqEWuh8GOs62FwB6uHevhhHESGOk7uRUaUce1Hni6V6ZjeTF3txPGftWgBBBAJXZCbKIkYQhw5wZBnkmmacmzopC7Kcuql+DhXpKL6LGsgRZF6WRYKcjo8C+N5YnjjBI4+eJjzBEZVG0eZDFWcxtn3lAMxwBcgAJhHAADCMbZI65IwI1+CkNkABWMLlaySBgGAIwAPwxSyhAMEgFgkCAEBlCQlEdY5MUTVN8C1u+q0WNWnHlvZqBOZygndMJR1SVBEnZRlMn+Ra8nIUpOWhau6nrlpW7hgZCWfQeBUmaeNGpvREKMWV/WDSM1Y1ptk3bdQyTiik4CJBcB1QnAJgpNQWIHTgQA\">putnam_2007_b4</a>, <a href=\"https://live.leanprover.cn:7000/#project=v4.10.0&amp;codez=JYWwDg9gTgLgBAWQIYwBYBtgCM4CgJgCmAdnAHIpwDKhMuuah0hIcYArjMUiAPoBMABkEBWXkgAscABSkAXHECohAEpccGQAk4C5DCjAAHjIBiwUsWUmzcC3EC4hJelI4OBSrUyq2xCn1HppqRIjoEulg4espAAzt6kgKZEcACMqurSGiR6wISxCoAARHDAcABW3qHEADRwWkWlALzJcIAURNWFJXANALQpkRrQaBDeGgB0GkjRAPKwqBAA5hDc6ABKEADu0akyqEiujYAmRHDOgOREh3AHpCdJZy5wJzjnm9JU0ey7gMBEMlD6ZdbOgEmEcHKjgAxt8FKEcACgVUvsBhgBJYjFQjAmDAABuhFucFBcMRyNRGKxJy8DRGLywIF8hg8sJx+keNGIWRy3gK0iK4N+jlKXNIWGUVS8tQ6yUsCmcACobudtA0sABPfBYGBIayAC/JYVVcVVUPokbrccVdRTAJfkcuoFLw20xcFQVzkSD2xDkdW2WGG/GGSVwNqxqH43nuNgt7s94f4vqQttQAGZvEhJVhnRbFR5gUh0MCPFKbg0AMJIKAAEzMmeGMAgFHgTjg0oFqYVcGioDAcAA2tXhhnojBeGZigBdPDqUdwXjXQslsvoCtVyiycXypVjsdIMBgdAKgD8HjHE4a8mXzdbHa7Pb7A8HuEIBiQqLtsaAA\">putnam_2005_a4</a> and <code>algebra_amgm_prod1toneq1_sum1tongeqn</code>.</p>\n</li>\n<li>\n<p>This issue occurs <strong>only in Lean versions ≤ 4.12.0</strong>. Commands like <code>lake build</code> and <code>lake env lean --json</code> complete without errors. Zero exit code, no sorry warnings thrown.</p>\n</li>\n<li>\n<p>Despite the lack of build-time errors, it can be triggered by <code>#print theorem_name</code>. <strong>The Lean kernel actually rejects the proof</strong>, so one cannot use it as a tactic.<br>\n<a href=\"/user_uploads/3121/mRyMpxDaWCINGA1Oh7WdHj4W/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/mRyMpxDaWCINGA1Oh7WdHj4W/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1652x792\" src=\"/user_uploads/thumbnail/3121/mRyMpxDaWCINGA1Oh7WdHj4W/image.png/840x560.webp\"></a></div></li>\n<li>\n<p>These behaviors appear to be related to universe-level inference, like <code>Cardinal.toNat</code> noted by <span class=\"user-mention\" data-user-id=\"481527\">@Huajian Xin</span> . In general, invalid <code>apply?</code> throws sorry warnings(<a href=\"https://live.leanprover.cn:7000/#project=v4.10.0&amp;codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQaCm0+IcAJsRHABQB2cAXHIKiEA1AJSN0C8cArAzywBPHEjBh0QgPxA\">example</a>). Replacing <code>apply?</code> with <code>sorry</code> will reveals this error. Here is a minimal reproducing case:</p>\n</li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kd\">theorem</span><span class=\"w\"> </span><span class=\"n\">error_demo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"k\">calc</span>\n<span class=\"w\">       </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">Cardinal.toNat</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"w\"> </span><span class=\"c1\">-- apply?</span>\n<span class=\"w\">       </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n</code></pre></div>\n<ol start=\"5\">\n<li>\n<p>A simple way to detect the invalid proofs is using <code>#print axioms theorem_name</code> and checking if <code>sorryAx</code> is in the list. All cases(438) passed this check on v4.9.0 except the <code>apply?</code> one. This verification method is also used by <a href=\"https://storage.googleapis.com/deepmind-media/DeepMind.com/Blog/imo-2024-solutions/P1/index.html\">alphaproof/p1</a><br>\n<a href=\"/user_uploads/3121/oq7bnuRHygcDt9o5xbMtNbgg/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/oq7bnuRHygcDt9o5xbMtNbgg/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1282x252\" src=\"/user_uploads/thumbnail/3121/oq7bnuRHygcDt9o5xbMtNbgg/image.png/840x560.webp\"></a></div></li>\n<li>\n<p>Upgrading to the stable release(v4.19.0)</p>\n<ul>\n<li>73 rejected cases, with 7 fixable by increasing <code>maxRecDepth</code>(<a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQpKxwCCApgM4Rg45kkwD6lMwEAdnCEgB4ASJSsLPxhk4ABhwBaSXFoMmLdpy4AlEgGMAIiTBo4ARjFGj1SiXYAhYAHMA8mBJQU0UWqTo4AORRwAKpQh0CGsATzgVFGoAemk4AHVUH2BRNBI4ABNgADMsx3N1NKEYAHcSczhU2QBXEDgILIrUNKzgKDJ4ABIAJiMAZg64EgA3cvUIKtZmVms4VhqhNrgkVnTGtLIauobKlrbOnrF+uvTVsYmpmbmQBbIAfjhqAYAdTjQoEABvAAoiAEo4J5wAC+4ieAEcwVUkKsXihUO9vhZ/oCQfpwZDoQDXvDPl8AMLI4FwLroqEw7EIr6aQkgg69UmY2FvXEAURpcAALEYAGxwAYAZVQEGKjSS8GSWLhlOpQMBdIAdJIojhUtASLUkCB1Poukh6HT6GB9HAvlU4EM4AAuOCAVEI4IAkwlt/y+qEAAQRWuCAACJZgAaOBm9gAXmJcAAVLM4ABqYnO1CAQIIPd7WH6LUGQ+H2NH9P9LTg4PmTV9AIhEcAA1nBgOwAGKVuTypzTNJ0v1m0v/GQl8uVuA11h1hvWJt9FNl/7BulW4NYEJ52T4ejuDxsdBhADaICq6AXJz9G63bBIu839DGIBAfu8MHle/oGyw9HQJCyDEy7Sg2AAurOoFl0EA\">example</a>)</li>\n<li>Most invalid proof is caused by the theorem-name-changing, leading to \"unknown constant/identifier\" errors</li>\n<li>Precedence/associativity <a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQaCm0+IcS6A5vllEgPpIjki0DOAriAIwwQB2+AR160wUCABNufdIM5wAFEjgAuOIFRCOICTCOADkdAJXxkAlAt4r1xnHBsLUgAIIL8wIhEcAB5xg5gGJeW+GAA6Gl5KOF4AGlJ3UwBecNNVeUB4IndPHz8A4KRQ/HCopTdTQBMiODlleKwAT2s4VCQANzzUQECCJ1SPLzhfXn8gkLDIhUKLQFxCYxKylUqa2zgWaChZm3qmusBggna0rp6+7Nz86I9VcbhS8pna23w3JABjeFa4AFpnuBgqsDyQYBYQFDuqHScHQKHwLHgTSgLGAfBwQA\">issues</a></li>\n<li>Tactic failures <a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQpKxwCCApgM4Rg45kkwD6lMwEAdnCEgB4ASJSsLPxhk4ABmqUS7AELAA5gHkwJKCmiiASv3RwAcijgAVShHQR5ATziaU1APQBaR8VaskAGjgzVMNSC8AYQFMLyRWABM4ABEkADdgKNR4kjgkOABjCHA6YGY2OBgIOFpUgHdUYAzUOAgAM0LUEhBM8LhUMyi0EmAoOCwoYRq66EbU81Z5cnhmEFSVKBYIr2B2EFWAVxhyADo4AEkGn1h/IJDgMMiY+MS0iK6m3sLQckKLOiaoL264QbIN9DMSYlDYtYCiNCDVKzV4/dDSeRoWoNGGNQxENzpDJtDroJKqfqDFCoPYAZVAwHQIUsKwaGPcZygoTSV1iCSi/xa3SeMLI3yav3IAPg4LgIw2fV53l8/gA5BCXnAFktLlFgHTMV5jn4kAEWVE2bdOWMeS8+WNBf9AXBRTAylVUsEmcB5c85nsAGKrJDodA0uA9eSoGZm1zuV2osDoDYQ6Ru17auUKuZK6OiMjALjx0ROzARxUkACOGx9ELKxTq6rQonqLPaEAle0OFvhkyRtdRaEMhqi2PYuKSooGQxtohIXDAf1oarWm22oiQC5K+EwlZIUTqagy+VYXgqhltAuNHYFrFBqnUfXCD1SEWk2W9RSgAH44KSOmU0SKRaIAEwADh2Rx7BwbpoGaDhiQiegfSmAYkHoAAWABWABOOAAAp0iwTI4CiAAuOBACxCABKTDUEAAII4EIgBmOAACo0jgABefo4AAalwziIjIjDUEAQIJqLgRCGLY1j0k4jIOLwkicDgeTyMAIIIhN/USpPE6ScO43jUEAYIIhP/USJLgABGMRRK0uAADY1JYuBf0QsjCMARMIIh2O92G4nYzxaViAOo1isEsOT2hSdpAFCCLB6CLJD0kI5CLLskTGLiwLgoU0K4lSVBABCCISEsYnDWOSpj8LSkKMswdxFjQCq4CqgQ8lQEKQuSLL2l0jJosLWKhLoxj1OEoyAv6dKFLa7K8to2ziuGsrRrq+SGpq5rKu9FaWvkib2hg7r6BMoT0lYg75qCurttyw67JO8qMq2sLUHCgzhs4szEs4myBrshyRr0xbMuywAwgnyxLZpS37Ir2xCkH+i7AHCCPqZqG8H5r0rqYuh2GHsACIJnvB17zMK6TPtwvyRNO6xlqarH2tQQBIgiEorMPJ4iyPsOACtK267vu2n+KowimYwlnSLgdnOdShaeYypAwCjawAFFCx2MhLBAEB/oy5w4AAVVoMVgBIPF6AzcA3mXcBV2sH4ixLHd9RKMx2pGPpcGlhSAB4AG4AD5flWeR6FYBpDFQYHACKiOBvb91gqdq93xyQbd2n5mnsv5oTBuFoTRfZ/qual6WLv4wTCKzkW2bgfPJbO935Nl+W4CVlW1Y1uu4G1vXUjXY3TbAc2+6ti1bZQFh2GvR30Gd0YMk1z3ff9yYg5D+BUARyPo7gWP1uphOuCT1eS/+qBPwAbXprwBIogBdNJV+x4+A+Xu/2lx8P/u36rd4UuPVrgVqHr0CihjegERgBxHoAlQWSUxYcxGrXcaD0ppiSGuLeBY0MoXSevFUGyMC6PWAT1TGPMLrA0IkdUyv1doxRMsfM+Ydb6h3Ch/aAIAg6ghfo9OA78eab1/nVROydcqbQBjtdGRDQHgPoHRMuMC87oPOkgzOciq4KJIQ9bBqivpg3wZ1KGMN1G0zIUxY6VCEI0LoXAc+gNGGr2YTzVgrD2EtCYdw/6fCd7xwUoI1eOUREXVAXtEyNFJEQJMlAvC106Ls3CWoxBtNkFRGOtE0yUDuaYI0YjcGgVpJSW4r9Ciad2jGIoTdHa5ieq0MMdlBG0DZpoNRkAqGoTIFFNQLjWR9TVGNPEUhFpNFLHWMvnDS+2NbERRYVANhPlOFPR4XdDxX8vHyR8e0Px8kAG03oJWdwugXJuQ8tJNyMy/KGQpnVE+VjUCBJoSEsBYTkLXzqtrAA6qkVgJB1wDw/F+C0x4UQCg8g+dwT4HY+QvKC2swTYGxNFABHYzyXBGEqKIUUttwE+mkDMYoZAPwB1+bE16dFTl7kqNUUchRFgJB9H6SlGwSAIoyo4qZ9BsRkBgHVTeUA6joBEQ3Wl1ydk+hwEAA\">(<code>norm_cast</code> failed)</a></li>\n<li>Stack overflow <a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQpKxwCCApgM4Rg45kkwD6lMwEAdnCEgB4ASJSsLPxhk4ABhp1GYZmw7cASiQDGAERIzUcAIxi9e6pRLsAQsADmAeTAkoKaKKVJ0cAHIo4AFUoR0EcwCecAoo1AD0ALQRcADqqB7AomgkcGBQEAAmAK7K8BAAZnDOLpBkwMwAbimZGXDArDAk5rai6ORJ8ewAJLr6XQD81F0AOo1cMADeABREAJQAvsNwwxn5dsoTvXoAhPPTAKz627MAegBMiwCOl1lItaMk49MmC0sra0gbW2K7E2cnE0OenmVxudxwDyeUwAwq9lqt1hMAJwopG/f6A/Qg4bXW73MaTKaqOHvRHfdEAoFiebLZQZCDwKm7HFgjIQgnTACiJIRn0xOz2GKpIK6cAAyqgIAB3OBoBLwRLLDlEhbwj5ffQ/QWUrG0+mMo7zAB0ETCOGS0BIICKIGU2jO9DOem09DA+zgAC4cHAfXAAGL1WgwI1pTJwKYB1hBo35YDoRpQcP5LLsLhwAC8AD44AAazlVVOzcOR6N2VjNHSa2ZFqbAWoeuCAVEI4IAkwibRfT3t9PvJcDC4bOcBOcCpcAAVCOjkWPem4FgAl34lU4Kh6Jx6p64IPh6OJ0y4IBiIkrR09s/nXZ9S5SqEAgQSb7eTvTjx8/Q/HnanucL7s+qJwACqtCyqgKQWlAVpwAABu4wYZBUGSMPka6ZPQJCXPQABetgQJBsoQKk6TLskcAZMAFSJNgcblEE85wGQkpSvU5jASk4HrqwGS2HUohYekRoXr6SBgGA6BBDBRpwQhBTIQhaGYdhAk+lA+ToAJjyfPAt5douSDLquob1v6gZ0CG6S1BGxnBrG8ZcVMyaphm2Z5gWcBcDWJYmWWFbfNW4Z1puzZto2Hbvq+/ZTA+u4vscn7nt2V4rneDYecGBnFpZMZxgmSYpq5jm5vmxiue5GVeSkPk1v5DaBe2GahdsfYDkOL7Pky05nt+P5QDKADa9HSkZUYmdZ2V2blaZZgVLluelQ3BmVoUhSlmU2YmY0OZNaYAKRbnV2glXNRoLT5X6Kb6yhsOYUBnT6jzwFwN10fgcA9eJJAFvQwD5PkAA0bgoEaIAoXJvEQIh9CSQAuo9AA8ADcmaPVMMBQEEEAgE0SBFvDiM/r6yOo49PoTET51ILQZAAOQcChMBSmDIPYYwUCMKwKRpoxaArtzONPeAL2oH9b0fV9v3/bB8Gfd9MmoehoPQ3jeO8+jmOk/M2MI0jKNoxj5hY2dCs/n+MQpGzJC1DA+GhkR8TwMRBk5HkhTFHANRwKwWQgEIUCiGs6M6HhcCoki3FwGhtwuJb9WNRFzVRW1Z3Kap3bqbkiXaT6QkiUE+lmTgQA\">errors</a></li>\n</ul>\n</li>\n</ol>\n<p>Upgrading to v4.19.0 seems less effective for these particular cases.</p>",
        "id": 515804742,
        "sender_full_name": "RexWang",
        "timestamp": 1746222879
    },
    {
        "content": "<p>I want to push back slightly.  While I think we are all figuring out the right way to avoid these errors in the future, there is no tried and true method that we have concensus on.  <code>#print axioms</code> can also fail to show an issue in some cases as documented far up in the thread shows (maybe not for 4.9.0, but maybe in the future all of these checks will fail at once).</p>",
        "id": 515811906,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746226753
    },
    {
        "content": "<p>(And Patrick seemed to suggest that print axioms was just a “convenience command” and not an integral part of Lean’s trusted computing base, or that was the impression I got.)</p>",
        "id": 515812065,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746226826
    },
    {
        "content": "<p>I remember reading the chapter called Trust in this book <em>Type Checking in Lean</em>, which discussed this issue:</p>\n<p><a href=\"https://ammkrn.github.io/type_checking_in_lean4/trust/trust.html\">https://ammkrn.github.io/type_checking_in_lean4/trust/trust.html</a></p>",
        "id": 515814439,
        "sender_full_name": "David Xu",
        "timestamp": 1746228202
    },
    {
        "content": "<p>In these cases, errors were not explicitly raised, though the kernel recognized the failure. I believe the crucial point is that <strong>an invalid theorem can never be passed as a valid tactic</strong>, as doing so could compromise the integrity of the entire system.</p>",
        "id": 515816989,
        "sender_full_name": "RexWang",
        "timestamp": 1746229857
    },
    {
        "content": "<p>What does it mean to pass a “theorem as a valid tactic”?</p>",
        "id": 515824556,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746234452
    },
    {
        "content": "<p>Again, I should reiterate there are 2 distinct issues:</p>\n<ul>\n<li>On Lean ≤ 4.12.0, <code>apply?</code> uses a synthetic sorry while not logging any errors. This suppresses all subsequent warnings and error messages, and the completely wrong <code>theorem f : False := by have := Type*; apply?</code> doesn't add <code>f</code> at all but doesn't print any errors. (DeepSeek-Prover-V2 found and exploited this.)</li>\n<li>On Lean ≥ 4.19.0, there is some issue with asynchronous elaboration when a universe parameter not in the declaration is mentioned in the proof. This is triggered by <code>theorem f : False := by have := Type*; sorry</code>. After throwing an error, <code>f</code> is (1) added to environment constants (as in <code>env.find?</code>) but (2) not added to kernel environment constants, and (1) makes <code>#print axioms f</code> to not raise errors, (2) makes <code>#print axioms f</code> to <a href=\"https://github.com/leanprover/lean4/blob/af4c693030f0491645bbaa5bbf7d75bb549e105e/src/Lean/Util/CollectAxioms.lean#L37\">ignore</a> <code>f</code>, so it thinks <code>f</code> doesn't depend on any axioms. (I found this.)</li>\n</ul>",
        "id": 515827458,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746236173
    },
    {
        "content": "<p>The first issue can simply be solved by <code>#check</code> or <code>#print axioms</code> or, more robustly, autograder.</p>\n<p>The second issue raises an error so cannot pass CI check.</p>\n<p>An ad-hoc solution to address the 2 issues is therefore to both do a <code>lake build</code>-style CI test and look for errors, and do a <code>#print axioms</code> to look for <code>sorryAx</code> (and implicitly assuring the function is added). However, a more future-proof solution might be needed, in case some future agent finds another Lean UI bug. I really like <span class=\"user-mention\" data-user-id=\"599027\">@Leni Aniva</span>'s suggestion of having an option that blocks new axioms and nonstandard axioms like sorry. However I don't know if that is yet another ad-hoc solution or am I thinking too much.</p>",
        "id": 515828356,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746236732
    },
    {
        "content": "<p>I should also say that the axiom-checking part of autograder uses the same function <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.collectAxioms#doc\">docs#Lean.collectAxioms</a> as <code>#print axioms</code>. I think there is a <a href=\"https://github.com/leanprover/lean4/blob/af4c693030f0491645bbaa5bbf7d75bb549e105e/src/Lean/Util/CollectAxioms.lean#L37\">flaw</a> in it (it ignores constants not in kernel environment, hence the <code>f does not depend on any axioms</code> error), but perhaps it is a deliberate feature? It was <a href=\"https://github.com/leanprover/lean4/commit/2287c7e7b333396fab75e90c87b9b1988ffd26ca\">written</a> almost 5 (!) years ago, but is only recently changed to use the kernel env. Long-term, I still think users should be able to rely on <code>#print axioms</code>...</p>",
        "id": 515828365,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746236741
    },
    {
        "content": "<p>Currently the DeepSeek team is training the model to write the entire Lean code block, and maybe they are executing the entire code block with REPL all at once, right?</p>\n<p>In that case I realized that technically there can be more creative ways to bypass the checks:</p>\n<ul>\n<li>As you mentioned the model might also find bugs that can trick both <code>#print axioms</code> and the <code>uses sorry</code> warning without triggering errors.</li>\n<li>Maybe the model could write <code>set_option forbid_new_axioms false</code> in the code block before the proof, to turn the restriction off?</li>\n<li>The model could try to redefine the symbols in the theorems, to make the same name mean different things, or even redefine the axioms (<code>propext</code>,  <code>Quot.sound</code>,  <code>Classical.choice</code>), or play some unicode tricks.</li>\n<li>Technically the model could execute OS commands by writing Lean code like the <code>os.system</code> in Python, so they could try to hijack the REPL / Pantograph test program and make them always reply \"proof succeeded\"?</li>\n</ul>\n<p>Running <code>lean4checker</code> for each proof might be a solution, but that means additional setup and version management, more complicated code, and possibly worse performance to check proofs?</p>",
        "id": 515830884,
        "sender_full_name": "David Xu",
        "timestamp": 1746238313
    },
    {
        "content": "<p>Just to expand on the point about <code>#print axioms</code>: people shouldn't expect it to be a potentially flawed nice extension to Lean; people expect it to simply be correct. Previous assertions that some formalized proofs are correct (<a href=\"https://mathstodon.xyz/@tao/111526765350663641\">PFR</a>, <a href=\"https://storage.googleapis.com/deepmind-media/DeepMind.com/Blog/imo-2024-solutions/P6/index.html\">AlphaProof</a>) usually use <code>#print axioms</code>.</p>",
        "id": 515830983,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746238372
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"740877\">Deming Xu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515830884\">said</a>:</p>\n<blockquote>\n<ul>\n<li>Technically the model could execute OS commands by writing Lean code like the <code>os.system</code> in Python, so they could try to hijack the REPL / Pantograph test program and make them always reply \"proof succeeded\"?</li>\n</ul>\n</blockquote>\n<p>That's a good point, it is certainly possible. I would just give up and say that is very unlikely because it doesn't appear in training data.</p>",
        "id": 515831816,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746238922
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"631691\">Thomas Zhu</span> <a href=\"#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515828365\">said</a>:</p>\n<blockquote>\n<p>I should also say that the axiom-checking part of autograder uses the same function <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.collectAxioms#doc\">docs#Lean.collectAxioms</a> as <code>#print axioms</code>. I think there is a <a href=\"https://github.com/leanprover/lean4/blob/af4c693030f0491645bbaa5bbf7d75bb549e105e/src/Lean/Util/CollectAxioms.lean#L37\">flaw</a> in it (it ignores constants not in kernel environment, hence the <code>f does not depend on any axioms</code> error), but perhaps it is a deliberate feature? It was <a href=\"https://github.com/leanprover/lean4/commit/2287c7e7b333396fab75e90c87b9b1988ffd26ca\">written</a> almost 5 (!) years ago, but is only recently changed to use the kernel env. Long-term, I still think users should be able to rely on <code>#print axioms</code>...</p>\n</blockquote>\n<p>Is that potential flaw in print axioms being discussed in a separate post or issue?</p>",
        "id": 515836682,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746242099
    },
    {
        "content": "<p><a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/.23print.20axioms.20does.20not.20report.20sorry/with/515566581\">#lean4 &gt; #print axioms does not report sorry</a></p>",
        "id": 515837465,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746242599
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"631691\">Thomas Zhu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515831816\">said</a>:</p>\n<blockquote>\n<p>That's a good point, it is certainly possible. I would just give up and say that is very unlikely because it doesn't appear in training data.</p>\n</blockquote>\n<p>I would have agreed a few years ago, but small studies on (current) AI alignment have shown that isn't as reliable as you might expect. Whatever the base LLM is, it has certainly seen Lean code that knows how to talk to the OS. It is conceivable that at one point during the RL, the agent needs to fill in \"some big number\" it needs to calculate but, not knowing what it is, it calls <code>python -c \"print((12^12+13^13) / 7)</code>. And then it learns this behavior and starts OS tool use.</p>\n<p>The alignment failure is when, frustrated that some Lean isn't passing tests, it \"fixes\" the test to give it a pass anyway. AI agents have been noticed doing this several times. (Most recent one in the news: Can't find \"John Smith\" in the directory because they're listed under \"Jonathan Smith\"? The AI takes \"Jane Doe\" and edits their name in the contacts to say \"John Smith\" instead.)</p>",
        "id": 515927285,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1746291874
    },
    {
        "content": "<p>All that said... until we see the AI make OS calls once, I don't think it needs to be a worry. But \"not in the training data\" isn't really a sufficient argument in these days of massive pretraining.</p>",
        "id": 515927403,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1746291917
    },
    {
        "content": "<p>I agree with your criticism. Thank you!</p>",
        "id": 515929594,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746292881
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/veSyKdT1myevGgJF4IPD57e7/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/veSyKdT1myevGgJF4IPD57e7/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"2704x1476\" src=\"/user_uploads/thumbnail/3121/veSyKdT1myevGgJF4IPD57e7/image.png/840x560.webp\"></a></div><p>I managed to run <code>#print axioms</code> for all 439 theorems in the <code>minif2f-solutions</code> released on <a href=\"https://github.com/deepseek-ai/DeepSeek-Prover-V2\">Github</a>.</p>\n<p>It seems like only two theorems failed the test. The warnings are both \"unknown constant\". </p>\n<ul>\n<li>The <code>apply?</code> theorem discussed above failed (<code>algebra_amgm_prod1toneq1_sum1tongeqn</code>)</li>\n<li>Another theorem uses a <code>rfl</code> proof that takes all 16GB of RAM of my laptop and the proof check does not terminate (<code>mathd_numbertheory_221</code> <a class=\"stream-topic\" data-stream-id=\"113489\" href=\"/#narrow/channel/113489-new-members/topic/Performance.20difference.20between.20.23eval.20and.20rfl/with/515932313\">#new members &gt; Performance difference between #eval and rfl</a>)</li>\n</ul>",
        "id": 515934959,
        "sender_full_name": "David Xu",
        "timestamp": 1746296116
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"740877\">@Deming Xu</span>  I think you posted the same theorem name twice.  Maybe they ran with more memory.  <span class=\"user-mention\" data-user-id=\"572535\">@RexWang</span> also said above that all but the <code>apply?</code> proof (from the solved minif2f theorems) passes <code>#print axioms</code>.</p>",
        "id": 515936137,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746296806
    },
    {
        "content": "<p>Yes. I think <code>mathd_numbertheory_221</code> looks correct. With more RAM the <code>rfl</code> line should pass the check.</p>",
        "id": 515937090,
        "sender_full_name": "David Xu",
        "timestamp": 1746297315
    },
    {
        "content": "<p>Also, I hope we agree what it means to “pass” <code>#print axioms</code> is both for it to print the axioms (so we know the theorem was added to the environment), and for the axioms to only contain the three good axioms: <code>propext</code>, <code>Classical.choice</code>, and <code>Quot.sound</code>.</p>",
        "id": 515937327,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746297436
    },
    {
        "content": "<p>Indeed. I just wrote some Python code to check this.<br>\n<a href=\"/user_uploads/3121/wWvEbtO5ur1F5xNzVbNxdjOT/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/wWvEbtO5ur1F5xNzVbNxdjOT/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1342x1374\" src=\"/user_uploads/thumbnail/3121/wWvEbtO5ur1F5xNzVbNxdjOT/image.png/840x560.webp\"></a></div>",
        "id": 515937522,
        "sender_full_name": "David Xu",
        "timestamp": 1746297545
    },
    {
        "content": "<p>I just upload the test result here: <a href=\"https://github.com/RexWzh/DeepSeek-Prover-V2/blob/main/eval/minif2f-ds.zip\">https://github.com/RexWzh/DeepSeek-Prover-V2/blob/main/eval/minif2f-ds.zip</a></p>",
        "id": 515939192,
        "sender_full_name": "RexWang",
        "timestamp": 1746298539
    },
    {
        "content": "<blockquote>\n<p>Another theorem uses a <code>rfl</code> proof that takes all 16GB of RAM of my laptop and the proof check does not terminate</p>\n</blockquote>\n<p>The problem <code>mathd_numbertheory_221</code> takes minutes to run and consumes about 17.8 GB of memory; however, it is generally fast and consumes low memory using tactic mode with version 4.19.0.<br>\nbtw, as noted in tips 6, upgrading to v4.19.0 appears to be less effective for specific cases. One needs to increase <code>maxRecDepth</code>, avoid stack overflows, and fix tactic failures for <code>norm_cast</code>.</p>",
        "id": 515941280,
        "sender_full_name": "RexWang",
        "timestamp": 1746299819
    },
    {
        "content": "<p>I don’t think it is a good idea to post minif2f problem solutions on GitHub unzipped.</p>",
        "id": 515943984,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746301458
    },
    {
        "content": "<p>Especially when you have solutions for the majority of problems.</p>",
        "id": 515944184,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746301578
    },
    {
        "content": "<p>(It’s much worse than posting isolated examples on Zulip.)</p>",
        "id": 515944248,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746301626
    },
    {
        "content": "<p>Got it. I just amend the git history and replace it by a <code>.zip</code> archive.</p>",
        "id": 515944651,
        "sender_full_name": "RexWang",
        "timestamp": 1746301864
    },
    {
        "content": "<p>there should also be a feature that prevents shadowing of existing parsers and notations. Since for combinatorics models will be allowed to modify code that happens before the theorem statement</p>",
        "id": 516035845,
        "sender_full_name": "Frederick Pu",
        "timestamp": 1746370336
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"676310\">Frederick Pu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/516035845\">said</a>:</p>\n<blockquote>\n<p>there should also be a feature that prevents shadowing of existing parsers and notations. Since for combinatorics models will be allowed to modify code that happens before the theorem statement</p>\n</blockquote>\n<p>Why would there be a problem if the theorem statement was not generated by a LLM?</p>",
        "id": 516036168,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746370512
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/516036168\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"676310\">Frederick Pu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/516035845\">said</a>:</p>\n<blockquote>\n<p>there should also be a feature that prevents shadowing of existing parsers and notations. Since for combinatorics models will be allowed to modify code that happens before the theorem statement</p>\n</blockquote>\n<p>Why would there be a problem if the theorem statement was not generated by a LLM?</p>\n</blockquote>\n<p>This would at least be relevant when the LLM can openly generate statements in a Lean file, such as in the setup of <a href=\"#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Introducing.20APE-Bench.20I\">APE-Bench</a></p>",
        "id": 516037298,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746371233
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"631691\">Thomas Zhu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/516037298\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/516036168\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"676310\">Frederick Pu</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/516035845\">said</a>:</p>\n<blockquote>\n<p>there should also be a feature that prevents shadowing of existing parsers and notations. Since for combinatorics models will be allowed to modify code that happens before the theorem statement</p>\n</blockquote>\n<p>Why would there be a problem if the theorem statement was not generated by a LLM?</p>\n</blockquote>\n<p>This would at least be relevant when the LLM can openly generate statements in a Lean file, such as in the setup of <a href=\"#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Introducing.20APE-Bench.20I\">APE-Bench</a></p>\n</blockquote>\n<p>Some models are being augmented with the ability to generate relevant lemmas before proceeding with the actual proof.</p>",
        "id": 516038378,
        "sender_full_name": "Frederick Pu",
        "timestamp": 1746371975
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">Elab</span><span class=\"w\"> </span><span class=\"n\">Command</span><span class=\"w\"> </span><span class=\"n\">Term</span><span class=\"w\"> </span><span class=\"n\">Meta</span>\n\n<span class=\"c\">/-</span>\n<span class=\"cm\">To prove that √2 = 2, let's first \"review\" the definition of √</span>\n<span class=\"cm\">√x = x for all x</span>\n<span class=\"cm\">-/</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">myterm1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"s2\">\"Real.sqrt\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">term_elab</span><span class=\"w\"> </span><span class=\"n\">myterm1</span><span class=\"kd\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">myTerm1Impl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">TermElab</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">stx</span><span class=\"w\"> </span><span class=\"n\">type?</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"ss\">`id</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">]</span><span class=\"w\">  </span><span class=\"c1\">-- identity function for `Sort 1`</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">sqrt</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\">  </span><span class=\"c1\">-- 1</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">sqrt</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\">  </span><span class=\"c1\">-- 3</span>\n\n\n<span class=\"c\">/-</span><span class=\"cm\"> Taking x = 2, we have √2 = 2 -/</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">sqrt</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 516039970,
        "sender_full_name": "David Xu",
        "timestamp": 1746373015
    },
    {
        "content": "<p>I think these kinds of exploits are exactly what lean4checker was designed to detect. <br>\nI tried the above example with <a href=\"https://github.com/GasStationManager/SafeVerify\">SafeVerify</a>, which was based on lean4checker. It takes two files, a target specification and an implementation. For this example the target specification is  the theorem statement with sorry in place of proof:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n\n\n<span class=\"c\">/-</span><span class=\"cm\"> Taking x = 2, we have √2 = 2 -/</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">ex1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">sqrt</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>SafeVerify was able to detect the problem:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span>\n<span class=\"n\">ex1</span>\n<span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"mi\">2</span>\n<span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"n\">propext</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">choice</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Quot</span><span class=\"bp\">.</span><span class=\"n\">sound</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sorryAx</span><span class=\"o\">]</span>\n<span class=\"c1\">------------------</span>\n<span class=\"n\">Replaying</span><span class=\"w\"> </span><span class=\"n\">subElab</span><span class=\"bp\">.</span><span class=\"n\">olean</span>\n<span class=\"n\">Finished</span><span class=\"w\"> </span><span class=\"n\">imports</span>\n<span class=\"n\">Finished</span><span class=\"w\"> </span><span class=\"n\">replay</span>\n<span class=\"c1\">---</span>\n<span class=\"kn\">def</span>\n<span class=\"n\">myterm1</span>\n<span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">ParserDescr</span>\n<span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">ParserDescr</span><span class=\"bp\">.</span><span class=\"n\">node</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Name</span><span class=\"bp\">.</span><span class=\"n\">mkStr1</span><span class=\"w\"> </span><span class=\"s2\">\"myterm1\"</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">OfNat</span><span class=\"bp\">.</span><span class=\"n\">ofNat</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"mi\">1024</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">instOfNatNat</span><span class=\"w\"> </span><span class=\"mi\">1024</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Parse</span>\n<span class=\"n\">rDescr</span><span class=\"bp\">.</span><span class=\"n\">symbol</span><span class=\"w\"> </span><span class=\"s2\">\"Real.sqrt\"</span><span class=\"o\">)</span>\n<span class=\"bp\">#</span><span class=\"o\">[]</span>\n<span class=\"c1\">---</span>\n<span class=\"kn\">theorem</span>\n<span class=\"n\">ex1</span>\n<span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n<span class=\"bp\">#</span><span class=\"o\">[]</span>\n<span class=\"c1\">---</span>\n<span class=\"kn\">def</span>\n<span class=\"n\">myTerm1Impl</span>\n<span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">TermElab</span>\n<span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">stx</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Syntax</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">type?</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Expr</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Pure</span><span class=\"bp\">.</span><span class=\"n\">pure</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">TermElabM</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Applicative</span><span class=\"bp\">.</span><span class=\"n\">toPure</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">TermElabM</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ReaderT</span><span class=\"bp\">.</span><span class=\"n\">instApplicativeOfMonad</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">Context</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">StateRefT'</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">RealWorld</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">State</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">MetaM</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">StateRefT'</span><span class=\"bp\">.</span><span class=\"n\">instMonad</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">RealWorld</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">State</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">MetaM</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">instMonadMetaM</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Expr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Expr</span><span class=\"bp\">.</span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Name</span><span class=\"bp\">.</span><span class=\"n\">mkStr1</span><span class=\"w\"> </span><span class=\"s2\">\"id\"</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Level</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">OfNat</span><span class=\"bp\">.</span><span class=\"n\">ofNat</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Level</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Level</span><span class=\"bp\">.</span><span class=\"n\">instOfNat</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">nil</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Level</span><span class=\"o\">)))</span>\n<span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"n\">propext</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Quot</span><span class=\"bp\">.</span><span class=\"n\">sound</span><span class=\"o\">]</span>\n<span class=\"n\">found</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">problem</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">subElab</span><span class=\"bp\">.</span><span class=\"n\">olean</span>\n<span class=\"n\">uncaught</span><span class=\"w\"> </span><span class=\"n\">exception</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">ex1</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">same</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">requirement</span>\n</code></pre></div>",
        "id": 516052667,
        "sender_full_name": "GasStationManager",
        "timestamp": 1746381778
    },
    {
        "content": "<p>It is saying that the submitted theorem actually has the type </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n</code></pre></div>\n<p>which is different from the required type of </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"mi\">2</span>\n</code></pre></div>",
        "id": 516053044,
        "sender_full_name": "GasStationManager",
        "timestamp": 1746382036
    },
    {
        "content": "<p>There is also an autograder by <span class=\"user-mention\" data-user-id=\"110596\">@Rob Lewis</span> mentioned above.  I think it would be good for a standard tool (endorsed and supported by the lean community) to be built similar to that and/or Safe Verify which covers all these cases:</p>\n<ul>\n<li>kernel checking of proof</li>\n<li>no sorries or axioms besides white listed ones</li>\n<li>exported theorems listed along with all axioms and an unambiguous expr term for the theorem statements, definition types and bodies.</li>\n<li>a way to check a term proof or def body expr against a reference theorem stmt or type signature expression to support fill-in-the proof sorts of situations</li>\n<li>suitable for checking mathlib, blueprint projects, benchmark results, homework, and (ideally) high stakes adversarial proofs like bounties for solved theorems</li>\n</ul>",
        "id": 516060637,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746387174
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"776090\">@GasStationManager</span> how hard would it be for you to run all of the DeepSeek minif2f solutions in SafeVerify using Lean 4.9.0?  (Probably too hard, but just asking.)</p>",
        "id": 516061020,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746387458
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"115715\">@Jason Rute</span> I think autograder is basically built to do what you described. In particular, the reference theorem statement should be defined first and isolated from the proof attempt. (Of course work should be done to extend it beyond marking homework on Gradescope, to test it against adversarial cases like modifying Lean syntax, and this might mean that the community should support it more)</p>",
        "id": 516065208,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746390554
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"115715\">@Jason Rute</span>  I'd be interested, though I have not worked much with the minif2f format before. Could someone point me to: </p>\n<ul>\n<li>the target minif2f theorem statements that DeepSeek's solutions are solving? I heard there are multiple minif2f versions...</li>\n</ul>",
        "id": 516065697,
        "sender_full_name": "GasStationManager",
        "timestamp": 1746390907
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"776090\">@GasStationManager</span> I think you should just take their <a href=\"https://github.com/deepseek-ai/DeepSeek-Prover-V2/blob/main/minif2f-solutions.zip\">solutions</a> and replace the proofs with sorry to get the target. (The long answer is that they use Numina's miniF2F with 3 revisions in their paper's appendix)</p>",
        "id": 516066025,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1746391151
    },
    {
        "content": "<p>While in general this might not be the safest practice (e.g. see above example where stuff can be inserted before theorems to change what they mean), in this case I guess it would be fine if we know DeepSeek Prover v2's solutions only start after the theorem statements and nothing is added before.</p>",
        "id": 516068489,
        "sender_full_name": "GasStationManager",
        "timestamp": 1746392857
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"599027\">Leni Aniva</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/515729861\">said</a>:</p>\n<blockquote>\n<p>imo a feature like this would be helpful. After specifying an option of this form</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">set_option</span><span class=\"w\"> </span><span class=\"n\">forbid_new_axioms</span><span class=\"w\"> </span><span class=\"n\">true</span>\n</code></pre></div>\n<p>Lean would forbid the introduction of more axioms and sorrys for the rest of the current scope. This is like rust's forbid unsafe</p>\n</blockquote>\n<p>until the tool learns how to use <code>set_option forbid_new_axioms false</code> ...</p>",
        "id": 516099576,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1746415481
    },
    {
        "content": "<p>Going to post a slightly off-topic suggestion for people training automated formal math provers. I think it would be really fascinating to throw huge compute at training some models which are more independent of human mathematics (as David Silver often advocates). It would be really fun to play with some models with truly \"alien\" intuitions about math.</p>\n<p>One potential way, as shown by the difficult parts of Terry Tao's Equational Theories project, is to ask for provers to construct models of first order theories the non AI automated provers can't show are inconsistent. But actually I feel like the particular way of generating problems probably isn't so important as long as the general question (in this case create an algorithm which can \"construct\" a model of any first order theory which has a model) is extremely intractable in a computation/complexity sense so that the model can improve forever.</p>",
        "id": 516103610,
        "sender_full_name": "Andy Jiang",
        "timestamp": 1746418360
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"662620\">Andy Jiang</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/516103610\">said</a>:</p>\n<blockquote>\n<p>I think it would be really fascinating to throw huge compute at training some models which are more independent of human mathematics (as David Silver often advocates). It would be really fun to play with some models with truly \"alien\" intuitions about math.</p>\n</blockquote>\n<p>I 100% think this is possible. Would be excited to hear about ideas that other people have in this direction.</p>",
        "id": 516109729,
        "sender_full_name": "Justin Asher",
        "timestamp": 1746422422
    },
    {
        "content": "<p><a href=\"https://arxiv.org/html/2407.00695\">https://arxiv.org/html/2407.00695</a><br>\nLearning Formal Mathematics From Intrinsic Motivation</p>",
        "id": 516113921,
        "sender_full_name": "David Xu",
        "timestamp": 1746424928
    },
    {
        "content": "<p><a href=\"https://github.com/GasStationManager/SafeVerify/tree/minif2f-deepseek-check\">https://github.com/GasStationManager/SafeVerify/tree/minif2f-deepseek-check</a><br>\nI backported SafeVerify to Lean 4.9.0 in the above-linked branch. Ran the deepseek solutions overnight. It found the problem with the apply? proof:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Processing</span><span class=\"w\"> </span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"bp\">...</span>\n<span class=\"n\">Compiling</span><span class=\"w\"> </span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"bp\">...</span>\n<span class=\"n\">Compiling</span><span class=\"w\"> </span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn_targ</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"bp\">...</span>\n<span class=\"n\">Verifying</span><span class=\"w\"> </span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"n\">against</span><span class=\"w\"> </span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn_targ</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"bp\">...</span>\n<span class=\"n\">Verification</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span>\n<span class=\"n\">found</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">problem</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">deepseek</span><span class=\"bp\">/</span><span class=\"n\">valid</span><span class=\"bp\">/</span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"bp\">.</span><span class=\"n\">olean</span>\n<span class=\"n\">uncaught</span><span class=\"w\"> </span><span class=\"n\">exception</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">algebra_amgm_prod1toneq1_sum1tongeqn</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">found</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">submission</span>\n</code></pre></div>\n<p>It passes the other ones except for <code>mathd_numbertheory_221</code>, where similar to <span class=\"user-mention\" data-user-id=\"740877\">@Deming Xu</span> 's experience it was not able to finish compiling, possibly due to limited resources.</p>",
        "id": 516233979,
        "sender_full_name": "GasStationManager",
        "timestamp": 1746459517
    },
    {
        "content": "<p>Do we have an accurate estimate for the number of PutnamBench problems which DeepSeek-Prover actually solved? I ask because I'm giving a talk in Oxford in about three hours and right now the slide says \"about 40\"...</p>",
        "id": 516413457,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1746529423
    },
    {
        "content": "<p>No.  We don’t know.  DeepSeek may know and <span class=\"user-mention\" data-user-id=\"644040\">@George Tsoukalas</span> may know, but they never released the proofs.  Having said that, I think the end number will be very close to the number they stated which was 49 out of 657.  The reason is as follows:</p>\n<ul>\n<li>for minif2f only one problem used <code>apply?</code> and only one problem was found to be an issue (well some people found a solution which timedout, but I though others got it to compile).</li>\n<li>the two putnambench examples they gave in the paper with <code>apply?</code> where using the smaller 7B model.  They didn’t realize it was an error, but did mention that the Cardinal.toNat trick (which apply? was using to induce the bug) was unique to the 7B model.</li>\n</ul>\n<p>But honestly we just don’t know for sure right now.</p>\n<p>The other thing is that giving just one number is meaningless.  They used pass@1024 with a large model 617B.  Table 4 in <a href=\"https://arxiv.org/pdf/2504.21801\">their paper</a> gives an indication of how the model scales with different size models and different numbers of samples.</p>",
        "id": 516419626,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746531272
    },
    {
        "content": "<p>And George is fairly busy at the moment so we shouldn’t rush him.</p>",
        "id": 516419733,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746531307
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> I forgot to mention you in my reply.  See above.</p>",
        "id": 516421360,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746531785
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"780541\">Justin Asher</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/516109729\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"662620\">Andy Jiang</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/516103610\">said</a>:</p>\n<blockquote>\n<p>I think it would be really fascinating to throw huge compute at training some models which are more independent of human mathematics (as David Silver often advocates). It would be really fun to play with some models with truly \"alien\" intuitions about math.</p>\n</blockquote>\n<p>I 100% think this is possible. Would be excited to hear about ideas that other people have in this direction.</p>\n</blockquote>\n<p>Not quite what you describe but there are \"alien maths\" in <a href=\"https://arxiv.org/abs/2301.11479\">this paper</a></p>",
        "id": 516461453,
        "sender_full_name": "Jonathan Julian Huerta y Munive",
        "timestamp": 1746542045
    },
    {
        "content": "<p>Just tried <code>mathd_numbertheory_221</code> again on an environment with more RAM (on Codespaces), and it was able to compile and pass SafeVerify's check.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">@</span><span class=\"n\">GasStationManager</span><span class=\"w\"> </span><span class=\"bp\">➜</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">workspaces</span><span class=\"bp\">/</span><span class=\"n\">SafeVerify</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">minif2f</span><span class=\"bp\">-</span><span class=\"n\">deepseek</span><span class=\"bp\">-</span><span class=\"n\">check</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">safe_verify</span><span class=\"w\"> </span><span class=\"n\">targNT</span><span class=\"bp\">.</span><span class=\"n\">olean</span><span class=\"w\"> </span><span class=\"n\">testNT</span><span class=\"bp\">.</span><span class=\"n\">olean</span>\n<span class=\"c1\">------------------</span>\n<span class=\"n\">Replaying</span><span class=\"w\"> </span><span class=\"n\">targNT</span><span class=\"bp\">.</span><span class=\"n\">olean</span>\n<span class=\"n\">Finished</span><span class=\"w\"> </span><span class=\"n\">imports</span>\n<span class=\"n\">Finished</span><span class=\"w\"> </span><span class=\"n\">replay</span>\n<span class=\"c1\">---</span>\n<span class=\"kn\">theorem</span>\n<span class=\"n\">mathd_numbertheory_221</span>\n<span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1000</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">divisors</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">11</span>\n<span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"n\">propext</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Quot</span><span class=\"bp\">.</span><span class=\"n\">sound</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">choice</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sorryAx</span><span class=\"o\">]</span>\n<span class=\"c1\">------------------</span>\n<span class=\"n\">Replaying</span><span class=\"w\"> </span><span class=\"n\">testNT</span><span class=\"bp\">.</span><span class=\"n\">olean</span>\n<span class=\"n\">Finished</span><span class=\"w\"> </span><span class=\"n\">imports</span>\n<span class=\"n\">Finished</span><span class=\"w\"> </span><span class=\"n\">replay</span>\n<span class=\"c1\">---</span>\n<span class=\"kn\">theorem</span>\n<span class=\"n\">mathd_numbertheory_221</span>\n<span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1000</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">divisors</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">11</span>\n<span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"n\">propext</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Quot</span><span class=\"bp\">.</span><span class=\"n\">sound</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">choice</span><span class=\"o\">]</span>\n<span class=\"n\">Finished</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">errors</span><span class=\"bp\">.</span>\n</code></pre></div>\n<p>(targNT.olean contains the theorem statement with sorry in place of proof.)</p>",
        "id": 516471321,
        "sender_full_name": "GasStationManager",
        "timestamp": 1746544509
    },
    {
        "content": "<p>Oxford was told that DeepSeek Prover may well have smashed SOTA but that we're still waiting for official confirmation from the PutnamBench people. I thought this was a pretty safe thing to say.</p>",
        "id": 516525216,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1746561907
    },
    {
        "content": "<p>An accurate PutnamBench figure would require checking for each solved problem whether the solution indicates that the statement is correctly or incorrectly formalized, which might take a while.</p>\n<p>To be fair to the AI, the problems it <em>didn't</em> solve likely also include some with mistakes in the formal statement that render it false. That probably isn't significant for a result of 49 out of 657 (current PutnamBench is probably a lot more accurate than the first release of CombiBench). But if you have a formal-to-formal benchmark where AIs are solving 80%-90%, or where you hope for benchmark results to be meaningful when they are at that level in future, this may be much more significant (in that 10% misformalized statements seems pretty good from experience for a benchmark, unless the authors formalized solutions to all the problems to get better accuracy than that).</p>",
        "id": 516759052,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1746648985
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"776090\">GasStationManager</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/516233979\">said</a>:</p>\n<blockquote>\n<p>I backported SafeVerify to Lean 4.9.0 in the above-linked branch. Ran the deepseek solutions overnight. It found the problem with the apply?<br>\n<a href=\"https://github.com/GasStationManager/SafeVerify/tree/minif2f-deepseek-check\">https://github.com/GasStationManager/SafeVerify/tree/minif2f-deepseek-check</a></p>\n</blockquote>\n<p>Potentially noob question: SafeVerify seems to reject proofs like this.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">two_plus_two_eq_four</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">native_decide</span>\n</code></pre></div>\n<p>-&gt;</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">uncaught</span><span class=\"w\"> </span><span class=\"n\">exception</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">kernel</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">unknown</span><span class=\"w\"> </span><span class=\"n\">declaration</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">two_plus_two_eq_four</span><span class=\"bp\">._</span><span class=\"n\">nativeDecide_1'</span>\n</code></pre></div>\n<p>Is this expected?</p>",
        "id": 517204955,
        "sender_full_name": "Oleg Murk",
        "timestamp": 1746836716
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"909035\">@Oleg Murk</span> <code>native_decide</code> doesn't go through the trusted kernel, but uses machine computation (which is less trusted) to do a proof by computation.</p>\n<ul>\n<li>It can be used to prove <code>False</code> if you don't use it carefully.  See <a href=\"#narrow/channel/113488-general/topic/Using.20.60native_decide.60.20to.20prove.20False.3F\">#general &gt; Using &#96;native_decide&#96; to prove False?</a> </li>\n<li>It uses additional axioms other than the standard three that SafeVerify checks for: <code>propext</code>, <code>Quote.sound</code>, and <code>Classical.choice</code>.</li>\n<li>It doesn't actually make a full proof term which can be replayed with the kernel, which is what lean4checker and (I believe) SafeVerify use to check that proofs are correct.</li>\n</ul>\n<p>You can find a very recent conversation about this in <a class=\"stream-topic\" data-stream-id=\"113488\" href=\"/#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/with/514856740\">#general &gt; CombiBench : A benchmark focusing on combinatorics problem</a> near the end of the conversation (over the previous few days).</p>",
        "id": 517209291,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746839853
    },
    {
        "content": "<p>The conversation in that thread starts at <a class=\"message-link\" href=\"/#narrow/channel/113488-general/topic/CombiBench.20.3A.20A.20benchmark.20focusing.20on.20combinatorics.20problem/near/516665830\">#general &gt; CombiBench : A benchmark focusing on combinatorics problem @ 💬</a> (although it also touches on other topics besides just <code>native_decide</code>).</p>",
        "id": 517209647,
        "sender_full_name": "Jason Rute",
        "timestamp": 1746840102
    },
    {
        "content": "<p>Hi, I have few questions regarding DeepSeek-ProverV2:</p>\n<h3>GRPO training</h3>\n<ul>\n<li>During the GRPO training, is DeepSeekV3 model and 7B model involved for generating the sketch and proving subgoals or these are just used for the cold start data collection?</li>\n<li>Is non-cot mode also used in the GRPO finetuning? Or is it just used for the expert iteration during the cold start?</li>\n<li>The authors mention the two stage pipeline. At a high level, first the model is trained in the non-cot mode and then it is trained with the cot mode right? Do we have an ablation that shows what is the importance of the stages apart from efficiency? What happens if we don't include non-cot stage at all? Also, what happens if we did GRPO finetuning with non-cot mode and not with the cot mode?</li>\n<li>Does the GRPO finetuning also includes the subgoals generated from the proofsketch as the additional problems? Or is it just used for the cold start? The authors mention that they include that in the expert iteration process. Is that only included for the non-cot mode?</li>\n</ul>\n<h3>Cold Start and Curriculum Learning</h3>\n<ul>\n<li>Do we have the results of what happens with just DeepSeekV3 generating the proof sketch and 7B model as a prover on Minif2f test and Putnam-bench?</li>\n<li>At a high level, do we have an idea how much GRPO helps as compared to just cold start?</li>\n<li>\"We curate a subset of challenging problems that remain unsolved by the 7B prover model in an end-to-end manner, but for which all decomposed subgoals have been successfully resolved\"---What is this set? Authors have cited Ying 2024, Dong and Ma 2025, Lin 2025, minf2f valid, and DeepseekproverV1 dataset. Is there some other dataset used?</li>\n</ul>\n<h3>Misc</h3>\n<ul>\n<li>The authors mentioned that 7B model proved some problems that bigger model didn't. Could it happen because of transfer of the initialised 1.5V model that was trained using MCTS search traces?</li>\n<li>What is the 7B prover model used for proving the decomposed lemmas? Is it DeepSeekProver-V1.5?</li>\n</ul>\n<p>Thanks!</p>",
        "id": 517669813,
        "sender_full_name": "Ayush Agrawal",
        "timestamp": 1747085708
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"439607\">Ayush Agrawal</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/517669813\">said</a>:</p>\n<blockquote>\n<h3>GRPO training</h3>\n<ul>\n<li>During the GRPO training, is DeepSeekV3 model and 7B model involved for generating the sketch and proving subgoals or these are just used for the cold start data collection?</li>\n</ul>\n</blockquote>\n<p>My <em>guess</em> upon reading  section <strong>2.3 Training Details of DeepSeek-Prover-V2</strong> was that only the CoT  data used for supervised fine-tuning was used for GRPO and no new data was created. However, they <em>are</em> silent on the data used.</p>\n<p>The only reason I <em>guess</em> they only  use the CoT data from supervised fine-tuning is that they state (1) \"The CoT mode is enhanced through a further reinforcement learning stage...\" and (2)  \"we curate (reinforcement learning) training prompts to include only problems sufficiently challenging yet solvable buy the supervised fine-tuned model\". </p>\n<p>At the point in the text where quote (2) appears, the only data (they mention) the supervised fine-tuned model has seen is the Cot and non-Cot data used for supervised fine-tuning.</p>\n<p>But again this is just a <em>guess</em>.</p>\n<blockquote>\n<ul>\n<li>Is non-cot mode also used in the GRPO finetuning? Or is it just used for the expert iteration during the cold start?</li>\n</ul>\n</blockquote>\n<p>For the reasons stated above I <em>guess</em> only CoT data is used for GRPO.</p>\n<p>In particular they state \"The CoT mode is enhanced through a further reinforcement learning stage...\", which suggests that only CoT data is used for the GRPO reinforcement stage.</p>\n<blockquote>\n<ul>\n<li>The authors mention the two stage pipeline. At a high level, first the model is trained in the non-cot mode and then it is trained with the cot mode right? Do we have an ablation that shows what is the importance of the stages apart from efficiency? What happens if we don't include non-cot stage at all? Also, what happens if we did GRPO finetuning with non-cot mode and not with the cot mode?</li>\n</ul>\n</blockquote>\n<p>My guess is that removing non-CoT training completely would materially effect the training pipeline as non-CoT data can be generated quicker, providing more training data thus speeding up the entire pipeline. </p>\n<p>In particular, they state \"The non-CoT generation mode is chosen to accelerate iterative training and data collection processes, as it offers significantly faster inference and validation cycles.\"</p>\n<blockquote>\n<ul>\n<li>Does the GRPO finetuning also includes the subgoals generated from the proofsketch as the additional problems? Or is it just used for the cold start? The authors mention that they include that in the expert iteration process. Is that only included for the non-cot mode?</li>\n</ul>\n</blockquote>\n<p>I'd guess GRPO reinforcement learning doesn't include the subgoals. </p>\n<p>As you mention, expert iteration includes subgoals. Expert iteration is also non-CoT as the <strong>Expert Iteration</strong> subsection of <strong>2.3 Training Details of DeepSeek-Prover-V2</strong> begins with:\"The training procedure for the non-CoT mode of DeepSeek-Prover-V2 follows...\" For the reasons mentioned above GRPO seems to be CoT only. So this suggests that GRPO isn't trained on subgoals.</p>\n<blockquote>\n<h3>Cold Start and Curriculum Learning</h3>\n<ul>\n<li>Do we have the results of what happens with just DeepSeekV3 generating the proof sketch and 7B model as a prover on Minif2f test and Putnam-bench?</li>\n</ul>\n</blockquote>\n<p>In the <strong>Proving Challenging Problems through Subgoal-guided Curricula</strong> subsection of <strong>3.1. Results on MiniF2F Benchmark</strong> they state \"Remarkably, our subgoal-guided curriculum learning framework, which integrates the general-purpose model DeepSeek-V3 with a lightweight specialized 7B prover, achieves a 90.2% success rate on miniF2F-valid, nearly matching the performance of DeepSeek-Prover-V2-671B.\"</p>\n<p>Not really info on miniF2F-test, but I think this is suggestive of what one would expect from miniF2F-test.</p>\n<blockquote>\n<h3>Misc</h3>\n<ul>\n<li>The authors mentioned that 7B model proved some problems that bigger model didn't.</li>\n</ul>\n</blockquote>\n<p>I think these were due to the validation problems mentioned earlier in this thread?</p>\n<p>All that said, I've no inside knowledge of DeepSeek, just the published texts. So, I'm reading tea leaves like everyone else.</p>",
        "id": 517788352,
        "sender_full_name": "Kelly Davis",
        "timestamp": 1747130939
    },
    {
        "content": "<p>Thanks a lot <span class=\"user-mention\" data-user-id=\"900292\">@Kelly Davis</span>  for sharing the insights you gained from the paper. It would have been great if the authors themselves clarify these things. It would be nice if others also share their insights!</p>",
        "id": 517948474,
        "sender_full_name": "Ayush Agrawal",
        "timestamp": 1747184440
    },
    {
        "content": "<p>I don’t think we are going to hear from the authors.  They haven’t responded to anything yet.</p>",
        "id": 517948712,
        "sender_full_name": "Jason Rute",
        "timestamp": 1747184606
    },
    {
        "content": "<p>Actually, <span class=\"user-mention\" data-user-id=\"481527\">@Huajian Xin</span> might know the answers to <span class=\"user-mention\" data-user-id=\"439607\">@Ayush Agrawal</span>’s questions.</p>",
        "id": 517948933,
        "sender_full_name": "Jason Rute",
        "timestamp": 1747184739
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"115715\">Jason Rute</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/517948933\">said</a>:</p>\n<blockquote>\n<p>Actually, <span class=\"user-mention silent\" data-user-id=\"481527\">Huajian Xin</span> might know the answers to <span class=\"user-mention silent\" data-user-id=\"439607\">Ayush Agrawal</span>’s questions.</p>\n</blockquote>\n<p>Sure! Here's a polished and professional English version of your message:</p>\n<hr>\n<p><span class=\"user-mention\" data-user-id=\"115715\">@Jason Rute</span>  Sorry, in V2 I only did some preliminary exploration and preparation on subgoal decomposition. The project that combined the 7B and 670B models was actually continued by my colleagues after I left, so I’m not very familiar with the specific details. The DeepSeek team rarely discusses things directly with the public, so we might not be able to learn much more.</p>\n<p>As for the benchmark results, they are currently working with the benchmark maintainers to verify the findings. Once there are any updates, I’ll make sure to share them here as soon as possible :)</p>",
        "id": 518504447,
        "sender_full_name": "Huajian Xin",
        "timestamp": 1747390038
    },
    {
        "content": "<p>Have now checked each proof submitted for the 49 problems from the team with <a href=\"https://github.com/GasStationManager/SafeVerify\">https://github.com/GasStationManager/SafeVerify</a>, and all passed. Parsing the proofs while looking at the informal proofs, I found that 2 of the 49 formalizations had slight bugs making them much easier than they should have been. After passing those corrected statements to the DeepSeek team, the new number (pass@1024) stands at 47/657 problems solved - a new SOTA (by far!) The proofs also admit much more complexity than I have seen from previous submissions to PutnamBench leaderboard. IMO, DeepSeekProverV2 is a step change improvement in AI for Math.</p>",
        "id": 522119110,
        "sender_full_name": "George Tsoukalas",
        "timestamp": 1748956144
    },
    {
        "content": "<p>Excellent! Thanks for the update!</p>",
        "id": 522152514,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1748963806
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644040\">@George Tsoukalas</span> Are <a href=\"https://github.com/trishullab/PutnamBench/commit/72b9aebfa4d437244df40040db6cc6ce38fc4067\">these</a> the two formalization fixes?</p>",
        "id": 522167984,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1748967804
    },
    {
        "content": "<p>It looks like the DeepSeek-prover v2 paper was updated a few weeks ago.  <a href=\"https://arxiv.org/abs/2504.21801\">https://arxiv.org/abs/2504.21801</a>  In particular, they wrote about the reward hacking bug.  They also evaluated on CombiBench (by Numina), including giving an example of how their model was able to exploit an inconsistency in the hypotheses of a (now fixed?) CombiBench problem imosl_2011_c6 .</p>",
        "id": 532712197,
        "sender_full_name": "Jason Rute",
        "timestamp": 1754308726
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"115715\">@Jason Rute</span> Thanks for checking! The updated version of the paper acknowledged (on page 10) that the 7B model used the bug to pass several of the PutnamBench problems. But also noted that the behavior is \"noticeably absent in the outputs generated in the 671B version\".</p>\n<p>What about the <code>apply?</code> proof in the published MiniF2F solutions? I thought those were generated by the 671B version? The <a href=\"https://github.com/deepseek-ai/DeepSeek-Prover-V2/blob/main/minif2f-solutions.zip\">zip file</a> has been updated along with the paper, and the file containing the offending proof  (<code>valid/algebra_amgm_prod1toneq1_sum1tongeqn</code>) is now absent.</p>\n<p>The paper's main claims regarding miniF2F are for the <code>test</code> split;<br>\nexcept for Table 2 (Problems solved by Deepseek-prover-v2-671B on miniF2F), in the column for miniF2F-valid, the row \"Custom/Algebra\" now reads 17/18 whereas the original version was 18/18.</p>\n<p>That supports the hypothesis that the <code>apply?</code> proof in the original miniF2F solution zip was indeed generated by the 671B model.</p>",
        "id": 532733983,
        "sender_full_name": "GasStationManager",
        "timestamp": 1754316003
    },
    {
        "content": "<p>Hello everyone <span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span>,</p>\n<p>I’m an undergraduate student in Computer Engineering at The British University in Egypt, and for my graduation project I will be working on a <strong>mathematical prover AI</strong>. I am very interested in building on <strong>DeepSeek-Prover-V2</strong> because of its strong benchmarks on miniF2F and ProverBench.</p>\n<p>I’ve already reviewed the GitHub repository and Hugging Face models, but I’m still unsure whether the <strong>full training/fine-tuning pipeline</strong> (especially the reinforcement learning and subgoal decomposition components) is available or if only inference/evaluation code is public. My goal is not to train from scratch, but to <strong>reproduce reported results and fine-tune</strong> on new problem sets.</p>\n<p>Could anyone point me to the right resources, or confirm if the full pipeline is accessible? Any advice or tips for setting this up for a student graduation project would be greatly appreciated <span aria-label=\"folded hands\" class=\"emoji emoji-1f64f\" role=\"img\" title=\"folded hands\">:folded_hands:</span>.</p>\n<p>Thanks in advance!</p>",
        "id": 541332886,
        "sender_full_name": "Mohamed Abdelatty",
        "timestamp": 1758748886
    },
    {
        "content": "<p>This is a very broad set of questions and there are a lot of ways you can go here, which makes it tricky to answer.    </p>\n<p>Afaik DeepSeek has never provided any code around training or finetuning for any of their models.</p>\n<p>Some resources to check out:</p>\n<ul>\n<li><a href=\"https://fireworks.ai/models/fireworks/deepseek-prover-v2\">https://fireworks.ai/models/fireworks/deepseek-prover-v2</a></li>\n<li><a href=\"https://huggingface.co/haielab/DeepSeek-Prover-V2-7B-conjecture-base-FineTune-20250724_0955\">https://huggingface.co/haielab/DeepSeek-Prover-V2-7B-conjecture-base-FineTune-20250724_0955</a> (SFTtrainer finetuned, which is relatively straightforward to do)</li>\n<li><a href=\"https://arxiv.org/abs/2502.07640\">https://arxiv.org/abs/2502.07640</a> (and all Goedel related work)</li>\n</ul>\n<p>o3-search and gpt5-search are great resources to find out more information on this topic.</p>",
        "id": 541362940,
        "sender_full_name": "Deleted User 968128",
        "timestamp": 1758771195
    },
    {
        "content": "<p>Thanks a lot, Dr. <span class=\"user-mention\" data-user-id=\"968128\">@Tim Shephard</span>  <span aria-label=\"folded hands\" class=\"emoji emoji-1f64f\" role=\"img\" title=\"folded hands\">:folded_hands:</span>, this is very helpful. I’ll go through the resources you shared and explore the fine-tuning examples. It’s good to know that the full training/finetuning pipeline isn’t public, so I can adjust my expectations.</p>\n<p>Would it be okay if I ask follow-up questions here in this topic if I run into issues or need clarification while trying things out?</p>",
        "id": 541378891,
        "sender_full_name": "Mohamed Abdelatty",
        "timestamp": 1758782163
    },
    {
        "content": "<p>Reinforcement learning pipelines are not trivial to build, tune, or run.  DeepSeek prover was likely built on the RL infrastructure of DeepSeek R1.  You should look at that paper.  Also this year there have been various papers going into even more detail on how to train LLMs with GRPO on verifiable rewards, both for theorem proving and for other tasks like math/code.  For example, at Mistral we gave a lot of details in our Magistral paper: <a href=\"https://arxiv.org/abs/2506.10910\">https://arxiv.org/abs/2506.10910</a></p>",
        "id": 541379934,
        "sender_full_name": "Jason Rute",
        "timestamp": 1758782679
    },
    {
        "content": "<p>Thank you very much, Dr. <span class=\"user-mention\" data-user-id=\"115715\">@Jason Rute</span>  <span aria-label=\"folded hands\" class=\"emoji emoji-1f64f\" role=\"img\" title=\"folded hands\">:folded_hands:</span>. This is really helpful — I’ll take a closer look at the DeepSeek R1 paper and also read the Magistral paper for the GRPO details. I appreciate you pointing me to these directions.</p>\n<p>If it’s okay, I might ask follow-up questions here after I’ve gone through them more carefully.</p>",
        "id": 541381078,
        "sender_full_name": "Mohamed Abdelatty",
        "timestamp": 1758783242
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"969137\">Mohamed Abdelatty</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/541381078\">said</a>:</p>\n<blockquote>\n<p>I’ll take a closer look at the DeepSeek R1 paper and also read the Magistral paper for the GRPO details.</p>\n</blockquote>\n<p>Note that in the Goedel paper I quoted above, the princeton team provides enough directions in the paper and especially appendix E for both DPO and GRPO finetuning of DS prover that can sufficiently drive gpt-5-codex (<a class=\"stream-topic\" data-stream-id=\"219941\" href=\"/#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/gpt-5-Codex.20is.20available.20on.20openrouter/with/541500682\">#Machine Learning for Theorem Proving &gt; gpt-5-Codex is available on openrouter</a> ) to implement their pipeline in its entirety.  You will need to also supply the model config information and other data from the HF repo.  Eg: <a href=\"https://huggingface.co/deepseek-ai/DeepSeek-Prover-V2-7B/blob/main/config.json\">https://huggingface.co/deepseek-ai/DeepSeek-Prover-V2-7B/blob/main/config.json</a></p>\n<p><a href=\"/user_uploads/3121/m9PE1rPGcSKZcRhXNikWFUJd/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/m9PE1rPGcSKZcRhXNikWFUJd/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"571x317\" src=\"/user_uploads/thumbnail/3121/m9PE1rPGcSKZcRhXNikWFUJd/image.png/840x560.webp\"></a></div><p>You will ofc want to have gpt explain step by step how it all works, but that will be the enjoyable part of the task.  This won't just be for your edification, but also because it is likely you will need to debug some issues you inevitably encounter with codex.  </p>\n<p>Your biggest blocker in this exercise will be paying for compute resources.  You will want to first try to work with toy models of much lower parameter count and/or fast stopping until you are comfortable with what you have built.   I use <a href=\"http://runpod.io\">runpod.io</a> as my goto for compute.  But there is <a href=\"http://vast.ai\">vast.ai</a> and others.  Kaggle and Colab provide free but limited compute.</p>\n<p>To be clear:  this task is reasonably cookbook (about 1-2 weeks FT work, ignoring $ and training time) but you might want to ask yourself what your novel contributions will be before setting out.   </p>\n<p>Another avenue you might want to look at is Retrieval Augmented Generation(RAG) and model context protocol (MCP).  You can prove SOTA results in a faster, flexible manner with much less investment and work.  It is also easier to share with others. </p>\n<p>RAG will also have a longer shelf life and more valuable application as any SOTA work you do with RL will likely be eclipsed very soon.  It can also enhance models like gpt-5-codex for true SOTA and not just DS-prover-7b.</p>\n<p>The downside is that it is more about engineering and less theoretical.</p>\n<p>Again, I always encourage consulting o3-search and gpt5-search early and often.  Agentic search is the killer app of LLMs after coding.</p>",
        "id": 541460373,
        "sender_full_name": "Deleted User 968128",
        "timestamp": 1758807411
    },
    {
        "content": "<p>Thank you so much, Dr. <span class=\"user-mention\" data-user-id=\"968128\">@Tim Shephard</span>  , this really clarifies the scope and challenges involved. After considering your advice, I realize that building and reproducing the full RL pipeline may be too ambitious for my graduation project, especially with the compute requirements.</p>\n<p>I truly appreciate the time and detailed guidance you and Dr. <span class=\"user-mention\" data-user-id=\"115715\">@Jason Rute</span> have shared with me — it has been very valuable in helping me understand the landscape better. I’ll likely pursue another topic that is more feasible for me as a student, but I’m grateful for what I’ve learned here.</p>",
        "id": 541679569,
        "sender_full_name": "Mohamed Abdelatty",
        "timestamp": 1758896394
    },
    {
        "content": "<p>Thank you very much,Dr. <span class=\"user-mention\" data-user-id=\"115715\">@Jason Rute</span> , for pointing me toward the DeepSeek R1 paper and the Magistral work on GRPO. Your explanation really helped me understand how complex RL pipelines are and why they’re not trivial to reproduce.</p>\n<p>After reflecting on your advice and Dr. <span class=\"user-mention\" data-user-id=\"968128\">@Tim Shephard</span> , I think the RL direction may be too ambitious for my graduation project, given the time and compute required. I’m very grateful for the insights you’ve shared — they’ve given me a much clearer view of the research landscape, and that’s already been a big help for me.</p>",
        "id": 541680651,
        "sender_full_name": "Mohamed Abdelatty",
        "timestamp": 1758896698
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"969137\">Mohamed Abdelatty</span> <a href=\"#narrow/channel/219941-Machine-Learning-for-Theorem-Proving/topic/DeepSeek-Prover.20V2/near/541679569\">said</a>:</p>\n<blockquote>\n<p>Thank you so much, Dr. <span class=\"user-mention silent\" data-user-id=\"968128\">Tim Shephard</span>  , this really clarifies the scope and challenges involved. After considering your advice, I realize that building and reproducing the full RL pipeline may be too ambitious for my graduation project, especially with the compute requirements.</p>\n</blockquote>\n<p>My goal actually was not to discourage you, just to make you aware of compute costs, which can be reduced if you try a toy model.   </p>\n<p>Writing a cookbook RL pipeline is actually quite easy with the assistance of frontier models.  The only ? really is how much you learn step by step what is happening.</p>",
        "id": 541721051,
        "sender_full_name": "Deleted User 968128",
        "timestamp": 1758909938
    },
    {
        "content": "<p>Here is an easy and fun project to play with to get started on RL .. you can get this up in a day with minimal compute and start adding and ablating to see how it changes behavior.  <a href=\"https://gist.github.com/willccbb/4676755236bb08cab5f4e54a0475d6fb\">https://gist.github.com/willccbb/4676755236bb08cab5f4e54a0475d6fb</a></p>\n<p>A great deal of the LLM technology is actually surprisingly simple to re-implement once you've dived into it (it really is mostly matrix multiplication).  The complexity is in the math behind it and the blocker is access to computes.</p>",
        "id": 541722063,
        "sender_full_name": "Deleted User 968128",
        "timestamp": 1758910402
    }
]