[
    {
        "content": "<p>Introducing InternLM-Step-Prover and Lean-Github. A state-of-the-art math prover with LEAN 4 and obtain SOTA on MiniF2F, Proofnet, and Putnam benchmarks. Our model solved 3 IMO problems in MiniF2F, and one problem had never been solved by LEAN before (IMO1983P6).</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/fhrBNga5WYENntjQq5DbxP9s/ReProver.png\"><img src=\"/user_uploads/thumbnail/3121/fhrBNga5WYENntjQq5DbxP9s/ReProver.png/840x560.webp\"></a></div><p>Here is how our model proved IMO and how we collect our training dataset Lean-Github:<br>\n<a href=\"/user_uploads/3121/AOBIbrT3s7hq1xwx4T9e3QT9/147-Repos.png\">/user_uploads/3121/AOBIbrT3s7hq1xwx4T9e3QT9/147-Repos.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/AOBIbrT3s7hq1xwx4T9e3QT9/147-Repos.png\"><img src=\"/user_uploads/thumbnail/3121/AOBIbrT3s7hq1xwx4T9e3QT9/147-Repos.png/840x560.webp\"></a></div><p>We open source our model and our training dataset here. </p>\n<p><span aria-label=\"place holder\" class=\"emoji emoji-1f4d1\" role=\"img\" title=\"place holder\">:place_holder:</span>Arxiv:<a href=\"https://arxiv.org/abs/2407.17227\">https://arxiv.org/abs/2407.17227</a><br>\n<span aria-label=\"hug\" class=\"emoji emoji-1f917\" role=\"img\" title=\"hug\">:hug:</span>Model:<a href=\"https://huggingface.co/internlm/internlm2-step-prover\">https://huggingface.co/internlm/internlm2-step-prover</a><br>\n<span aria-label=\"bar chart\" class=\"emoji emoji-1f4ca\" role=\"img\" title=\"bar chart\">:bar_chart:</span>Dataset: <a href=\"https://huggingface.co/datasets/internlm/Lean-Github\">https://huggingface.co/datasets/internlm/Lean-Github</a><br>\n<span aria-label=\"computer\" class=\"emoji emoji-1f4bb\" role=\"img\" title=\"computer\">:computer:</span>Github: <a href=\"https://github.com/InternLM/InternLM-Math\">https://github.com/InternLM/InternLM-Math</a></p>",
        "id": 453829990,
        "sender_full_name": "InternLM-Math",
        "timestamp": 1721872959
    },
    {
        "content": "<p>Could you post the IMO1983P6 statement and (found) proof?</p>",
        "id": 453844764,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1721879035
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/InternLM-Step-Prover.20and.20Lean-Github/near/453844764\">said</a>:</p>\n<blockquote>\n<p>Could you post the IMO1983P6 statement and (found) proof?</p>\n</blockquote>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">imo_1983_p6</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h₀</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">h₃</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">+</span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"bp\">-</span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">ring_nf</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₄</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">+</span><span class=\"n\">b</span><span class=\"bp\">+</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">linarith</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">add_assoc</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₅</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"bp\">-</span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"bp\">+</span><span class=\"n\">b</span><span class=\"bp\">-</span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">nlinarith</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₆</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"bp\">-</span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"bp\">+</span><span class=\"n\">c</span><span class=\"bp\">-</span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">nlinarith</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h₇</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"bp\">-</span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"bp\">+</span><span class=\"n\">c</span><span class=\"bp\">-</span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">nlinarith</span>\n<span class=\"w\">    </span><span class=\"n\">nlinarith</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h₀</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₀</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₀</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₁</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₃</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₄</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₅</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₆</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h₇</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 453844996,
        "sender_full_name": "InternLM-Math",
        "timestamp": 1721879224
    },
    {
        "content": "<p>Interesting. The first three lines of the proof don't actually contribute anything. I wonder where it \"gets the idea\" for the next three haves.</p>",
        "id": 453845306,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1721879507
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/InternLM-Step-Prover.20and.20Lean-Github/near/453845306\">said</a>:</p>\n<blockquote>\n<p>Interesting. The first three lines of the proof don't actually contribute anything. I wonder where it \"gets the idea\" for the next three haves.</p>\n</blockquote>\n<p>We also have no idea how it guess these haves. <span aria-label=\"rolling on the floor laughing\" class=\"emoji emoji-1f923\" role=\"img\" title=\"rolling on the floor laughing\">:rolling_on_the_floor_laughing:</span> We are training on Github-Lean and expert iteration on massive olympic-level problems. It may learn during this process.</p>",
        "id": 453845527,
        "sender_full_name": "InternLM-Math",
        "timestamp": 1721879693
    },
    {
        "content": "<p>Without <code>h₄</code>, the proof actually is <del>three times</del> a bit faster. Maybe <code>nlinarith</code> is slowed down by the presence of the unnecessary fact in the context... (EDIT: One has to remove <code>h₄</code> from the list in the last <code>nlinarith</code>.)</p>",
        "id": 453923554,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1721907059
    },
    {
        "content": "<p>According to <a href=\"https://huggingface.co/datasets/internlm/Lean-Github/viewer/default/train?q=compfiles\">https://huggingface.co/datasets/internlm/Lean-Github/viewer/default/train?q=compfiles</a>, <span class=\"user-mention\" data-user-id=\"243791\">@David Renshaw</span>'s \"Compfiles\" is in the dataset, which probably has overlap with minif2f. Did you filter this from the data you actually used when training your model?</p>",
        "id": 453925260,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1721907809
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479359\">Michael Stoll</span> <a href=\"#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/InternLM-Step-Prover.20and.20Lean-Github/near/453923554\">said</a>:</p>\n<blockquote>\n<p>Without <code>h₄</code>, the proof actually is <del>three times</del> a bit faster. Maybe <code>nlinarith</code> is slowed down by the presence of the unnecessary fact in the context... (EDIT: One has to remove <code>h₄</code> from the list in the last <code>nlinarith</code>.)</p>\n</blockquote>\n<p>We paste the exact proof our model found. We found many of our proof contain redundant steps.</p>",
        "id": 453962111,
        "sender_full_name": "InternLM-Math",
        "timestamp": 1721916942
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/InternLM-Step-Prover.20and.20Lean-Github/near/453925260\">said</a>:</p>\n<blockquote>\n<p>According to <a href=\"https://huggingface.co/datasets/internlm/Lean-Github/viewer/default/train?q=compfiles\">https://huggingface.co/datasets/internlm/Lean-Github/viewer/default/train?q=compfiles</a>, <span class=\"user-mention silent\" data-user-id=\"243791\">David Renshaw</span>'s \"Compfiles\" is in the dataset, which probably has overlap with minif2f. Did you filter this from the data you actually used when training your model?</p>\n</blockquote>\n<p>Imo1983p6 is not solved by compfiles (<a href=\"https://github.com/dwrensha/compfiles/blob/main/Compfiles/Imo1983P6.lean\">https://github.com/dwrensha/compfiles/blob/main/Compfiles/Imo1983P6.lean</a>). We do not remove compfiles in our training, since olympic level math solutions are so scarce and it contains many useful lemmas. Putnam Benchmark and Imo1983P6 have no chance of leaking.</p>",
        "id": 453962554,
        "sender_full_name": "InternLM-Math",
        "timestamp": 1721917035
    }
]