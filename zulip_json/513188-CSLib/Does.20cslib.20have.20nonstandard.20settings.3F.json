[
    {
        "content": "<p>While working on a branch in cslib:<br>\n<a href=\"https://github.com/ctchou/cslib/commits/nat-segment/\">https://github.com/ctchou/cslib/commits/nat-segment/</a><br>\nI got two kinds of warnings that I had never seen when working on my own automata theory project, whose only dependency is mathlib.  One type of warnings is this:<br>\n<a class=\"stream-topic\" data-stream-id=\"113489\" href=\"/#narrow/channel/113489-new-members/topic/What.20does.20this.20warning.20mean.3F/with/544467039\">#new members &gt; What does this warning mean?</a> <br>\nThe other is that when I don't want to deal with decidability issues, I used to just put <code>open Classical</code> at the beginning of a file.  But now when I do that while working in cslib, I got the following warning:</p>\n<blockquote>\n<p>please avoid 'open (scoped) Classical' statements: this can hide theorem statements which would be better stated with explicit decidability statements.<br>\nInstead, use <code>open Classical in</code> for definitions or instances, the <code>classical</code> tactic for proofs.<br>\nFor theorem statements, either add missing decidability assumptions or use <code>open Classical in</code>.<br>\nNote: This linter can be disabled with <code>set_option linter.style.openClassical false</code></p>\n</blockquote>\n<p>Is there a setting specific to cslib that triggered this?</p>",
        "id": 544467326,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1760337102
    },
    {
        "content": "<p>We include in our lakefile (and check in CI) <code>linter.mathlibStandardSet</code>, which includes this linter.</p>",
        "id": 544468893,
        "sender_full_name": "Chris Henson",
        "timestamp": 1760337746
    },
    {
        "content": "<p>I see.  I just want to use classical logic and not think about \"decidability\" issues at all.  What is the correct way to express my intent?  Now I precede each offending definition or theorem with <code>open Classical in</code>.  Is there a way for me to say: \"I just want to use classical logic in this whole file\"?</p>",
        "id": 544469716,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1760338056
    },
    {
        "content": "<p>I think it's not recommended to do so? The definitions need <code>open Classical</code>, but for the theorems you should be able to write it differently. It looks like you just want to decide if something is in a range, right? So I think you could have a local classical instance and be fine. I can look in the morning.</p>",
        "id": 544475227,
        "sender_full_name": "Chris Henson",
        "timestamp": 1760339991
    },
    {
        "content": "<p>Thanks in advance!  I'd appreciate any suggestions.  The relevant code is in the last 2 commits of:<br>\n<a href=\"https://github.com/ctchou/cslib/commits/nat-segment/\">https://github.com/ctchou/cslib/commits/nat-segment/</a></p>",
        "id": 544480084,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1760341428
    },
    {
        "content": "<p><code>open Classical in </code> is indeed better practice</p>",
        "id": 544500199,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1760347004
    },
    {
        "content": "<p>In fact, in general it's best to write</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">segment'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">count</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">count</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>\n<p>to make clear that the scope is used only for the implementation not the signature</p>",
        "id": 544500373,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1760347071
    },
    {
        "content": "<p>Though isn't this just <code>Nat.count (· ∈ range φ) (k + 1) - 1</code>?</p>",
        "id": 544500626,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1760347152
    },
    {
        "content": "<p>Alas, you are right.  I even proved a version of this myself.  I'll switch to this better definition (which, to be sure, still needs <code>open scoped Classical in</code>).</p>",
        "id": 544602338,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1760378952
    }
]