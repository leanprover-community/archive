[
    {
        "content": "<p>I have opened <a href=\"https://github.com/leanprover/cslib/pull/243\">cslib#243</a> moving CSLib to the module system. I mostly followed Mathlib's example of using <code>@[expose] public section</code> which seemed straightforward for a first pass, but would welcome a second look from someone with more experience with modules.</p>",
        "id": 566165897,
        "sender_full_name": "Chris Henson",
        "timestamp": 1767462893
    },
    {
        "content": "<p>I haven't looked at the code in detail, but from your description it sounds good to me</p>",
        "id": 566172406,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1767470301
    },
    {
        "content": "<p>Is there a tutorial on the new module system?  As usual, the Lean language reference is not the easiest thing to read.</p>",
        "id": 566180292,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1767477685
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"929508\">@Fabrizio Montesi</span> They are not hard to fix, but every PR that lands before this accumulates merge conflicts, so it would be nice to prioritize this for review.</p>",
        "id": 567584753,
        "sender_full_name": "Chris Henson",
        "timestamp": 1768235557
    },
    {
        "content": "<p>(I would also like to make sure there's at least one day of nightly testing with this before the release that includes this PR to keep that process smooth)</p>",
        "id": 567585098,
        "sender_full_name": "Chris Henson",
        "timestamp": 1768235632
    },
    {
        "content": "<p>I agree with Chris that we should get this over with ASAP.  It impacts all outstanding and future PRs.</p>",
        "id": 567593149,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1768237461
    },
    {
        "content": "<p>good point, done</p>",
        "id": 567593564,
        "sender_full_name": "Fabrizio Montesi",
        "timestamp": 1768237561
    },
    {
        "content": "<p>Great, thank you! I will follow up soon with a PR re-enabling the new module aware <code>shake</code> and splitting out some meta code into new files. (I felt it was simpler to split this out than try doing everything at once)</p>",
        "id": 567599167,
        "sender_full_name": "Chris Henson",
        "timestamp": 1768238936
    },
    {
        "content": "<p>As a practical matter, for contributors any PRs in progress should merge <code>main</code> and in any new files you likely want to follow the pattern of files beginning with</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">module</span>\n\n<span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">expose</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">section</span>\n</code></pre></div>\n<p>As we use the module system further, we will refine what needs to be public and/or exposed.</p>",
        "id": 567599327,
        "sender_full_name": "Chris Henson",
        "timestamp": 1768238971
    },
    {
        "content": "<p>Also, this gave a nice performance boost!</p>\n<p><span class=\"user-mention silent\" data-user-id=\"992983\">radar</span> <a href=\"#narrow/channel/116290-rss/topic/Significant.20commits.20to.20cslib/near/567599121\">said</a>:</p>\n<blockquote>\n<p><strong><a href=\"https://radar.lean-lang.org/repos/cslib/commits/d61818c32e06ed6746664bb7d4f4acdba56371ed\">feat: move to the module system (</a><a href=\"https://github.com/leanprover/cslib/pull/243\">cslib#243</a><a href=\"https://radar.lean-lang.org/repos/cslib/commits/d61818c32e06ed6746664bb7d4f4acdba56371ed\">)</a></strong><br>\n<strong>Large changes</strong> (1<span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span>)</p>\n<ul>\n<li><span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span> <code>build//instructions</code>: <strong>-94.8G</strong> (<strong>-5.2%</strong>)</li>\n</ul>\n</blockquote>",
        "id": 567599647,
        "sender_full_name": "Chris Henson",
        "timestamp": 1768239052
    },
    {
        "content": "<p>It seems that <code>lake exe mk_all</code> still generates the old formats for <code>Cslib.lean</code> and <code>CslibTests.lean</code>.</p>",
        "id": 567612260,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1768242269
    },
    {
        "content": "<p>You have to add a <code>--module</code> option now.</p>",
        "id": 567612362,
        "sender_full_name": "Chris Henson",
        "timestamp": 1768242298
    },
    {
        "content": "<p>I see. Thanks!</p>",
        "id": 567612751,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1768242405
    }
]