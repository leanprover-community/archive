[
    {
        "content": "<p>Hi, in view of <a href=\"https://github.com/leanprover-community/mathlib4/pull/31247\">mathlib#31247</a>, the closure theorems of regular languages under complement, union, and intersection will appear in mathlib soon and their names will conflict with our versions of the same results in:<br>\n<a href=\"https://github.com/leanprover/cslib/blob/main/Cslib/Computability/Languages/RegularLanguage.lean\">https://github.com/leanprover/cslib/blob/main/Cslib/Computability/Languages/RegularLanguage.lean</a><br>\nI'm wondering what we should do.  I can think of two options:<br>\n(1) Delete our versions of those results when we start using the version of mathlib containing those results.<br>\n(2) Keep our versions of those results but rename them (say, with a prime) to avoid conflicts and add a comment to point out that the same results also appear in mathlib.<br>\nPersonally I prefer (2) because I think the proofs using our definitions of DFA are of independent interest.  What do you think?<br>\nI should point out that <a href=\"https://github.com/leanprover-community/mathlib4/pull/31247\">mathlib#31247</a> does not contain the indexed union and intersection versions of those results.</p>",
        "id": 562830169,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1765326341
    },
    {
        "content": "<p>I think those results are better placed in CSLib</p>",
        "id": 562834073,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1765328295
    },
    {
        "content": "<p>Namespacing will take care of these conflicts for the most part.</p>",
        "id": 562834197,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1765328364
    },
    {
        "content": "<p>Cslib does not make its own version of a mathematical notion if it already exists in mathlib (except when the notion is a primary object of interest to cslib, such as automata).  Since mathlib already has the notions of <code>Language</code> and <code>Language.IsRegular</code>, cslib inherits them from mathlib and only adds new definitions and theorems about them that are not (yet) in mathlib.  Previously (for example) the theorem <code>Language.IsRegular.compl</code> was not in mathlib, but it is now.  So the options are either (1) delete <code>Language.IsRegular.compl</code> from cslib or (2) rename it to something else.  Wrapping <code>Language.IsRegular.compl</code> in the <code>Cslib</code> namespace is just one way of doing the renaming.</p>",
        "id": 562837813,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1765330353
    },
    {
        "content": "<p>If the statements are identical then you should always just delete the cslib one</p>",
        "id": 562838281,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1765330593
    },
    {
        "content": "<p>If the statements are different in a trivial way, you should align them (either by PRing to mathlib, or by adapting CSLib) then delete the cslib one.</p>",
        "id": 562838358,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1765330630
    },
    {
        "content": "<p>If they are different in a non-trivial way (i.e. different definitions of NFAs) then you should try to rename one or both to avoid ambiguity</p>",
        "id": 562838397,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1765330652
    },
    {
        "content": "<p>Which case is this?</p>",
        "id": 562838405,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1765330654
    },
    {
        "content": "<p>Yes, exactly what Eric says in general. In either case, can you make a PR to the <code>nightly-testing</code> branch with the required changes? I think the failure there is because of this.</p>",
        "id": 562839065,
        "sender_full_name": "Chris Henson",
        "timestamp": 1765330989
    },
    {
        "content": "<p>It looks like the only one I can see causing trouble is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Language.isRegular_iff#doc\">docs#Language.isRegular_iff</a>, which mentions a mathlib DFA on the RHS. I think if cslib wants the same notion for its own dfa, then <code>Language.isRegular_iff_cslibDFA</code> is reasonable enough as a new name</p>",
        "id": 562839210,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1765331064
    },
    {
        "content": "<p>The mathlib one could quite reasonable rename to <code>isRegular_iff_dfa</code></p>",
        "id": 562839342,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1765331130
    },
    {
        "content": "<p>Our now-duplicate <code>Language.mem_inf</code> is the failure in CI.</p>",
        "id": 562840186,
        "sender_full_name": "Chris Henson",
        "timestamp": 1765331607
    },
    {
        "content": "<p>I assume it falls into the first case? (<a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Language.mem_inf#doc\">docs#Language.mem_inf</a>)</p>",
        "id": 562840606,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1765331829
    },
    {
        "content": "<p>They are exactly the same semantically, but one is proved using mathlib's definition of DFA and the other using cslib's definition of DA (which doesn't include the accepting states).  Let me do this:<br>\n(1) I'll make a PR to rename the relevant theorems with comments saying that they will be removed after a future mathlib bump in cslib.  This should fix the <code>nightly-testing</code> failures.<br>\n(2) After the mathlib bump, I'll do another PR to remove the theorems.</p>",
        "id": 562840625,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1765331839
    },
    {
        "content": "<p>As far as Lean is concerned, two theorems are identical if they have the same statement. Generally mathlib doesn't keep around multiple ways to prove the same thing.</p>",
        "id": 562840725,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1765331893
    },
    {
        "content": "<p>I assume you're not talking about <code>mem_inf</code> which is proved by <code>Set.mem_inter_iff</code></p>",
        "id": 562840774,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1765331920
    },
    {
        "content": "<p>If theorems are to be removed on bumping Mathlib, it is preferable to make just a single PR to the <code>nightly-testing</code> branch.</p>",
        "id": 562840906,
        "sender_full_name": "Chris Henson",
        "timestamp": 1765331981
    },
    {
        "content": "<p>I was talking about <code>Language.IsRegular.{compl,add,inf}</code>.</p>",
        "id": 562840956,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1765332005
    },
    {
        "content": "<p>Never mind.  I realized I was being stupid.  I'll make a PR for the nightly-testing branch.</p>",
        "id": 562841149,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1765332090
    },
    {
        "content": "<p>Okay, thanks! I might have normally taken care of this already, but was busy with travel. Your thinking ahead is appreciated.</p>",
        "id": 562841832,
        "sender_full_name": "Chris Henson",
        "timestamp": 1765332393
    },
    {
        "content": "<p>I'll do it tomorrow.  Too late today.</p>",
        "id": 562842179,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1765332563
    },
    {
        "content": "<p>PR: <a href=\"https://github.com/leanprover/cslib/pull/209\">cslib#209</a></p>",
        "id": 563068665,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1765404173
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110637\">@Ching-Tsun Chou</span>, could you please run <code>lake exe shake --fix</code> on your PR?</p>",
        "id": 563078082,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1765408690
    },
    {
        "content": "<p>Thanks for pointing it out.  I've just pushed a fix.</p>",
        "id": 563079020,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1765409205
    },
    {
        "content": "<p>8 messages were moved from this topic to <a class=\"stream-topic\" data-stream-id=\"113488\" href=\"/#narrow/channel/113488-general/topic/Using.20shake.20in.20new.20projects/with/564155030\">#general &gt; Using shake in new projects</a> by <span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span>.</p>",
        "id": 564155031,
        "sender_full_name": "Notification Bot",
        "timestamp": 1765931638
    },
    {
        "content": "<p>Another “excuse” to redo these results is to also give bounds on the (DFA) state complexity of the various constructions.<br>\nI believe that tight bounds are known for all Boolean operations.</p>",
        "id": 572310467,
        "sender_full_name": "Yuval Filmus",
        "timestamp": 1770363607
    },
    {
        "content": "<p>The current proofs in cslib should allow such bounds to be proven.  But some literature search will be required to come up with specific automata that achieve those bounds.</p>",
        "id": 572452017,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1770406763
    }
]