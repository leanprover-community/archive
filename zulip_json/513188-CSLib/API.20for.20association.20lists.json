[
    {
        "content": "<p>I would like to encourage a common interface for typing contexts as association lists. As I use this more heavily in my upcoming PR for locally nameless System F, I'd like some advice on what existing infrastructure to use and upstreaming helpful API. I see three places with existing work:</p>\n<ul>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.lookup#doc\">docs#List.lookup</a> for product types with <code>BEq</code> keys.</li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Data/List/Sigma.html\">Mathlib.Data.List.Sigma</a> for dependent pairs with <code>DecidableEq</code> keys.</li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/Std/Data/Internal/List/Associative.html\">Std.Data.Internal.List.Associative</a> for dependent pairs with <code>BEq</code> keys.</li>\n</ul>\n<p>I have avoided <code>Std.Data.Internal.List</code> because of its nature as an implementation detail for hash maps, though it does have some nice API that feels awkward to duplicate elsewhere. Currently we are using <code>Mathlib.Data.List.Sigma</code>, as it also has some helpful definitions about non-duplicated keys. Does this sound like the right approach? If so, I can upsteam some additional lemmas and <code>grind</code> annotations that have been useful.</p>\n<p>I also had the thought that it would be nice to have scoped <code>GetElem</code> and <code>GetElem?</code> instances for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.dlookup#doc\">docs#List.dlookup</a>, but I guess this is problematic when dealing with keys that are natural numbers.</p>",
        "id": 537253643,
        "sender_full_name": "Chris Henson",
        "timestamp": 1756808352
    },
    {
        "content": "<p>there is also <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.AssocList#doc\">docs#Lean.AssocList</a> but that seems to be very similar to <code>List.lookup</code>'s functionality.</p>",
        "id": 537279870,
        "sender_full_name": "Julia Scheaffer",
        "timestamp": 1756817648
    },
    {
        "content": "<p>I would encourage improving the API of <code>Mathlib.Data.List.Sigma</code> for now, and then if someone (e.g. the FRO in Std, or a separate library) wants to build out a non-Mathlib associative list API we can at very least use that API there as reference.</p>\n<p>It doesn't seem unreasonable to me to ask that <code>Std.Data.Internal.List</code> eventually becomes public, but it won't happen right away.</p>",
        "id": 537413898,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1756883581
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"687698\">@Chris Henson</span>, I wonder also if you might be interested in simply using <code>ExtTreeMap</code> rather than an association list.</p>",
        "id": 537415443,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1756884236
    },
    {
        "content": "<p>Okay, I will continue with <code>Mathlib.Data.List.Sigma</code> (and consider <code>ExtTreeMap</code>). After cleaning things up a bit, I got a lot of mileage out of adding <code>grind</code> to existing API there plus just a few additional lemmas. <a href=\"https://github.com/chenson2018/cslib/blob/lc-fsub-reorg/Cslib/Languages/LambdaCalculus/LocallyNameless/Context.lean\">WIP here</a> for anyone curious.</p>",
        "id": 537463083,
        "sender_full_name": "Chris Henson",
        "timestamp": 1756901966
    },
    {
        "content": "<p>Excited to see a Mathlib PR with grind annotations for <code>List.Sigma</code>. :-)</p>",
        "id": 537584240,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1756957070
    },
    {
        "content": "<p>I have opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/30313\">#30313</a> with some initial <code>grind</code> annotations and a few small lemmas.</p>",
        "id": 543632642,
        "sender_full_name": "Chris Henson",
        "timestamp": 1759876856
    }
]