[
    {
        "content": "<p>I think something  in <code>Cslib.Automata</code> is interfering with <code>Sum</code>.  For example, if a file contains only the following code:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Sum</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">inl</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">inr</span>\n</code></pre></div>\n<p>then everything works fine.  However, if I put the above code in the <code>Cslib.Automata</code> namespace as follows:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Cslib</span><span class=\"bp\">.</span><span class=\"n\">Computability</span><span class=\"bp\">.</span><span class=\"n\">Automata</span><span class=\"bp\">.</span><span class=\"n\">NA</span>\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Cslib</span><span class=\"bp\">.</span><span class=\"n\">Automata</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Sum</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">inl</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">inr</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Cslib</span><span class=\"bp\">.</span><span class=\"n\">Automata</span>\n</code></pre></div>\n<p>then Lean claims that <code>inl</code> and <code>inr</code> are \"unknown identifiers\" and I have to use <code>Sum.inl</code> and <code>Sum.inr</code> to get them.  I think something imported by <code>Cslib.Computability.Automata.NA</code> is interfering with <code>Sum</code>.  (The problem disappears if the <code>import</code> is removed.)  I see that there are <code>LTS.inl</code> and <code>LTS.inr</code> in <code>Cslib.Foundations.Semantics.LTS.Basic</code>.  But the code above did not open <code>LTS</code>.  Any idea what's going on?</p>",
        "id": 556644495,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1763251294
    },
    {
        "content": "<p>Hmm, I don't immediately understand why, but if you move <code>open Sum</code> to be first you no longer get an error.</p>",
        "id": 556650851,
        "sender_full_name": "Chris Henson",
        "timestamp": 1763260121
    },
    {
        "content": "<p>Thanks for the idea!  I encountered the problem while working on this branch:<br>\n<a href=\"https://github.com/ctchou/cslib/tree/na-sum-work\">https://github.com/ctchou/cslib/tree/na-sum-work</a><br>\nIn the file <code>Cslib/Computability/Automata/Sum.lean</code>, if you move the <code>open Sum</code> to inside <code>namespace Cslib.Automata</code>, then the definition of <code>sum</code> fails (because Lean says <code>inl</code> and <code>inr</code> are undefined) but the theorem statement of <code>sum_run_iff</code> works.  However, while working on its proof, I found that the <code>inl</code> and <code>inr</code> in the theorem statement seem to be resolved into something different from <code>Sum.inl</code> and <code>Sum.inr</code>.</p>",
        "id": 556652455,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1763262384
    },
    {
        "content": "<p>In the branch, I'm working inside the namespace <code>Cslib.Automata.NA</code>, which extends <code>LTS</code>, which has methods <code>LTS.inl</code> and <code>LTS.inr</code>.  Perhaps this has something to do with the problem?  But the code example I gave above does not open <code>NA</code>, so presumably the methods of <code>LTS</code> are not exposed and should not cause any problem.</p>",
        "id": 556652691,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1763262735
    },
    {
        "content": "<p>Mmmh that's the only possible reason I can think of, yes..</p>\n<p>Note that, as I noted in the docstring, the 'union' section for LTS is still under active development. If it causes trouble, we can just put it in a separate file for now. I guess it might be convenient to have union/product/intersection operations for (F)LTSs for automata theory though, but we don't need to do that now.</p>",
        "id": 556801602,
        "sender_full_name": "Fabrizio Montesi",
        "timestamp": 1763377895
    },
    {
        "content": "<p>I think this is a red herring. Just the <code>Cslib</code> namespace like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Cslib</span>\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Cslib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Sum</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">inl</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">inr</span>\n</code></pre></div>\n<p>also fails, even if I completely remove <code>LTS.{inl,inr}</code>.</p>",
        "id": 556849994,
        "sender_full_name": "Chris Henson",
        "timestamp": 1763390942
    },
    {
        "content": "<p>I would guess that somewhere there is a <code>Cslib.Sum</code> namespace</p>",
        "id": 556851979,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1763391313
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/513188-CSLib/topic/Something.20in.20Cslib.2EAutomata.20is.20interfering.20with.20Sum/near/556851979\">said</a>:</p>\n<blockquote>\n<p>I would guess that somewhere there is a <code>Cslib.Sum</code> namespace</p>\n</blockquote>\n<p>Ahh that's it, thanks! There are functions that should be in the <code>Sum</code> namespace, but were accidentally declared as <code>Sum.{...}</code> at the root of the <code>Cslib</code> namespace. I'll PR a fix.</p>",
        "id": 556854366,
        "sender_full_name": "Chris Henson",
        "timestamp": 1763391798
    },
    {
        "content": "<p>Ah yes, I can imagine which they are now. Thanks for digging. <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>\n<p>(Maybe the names of some of these functions need updating as well, iirc.)</p>",
        "id": 556855086,
        "sender_full_name": "Fabrizio Montesi",
        "timestamp": 1763391944
    },
    {
        "content": "<p>Actually they can be removed completely, as they are the same as <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Sum.isLeft_inl#doc\">docs#Sum.isLeft_inl</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Sum.isRight_inr#doc\">docs#Sum.isRight_inr</a>.</p>",
        "id": 556856199,
        "sender_full_name": "Chris Henson",
        "timestamp": 1763392186
    },
    {
        "content": "<p>Even better!</p>",
        "id": 556856319,
        "sender_full_name": "Fabrizio Montesi",
        "timestamp": 1763392214
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/cslib/pull/162\">cslib#162</a></p>",
        "id": 556869164,
        "sender_full_name": "Chris Henson",
        "timestamp": 1763395121
    }
]