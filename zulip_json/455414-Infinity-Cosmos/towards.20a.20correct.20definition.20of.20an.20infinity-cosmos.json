[
    {
        "content": "<p>Over the summer <span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> and I sketched a definition of an infinity cosmos that cut several corners (principally around simplicially enriched limits) and left open a few sorries. Thanks to the collective efforts of this group, they have now almost all been resolved.</p>\n<p>The <a href=\"https://github.com/emilyriehl/infinity-cosmos/pull/39\">draft PR</a> contains two versions of the definition for comparison and commentary and one sorry, which I'll now describe.</p>",
        "id": 481824767,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731366137
    },
    {
        "content": "<p>In the code below <code>exact this</code> fails because two instances do not agree:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimplicialCategory</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span>\n\n\n<span class=\"sd\">/-- A `PreInfinityCosmos` is a simplicially enriched category whose hom-spaces are quasi-categories</span>\n<span class=\"sd\">and whose morphisms come equipped with a special class of isofibrations.-/</span>\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">PreInfinityCosmos</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">SimplicialCategory</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">has_qcat_homs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"n\">SSet</span><span class=\"bp\">.</span><span class=\"n\">Quasicategory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">EnrichedCategory</span><span class=\"bp\">.</span><span class=\"n\">Hom</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)]</span>\n<span class=\"w\">  </span><span class=\"n\">IsIsoFibration</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MorphismProperty</span><span class=\"w\"> </span><span class=\"n\">K</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">InfinityCosmos</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">][</span><span class=\"n\">SimplicialCategory</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">PreInfinityCosmos</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">PreInfinityCosmos</span>\n\n<span class=\"sd\">/-- Common notation for the hom-spaces in a pre-∞-cosmos.-/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">QCat</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">EnrichedCategory</span><span class=\"bp\">.</span><span class=\"n\">Hom</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span>\n<span class=\"w\">  </span><span class=\"n\">property</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PreInfinityCosmos</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">infer_instance</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"bp\">.</span><span class=\"n\">has_qcat_homs</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"c1\">-- exact this</span>\n<span class=\"w\">    </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">this</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>One of them is a metavariable I believe(?); I don't really know what this means.</p>\n<p>The other is something called <code>toSimplicialCategory</code>. I have no idea what this is and couldn't find it by searching.</p>",
        "id": 481825026,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731366272
    },
    {
        "content": "<p>Instances are the bane of my existence, so help would be very welcome.</p>",
        "id": 481825112,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731366316
    },
    {
        "content": "<p>I didn't have permission to push to your branch,  but I closed the sorry in <a href=\"https://github.com/emilyriehl/infinity-cosmos/pull/40\">https://github.com/emilyriehl/infinity-cosmos/pull/40</a> </p>\n<p>The issue was that you had instance variables <code>[SimplicialCategory K]</code> and <code>[PreInfinityCosmos K]</code>. So Lean was confused by the fact that you had a random simplicial category structure on <code>K</code>, and the simplicial category structure coming from the pre-infinity-cosmos structure. The solution was to just remove the <code>[SimplicialCategory K]</code> variable</p>",
        "id": 481897003,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731402382
    },
    {
        "content": "<p>Feel free to just copy my code over to your branch and close my PR so you can keep working on this</p>",
        "id": 481897918,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731402701
    },
    {
        "content": "<p>I've added the instances that make <code>section tests</code> compile (with a sorry)</p>",
        "id": 481905154,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731405007
    },
    {
        "content": "<p>I figured out how to make a PR to your PR instead: <a href=\"https://github.com/emilyriehl/infinity-cosmos/pull/41\">https://github.com/emilyriehl/infinity-cosmos/pull/41</a></p>",
        "id": 481926578,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731411693
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"519559\">Dagur Asgeirsson</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/towards.20a.20correct.20definition.20of.20an.20infinity-cosmos/near/481897003\">said</a>:</p>\n<blockquote>\n<p>The issue was that you had instance variables <code>[SimplicialCategory K]</code> and <code>[PreInfinityCosmos K]</code>. So Lean was confused by the fact that you had a random simplicial category structure on <code>K</code>, and the simplicial category structure coming from the pre-infinity-cosmos structure. The solution was to just remove the <code>[SimplicialCategory K]</code> variable</p>\n</blockquote>\n<p>I see the issue I didn't understand before. When a class extends another class you should only assume an instance of the largest class. </p>\n<p>I had somehow thought that for extensions Lean would unify the instances (because I thought <code>[Category K] [SimplicialCategory K]</code> was an example of this). But <code>SimplicialCategory</code> does not extend <code>Category</code>.</p>",
        "id": 481981375,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731426765
    },
    {
        "content": "<p>Can you explain the code</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">attribute</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"kn\">instance</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">has_terminal</span><span class=\"w\"> </span><span class=\"n\">has_products</span>\n</code></pre></div>\n<p>I don't know quite what this does or  when to use it.</p>",
        "id": 481981530,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731426806
    },
    {
        "content": "<p>One additional note about this PR:</p>\n<p>There is one further modification we will definitely make either pre or post merge, which is to use the general enriched category theory of cotensors developed by <span class=\"user-mention\" data-user-id=\"761171\">@Daniel Carranza</span>  in place of the stubby material which is currently in the simplicial category cotensors file.</p>",
        "id": 481996147,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731431070
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246635\">Emily Riehl</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/towards.20a.20correct.20definition.20of.20an.20infinity-cosmos/near/481981530\">said</a>:</p>\n<blockquote>\n<p>Can you explain the code</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">attribute</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"kn\">instance</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">has_terminal</span><span class=\"w\"> </span><span class=\"n\">has_products</span>\n</code></pre></div>\n<p>I don't know quite what this does or  when to use it.</p>\n</blockquote>\n<p>What it's doing is making the fields <code>has_terminal</code> and <code>has_products</code> of the class <code>InfintyCosmos'</code> instances (the namespace <code>InfinityCosmos'</code> is open). </p>\n<p>So it does the same as  the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">InfinityCosmos'</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasConicalTerminal</span><span class=\"w\"> </span><span class=\"n\">K</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">InfinityCosmos'</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasConicalProducts</span><span class=\"w\"> </span><span class=\"n\">K</span>\n</code></pre></div>",
        "id": 482031837,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731442669
    },
    {
        "content": "<p>In particular, this means that typeclass synthesis is now aware of them, and can make use of those results when trying to fill in some <code>[FooBar X Y Z]</code> assumption.</p>",
        "id": 482106438,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1731483410
    },
    {
        "content": "<p>After today's seminar, we now have a sorry-free definition of an oo-cosmos that is actually correct which can be found <a href=\"https://github.com/emilyriehl/infinity-cosmos/pull/39\">here</a>. (Confidential to <span class=\"user-mention\" data-user-id=\"761171\">@Daniel Carranza</span>, I did my best to reproduce your code and finish the proof of <code>local_cotensor_bifunctoriality</code> but likely did thing suboptimally.)</p>\n<p>There's a lot that needs golfing before we start to build on top of it. I don't have time to highlight specific inefficiencies/questions now but let me just say that suggestions are very welcome.</p>",
        "id": 483149109,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731974429
    },
    {
        "content": "<p>Nice milestone! Congrats!</p>",
        "id": 483192737,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1731998970
    },
    {
        "content": "<p>I'm ready to merge this branch now, unless anyone objects. I'm sure we'll make further tweaks but I want this development to be part of main.</p>",
        "id": 483972268,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1732301895
    }
]