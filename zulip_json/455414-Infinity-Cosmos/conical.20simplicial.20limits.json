[
    {
        "content": "<p>I've been experimentally adding things to <span class=\"user-mention\" data-user-id=\"519559\">@Dagur Asgeirsson</span>'s file on conical limits and have run into a universe error I don't understand.</p>\n<p>The file starts with some variables</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimplicialCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>while I thought was identical to writing</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">u₁</span><span class=\"w\"> </span><span class=\"n\">v₁</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimplicialCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>But when I replace the former with the latter it breaks a bunch of stuff in his proof that conical limits induce an isomorphism. Any idea what's up?</p>",
        "id": 471558304,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1726777582
    },
    {
        "content": "<p>The reason I'm trying to be more explicit about universes is I'm having trouble defining <code>HasConicalLimits</code> which refers to a simplicial category that has all conical limits up to the size of its hom simplicial sets.</p>",
        "id": 471558432,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1726777643
    },
    {
        "content": "<p>The former creates universe metavariables. These metavariables can secretly hide universe constraints in the code.</p>",
        "id": 471558539,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1726777683
    },
    {
        "content": "<p>Specifically the undecorated <code>Category</code> classes</p>",
        "id": 471558629,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1726777729
    },
    {
        "content": "<p>We need a <code>[Category* C]</code> elaborator!</p>",
        "id": 471563820,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1726780002
    },
    {
        "content": "<p>Here's a prototype:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"n\">elab</span><span class=\"w\"> </span><span class=\"s2\">\"Category*\"</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Lean.Meta.mkFreshLevelMVar</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Lean.Elab.Term.elabTerm</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">none</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">sort</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Lean.Meta.inferType</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">throwError</span><span class=\"w\"> </span><span class=\"s2\">\"ERROR\"</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">cat</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean.Expr</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"ss\">``CategoryTheory.Category</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"n\">u</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Lean.Elab.Term.levelMVarToParam</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">app</span><span class=\"w\"> </span><span class=\"n\">cat</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">≫</span><span class=\"w\"> </span><span class=\"n\">g</span>\n</code></pre></div>",
        "id": 471565160,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1726780629
    },
    {
        "content": "<p>If I've understood <span class=\"user-mention\" data-user-id=\"306577\">@Matthew Ballard</span>'s point, it seems that in the code below there are secret universe constraints that the universe metavariables automatically configure themselves to satisfy. But when I replace them with named universe variables, the named variables don't satisfy the constraint unless explicitly told about it.</p>",
        "id": 471570100,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1726783378
    },
    {
        "content": "<p>I think I see the issue. One of the errors caused when using named variables is here</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">limitComparison</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">sHom</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">pt</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">limit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"bp\">⋙</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sHomFunctor</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">op</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">limit</span><span class=\"bp\">.</span><span class=\"n\">lift</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">(((</span><span class=\"n\">sHomFunctor</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">op</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">mapCone</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>where the error message is <code>failed to synthesize\nHasLimit (F ⋙ (sHomFunctor C).obj (op X))</code>. This functor is valued in a presheaf category valued in <code>Type v</code> so should have a limit if <code>v</code> is at least <code>max u₁ v₁</code>.</p>",
        "id": 471570737,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1726783725
    },
    {
        "content": "<p>Unfortunately the code is still broken with</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">u₁</span><span class=\"w\"> </span><span class=\"n\">v₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimplicialCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"bp\">⥤</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cone</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>though it works with </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimplicialCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"bp\">⥤</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cone</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>I'm not sure why...</p>",
        "id": 471570780,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1726783762
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243562\">Adam Topaz</span> <a href=\"#narrow/stream/455414-Infinity-Cosmos/topic/conical.20simplicial.20limits/near/471565160\">said</a>:</p>\n<blockquote>\n<p>Here's a prototype:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"n\">elab</span><span class=\"w\"> </span><span class=\"s2\">\"Category*\"</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Lean.Meta.mkFreshLevelMVar</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Lean.Elab.Term.elabTerm</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">none</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">sort</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Lean.Meta.inferType</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">throwError</span><span class=\"w\"> </span><span class=\"s2\">\"ERROR\"</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">cat</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean.Expr</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"ss\">``CategoryTheory.Category</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"n\">u</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">Lean.Elab.Term.levelMVarToParam</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">app</span><span class=\"w\"> </span><span class=\"n\">cat</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">≫</span><span class=\"w\"> </span><span class=\"n\">g</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Looks good to me. Could we combine it with a linter that forbids bare <code>[Category C]</code>?</p>",
        "id": 471579395,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1726789523
    },
    {
        "content": "<p>Well, one thing I would still like to experiment with is arranging the morphism universe parameter to come before the object one.</p>",
        "id": 471579665,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1726789732
    },
    {
        "content": "<p>But I won’t have time to try doing that seriously for a couple of days</p>",
        "id": 471579686,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1726789748
    },
    {
        "content": "<p>Also matching on <code>.succ u</code> isn’t ideal</p>",
        "id": 471579807,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1726789835
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"246635\">@Emily Riehl</span> I've opened <a href=\"https://github.com/emilyriehl/infinity-cosmos/pull/13\">https://github.com/emilyriehl/infinity-cosmos/pull/13</a> which fixes the universe issues in this file. It adds the assumption <code>[HasLimitsOfShape J SSet]</code> (which will always hold if <code>J</code> is \"small enough\") to fix the issues in the section about the comparison maps. It also reorders the universe arguments so that <code>HasConicalLimitsOfSize</code> has the desired meaning.</p>",
        "id": 472679011,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1727265429
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"519559\">@Dagur Asgeirsson</span></p>",
        "id": 472775657,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1727299111
    },
    {
        "content": "<p>I've been trying to build out some API around the conical simplicial limits, but I could use some advice on <br>\n(a) structuring things property (eg should these be theorems or instances) and<br>\n(b) help in filling some sorries (where I'm stuck).<br>\nThis all concerns the Limits file under SimplicialCategory created by <span class=\"user-mention\" data-user-id=\"519559\">@Dagur Asgeirsson</span> </p>\n<p>Specifically, I'd like to be able to add an assumption that a simplicial category K has a certain type of conical simplicial limits and have lean infer that K then has the underlying unenriched limits of the same type. </p>\n<p>For example</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">HasConicalProducts_hasProducts</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasConicalProducts</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasProducts</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 480249876,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1730581148
    },
    {
        "content": "<p>Some results/constructions in this direction are straightforward (aside from the choice of variables names; advice is very welcome):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/--</span>\n<span class=\"sd\">A limit cone `c` in a simplicial category `A` is a *simplicially enriched limit* if for every</span>\n<span class=\"sd\">`X : C`, the cone obtained by applying the simplicial coyoneda functor `(X ⟶[A] -)` to `c` is a</span>\n<span class=\"sd\">limit cone in `SSet`.</span>\n<span class=\"sd\">-/</span>\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">IsSLimit</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">isLimit</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsLimit</span><span class=\"w\"> </span><span class=\"n\">c</span>\n<span class=\"w\">  </span><span class=\"n\">isSLimit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsLimit</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">sHomFunctor</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">op</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">mapCone</span><span class=\"w\"> </span><span class=\"n\">c</span>\n\n<span class=\"sd\">/-- Conical simplicial limits are also limits in the unenriched sense.-/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsSLimit_islimit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">slim</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsSLimit</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsLimit</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">slim</span><span class=\"bp\">.</span><span class=\"n\">isLimit</span>\n</code></pre></div>",
        "id": 480249962,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1730581215
    },
    {
        "content": "<p>Everything of the form \"has conical limit -&gt; has limit\" is can be an instance. <br>\nRegarding the sorry in <code>HasConicalLimitsOfSize_hasLimitsOfSize</code> I can take a look a bit later, but I suspect the problem is that Lean is making up some universes and everything should just work if you provide the <code>HasConicalLimitsOfSize</code> instance and the <code>HasLimitsOfSize</code> that you want to prove with (the same) explicit universes</p>",
        "id": 480250387,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1730581610
    },
    {
        "content": "<p>I managed to close these sorries but with <a href=\"https://github.com/emilyriehl/infinity-cosmos/commit/4d2348f83e1eeccdbc4234c5e326f47d1e66b881#diff-8930d9909fa447aa0bdf7569b561349605515737e6152c788b6d45d647b372d1R209\">horrible proofs</a>. Can anyone explain what I'm doing wrong?</p>",
        "id": 481610987,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731284696
    },
    {
        "content": "<p>Specifically</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- `C` has all conical limits of size `v₁ u₁` (`HasLimitsOfSize.{v₁ u₁} C`)</span>\n<span class=\"sd\">if it has conical limits of every shape `J : Type u₁` with `[Category.{v₁} J]`.</span>\n<span class=\"sd\">-/</span>\n<span class=\"kd\">@[</span><span class=\"n\">pp_with_univ</span><span class=\"kd\">]</span>\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">HasConicalLimitsOfSize</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimplicialCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- All functors `F : J ⥤ C` from all small `J` have conical limits -/</span>\n<span class=\"w\">  </span><span class=\"n\">has_conical_limits_of_shape</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u₁</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">HasConicalLimitsOfShape</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">infer_instance</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">HasConicalLimitsOfSize_hasLimitsOfSize</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasConicalLimitsOfSize</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">HasLimitsOfSize</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">has_limits_of_shape</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"n\">hyp</span>\n<span class=\"w\">    </span><span class=\"n\">constructor</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">F</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">lem1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasConicalLimitsOfSize</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">infer_instance</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">lem2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasConicalLimitsOfShape</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">lem1</span><span class=\"bp\">.</span><span class=\"n\">has_conical_limits_of_shape</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasConicalLimit</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">lem2</span><span class=\"bp\">.</span><span class=\"n\">has_conical_limit</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">HasConicalLimit_hasLimit</span><span class=\"w\"> </span><span class=\"n\">F</span>\n</code></pre></div>",
        "id": 481611010,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731284717
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">HasConicalProducts</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- All discrete diagrams of bounded size have conical products.  -/</span>\n<span class=\"w\">  </span><span class=\"n\">has_conical_limits_of_shape</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">HasConicalLimitsOfShape</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Discrete</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">infer_instance</span>\n<span class=\"c1\">--  has_limits_of_shape : ∀ { I : Type w} (f : I → C), HasConicalProduct f := by</span>\n<span class=\"c1\">--    infer_instance</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">HasConicalProducts_hasProducts</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hyp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasConicalProducts</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">w</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">     </span><span class=\"n\">HasProducts</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">w</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">I</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">f</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hyp</span><span class=\"bp\">.</span><span class=\"n\">has_conical_limits_of_shape</span><span class=\"w\"> </span><span class=\"n\">I</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasConicalLimit</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">infer_instance</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">HasConicalLimit_hasLimit</span><span class=\"w\"> </span><span class=\"n\">f</span>\n</code></pre></div>",
        "id": 481611038,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731284749
    },
    {
        "content": "<p>I couldn't figure out how to reference the hypothesis <code>HasConicalProducts</code> in the latter without giving it a name; I got a circular universe error I hadn't seen before.</p>",
        "id": 481611154,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731284829
    },
    {
        "content": "<p>It's possible that some of the issue here has to do with whether products are indexed by functions out of a type or functors out a discrete category. In mathlib <code>HasProduct</code> is indexed by functions out of a type but <code>HasProducts</code> references limits of discrete diagrams (indexed by functors out of a discrete category). See the commented out alternative form of <code>has_conical_limits_of_shape.</code></p>",
        "id": 481611236,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731284894
    },
    {
        "content": "<p>I'm taking a look</p>",
        "id": 481656001,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731312114
    },
    {
        "content": "<p>The issue was just that the instances <code>HasConicalLimitsOfShape -&gt; HasConicalLimit</code> and <code>HasConicalLimitsOfSize -&gt; HasConicalLimitsOfShape</code> weren't declared until further down in the file. Now the proofs are basically just <code>inferInstance</code></p>",
        "id": 481659606,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731313317
    },
    {
        "content": "<p><a href=\"https://github.com/emilyriehl/infinity-cosmos/pull/38\">https://github.com/emilyriehl/infinity-cosmos/pull/38</a></p>",
        "id": 481659613,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731313319
    },
    {
        "content": "<p>Thank you. Someday I hope I won't be so bad at this... ;)</p>",
        "id": 481724978,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731332544
    },
    {
        "content": "<p>It's certainly quite the learning curve, for sure! Moreover I think learning category theory is a very hard place to start. I remember the first Lean for the Curious Mathematician in something like 2020, when I had felt like I was on top of the system, and Kim Morrison had put some category theory exercises together for the attendees, and after about 2 hours of working on them I had just about stumbled through the first one -- and this was after we'd written the perfectoid space paper!</p>",
        "id": 481750593,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1731339434
    },
    {
        "content": "<p>Especially the API for limits takes some getting used to</p>",
        "id": 481776099,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731346992
    },
    {
        "content": "<p>I'm back with my regularly scheduled trouble with instances and universe levels.</p>\n<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> pointed out (of course) that since an ∞-cosmos has conical products it should have a conical terminal object. Unfortunately, lean does not agree.</p>\n<p>I tried to remedy this situation as follows:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">section</span><span class=\"w\"> </span><span class=\"n\">ConicalProducts</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimplicialCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n\n<span class=\"sd\">/-- An abbreviation for `HasSLimit (Discrete.functor f)`. -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">HasConicalProduct</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">HasConicalLimit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Discrete</span><span class=\"bp\">.</span><span class=\"n\">functor</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">HasConicalProduct_hasProduct</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasConicalProduct</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">HasProduct</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">HasConicalLimit_hasLimit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Discrete</span><span class=\"bp\">.</span><span class=\"n\">functor</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">HasConicalProducts</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- All discrete diagrams of bounded size have conical products.  -/</span>\n<span class=\"w\">  </span><span class=\"n\">has_conical_limits_of_shape</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">HasConicalLimitsOfShape</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Discrete</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">infer_instance</span>\n<span class=\"c1\">--  has_limits_of_shape : ∀ { I : Type w} (f : I → C), HasConicalProduct f := by</span>\n<span class=\"c1\">--    infer_instance</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">HasConicalProducts_hasProducts</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hyp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasConicalProducts</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">w</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">HasProducts</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">w</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">I</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">f</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hyp</span><span class=\"bp\">.</span><span class=\"n\">has_conical_limits_of_shape</span><span class=\"w\"> </span><span class=\"n\">I</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasConicalLimit</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">infer_instance</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">HasConicalLimit_hasLimit</span><span class=\"w\"> </span><span class=\"n\">f</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">HasConicalProducts_hasConicalTerminal</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hyp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasConicalProducts</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">HasConicalTerminal</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hyp</span><span class=\"bp\">.</span><span class=\"n\">has_conical_limits_of_shape</span><span class=\"w\"> </span><span class=\"n\">PEmpty</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">}</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">HasConicalProducts_hasConicalTerminal'</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hyp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasConicalProducts</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">HasConicalTerminal</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">inst</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hyp</span><span class=\"bp\">.</span><span class=\"n\">has_conical_limits_of_shape</span><span class=\"w\"> </span><span class=\"n\">PEmpty</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">ConicalProducts</span>\n</code></pre></div>",
        "id": 483550572,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1732128397
    },
    {
        "content": "<p>My question is firstly whether the final statement is correct. If so, does anyone have suggestions for how to fill the last sorry.</p>",
        "id": 483550733,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1732128467
    },
    {
        "content": "<p>the statement looks correct to me</p>",
        "id": 483550927,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1732128536
    },
    {
        "content": "<p>what happens when you just replace the 0 with <code>w</code>?</p>",
        "id": 483551041,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1732128584
    },
    {
        "content": "<p>I guess you will need a slightly different <code>PEmpty</code> but otherwise it seems like it would work</p>",
        "id": 483551131,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1732128611
    },
    {
        "content": "<p>Since <code>HasConicalTerminal</code> is defined in terms of <code>Discrete.{0} PEmpty</code>, you can't directly infer it. As Mario points out, you could get something like <code>HasConicalLimitsOfShape (Discrete.{w} PEmpty</code>. To get the one of size 0, you'd need an analogue of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Limits.hasLimitsOfSizeShrink#doc\">docs#CategoryTheory.Limits.hasLimitsOfSizeShrink</a> to finish. </p>\n<p>Alternatively, since these shapes are equivalent categories, an analogue of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Limits.hasLimitsOfShape_of_equivalence#doc\">docs#CategoryTheory.Limits.hasLimitsOfShape_of_equivalence</a> would work. </p>\n<p>In any case, these would both be useful to have</p>",
        "id": 483556388,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1732130662
    },
    {
        "content": "<p>Thanks for these suggestions. I tried to implement everything (which took me down various rabbit holes to):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SimplicialCategory</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">hasConicalLimitOfIso</span><span class=\"bp\">.</span><span class=\"n\">coneIso</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"bp\">⥤</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"bp\">≅</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cone</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">((</span><span class=\"n\">sHomFunctor</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">op</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">mapCone</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">Cones</span><span class=\"bp\">.</span><span class=\"n\">postcompose</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">≅</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">Cones</span><span class=\"bp\">.</span><span class=\"n\">postcompose</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">isoWhiskerRight</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">sHomFunctor</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">op</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)))</span><span class=\"bp\">.</span><span class=\"n\">hom</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">obj</span>\n<span class=\"w\">        </span><span class=\"o\">(((</span><span class=\"n\">sHomFunctor</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">op</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">mapCone</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 483823935,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1732241839
    },
    {
        "content": "<p>But despite proving conical analogues of everything you mentioned I still wasn't able to finish this proof:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">HasConicalProducts_hasConicalTerminal'</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hyp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasConicalProducts</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">w</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">HasConicalTerminal</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">HasConicalTerminal</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">inst</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hyp</span><span class=\"bp\">.</span><span class=\"n\">has_conical_limits_of_shape</span><span class=\"w\"> </span><span class=\"n\">PEmpty</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PEmpty</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">≃</span><span class=\"w\"> </span><span class=\"n\">PEmpty</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">equivPEmpty</span><span class=\"w\"> </span><span class=\"n\">PEmpty</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">eq'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Discrete</span><span class=\"w\"> </span><span class=\"n\">PEmpty</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">≃</span><span class=\"w\"> </span><span class=\"n\">Discrete</span><span class=\"w\"> </span><span class=\"n\">PEmpty</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">equivOfIsEmpty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Discrete</span><span class=\"w\"> </span><span class=\"n\">PEmpty</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Discrete</span><span class=\"w\"> </span><span class=\"n\">PEmpty</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">})</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">hasConicalLimitsOfShape_of_equivalence</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">J</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Discrete</span><span class=\"w\"> </span><span class=\"n\">PEmpty</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">w</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 483824032,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1732241896
    },
    {
        "content": "<p>I think the problem might by the theorems concern equivalences of categories , which confusingly (to me) are denoted with the symbol <code>≅</code>. But this does not type check in either <code>eq</code> or <code>eq'</code> because </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">argument</span>\n<span class=\"n\">PEmpty</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">}</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 483824166,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1732242001
    },
    {
        "content": "<p>Note that equivalence of categories is denoted <code>≌</code> (<code>\\backcong</code>) and not <code>≅</code> (<code>\\iso</code>/<code>\\cong</code>). Is that the symbol you wrote? It should typecheck between the <code>Discrete PEmpty</code>'s (the other ones aren't categories).</p>",
        "id": 483856922,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1732263180
    },
    {
        "content": "<p>This works:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">w</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Discrete</span><span class=\"w\"> </span><span class=\"n\">PEmpty</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">≌</span><span class=\"w\"> </span><span class=\"n\">Discrete</span><span class=\"w\"> </span><span class=\"n\">PEmpty</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">w</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Discrete</span><span class=\"bp\">.</span><span class=\"n\">equivalence</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">equivPEmpty</span><span class=\"w\"> </span><span class=\"n\">PEmpty</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">})</span>\n</code></pre></div>",
        "id": 483857218,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1732263310
    },
    {
        "content": "<p>(My apologies for the long ago notation choice of \\backcong...)</p>",
        "id": 483897849,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732277671
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"519559\">Dagur Asgeirsson</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/conical.20simplicial.20limits/near/483856922\">said</a>:</p>\n<blockquote>\n<p>Note that equivalence of categories is denoted <code>≌</code> (<code>\\backcong</code>) and not <code>≅</code> (<code>\\iso</code>/<code>\\cong</code>). Is that the symbol you wrote? It should typecheck between the <code>Discrete PEmpty</code>'s (the other ones aren't categories).</p>\n</blockquote>\n<p>Indeed, this was what I was missing! Hilarious.</p>",
        "id": 483970063,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1732301002
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/conical.20simplicial.20limits/near/483897849\">said</a>:</p>\n<blockquote>\n<p>(My apologies for the long ago notation choice of ≌ ```</p>\n<p>If someone wants to fix it, I don't particularly see that it is too late. It would be a fun but probably unlikely experiment to try just overloading <code>≅</code>. But failing that, what would be better?</p>\n</blockquote>",
        "id": 484022903,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732329086
    },
    {
        "content": "<p>I do not think that <code>≌/≅</code> needs a fix :-)</p>",
        "id": 484045474,
        "sender_full_name": "Joël Riou",
        "timestamp": 1732351069
    },
    {
        "content": "<p>Agreed. It's clearly documented at the start of the file (which I didn't check). Lesson learned.</p>",
        "id": 484089998,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1732390471
    },
    {
        "content": "<p>Mathematicians would not even distinguish the two symbols, this is just a mathlib gotcha.</p>",
        "id": 484090103,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1732390564
    },
    {
        "content": "<p>Mathematicians also use the same symbol <code>-&gt;</code> for a morphism and a functor. I am happy we do not conflate the two :-)</p>",
        "id": 484091286,
        "sender_full_name": "Joël Riou",
        "timestamp": 1732391661
    },
    {
        "content": "<p>I think Kevin is saying that a mathematician would not differentiate between the symbols <code>≌/≅</code> when writing. As far as I know, mathematicians do use clearly distinct symbols for equivalence and isomorphism, namely <code>≃</code> and <code>≅</code> respectively.</p>",
        "id": 484091493,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1732391868
    },
    {
        "content": "<p>I tend to agree that mathlib's deliberate use of unicode confusables is a bad habit</p>",
        "id": 484091626,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1732391969
    },
    {
        "content": "<p>It's just one of those things you have to learn, like how every few months someone asks about why <code>a | b</code> works for someone else and not for them, because they didn't realise that \"divides\" is <code>\\|</code></p>",
        "id": 484094516,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1732394428
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/conical.20simplicial.20limits/near/484091493\">said</a>:</p>\n<blockquote>\n<p>I think Kevin is saying that a mathematician would not differentiate between the symbols <code>≌/≅</code> when writing. As far as I know, mathematicians do use clearly distinct symbols for equivalence and isomorphism, namely <code>≃</code> and <code>≅</code> respectively.</p>\n</blockquote>\n<p>I dimly remember way back in the day when I settled on <code>backcong</code>, going looking through unicode hoping for the third in the sequence <code>≃</code>, <code>≅</code>, ..., to use for the next categorical level. But I didn't find anything.</p>",
        "id": 484102093,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732401844
    },
    {
        "content": "<p>In coordination with <span class=\"user-mention\" data-user-id=\"246635\">@Emily Riehl</span> I generalised these from simplicial sets to conical limit over a general enriched ordinary category: <a href=\"https://github.com/emilyriehl/infinity-cosmos/pull/78\">https://github.com/emilyriehl/infinity-cosmos/pull/78</a></p>\n<p><span class=\"user-mention\" data-user-id=\"519559\">@Dagur Asgeirsson</span> would you have the chance to glimpse over the definitions and see if I did things right?<br>\nIs there any particular choice for the order of <code>universe</code>s at the top?</p>\n<p>I would create PR's to mathlib with these additions now</p>",
        "id": 494995508,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1737449101
    },
    {
        "content": "<p>I took a quick look and it looks reasonable. You can ping me when the mathlib PR is ready and I can do a proper review on that. I think the name should contain the word <code>Enriched</code>, maybe by putting it in the <code>CategoryTheory.Enriched</code> namespace. Probably <code>CategoryTheory.Enriched.IsLimit</code> is too confusing, so maybe <code>CategoryTheory.Enriched.IsConicalLimit</code> or <code>CategoryTheory.Enriched.IsEnrichedLimit</code>.</p>",
        "id": 494998227,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1737449986
    },
    {
        "content": "<p>Also, when you open the mathlib PR, make sure to mirror the file structure of the ordinary limit API as much as possible</p>",
        "id": 494998360,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1737450012
    },
    {
        "content": "<p>Thanks! I think Emily suggested <code>IsConicalLimit</code> over <code>IsEnrichedLimit</code> so maybe <code>CategoryTheory.Enriched.IsConicalLimit</code>?</p>",
        "id": 494998845,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1737450167
    },
    {
        "content": "<p>I like \"conical\" because in the future we will develop a more general theory of enriched limits, including <em>cotensors</em> (formalized by <span class=\"user-mention\" data-user-id=\"761171\">@Daniel Carranza</span>) and more general <em>weighted limits</em>. Each of these deserve to be called \"enriched limits\" but the term \"conical\" distinguishes the enriched limits which have ordinary cone shapes.</p>",
        "id": 495093365,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1737476041
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"519559\">@Dagur Asgeirsson</span> and <span class=\"user-mention\" data-user-id=\"459699\">@Joël Riou</span>  do you have any suggestions for the <code>CategoryTheory/Enriched</code> directory structure? </p>\n<p>Right now mathlib has <code>Basic.lean</code> (defining enriched categories) <code>Ordinary.lean</code> (defining enriched ordinary categories) and other files like <code>Opposite.lean</code> which develop opposite categories for both enriched categories and enriched ordinary categories. This seems reasonable to me (for now at least).</p>\n<p>Following this, I'd suggest <span class=\"user-mention\" data-user-id=\"385895\">@Jon Eugster</span>'s <code>InfinityCosmos/ForMathlib/Enriched/Ordinary/Limits</code> get filed as <code>Mathlib/Enriched/ConicalLimits</code>.</p>",
        "id": 495095444,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1737476599
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246635\">Emily Riehl</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/conical.20simplicial.20limits/near/495095444\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"519559\">Dagur Asgeirsson</span> and <span class=\"user-mention silent\" data-user-id=\"459699\">Joël Riou</span>  do you have any suggestions for the <code>CategoryTheory/Enriched</code> directory structure? </p>\n</blockquote>\n<p>Ah, I have already merged <a href=\"https://github.com/leanprover-community/mathlib4/pull/20903\">#20903</a>, but if a better option is found, we may proceed otherwise...</p>",
        "id": 495099002,
        "sender_full_name": "Joël Riou",
        "timestamp": 1737477581
    },
    {
        "content": "<p>Ah, great, somehow I missed this. Glad to hear everyone else is ahead of me ;)</p>",
        "id": 495101367,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1737478267
    },
    {
        "content": "<p>Two more organizational questions:</p>\n<ul>\n<li>at some point there is a namespace <code>isConicalLimit</code>. Should this be <code>IsConicalLimit</code>? Are all namespaces in UpperCamelCase?</li>\n<li>At the end of the <code>Limits</code> file (which I think should be renamed <code>ConicalLimits</code>) there are some special cases involving specific diagram shapes: terminal objects, products, and pullbacks. Should these be broken out into their own files? Should the <code>HasConicalTerminal</code> get added to the <code>IsConicalTerminal</code> file?</li>\n</ul>",
        "id": 495122676,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1737485171
    },
    {
        "content": "<p>Finally, for the eventual PR to mathlib, how much should <span class=\"user-mention\" data-user-id=\"385895\">@Jon Eugster</span> PR at a time?</p>",
        "id": 495122735,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1737485195
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246635\">Emily Riehl</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/conical.20simplicial.20limits/near/495122676\">said</a>:</p>\n<blockquote>\n<p>Two more organizational questions:</p>\n<ul>\n<li>At the end of the <code>Limits</code> file (which I think should be renamed <code>ConicalLimits</code>) there are some special cases involving specific diagram shapes: terminal objects, products, and pullbacks. Should these be broken out into their own files? Should the <code>HasConicalTerminal</code> get added to the <code>IsConicalTerminal</code> file?</li>\n</ul>\n</blockquote>\n<p>Dagur suggested to try mirroring the existing Limit-API as much as possible, therefore I figured this file would be split at least into <code>Mathlib/CategoryTheory/Enriched/Ordinary/Limits/IsConicalLimit.lean</code> and <code>Mathlib/CategoryTheory/Enriched/Ordinary/Limits/HasConicalLimit.lean</code>. I thought of putting them into this <code>Enriched.Ordinal</code> folder because it all assume <code>EnrichedOrdinaryCategory</code>. And I would look at mathlib to figure out how to split-up files around this specific diagram shapes and conical-terminal, too. Does that sound good?</p>",
        "id": 495227282,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1737535756
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246635\">Emily Riehl</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/conical.20simplicial.20limits/near/495122676\">said</a>:</p>\n<blockquote>\n<ul>\n<li>at some point there is a namespace <code>isConicalLimit</code>. Should this be <code>IsConicalLimit</code>? Are all namespaces in UpperCamelCase?</li>\n</ul>\n</blockquote>\n<p>I thought namespaces ought to match the definition/structure's name they are about, so they might be lower-case. (<code>section</code>s are probably only upper-case, but not sure.) Although, I don't think it matters if the statements don't have that definition as explicit argument, because dot-notation won't be a thing anyways.</p>",
        "id": 495227887,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1737535959
    },
    {
        "content": "<p>or would <code>CategoryTheory/Enriched/Limits</code> be a better place?</p>",
        "id": 495230722,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1737536857
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246635\">Emily Riehl</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/conical.20simplicial.20limits/near/495122735\">said</a>:</p>\n<blockquote>\n<p>Finally, for the eventual PR to mathlib, how much should <span class=\"user-mention silent\" data-user-id=\"385895\">Jon Eugster</span> PR at a time?</p>\n</blockquote>\n<p>I would start by opening a PR with all the material. Then it's often natural to split it into several PRs, perhaps one per new file added</p>",
        "id": 495242919,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1737540436
    },
    {
        "content": "<p>The declaration is called <code>IsConicalLimit</code> (upper camel case because it's a type), so the namespace should be called that as well. (but there is nothing wrong with namespaces in lower camel case)</p>",
        "id": 495243260,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1737540532
    },
    {
        "content": "<p>Regarding files for the specific shapes, there is nothing wrong with one file for each shape. These will initially be very small files, but in the future we might want to develop more API for some of these shapes. I would suggest creating a <code>Limits</code> folder inside <code>Enriched</code> (or maybe inside <code>Enriched/Ordinary</code>). Initially, we maybe don't need much of a folder structure inside the <code>Enriched/Limits</code> folder, but that can always be changed later, e.g. if we end up with lots of files for specific shapes, we might create a <code>Shapes</code> folder, etc.</p>",
        "id": 495244207,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1737540847
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"519559\">Dagur Asgeirsson</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/conical.20simplicial.20limits/near/495243260\">said</a>:</p>\n<blockquote>\n<p>The declaration is called <code>IsConicalLimit</code> (upper camel case because it's a type), so the namespace should be called that as well. (but there is nothing wrong with namespaces in lower camel case)</p>\n</blockquote>\n<p>ah, I thought <span class=\"user-mention\" data-user-id=\"246635\">@Emily Riehl</span>'s question was about the <a href=\"https://github.com/emilyriehl/infinity-cosmos/blob/b05eaaaee034f647dca60dc8c101e874e8887a2e/InfinityCosmos/ForMathlib/CategoryTheory/Enriched/Ordinary/Limits.lean#L184\"><code>namespace conicalLimit</code></a> which belongs to the <code>def conicalLimit</code> above it and therefore would be lower case. </p>\n<p><code>namespace IsConicalLimit</code> has always been upper case as you explained correctly <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 495250138,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1737542486
    },
    {
        "content": "<p>Right, they are both correct (analogous to <code>IsLimit</code> and <code>limit</code>)</p>",
        "id": 495250445,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1737542560
    },
    {
        "content": "<p>What is the use of a lower case namespace? Probably means that you can never use dot notation, and somehow isn't that the point of namespaces?</p>",
        "id": 495253729,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737543519
    },
    {
        "content": "<p>Dot notation isn't the only point of namespaces, it's also a way of shortening names by opening the relevant namespace</p>",
        "id": 495253970,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1737543598
    },
    {
        "content": "<p>I will place a vote for putting things in <code>Enriched/Limits</code> if we can get away with it. <code>Mathlib.CategoryTheory.Enriched.Ordinary.Limits.Foo</code> starts to feel a bit long in my  opinion.</p>",
        "id": 495345601,
        "sender_full_name": "Nick Ward",
        "timestamp": 1737569283
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"776338\">Nick Ward</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/conical.20simplicial.20limits/near/495345601\">said</a>:</p>\n<blockquote>\n<p>I will place a vote for putting things in <code>Enriched/Limits</code></p>\n</blockquote>\n<p>sounds reasonable. I looked at the other files in <code>Mathlib/CategoryTheory/Enriched</code> and basically all of them use <code>EnrichedOrdinaryCategory</code> somewhere (if not exclusively).</p>",
        "id": 495347810,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1737570029
    },
    {
        "content": "<p>There's no an entire PR series cummulating in: <a href=\"https://github.com/leanprover-community/mathlib4/pull/20967\">#20967</a></p>\n<p>One missing point are references. <span class=\"user-mention\" data-user-id=\"519559\">@Dagur Asgeirsson</span> did you have anything particularly when you wrote this for simplicial sets?</p>",
        "id": 495372757,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1737579701
    },
    {
        "content": "<p>Great! I think I was just using the infinity-cosmos blueprint</p>",
        "id": 495380868,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1737582983
    },
    {
        "content": "<p>This is quite a well-organized stack of PRs. One for each <span aria-label=\"octopus\" class=\"emoji emoji-1f419\" role=\"img\" title=\"octopus\">:octopus:</span> arm!</p>",
        "id": 495382010,
        "sender_full_name": "Nick Ward",
        "timestamp": 1737583452
    },
    {
        "content": "<p>The standard reference is Kelly's <a href=\"http://www.tac.mta.ca/tac/reprints/articles/10/tr10.pdf\">book</a>  with conical limits appearing in section 3.8.</p>",
        "id": 495382175,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1737583537
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"385895\">@Jon Eugster</span> can you help me understand what <code>-- see Note [lower instance priority]</code> refers to? It seems this is a standard way to reference things in mathlib, but I do not know where to find such a note.</p>",
        "id": 495383112,
        "sender_full_name": "Nick Ward",
        "timestamp": 1737583948
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"776338\">Nick Ward</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/conical.20simplicial.20limits/near/495383112\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"385895\">Jon Eugster</span> can you help me understand what <code>-- see Note [lower instance priority]</code> refers to? It seems this is a standard way to reference things in mathlib, but I do not know where to find such a note.</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/blob/3e2f75fecded964cd9d2a775dbdf1ed6ba2f689c/Mathlib/Algebra/HierarchyDesign.lean#L218-L232\">it's here</a>. I believe these library notes ought to link but as far as I know nobody ever reimplemented that feature.</p>",
        "id": 495384170,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1737584429
    },
    {
        "content": "<p>Thank you! Apologies by the way if my limited PR comments have found their way to the wrong PRs in the series.</p>",
        "id": 495385228,
        "sender_full_name": "Nick Ward",
        "timestamp": 1737584943
    },
    {
        "content": "<p>ah no worries, I'll have a look tomorrow and apply any suggestions to the correct PR. thanks for looking at them</p>",
        "id": 495385545,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1737585114
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"385895\">@Jon Eugster</span> what would you like us to do with the InfinityCosmos version of this PR? We could either (i) merge it now or (ii) let it be. </p>\n<p>I don't want to add to your workflow; the mathlib PR is the main thing. So if (ii) is easiest that's fine.</p>\n<p>But on the other hand, you've updated the <code>InfinityCosmos/Basic</code> and <code>InfinityCosmos/Isofibrations</code> files in a way I'd like to start using.</p>",
        "id": 495385682,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1737585172
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246635\">Emily Riehl</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/conical.20simplicial.20limits/near/495385682\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"385895\">Jon Eugster</span> what would you like us to do with the InfinityCosmos version of this PR? We could either (i) merge it now or (ii) let it be.</p>\n</blockquote>\n<p>I'd be happy if you merge this now.</p>",
        "id": 495452439,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1737622435
    },
    {
        "content": "<p>Merged! I didn't delete your branch, though, in case you still want it for some reason. But if not, please feel free to delete this yourself. </p>\n<p>Thanks for all your work on this. Please feel free to <code>@</code> me at any time if I can be helpful with the Mathlib PRs.</p>",
        "id": 495515301,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1737643372
    }
]