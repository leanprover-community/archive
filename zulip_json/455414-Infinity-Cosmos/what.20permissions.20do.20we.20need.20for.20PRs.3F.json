[
    {
        "content": "<p>I'd like anyone to be able to submit a PR to the infinity cosmos repository for review. Is this a good idea, and if so do I need to do anything with the permissions? </p>\n<p>I ask because <span class=\"user-mention\" data-user-id=\"754695\">@Zeyi Zhao</span> is having trouble sending us a PR from a branch of the repository (rather than a fork). How does mathlib make this possible?</p>\n<p>I don't have a lot of experience maintaining public git repositories so general advice on this sort of thing is welcome.</p>",
        "id": 481961477,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731421550
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246635\">Emily Riehl</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/what.20permissions.20do.20we.20need.20for.20PRs.3F/near/481961477\">said</a>:</p>\n<blockquote>\n<p>I'd like anyone to be able to submit a PR to the infinity cosmos repository for review. </p>\n</blockquote>\n<p>Anyone is able to submit a PR from a fork, this does not require any permissions</p>",
        "id": 481963510,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731422041
    },
    {
        "content": "<p>The way mathlib allows PRs from branches is that people who want to contribute ask for an invitation here on Zulip and then a maintainer sends them an invitation. It's probably a bad idea to allow anyone to push directly to branches of the repo</p>",
        "id": 481963868,
        "sender_full_name": "Dagur Asgeirsson",
        "timestamp": 1731422129
    },
    {
        "content": "<p>I think I shall push through a fork and see what happens.</p>",
        "id": 481965816,
        "sender_full_name": "Zeyi Zhao",
        "timestamp": 1731422718
    },
    {
        "content": "<p>I've been running FLT via the \"submit a PR via a fork\" principle and it's worked fine so far. The only objection I've had so far was from Yael Dillies, who complained that they were collaborating with someone else on a PR and the fork process apparently made it harder. But my understanding is that PRs from forks are the normal way that github is supposed to be used, and it's mathlib which is the outlier. The reason is that <del>after every PR the mathlib people want a huge amount of stuff to be run to check that the PR passes various tests, and they apparently can't run these tests on PRs from forks.</del> that is incorrect: the reason is to do with olean caches.</p>",
        "id": 481970854,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1731424080
    },
    {
        "content": "<p>Some questions:</p>\n<p>(1) How would I as a maintainer send an invitation (what sort of invitation?) if we were to go the mathlib route?</p>\n<p>(2) Do folks create and delete forks for every PR? Or does it make sense to make one fork of a repository and use it always? If the latter, does the user have to manually keep the fork up to date?</p>",
        "id": 481980843,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731426604
    },
    {
        "content": "<p>I don't know about (1), unfortunately. For (2), if you use a forking workflow, everyone would create a single fork and then essentially have two copies of the repository. For instance, I have write access to my fork at <a href=\"https://github.com/gio256/infinity-cosmos\">gio256/infinity-cosmos</a>, but only read access to the \"upstream\" repository at <a href=\"https://github.com/emilyriehl/infinity-cosmos\">emilyriehl/infinity-cosmos</a>. If I had a bug fix to contribute, I would create a new branch at <code>gio256/infinity-cosmos/bug-fix</code>, then open a PR asking to merge the <code>bug-fix</code> branch of my repository  into the main branch of the upstream repository (<code>emilyriehl/infinity-cosmos/main</code>).</p>\n<p>You do need to keep the fork up to date, but it is the same process as incorporating changes from the <code>main</code> branch into a personal branch.</p>",
        "id": 481992474,
        "sender_full_name": "Nick Ward",
        "timestamp": 1731429917
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"754695\">Zeyi Zhao</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/what.20permissions.20do.20we.20need.20for.20PRs.3F/near/481965816\">said</a>:</p>\n<blockquote>\n<p>I think I shall push through a fork and see what happens.</p>\n</blockquote>\n<p>Follow up question: If I already have a fork, How do I create a new pull request?</p>",
        "id": 481998198,
        "sender_full_name": "Zeyi Zhao",
        "timestamp": 1731431704
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"754695\">@Zeyi Zhao</span> If you visit the forked repository on github and select the branch you want to PR, you should see \"This branch is <code>n</code> commits ahead of <code>emilyriehl/infinity-cosmos:main</code>\" at the top of the page. Next to that you can click \"Contribute\" and then \"Open Pull Request\".</p>",
        "id": 482000063,
        "sender_full_name": "Nick Ward",
        "timestamp": 1731432334
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"776338\">Nick Ward</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/what.20permissions.20do.20we.20need.20for.20PRs.3F/near/482000063\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"754695\">Zeyi Zhao</span> If you visit the forked repository on github and select the branch you want to PR, you should see \"This branch is <code>n</code> commits ahead of <code>emilyriehl/infinity-cosmos:main</code>\" at the top of the page. Next to that you can click \"Contribute\" and then \"Open Pull Request\".</p>\n</blockquote>\n<p>Thanks for your help! I got it.</p>",
        "id": 482005703,
        "sender_full_name": "Zeyi Zhao",
        "timestamp": 1731434274
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246635\">Emily Riehl</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/what.20permissions.20do.20we.20need.20for.20PRs.3F/near/481980843\">said</a>:</p>\n<blockquote>\n<p>Some questions:</p>\n<p>(1) How would I as a maintainer send an invitation (what sort of invitation?) if we were to go the mathlib route?<br>\n</p>\n</blockquote>\n<p><a href=\"/user_uploads/3121/wdvn9TsgOp1CjKboH1lK3Saz/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/wdvn9TsgOp1CjKboH1lK3Saz/image.png\" title=\"image.png\"><img data-original-dimensions=\"2637x204\" src=\"/user_uploads/thumbnail/3121/wdvn9TsgOp1CjKboH1lK3Saz/image.png/840x560.webp\"></a></div><ul>\n<li>Click on \"Settings\" in the menu at the top of the page of your repo.</li>\n</ul>\n<p><a href=\"/user_uploads/3121/KhT5Y5lMLlky3_GW75AMHl51/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/KhT5Y5lMLlky3_GW75AMHl51/image.png\" title=\"image.png\"><img data-original-dimensions=\"1692x304\" src=\"/user_uploads/thumbnail/3121/KhT5Y5lMLlky3_GW75AMHl51/image.png/840x560.webp\"></a></div><ul>\n<li>Click on \"Collaborators and teams\" in the vertical menu that appears on the settings page</li>\n<li>Authenticate</li>\n</ul>\n<p><a href=\"/user_uploads/3121/EK_s8jXOrPl57wr70sjT_Y23/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/EK_s8jXOrPl57wr70sjT_Y23/image.png\" title=\"image.png\"><img data-original-dimensions=\"1066x283\" src=\"/user_uploads/thumbnail/3121/EK_s8jXOrPl57wr70sjT_Y23/image.png/840x560.webp\"></a></div><ul>\n<li>Click \"Add people\"</li>\n</ul>\n<p><a href=\"/user_uploads/3121/beHBTGWYCXSwqcDMpPMMuDs2/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/beHBTGWYCXSwqcDMpPMMuDs2/image.png\" title=\"image.png\"><img data-original-dimensions=\"768x306\" src=\"/user_uploads/thumbnail/3121/beHBTGWYCXSwqcDMpPMMuDs2/image.png/840x560.webp\"></a></div><ul>\n<li>Search for the github username</li>\n<li>Choose \"write\" access for the role</li>\n</ul>",
        "id": 482107366,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1731483811
    },
    {
        "content": "<p>I recommend to <em>not</em> go via the Mathlib route, but just let contributors create a fork, and make a pull request from forks.</p>\n<p>The only reason that we use our setup in Mathlib, is that we make the olean cache available for all branches of Mathlib, and it's tricky to do that for forks.</p>",
        "id": 482122336,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1731488904
    },
    {
        "content": "<p>You can still add contributors via Johan's instructions if you want to add additional people that are able to merge pull requests.</p>",
        "id": 482122462,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1731488949
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/what.20permissions.20do.20we.20need.20for.20PRs.3F/near/481970854\">said</a>:</p>\n<blockquote>\n<p>The only objection I've had so far was from Yael Dillies, who complained that they were collaborating with someone else on a PR and the fork process apparently made it harder</p>\n</blockquote>\n<p>This can be resolved either by having Yael ask the author direct permission to their fork, or you deciding to give Yael maintainer powers on FLT (which grants access to PRs from forks too); which is to say, either you have to opt into giving Yael this power globally, or each contributor has to do so.</p>",
        "id": 482126497,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731490183
    },
    {
        "content": "<p>I edited my post above removing my claim that the issue was CI and replacing it with the claim that it's oleans. Thanks Eric for the explanation of how to do the joint PR thing -- mathlib was basically my first experience with open source coding and FLT is my second.</p>",
        "id": 482159965,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1731500716
    },
    {
        "content": "<p>What is an \"olean\" (aside from a city in New York, which is what google tells me)?</p>",
        "id": 482633910,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1731683478
    },
    {
        "content": "<p>It is one of the kinds of files that Lean produces while type-checking.  Lean produces a few different files, containing different information, the <code>olean</code>s is where basically all the typing information is contained.  When you import a file, Lean checks to see if there are available <code>olean</code>s for all the dependencies: if it finds them, then it loads the pre-processed information contained in them, instead of re-building the files.  Loading is <em>much</em> faster than rebuilding.</p>",
        "id": 482636763,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1731684266
    },
    {
        "content": "<p>(Also, <code>.olean</code> is the extension of such files.)</p>",
        "id": 482636936,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1731684310
    },
    {
        "content": "<p>IIUC the <code>*.olean</code> name is meant to be analogous to <code>*.o</code> for c programs</p>",
        "id": 482638155,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1731684634
    },
    {
        "content": "<p>It's the 5000 things which get downloaded when you type <code>lake exe cache get</code> which mean that you don't have to wait for 2 hours when you type <code>import Mathlib</code></p>",
        "id": 482642423,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1731685820
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"776338\">Nick Ward</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/what.20permissions.20do.20we.20need.20for.20PRs.3F/near/482000063\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"754695\">Zeyi Zhao</span> If you visit the forked repository on github and select the branch you want to PR, you should see \"This branch is <code>n</code> commits ahead of <code>emilyriehl/infinity-cosmos:main</code>\" at the top of the page. Next to that you can click \"Contribute\" and then \"Open Pull Request\".</p>\n</blockquote>\n<p>Another question: what I have is I created my own fork from infinity-cosmos and I am able to create a pull request on my end. What happened is that when I log into my Github account, I can see the pull request only on my account and it does not appear on Emily's account. Ideally it should appear on Emily's end and she will be able to see it the same place where she create her own pull request. Maybe my words are quite clear because I am totally new to it. What should I do? Any help is appreciated.</p>",
        "id": 483391834,
        "sender_full_name": "Zeyi Zhao",
        "timestamp": 1732068349
    },
    {
        "content": "<p>Do you mean <a href=\"https://github.com/Georjez/infinity-cosmos/pull/1\">this PR</a>? it seems that you've opened it in your own fork instead of the main repository</p>",
        "id": 483393365,
        "sender_full_name": "Ben Eltschig",
        "timestamp": 1732069378
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"646363\">Ben Eltschig</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/what.20permissions.20do.20we.20need.20for.20PRs.3F/near/483393365\">said</a>:</p>\n<blockquote>\n<p>Do you mean <a href=\"https://github.com/Georjez/infinity-cosmos/pull/1\">this PR</a>? it seems that you've opened it in your own fork instead of the main repository</p>\n</blockquote>\n<p>I think you are right. I need to open it in the main repository. What I am trying to do is I have some code to send to Emily(merge them into the main repository?) and I am trying to do by creating a pull request.</p>",
        "id": 483394196,
        "sender_full_name": "Zeyi Zhao",
        "timestamp": 1732069890
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"754695\">@Zeyi Zhao</span> Apologies, I should have explained more thoroughly. Clicking on \"Open Pull Request\" should bring you to the \"diff\" showing the lines of code that would be added or removed should your pull request be merged. At the top of this page, you can select \"base repository\" and a branch in the base repository, as well as \"head repository\" and a branch in the head repository. The \"base\" is where you want the code to <em>go</em>, and the \"head\" is where you want the code to <em>come from</em>. In this case, you want to select the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">base</span><span class=\"w\"> </span><span class=\"n\">repository</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">emilyriehl</span><span class=\"bp\">/</span><span class=\"n\">infinity</span><span class=\"bp\">-</span><span class=\"n\">cosmos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">base</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">master</span>\n<span class=\"n\">head</span><span class=\"w\"> </span><span class=\"n\">repository</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">username</span><span class=\"o\">}</span><span class=\"bp\">/</span><span class=\"n\">infinity</span><span class=\"bp\">-</span><span class=\"n\">cosmos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">compare</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">branch_with_your_work</span><span class=\"o\">}</span>\n</code></pre></div>",
        "id": 483395799,
        "sender_full_name": "Nick Ward",
        "timestamp": 1732070965
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"776338\">Nick Ward</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/what.20permissions.20do.20we.20need.20for.20PRs.3F/near/483395799\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"754695\">Zeyi Zhao</span> Apologies, I should have explained more thoroughly. Clicking on \"Open Pull Request\" should bring you to the \"diff\" showing the lines of code that would be added or removed should your pull request be merged. At the top of this page, you can select \"base repository\" and a branch in the base repository, as well as \"head repository\" and a branch in the head repository. The \"base\" is where you want the code to <em>go</em>, and the \"head\" is where you want the code to <em>come from</em>. In this case, you want to select the following:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">base</span><span class=\"w\"> </span><span class=\"n\">repository</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">emilyriehl</span><span class=\"bp\">/</span><span class=\"n\">infinity</span><span class=\"bp\">-</span><span class=\"n\">cosmos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">base</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">master</span>\n<span class=\"n\">head</span><span class=\"w\"> </span><span class=\"n\">repository</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">username</span><span class=\"o\">}</span><span class=\"bp\">/</span><span class=\"n\">infinity</span><span class=\"bp\">-</span><span class=\"n\">cosmos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">compare</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">branch_with_your_work</span><span class=\"o\">}</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Thanks! I will take a try.</p>",
        "id": 483395916,
        "sender_full_name": "Zeyi Zhao",
        "timestamp": 1732071034
    },
    {
        "content": "<p>Feel free to send a direct message as well. Git is neat for many reasons, but user-friendliness is not among them.</p>",
        "id": 483396097,
        "sender_full_name": "Nick Ward",
        "timestamp": 1732071173
    },
    {
        "content": "<p>Note also that this is not a lean question, there will be many resources out there on the internet explaining how to use GitHub in this way. Nick is right though, like lean it's a bit of a steep learning curve!</p>",
        "id": 483418937,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1732086994
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"754695\">@Zeyi Zhao</span> any luck with this?</p>",
        "id": 483972467,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1732301946
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246635\">Emily Riehl</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/what.20permissions.20do.20we.20need.20for.20PRs.3F/near/483972467\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"754695\">Zeyi Zhao</span> any luck with this?</p>\n</blockquote>\n<p>So far I can see a pull request at your end. Hopefully I didn't mess up with anything in there. <span class=\"user-mention\" data-user-id=\"246635\">@Emily Riehl</span></p>",
        "id": 483976038,
        "sender_full_name": "Zeyi Zhao",
        "timestamp": 1732303391
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"754695\">Zeyi Zhao</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/what.20permissions.20do.20we.20need.20for.20PRs.3F/near/483976038\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"246635\">Emily Riehl</span> <a href=\"#narrow/channel/455414-Infinity-Cosmos/topic/what.20permissions.20do.20we.20need.20for.20PRs.3F/near/483972467\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"754695\">Zeyi Zhao</span> any luck with this?</p>\n</blockquote>\n<p>So far I can see a pull request at your end. Hopefully I didn't mess up with anything in there. <span class=\"user-mention silent\" data-user-id=\"246635\">Emily Riehl</span></p>\n</blockquote>\n<p>Please let me know if there are any adjustments needed.</p>",
        "id": 483976232,
        "sender_full_name": "Zeyi Zhao",
        "timestamp": 1732303462
    },
    {
        "content": "<p>Great, I see it now. I just left several comments on your code. You should be able to make the changes locally and push them back to this PR. Let me know if you have any questions <span class=\"user-mention\" data-user-id=\"754695\">@Zeyi Zhao</span></p>",
        "id": 483983257,
        "sender_full_name": "Emily Riehl",
        "timestamp": 1732306057
    }
]