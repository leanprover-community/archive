[
    {
        "content": "<p>Hi, if I write this code:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">5</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">regular</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">IsRegularOfDegree</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>I get this error:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">synthesize</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"kn\">class</span>\n<span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">LocallyFinite</span>\n</code></pre></div>\n<p>However if I define <code>instance : DecidableRel G.Adj</code>  it works.<br>\nHowever, it should be possible to work with <code>IsRegularOfDegree</code> even if <code>G.Adj</code> is not comutable, and, <code>G.LocallyFinite</code> is obvious from <code>Fintype V</code>. Do you know if there is any solution to this?</p>\n<p>Also I think it should be possible to use <code>IsSRGWith</code> with out <code>DecidableRel G.Adj</code>, but it is needed as part of the definition, I don't know why</p>",
        "id": 566070327,
        "sender_full_name": "Iván Renison",
        "timestamp": 1767367930
    },
    {
        "content": "<p>The issue IMO stems from <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SimpleGraph.degree#doc\">docs#SimpleGraph.degree</a> being computable</p>",
        "id": 566071505,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1767368488
    },
    {
        "content": "<p>Oh wow, I'm just now finishing up removing this from degrees</p>",
        "id": 566071703,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1767368620
    },
    {
        "content": "<p>PR will be up soon, it solves this issue</p>",
        "id": 566071791,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1767368672
    },
    {
        "content": "<p>Ok, great! Thank you</p>",
        "id": 566071844,
        "sender_full_name": "Iván Renison",
        "timestamp": 1767368707
    },
    {
        "content": "<p><del>Also, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SimpleGraph.IsRegularOfDegree.top#doc\">docs#SimpleGraph.IsRegularOfDegree.top</a> already exists</del><br>\nI somehow confused the graph being on <code>Fin</code> with it being the complete graph, sorry</p>",
        "id": 566071869,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1767368724
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"933054\">Snir Broshi</span> <a href=\"#narrow/channel/252551-graph-theory/topic/IsRegularOfDegree.20without.20DecidableRel/near/566071791\">said</a>:</p>\n<blockquote>\n<p>PR will be up soon</p>\n</blockquote>\n<p>Opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/33501\">#33501</a>, it removes <code>LocallyFinite</code> from <code>IsRegularOfDegree</code></p>",
        "id": 566118618,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1767408547
    },
    {
        "content": "<p>Not sure what to do about the import increase <span aria-label=\"hurt\" class=\"emoji emoji-1f915\" role=\"img\" title=\"hurt\">:hurt:</span><br>\nAdded imports for <code>Data.ENat.Lattice</code> and <code>Data.Set.Card</code> in <code>SimpleGraph.Finite</code>, which seem reasonable to me but they causes a big chain reaction of import increases</p>",
        "id": 566118729,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1767408732
    },
    {
        "content": "<p>do we need ENat for defining IsRegularOfDegree? It's still only using Nat. We don't need to define IsRegularOfDegree using edegree if we keep the locally finite assumption</p>",
        "id": 566152402,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1767449077
    },
    {
        "content": "<p>Defining it using edegree is odd anyway given that you can't use IsRegularOfDegree for infinite graphs anyway.</p>",
        "id": 566152508,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1767449190
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"646655\">Iván Renison</span> <a href=\"#narrow/channel/252551-graph-theory/topic/IsRegularOfDegree.20without.20DecidableRel/near/566070327\">said</a>:</p>\n<blockquote>\n<p>I get this error:</p>\n</blockquote>\n<p>It works on the current lean playground? <code>#synth G.LocallyFinite</code> returns something in CategoryTheory though.</p>",
        "id": 566152944,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1767449654
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"761203\">Vlad Tsyrklevich</span> <a href=\"#narrow/channel/252551-graph-theory/topic/IsRegularOfDegree.20without.20DecidableRel/near/566152402\">said</a>:</p>\n<blockquote>\n<p>do we need ENat for defining IsRegularOfDegree? It's still only using Nat. We don't need to define IsRegularOfDegree using edegree if we keep the locally finite assumption</p>\n</blockquote>\n<p>But the point of the discussion above is to remove the locally finite assumption.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"761203\">Vlad Tsyrklevich</span> <a href=\"#narrow/channel/252551-graph-theory/topic/IsRegularOfDegree.20without.20DecidableRel/near/566152508\">said</a>:</p>\n<blockquote>\n<p>Defining it using edegree is odd anyway given that you can't use IsRegularOfDegree for infinite graphs anyway.</p>\n</blockquote>\n<p>Why not? The Hasse graph of <code>ℤ</code> (infinite path graph) is 2-regular.<br>\nAssuming you meant non-locally-finite, then I agree but as OP notes it's annoying to have to provide both <code>Fintype</code> for the neighbors of every vertex and then also a degree proof.</p>",
        "id": 566156267,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1767452962
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SimpleGraph.dist#doc\">docs#SimpleGraph.dist</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SimpleGraph.diam#doc\">docs#SimpleGraph.diam</a> are defined using <code>ENat</code>, and I really like that approach.<br>\nAlso it's useful for me to be able to talk about degrees being infinite.</p>",
        "id": 566156387,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1767453116
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"761203\">Vlad Tsyrklevich</span> <a href=\"#narrow/channel/252551-graph-theory/topic/IsRegularOfDegree.20without.20DecidableRel/near/566152944\">said</a>:</p>\n<blockquote>\n<p>It works on the current lean playground? <code>#synth G.LocallyFinite</code> returns something in CategoryTheory though.</p>\n</blockquote>\n<p>To solve the specific <code>Finite</code> issue, we can add:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">LocallyFinite</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">classical</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">ofFinite</span><span class=\"w\"> </span><span class=\"n\">V</span>\n<span class=\"w\">  </span><span class=\"n\">infer_instance</span>\n</code></pre></div>",
        "id": 566156618,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1767453392
    },
    {
        "content": "<p>don't make it a global instance I think</p>",
        "id": 566157639,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1767454561
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"761203\">Vlad Tsyrklevich</span> <a href=\"#narrow/channel/252551-graph-theory/topic/IsRegularOfDegree.20without.20DecidableRel/near/566152508\">said</a>:</p>\n<blockquote>\n<p>Assuming you meant non-locally-finite, then I agree but as OP notes it's annoying to have to provide both <code>Fintype</code> for the neighbors of every vertex and then also a degree proof.</p>\n</blockquote>\n<p>Yes, sorry: I should have said infinite-degree graphs. To prove something is regular with degree n, you will anyways need to show the degree is finite so you get a local finiteness proof for free, no?</p>",
        "id": 566157667,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1767454592
    },
    {
        "content": "<p>I'm not against ENat (I like being able to work with infinite graphs as well), but the definition of edegree could then just live in a separate file. In this case, we also have a way of talking about infinite degree (e.g. \\not LocallyFinite) though you don't get any algebraic properties out of it like you do with ENat. I'm not sure how often you want addition or multiplication versus just max though?</p>",
        "id": 566157790,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1767454744
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"761203\">Vlad Tsyrklevich</span> <a href=\"#narrow/channel/252551-graph-theory/topic/IsRegularOfDegree.20without.20DecidableRel/near/566157667\">said</a>:</p>\n<blockquote>\n<p>To prove something is regular with degree n, you will anyways need to show the degree is finite so you get a local finiteness proof for free, no?</p>\n</blockquote>\n<p>But you can't even state the theorem without first adding an instance of <code>LocallyFinite</code>. This may be fixed if we change <code>IsRegularOfDegree</code> to <code>∃ (_ : G.LocallyFinite), ∀ v, G.degree v = k</code></p>",
        "id": 566160024,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1767456811
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"761203\">Vlad Tsyrklevich</span> <a href=\"#narrow/channel/252551-graph-theory/topic/IsRegularOfDegree.20without.20DecidableRel/near/566157790\">said</a>:</p>\n<blockquote>\n<p>I'm not against ENat (I like being able to work with infinite graphs as well), but the definition of edegree could then just live in a separate file.</p>\n</blockquote>\n<p>Okay, so do you support changing <code>degree</code> to drop the <code>Fintype</code>? Using <code>Set.ncard</code> instead of <code>Finset.card</code>?</p>",
        "id": 566160157,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1767456925
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"933054\">Snir Broshi</span> <a href=\"#narrow/channel/252551-graph-theory/topic/IsRegularOfDegree.20without.20DecidableRel/near/566160157\">said</a>:</p>\n<blockquote>\n<p>Okay, so do you support changing <code>degree</code> to drop the <code>Fintype</code>? Using <code>Set.ncard</code> instead of <code>Finset.card</code>?</p>\n</blockquote>\n<p>No strong opinion one way or the other.</p>",
        "id": 566165751,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1767462702
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/252551-graph-theory/topic/IsRegularOfDegree.20without.20DecidableRel/near/566157639\">said</a>:</p>\n<blockquote>\n<p>don't make it a global instance I think</p>\n</blockquote>\n<p>Oh wow it's not a Prop! We should rename SimpleGraph.LocallyFinite to SimpleGraph.LocallyFintype and then add the correct proposition SimpleGraph.LocallyFinite .</p>",
        "id": 566167765,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1767464735
    }
]