[
    {
        "content": "<p>Hello there.</p>\n<p>I'm very new to Lean (and mathematics - I'm a materials scientist by training), and I saw that, while there are a couple of graph implementations in <code>mathlib</code>, there weren't any implementations of hypergraphs. I figured it could be a good project to try to formalize hypergraphs, getting to know Lean better and also potentially creating something useful for my research (hypergraphs happen to be quite useful for the area of chemistry that I work on).</p>\n<p>I've got an initial implementation and some properties worked out. Before I got deeper on proofs, conversions between types, etc., I thought I should get some feedback from folks who actually know what they're doing.</p>\n<p>The full code can be found <a href=\"https://github.com/espottesmith/mathlib4/blob/undirhyper/Mathlib/Combinatorics/Hypergraph/Basic.lean\">here</a>.  My basic definition, which is heavily inspired by <span class=\"user-mention\" data-user-id=\"329425\">@Peter Nelson</span> and Jun Kwon's work on <code>Mathlib.Combinatorics.Graph</code>, is below:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The vertex set -/</span>\n<span class=\"w\">  </span><span class=\"n\">vertexSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The hyperedge predicate: a set of vertices `s : Set α` is contained in a hyperedge `e`. -/</span>\n<span class=\"w\">  </span><span class=\"n\">IsHyperedge</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- Incidence predicate stating that a vertex `x` is a member of hyperedge `e` -/</span>\n<span class=\"w\">  </span><span class=\"n\">IsIncident</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IsHyperedge</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The hyperedge set -/</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedgeSet</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">vertexSet</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IsHyperedge</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- A hyperedge contains only one set of vertices -/</span>\n<span class=\"w\">  </span><span class=\"n\">eq_of_isHyperedge_of_isHyperedge</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">⦃</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">⦄,</span><span class=\"w\"> </span><span class=\"n\">IsHyperedge</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">IsHyperedge</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">t</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- If some vertex `x` is incident on an edge `e`, then `x ∈ V` -/</span>\n<span class=\"w\">  </span><span class=\"n\">mem_of_isIncident</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">⦃</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">⦄,</span><span class=\"w\"> </span><span class=\"n\">IsIncident</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">vertexSet</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- Vertices can be incident on a hyperedge `e` if and only if `e` is in the hyperedge set. -/</span>\n<span class=\"w\">  </span><span class=\"c1\">-- TODO: should this be based on IsIncident?</span>\n<span class=\"w\">  </span><span class=\"c1\">-- If so, then we'd be definine hyperedges to be non-empty</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedge_mem_iff_exists_isHyperedge</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">hyperedgeSet</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">vertexSet</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IsHyperedge</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">Iff</span><span class=\"bp\">.</span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"sd\">/--</span>\n<span class=\"sd\">  If a set of vertices `s` is contained in a hyperedge `e`, then all elements `x ∈ s` are</span>\n<span class=\"sd\">  incident on `e` and all elements in `V \\ s` are not incident on `e`</span>\n<span class=\"sd\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">isIncident_and_not_isIncident_of_isHyperedge</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">⦃</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">⦄,</span><span class=\"w\"> </span><span class=\"n\">IsHyperedge</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IsIncident</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">vertexSet</span><span class=\"w\"> </span><span class=\"bp\">\\</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"n\">IsIncident</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 534271715,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755105243
    },
    {
        "content": "<p>(disclaimer: I'm also new to Lean)<br>\nLooks cool, and seems based on the existing <code>Graph</code>, but I'm not sure what's the advantage of all these axioms as opposed to:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedgeSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>or maybe</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">vertexSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedgeSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>which is what it looks to me you're trying to model with <code>IsHyperedge</code> and <code>IsIncident</code>.<br>\nMaybe the authors of the relatively new <code>Graph</code> (Peter Nelson &amp; Kyle Miller) can explain the advantages which I'm not seeing (not sure if tagging people is considered rude or not)<br>\n<a href=\"#narrow/stream/144837-PR-reviews/topic/.2324122.20Multigraphs\">This</a> is the original discussion about <code>Multigraph</code></p>",
        "id": 534293714,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1755114330
    },
    {
        "content": "<p>What do you think of this alternate version of the last axiom:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"n\">isIncident_and_not_isIncident_of_isHyperedge</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">⦃</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">⦄,</span><span class=\"w\"> </span><span class=\"n\">IsHyperedge</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">vertexSet</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">IsIncident</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>\n<p>It's almost equivalent, the current version allows <code>s</code> to have elements which are not vertices</p>",
        "id": 534295080,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1755114969
    },
    {
        "content": "<p>Originally, I had a similar definition:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">vertexSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedgeSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">β</span>\n<span class=\"w\">  </span><span class=\"n\">IsIncident</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n</code></pre></div>\n<p>(your definition is even simpler, which is nice in a sense).</p>\n<p>First, why two types (α and β). This comes down to flexibility (maybe a user has a separate object they want to treat as a hyperedge, for some reason) but also downstream applications. Often, in hypergraph theory we want to think about an <em>incidence matrix</em>. Having two types makes conversion into a matrix (which needs two index types) very natural.</p>\n<p>In terms of why I included so many axioms, this is a big part of why I wanted to ask here for advice. <code>Graph</code> uses this approach (I think) with the logic that it makes creating a hypergraph initially more annoying but makes downstream proofs more facile. But <code>DiGraph</code> and <code>SimpleGraph</code> take an approach more similar to what you suggest. I'm not knowledgable enough to be confident that one is better than the other.</p>",
        "id": 534295269,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755115056
    },
    {
        "content": "<p>Does my current definition allow non-vertex elements? Since <code>left_mem_of_isIncident</code>... I guess you mean that, with that one axiom alone, that isn't guaranteed, which is valid.</p>",
        "id": 534295442,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755115136
    },
    {
        "content": "<p>I definitely like that your version of <code>isIncident_and_not_isIncident_of_isHyperedge</code> is more concise. Given the structure, though, I think it'd be better named something like <code>isIncident_of_isHyperedge</code> or  some such.</p>",
        "id": 534295773,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755115268
    },
    {
        "content": "<p>Do appreciate being able to label the hyperedges with extra data in addition to what it is incident to especially if want multiple with the same incidence distinguished by those labels</p>",
        "id": 534322910,
        "sender_full_name": "Ammar Husain",
        "timestamp": 1755131078
    },
    {
        "content": "<p>Oh labeling sounds useful, and it also allows \"parallel\" hyperedges.<br>\nIn that case I like the <code>vertexSet</code> + <code>hyperedgeSet</code> + <code>IsIncident</code> definition.<br>\nTwo questions I have about it:</p>\n<ol>\n<li><code>Set α</code> is actually <code>α → Prop</code>, so <code>toHyperedge : β → Set α</code> is equivalent to <code>IsIncident : α → β → Prop</code> but might be more readable: a hyperedge is a set of vertices, like in the literature</li>\n<li>Since sets can be types (they're auto-coerced to <code>Subtype</code>) why separate <code>α</code> from <code>vertexSet</code> and <code>β</code> from <code>hyperedgeSet</code>? We can:</li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">vertices</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedges</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span>\n<span class=\"w\">  </span><span class=\"n\">IsIncident</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">vertices</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">hyperedges</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n</code></pre></div>\n<p>or</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedges</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span>\n<span class=\"w\">  </span><span class=\"n\">IsIncident</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">hyperedges</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n</code></pre></div>\n<p>It even makes the incidence matrix more straightforward, no sets involved.</p>",
        "id": 534324285,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1755132318
    },
    {
        "content": "<p>You don’t want vertices to be a Type. You want them to be <code>Set V</code></p>",
        "id": 534449816,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1755166783
    },
    {
        "content": "<p>Sets are far more convenient to work with than types</p>",
        "id": 534449854,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1755166799
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"947608\">@Ammar Husain</span> <span class=\"user-mention\" data-user-id=\"466334\">@Shreyas Srinivas</span>, do y'all have opinions about having a stripped down definition (e.g., with just <code>vertexSet</code>, <code>hyperedgeSet</code>, and some combination of <code>IsIncident</code> and <code>IsHyperedge</code>) vs. having multiple axioms in the definition?</p>",
        "id": 534476735,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755175872
    },
    {
        "content": "<p>I personally think if you want to label hyperedges, it makes sense to extend </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">vertexSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedgeSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 534512310,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1755187064
    },
    {
        "content": "<p>you want the vertexSet to avoid creating a separate type for subhypergraphs and then face the annoying issue of proving lemmas for subhypergraphs that apply to all hypergraphs through tedious coercions</p>",
        "id": 534512438,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1755187105
    },
    {
        "content": "<p>In that case, you'd want to have a guarantee that all <code>α</code> in a hyperedge were in the vertex set / each hyperedge is a subset of <code>vertexSet</code>, right?</p>",
        "id": 534512774,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755187204
    },
    {
        "content": "<p>yes</p>",
        "id": 534512816,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1755187215
    },
    {
        "content": "<p>See the definition of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SimpleGraph.Subgraph#doc\">docs#SimpleGraph.Subgraph</a></p>",
        "id": 534512852,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1755187226
    },
    {
        "content": "<p>you don't need <code>adj_sub {v w : V} : self.Adj v w → G.Adj v w</code></p>",
        "id": 534513011,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1755187271
    },
    {
        "content": "<p>and you don't need edge.symm because it makes no sense here</p>",
        "id": 534513049,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1755187281
    },
    {
        "content": "<p>Word, that's helpful feedback. I'll get started cleaning up my code.</p>\n<p>Yeah, of course, symmetry isn't relevant here.</p>",
        "id": 534513183,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755187319
    },
    {
        "content": "<p>How does this look?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The vertex set -/</span>\n<span class=\"w\">  </span><span class=\"n\">vertexSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The hyperedge set -/</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedgeSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- Incidence predicate stating that a vertex `x` is a member of hyperedge `e` -/</span>\n<span class=\"w\">  </span><span class=\"n\">IsIncident</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">hyperedgeSet</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">e</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- All hyperedges must be subsets of the vertex set -/</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedge_isSubset_vertexSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">⦃</span><span class=\"n\">e</span><span class=\"o\">⦄,</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">hyperedgeSet</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">vertexSet</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- If something is incident on a hyperedge, then it must be in the vertex set -/</span>\n<span class=\"w\">  </span><span class=\"n\">vertex_mem_if_isIncident</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">⦃</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">⦄,</span><span class=\"w\"> </span><span class=\"n\">IsIncident</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">vertexSet</span>\n</code></pre></div>",
        "id": 534515805,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755188205
    },
    {
        "content": "<p>Oh, there's one annoyance (so far). If hyperedges are just <code>Set α</code>, then defining the dual of a hypergraph becomes annoying.</p>\n<p>If  <code>H = (V, E)</code>, then the dual <code>H* = (E, V)</code>, and incidence is defined such that if a vertex <code>v ∈ V</code> was incident on <code>e ∈ E</code> in H, then <code>e</code> is incident on <code>v</code> in <code>H*</code>.</p>\n<p>In the current system, <code>dual(H : Hypergraph α)</code> would create a hypergraph of type <code>Hypergraph (Set α)</code>... which would then have a hyperedge set of type <code>Set (Set α)</code>. So, then you wouldn't have the property that <code>dual(dual(H)) = H</code>; rather, you'd have growing numbers of nested sets.</p>",
        "id": 534522618,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755190114
    },
    {
        "content": "<p>This makes me want to stick with having a <code>β</code> type for hyperedges (unless I'm missing some way to avoid this awkwardness with duals)</p>",
        "id": 534523257,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755190361
    },
    {
        "content": "<p>so one thing avoiding beta was for was to prevent parallel edges, should there be a proof that for every pair of such they are not the same adjacencies?</p>",
        "id": 534524077,
        "sender_full_name": "Ammar Husain",
        "timestamp": 1755190670
    },
    {
        "content": "<p>IsIncident is not serving any purpose</p>",
        "id": 534533234,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1755194087
    },
    {
        "content": "<p>You have merely assigned it a default value. This does not constrain the relation to be defined this way</p>",
        "id": 534533399,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1755194134
    },
    {
        "content": "<p>I am not on a laptop and it isn’t convenient to type lean on a phone. What you want is to convert the last field to <code>(\\exists e \\in hyperEdgeSet, v \\in e  -&gt; v \\in vertex Set</code></p>",
        "id": 534533836,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1755194291
    },
    {
        "content": "<p>Ah, I misunderstood the syntax on <code>IsIncident</code> (as I said, quite new to Lean).</p>\n<p>So, given that <code>IsIncident</code> isn't needed, we're talking about something like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The vertex set -/</span>\n<span class=\"w\">  </span><span class=\"n\">vertexSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The hyperedge set -/</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedgeSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- All hyperedges must be subsets of the vertex set -/</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedge_isSubset_vertexSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">⦃</span><span class=\"n\">e</span><span class=\"o\">⦄,</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">hyperedgeSet</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">vertexSet</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- If something is incident on a hyperedge, then it must be in the vertex set -/</span>\n<span class=\"w\">  </span><span class=\"n\">vertex_mem_if_mem_hyperedge</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">⦃</span><span class=\"n\">x</span><span class=\"o\">⦄,</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">hyperedgeSet</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">vertexSet</span>\n</code></pre></div>",
        "id": 534538721,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755196246
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 534550118,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1755201319
    },
    {
        "content": "<p>I was right in my deleted message. The fourth field is implied by the third field</p>",
        "id": 534553854,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1755202938
    },
    {
        "content": "<p>If all hyperedges are subsets of the vertex set, then every vertex edge in a hyperedge is surely in the vertex set by definition.</p>",
        "id": 534554004,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1755202992
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"466334\">Shreyas Srinivas</span> <a href=\"#narrow/channel/252551-graph-theory/topic/.28Undirected.29.20hypergraphs/near/534553854\">said</a>:</p>\n<blockquote>\n<p>I was right in my deleted message. The fourth field is implied by the third field</p>\n</blockquote>\n<p>no it's not, since you can set <code>hyperedgeSet := ∅</code></p>",
        "id": 534555341,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755203534
    },
    {
        "content": "<p>oh is there a missing parentheses around the exists here?</p>",
        "id": 534555611,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755203653
    },
    {
        "content": "<p>If that was supposed to be <code>∀ ⦃x⦄, (∃ e ∈ hyperedgeSet, x ∈ e) → x ∈ vertexSet</code> then yes, it's equivalent to the third condition.</p>",
        "id": 534555696,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755203693
    },
    {
        "content": "<p>So, it's better that I prove the fourth condition based on the third?</p>",
        "id": 534556144,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755203886
    },
    {
        "content": "<p>you have a very weird statement of the fourth condition</p>",
        "id": 534556256,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755203924
    },
    {
        "content": "<p>it's also just two rewrites away from the third condition</p>",
        "id": 534556295,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755203942
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=exists_imp#doc\">docs#exists_imp</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Set.subset_def#doc\">docs#Set.subset_def</a></p>",
        "id": 534556355,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755203969
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/252551-graph-theory/topic/.28Undirected.29.20hypergraphs/near/534556355\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=exists_imp#doc\">docs#exists_imp</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Set.subset_def#doc\">docs#Set.subset_def</a></p>\n</blockquote>\n<p>Appreciate the pointer here.</p>",
        "id": 534556613,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755204024
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/stream/252551-graph-theory/topic/.28Undirected.29.20hypergraphs/near/534556256\">said</a>:</p>\n<blockquote>\n<p>you have a very weird statement of the fourth condition</p>\n</blockquote>\n<p>It was my fault. I first worked to remove the unnecessary <code>IsIncident</code> field which was being used in what was then the fifth field.  Basically I was debugging one step at a time.</p>",
        "id": 534558016,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1755204673
    },
    {
        "content": "<p>What happened with want to stick with having a \\beta type?</p>",
        "id": 534687875,
        "sender_full_name": "Ammar Husain",
        "timestamp": 1755279038
    },
    {
        "content": "<p>Sorry, just saw this.</p>\n<p>So, I still kind of like having the <code>β</code> type for hyperedges. I think it makes the hypergraph definition somewhat more general. But I've also come to the conclusion, having now made some additional definitions and lemmas both with hyperedges as <code>β</code> and with hyperedges as <code>Set α</code>,  that the former is more cumbersome.</p>\n<p>With <code>β</code>, you need to not only carry around vertices and hyperedges but also the sets of vertices associated with each hyperedge. You also need to be able to prove additional properties in order to create a hypergraph (see my original definition, though of course it's possible that some of the implications that I had weren't strictly necessary).</p>\n<p>In contrast, with <code>Set α</code>, as <span class=\"user-mention\" data-user-id=\"466334\">@Shreyas Srinivas</span> helped me see, you can get away with just:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The vertex set -/</span>\n<span class=\"w\">  </span><span class=\"n\">vertexSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The hyperedge set -/</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedgeSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- All hyperedges must be subsets of the vertex set -/</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedge_isSubset_vertexSet</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">⦃</span><span class=\"n\">e</span><span class=\"o\">⦄,</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">hyperedgeSet</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">vertexSet</span>\n</code></pre></div>\n<p>and then it's pretty easy to define things like a partial hypergraph:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/--</span>\n<span class=\"sd\">Given a subset of the hyperedge set `E(H)` of a hypergraph `H` (`l : Set (Set α)`), the</span>\n<span class=\"sd\">*partial hypergraph* `Hˡ` has `E(Hˡ) = l ∩ E(H)` and `V(Hˡ)` is the subset of `V(H)` which is</span>\n<span class=\"sd\">incident on at least one hyperedge in `E(Hˡ)`.</span>\n<span class=\"sd\">-/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">partialHypergraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Hypergraph</span><span class=\"bp\">.</span><span class=\"n\">mk</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">∩</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">hq</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">hx</span>\n<span class=\"w\">      </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">q</span>\n<span class=\"w\">      </span><span class=\"n\">constructor</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">mem_of_mem_inter_left</span><span class=\"w\"> </span><span class=\"n\">hq</span>\n<span class=\"w\">      </span><span class=\"n\">constructor</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">mem_of_mem_inter_right</span><span class=\"w\"> </span><span class=\"n\">hq</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hx</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h0</span>\n<span class=\"w\">  </span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 534950270,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755523024
    },
    {
        "content": "<p>If you do plan to put this in a repository somewhere, please let us know! I'm also tangentially involved with hypergraphs, so seeing some theorems on them formalized would be great.</p>\n<p>(You can also golf down <code>partialHypergraph</code> a little):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">partialHypergraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">vertexSet</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedgeSet</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">∩</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedge_isSubset_vertexSet</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">hq</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">q</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hq</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hq</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"bp\">⟩</span>\n</code></pre></div>",
        "id": 534957741,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1755525434
    },
    {
        "content": "<p>I'm planning on submitting a PR to <code>mathlib</code>. I just wanted to sort out the general design here first so that I didn't waste any of the maintainers' time.</p>\n<p>If you're interested in contributing, I can get a work-in-progress PR out sooner rather than later.</p>",
        "id": 534980690,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755532631
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"767695\">Tristan Figueroa-Reid</span> <a href=\"#narrow/channel/252551-graph-theory/topic/.28Undirected.29.20hypergraphs/near/534957741\">said</a>:</p>\n<blockquote>\n<p>If you do plan to put this in a repository somewhere, please let us know! I'm also tangentially involved with hypergraphs, so seeing some theorems on them formalized would be great.</p>\n<p>(You can also golf down <code>partialHypergraph</code> a little):</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">partialHypergraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">vertexSet</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedgeSet</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">∩</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">hyperedge_isSubset_vertexSet</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">hq</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">q</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hq</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hq</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"bp\">⟩</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>And I'm sure most of my proofs are on the inefficient side... definitely appreciate your suggestion.</p>",
        "id": 534980962,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755532719
    },
    {
        "content": "<p>Opened this PR: <a href=\"https://github.com/leanprover-community/mathlib4/pull/28613\">https://github.com/leanprover-community/mathlib4/pull/28613</a></p>",
        "id": 535021822,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755551067
    },
    {
        "content": "<p>This is nice to see, I have a pretty substantial development of hypergraph theory in a private repo, so I'm glad to see this discussion converged on the same definition that I had. I'll take a closer look at your PR tomorrow, thanks for making it.</p>",
        "id": 535034513,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1755560166
    },
    {
        "content": "<p>Of course! Any feedback (or additions, if there's code you can share) is welcome.</p>",
        "id": 535035998,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1755561248
    },
    {
        "content": "<p>Okay, so, my <a href=\"https://github.com/leanprover-community/mathlib4/pull/28613\">original Hypergraph PR</a> is still in progress, but I've been continuing working in the background.</p>\n<p>One thing that I'm a bit stuck on is defining walks on hypergraphs. <code>SimpleGraph</code> uses an inductive type:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Walk</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">nil</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Walk</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">u</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">Adj</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Walk</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Walk</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">w</span>\n<span class=\"w\">  </span><span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">DecidableEq</span>\n</code></pre></div>\n<p>where <code>Walk u v</code> is the type of all walks from <code>u</code> to <code>v</code>.</p>\n<p>and you could do something similar for hypergraphs:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Walk</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">nil</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Walk</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">he</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"o\">))</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hxy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Walk</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Walk</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">z</span>\n</code></pre></div>\n<p>This isn't quite as pretty because, while a graph's walk depends only on the string of vertices, here the identity of the hyperedge matters (this is why I have the three hypotheses <code>(he : e ∈ E(H))\n    (hx : x ∈ e) (hy : y ∈ e)</code> instead of just <code>(h : H.Adj x y)</code>).</p>\n<p>It seemed simpler to me to just represent a walk as <code>List (α × Set α)</code>, with a sort of validator predicate</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsWalk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Hypergraph</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">[]</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">True</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"o\">[]</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">∅</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"bp\">.</span><span class=\"n\">IsWalk</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">W</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Is there a benefit to going with the new inductive type that I'm just not seeing?</p>",
        "id": 538094745,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1757266708
    },
    {
        "content": "<p>The main important difference is that nil walk doesn't have a vertex associated with. This means, that if you want to define <code>source</code> and <code>target</code> of a walk, you have to either return Option, or accept proof that walk is not nil, or use <code>[Inhabited V]</code>.</p>\n<p>Maybe you could try <code>α × List (α × Set α)</code> instead?</p>\n<p>I was experimenting (not much yet though) with this definition of Walk for SimpleGraph. With the current definition, I've had some problems with type checker, because source and target vertex are part of the type.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">}</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"bp\">.</span><span class=\"n\">IsWalk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">nil</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsWalk</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">[]</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">es</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)},</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">Adj</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"bp\">.</span><span class=\"n\">IsWalk</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">es</span><span class=\"w\"> </span><span class=\"bp\">→</span>\n<span class=\"w\">    </span><span class=\"n\">SimpleGraph</span><span class=\"bp\">.</span><span class=\"n\">IsWalk</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">u</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"n\">es</span><span class=\"o\">)</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"bp\">.</span><span class=\"n\">IsWalk'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">nil</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">True</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">u'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"n\">es</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">u'</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">Adj</span><span class=\"w\"> </span><span class=\"n\">u'</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"bp\">.</span><span class=\"n\">IsWalk'</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">es</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"bp\">.</span><span class=\"n\">IsWalk</span><span class=\"bp\">.</span><span class=\"n\">iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">es</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">IsWalk</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">es</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">IsWalk'</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">es</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"bp\">.</span><span class=\"n\">Walk2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"bp\">.</span><span class=\"n\">IsWalk</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>\n<p>I've tried using inductive Prop definition to avoid <code>u = u'</code>, but I'm not sure whether it's better or not like that.</p>",
        "id": 538180280,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1757325283
    },
    {
        "content": "<p>Your <code>α × List (α × Set α)</code> suggestion is a good one. I can totally see the <code>nil</code> checking becoming quite onerous.</p>\n<p>And I'm glad that I'm not the only one who's had some issues with the inductive <code>Walk</code> definitions and related derivations.</p>",
        "id": 538187852,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1757327615
    },
    {
        "content": "<p>Just came across this thread, and thought I'd mention that I've done a bunch of work formalising design theory/hypergraphs in Isabelle (<a href=\"https://www.isa-afp.org/authors/edmonds/\">https://www.isa-afp.org/authors/edmonds/</a>). Could be interesting to compare!  I'm playing around with Lean as well, so am hoping to port a few things across/try out some new proofs on some point, would be open to connecting with existing lean developments on it!</p>",
        "id": 539031627,
        "sender_full_name": "Chelsea Edmonds",
        "timestamp": 1757673149
    },
    {
        "content": "<p>Ah! Thank you for sharing this! I hadn't realized that others had formalized hypergraphs. I will take a look at your work and probably come back with questions.</p>\n<p>I link to the PR that I wrote (using some modified versions of <span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span>'s code) above. If you have thoughts/feedback, I'd love to hear it!</p>",
        "id": 539068432,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1757684389
    },
    {
        "content": "<p>Questions very welcome! Isabelle tends to be fairly readable online, but know there are some notable differences to Lean that can affect the approach - Bhavik and I have discussed in the past :) I'd note that on my end the design theory library was significantly more developed then the hypergraph work, but both modelled as incidence set systems at the end of the day so a lot would translate really easily (the hypergraph library basically showed how to translate a few concepts I needed across and I think overlaps with most of your initial PR). The design theory libraries include a lot of the concepts you've listed as future work (incidence matrices - which in hindsight I would do a different way, lots of variation on design types, dual designs etc).</p>",
        "id": 539072487,
        "sender_full_name": "Chelsea Edmonds",
        "timestamp": 1757685511
    },
    {
        "content": "<p>Yeah, I suppose I'll have to look at the Isabelle design theory work to fully understand what you've done with hypergraphs.</p>",
        "id": 539074112,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1757685932
    },
    {
        "content": "<p>Yeah its pretty interconnected!</p>",
        "id": 539074690,
        "sender_full_name": "Chelsea Edmonds",
        "timestamp": 1757686100
    },
    {
        "content": "<p>I'm not actively working on formal maths projects at the moment (this was all from my PhD), but hopefully will have a little time for it again later this year once I start a new job so will definitely try out/have a closer look at your Lean library too then :)</p>",
        "id": 539075429,
        "sender_full_name": "Chelsea Edmonds",
        "timestamp": 1757686278
    },
    {
        "content": "<p>Well, congrats on the new job. I hope the transition goes smoothly!</p>",
        "id": 539077486,
        "sender_full_name": "Evan Walter Clark Spotte-Smith",
        "timestamp": 1757686819
    }
]