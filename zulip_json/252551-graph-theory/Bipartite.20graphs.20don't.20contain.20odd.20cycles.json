[
    {
        "content": "<p>Hi all,</p>\n<p>over the holidays I started learning Lean and worked through the statement</p>\n<blockquote>\n<p>theorem isBipartite_no_odd_cycle :<br>\n    G.IsBipartite ‚Üí ‚àÄ n : ‚Ñï, (SimpleGraph.cycleGraph (2*(n+1)+1)).Free G :=<br>\n</p>\n</blockquote>\n<p>which corresponds to one of the TODOs on the documentation page for <code>IsBipartite</code>. Since this is my first Lean project, the proof is still a bit chaotic, but the approach seems to work. If this direction is something mathlib would like to include, I‚Äôd be very happy to clean up the argument, pursue the backward implication as well, and eventually prepare a PR to fill in the missing pieces. I‚Äôd appreciate any feedback on whether this would be useful and how best to integrate it into the existing API.</p>",
        "id": 566182754,
        "sender_full_name": "Simon Strzoda",
        "timestamp": 1767481263
    },
    {
        "content": "<p>Hi!</p>\n<p>I also worked on this to learn Lean. :D</p>\n<p>There was already quite a lot of discussion about this:<br>\n<a class=\"stream-topic\" data-stream-id=\"217875\" href=\"/#narrow/channel/217875-Is-there-code-for-X.3F/topic/bipartite.20iff.20does.20not.20contain.20an.20odd.20cycle/with/565095054\">#Is there code for X? &gt; bipartite iff does not contain an odd cycle</a> <br>\n<a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/Formalizing.20Graph.20Theory.20-.20The.20Odd.20Cycle.20Theorem.20in.20Lean/with/566010484\">#mathlib4 &gt; Formalizing Graph Theory - The Odd Cycle Theorem in Lean</a> </p>\n<p>Would you like to share what was your approach? I'll be interested in it.</p>",
        "id": 566182895,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1767481509
    },
    {
        "content": "<p>Ah, you only proved this one implication. The other implication is I think harder and isn't yet proved in mathlib. <code>‚àÄ n : ‚Ñï, (SimpleGraph.cycleGraph (2*(n+1)+1)).Free G</code> is equivalent to <code>‚àÄ w : G.Walk u u, w.IsCycle ‚Üí Even w.length</code>. We already have even more general <code>G.IsBipartite ‚Üí (‚àÄ w : G.Walk u u, Even w.length)</code> in mathlib: <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Combinatorics/SimpleGraph/ConcreteColorings.html#SimpleGraph.two_colorable_iff_forall_loop_even\">SimpleGraph.two_colorable_iff_forall_loop_even</a></p>",
        "id": 566183215,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1767481989
    },
    {
        "content": "<p>We also have <code>(‚àÄ w : G.Walk u u, Even w.length) ‚Üí G.IsBipartite</code>. And what we doesn't have (yet merged) is <code>(‚àÄ w : G.Walk u u, w.IsCycle ‚Üí Even w.length) ‚Üí G.IsBipartite</code>, which is a very similar to <code>(‚àÄ n : ‚Ñï, (SimpleGraph.cycleGraph (2*(n+1)+1)).Free G) ‚Üí G.IsBipartite</code>.</p>",
        "id": 566183280,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1767482082
    },
    {
        "content": "<p>Hi Jakub, thanks for the quick reply!</p>\n<p>At a high level, my approach for the direction I proved was to assume, for contradiction, that the graph contains an odd cycle and admits a coloring. From there, I showed that any coloring of a cycle must be <em>alternating</em>, and then used these two facts to conclude that two adjacent vertices must receive the same color‚Äîcontradicting the assumption that the graph is colorable.</p>\n<p>For the other direction, I planned to first handle the special case of connected graphs and then generalize to arbitrary graphs. To construct the coloring, I was considering the ‚Äúshortest‚Äëpath parity coloring‚Äù. To show that this assignment is indeed a coloring, i.e. a graph homomorphism</p>\n<blockquote>\n<p>(SimpleGraph.Hom G (completeGraph (Fin 2))</p>\n</blockquote>\n<p>I would need to show that adjacent vertices in <code>G</code> map to adjacent vertices in <code>completeGraph (Fin 2)</code>. My idea was to assume, for contradiction, that two adjacent vertices in <code>G</code> receive the same color, then use the walks arising from the shortest‚Äëpath construction to build an odd cycle in <code>G</code>, contradicting the assumption that <code>G</code> is odd‚Äëcycle‚Äëfree.</p>\n<p>Thanks again for the helpful reply! It seems the main ideas are already well covered, so I won‚Äôt pursue this direction further, but I really appreciated the insights. :)</p>",
        "id": 566184611,
        "sender_full_name": "Simon Strzoda",
        "timestamp": 1767484156
    },
    {
        "content": "<p>About the discussion, I already had a PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/33257\">#33257</a> proved by bypass in Mathlib. But I do not know what the PR should be used for. It's really that I cannot just upload a PR as a file storage, but I do not have the permission to  merge it into Mathlib. \"Merging is blocked: You're not authorized to push to this branch.\" That is what GitHub show me.</p>\n<p>Maybe the most I can do is inspiring some new idea here in Zulip. Feel free to check if you think it is usable.</p>",
        "id": 566193696,
        "sender_full_name": "Nick Adfor",
        "timestamp": 1767496313
    },
    {
        "content": "<p>There's also another work from Rida (<a class=\"stream-topic\" data-stream-id=\"252551\" href=\"/#narrow/channel/252551-graph-theory/topic/Girth.20and.20Diameter.20Proof/with/566063578\">#graph theory &gt; Girth and Diameter Proof</a> ). Rida has a private definition about takeAt which I haven't checked carefully.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"877182\">Nick Adfor</span> <a href=\"#narrow/channel/252551-graph-theory/topic/Girth.20and.20Diameter.20Proof/near/566011824\">said</a>:</p>\n<blockquote>\n<p>I've noticed that your <code>takeAt</code></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Walk</span><span class=\"bp\">.</span><span class=\"n\">takeAt</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">Walk</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">Walk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">getVert</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">getVert</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">((</span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">drop</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">take</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">copy</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">drop_getVert</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">sub_add_cancel</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>may introduce a new method to define lastCommonVertex in my post <a class=\"message-link\" href=\"/#narrow/channel/287929-mathlib4/topic/Formalizing.20Graph.20Theory.20-.20The.20Odd.20Cycle.20Theorem.20in.20Lean/near/565094255\">#mathlib4 &gt; Formalizing Graph Theory - The Odd Cycle Theorem in Lean @ üí¨</a> </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">lastCommonVertex</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">Walk</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">Walk</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">IsPath</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">IsPath</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hp_min</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">dist</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hq_min</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">dist</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>But as now your def Walk.takeAt cannot run as Nat.sub_add_cancel h showing</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Tactic</span><span class=\"w\"> </span><span class=\"ss\">`rewrite</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Did</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">find</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">occurrence</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">pattern</span>\n<span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">expression</span>\n<span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">getVert</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">getVert</span><span class=\"w\"> </span><span class=\"n\">j</span>\n</code></pre></div>\n<p>so I cannot finish my def.</p>\n</blockquote>",
        "id": 566193973,
        "sender_full_name": "Nick Adfor",
        "timestamp": 1767496841
    },
    {
        "content": "<p>For textbook proof, there's one from Introductory Combinatorics. But this relies on well-definition about lastCommonVertex, </p>\n<p><span class=\"user-mention silent\" data-user-id=\"877182\">Nick Adfor</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Formalizing.20Graph.20Theory.20-.20The.20Odd.20Cycle.20Theorem.20in.20Lean/near/565093974\">said</a>:</p>\n<blockquote>\n<p><a href=\"/user_uploads/3121/oZ4qzepx1Sw9OZMR9pxs1-ZK/c860c667-f601-4b81-ab2b-6f6d7b9cdd16.jpg\">precise and concise proof.jpg</a></p>\n</blockquote>\n<p>which <span class=\"user-mention\" data-user-id=\"870257\">@Jakub Nowak</span> pointed out that it might be wrong (lack a well-definition). Click the blue part to see the origin.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"870257\">Jakub Nowak</span> <a href=\"#narrow/channel/287929-mathlib4/topic/Formalizing.20Graph.20Theory.20-.20The.20Odd.20Cycle.20Theorem.20in.20Lean/near/565094255\">said</a>:</p>\n<blockquote>\n<p>I think that \"Since the first vertex of each of these walks is x there is a vertex z that is the last common vertex of these two walks\" is not true.<br>\nThis is because you can take the last vertex on the walk x‚ãØa that is common with the walk x‚ãØb, and you can take the last vertex on the walk x‚ãØb that is common with the walk x‚ãØa. And these two are not necessarily equal.</p>\n</blockquote>\n<p>Maybe (just maybe) Rida's takeAt can solve the problem. But these days I lack time to check them all. Maybe you can bring these work together :)</p>",
        "id": 566194104,
        "sender_full_name": "Nick Adfor",
        "timestamp": 1767497128
    },
    {
        "content": "<p>I took a look at <a href=\"https://github.com/leanprover-community/mathlib4/pull/33257\">#33257</a>, and I was thinking that maybe it is also nice to have the theorem <code>isBipartite_iff_all_loops_even : G.IsBipartite ‚Üî ‚àÄ (v : V) (c : G.Walk v v), Even c.length</code>, which I think it is also true</p>",
        "id": 566216648,
        "sender_full_name": "Iv√°n Renison",
        "timestamp": 1767526386
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"646655\">Iv√°n Renison</span> <a href=\"#narrow/channel/252551-graph-theory/topic/Bipartite.20graphs.20don't.20contain.20odd.20cycles/near/566216648\">said</a>:</p>\n<blockquote>\n<p>I took a look at <a href=\"https://github.com/leanprover-community/mathlib4/pull/33257\">#33257</a>, and I was thinking that maybe it is also nice to have the theorem <code>isBipartite_iff_all_loops_even : G.IsBipartite ‚Üî ‚àÄ (v : V) (c : G.Walk v v), Even c.length</code>, which I think it is also true</p>\n</blockquote>\n<p>We already do have this: <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Combinatorics/SimpleGraph/ConcreteColorings.html#SimpleGraph.two_colorable_iff_forall_loop_even\">SimpleGraph.two_colorable_iff_forall_loop_even</a></p>",
        "id": 566243599,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1767553954
    }
]