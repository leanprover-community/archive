[
    {
        "content": "<p>Now that we have digraphs in mathlib, what are the next steps to have things such as walks, paths, cycles, (in, out)-degrees, adjacency matrices, etc for digraphs? Do we plan to just redo these definitions from <code>SimpleGraph</code>s, or should we relate them in some way to their adjacent definitions in <code>SimpleGraph</code>?</p>",
        "id": 471248493,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726663113
    },
    {
        "content": "<p>My first guess would be to redo the definitions, and have lemmas relating them to the SimpleGraph versions where appropriate. For example, once we have the map sending a digraph to a simple graph which forgets orientations, construct the function from a walk in a digraph to a walk in the corresponding simple graph.</p>",
        "id": 471283845,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1726672426
    },
    {
        "content": "<p>It feels like a lot of duplication coming up ... Is the plan to refactor <code>SimpleGraph</code> now to say that a <code>SimpleGraph</code> is a <code>Digraph</code> where <code>Adj</code> is symmetric and has no self-loop? And then we could move to <code>Digraph</code> everything that is not dependent on these particular properties of <code>Adj</code>, typically the definition of <code>Path</code>.</p>",
        "id": 471288856,
        "sender_full_name": "Vincent Beffara",
        "timestamp": 1726673427
    },
    {
        "content": "<p>Does this \"orientation-forgetting\" map from <code>Digraph</code>s to <code>SimpleGraph</code>s look okay?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">toSimpleGraph</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Digraph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">Adj</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">‚â†</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">Adj</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">‚à®</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">Adj</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">h‚ÇÅ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">And</span><span class=\"bp\">.</span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Or</span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"bp\">‚Äπ_‚Ä∫</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Or</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"bp\">‚Äπ_‚Ä∫</span>\n<span class=\"w\">  </span><span class=\"n\">loopless</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 471306223,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726678353
    },
    {
        "content": "<p>My impression is that a copy paste and modify job will suffice</p>",
        "id": 471307217,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1726678702
    },
    {
        "content": "<p>At least for some of the basic files</p>",
        "id": 471307234,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1726678708
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"242586\">Vincent Beffara</span> <a href=\"#narrow/stream/252551-graph-theory/topic/Digraphs/near/471288856\">said</a>:</p>\n<blockquote>\n<p>It feels like a lot of duplication coming up ... Is the plan to refactor <code>SimpleGraph</code> now to say that a <code>SimpleGraph</code> is a <code>Digraph</code> where <code>Adj</code> is symmetric and has no self-loop? And then we could move to <code>Digraph</code> everything that is not dependent on these particular properties of <code>Adj</code>, typically the definition of <code>Path</code>.</p>\n</blockquote>\n<p>Yup, could do! That's definitely a sensible thing to try</p>",
        "id": 471307741,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1726678877
    },
    {
        "content": "<p>Thanks, I'll try porting some of the things from <code>SimpleGraph</code>s to <code>Digraphs</code> while taking these points into consideration.</p>",
        "id": 471309054,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726679328
    },
    {
        "content": "<p>Another point:<br>\nSince we are having an orientation-forgetting map, how can we formalize the opposite: an \"orientation\" of a <code>SimpleGraph</code>, which results in a <code>Digraphs</code>. I'm asking because I've seen this used often in literature, for instance, tournaments are often defined as an \"orientation of a complete simple graph\".</p>",
        "id": 471309057,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726679330
    },
    {
        "content": "<p>Is there a way to do this without having to \"choose\" the orientations</p>",
        "id": 471309151,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726679366
    },
    {
        "content": "<p>You can turn every edge into a pair of directed edges in opposite directions (and maybe this turns out to give a galois connection with the forgetful map). But otherwise you do need to specify the orientations in some way, for the notion to be well-defined up to isomorphisms on the vertex set</p>",
        "id": 471312382,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1726680508
    },
    {
        "content": "<p>Beware that there are two ways to forget orientation, you can have an unoriented edge if either orientation is present, or alternatively if both are present. I don‚Äôt know which one is more natural for applications. You did the first, but the second is more dual to Bhavik‚Äôs double orientation</p>",
        "id": 471315212,
        "sender_full_name": "Vincent Beffara",
        "timestamp": 1726681492
    },
    {
        "content": "<p>We should have both!</p>",
        "id": 471315627,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1726681648
    },
    {
        "content": "<p>there are other notions of adding orientation. For example a bfs tree with edges oriented towards the starting node, Sinkless orientations etc</p>",
        "id": 471316806,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1726682044
    },
    {
        "content": "<p>it might be nice to a generic way of orienting each undirected edge</p>",
        "id": 471316952,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1726682091
    },
    {
        "content": "<p>Maybe we can have an <code>Orientation.lean</code> file in the <code>SimpleGraph</code> (or <code>Digraph</code>?) folder that contains such orientations, and maybe it can contain the <code>Digraph.toSimpleGraph</code> function with some basic lemmas too.</p>",
        "id": 471318505,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726682600
    },
    {
        "content": "<p>According to <a href=\"https://en.wikipedia.org/wiki/Orientation_(graph_theory)\">https://en.wikipedia.org/wiki/Orientation_(graph_theory)</a>, an oriented graph is a <code>Digraph</code> such that none of its pairs of vertices is linked by two mutually symmetric edges. There are many different types of orientations and it would be nice to formalize some of this! It would come in handy once we want to formalize tournaments.</p>",
        "id": 471463945,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726745071
    },
    {
        "content": "<p>What do you think about defining it like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Digraph</span><span class=\"bp\">.</span><span class=\"n\">IsOriented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Digraph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">¬¨</span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">Adj</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"bp\">¬¨</span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">Adj</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">Adj</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Should oriented graphs contain self-loops or not?<br>\nI've found papers that assume they don't, and I think that is better for our purposes.</p>",
        "id": 471468852,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726746887
    },
    {
        "content": "<p>Equivalently, its \"strong\" map into a <code>SimpleGraph</code> is <code>bot</code></p>",
        "id": 471469439,
        "sender_full_name": "Vincent Beffara",
        "timestamp": 1726747105
    },
    {
        "content": "<p>What is a \"strong map\"?</p>",
        "id": 471469763,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726747204
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"242586\">Vincent Beffara</span> <a href=\"#narrow/stream/252551-graph-theory/topic/Digraphs/near/471315212\">said</a>:</p>\n<blockquote>\n<p>Beware that there are two ways to forget orientation, you can have an unoriented edge if either orientation is present, or alternatively if both are present. I don‚Äôt know which one is more natural for applications. You did the first, but the second is more dual to Bhavik‚Äôs double orientation</p>\n</blockquote>\n<p>I think Vincent is referring to the \"unoriented edge if both oriented edges are present\" map</p>",
        "id": 471470875,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1726747486
    },
    {
        "content": "<p>If we define oriented graphs in that way then we will be allowing them to have self-loops</p>",
        "id": 471471976,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726747845
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"580947\">Rida Hamadani</span> <a href=\"#narrow/stream/252551-graph-theory/topic/Digraphs/near/471306223\">said</a>:</p>\n<blockquote>\n<p>Does this \"orientation-forgetting\" map from <code>Digraph</code>s to <code>SimpleGraph</code>s look okay?</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">toSimpleGraph</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Digraph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">Adj</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">‚â†</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">Adj</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">‚à®</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">Adj</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">h‚ÇÅ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span><span class=\"bp\">‚ü©</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">And</span><span class=\"bp\">.</span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Or</span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"bp\">‚Äπ_‚Ä∫</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Or</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"bp\">‚Äπ_‚Ä∫</span>\n<span class=\"w\">  </span><span class=\"n\">loopless</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Perhaps it's better to use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SimpleGraph.fromRel#doc\">docs#SimpleGraph.fromRel</a> ?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">toSimpleGraph</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Digraph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">fromRel</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"bp\">.</span><span class=\"n\">Adj</span>\n</code></pre></div>",
        "id": 471480299,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726750512
    },
    {
        "content": "<p>That's a great idea, thank you!</p>",
        "id": 471480399,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726750556
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/16954\">#16954</a> starts with some of the things discussed here, but doesn't port anything from <code>SimpleGraph</code>s to <code>Digraph</code>s yet</p>",
        "id": 471575798,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726786986
    },
    {
        "content": "<p>It would be nice to have an <code>IsLoopless</code> predicate.</p>",
        "id": 471760523,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726845663
    },
    {
        "content": "<p>We have the classes <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsIrrefl#doc\">docs#IsIrrefl</a> for loopless, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsAsymm#doc\">docs#IsAsymm</a> for oriented, and so on  ... would it make sense to use these instead of explicit quantifiers?</p>",
        "id": 471786191,
        "sender_full_name": "Vincent Beffara",
        "timestamp": 1726852600
    },
    {
        "content": "<p>Nice idea, but what do you think about using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AntiSymmetric#doc\">docs#AntiSymmetric</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Irreflexive#doc\">docs#Irreflexive</a> instead? So we won't have to deal with adding <code>h.asymm</code> every time we want to use the hypothesis <code>h : G.IsOriented</code>. Also <code>Irreflexive </code> is used already when defining the loopless property on <code>SimpleGraph</code>s.</p>",
        "id": 471797308,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726855343
    },
    {
        "content": "<p>Oh, <code>Antisymmetric</code> is different from <code>Asymmetric</code>, and apparently we don't have <code>Asymmetric</code> in mathlib</p>",
        "id": 471798740,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726855862
    },
    {
        "content": "<p>I've added <code>Asymmetric</code> and rewrote the PR to use it instead, alongside <code>Irreflexive</code>.</p>",
        "id": 471853981,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1726876967
    },
    {
        "content": "<p>I don't know if this is the place to ask, but is there an advantage to implementing digraphs, simple graphs, etc. as separate structures instead of say:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Graph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Rel</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"n\">V</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Graph</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">UndirectedGraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Graph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">undirected</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Symmetric</span><span class=\"w\"> </span><span class=\"n\">G</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">LooplessGraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Graph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">loopless</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Irreflexive</span><span class=\"w\"> </span><span class=\"n\">G</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">SimpleGraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Graph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">UndirectedGraph</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LooplessGraph</span><span class=\"w\"> </span><span class=\"n\">G</span>\n\n<span class=\"c1\">-- and so on</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">SemicompleteGraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Graph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">LooplessGraph</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">semicomplete</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"bp\">‚à®</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">QuasiTransitiveGraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Graph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">LooplessGraph</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">quasi_transitive</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÉ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÉ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÉ</span><span class=\"w\"> </span><span class=\"bp\">‚à®</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÉ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Graph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SemicompleteGraph</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">QuasiTransitiveGraph</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">quasi_transitive</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÉ</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">semicomplete</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÉ</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">OrientedGraph</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Graph</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">oriented</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Xor'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"o\">)</span>\n\n<span class=\"c1\">-- DAG, tree, etc.</span>\n</code></pre></div>\n<p>In this case digraphs, simple graphs, etc. are built up using classes and definitions/theorems pick the resolution they need so no duplication. It also future proofs implementation of new subclasses of graphs.</p>\n<p>I'm relatively new to Lean, but this reminds me of how say <code>Ring</code> is defined as a class extending <code>SemiRing</code>, <code>AddCommGroup</code>, <code>AddGroupWithOne</code>. Is there some lurking reason as to why this isn't done?</p>",
        "id": 486753744,
        "sender_full_name": "Mitchell Horner",
        "timestamp": 1733650972
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"688480\">@Mitchell Horner</span> There's a bit of discussion about this today at <a class=\"message-link\" href=\"/#narrow/channel/217875-Is-there-code-for-X.3F/topic/Weak.20components.20of.20a.20digraph/near/486965227\">#Is there code for X? &gt; Weak components of a digraph @ üí¨</a>, including a reference to a relevant PR. One other reason is that it's good to have actual types per class of object ‚Äî for example the lattice structures on Digraph and SimpleGraph are interesting and useful.</p>",
        "id": 487056723,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1733765491
    },
    {
        "content": "<p>For <code>Ring</code>, etc., the key difference is that these typeclasses implementing synecdoche. We talk about the underlying type for a ring as if it's the ring itself. It's nice because a single type can \"be\" multiple things in the algebraic hierarchy.</p>\n<p>The first complication are types like <code>Subgroup</code>, but then there's a trick you can use. Given <code>H : Subgroup G</code>, you can use <code>H</code> as if it were a type, because Lean has its CoeSort system. Then we can say <code>H</code> \"is\" a group by synecdoche through the coercion ‚Äî¬†that is to say, <code>H</code> as a type has a <code>Group</code> instance.</p>\n<p>However, this all falls apart when you start working with homomorphisms. You want types of homomorphisms, and there are some complications to, for example, a ring homomorphism \"being\" an additive homomorphism. This is all the DFunlike business patching it over.</p>\n<p>Graphs are similar to homomorphisms. There are complications, and as that PR in the link shows, it's possible to do similar things, but it's not as nice of a situation as <code>Ring</code> et al.</p>",
        "id": 487058535,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1733765958
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/252551-graph-theory/topic/Digraphs/near/487056723\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"688480\">Mitchell Horner</span> There's a bit of discussion about this today at <a class=\"message-link\" href=\"/#narrow/channel/217875-Is-there-code-for-X.3F/topic/Weak.20components.20of.20a.20digraph/near/486965227\">#Is there code for X? &gt; Weak components of a digraph @ üí¨</a>, including a reference to a relevant PR. One other reason is that it's good to have actual types per class of object ‚Äî for example the lattice structures on Digraph and SimpleGraph are interesting and useful.</p>\n</blockquote>\n<p>Thanks for this explanation. That discussion and <a href=\"https://github.com/leanprover-community/mathlib4/pull/4127\">#4127</a> is exactly what I was looking for.</p>",
        "id": 487183831,
        "sender_full_name": "Mitchell Horner",
        "timestamp": 1733817864
    }
]