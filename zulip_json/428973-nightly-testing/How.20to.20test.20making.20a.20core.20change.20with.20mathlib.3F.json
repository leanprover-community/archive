[
    {
        "content": "<p>Hi! I have a basic question which I'm sure is documented somewhere, but I cannot find that documentation. Points to RTFM are very welcome; I'd read the manual if I could find one! I'd like to test the change in <a href=\"https://github.com/leanprover/lean4/pull/12007\">lean#12007</a> (tweaking some pretty-printing --- i.e., should not cause any additional build failures anywhere <span aria-label=\"fingers crossed\" class=\"emoji emoji-1f91e\" role=\"img\" title=\"fingers crossed\">:fingers_crossed:</span>).</p>\n<ul>\n<li>My first attempt was simply making a PR to the main core branch. That didn't generate a mathlib toolchain. Would there have been a label to apply to the core PR, to automatically generate a mathlib toolchain for me?</li>\n<li>Reading the sticky comment, I rebased my PR on the <code>nightly-with-mathlib</code> branch... still no luck.</li>\n<li>In a final attempt, I forked the nightly-testing repository, checked out the <code>nightly-testing</code> branched and switched the lean toolchain to the one from my PR: <a href=\"https://github.com/leanprover-community/mathlib4/pull/33991\">#33991</a>. Running <code>lake build</code> locally yields failures in batteries, i.e. unrelated to my PR.</li>\n</ul>\n<p>What am I doing wrong/what should I be doing instead?</p>",
        "id": 568156530,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1768468602
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/contribute/tags_and_branches.html\">https://leanprover-community.github.io/contribute/tags_and_branches.html</a> says</p>\n<blockquote>\n<p>For any PR that potentially affects Std or Mathlib, you should base your PR off the HEAD of the <code>nightly-with-mathlib</code> branch. In that case, a <code>lean-pr-testing-NNNN</code> Mathlib branch is created, described in detail below, and results from this branch are reported via comments in the PR discussion.</p>\n</blockquote>\n<p>Clearly this information is out of date. I think that entire page needs a thorough rewrite.</p>\n<p>It seems to me that the branch should have been created in the mathlib4-nightly-testing repo, but that hasn't happened.</p>",
        "id": 568157778,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1768468946
    },
    {
        "content": "<p>Isn't the issue that there are still other CI steps failing on your PR to core?</p>",
        "id": 568158485,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1768469139
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/blob/master/doc/dev/index.md\">https://github.com/leanprover/lean4/blob/master/doc/dev/index.md</a> has the same information (condensed) - so should probably also be rewritten.</p>",
        "id": 568166092,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1768471160
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/channel/428973-nightly-testing/topic/How.20to.20test.20making.20a.20core.20change.20with.20mathlib.3F/near/568158485\">said</a>:</p>\n<blockquote>\n<p>Isn't the issue that there are still other CI steps failing on your PR to core?</p>\n</blockquote>\n<p>Fair... while I am rather surprised, let me try to investigate. First stumbling block is more outdated documentation: the snippet </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">rootdir</span>\n<span class=\"n\">elan</span><span class=\"w\"> </span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">link</span><span class=\"w\"> </span><span class=\"n\">lean4</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span>\n<span class=\"n\">elan</span><span class=\"w\"> </span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">link</span><span class=\"w\"> </span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">stage0</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage0</span>\n</code></pre></div>\n<p>fails with an error \"not a directory: build/release/stage0\". What's the correct incantation?</p>",
        "id": 568166397,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1768471235
    },
    {
        "content": "<p>I'm sorry, but I don't know the answer. Hopefully someone from the FRO can chime in.</p>",
        "id": 568171639,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1768472725
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/channel/428973-nightly-testing/topic/How.20to.20test.20making.20a.20core.20change.20with.20mathlib.3F/near/568157778\">said</a>:</p>\n<blockquote>\n<p>Clearly this information is out of date.</p>\n</blockquote>\n<p>Sorry, what is out of date here? (Std should become Batteries.)</p>",
        "id": 570235800,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1769490209
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/428973-nightly-testing/topic/How.20to.20test.20making.20a.20core.20change.20with.20mathlib.3F/near/568166397\">said</a>:</p>\n<blockquote>\n<p>fails with an error \"not a directory: build/release/stage0\". What's the correct incantation?</p>\n</blockquote>\n<p>I think this is correct, but if you haven't done a build on the command line yet that stage0/ subdirectory won't exist yet.</p>",
        "id": 570235846,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1769490253
    },
    {
        "content": "<p>Oh, I see</p>\n<blockquote>\n<ul>\n<li>All PRs to Mathlib should be made from branches of the Mathlib repository itself.<ul>\n<li>This is required for Mathlib's <code>.olean</code> caching mechanism.</li>\n<li>Please ask on the <a href=\"#narrow/stream/287929-mathlib4/topic/github.20permission\">zulip chat</a> for \"write\" permission to Mathlib. Please write a sentence about your background and plans.</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p>is outdated. I guess we need to explain how to ask for write access on the mathlib4-nightly-testing fork.</p>",
        "id": 570235979,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1769490372
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/428973-nightly-testing/topic/How.20to.20test.20making.20a.20core.20change.20with.20mathlib.3F/near/570235800\">said</a>:</p>\n<blockquote>\n<p>(Std should become Batteries.)</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/leanprover-community.github.io/pull/776\">https://github.com/leanprover-community/leanprover-community.github.io/pull/776</a></p>",
        "id": 570236089,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1769490452
    },
    {
        "content": "<p>Further revisions in <a href=\"https://github.com/leanprover-community/leanprover-community.github.io/pull/777\">https://github.com/leanprover-community/leanprover-community.github.io/pull/777</a>, but this still needs careful review.</p>",
        "id": 570236758,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1769490943
    },
    {
        "content": "<p>Looks pretty good to me.</p>",
        "id": 570238881,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1769492581
    }
]