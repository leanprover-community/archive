[
    {
        "content": "<p>In the past few days I have tried to document and automate the workflows involved in keeping mathlib in sync with new Lean releases.</p>\n<p>For starters, please take 30s to read <a href=\"https://leanprover-community.github.io/contribute/tags_and_branches.html#mathlib-nightly-and-bump-branches\">tags and branches &gt; mathlib nightly and bump branches</a> on the community website. (This is a new section that I wrote a few days ago.)</p>\n<p>Tl;dr: Lean publishes new nightly releases every day. At the end of the month this becomes a new release. Mathlib adapts to the nightlies on the <code>bump/v4.x.y</code>. At the end of the month, this branch is merged into master without further review.</p>\n<p><strong>TL;DR:</strong> The branch <code>bump/v4.x.y</code> is part of our \"trusted code base\". Mathlib maintainers are responsible for reviewing changes to that branch.</p>\n<hr>\n<p>About automation:</p>\n<blockquote>\n<p>chore: add workflow for merging master into bump/v4.x.y branches <a href=\"https://github.com/leanprover-community/mathlib4/pull/17081\">#17081</a></p>\n</blockquote>\n<p>This <span aria-label=\"this\" class=\"emoji emoji-1f446\" role=\"img\" title=\"this\">:this:</span>  PR adds a workflow that merges <code>master</code> into <code>bump/v4.x.y</code> several times per day. Usually, there are no problems. If there are problems, it creates a PR and posts it to zulip.</p>\n<p>Mathlib maintainers are responsible for <em>reviewing</em> the resulting PR, because it's contents will end up in mathlib without further review.<br>\nOf course this is only a merge conflict, so the PR should be uncontroversial.</p>\n<blockquote>\n<p>ci(.github/workflows): add discover-lean-pr-testing.yml <a href=\"https://github.com/leanprover-community/mathlib4/pull/17399\">#17399</a></p>\n</blockquote>\n<p>This <span aria-label=\"this\" class=\"emoji emoji-1f446\" role=\"img\" title=\"this\">:this:</span>  PR adds a workflow that finds branches of the form <code>lean-pr-testing-NNNN</code>corresponding to core PRs that have been merged into the latest nightly. These branches should be merged into the <code>nightly-testing</code> branch of<br>\nmathlib. The workflow only reports branches that have a non-trivial diff.</p>\n<p>In the future, I plan to automate this further. If the merge is trivial, just do it. Otherwise, create a PR and ask for help.</p>\n<p>NB: These branches are not part of the TCB. Anything that happens here will be reviewed again at some point, before landing in master.</p>\n<blockquote>\n<p>TODO</p>\n</blockquote>\n<p>Add a workflow that automatically creates PRs for merging <code>nightly-testing</code> into <code>bump/v4.x.y</code>. At the moment there is still a manual step involved in the form of a bot asking us to run a script. See <a class=\"stream-topic\" data-stream-id=\"428973\" href=\"/#narrow/stream/428973-nightly-testing/topic/Mathlib.20bump.20branch.20reminders\">#nightly-testing &gt; Mathlib bump branch reminders</a> .</p>\n<p>Whether automated or not. These PRs must be reviewed. Because these changes to <code>bump/v4.x.y</code> will end up in mathlib without further review.<br>\nOf course these are only adaptations to changes in Lean. So the PRs should be mostly uncontroversial.</p>",
        "id": 474772976,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1728031606
    },
    {
        "content": "<p>I assume by \"maintainers\" everywhere in your documentation, you mean \"maintainers and reviewers\"?</p>",
        "id": 474789695,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1728037119
    },
    {
        "content": "<p>Btw this <span aria-label=\"green\" class=\"emoji emoji-1f7e2\" role=\"img\" title=\"green\">:green:</span> looks very close to <span aria-label=\"orange circle\" class=\"emoji emoji-1f7e0\" role=\"img\" title=\"orange circle\">:orange_circle:</span> to colorblind me, and the <span aria-label=\"cross mark\" class=\"emoji emoji-274c\" role=\"img\" title=\"cross mark\">:cross_mark:</span> is making me think that it is supposed to be corresponding to a possible github status (ie <span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span>, <span aria-label=\"orange circle\" class=\"emoji emoji-1f7e0\" role=\"img\" title=\"orange circle\">:orange_circle:</span> or <span aria-label=\"cross mark\" class=\"emoji emoji-274c\" role=\"img\" title=\"cross mark\">:cross_mark:</span>), but it is not <span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span>. Can someone confirm/infirm my understanding of how we are supposed to read this graphic and fix it?</p>",
        "id": 474790437,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1728037349
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/bNtvpZ2lLE5O9hp_Ah-DHxab/image.png\">In this image, I mean</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/bNtvpZ2lLE5O9hp_Ah-DHxab/image.png\" title=\"In this image, I mean\"><img data-original-dimensions=\"329x376\" src=\"/user_uploads/thumbnail/3121/bNtvpZ2lLE5O9hp_Ah-DHxab/image.png/840x560.webp\"></a></div>",
        "id": 474790467,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1728037358
    },
    {
        "content": "<p>There is only the green one. But also, that picture is a bit out-dated in some parts.</p>",
        "id": 474790604,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1728037414
    },
    {
        "content": "<p>The text should be accurate though</p>",
        "id": 474790629,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1728037426
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/stream/428973-nightly-testing/topic/workflow/near/474789695\">said</a>:</p>\n<blockquote>\n<p>I assume by \"maintainers\" everywhere in your documentation, you mean \"maintainers and reviewers\"?</p>\n</blockquote>\n<p>Yes, sorry.</p>",
        "id": 474790712,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1728037443
    }
]