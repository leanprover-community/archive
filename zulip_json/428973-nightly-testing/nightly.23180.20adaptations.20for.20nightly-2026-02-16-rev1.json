[
    {
        "content": "<blockquote>\n<p>chore: adaptations for nightly-2026-02-16-rev1 <a href=\"https://github.com/leanprover-community/mathlib4-nightly-testing/pull/180\">nightly#180</a></p>\n</blockquote>\n<p>Please review this PR. At the next toolchain release this diff will land in 'master'.</p>\n<p>(This message wasn't posted automatically because of a SIGPIPE bug in <code>create-adaptation-pr.sh</code> â€” see <a href=\"https://github.com/leanprover-community/mathlib4/pull/35434\">#35434</a> for the fix.)</p>",
        "id": 574226709,
        "sender_full_name": "Kim Morrison :bot:",
        "timestamp": 1771311209
    },
    {
        "content": "<p>This is the insane 3000+ file PR that adds <code>set_option backward.isDefEq.respectTransparency false</code> where needed after <a href=\"https://github.com/leanprover/lean4/pull/12179\">lean#12179</a>.</p>",
        "id": 574226767,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1771311272
    },
    {
        "content": "<p>I'm working on making the git history inspectable. </p>\n<p>Step 1. squash it all into one commit! b1638f2181cbf354d0502152a3600eb8cf99faaa<br>\nStep 2. insert the history of the <code>lean-pr-testing-12179</code> branch underneath that commit in a rebase<br>\nStep 3. hopefully not mess up the rebase conflicts...</p>",
        "id": 574227479,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1771311765
    },
    {
        "content": "<p>Okay, the git history now reflects the history from lean-pr-testing-12179.</p>\n<p>There are lots of manual commits, that ideally would be reviewed.</p>\n<p>There are two big commits, both labelled <code>x: ./fix_backward_defeq.py</code>, which are automatically generated and should consist solely of adding lines <code>set_option backward.isDefEq.respectTransparency false in</code>.</p>\n<p>And then <a href=\"https://github.com/leanprover-community/mathlib4-nightly-testing/pull/180/commits/5643160dcddd2b50ff488ec0ed1e44bb7fde404e\">https://github.com/leanprover-community/mathlib4-nightly-testing/pull/180/commits/5643160dcddd2b50ff488ec0ed1e44bb7fde404e</a> is \"everything else\" in this PR that was not on lean-pr-testing-12179. (And LGTM: it's just set_options on stuff added to master after lean-pr-testing-12179 was completed.)</p>",
        "id": 574227821,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1771311954
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/428973-nightly-testing/topic/nightly.23180.20adaptations.20for.20nightly-2026-02-16-rev1/near/574227821\">said</a>:</p>\n<blockquote>\n<p>There are two big commits, both labelled <code>x: ./fix_backward_defeq.py</code>, which are automatically generated and should consist solely of adding lines <code>set_option backward.isDefEq.respectTransparency false in</code>.</p>\n</blockquote>\n<p>Well, I didn't get this exactly right, but the violations are minor. This <a href=\"https://gist.github.com/kim-em/481f3210555579fdeaeeac9b2c2136be\">script</a> reports the following harmless <a href=\"https://gist.github.com/kim-em/f9b410f2551c06fe432eaf59c9f9e794\">violations</a> of the rule.</p>",
        "id": 574228537,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1771312434
    },
    {
        "content": "<p>And so the diffs that still need review are</p>\n<ul>\n<li>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/compare/a4e165b66acf5ab6885a6626761038fa1481a7a8...56c60f6c08bae0f2993a09a6fe520930ed43595d\">https://github.com/leanprover-community/mathlib4/compare/a4e165b66acf5ab6885a6626761038fa1481a7a8...56c60f6c08bae0f2993a09a6fe520930ed43595d</a> <br>\nand</p>\n</li>\n<li>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/compare/1cb8bd3125e325528b17bfdc074b2658875dcbce...c3881bfbbaed0330d031701f7265bf80e073fed0\">https://github.com/leanprover-community/mathlib4/compare/1cb8bd3125e325528b17bfdc074b2658875dcbce...c3881bfbbaed0330d031701f7265bf80e073fed0</a></p>\n</li>\n</ul>",
        "id": 574228747,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1771312567
    },
    {
        "content": "<p>And those look fine, except that I need to add another commit deleting the <code>fix_backward_defeq.py</code> script, which probably should be salvaged and turn into something general, because it is kind of awesome that it managed to automatically edit 1000s of files in Mathlib, managing all the rebuilds necessary.</p>\n<p>Oh, and that I am opinionated about whitespace in some non-standard ways. <span aria-label=\"woman shrugging\" class=\"emoji emoji-1f937-200d-2640\" role=\"img\" title=\"woman shrugging\">:woman_shrugging:</span></p>",
        "id": 574229072,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1771312774
    },
    {
        "content": "<p>Note that I have removed some <code>@[simp]</code>annotations which are both not used in the Mathlib, and which the simpNF linter now complains about.</p>",
        "id": 574229155,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1771312830
    },
    {
        "content": "<p>Okay, I am happy with this. I am going to start cutting <code>v4.29.0-rc1</code>, and will plan to merge this, if it hasn't already been, in time for it to be ready for Mathlib to move over.</p>",
        "id": 574229278,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1771312916
    },
    {
        "content": "<p>I reviewed everything except the two big auto-generated commits.</p>",
        "id": 574229399,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1771312992
    },
    {
        "content": "<p>My takeaways:</p>\n<ul>\n<li>Adding and removing the script could have been <code>transient: </code> commits</li>\n<li>It would be great if there was a script that confirmed that a certain range of commits did nothing but add lines that start with <code>set_option yayayada false</code> + optional <code>in</code> + optional <code>-- comment</code>.</li>\n<li>All the changes that are not of the above form look good to me.</li>\n<li>Except that one simp seems to be removed without adaptation note.</li>\n</ul>",
        "id": 574229528,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1771313082
    },
    {
        "content": "<blockquote>\n<ul>\n<li>Except that one simp seems to be removed without adaptation note.</li>\n</ul>\n</blockquote>\n<p>Can you help me find that one?</p>",
        "id": 574229753,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1771313218
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/channel/428973-nightly-testing/topic/nightly.23180.20adaptations.20for.20nightly-2026-02-16-rev1/near/574229528\">said</a>:</p>\n<blockquote>\n<ul>\n<li>It would be great if there was a script that confirmed that a certain range of commits did nothing but add lines that start with <code>set_option yayayada false</code></li>\n</ul>\n</blockquote>\n<p>See above, there's a script in a gist for doing this (at least the inflexible version with no comment)</p>",
        "id": 574229834,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1771313258
    },
    {
        "content": "<p>Aah, nice. I suppose we could try to generalize the <code>x:</code> framework to make it possible to run such scripts as part of CI. But maybe that's over-complicating a framework that doesn't even work correctly right now.</p>",
        "id": 574230148,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1771313424
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/428973-nightly-testing/topic/nightly.23180.20adaptations.20for.20nightly-2026-02-16-rev1/near/574229753\">said</a>:</p>\n<blockquote>\n<blockquote>\n<ul>\n<li>Except that one simp seems to be removed without adaptation note.</li>\n</ul>\n</blockquote>\n<p>Can you help me find that one?</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4-nightly-testing/pull/180#discussion_r2815363611\">https://github.com/leanprover-community/mathlib4-nightly-testing/pull/180#discussion_r2815363611</a></p>",
        "id": 574233117,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1771315025
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/channel/428973-nightly-testing/topic/nightly.23180.20adaptations.20for.20nightly-2026-02-16-rev1/near/574233117\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/428973-nightly-testing/topic/nightly.23180.20adaptations.20for.20nightly-2026-02-16-rev1/near/574229753\">said</a>:</p>\n<blockquote>\n<blockquote>\n<ul>\n<li>Except that one simp seems to be removed without adaptation note.</li>\n</ul>\n</blockquote>\n<p>Can you help me find that one?</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4-nightly-testing/pull/180#discussion_r2815363611\">https://github.com/leanprover-community/mathlib4-nightly-testing/pull/180#discussion_r2815363611</a></p>\n</blockquote>\n<p>It already has an adaptation note a few lines higher.</p>",
        "id": 574264017,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1771325848
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/channel/428973-nightly-testing/topic/nightly.23180.20adaptations.20for.20nightly-2026-02-16-rev1/near/574230148\">said</a>:</p>\n<blockquote>\n<p>Aah, nice. I suppose we could try to generalize the <code>x:</code> framework to make it possible to run such scripts as part of CI. But maybe that's over-complicating a framework that doesn't even work correctly right now.</p>\n</blockquote>\n<p>These <code>x:</code> commits would certainly not be reproducible in CI. They took many hours on much faster machine.</p>",
        "id": 574264095,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1771325878
    },
    {
        "content": "<p><img alt=\":merge:\" class=\"emoji\" src=\"https://avatars.zulip.com/3121/emoji/images/37577b95.png\" title=\"merge\"></p>",
        "id": 574264239,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1771325928
    }
]