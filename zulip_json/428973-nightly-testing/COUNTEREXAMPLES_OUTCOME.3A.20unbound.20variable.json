[
    {
        "content": "<p>Did the pr-testing-comment script break? Is anyone already having a look?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Run</span><span class=\"w\"> </span><span class=\"n\">scripts</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">pr</span><span class=\"bp\">-</span><span class=\"n\">testing</span><span class=\"bp\">-</span><span class=\"n\">comments</span><span class=\"bp\">.</span><span class=\"n\">sh</span><span class=\"w\"> </span><span class=\"n\">lean</span>\n<span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">pr</span><span class=\"bp\">-</span><span class=\"n\">testing</span><span class=\"bp\">-</span><span class=\"mi\">5991</span><span class=\"bp\">'</span><span class=\"w\"> </span><span class=\"n\">branch</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">so</span><span class=\"w\"> </span><span class=\"n\">we</span><span class=\"w\"> </span><span class=\"n\">need</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">adjust</span><span class=\"w\"> </span><span class=\"n\">labels</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">write</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">comment</span><span class=\"bp\">.</span>\n<span class=\"n\">Removing</span><span class=\"w\"> </span><span class=\"n\">label</span><span class=\"w\"> </span><span class=\"n\">awaiting</span><span class=\"bp\">-</span><span class=\"n\">mathlib</span>\n<span class=\"o\">{</span>\n<span class=\"w\">  </span><span class=\"s2\">\"message\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Label does not exist\"</span><span class=\"o\">,</span>\n<span class=\"w\">  </span><span class=\"s2\">\"documentation_url\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://docs.github.com/rest/issues/labels#remove-a-label-from-an-issue\"</span><span class=\"o\">,</span>\n<span class=\"w\">  </span><span class=\"s2\">\"status\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"404\"</span>\n<span class=\"o\">}</span>\n<span class=\"n\">Removing</span><span class=\"w\"> </span><span class=\"n\">label</span><span class=\"w\"> </span><span class=\"n\">breaks</span><span class=\"bp\">-</span><span class=\"n\">mathlib</span>\n<span class=\"o\">{</span>\n<span class=\"w\">  </span><span class=\"s2\">\"message\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Label does not exist\"</span><span class=\"o\">,</span>\n<span class=\"w\">  </span><span class=\"s2\">\"documentation_url\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://docs.github.com/rest/issues/labels#remove-a-label-from-an-issue\"</span><span class=\"o\">,</span>\n<span class=\"w\">  </span><span class=\"s2\">\"status\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"404\"</span>\n<span class=\"o\">}</span>\n<span class=\"n\">Adding</span><span class=\"w\"> </span><span class=\"n\">label</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"bp\">-</span><span class=\"n\">mathlib</span>\n<span class=\"o\">[</span>\n<span class=\"w\">  </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"s2\">\"id\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">5906552834</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"node_id\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"LA_kwDOB7kabM8AAAABYA7YAg\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"url\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://api.github.com/repos/leanprover/lean4/labels/builds-mathlib\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"name\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"builds-mathlib\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"color\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"81C3A1\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"default\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"description\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"CI has verified that Mathlib builds against this PR\"</span>\n<span class=\"w\">  </span><span class=\"o\">},</span>\n<span class=\"w\">  </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"s2\">\"id\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">5906657964</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"node_id\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"LA_kwDOB7kabM8AAAABYBByrA\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"url\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://api.github.com/repos/leanprover/lean4/labels/toolchain-available\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"name\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"toolchain-available\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"color\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"366329\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"default\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"description\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"A toolchain is available for this PR, at leanprover/lean4-pr-releases:pr-release-NNNN\"</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n<span class=\"o\">]</span>\n<span class=\"n\">scripts</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">pr</span><span class=\"bp\">-</span><span class=\"n\">testing</span><span class=\"bp\">-</span><span class=\"n\">comments</span><span class=\"bp\">.</span><span class=\"n\">sh</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">line</span><span class=\"w\"> </span><span class=\"mi\">105</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">COUNTEREXAMPLES_OUTCOME</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">unbound</span><span class=\"w\"> </span><span class=\"kn\">variable</span>\n</code></pre></div>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/11722398054/job/32651847816\">https://github.com/leanprover-community/mathlib4/actions/runs/11722398054/job/32651847816</a></p>",
        "id": 481134672,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1730990279
    },
    {
        "content": "<p>Fallout from <a href=\"https://github.com/leanprover-community/mathlib4/pull/15996\">#15996</a> perhaps? <span class=\"user-mention\" data-user-id=\"634338\">@Michael Rothgang</span></p>",
        "id": 481135435,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1730990508
    },
    {
        "content": "<p>Sounds like it could be! This is a script erroring because it doesn't know any variable <code>COUNTEREXAMPLES_OUTCOME</code>. I see a short and a long-term fix.</p>\n<p>Short-term fix: use a default value for the variable, as described <a href=\"http://redsymbol.net/articles/unofficial-bash-strict-mode/#solution-positional-parameters\">here</a>, i.e. write <code>${COUNTEREXAMPLES_OUTCOME:-}</code> instead. This could work here... but reading the doc-string before, it looks like that's not a good fix.</p>\n<p>Better fix: find out why that variable was not set when this script was called. By line 27 on that file, it should be set --- this this is merely <em>exposing</em> a pre-existing error.</p>\n<p>(Worst fix: remove the <code>set -u</code> from that file. That's at best a band-aid, in my opinion.)</p>",
        "id": 481139044,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1730991576
    },
    {
        "content": "<p>There was a recent similar issue: is it the difference between counterexample and counterexamples?</p>",
        "id": 481141101,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730992153
    },
    {
        "content": "<p>Maybe <a href=\"https://github.com/leanprover-community/mathlib4/pull/18617\">#18617</a>?</p>",
        "id": 481141902,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730992407
    },
    {
        "content": "<p>And <a href=\"#narrow/channel/287929-mathlib4/topic/lean.2Fbatteries.20pr.20comment.20script.20fails\">this discussion</a> seems to report the same error.</p>",
        "id": 481142322,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730992530
    },
    {
        "content": "<p>If no one beats me to it I'll make a PR in a few hours.</p>",
        "id": 481154750,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1730996306
    },
    {
        "content": "<p>Ah, actually, I just noticed that this testing branch doesn't contain <a href=\"https://github.com/leanprover-community/mathlib4/pull/18617\">#18617</a>, so if you merge <code>master</code> into it, it might fix it?</p>",
        "id": 481157319,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1730997066
    }
]