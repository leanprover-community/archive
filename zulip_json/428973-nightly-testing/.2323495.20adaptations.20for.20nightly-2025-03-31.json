[
    {
        "content": "<blockquote>\n<p>chore: adaptations for nightly-2025-03-31 <a href=\"https://github.com/leanprover-community/mathlib4/pull/23495\">#23495</a> Please review this PR. At the end of the month this diff will land in 'master'.</p>\n</blockquote>",
        "id": 509183147,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1743423451
    },
    {
        "content": "<p>This is a giant one.</p>\n<p>Most of the changes are consequences of <a href=\"https://github.com/leanprover/lean4/pull/7717\">lean#7717</a>, <span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span>'s changes to structure elaboration.</p>",
        "id": 509184886,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1743423910
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span>, could you say something about plans for the many <code>#adapation_note</code>s added here?</p>",
        "id": 509184990,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1743423942
    },
    {
        "content": "<p>It's maybe worth pointing out that for nearly all the newly added fields, there is an extremely helpful error message when it is omitted.</p>",
        "id": 509192549,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1743425773
    },
    {
        "content": "<p>e.g. at <a href=\"https://github.com/leanprover-community/mathlib4/pull/23495/files#diff-38a54f42a615bd992ae1c0776809903abbcaf4eec7254537ca802a850e9ab47d\">https://github.com/leanprover-community/mathlib4/pull/23495/files#diff-38a54f42a615bd992ae1c0776809903abbcaf4eec7254537ca802a850e9ab47d</a>, omitting the field gives:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">field</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">compl'</span><span class=\"w\"> </span><span class=\"n\">must</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">explicitly</span><span class=\"w\"> </span><span class=\"n\">provided</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">its</span><span class=\"w\"> </span><span class=\"n\">synthesized</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"n\">is</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">⇨</span><span class=\"w\"> </span><span class=\"bp\">⊥</span>\n</code></pre></div>",
        "id": 509193200,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1743425929
    },
    {
        "content": "<p>That link <del>doesn't work for me, perhaps because I have to click \"expand diff\"</del> takes a very long time to jump to the right place</p>",
        "id": 509193671,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1743426025
    },
    {
        "content": "<p>Here <span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HeytingAlgebra</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nucleus</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"bp\">+</span><span class=\"w\">  </span><span class=\"n\">compl</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">⇨</span><span class=\"w\"> </span><span class=\"bp\">⊥</span>\n<span class=\"w\">   </span><span class=\"n\">le_himp_iff</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">     </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">coe_le_coe</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Pi</span><span class=\"bp\">.</span><span class=\"n\">le_def</span><span class=\"o\">]</span>\n<span class=\"w\">       </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">le_rfl</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trans'</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">gcongr</span><span class=\"bp\">⟩</span>\n<span class=\"bp\">...</span>\n</code></pre></div>",
        "id": 509195808,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1743426477
    },
    {
        "content": "<p>I assume it's too complex to make this a \"Try this\"?</p>",
        "id": 509197258,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1743426802
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span></p>\n<ul>\n<li>The \"2025-03-29 for <a href=\"https://github.com/leanprover/lean4/pull/7717\">lean4#7717</a> had to add <code>norm_mul_self_le</code> field\" adaptation notes all involve a weakness of the new parent instance system, where parents that depend on fields can't yet be used. I think these should be fixed by next month. Same goes for <code>instIsTopologicalAddGroup</code>.</li>\n<li>For the handful of added <code>beta_reduce</code>s, it's a mystery why there was beta reduction in the first place.</li>\n<li>The \"a single <code>simp_rw</code> needed to be broken up\" is mysterious to me still. I think there's some difference in constructor layout.</li>\n</ul>\n<p>In all cases, the adaptation notes are marked so I can try to fix them, hopefully this month.</p>",
        "id": 509199201,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1743427237
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> PRs welcome! I thought about this, but only as far as realizing that there's now a place where someone could try writing a Try This.</p>",
        "id": 509199758,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1743427354
    },
    {
        "content": "<p>I've read through all the changes now. I think except for the \"no :=\" field notation appearing in e.g. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">simps</span><span class=\"kd\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">strictMono</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">StrictMono</span><span class=\"w\"> </span><span class=\"n\">toFun</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">LTSeries</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">length</span>\n<span class=\"w\">  </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">toFun</span>\n<span class=\"w\">  </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">strictMono</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">lt_add_one</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n</code></pre></div>\n<p>I'm happy.</p>",
        "id": 509321138,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1743462996
    },
    {
        "content": "<p>Oh, maybe <span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> has already removed those?? I can't find any now.</p>",
        "id": 509321324,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1743463092
    },
    {
        "content": "<p>I don't think I touched anything</p>",
        "id": 509321345,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1743463108
    },
    {
        "content": "<p>Found a few instances just now and expanded them.</p>",
        "id": 509336069,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1743470955
    }
]