[
    {
        "content": "<p>Thanks!</p>\n<p>I noticed the documentation build is broken on master, but it seems to have been broken since <a href=\"https://github.com/leanprover-community/sphere-eversion/commit/0092b9e50b431cef132e884b03f8022c1d7cca2c\">https://github.com/leanprover-community/sphere-eversion/commit/0092b9e50b431cef132e884b03f8022c1d7cca2c</a></p>",
        "id": 475299882,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728308308
    },
    {
        "content": "<p>Indeed, that build has been broken <a href=\"#narrow/stream/303200-sphere-eversion/topic/What.20is.20ready.20for.20upstreaming.3F/near/449646585\">for three months</a>.</p>",
        "id": 475303371,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1728309290
    },
    {
        "content": "<p>Help fixing it is welcome, but not high priority for me.</p>",
        "id": 475303422,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1728309300
    },
    {
        "content": "<p>Oh, I think I'd need to revert your change to move to lakefile.toml in 9567b65a5232380502b6f0041ce6452decf80823</p>",
        "id": 475303977,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728309460
    },
    {
        "content": "<p>So doc-gen doesn't support a lakefile.toml? That's a shame, is there an issue about this already? In any case, feel free to go ahead.</p>",
        "id": 475313060,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1728311995
    },
    {
        "content": "<p>Really? That sounds very weird.</p>",
        "id": 475327195,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1728315521
    },
    {
        "content": "<p>We used to have an optional dependency; I don't know if that's possible with toml</p>",
        "id": 475339007,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728318638
    },
    {
        "content": "<p>Maybe there is a way that I just don't know, though</p>",
        "id": 475339151,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728318678
    },
    {
        "content": "<p>I also don't know how important it is for the dependency to be optional</p>",
        "id": 475339215,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728318699
    },
    {
        "content": "<p>9 messages were moved here from <a class=\"stream-topic\" data-stream-id=\"303200\" href=\"/#narrow/stream/303200-sphere-eversion/topic/What.20is.20ready.20for.20upstreaming.3F\">#sphere eversion &gt; What is ready for upstreaming?</a> by <span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span>.</p>",
        "id": 475339362,
        "sender_full_name": "Notification Bot",
        "timestamp": 1728318727
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/stream/303200-sphere-eversion/topic/Documentation.20build.20failing.20on.20master/near/475339007\">said</a>:</p>\n<blockquote>\n<p>We used to have an optional dependency; I don't know if that's possible with toml</p>\n</blockquote>\n<p>It's not possible. We are hoping that everyone will move away from relying on optional dependencies.</p>",
        "id": 476594693,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1728814043
    },
    {
        "content": "<p>For doc-gen, one solution (besides just making it a standard dependency, which is a bit clunky), is to have a 2nd repo which depends on main one, and doc-gen, and handles generating the documation separately without interfering with \"normal\" users.</p>",
        "id": 476594764,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1728814116
    },
    {
        "content": "<p>Also kinda clunky :)</p>",
        "id": 476597739,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728817370
    },
    {
        "content": "<p>Just crosslinking to the discussion of this approach at <a href=\"#narrow/stream/287929-mathlib4/topic/How.20does.20build.20.26.20deploy.20document.20for.20Mathlib4.20currently.3F/near/476591680\">https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/How.20does.20build.20.26.20deploy.20document.20for.20Mathlib4.20currently.3F/near/476591680</a></p>",
        "id": 476600267,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1728819923
    },
    {
        "content": "<p>(I have moved my message to a more appropriate stream).</p>",
        "id": 476796575,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1728914731
    },
    {
        "content": "<p>I have finally opened <a href=\"https://github.com/leanprover-community/sphere-eversion/pull/91\">https://github.com/leanprover-community/sphere-eversion/pull/91</a> to fix this. The CI changes are shamelessly copied from the carleson CI workflow. <span class=\"user-mention\" data-user-id=\"556875\">@Pietro Monticone</span> Would you like to double-check this part looks alright?</p>",
        "id": 494341245,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1737113893
    },
    {
        "content": "<p>Sure, I’ll take a look at later today (probably during LT2025 social time).</p>",
        "id": 494346173,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1737115707
    },
    {
        "content": "<p>Just a quick comment: it might be better to copy the latest docbuild-based version of the Carleson workflow without symlinks.</p>",
        "id": 494346594,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1737115839
    },
    {
        "content": "<p>Could you please add the current one? Then I’ll take a look later.</p>",
        "id": 494346732,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1737115891
    },
    {
        "content": "<p>Done. (By the way: the <code>setup_lake_package_symlinks.sh</code> script in Carleson is unused: is that safe to delete?)</p>",
        "id": 494349135,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1737116712
    },
    {
        "content": "<p>Yes</p>",
        "id": 494349188,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1737116727
    },
    {
        "content": "<p>This </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">uses</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">actions</span><span class=\"bp\">/</span><span class=\"n\">checkout</span><span class=\"bp\">@</span><span class=\"n\">v2</span>\n</code></pre></div>\n<p>should be upgraded to the latest action version (i.e. <code>v4</code>).</p>",
        "id": 494385959,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1737128059
    },
    {
        "content": "<p>This one </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">actions</span><span class=\"bp\">/</span><span class=\"n\">deploy</span><span class=\"bp\">-</span><span class=\"n\">pages</span><span class=\"bp\">@</span><span class=\"n\">v1</span>\n</code></pre></div>\n<p>should be upgraded to the latest version (i.e. <code>v4</code>).</p>",
        "id": 494386464,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1737128214
    },
    {
        "content": "<p>The following config files are superfluous and should be removed: </p>\n<ul>\n<li><code>docbuild/lean-toolchain</code></li>\n<li><code>docbuild/lake-manifest.json</code></li>\n</ul>\n<p>Everything should be configured and hosted by the workflow runner.</p>",
        "id": 494388469,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1737128829
    },
    {
        "content": "<p>Ok, now it looks good to me.</p>",
        "id": 494390011,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1737129288
    },
    {
        "content": "<p>Merged the PR: let's see if it works!</p>",
        "id": 494392516,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1737130015
    },
    {
        "content": "<p>For those following along: it failed, but Pietro already proposed a fix. Merged that; we'll see if that suffices.</p>",
        "id": 494432423,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1737144933
    },
    {
        "content": "<p>Yes, it worked. There is a remaining unrelated checkdecls issue</p>",
        "id": 494451887,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1737153322
    },
    {
        "content": "<p>Pushed a fix for that (I think)</p>",
        "id": 494451994,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1737153376
    },
    {
        "content": "<p>Fine, it worked.</p>",
        "id": 494455243,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1737155335
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/leanprover-community/sphere-eversion/pull/106\">sphere-eversion#106</a> to fix the doc-related cache step as in <a href=\"https://github.com/PatrickMassot/leanblueprint/pull/70\">leanblueprint#70</a>.</p>",
        "id": 517305326,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1746921245
    }
]