[
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"703970\">Etienne Marion</span> <a href=\"#narrow/channel/509433-Brownian-motion/topic/Tasks.20and.20claims/near/525372697\">said</a>:</p>\n<blockquote>\n<p>If nobody has claimed it I'll try lemma 3.32 <code>IsGaussianProcess.modification</code>.</p>\n</blockquote>\n<p>I had to add an hypothesis to the lemma. I proved that a Gaussian process is almost everywhere measurable, so if <code>Y</code> is a modification of <code>X</code> and <code>X</code> is a Gaussian process, then <code>Y</code> might fail to be almost everywhere measurable (only if <code>T</code> is not countable), in which case it would not be a Gaussian process. Maybe we can change the definition of a Gaussian process to the following to avoid this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsGaussianProcess</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Ω</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">Ω</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">volume_tac</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IsGaussian</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">I</span><span class=\"bp\">.</span><span class=\"n\">restrict</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">ω</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">ω</span><span class=\"o\">)))</span>\n</code></pre></div>\n<p>Or</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsGaussianProcess</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Ω</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">Ω</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">volume_tac</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IsGaussian</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">ω</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"bp\">.</span><span class=\"n\">restrict</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">ω</span><span class=\"o\">))))</span>\n</code></pre></div>\n<p>(which I find nicer).<br>\nIn fact</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsGaussianProcess</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Ω</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">Ω</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">volume_tac</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IsGaussian</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">ω</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">ω</span><span class=\"o\">)))</span>\n</code></pre></div>\n<p>would be more consistent with the statement of <code>finite_distributions_eq</code>. Is there a reason why the latter uses a fintype rather than a finset?</p>",
        "id": 525387577,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1750703225
    },
    {
        "content": "<p><a href=\"#narrow/channel/509433-Brownian-motion/topic/Definition.20of.20a.20Gaussian.20process/near/525387577\">A message</a> was moved here from <a class=\"stream-topic\" data-stream-id=\"509433\" href=\"/#narrow/channel/509433-Brownian-motion/topic/Tasks.20and.20claims/with/523986698\">#Brownian motion &gt; Tasks and claims</a> by <span class=\"user-mention silent\" data-user-id=\"703970\">Etienne Marion</span>.</p>",
        "id": 525389015,
        "sender_full_name": "Notification Bot",
        "timestamp": 1750703907
    },
    {
        "content": "<p>Let's summarize the possible measurability conditions for <code>X : T → Ω → E</code> for <code>T</code> the index set and <code>Ω</code> the probability space (for my future reference as much as for anyone else).</p>\n<p>For a measurable process, <code>∀ t, Measurable (X t)</code> and <code>Measurable (fun ω t ↦ X t ω)</code> are equivalent by definition of the product measurable space.<br>\nIf we want to relax to AEMeasurable, we can do it from either of these conditions, but <code>∀ t, AEMeasurable (X t) P</code> and <code>AEMeasurable (fun ω t ↦ X t ω) P</code> are not equivalent anymore (unless <code>T</code> is countable). The first one is weaker.<br>\nThe useful notion of a.e. measurable in any context is the one that corresponds to \"almost everywhere equal to a measurable thing\". Here the thing is a process, and that useful notion would be <code>AEMeasurable (fun ω t ↦ X t ω) P</code>. For the weaker condition, there may not be a single measurable process to which it's a.e. equal.</p>\n<p>So I'm fine with having <code>AEMeasurable (fun ω t ↦ X t ω) P</code> as standard assumption everywhere. I used the weaker <code>∀ t, AEMeasurable (X t) P</code> in several statements because at the start of the project I did not see that there was an issue.</p>",
        "id": 525396342,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1750707185
    },
    {
        "content": "<p>So I don't think the a.e.-measurability that the current definition of Gaussian process assumes is an issue, but there could be another good reason for changing the definition.</p>\n<p>Your third def looks like a more natural way to describe the finite dimensional distributions than <code>(P.map (fun ω t ↦ X t ω)).map I.restrict</code>.</p>",
        "id": 525398026,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1750707993
    },
    {
        "content": "<p>I agree this condition is not an issue. But indeed I think that it would be more natural to only do one mapping in the definition of a Gaussian process. Personally I prefer the second definition I wrote. The reason is that encoding the restriction into <code>Finset.restrict</code> rather than writing it with type ascription allows for more rewriting, for example to say that restricting to a finset <code>I</code> and then to a smaller one <code>J</code> (via <code>Finset.restrict₂</code>) is the same as directly restricting to <code>J</code>. Also, projective family of measures and projective limits are defined in terms of <code>Finset.restrict₂</code> and <code>Finset.restrict</code>.<br>\nThe only drawback I can see is that this would mean that when talking about finite dimensional distributions, we index them with a finset, and not an arbitrary finite type. I don't know if that is important or not.</p>",
        "id": 525405267,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1750711585
    },
    {
        "content": "<p>A PR to change the definition of a Gaussian process to your second definition would be welcome (or you can do it in your open PR about those processes).</p>",
        "id": 525454900,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1750749390
    },
    {
        "content": "<p>Related to the measurability discussion above, in <a href=\"https://github.com/RemyDegenne/brownian-motion/pull/104\">https://github.com/RemyDegenne/brownian-motion/pull/104</a> I am changing the definition <code>IsKolmogorovProcess</code> to use something stronger (which I need for the Hölder modification lemmas). I am introducing a new definition for a measurable version of the condition, and <code>IsKolmogorovProcess</code> means being a.e. equal to a process that satisfies the measurable version.<br>\nThe new definitions are:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">IsMeasurableKolmogorovProcess</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Ω</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">Ω</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">measurablePair</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Measurable</span><span class=\"o\">[</span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">borel</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">ω</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">ω</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">ω</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"n\">kolmogorovCondition</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∫⁻</span><span class=\"w\"> </span><span class=\"n\">ω</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">edist</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">ω</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">ω</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">∂</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">edist</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">q</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsKolmogorovProcess</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Ω</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">Ω</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IsMeasurableKolmogorovProcess</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">∀ᵐ</span><span class=\"w\"> </span><span class=\"n\">ω</span><span class=\"w\"> </span><span class=\"bp\">∂</span><span class=\"n\">P</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">ω</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">ω</span>\n</code></pre></div>\n<p>We should probably change the names later to <code>IsKolmogorovProcess</code> and <code>IsAEKolmogorovProcess</code> or something similar to fit better with the Mathlib names for Measurable/AEMeasurable, but I want to minimize the changes for now.</p>",
        "id": 526062926,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1751023306
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"703970\">@Etienne Marion</span> a consequence of the change is that we should prove <code>IsMeasurableKolmogorovProcess</code> for the Brownian motion. Your code in <a href=\"https://github.com/RemyDegenne/brownian-motion/pull/105\">https://github.com/RemyDegenne/brownian-motion/pull/105</a> should be easy to adapt.</p>",
        "id": 526063603,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1751023600
    }
]