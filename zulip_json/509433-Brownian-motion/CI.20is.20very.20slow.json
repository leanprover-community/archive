[
    {
        "content": "<p>The documentation step of our CI now takes hours. I think it's doing that since I bumped to 4.22.0-rc2 . The last successful CI on a merge to master took almost 6 hours. Anyone feels like investigating?<br>\nI'll tag <span class=\"user-mention\" data-user-id=\"556875\">@Pietro Monticone</span> since he's a CI expert.</p>",
        "id": 526794260,
        "sender_full_name": "RÃ©my Degenne",
        "timestamp": 1751460738
    },
    {
        "content": "<p>It's all due to docs generation: a combination of having <code>import Mathlib</code> and the issues discussed in <a class=\"stream-topic\" data-stream-id=\"113488\" href=\"/#narrow/channel/113488-general/topic/Why.20is.20doc-gen4.20so.20slow.3F/with/522844935\">#general &gt; Why is doc-gen4 so slow?</a></p>\n<p>There is another docs cache issue (which is not causing the inefficiency, but it's related) in the new <code>docgen-action</code> which will be solved in the next few days. </p>\n<p>CC: <span class=\"user-mention\" data-user-id=\"238446\">@Anne Baanen</span></p>",
        "id": 526808050,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1751464634
    },
    {
        "content": "<p>I don't have <code>import Mathlib</code> anymore, and until that recent dependency bump it was taking a bit more than 30 minutes (or 80 minutes when I still had an <code>import Mathlib</code>). The fact that it takes 6 hours to build the docs is new.</p>",
        "id": 526808670,
        "sender_full_name": "RÃ©my Degenne",
        "timestamp": 1751464774
    },
    {
        "content": "<p>The current run: <a href=\"https://github.com/RemyDegenne/brownian-motion/actions/runs/16023065753/job/45204400417\">https://github.com/RemyDegenne/brownian-motion/actions/runs/16023065753/job/45204400417</a> (already 3 hours long)</p>",
        "id": 526809017,
        "sender_full_name": "RÃ©my Degenne",
        "timestamp": 1751464864
    },
    {
        "content": "<p>Oh, I see. It seems to be due to the latest release then... </p>\n<p>In the meantime, I would recommend disabling doc generation by setting <code>api_docs: false</code> in your workflow:</p>\n<div class=\"codehilite\" data-code-language=\"Diff\"><pre><span></span><code><span class=\"w\"> </span>     - name: Compile blueprint and documentation\n<span class=\"w\"> </span>       uses: leanprover-community/docgen-action@f78d5a9a1a728288aef64bde6f133d30a8511cb7 # 2025-06-27\n<span class=\"w\"> </span>       with:\n<span class=\"w\"> </span>         blueprint: true\n<span class=\"w\"> </span>         homepage: home_page\n<span class=\"gi\">+         api_docs: false</span>\n</code></pre></div>\n<p>This should serve as a temporary workaround until the <code>docgen-action</code> cache issue is resolved which would reduce the workflow compilation time.</p>",
        "id": 526810792,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1751465334
    },
    {
        "content": "<p>Thanks, I'll do that! The docs are not essential to the project anyway.</p>",
        "id": 526811371,
        "sender_full_name": "RÃ©my Degenne",
        "timestamp": 1751465474
    },
    {
        "content": "<p>Iâ€™ve also reported it here: <a class=\"message-link\" href=\"/#narrow/channel/113488-general/topic/Why.20is.20doc-gen4.20so.20slow.3F/near/526811544\">#general &gt; Why is doc-gen4 so slow? @ ðŸ’¬</a></p>",
        "id": 526814266,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1751466180
    },
    {
        "content": "<p>Performance fix <a href=\"#narrow/stream/113488-general/topic/Why.20is.20doc-gen4.20so.20slow.3F/near/526944691\">https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Why.20is.20doc-gen4.20so.20slow.3F/near/526944691</a></p>",
        "id": 526950095,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1751533659
    },
    {
        "content": "<p>I've enabled docs generation again. Let's see if it's fast: <a href=\"https://github.com/RemyDegenne/brownian-motion/actions/runs/16046299057/job/45278364911\">https://github.com/RemyDegenne/brownian-motion/actions/runs/16046299057/job/45278364911</a></p>",
        "id": 526950306,
        "sender_full_name": "RÃ©my Degenne",
        "timestamp": 1751533725
    },
    {
        "content": "<p>It completed in 37 minutes. That's back to normal. <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 526958077,
        "sender_full_name": "RÃ©my Degenne",
        "timestamp": 1751536076
    }
]