[
    {
        "content": "<p>When defining a <code>CoeSort</code>/<code>CoeFun</code>, I want to add the <code>@[coe]</code> attribute for it to delaborate correctly. However, this marks the coercion as a regular coercion, and seemingly doesn't have the ability to make it use <code>↥</code> and <code>⇑</code> notation. Following <a href=\"https://github.com/leanprover-community/mathlib4/blob/master/Mathlib/Data/FunLike/Basic.lean#L173\">Mathlib/Data/FunLike/Basic</a> I can do something like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">run_cmd</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Command</span><span class=\"bp\">.</span><span class=\"n\">liftTermElabM</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">registerCoercion</span><span class=\"w\"> </span><span class=\"ss\">``myfun</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">numArgs</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">coercee</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">coeFun</span><span class=\"w\"> </span><span class=\"o\">})</span>\n</code></pre></div>\n<p>but is there a better way to do this?</p>",
        "id": 481430249,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1731129931
    },
    {
        "content": "<p>As far as I know, that is the only interface to create a <code>.coeFun</code> entry. At least core Lean provides no additional interface.</p>",
        "id": 481474652,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731169999
    },
    {
        "content": "<p>Is there anything for <code>.coeSort</code>?</p>",
        "id": 481474740,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1731170090
    },
    {
        "content": "<p>No</p>",
        "id": 481475202,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731170500
    },
    {
        "content": "<p>(I'm just doing \"go to references\" on these constructors from within VS Code. That's just answering \"does core Lean have any interfaces\")</p>",
        "id": 481475286,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731170546
    },
    {
        "content": "<p>I'm interested in correct delaboration of these — should we have <code>@[coe_sort]</code> and <code>@[coe_fun]</code> attributes to accompany <code>@[coe]</code>?</p>",
        "id": 481520976,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731208951
    },
    {
        "content": "<p>That seems sensible, yes. <a href=\"https://github.com/leanprover-community/mathlib4/blob/16c9d8c2fba7254dbeb6e41eeb0554c23e5776ec/Mathlib/Data/SetLike/Basic.lean#L115\">SetLike uses a custom delaborator</a> instead of <code>coe_sort</code>, interestingly</p>",
        "id": 481526687,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1731214591
    },
    {
        "content": "<p>As does FunLike</p>",
        "id": 481551719,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731236953
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/270676-lean4/topic/.60coe.60.20attribute.20for.20CoeFun.2FCoeSort/near/481551719\">said</a>:</p>\n<blockquote>\n<p>As does FunLike</p>\n</blockquote>\n<p>I can't find that; where's the code for that?</p>",
        "id": 481553626,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1731238598
    },
    {
        "content": "<p>Oh, maybe I'm misremembering and I contributed the custom delaborator to core not mathlib</p>",
        "id": 481572869,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731253828
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/270676-lean4/topic/.60coe.60.20attribute.20for.20CoeFun.2FCoeSort/near/481520976\">said</a>:</p>\n<blockquote>\n<p>I'm interested in correct delaboration of these — should we have <code>@[coe_sort]</code> and <code>@[coe_fun]</code> attributes to accompany <code>@[coe]</code>?</p>\n</blockquote>\n<p>Would a core PR implementing those be welcome, or should I just PR it to Mathlib?</p>",
        "id": 483181181,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1731991373
    },
    {
        "content": "<p>I think it should be welcome</p>",
        "id": 483201552,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1732003147
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"690858\">@Daniel Weber</span> Are you still interested in doing this? It would be nice to have for the purpose of pretty printing CoeFun dot notation as dot notation.</p>",
        "id": 484089081,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1732389679
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/270676-lean4/topic/.60coe.60.20attribute.20for.20CoeFun.2FCoeSort/near/484089081\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"690858\">Daniel Weber</span> Are you still interested in doing this? It would be nice to have for the purpose of pretty printing CoeFun dot notation as dot notation.</p>\n</blockquote>\n<p>I'm interested in this topic because I realized that when I use coercion in playground, there is no extra property named <code>@[coe_fun]</code> just like <code>@[coe]</code>. However, I used Coq before learning Lean4, so I need to familiarize myself with the Lean code. I would really like to help, please provide some information such as which part you are planning to change and what references are available.</p>",
        "id": 484128918,
        "sender_full_name": "Edward Zhang",
        "timestamp": 1732431260
    }
]