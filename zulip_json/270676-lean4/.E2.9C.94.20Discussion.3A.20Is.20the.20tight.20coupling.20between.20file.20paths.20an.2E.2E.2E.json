[
    {
        "content": "<p>As I'm getting more comfortable working with Lean 4 for real-world projects, I've encountered a design question that I'd like to better understand — or perhaps discuss its trade-offs with the community. In Lean 4, there seems to be a strict requirement that a file's path must match the namespace it defines. For example, if I have a file at <code>MyProject/Foo/Bar.lean</code>, then the file is expected to define the module <code>MyProject.Foo.Bar</code>, and that namespace must appear explicitly in the file via a </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">MyProject</span><span class=\"bp\">.</span><span class=\"n\">Foo</span><span class=\"bp\">.</span><span class=\"n\">Bar</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"w\"> </span><span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">MyProject</span><span class=\"bp\">.</span><span class=\"n\">Foo</span><span class=\"bp\">.</span><span class=\"n\">Bar</span>\n</code></pre></div>\n<p>block. Any mismatch between the namespace and the path will lead to errors when importing the module.</p>\n<p>From a software engineering perspective, this design feels somewhat rigid. In languages like Rust, for example, modules can be freely moved across directories, and the module hierarchy can be restructured without needing to touch the internal code — everything is driven by the <code>mod</code> and <code>use</code> declarations.</p>\n<p>In contrast, Lean's tight path–namespace coupling requires both refactoring the filesystem <em>and</em> rewriting internal module names, which makes code movement or reuse more cumbersome.</p>\n<p>So my questions are: </p>\n<ol>\n<li>Is there a deep reason for this strict coupling in Lean 4 — perhaps related to formal verification goals or tooling simplicity?</li>\n<li>Are there any known plans or proposals for more flexible module mapping in the future (e.g., via a manifest file or project-level module remapping)?</li>\n<li>How do experienced Lean users deal with this in larger projects?</li>\n</ol>\n<p>Thanks in advance! I'd love to hear your thoughts.</p>",
        "id": 523974630,
        "sender_full_name": "Junhua Gu",
        "timestamp": 1749830903
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"928880\">Junhua Gu</span> <a href=\"#narrow/channel/270676-lean4/topic/Discussion.3A.20Is.20the.20tight.20coupling.20between.20file.20paths.20and.20mod/near/523974630\">said</a>:</p>\n<blockquote>\n<p>For example, if I have a file at <code>MyProject/Foo/Bar.lean</code>, then the file is expected to define the module <code>MyProject.Foo.Bar</code>, and that namespace must appear explicitly in the file via a </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">MyProject</span><span class=\"bp\">.</span><span class=\"n\">Foo</span><span class=\"bp\">.</span><span class=\"n\">Bar</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"w\"> </span><span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">MyProject</span><span class=\"bp\">.</span><span class=\"n\">Foo</span><span class=\"bp\">.</span><span class=\"n\">Bar</span>\n</code></pre></div>\n<p>block. Any mismatch between the namespace and the path will lead to errors when importing the module.</p>\n</blockquote>\n<p>To my knowledge this is not true.</p>",
        "id": 523976279,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1749831537
    },
    {
        "content": "<p>The file <code>MyProject/Foo/Bar.lean</code> is accessed through the module <code>MyProject.Foo.Bar</code> (this appears as an <code>import MyProject.Foo.Bar</code> statement at the top of your file), but there is no requirement at all about namespacing.</p>",
        "id": 523976762,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1749831704
    },
    {
        "content": "<p>So when you move a file, all you need to do is change the <code>import</code> statements of everything that imports that file directly to reflect its new location.</p>",
        "id": 523977143,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1749831854
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"928880\">Junhua Gu</span> <a href=\"#narrow/channel/270676-lean4/topic/Discussion.3A.20Is.20the.20tight.20coupling.20between.20file.20paths.20and.20mod/near/523974630\">said</a>:</p>\n<blockquote>\n<p>if I have a file at <code>MyProject/Foo/Bar.lean</code>, then the file is expected to define the module <code>MyProject.Foo.Bar</code></p>\n</blockquote>\n<p>This is true, however. \"file\" and \"module\" are indistinguishable in current Lean</p>",
        "id": 524020564,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1749853043
    },
    {
        "content": "<p>The wording as written is not true, there is no \"expected\" here, the file <em>unavoidably</em> defines the module even if empty.</p>",
        "id": 524021012,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1749853461
    },
    {
        "content": "<p>Yes, you're absolutely right :-)</p>",
        "id": 524021197,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1749853604
    },
    {
        "content": "<p>Thanks a lot for the detailed explanation, that makes much more sense now.</p>",
        "id": 524035946,
        "sender_full_name": "Junhua Gu",
        "timestamp": 1749869437
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"928880\">Junhua Gu</span> has marked this topic as resolved.</p>",
        "id": 524035949,
        "sender_full_name": "Notification Bot",
        "timestamp": 1749869442
    }
]