[
    {
        "content": "<p>Is it possible to use an environment variable as the path to a dependency in <code>lakefile.{toml,lean}</code>, as opposed to a git hash?</p>",
        "id": 516540399,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1746568907
    },
    {
        "content": "<p>I am not quite sure what you mean. Perhaps <code>require ... from run_io IO.getEnv \"PKG_PATH\"</code> would do what you want in <code>lakefile.lean</code>?</p>",
        "id": 518859823,
        "sender_full_name": "Mac Malone",
        "timestamp": 1747520074
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"315577\">Mac Malone</span> <a href=\"#narrow/channel/270676-lean4/topic/Envvar.20dependency.20path/near/518859823\">said</a>:</p>\n<blockquote>\n<p>I am not quite sure what you mean. Perhaps <code>require ... from run_io IO.getEnv \"PKG_PATH\"</code> would do what you want in <code>lakefile.lean</code>?</p>\n</blockquote>\n<p>this is perfect</p>",
        "id": 519218195,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1747686971
    },
    {
        "content": "<p>wouldn't this interfere with the lock file?</p>",
        "id": 519218252,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1747686987
    },
    {
        "content": "<p>Yes. One would need to run <code>lake -R update &lt;env-pkg-name&gt;</code> whenever the locked path should change.</p>",
        "id": 519226177,
        "sender_full_name": "Mac Malone",
        "timestamp": 1747689380
    },
    {
        "content": "<p>well this couldnt be used with nix then</p>",
        "id": 519226213,
        "sender_full_name": "Leni Aniva",
        "timestamp": 1747689394
    },
    {
        "content": "<p>It is also possible to just remove the environment-dependent dependency from the lockfile-- then it will always follow the configured path. The configuration itself is also cached, so Lake would need to be run with <code>lake -R</code> whenever it should recheck the enviroment (by reconfiguring).</p>",
        "id": 519226627,
        "sender_full_name": "Mac Malone",
        "timestamp": 1747689525
    },
    {
        "content": "<p>(The reason for all this caching is that Lake is aiming for eproducible builds and thus attempts to avoid dynamic, shifting state.)</p>",
        "id": 519227117,
        "sender_full_name": "Mac Malone",
        "timestamp": 1747689706
    }
]