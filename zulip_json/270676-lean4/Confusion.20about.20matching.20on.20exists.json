[
    {
        "content": "<p>Sometimes I can match on exists and sometimes I cannot, resulting in an error \"Case tag 'rhs' not found.\", I'm a bit confused as to how and when this occurs.</p>\n<p><a href=\"/user_uploads/3121/R75Sm-o2KAuOEillXOcAx3N5/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/R75Sm-o2KAuOEillXOcAx3N5/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1193x337\" src=\"/user_uploads/thumbnail/3121/R75Sm-o2KAuOEillXOcAx3N5/image.png/840x560.webp\"></a></div><p>Is there some way I can get the witness of the exists in this instance?</p>",
        "id": 543777653,
        "sender_full_name": "Anna Williams",
        "timestamp": 1759937282
    },
    {
        "content": "<p>i don't know what the error means because you didn't provide an <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> , but you can't eliminate from Prop into data, so there is no way to get the witness computably from an exists</p>",
        "id": 543778023,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759937362
    },
    {
        "content": "<p>that's weird</p>",
        "id": 543778215,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759937400
    },
    {
        "content": "<p>there are ways around this, but i'm refraining from saying them, because usually it means you're in the wrong situation and \"eliminating prop into data\" is not the right step to take in this instance</p>",
        "id": 543778238,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759937404
    },
    {
        "content": "<p>consider using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Exists.choose#doc\">docs#Exists.choose</a> instead</p>",
        "id": 543778347,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759937428
    },
    {
        "content": "<p>that's the workaround i was deliberately omitting</p>",
        "id": 543778427,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759937451
    },
    {
        "content": "<p>your theorem <code>lubUnique</code> probably does not mean what you think it does</p>",
        "id": 543778557,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759937484
    },
    {
        "content": "<p>Lean has proof irrelevance so any two proofs of the same thing are automatically equal</p>",
        "id": 543778669,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759937511
    },
    {
        "content": "<p>oh yeah, that too</p>",
        "id": 543778702,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759937519
    },
    {
        "content": "<p>When you say \"proof irrelevance\" do you mean that the entire thing is forgotten or that just the proof corresponding to one witness is forgotten? I think this is where I'm getting confused</p>",
        "id": 543785047,
        "sender_full_name": "Anna Williams",
        "timestamp": 1759939415
    },
    {
        "content": "<p>I've tried using <code>Σ'</code>which I know keeps the data, but then I run into problems with certain structures being Types instead of Props</p>",
        "id": 543785627,
        "sender_full_name": "Anna Williams",
        "timestamp": 1759939566
    },
    {
        "content": "<p>the problem is that you're trying to translate some natural language directly into symbol without considering the logic behind</p>",
        "id": 543786056,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759939689
    },
    {
        "content": "<p>I don't think that's very helpful?</p>",
        "id": 543786849,
        "sender_full_name": "Anna Williams",
        "timestamp": 1759939928
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"934271\">Anna Williams</span> <a href=\"#narrow/channel/270676-lean4/topic/Confusion.20about.20matching.20on.20exists/near/543785047\">said</a>:</p>\n<blockquote>\n<p>When you say \"proof irrelevance\" do you mean that the entire thing is forgotten or that just the proof corresponding to one witness is forgotten? I think this is where I'm getting confused</p>\n</blockquote>\n<p>Proof irrelevance means that any two proofs of the same theorem are always considered equal</p>",
        "id": 543796064,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759942878
    },
    {
        "content": "<p>so for example, any two proofs of <code>∃ a : D, LeastUpperBound p a S</code> will be definitionally equal</p>",
        "id": 543796408,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1759942990
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"934271\">Anna Williams</span> <a href=\"#narrow/channel/270676-lean4/topic/Confusion.20about.20matching.20on.20exists/near/543786849\">said</a>:</p>\n<blockquote>\n<p>I don't think that's very helpful?</p>\n</blockquote>\n<p>To someone who has had little contact with formal logic, they might think about \"there exists x such that p(x)\" vaguely, and to them this might be already equivalent to having that x already, but when you're doing formal logic (especially in a verification system such as Lean), the expression \"there exists x such that p(x)\" is a proposition (i.e. a true/false statement), while the <em>witness</em> <code>x</code> itself \"contains data\" (i.e. is an object of some set), and it cannot be compared to a proposition</p>",
        "id": 543797378,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759943341
    },
    {
        "content": "<p>To clarify, a longish example. Here we have an existence theorem but cannot resolve without proving a non-trivial theorem:</p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>Noncomputable exists proof</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<h1>A Noncomputable function</h1>\n<p>An interesting example of a non-constructive proof is the following:<br>\n<strong>Theorem:</strong> There exist irrational numbers $a$ and $b$ such that $a^b$ is rational.<br>\n<strong>Proof:</strong> Let <code>b = √2</code>. If <code>b^b</code> is rational, then we can take <code>a = b</code>. Otherwise, we can take <code>a = √2^{√2}</code>, so <code>a^b=2</code>.</p>\n<p>We can prove this in Lean. But a function that returns such a pair of numbers has to be defined as <code>noncomputable</code> in Lean.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">sqrt2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">sqrt</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">sq_sq_sq_sqrt2_rational</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sqrt2</span><span class=\"bp\">^</span><span class=\"n\">sqrt2</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"n\">sqrt2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">rpow_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">mul_self_sqrt</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sqrt2</span><span class=\"bp\">^</span><span class=\"n\">sqrt2</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"n\">sqrt2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">   </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">rpow_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">mul_self_sqrt</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">There exists an irrational numbers `a` and `b` such that `a^b` is rational.</span>\n<span class=\"sd\">-/</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">irrational_power_irrational_rational</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Irrational</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">Irrational</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">∧</span>\n<span class=\"w\">    </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">Irrational</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"bp\">^</span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Irrational</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sqrt2</span><span class=\"bp\">^</span><span class=\"n\">sqrt2</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">pos</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">sqrt2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">sqrt2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sqrt2</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sq_sq_sq_sqrt2_rational</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">irrational_sqrt_two</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">neg</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">sqrt2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sqrt2</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">irrational_sqrt_two</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">assumption</span>\n</code></pre></div>\n</div></div>",
        "id": 544520785,
        "sender_full_name": "Siddhartha Gadgil",
        "timestamp": 1760353439
    },
    {
        "content": "<p>You could use Subtype.</p>",
        "id": 544537548,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1760358055
    },
    {
        "content": "<p>That is often a good way to hold \"this is a term, that satisfies a given predicate\"</p>",
        "id": 544537633,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1760358078
    },
    {
        "content": "<p>to say that there exists some x with p x is to say that there exists a term of type <code>Subtype p</code></p>",
        "id": 544537702,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1760358097
    },
    {
        "content": "<p>often a better way is to construct the term first and only afterwards prove it satisfies the predicate in a separate theorem</p>",
        "id": 544537803,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760358125
    },
    {
        "content": "<p>this doesn't always work for recursive definitions</p>",
        "id": 544537862,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760358142
    }
]