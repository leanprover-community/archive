[
    {
        "content": "<p>Hi!<br>\nI'm trying the following</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">run_cmd</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">stt</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">get</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">stt</span><span class=\"bp\">.</span><span class=\"n\">env</span><span class=\"bp\">.</span><span class=\"n\">find?</span>\n<span class=\"w\">    </span><span class=\"ss\">``Std.Tactic.BVDecide.BVExpr.bitblast.blastUdiv.denote_blastDivSubtractShift_q</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">const</span><span class=\"bp\">.</span><span class=\"n\">get!</span>\n<span class=\"w\">  </span><span class=\"n\">dbg_trace</span><span class=\"w\"> </span><span class=\"n\">const</span><span class=\"bp\">.</span><span class=\"n\">size</span>\n</code></pre></div>\n<p>Where <code>.size</code> is a function that computes the number of nodes on the constant expressions (type + value).</p>\n<p>For that theorem specifically, my computer doesn't finish. But on someone else's computer, running that as a compiled program consumes 50~70 GB of RAM and outputs... checks notes... around 28 billion <span aria-label=\"explode\" class=\"emoji emoji-1f92f\" role=\"img\" title=\"explode\">:explode:</span></p>\n<p>What's happening here? How is this virtually possible and how come my machine can type check that term in a second or two?</p>",
        "id": 540480510,
        "sender_full_name": "Arthur Paulino",
        "timestamp": 1758295138
    },
    {
        "content": "<p>The theorem has lots of common subterms that are being shared, <code>Expr.size</code> counts the nodes in the tree instead of the DAG view of the term. If you disregard term sharing exponential overhead is to be expected for sufficiently messed up terms.</p>",
        "id": 540481568,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1758295426
    },
    {
        "content": "<p>Ah, sharing. Makes a lot of sense, thanks!</p>",
        "id": 540482452,
        "sender_full_name": "Arthur Paulino",
        "timestamp": 1758295658
    },
    {
        "content": "<p>See also</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">pp</span><span class=\"bp\">.</span><span class=\"n\">exprSizes</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">Std</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">BVDecide</span><span class=\"bp\">.</span><span class=\"n\">BVExpr</span><span class=\"bp\">.</span><span class=\"n\">bitblast</span><span class=\"bp\">.</span><span class=\"n\">blastUdiv</span><span class=\"bp\">.</span><span class=\"n\">denote_blastDivSubtractShift_q</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">...</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"mi\">2575268672</span><span class=\"bp\">/</span><span class=\"mi\">6967</span><span class=\"bp\">/</span><span class=\"mi\">6967</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n</code></pre></div>",
        "id": 540482563,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1758295701
    }
]