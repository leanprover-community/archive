[
    {
        "content": "<p><code>show</code>'s docstring claims:</p>\n<blockquote>\n<p><code>show t</code>Â finds the first goal whose target unifies withÂ <code>t</code>. It makes that the main goal, performs the unification, and replaces the target with the unified version ofÂ <code>t</code>.</p>\n</blockquote>\n<p>However, when I try using it in a case where I have many separate goals, rather than trying to find a goal that matches my pattern, it tries to unify my pattern with the current main goal and fails when it doesn't match. </p>\n<p><a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">congr</span>\n<span class=\"w\">  </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">d</span>\n</code></pre></div>",
        "id": 523214221,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1749536421
    },
    {
        "content": "<p>Yes, this is a known issue, and there is an open PR <a href=\"https://github.com/leanprover/lean4/pull/7395\">lean4#7395</a> to fix this.</p>",
        "id": 523214514,
        "sender_full_name": "Markus Himmel",
        "timestamp": 1749536563
    },
    {
        "content": "<p>Please include a link to another thread if you're reposting instead of moving (<a href=\"#narrow/channel/287929-mathlib4/topic/.E2.9C.94.20.60show.60.20tactic.20docstring.20still.20accurate.3F/near/523209186\">#mathlib4 &gt; âœ” &#96;show&#96; tactic docstring still accurate? @ ðŸ’¬</a>), especially if there's already some discussion there.</p>",
        "id": 523340044,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1749576776
    },
    {
        "content": "<p>How do you move, anyway?</p>",
        "id": 523369824,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1749589376
    },
    {
        "content": "<p>I think only admins can move but probably there's little point moving now?</p>",
        "id": 523379059,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1749593658
    },
    {
        "content": "<p>Yeah, moving between channels is limited to moderators.</p>\n<p>Reposting is fine, so long as there's some trail that links together discussions, ideally in both thread. Otherwise, people might have my experience wondering \"Wait, didn't I just read this thread? What was the other one? (spend some moments digging it up) What's different between these?\"</p>",
        "id": 523382219,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1749595560
    },
    {
        "content": "<p>Aight. Yeah, when Yael made his post and I resolved the thread, I didn't expect people to keep posting ^.^;. Will do that next time.</p>",
        "id": 523382338,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1749595610
    },
    {
        "content": "<p>If you posted a link to the new thread, I'm sure discussion would have continued here :-)</p>",
        "id": 523382461,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1749595688
    },
    {
        "content": "<p>In any case, there's a better answer than <code>show</code>. Batteries has a <code>case</code> variant that uses pattern matching:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">Case</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">congr</span>\n<span class=\"w\">  </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 523382511,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1749595716
    },
    {
        "content": "<p>This has existed for two years, but mathlib still doesn't import it.</p>\n<p>It exists because one of the first times this question about <code>show</code> came up we all thought \"don't we want to move away from unstructured tactics? <code>case</code> could handle this, right?\"</p>",
        "id": 523382661,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1749595802
    },
    {
        "content": "<p>This was also in the pre-FRO period when Lean 4 wasn't accepting this kind of contribution, so <code>show</code> was not changeable, and we didn't want to override <code>show</code> in a downstream library.</p>\n<p>I think it could be nice to have a <code>show c = d =&gt; ...</code> structured variant that would be a synonym for <code>case _ : c = d =&gt; ...</code>.</p>",
        "id": 523382810,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1749595894
    },
    {
        "content": "<p>Huh. Okay, good to know.I'll try that next time it comes up.</p>",
        "id": 523384201,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1749596581
    },
    {
        "content": "<p>By the way, when you say \"mathlib doesn't import it\", is that \"mathlib won't accept a PR importing it\" or just \"mathlib doesn't yet use it anywhere\"?</p>",
        "id": 523384242,
        "sender_full_name": "Robert Maxton",
        "timestamp": 1749596603
    },
    {
        "content": "<p>It's just descriptive, not normative.</p>\n<p>I think it would be reasonable to add it to Mathlib.Tactic.Common</p>",
        "id": 523385347,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1749597260
    },
    {
        "content": "<p>I went ahead and made a PR: <a href=\"https://github.com/leanprover-community/mathlib4/pull/25706\">mathlib#25706</a></p>",
        "id": 523604821,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1749661761
    }
]