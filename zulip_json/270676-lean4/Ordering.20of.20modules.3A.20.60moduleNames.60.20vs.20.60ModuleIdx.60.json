[
    {
        "content": "<p>The <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.EnvironmentHeader#doc\">docs#Lean.EnvironmentHeader</a> contains a <code>moduleNames</code> field that is an <code>Array</code> of <code>Name</code>s containing all (transitively) imported module names of the current file.</p>",
        "id": 495373551,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737580005
    },
    {
        "content": "<p>For most functions, though, Lean refers to imported modules not by <code>Name</code>, but by <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.ModuleIdx#doc\">docs#Lean.ModuleIdx</a>, a type alias of <code>Nat</code>.</p>",
        "id": 495373563,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737580011
    },
    {
        "content": "<p>This means that it is easy to find the <em>index</em> of a module, but you then have to convert this index to a <code>Name</code> in some way.</p>",
        "id": 495373579,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737580019
    },
    {
        "content": "<p>Empirically, the <em>order</em> of the module names in <code>moduleNames</code> is exactly the <code>ModuleIdx</code> of the module.</p>",
        "id": 495373609,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737580027
    },
    {
        "content": "<p>Was I lucky?  <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 495373628,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737580034
    },
    {
        "content": "<p>Can I count on this?</p>",
        "id": 495373636,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737580038
    },
    {
        "content": "<p>Should this be documented?</p>",
        "id": 495373642,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737580040
    },
    {
        "content": "<p>(This question came from the comments to <a href=\"https://github.com/leanprover-community/mathlib4/pull/20908\">#20908</a> that exploits this \"feature\".)</p>",
        "id": 495373718,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737580074
    },
    {
        "content": "<p>Answered during office hours: the correspondence of <code>ModuleIdx</code> and \"index in the array of module names\" has been around for a long time and is also used by doc-gen.</p>",
        "id": 495386590,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737585623
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/pull/6749\">lean4#6749</a></p>",
        "id": 495388901,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737586825
    },
    {
        "content": "<p>Kyle mentioned also <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.findModuleOf%3F#doc\">docs#Lean.findModuleOf?</a>, which was a perfect fit for my application.</p>",
        "id": 495531885,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1737647643
    }
]