[
    {
        "content": "<p>Can I disable automatic opening of a namespace for the declaration name prefix?<br>\nI would like everything inside a declaration to be evaluated the same way as if it was <code>example</code> instead.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">map_comp_comp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">l</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">l</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- I want `map (g ∘ f) l` to be a syntax error</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">fg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"n\">fg</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n</code></pre></div>\n<p>In the example above, I would like to be forced to write <code>List.map (g ∘ f) l</code> or <code>l.map (g ∘ f)</code> because <code>map (g ∘ f) l</code> would cause a syntax error. Currently <code>map (g ∘ f) l</code> is allowed and I don't like it.</p>",
        "id": 484876887,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1732786767
    },
    {
        "content": "<p>Is what you are asking to <code>protect</code> the <code>List.map</code> declaration?</p>",
        "id": 484877740,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1732786999
    },
    {
        "content": "<p>I would like to have a project-wide setting that makes this behaviour default.</p>",
        "id": 484878207,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1732787119
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"417654\">@Martin Dvořák</span>, I guess this could be turned off, but why do you want this?</p>",
        "id": 484878566,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732787214
    },
    {
        "content": "<p>I want to force myself to write code in a way that will be readable for me later.</p>",
        "id": 484878681,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1732787245
    },
    {
        "content": "<p>And also, I don't want to have name changes break the insides.</p>",
        "id": 484878786,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1732787279
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"417654\">Martin Dvořák</span> <a href=\"#narrow/channel/270676-lean4/topic/Disable.20automatic.20namespace/near/484878681\">said</a>:</p>\n<blockquote>\n<p>I want to force myself to write code in a way that will be readable for me later.</p>\n</blockquote>\n<p>You'll probably say that I should use linters for that, not project settings.</p>",
        "id": 484879421,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1732787447
    },
    {
        "content": "<p>I find that the automatic <code>open X</code> when the declaration name is <code>X.y</code> is usually very useful, but does create some unpleasant situations.  So, having a mechanism to disable the automatic namespacing is something that I would also find useful.</p>",
        "id": 484879767,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1732787535
    },
    {
        "content": "<p>I basically never want it; it makes the output of <code>simp?</code> hardly readable for me.</p>",
        "id": 484879916,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1732787587
    },
    {
        "content": "<p>RFC: <a href=\"https://github.com/leanprover/lean4/issues/6436\">https://github.com/leanprover/lean4/issues/6436</a></p>",
        "id": 490468990,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1734940102
    },
    {
        "content": "<p>I don't think \"is allowed and I don't like it\" is really RFC-appropriate: you should explain what is undesirable about it rather than just stating a personal evaluation.</p>",
        "id": 490509449,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1734956563
    },
    {
        "content": "<p>Ultimately, it is all my personal opinion. What is undesirable, however, is that the body of a declaration can change its semantics when the name of the declaration changes (albeit not the main reason why I created the RFC).</p>",
        "id": 490510207,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1734956902
    },
    {
        "content": "<p>RFC (second attempt): <a href=\"https://github.com/leanprover/lean4/issues/6855\">https://github.com/leanprover/lean4/issues/6855</a></p>",
        "id": 496598883,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1738171105
    }
]