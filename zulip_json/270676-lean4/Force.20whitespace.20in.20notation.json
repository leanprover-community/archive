[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n\n<span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"s2\">\"Σ\"</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"n\">arg</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"n\">arg</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">x</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- Σ0Int : Type</span>\n</code></pre></div>\n<p>If I define a notation like this, Lean automatically deletes the whitespace between <code>0</code> and <code>Int</code>. Is there a way to force Lean to put the whitespace back in?</p>\n<p>This is giving me an issue because of the new whitespace linter complaining about the extra space when I do write <code>Σ0 Int</code>.</p>",
        "id": 528177712,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752193297
    },
    {
        "content": "<p>I would say to use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Parser.ppSpace#doc\">docs#Lean.Parser.ppSpace</a> but that doesn't seem to be working here</p>",
        "id": 528179494,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752194707
    },
    {
        "content": "<p>I don't know how to get the space there with <code>notation</code>, but you should be able to get what you want with <code>syntax</code>.</p>",
        "id": 528184310,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752199031
    },
    {
        "content": "<p>There is a similar issue with another notation and I added the notation to the list of exceptions for the linter: you could also do that.</p>",
        "id": 528184351,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752199076
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/blob/master/Mathlib%2FTactic%2FLinter%2FCommandStart.lean#L235\">https://github.com/leanprover-community/mathlib4/blob/master/Mathlib%2FTactic%2FLinter%2FCommandStart.lean#L235</a></p>",
        "id": 528184466,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752199178
    },
    {
        "content": "<p>You could add the name of the syntax node to this list as well.</p>",
        "id": 528184517,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752199212
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> <a href=\"#narrow/channel/270676-lean4/topic/Force.20whitespace.20in.20notation/near/528184351\">said</a>:</p>\n<blockquote>\n<p>There is a similar issue with another notation and I added the notation to the list of exceptions for the linter: you could also do that.</p>\n</blockquote>\n<p>Did syntax not work in that case?</p>",
        "id": 528185402,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752199993
    },
    {
        "content": "<p>I did not try it, since I was trying the get mathlib to compile with the smallest change to pre-existing code.</p>",
        "id": 528185917,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752200440
    },
    {
        "content": "<p>Once the linter \"works\", I plan to revisit the exceptions and try to iron them out, when possible.</p>",
        "id": 528185966,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752200481
    },
    {
        "content": "<p>Not sure if there's a better way:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n\n<span class=\"kn\">macro</span><span class=\"w\"> </span><span class=\"s2\">\"Σ \"</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"o\">:</span><span class=\"n\">arg</span><span class=\"w\"> </span><span class=\"n\">ppSpace</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"o\">:</span><span class=\"n\">arg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">x</span><span class=\"o\">)</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">app_unexpander</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"kd\">]</span>\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">unexpandG</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">PrettyPrinter</span><span class=\"bp\">.</span><span class=\"n\">Unexpander</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"bp\">$_</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"bp\">Σ</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">throw</span><span class=\"w\"> </span><span class=\"o\">()</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- Σ 0 Int : Type</span>\n</code></pre></div>",
        "id": 528203437,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1752214568
    }
]