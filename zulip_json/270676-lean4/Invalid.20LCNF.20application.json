[
    {
        "content": "<p>Does this look like a compiler bug worth reporting?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c\">/-</span>\n<span class=\"cm\">Lean 4.23.0-nightly-2025-08-04</span>\n<span class=\"cm\">Target: x86_64-unknown-linux-gnu</span>\n<span class=\"cm\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">version</span>\n\n<span class=\"c\">/-</span>\n<span class=\"cm\">invalid LCNF application</span>\n<span class=\"cm\">  âŸ¨Type 1, TypeâŸ©</span>\n<span class=\"cm\">argument</span>\n<span class=\"cm\">  Type</span>\n<span class=\"cm\">has type</span>\n<span class=\"cm\">  (fun A =&gt; A) lcAny</span>\n<span class=\"cm\">must be a free variable</span>\n<span class=\"cm\">-/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">pair</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">Ã—</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">âŸ¨</span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"bp\">âŸ©</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">compiler</span><span class=\"bp\">.</span><span class=\"n\">checkTypes</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"c\">/-</span>\n<span class=\"cm\">type mismatch at LCNF application</span>\n<span class=\"cm\">  âŸ¨Type 1, TypeâŸ©</span>\n<span class=\"cm\">argument Type has type</span>\n<span class=\"cm\">  Type 1</span>\n<span class=\"cm\">but is expected to have type</span>\n<span class=\"cm\">  (fun A =&gt; A) lcAny</span>\n<span class=\"cm\">-/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">pair'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">Ã—</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">âŸ¨</span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"bp\">âŸ©</span>\n</code></pre></div>",
        "id": 532790647,
        "sender_full_name": "ğš ğš˜ğš“ğšŒğš’ğšğšŒğš‘ ğš—ğšŠğš ğš›ğš˜ğšŒğš”ğš’",
        "timestamp": 1754338478
    },
    {
        "content": "<p>Yes. I have seen this before during development (of a patch I never landed) on a  much more complicated example and couldn't quite decide the right course of action. This is almost as simple as it gets, so it will probably be illuminating. My guess is that there are slightly different assumptions in different parts of the frontend of the compiler about what exactly should be erased.</p>\n<p>Note that <code>compiler.checkTypes</code> isn't particularly helpful in general, since there are lots of little things that can legitimately destroy typeability during compilation.</p>",
        "id": 532795971,
        "sender_full_name": "Cameron Zwarich",
        "timestamp": 1754340656
    },
    {
        "content": "<p>Reported under <a href=\"https://github.com/leanprover/lean4/pull/9692\">lean4#9692</a>.</p>",
        "id": 532801180,
        "sender_full_name": "ğš ğš˜ğš“ğšŒğš’ğšğšŒğš‘ ğš—ğšŠğš ğš›ğš˜ğšŒğš”ğš’",
        "timestamp": 1754343094
    }
]