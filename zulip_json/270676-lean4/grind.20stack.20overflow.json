[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">h₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">h₃</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">h₄</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"bp\">^</span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"n\">grind</span>\n</code></pre></div>\n<p>produces a <code>Stack overflow detected. Aborting.</code> on both 4.24.0-rc1 and lean4 master. The stack trace seems to suggest it's some interaction between <code>lean_nat_big_sub</code> and <code>Int.pow</code> -- besides confirming this isn't a known issue I'm curious to learn how to diagnose further.</p>\n<p>(CC <span class=\"user-mention\" data-user-id=\"921547\">@Leo</span> who found the example.)</p>",
        "id": 544180171,
        "sender_full_name": "Julian Berman",
        "timestamp": 1760105680
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"221653\">@Paul Reichert</span>, This seems like it could be a similar issue to your instance of <a href=\"https://github.com/leanprover/lean4/pull/5935\">lean4#5935</a>.</p>",
        "id": 544211324,
        "sender_full_name": "Mac Malone",
        "timestamp": 1760114465
    },
    {
        "content": "<p>Interesting! I was suspecting that <em>my</em> issue was related to <code>BitVec</code> arithmetic in kernel and elaborator, so I'm surprised that there is also an example the only uses <code>Nat</code>.</p>",
        "id": 544218568,
        "sender_full_name": "Paul Reichert",
        "timestamp": 1760117427
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321696\">Julian Berman</span> <a href=\"#narrow/channel/270676-lean4/topic/grind.20stack.20overflow/near/544180171\">said</a>:</p>\n<blockquote>\n<p>and <code>Int.pow</code></p>\n</blockquote>\n<p>Could it be related to the fact that <code>Int.pow</code> is not tail recursive (see <a href=\"#narrow/channel/270676-lean4/topic/Large.20powers.20of.20.601.60.20and.20.60-1.60/near/530617797\">https://leanprover.zulipchat.com/#narrow/channel/270676-lean4/topic/Large.20powers.20of.20.601.60.20and.20.60-1.60/near/530617797</a>)</p>",
        "id": 544220794,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760118301
    },
    {
        "content": "<p>(Sorry to raise this old thread from the dead, but just noting that this has been fixed in the meantime.)</p>",
        "id": 563106999,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1765431025
    }
]