[
    {
        "content": "<p>In Coq, the ‘replace m with n’ tactic asks for a proof of ‘m = n’ and replaces all occurrences of ‘m’ in the current goal with ‘n’. Is there a similar tactic in Lean?</p>",
        "id": 492649404,
        "sender_full_name": "Qiancheng Fu",
        "timestamp": 1736406914
    },
    {
        "content": "<p>You can use <code>subst</code> on an equality proof</p>",
        "id": 492649493,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1736406951
    },
    {
        "content": "<p>I will have to manually clear the equality proof from my context after the substitution right?</p>",
        "id": 492649695,
        "sender_full_name": "Qiancheng Fu",
        "timestamp": 1736407026
    },
    {
        "content": "<p><code>conv</code> tactic <code>equals_to</code> should help here.</p>\n<p>Ah, but that doesn't replace all occurrences</p>",
        "id": 492659644,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1736410696
    },
    {
        "content": "<p>Then there is the idiom <code>rw [show m = n by …]</code></p>",
        "id": 492659784,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1736410753
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"815400\">Qiancheng Fu</span> <a href=\"#narrow/channel/270676-lean4/topic/Is.20there.20a.20tactic.20similar.20to.20.E2.80.9Creplace.20with.E2.80.9D.20in.20Coq.3F/near/492649695\">said</a>:</p>\n<blockquote>\n<p>I will have to manually clear the equality proof from my context after the substitution right?</p>\n</blockquote>\n<p>Not with <code>subst</code>, although <code>subst</code> only works if one side is a variable.</p>",
        "id": 492744354,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1736435054
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/channel/270676-lean4/topic/Is.20there.20a.20tactic.20similar.20to.20.E2.80.9Creplace.20with.E2.80.9D.20in.20Coq.3F/near/492659784\">said</a>:</p>\n<blockquote>\n<p>Then there is the idiom <code>rw [show m = n by …]</code></p>\n</blockquote>\n<p>The <code>rw [show m = n by ...]</code> is fairly close to what I want, though when writing the proof inside <code>by ...</code>, the goal doesn't seem to be updated. I've elected to just write my own tactic that implements the behavior of Coq's <code>replace with</code>.</p>",
        "id": 492780619,
        "sender_full_name": "Qiancheng Fu",
        "timestamp": 1736444764
    },
    {
        "content": "<p>A related idiom is using a named metavariable for the proof, like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">pf</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">pf</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 492785555,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1736445894
    },
    {
        "content": "<p>Ahh, that’s nice!</p>",
        "id": 492785732,
        "sender_full_name": "Qiancheng Fu",
        "timestamp": 1736445939
    },
    {
        "content": "<p>I usually do that kind of things using</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hmn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hmn</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>or if you prefer to do it in a different order:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">suffices</span><span class=\"w\"> </span><span class=\"n\">hmn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hmn</span><span class=\"o\">]</span>\n<span class=\"w\">   </span><span class=\"bp\">...</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 492823534,
        "sender_full_name": "Miguel Marco",
        "timestamp": 1736458752
    },
    {
        "content": "<p>That’s a natural thing to do, and probably one of the earliest approach users find. What I don’t like about this is that it clutters the infoview with these additional assumptions <code>hmn</code> that I only meant to use once.</p>",
        "id": 492834180,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1736462899
    }
]