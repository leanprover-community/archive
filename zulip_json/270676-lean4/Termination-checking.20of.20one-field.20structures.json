[
    {
        "content": "<p>Is this something that could be supported by the equation compiler?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">WrappedFunc</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">func</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">factorial</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WrappedFunc</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">func</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">factorial</span><span class=\"bp\">.</span><span class=\"n\">func</span><span class=\"w\"> </span><span class=\"n\">n</span>\n</code></pre></div>",
        "id": 538954813,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757632320
    },
    {
        "content": "<p>I can cheat with</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">factorial</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WrappedFunc</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">func</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">func</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">factorial</span><span class=\"bp\">.</span><span class=\"n\">func</span><span class=\"w\"> </span><span class=\"n\">n</span>\n</code></pre></div>\n<p>but then the equation lemma is <code>WrappedFunc.func factorial (n + 1) = n * factorial.func n</code>, where the RHS is not dot notation</p>",
        "id": 538954887,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757632374
    },
    {
        "content": "<p>(probably a question for <span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span>)</p>",
        "id": 538954932,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757632416
    },
    {
        "content": "<p>The context is <a href=\"#narrow/channel/287929-mathlib4/topic/Changing.20.60Stream.2ESeq.60.20to.20use.20.60GetElem.60/near/538548680\">#mathlib4 &gt; Changing &#96;Stream.Seq&#96; to use &#96;GetElem&#96; @ ðŸ’¬</a></p>",
        "id": 538955108,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757632577
    },
    {
        "content": "<p>Hmm, that reminds me of an issue I looked at recently. I think it was related to type classesâ€¦ ah, no, that was about nested induction.</p>\n<p>Iâ€™m not sure how to support it easily. There must be some kind of etwa-expansion happening, to expose the function parameter for the function inside <code>factorial : WrappedFunc</code>. So not completely impossible, but not a quick feature to add.</p>",
        "id": 539002708,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1757663412
    }
]