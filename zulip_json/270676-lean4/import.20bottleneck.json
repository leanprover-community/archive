[
    {
        "content": "<p>Hi! On our web interface <a href=\"https://lean.math.hhu.de/#code=import%20Mathlib\">https://lean.math.hhu.de/#code=import%20Mathlib</a>, importing mathlib takes more than 20s. On my laptop, it only takes 3s. What is the bottleneck here? Is it hard disk speed?</p>",
        "id": 339835574,
        "sender_full_name": "Alexander Bentkamp",
        "timestamp": 1678100101
    },
    {
        "content": "<p>that doesn't seem like an official Lean website</p>",
        "id": 339835890,
        "sender_full_name": "Locria Cyber",
        "timestamp": 1678100192
    },
    {
        "content": "<p>No, it's ours, and I would like to make it faster if possible.</p>",
        "id": 339836345,
        "sender_full_name": "Alexander Bentkamp",
        "timestamp": 1678100346
    },
    {
        "content": "<p>OT: I really appreciate your efforts! I want to use <a href=\"https://lean.math.hhu.de/\">https://lean.math.hhu.de/</a> for my students (as one of the options).</p>",
        "id": 339837148,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1678100595
    },
    {
        "content": "<p>Here is the timing on my laptop:</p>\n<div class=\"codehilite\" data-code-language=\"Bash Session\"><pre><span></span><code><span class=\"gp\">$ </span><span class=\"nb\">echo</span><span class=\"w\"> </span><span class=\"s1\">'import Mathlib'</span><span class=\"w\"> </span><span class=\"p\">|</span><span class=\"w\"> </span>lake<span class=\"w\"> </span>env<span class=\"w\"> </span><span class=\"nb\">time</span><span class=\"w\"> </span>lean<span class=\"w\"> </span>--stdin<span class=\"w\"> </span>--profile\n<span class=\"go\">interpretation of Mathlib.Prelude.Rename.binportTag took 318ms</span>\n<span class=\"go\">interpretation of Lean.mkStateFromImportedEntries._at.Mathlib.Prelude.Rename.initFn._@.Mathlib.Mathport.Rename._hyg.251._spec_1 took 299ms</span>\n<span class=\"go\">import took 852ms</span>\n<span class=\"go\">cumulative profiling times:</span>\n<span class=\"go\">    elaboration 0.0386ms</span>\n<span class=\"go\">    import 852ms</span>\n<span class=\"go\">    initialization 22.5ms</span>\n<span class=\"go\">    interpretation 784ms</span>\n<span class=\"go\">    linting 0.0482ms</span>\n<span class=\"go\">    parsing 0.00384ms</span>\n<span class=\"go\">1.25user 0.35system 0:01.72elapsed 93%CPU (0avgtext+0avgdata 1690552maxresident)k</span>\n<span class=\"go\">253160inputs+0outputs (439major+70565minor)pagefaults 0swaps</span>\n</code></pre></div>\n<p>If the CPU time doesn't scale up on your server, disk bottleneck seems likely, yes</p>",
        "id": 339837298,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1678100643
    },
    {
        "content": "<p>14 messages were moved from this topic to <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/stream/287929-mathlib4/topic/Problems.20building.20mathlib4\">#mathlib4 &gt; Problems building mathlib4</a> by <span class=\"user-mention silent\" data-user-id=\"110024\">Sebastian Ullrich</span>.</p>",
        "id": 339881037,
        "sender_full_name": "Notification Bot",
        "timestamp": 1678112447
    }
]