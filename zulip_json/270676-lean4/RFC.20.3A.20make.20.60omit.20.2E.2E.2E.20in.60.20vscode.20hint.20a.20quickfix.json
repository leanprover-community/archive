[
    {
        "content": "<p>With the recent changes in the behaviour of <code>variable</code> we seem to get hints about including or omitting section variables as shown in the screenshot<br>\n<a href=\"/user_uploads/3121/NrRo8pnDFL68FbXODwE-CMCd/Screenshot-from-2024-10-31-15-43-58.png\">Screenshot from 2024-10-31 15-43-58.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/NrRo8pnDFL68FbXODwE-CMCd/Screenshot-from-2024-10-31-15-43-58.png\" title=\"Screenshot from 2024-10-31 15-43-58.png\"><img data-original-dimensions=\"1923x802\" src=\"/user_uploads/thumbnail/3121/NrRo8pnDFL68FbXODwE-CMCd/Screenshot-from-2024-10-31-15-43-58.png/840x560.webp\"></a></div><p>Can we get these as automatic vscode quick-fixes instead?</p>\n<p>CC : <span class=\"user-mention\" data-user-id=\"221921\">@Marc Huisinga</span></p>",
        "id": 479894614,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730385947
    },
    {
        "content": "<p>The problem is that <code>omit</code> is intended as \"last resort\", and reorganizing is hard to do automatically.</p>",
        "id": 479967320,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730413229
    },
    {
        "content": "<p>But it doesn't need to. The LSP is already suggesting the line <code>omit ... in</code></p>",
        "id": 479968247,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730413808
    },
    {
        "content": "<p>It just needs to insert the line</p>",
        "id": 479968264,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730413818
    },
    {
        "content": "<p>Or offer a quickfix option to do that</p>",
        "id": 479968277,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730413830
    },
    {
        "content": "<p>Like Haskell does</p>",
        "id": 479968287,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730413838
    },
    {
        "content": "<p>What I am saying is that that is not the preferred solution, so we should <em>not</em> provide a code action, because that would encourage users to do the non-preferred thing.</p>",
        "id": 479985080,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730427203
    },
    {
        "content": "<p>Okay I see. But what's the preferred way to handle this? Not have variables? Or use sections more often?   </p>\n<p>I put these typeclass variable declarations of Fintyoe and DecidableEq on top of the namespace because for the topic, these are true by definition throughout this subfield of discrete fair division.</p>",
        "id": 480030545,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730457521
    },
    {
        "content": "<p>Yes, more sections, possibly rearranging lemmas so that the variables are required for shorter scopes.</p>\n<p>It's not perfect, but there was a lot of problems and dissatisfaction with the previous variables behaviour!</p>",
        "id": 480030794,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730457622
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/270676-lean4/topic/RFC.20.3A.20make.20.60omit.20.2E.2E.2E.20in.60.20vscode.20hint.20a.20quickfix/near/479985080\">said</a>:</p>\n<blockquote>\n<p>What I am saying is that that is not the preferred solution, so we should <em>not</em> provide a code action, because that would encourage users to do the non-preferred thing.</p>\n</blockquote>\n<p>How about if the code action emitted</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- TODO: remove `omit in` and move to another section instead</span>\n<span class=\"n\">omit</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Bar</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">in</span>\n</code></pre></div>",
        "id": 480032321,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1730458322
    },
    {
        "content": "<p>I like this idea. I am currently tempted to just disable this linter altogether, because creating sections to handle this while developing lemmas is a bit tedious</p>",
        "id": 480032906,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730458592
    },
    {
        "content": "<p>Eric, that would be a hindrance to trying to track / eliminate TODOs in Mathlib.</p>",
        "id": 480060000,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1730470997
    },
    {
        "content": "<p>I don't see the disadvantage os using omit over tedious rearrangement and sectioning</p>",
        "id": 480061346,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730471485
    },
    {
        "content": "<p>My preference might be because in general I favour organising code for semantic reasons. Not tooling issues</p>",
        "id": 480062521,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730471889
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/270676-lean4/topic/RFC.20.3A.20make.20.60omit.20.2E.2E.2E.20in.60.20vscode.20hint.20a.20quickfix/near/480060000\">said</a>:</p>\n<blockquote>\n<p>Eric, that would be a hindrance to trying to track / eliminate TODOs in Mathlib.</p>\n</blockquote>\n<p>We'd reject them in review, but the point is that the options you have now are:</p>\n<ol>\n<li>Ignore the warning, and end up with theorems with extra assumptions that will trip you up later</li>\n<li>Do the resectioning immediately, which is a annoying while trying to prove things</li>\n<li>Copy the <code>omit ... in</code> command from the infoview (which can also be annoying), and come back to it later</li>\n</ol>\n<p>While you should obviously do 2 before contributing to mathlib, while developing 3 is less of a footgun than 1, and so we should make it as easy as possible.</p>",
        "id": 480066950,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1730473584
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 480081834,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730479052
    }
]