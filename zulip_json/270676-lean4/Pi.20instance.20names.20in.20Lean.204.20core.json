[
    {
        "content": "<p>The instances <a href=\"https://leanprover-community.github.io/mathlib_docs/find/pi.inhabited\">docs3#pi.inhabited</a> and <a href=\"https://leanprover-community.github.io/mathlib_docs/find/pi.subsingleton\">docs3#pi.subsingleton</a> are auto-named in Lean 4 core, and called <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=instInhabitedForAll_1#doc\">docs#instInhabitedForAll_1</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=instSubsingletonForAll#doc\">docs#instSubsingletonForAll</a> instead - a few porting notes also comment on this. Would it be sensible to try to rename these? I'd be happy with a mathlib alias or a change in core, since we do have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Pi.Fintype#doc\">docs#Pi.Fintype</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Pi.Nonempty#doc\">docs#Pi.Nonempty</a></p>",
        "id": 397997260,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1698029065
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span>, could you add them as aliases in mathlib, with a link to <a href=\"https://github.com/leanprover/lean4/pull/2343\">lean4#2343</a>?</p>",
        "id": 398001943,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1698031674
    },
    {
        "content": "<p>Is there any reason not to rename these in core, besides being a waste of reviewer time? At this point I've probably spent more time trying to figure out if <code>alias</code> is safe for instances...</p>",
        "id": 398158365,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1698096350
    },
    {
        "content": "<p>Sorry about this. Just the usual answer: reviewing external PRs at Lean4 is still occupying more time that we have available for it, so wherever possible if fixes can be done downstream we'd prefer that.</p>\n<p>Renaming instances by hand is time that could be spent on <a href=\"https://github.com/leanprover/lean4/pull/2343\">lean4#2343</a> instead. :-)</p>",
        "id": 398172299,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1698105239
    },
    {
        "content": "<p>Coming back to this, is this still the best way forward? The previously mentioned issue <a href=\"https://github.com/leanprover/lean4/pull/2343\">lean4#2343</a> is closed, but the names here are still the sub-optimal ones, and there are still outstanding porting notes for this.</p>",
        "id": 465361751,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1724745557
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span>, yes, I'm happy to rename these. Could you either tell me exactly what you want changed, or make a PR?</p>",
        "id": 465439052,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1724762893
    },
    {
        "content": "<p>Yes: </p>\n<p>The instance</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Nonempty</span><span class=\"bp\">.</span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">ofNonempty</span>\n</code></pre></div>\n<p>on line 760 in lean/Init/Prelude.lean should have name <code>Pi.instNonempty</code>.</p>\n<p>The instance</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Inhabited</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Inhabited</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">default</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">default</span>\n</code></pre></div>\n<p>on line 769 in lean/Init/Prelude.lean should have name <code>Pi.instInhabited</code>.</p>\n<p>The instance</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Subsingleton</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subsingleton</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">allEq</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Subsingleton</span><span class=\"bp\">.</span><span class=\"n\">elim</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>on line 1840 in lean/Init/Core.lean should have name <code>Pi.instSubsingleton</code>.</p>\n<p>There are also instances on lines 757 and 766 which appear - to me - unnecessary, but I'll leave the question of what to do there up to you.</p>",
        "id": 466248246,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1725018108
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span>, <a href=\"https://github.com/leanprover/lean4/pull/5447\">lean#5447</a></p>",
        "id": 472390804,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1727150033
    },
    {
        "content": "<p>Thank you! I expect that the mathlib breakage here should be easy to fix, but regardless I'm happy to help with fixing it in any way</p>",
        "id": 472444403,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1727169895
    },
    {
        "content": "<p><del>There were no breakages, I think.</del> Oops, indeed some, but minor.</p>",
        "id": 472480744,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1727180585
    }
]