[
    {
        "content": "<p>Excuse me, I am new to the compiler of Lean4. When I read its source code, I encountered the following confusion.</p>\n<p>In lean4's <code>parseCommand</code> function,  it calls <code>topLevelCommandParserFn</code>, then eventually calls </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">categoryParserFn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">catName</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Name</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ParserFn</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">ctx</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">  </span><span class=\"n\">categoryParserFnExtension</span><span class=\"bp\">.</span><span class=\"n\">getState</span><span class=\"w\"> </span><span class=\"n\">ctx</span><span class=\"bp\">.</span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">catName</span><span class=\"w\"> </span><span class=\"n\">ctx</span><span class=\"w\"> </span><span class=\"n\">s</span>\n</code></pre></div>\n<p>I guess <code>categoryParseFn</code> returns a parser function based on the name of requested syntax category, which is retrieved from the environment with something registered extension.</p>\n<p>and the <code>categoryParserFnExtension</code> is defined as following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">builtin_initialize</span><span class=\"w\"> </span><span class=\"n\">categoryParserFnExtension</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">EnvExtension</span><span class=\"w\"> </span><span class=\"n\">CategoryParserFn</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">registerEnvExtension</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">categoryParserFnRef</span><span class=\"bp\">.</span><span class=\"n\">get</span>\n</code></pre></div>\n<p>This syntax confuses me.</p>\n<ol>\n<li>what does <code>builtin_initialize</code> mean exactly? is it a tag for compiler?</li>\n<li>what does the left arrow <code> ←</code> mean in this syntax? extract the value inside a monad?</li>\n<li>what is mechanism for extending the environment? is there a document describing it?</li>\n</ol>\n<p>Any help would be appreciated.</p>",
        "id": 451964842,
        "sender_full_name": "Keith",
        "timestamp": 1721200169
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"670366\">Keith</span> has marked this topic as resolved.</p>",
        "id": 452467439,
        "sender_full_name": "Notification Bot",
        "timestamp": 1721352197
    }
]