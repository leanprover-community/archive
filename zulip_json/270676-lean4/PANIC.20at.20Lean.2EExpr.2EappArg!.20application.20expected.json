[
    {
        "content": "<p>When updating the Carleson project to the latest version, I get a few hundred panics, both in CI and locally:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">PANIC</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Expr</span><span class=\"bp\">.</span><span class=\"n\">appArg!</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Expr</span><span class=\"o\">:</span><span class=\"mi\">896</span><span class=\"o\">:</span><span class=\"mi\">15</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">application</span><span class=\"w\"> </span><span class=\"n\">expected</span>\n</code></pre></div>\n<p>See e.g. the <code>Build Project</code> step in this run: <a href=\"https://github.com/fpvandoorn/carleson/actions/runs/10279969927/job/28446338121\">https://github.com/fpvandoorn/carleson/actions/runs/10279969927/job/28446338121</a></p>\n<p>It seems to be related to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.reducePow#doc\">docs#Nat.reducePow</a></p>",
        "id": 457037665,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1723016753
    },
    {
        "content": "<p>It probably has to do with simps and simpas. Apply the following diff <strong>to my PR</strong> <a href=\"https://github.com/fpvandoorn/carleson/pull/109\">https://github.com/fpvandoorn/carleson/pull/109</a> and run <code>lake build Carleson.Defs</code>; there will be no panic</p>\n<p><a href=\"/user_uploads/3121/IaECETxOee5BQYmW1TsPzgG5/out.diff\">out.diff</a></p>",
        "id": 457051154,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723020444
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">diff</span><span class=\"w\"> </span><span class=\"c1\">--git a/Carleson/Defs.lean b/Carleson/Defs.lean</span>\n<span class=\"n\">index</span><span class=\"w\"> </span><span class=\"mi\">320</span><span class=\"n\">f371</span><span class=\"bp\">..</span><span class=\"n\">c70e04f</span><span class=\"w\"> </span><span class=\"mi\">100644</span>\n<span class=\"c1\">--- a/Carleson/Defs.lean</span>\n<span class=\"bp\">+++</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">/</span><span class=\"n\">Carleson</span><span class=\"bp\">/</span><span class=\"n\">Defs</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"bp\">@@</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"mi\">471</span><span class=\"o\">,</span><span class=\"mi\">13</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"mi\">471</span><span class=\"o\">,</span><span class=\"mi\">13</span><span class=\"w\"> </span><span class=\"bp\">@@</span><span class=\"w\"> </span><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">Œò</span><span class=\"bp\">.</span><span class=\"n\">finite_and_mk_le_of_le_dist</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x‚ÇÄ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œò</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span>\n<span class=\"w\">   </span><span class=\"n\">simp_rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Cardinal</span><span class=\"bp\">.</span><span class=\"n\">mk_fintype</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">coe_sort_coe</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">card_coe</span><span class=\"o\">]</span>\n<span class=\"w\">   </span><span class=\"n\">norm_cast</span>\n<span class=\"w\">   </span><span class=\"n\">classical</span><span class=\"w\"> </span><span class=\"k\">calc</span>\n<span class=\"bp\">-</span><span class=\"w\">    </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">ùì©</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"bp\">+</span><span class=\"w\">    </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">ùì©</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">sum_const</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">smul_eq_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_one</span><span class=\"o\">]</span>\n<span class=\"w\">     </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">ùì©</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">sum_le_sum</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">hz</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">card_pos</span><span class=\"bp\">.</span><span class=\"n\">mpr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g_ne</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">hz</span><span class=\"o\">)</span>\n<span class=\"w\">     </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ùì©</span><span class=\"bp\">.</span><span class=\"n\">biUnion</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">card_biUnion</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">hz</span><span class=\"w\"> </span><span class=\"n\">z'</span><span class=\"w\"> </span><span class=\"n\">hz'</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">g_pd</span><span class=\"w\"> </span><span class=\"n\">hz</span><span class=\"w\"> </span><span class=\"n\">hz'</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">     </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">ùì©'</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">       </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">card_le_card</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"w\">       </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">mem_biUnion</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"bp\">-</span><span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">mem_of_subset</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">g</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">choose_spec</span><span class=\"bp\">.</span><span class=\"m\">2</span>\n<span class=\"bp\">+</span><span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">mem_of_subset</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">filter_subset</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">choose_spec</span><span class=\"bp\">.</span><span class=\"m\">2</span>\n<span class=\"w\">     </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">cùì©'</span>\n<span class=\"w\">     </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">C2_1_1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_comm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">pow_mul</span><span class=\"o\">]</span>\n\n<span class=\"bp\">@@</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"mi\">487</span><span class=\"o\">,</span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"mi\">487</span><span class=\"o\">,</span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">@@</span><span class=\"w\"> </span><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">Œò</span><span class=\"bp\">.</span><span class=\"n\">card_le_of_le_dist</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x‚ÇÄ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œò</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span>\n<span class=\"w\">     </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"n\">ùì©</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">C2_1_1</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">   </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">fùì©</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">cùì©</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">finite_and_mk_le_of_le_dist</span><span class=\"w\"> </span><span class=\"n\">hùì©</span><span class=\"w\"> </span><span class=\"n\">h2ùì©</span>\n<span class=\"w\">   </span><span class=\"n\">lift</span><span class=\"w\"> </span><span class=\"n\">ùì©</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œò</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">fùì©</span>\n<span class=\"bp\">-</span><span class=\"w\">  </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">cùì©</span>\n<span class=\"bp\">+</span><span class=\"w\">  </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">card_eq_fintype_card</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Cardinal</span><span class=\"bp\">.</span><span class=\"n\">mk_fintype</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">cast_le</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">cùì©</span>\n</code></pre></div>",
        "id": 457051184,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723020462
    },
    {
        "content": "<p>But revert any one of the three changes and a panic will appear. Even more tellingly, running <code>simp(a)?</code> on the three <code>simp(a)</code>s in question suggests the useless lemma <code>defaultA</code> in each case</p>",
        "id": 457051380,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723020523
    },
    {
        "content": "<p>Attached is the panic obtained by leaving out the first change<br>\n<a href=\"/user_uploads/3121/tPfVOSZXuc3hiz_GbSCq7K-j/panic-out.txt\">panic-out.txt</a></p>",
        "id": 457053113,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723020878
    },
    {
        "content": "<p>Is it possible the subterm matching <code>(_ ^ _ : Nat)</code> is merely defeq to hPow applied to two arguments but not structurally so?</p>",
        "id": 457061405,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1723022522
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span> here's the smallest I've got the panic to so far</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">Card</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">CompatibleFunctions</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">outParam</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">Œò</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span>\n\n<span class=\"kn\">export</span><span class=\"w\"> </span><span class=\"n\">CompatibleFunctions</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œò</span><span class=\"o\">)</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">defaultA</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">a</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CompatibleFunctions</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">defaultA</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"o\">)]</span>\n\n<span class=\"sd\">/-- PANIC -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">Œò</span><span class=\"bp\">.</span><span class=\"n\">panic</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">ùì©</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œò</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ùì©</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">ùì©</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n</code></pre></div>",
        "id": 457062304,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723022811
    },
    {
        "content": "<p>If you change the <code>abbrev</code> to <code>def</code> the panic goes away</p>",
        "id": 457062420,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723022846
    },
    {
        "content": "<p>Or <code>Finset</code> to <code>List</code> (and <code>card</code> to <code>length</code>), or <code>^</code> to <code>*</code></p>",
        "id": 457062887,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723022996
    },
    {
        "content": "<p>Thanks, that matches my hypothesis exactly</p>",
        "id": 457064044,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1723023358
    },
    {
        "content": "<p>Simpler:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Multiset</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">outParam</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span>\n\n<span class=\"kn\">export</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Z</span><span class=\"o\">)</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">a</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)]</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Multiset</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Multiset</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Multiset</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n</code></pre></div>",
        "id": 457064847,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723023555
    },
    {
        "content": "<p>The panic now goes away upon changing <code>1</code> to <code>0</code></p>",
        "id": 457065212,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723023656
    },
    {
        "content": "<p>Looks like a missing <code>unless e.isAppOfArity declName arity do return .continue</code>, which is present on the other binary operator reductions</p>",
        "id": 457067862,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723024589
    },
    {
        "content": "<p>I guess doing a <code>let_expr</code> based match would be fine as well.</p>",
        "id": 457069765,
        "sender_full_name": "Henrik B√∂ving",
        "timestamp": 1723025000
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/270676-lean4/topic/PANIC.20at.20Lean.2EExpr.2EappArg!.20application.20expected/near/457067862\">said</a>:</p>\n<blockquote>\n<p>Looks like a missing <code>unless e.isAppOfArity declName arity do return .continue</code>, which is present on the other binary operator reductions</p>\n</blockquote>\n<p>but where would that go in the lean4 repo?</p>",
        "id": 457073199,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723026175
    },
    {
        "content": "<p>On the first line of <code>Nat.reducePow</code>, to match <code>Nat.reduceBin</code></p>",
        "id": 457073662,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723026352
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"395550\">Henrik B√∂ving</span> <a href=\"#narrow/stream/270676-lean4/topic/PANIC.20at.20Lean.2EExpr.2EappArg!.20application.20expected/near/457069765\">said</a>:</p>\n<blockquote>\n<p>I guess doing a <code>let_expr</code> based match would be fine as well.</p>\n</blockquote>\n<p>Or <code>let ~q()</code> <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span></p>",
        "id": 457073951,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723026465
    },
    {
        "content": "<p>Yeah, I've got an <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">outParam</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span>\n\n<span class=\"kn\">export</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Z</span><span class=\"o\">)</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">a</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)]</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">reducePow</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 457107682,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723036769
    },
    {
        "content": "<p>Filed at <a href=\"https://github.com/leanprover/lean4/issues/4947\">https://github.com/leanprover/lean4/issues/4947</a></p>",
        "id": 457120270,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723039898
    },
    {
        "content": "<p>It sure seems to me that this is a regression from <a href=\"https://github.com/leanprover/lean4/pull/4637\">lean4#4637</a></p>",
        "id": 457140743,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723045490
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/270676-lean4/topic/PANIC.20at.20Lean.2EExpr.2EappArg!.20application.20expected/near/457067862\">said</a>:</p>\n<blockquote>\n<p>Looks like a missing <code>unless e.isAppOfArity declName arity do return .continue</code>, which is present on the other binary operator reductions</p>\n</blockquote>\n<p>Indeed this fixes it.</p>",
        "id": 457142150,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1723045920
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306577\">Matthew Ballard</span> <a href=\"#narrow/stream/270676-lean4/topic/PANIC.20at.20Lean.2EExpr.2EappArg!.20application.20expected/near/457142150\">said</a>:</p>\n<blockquote>\n<p>Indeed this fixes it.</p>\n</blockquote>\n<p>I tried fixing it myself. I couldn't find the right line to put that</p>",
        "id": 457313203,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723108680
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/blob/daa22187642d4cf6954c39a23eab20d8a8675416/src/Lean/Meta/Tactic/Simp/BuiltinSimprocs/Nat.lean#L58\">https://github.com/leanprover/lean4/blob/daa22187642d4cf6954c39a23eab20d8a8675416/src/Lean/Meta/Tactic/Simp/BuiltinSimprocs/Nat.lean#L58</a></p>",
        "id": 457313532,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1723108764
    },
    {
        "content": "<p>Then you probably want to a make your example into a test that fails before the fix and passes afterwards</p>",
        "id": 457313651,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1723108790
    },
    {
        "content": "<p><code>declName</code> and <code>arity</code> don't appear in the variables</p>",
        "id": 457314226,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723108957
    },
    {
        "content": "<p>You need to specialize them to the existing situation HPow.hPow and 6</p>",
        "id": 457314998,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1723109149
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306577\">Matthew Ballard</span> <a href=\"#narrow/stream/270676-lean4/topic/PANIC.20at.20Lean.2EExpr.2EappArg!.20application.20expected/near/457314998\">said</a>:</p>\n<blockquote>\n<p>You need to specialize them to the existing situation HPow.hPow and 6</p>\n</blockquote>\n<p>I added a file <code>9999.lean</code> to <code>lean4/tests/lean</code> with my example but how do I run it?</p>",
        "id": 457338761,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723115127
    },
    {
        "content": "<p>Which directory do I have to be in and what command must I give</p>",
        "id": 457338857,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723115161
    },
    {
        "content": "<p>wait...</p>",
        "id": 457339080,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723115253
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598052\">@Jeremy Tan</span> see <a href=\"https://lean-lang.org/lean4/doc/dev/testing.html\">https://lean-lang.org/lean4/doc/dev/testing.html</a> for running tests.</p>",
        "id": 459316629,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723161295
    },
    {
        "content": "<p>(If you find problems in the test docs please let us know!)</p>",
        "id": 459316674,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723161309
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 459334275,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723168319
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> I've got a diff ready. Should I fork and PR or have you accept me into the lean4 org and then PR?</p>",
        "id": 459338340,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723170957
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/pltRbhXmKbMHy8IbmrHY6yfI/out.diff\">out.diff</a></p>",
        "id": 459338493,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723171048
    },
    {
        "content": "<p>how should I title my PR anyway?</p>",
        "id": 459340641,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723172244
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> <a href=\"https://github.com/leanprover/lean4/pull/4968\">https://github.com/leanprover/lean4/pull/4968</a></p>",
        "id": 459341929,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723172759
    },
    {
        "content": "<p><del>Should I rebase onto nightly-with-mathlib?</del> OK, rebased</p>",
        "id": 459357836,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723176099
    },
    {
        "content": "<p>Is there anything I have done wrong with my PR?</p>",
        "id": 459359464,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723176659
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598052\">@Jeremy Tan</span> Looks good to me. Could you move the test into run/? Then you don't need the empty <code>expected</code> file</p>",
        "id": 459393358,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1723187759
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110024\">Sebastian Ullrich</span> <a href=\"#narrow/stream/270676-lean4/topic/PANIC.20at.20Lean.2EExpr.2EappArg!.20application.20expected/near/459393358\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"598052\">Jeremy Tan</span> Looks good to me. Could you move the test into run/? Then you don't need the empty <code>expected</code> file</p>\n</blockquote>\n<p>done</p>",
        "id": 459417177,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723194657
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"598052\">Jeremy Tan</span> <a href=\"#narrow/stream/270676-lean4/topic/PANIC.20at.20Lean.2EExpr.2EappArg!.20application.20expected/near/457140743\">said</a>:</p>\n<blockquote>\n<p>It sure seems to me that this is a regression from <a href=\"https://github.com/leanprover/lean4/pull/4637\">lean4#4637</a></p>\n</blockquote>\n<p>I left some comments on this PR; it's not clear to me that this is effective at preventing blowups on large powers</p>",
        "id": 459419980,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723195502
    },
    {
        "content": "<p>Anyway I tried the rebase command suggested but still no Batteries/mathlib CI</p>",
        "id": 459436115,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723199552
    },
    {
        "content": "<p>I will try to have a look at the CI next week. My first guess is that we are running into GitHub API rate limits. This has been a known problem (not specific to this step, but all over our infrastructure) for a couple of weeks now.</p>",
        "id": 459608043,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723252993
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"111080\">@Floris van Doorn</span> For now I have silenced the panics in my <a href=\"https://github.com/fpvandoorn/carleson/pull/109\">https://github.com/fpvandoorn/carleson/pull/109</a> by adding <code>attribute [-simp] Nat.reducePow</code> at the start of 9 files</p>",
        "id": 459636592,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723265449
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/270676-lean4/topic/PANIC.20at.20Lean.2EExpr.2EappArg!.20application.20expected/near/459419980\">said</a>:</p>\n<blockquote>\n<p>I left some comments on this PR; it's not clear to me that this is effective at preventing blowups on large powers</p>\n</blockquote>\n<p>Do you have code where it still blows up on large powers?</p>",
        "id": 459636867,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723265697
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598052\">@Jeremy Tan</span>, you aren't meant to change the PR target to <code>nightly-with-mathlib</code> (as you did, and Sebastian changed back), but rather <em>rebase</em> using <code>git rebase -i origin/nightly-with-mathlib</code>. Could you try this?</p>",
        "id": 459962465,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723423588
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> I did that, but Leo has already pushed a fix (<a href=\"https://github.com/leanprover/lean4/pull/4988\">lean4#4988</a>)</p>",
        "id": 460011388,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723445540
    },
    {
        "content": "<p>The tag is still not showing up in mathlib</p>",
        "id": 460013167,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723446303
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"598052\">Jeremy Tan</span> <a href=\"#narrow/stream/270676-lean4/topic/PANIC.20at.20Lean.2EExpr.2EappArg!.20application.20expected/near/460013167\">said</a>:</p>\n<blockquote>\n<p>The tag is still not showing up in mathlib</p>\n</blockquote>\n<p>What do you mean?</p>",
        "id": 460058431,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723460767
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> OK, I think I've got it right with <a href=\"https://github.com/leanprover/lean4/pull/5011\">lean4#5011</a></p>",
        "id": 462083197,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723547222
    },
    {
        "content": "<p>then why did I get this out of the blue failure? <a href=\"https://github.com/leanprover/lean4/actions/runs/10368758759/job/28703042712\">https://github.com/leanprover/lean4/actions/runs/10368758759/job/28703042712</a></p>",
        "id": 462101368,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723552302
    },
    {
        "content": "<p>This happens ocasionally, haven‚Äôt debugged yet when this happens. You can ignore it, not your PR‚Äôs fault. Maybe something with github rate limits or so.</p>",
        "id": 462101631,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1723552352
    },
    {
        "content": "<p><code>jq: error (at &lt;stdin&gt;:5): Cannot index string with string \"body\"</code></p>",
        "id": 462101638,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723552352
    },
    {
        "content": "<p>This is from</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">              </span><span class=\"n\">existing_comment</span><span class=\"bp\">=</span><span class=\"s2\">\"$(curl -L -s -H \"</span><span class=\"n\">Authorization</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">token</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"o\">{{</span><span class=\"w\"> </span><span class=\"n\">secrets</span><span class=\"bp\">.</span><span class=\"n\">MATHLIB4_BOT</span><span class=\"w\"> </span><span class=\"o\">}}</span><span class=\"s2\">\" </span><span class=\"se\">\\</span>\n<span class=\"s2\">                                      -H \"</span><span class=\"n\">Accept</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">application</span><span class=\"bp\">/</span><span class=\"n\">vnd</span><span class=\"bp\">.</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">v3</span><span class=\"bp\">+</span><span class=\"n\">json</span><span class=\"s2\">\" </span><span class=\"se\">\\</span>\n<span class=\"s2\">                                      \"</span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">api</span><span class=\"bp\">.</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">repos</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">issues</span><span class=\"bp\">/$</span><span class=\"o\">{{</span><span class=\"w\">        </span><span class=\"n\">steps</span><span class=\"bp\">.</span><span class=\"n\">workflow</span><span class=\"bp\">-</span><span class=\"n\">info</span><span class=\"bp\">.</span><span class=\"n\">outputs</span><span class=\"bp\">.</span><span class=\"n\">pullRequestNumber</span><span class=\"w\"> </span><span class=\"o\">}}</span><span class=\"bp\">/</span><span class=\"n\">comments</span><span class=\"s2\">\" </span><span class=\"se\">\\</span>\n<span class=\"s2\">                                      | jq 'first(.[] | select(.body | test(\"</span><span class=\"bp\">^-</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"s2\">\") or         startswith(\"</span><span class=\"n\">Mathlib</span><span class=\"w\"> </span><span class=\"n\">CI</span><span class=\"w\"> </span><span class=\"n\">status</span><span class=\"s2\">\")) | select(.user.login == \"</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">mathlib4</span><span class=\"bp\">-</span><span class=\"n\">bot</span><span class=\"s2\">\"))')\"</span>\n<span class=\"w\">              </span><span class=\"n\">existing_comment_id</span><span class=\"bp\">=</span><span class=\"s2\">\"$(echo \"</span><span class=\"bp\">$</span><span class=\"n\">existing_comment</span><span class=\"s2\">\" | jq -r .id)\"</span>\n<span class=\"w\">              </span><span class=\"n\">existing_comment_body</span><span class=\"bp\">=</span><span class=\"s2\">\"$(echo \"</span><span class=\"bp\">$</span><span class=\"n\">existing_comment</span><span class=\"s2\">\" | jq -r .body)\"</span>\n</code></pre></div>\n<p>and I have been staring at this point wondering how in <code>echo \"$existing_comment\" | jq -r .body</code> it can be that <code>jq</code> receives a string literal (and not either a json object or nothing). <span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span> <br>\nMaybe I should add some debugging output there</p>",
        "id": 462104241,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1723552823
    },
    {
        "content": "<p>Maybe rate limits are returned as a single string?</p>",
        "id": 462104679,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723552911
    },
    {
        "content": "<p>Yeah we've been seeing rate limits on the mathlib4 community bot in a lot of runs recently <span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span></p>",
        "id": 462105159,
        "sender_full_name": "Henrik B√∂ving",
        "timestamp": 1723553077
    }
]