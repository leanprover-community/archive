[
    {
        "content": "<p>Lean's numeric literal syntax supports underscores as digit separators for readability:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">myNumber</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">100</span><span class=\"n\">_000_000</span><span class=\"w\">  </span><span class=\"c1\">-- ✅ Works</span>\n</code></pre></div>\n<p>However, <code>String.toNat?</code> (and <code>String.toInt?</code>) do not support this syntax:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"k\">#eval</span><span class=\"w\"> </span><span class=\"s2\">\"100_000_000\"</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"bp\">?</span><span class=\"w\">  </span><span class=\"c1\">-- Returns `none` ❌</span>\n<span class=\"k\">#eval</span><span class=\"w\"> </span><span class=\"s2\">\"100000000\"</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"bp\">?</span><span class=\"w\">    </span><span class=\"c1\">-- Returns `some 100000000` ✅</span>\n</code></pre></div>\n<p>I wrote an issue about this here: <a href=\"https://github.com/leanprover/lean4/issues/11538\">https://github.com/leanprover/lean4/issues/11538</a></p>",
        "id": 562357458,
        "sender_full_name": "Nicolas Rouquette",
        "timestamp": 1765144657
    },
    {
        "content": "<p>I ran into this issue while developing a PR to add support for specifying \"max heartbeats\" in <code>doc-gen4</code>, see this PR: <a href=\"https://github.com/leanprover/doc-gen4/pull/336\">https://github.com/leanprover/doc-gen4/pull/336</a></p>",
        "id": 562359898,
        "sender_full_name": "Nicolas Rouquette",
        "timestamp": 1765145256
    },
    {
        "content": "<p>I've opened a PR to implement this: <a href=\"https://github.com/leanprover/lean4/pull/11541\">https://github.com/leanprover/lean4/pull/11541</a></p>\n<p>The implementation adds support for underscores as digit separators in <code>String.toNat?</code>, <code>String.toInt?</code>, and related functions. Underscores cannot appear at the start, end, or consecutively, matching the validation rules for numeric literals.</p>\n<p>Examples:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"k\">#eval</span><span class=\"w\"> </span><span class=\"s2\">\"100_000_000\"</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"bp\">?</span><span class=\"w\">  </span><span class=\"c1\">-- some 100000000</span>\n<span class=\"k\">#eval</span><span class=\"w\"> </span><span class=\"s2\">\"1_000\"</span><span class=\"bp\">.</span><span class=\"n\">toInt</span><span class=\"bp\">?</span><span class=\"w\">        </span><span class=\"c1\">-- some 1000</span>\n<span class=\"k\">#eval</span><span class=\"w\"> </span><span class=\"s2\">\"-1_000_000\"</span><span class=\"bp\">.</span><span class=\"n\">toInt</span><span class=\"bp\">?</span><span class=\"w\">   </span><span class=\"c1\">-- some (-1000000)</span>\n</code></pre></div>",
        "id": 562367158,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1765148069
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> !</p>",
        "id": 562367339,
        "sender_full_name": "Nicolas Rouquette",
        "timestamp": 1765148322
    }
]