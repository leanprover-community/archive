[
    {
        "content": "<p>I have a definition that lives in <code>Type 1</code></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">Elab</span><span class=\"w\"> </span><span class=\"n\">Meta</span><span class=\"w\"> </span><span class=\"n\">Command</span>\n\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Test</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">Test</span><span class=\"w\"> </span><span class=\"c1\">-- Type 1</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">instTestList</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Test</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">List</span>\n\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"n\">MetaM</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">evalConst</span><span class=\"w\"> </span><span class=\"n\">Test</span><span class=\"w\"> </span><span class=\"ss\">``instTestList</span>\n<span class=\"c\">/-</span><span class=\"cm\"> ERROR</span>\n<span class=\"cm\">application type mismatch</span>\n<span class=\"cm\">  evalConst Test</span>\n<span class=\"cm\">argument</span>\n<span class=\"cm\">  Test</span>\n<span class=\"cm\">has type</span>\n<span class=\"cm\">  Type 1 : Type 2</span>\n<span class=\"cm\">but is expected to have type</span>\n<span class=\"cm\">  Type : Type 1</span>\n<span class=\"cm\">-/</span>\n</code></pre></div>\n<p>This makes it difficult to use it in conjunction with <code>evalConst</code> and <code>MetaM</code>, which expect a term of type <code>Type</code>. Is there a way around this?</p>",
        "id": 477796890,
        "sender_full_name": "Anand Rao Tadipatri",
        "timestamp": 1729336167
    },
    {
        "content": "<p>Can you give a more complex example? There's nothing to evaluate in this one</p>",
        "id": 477797125,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1729336399
    },
    {
        "content": "<p><code>evalConst</code> would only work with computationally relevant values. <code>Type</code> has no runtime representation.</p>",
        "id": 477824890,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729359121
    },
    {
        "content": "<p>Apologies for the delay, I've updated my example.</p>",
        "id": 477932853,
        "sender_full_name": "Anand Rao Tadipatri",
        "timestamp": 1729463203
    },
    {
        "content": "<p>If you wanting to evaluate <code>Test</code> at runtime, this has problems because <code>Type -&gt; Type</code> has no runtime representation.</p>\n<p>Is this a toy example for what you actually want to do?</p>",
        "id": 477933852,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729464172
    },
    {
        "content": "<p>Thanks. Yes, it's a toy example for <a href=\"https://github.com/teorth/equational_theories/blob/4a5c9f43ad027fdb0db501b158232621729cdc2b/equational_theories/LiftingMagmaFamiliesCounterexamples.lean#L8\">the actual situation I would like to use it in</a>.</p>",
        "id": 477933977,
        "sender_full_name": "Anand Rao Tadipatri",
        "timestamp": 1729464298
    },
    {
        "content": "<p>Ok, I see. Unfortunately <code>Lean.evalConst</code> has that universe constraint, but if you use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Environment.evalConst#doc\">docs#Lean.Environment.evalConst</a> directly you can evaluate it.</p>",
        "id": 477934237,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729464593
    },
    {
        "content": "<p>What's the Intended difference between that and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.evalConst#doc\">docs#Lean.evalConst</a> ?</p>",
        "id": 477934952,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1729465243
    },
    {
        "content": "<p>Oh, I guess the latter uses the monad stack for convenience, but is stuck in Type as a result</p>",
        "id": 477935081,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1729465356
    }
]