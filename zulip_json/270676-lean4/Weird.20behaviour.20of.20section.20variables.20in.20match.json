[
    {
        "content": "<p>What's going on here in <code>S2</code> here?<br>\nFirst of all, why is <code>a</code> even included, under the new variable inclusion mechanism? It isn't mentioned in the type of the function and isn't an instance.<br>\nSecond, how come <code>somefun2</code> is invoked without having to pass <code>a</code> to it?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">autoImplicit</span><span class=\"w\"> </span><span class=\"n\">false</span>\n\n<span class=\"kn\">section</span><span class=\"w\"> </span><span class=\"n\">S1</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">somefun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">somefun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">S1</span>\n\n<span class=\"kn\">section</span><span class=\"w\"> </span><span class=\"n\">S2</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">somefun2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">somefun2</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">S2</span>\n</code></pre></div>",
        "id": 477824305,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1729358531
    },
    {
        "content": "<p>Here's the relevant release notes entry:</p>\n<blockquote>\n<p>The variable inclusion mechanism has been changed. Like before, when a definition mentions a variable, Lean will add it as an argument of the definition, but now in theorem bodies, variables are not included based on usage in order to ensure that changes to the proof cannot change the statement of the overall theorem. Instead, variables are only available to the proof if they have been mentioned in the theorem header or in an <strong><code>include</code> command</strong> or are instance implicit and depend only on such variables. The <strong><code>omit</code> command</strong> can be used to omit included variables.</p>\n</blockquote>\n<p>I thought it was just <code>theorem</code> (and <code>Prop</code>-valued <code>example</code>?) that used the more restrictive inclusion rule.</p>",
        "id": 477825072,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1729359251
    },
    {
        "content": "<p>Ah, I see, thanks (it only happens for <code>theorem</code>, not <code>example</code>)</p>",
        "id": 477825220,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1729359384
    }
]