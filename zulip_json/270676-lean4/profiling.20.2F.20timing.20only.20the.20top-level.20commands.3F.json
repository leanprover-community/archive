[
    {
        "content": "<p>Is there a way to get lean to tell me how long each line takes to run/elaborate (<code>Elab.command</code>), without spending a bunch of time (a) printing the line, and (b) tracing/printing children?  I have <a href=\"/user_uploads/3121/ojZXOJtBgnbj-x6SQZp_gsLw/test_extra.lean\">a file</a> that takes 100x longer to run with the profiler on than with it off.</p>",
        "id": 513316715,
        "sender_full_name": "Jason Gross",
        "timestamp": 1745192204
    },
    {
        "content": "<p>Maybe <code>#time</code>?</p>",
        "id": 513316934,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1745192466
    },
    {
        "content": "<p>You can set the trace profiler threshold very high but then enable Elab.command specifically</p>",
        "id": 513363714,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1745224369
    },
    {
        "content": "<p>Thank you both!  Is there a way to set the output format of <code>#time</code>?</p>",
        "id": 513425765,
        "sender_full_name": "Jason Gross",
        "timestamp": 1745251288
    },
    {
        "content": "<p>Actually, <span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span> , if I do</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">set_option</span><span class=\"w\"> </span><span class=\"n\">trace.profiler</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"kd\">set_option</span><span class=\"w\"> </span><span class=\"n\">trace.profiler.threshold</span><span class=\"w\"> </span><span class=\"mi\">1000</span>\n<span class=\"kd\">set_option</span><span class=\"w\"> </span><span class=\"n\">trace.Elab.command</span><span class=\"w\"> </span><span class=\"n\">true</span>\n</code></pre></div>\n<p>then I see the trace for <code>[Elab.command]</code>, but I don't see the timing for it.  I want to see the profile on everything that's enabled / to disable the trace on everything but Elab.command.</p>",
        "id": 513438386,
        "sender_full_name": "Jason Gross",
        "timestamp": 1745255848
    },
    {
        "content": "<p>If I open that code in the playground and add another command, I do get timings. Maybe some old Lean version?</p>",
        "id": 513445291,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1745258599
    },
    {
        "content": "<p>I'm running Lean (version 4.18.0, arm64-apple-darwin23.6.0, commit 11ccbced7964, Release)</p>",
        "id": 513450830,
        "sender_full_name": "Jason Gross",
        "timestamp": 1745260824
    },
    {
        "content": "<p>But indeed switching to nightly seems to show timings</p>",
        "id": 513451658,
        "sender_full_name": "Jason Gross",
        "timestamp": 1745261193
    }
]