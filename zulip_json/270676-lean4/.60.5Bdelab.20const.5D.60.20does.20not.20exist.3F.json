[
    {
        "content": "<p>this code in metaprogramming book does not work (see: <a href=\"https://leanprover-community.github.io/lean4-metaprogramming-book/extra/03_pretty-printing.html#making-our-own\">https://leanprover-community.github.io/lean4-metaprogramming-book/extra/03_pretty-printing.html#making-our-own</a>)</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">PrettyPrinter</span><span class=\"w\"> </span><span class=\"n\">Delaborator</span><span class=\"w\"> </span><span class=\"n\">SubExpr</span>\n\n<span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">42</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">delab</span><span class=\"w\"> </span><span class=\"n\">app.foo</span><span class=\"kd\">]</span>\n<span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">delabFoo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Delab</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">)</span>\n\n<span class=\"k\">#check</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"c1\">-- 1 : Nat → Nat</span>\n<span class=\"k\">#check</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"mi\">13</span><span class=\"w\"> </span><span class=\"c1\">-- 1 : Nat, full applications are also pretty printed this way</span>\n</code></pre></div>",
        "id": 486669692,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1733577934
    },
    {
        "content": "<p>I've done my own checking, but there does not seem to be a way to change the delaboration result of <code>foo</code> to an arbitrary Term.</p>",
        "id": 486669865,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1733578074
    },
    {
        "content": "<p>Could you say what doesn't work?</p>\n<p>Is it that the code is using <code>#check foo</code> instead of <code>#check (foo)</code>?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">foo</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- 1 : Nat → Nat</span>\n</code></pre></div>",
        "id": 486690361,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1733593844
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> </p>\n<blockquote>\n<p>Could you say what doesn't work?</p>\n</blockquote>\n<p>The output result of <code>#check foo</code> is <code>foo : Nat → Nat</code> and not <code>1 : Nat</code>.</p>",
        "id": 486725736,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1733624992
    },
    {
        "content": "<blockquote>\n<p>Is it that the code is using <code>#check foo</code> instead of <code>#check (foo)</code>?</p>\n</blockquote>\n<p>Thank you!!</p>",
        "id": 486725783,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1733625004
    },
    {
        "content": "<p>Is it possible to change the output result of <code>#check foo</code> using the <code>[delab]</code> attribute?</p>",
        "id": 486725820,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1733625039
    },
    {
        "content": "<p>No, this form prints a signature. It is special cased to avoid filling in implicit arguments or printing with a @</p>",
        "id": 486778181,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1733671268
    }
]