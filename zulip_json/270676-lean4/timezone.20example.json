[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"481858\">@Sofia Rodrigues</span> the example from <a href=\"https://github.com/leanprover/lean4/blob/master/src/Std/Time/Notation.lean#L198-L204\">https://github.com/leanprover/lean4/blob/master/src/Std/Time/Notation.lean#L198-L204</a> doesn’t seem to work:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Std</span><span class=\"bp\">.</span><span class=\"n\">Time</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Std</span><span class=\"bp\">.</span><span class=\"n\">Time</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">timezone</span><span class=\"o\">(</span><span class=\"s2\">\"America/Sao_Paulo\"</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Is there any documentation including working examples for this time library? I couldn’t find it in the reference manual.</p>",
        "id": 565464207,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1766775010
    },
    {
        "content": "<p>The error message is also not super illuminating, it says <code>error: offset 17: expected:</code></p>",
        "id": 565464229,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1766775048
    },
    {
        "content": "<p>That’s weird. I’m going to take a look at what’s wrong :/ it was supposed to be working.</p>",
        "id": 565464247,
        "sender_full_name": "Sofia Rodrigues",
        "timestamp": 1766775085
    },
    {
        "content": "<p>Do I understand correctly that Lean does <em>not</em> ship with a timezone database and we need to work in <code>IO</code> if we want to get access to the system database?</p>",
        "id": 565464269,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1766775116
    },
    {
        "content": "<p>About the broken macro, the tests in <a href=\"https://github.com/leanprover/lean4/blob/master/tests/lean/run/timeSet.lean#L19-L20\">https://github.com/leanprover/lean4/blob/master/tests/lean/run/timeSet.lean#L19-L20</a> use a more complicated format including the offset.</p>",
        "id": 565464324,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1766775191
    },
    {
        "content": "<p>Yes, I took a look, and the example is wrong. This timezone macro isn’t very good for working with timezones because it’s pure :S and you have to combine it with an offset. People will probably get confused when trying to work with it and <code>ZoneRules</code>.</p>",
        "id": 565464395,
        "sender_full_name": "Sofia Rodrigues",
        "timestamp": 1766775303
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">timezone</span><span class=\"o\">(</span><span class=\"s2\">\"America/Sao_Paulo -03:00\"</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>is the correct way to use this macro.</p>",
        "id": 565464412,
        "sender_full_name": "Sofia Rodrigues",
        "timestamp": 1766775312
    },
    {
        "content": "<p>I recommend using this function instead:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\"> </span><span class=\"n\">Std</span><span class=\"bp\">.</span><span class=\"n\">Time</span><span class=\"bp\">.</span><span class=\"n\">Database</span><span class=\"bp\">.</span><span class=\"n\">defaultGetZoneRules</span><span class=\"w\"> </span><span class=\"s2\">\"America/Sao_Paulo\"</span>\n</code></pre></div>",
        "id": 565464563,
        "sender_full_name": "Sofia Rodrigues",
        "timestamp": 1766775447
    },
    {
        "content": "<p>Is there a strong reason to not include a time zone database? It looks a bit strange to use IO for such a task.</p>",
        "id": 565464955,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1766775730
    },
    {
        "content": "<p>And I’m a bit confused by the difference between <code>TimeZone</code> and <code>ZoneRules</code>.</p>",
        "id": 565464988,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1766775780
    },
    {
        "content": "<p>Is this explained somewhere?</p>",
        "id": 565464997,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1766775789
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span> <a href=\"#narrow/channel/270676-lean4/topic/timezone.20example/near/565464955\">said</a>:</p>\n<blockquote>\n<p>Is there a strong reason to not include a time zone database? It looks a bit strange to use IO for such a task.</p>\n</blockquote>\n<p>We don’t want to maintain databases or other data that change over time, as that would introduce more things to maintain.</p>",
        "id": 565465054,
        "sender_full_name": "Sofia Rodrigues",
        "timestamp": 1766775859
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span> <a href=\"#narrow/channel/270676-lean4/topic/timezone.20example/near/565464988\">said</a>:</p>\n<blockquote>\n<p>And I’m a bit confused by the difference between <code>TimeZone</code> and <code>ZoneRules</code>.</p>\n</blockquote>\n<p>The <code>TimeZone</code> is a fixed offset with an identifier. <code>ZoneRules</code> contains all the offset transitions, such as daylight saving time.</p>",
        "id": 565465166,
        "sender_full_name": "Sofia Rodrigues",
        "timestamp": 1766775959
    },
    {
        "content": "<p>I’ll probably open a PR to rename these types, they’re not very clear</p>",
        "id": 565465208,
        "sender_full_name": "Sofia Rodrigues",
        "timestamp": 1766775996
    },
    {
        "content": "<p>Is there any situation where I would want <code>TimeZone</code> and not the full thing?</p>",
        "id": 565465225,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1766776016
    },
    {
        "content": "<p>And before I forget: thanks a lot for your answers!</p>",
        "id": 565465251,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1766776048
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span> <a href=\"#narrow/channel/270676-lean4/topic/timezone.20example/near/565465225\">said</a>:</p>\n<blockquote>\n<p>Is there any situation where I would want <code>TimeZone</code> and not the full thing?</p>\n</blockquote>\n<p>I think that in most cases people actually need <code>ZoneRules</code>, but <code>TimeZone</code> is easier to create and easier to reason about when working with the <code>DateTime</code> type.</p>",
        "id": 565465409,
        "sender_full_name": "Sofia Rodrigues",
        "timestamp": 1766776267
    }
]