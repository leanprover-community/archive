[
    {
        "content": "<p>Suppose I have a function <code>f [Monad m] : a -&gt;  m (List a)</code>. Where the list <code>f</code> returns is always non-empty. I'd like to write a theorem that says this is true.</p>\n<p>How would I even phrase this in a theorem statement? Something like <code>(. \\neq []) &lt;$&gt; f a = pure True</code> type checks, but it is of course wrong.   The goal of this helper lemma is to prove that it is always legal to do e.g.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"bp\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">last</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">list</span><span class=\"bp\">.</span><span class=\"n\">getLast</span>\n</code></pre></div>\n<p>I suppose I could modify f to return an <code>m {l : List a // l \\neq []}</code> or something, but that would be somewhat unfortunate as it would require cluttering the definition of <code>f</code> with these proofs.</p>",
        "id": 565529880,
        "sender_full_name": "cmlsharp",
        "timestamp": 1766868410
    },
    {
        "content": "<p>Well I know of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SatisfiesM#doc\">docs#SatisfiesM</a></p>",
        "id": 565531379,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1766870585
    },
    {
        "content": "<p>you might find something better in <span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> \"Std.Do\"</p>",
        "id": 565531436,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1766870680
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Std/Do/SPred/SVal.html#Std.Do.SVal.StateTuple\">Std.Do.SVal.StateTuple</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Std/Do/SPred/SVal.html#Std.Do.SVal\">Std.Do.SVal</a>, and <a href=\"https://loogle.lean-lang.org/?q=%22Std.Do%22\">662 more</a></p>",
        "id": 565531437,
        "sender_full_name": "loogle",
        "timestamp": 1766870681
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"1006649\">@cmlsharp</span>, please see <a href=\"https://lean-lang.org/doc/reference/latest/The--mvcgen--tactic/Tutorial___-Verifying-Imperative-Programs-Using--mvcgen/#mvcgen-tactic-tutorial\">https://lean-lang.org/doc/reference/latest/The--mvcgen--tactic/Tutorial___-Verifying-Imperative-Programs-Using--mvcgen/#mvcgen-tactic-tutorial</a></p>",
        "id": 566459225,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1767658642
    },
    {
        "content": "<p>Kim, does that provide something like <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=satisfying#doc\">docs#satisfying</a> that could be used in the example in this thread?</p>",
        "id": 566883623,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1767858746
    },
    {
        "content": "<p>Yes, you can write Hoare triples that I think are more expressive than anything SatisfiesM can provide. But I've barely used it myself, and found it quite confusing when I tried!</p>",
        "id": 566887070,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1767860249
    }
]