[
    {
        "content": "<p>Grind has a function <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Meta.Grind.isEqv#doc\">docs#Lean.Meta.Grind.isEqv</a> which checks whether two internalized expressions are in the same equivalence class. Notably, AFAICT, this is not the same as checking whether two expressions are equivalent according to grind's e-graph. For example, in the following (false goal):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">grind</span>\n</code></pre></div>\n<p>... the e-graph produced by <code>grind</code> does not have <code>f a</code> and <code>f b</code> in the same equivalence class (in fact, <code>f b</code> is not even internalized), so <code>isEqv</code> fails. However, the e-graph has <code>a</code> and <code>b</code> in the same equivalence class, so we should be able to deduce that <code>f a = f b</code>. Is there a good way of doing this? I tried internalizing <code>f b</code>, but that doesn't place it in the same e-class as <code>f a</code>.</p>\n<hr>\n<p><em>Sorry for asking all these grind implementation questions on Zulip - I can't make it to the relevant office hours as I'm located in Europe.</em></p>",
        "id": 555096644,
        "sender_full_name": "Marcus Rossel",
        "timestamp": 1762947753
    },
    {
        "content": "<p>I am not knowledgeable about these internals so I usually just spectate, but I personally find it useful for these discussions to be on Zulip as opposed to just office hours!</p>",
        "id": 555105384,
        "sender_full_name": "Chris Henson",
        "timestamp": 1762950432
    },
    {
        "content": "<p><del>Ah, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Meta.Grind.Goal.isCongruent#doc\">docs#Lean.Meta.Grind.Goal.isCongruent</a> might be the answer.</del></p>",
        "id": 555106528,
        "sender_full_name": "Marcus Rossel",
        "timestamp": 1762950760
    }
]