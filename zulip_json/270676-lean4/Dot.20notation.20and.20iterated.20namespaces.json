[
    {
        "content": "<p>Is the following a bug?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"bp\">.</span><span class=\"n\">B</span><span class=\"bp\">.</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">37</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n\n<span class=\"c\">/-</span><span class=\"cm\"> invalid field 'B', the environment does not contain 'A.B' -/</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">B</span><span class=\"bp\">.</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">37</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>(I noticed this when trying to write <code>I.Quotient.mk</code> with <code>I : Ideal R</code>, which gives an error even though <code>Ideal.Quotient.mk</code> exists.)</p>",
        "id": 491452240,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1735688597
    },
    {
        "content": "<p>I think this would be a better example, since dot notation doesn't work unless the function has an argument with the root type:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"bp\">.</span><span class=\"n\">B</span><span class=\"bp\">.</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">37</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"c\">/-</span><span class=\"cm\"> invalid field 'B', the environment does not contain 'A.B' -/</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">B</span><span class=\"bp\">.</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">37</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>My understanding of dot notation is that <code>A.B.C</code> is interpreted as <code>(A.B).C</code> and not <code>A.(B.C)</code>, in which case your example is not a bug, but I don't know if that's the actual expected behavior.</p>",
        "id": 491454774,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1735691073
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"380294\">Matt Diamond</span> <a href=\"#narrow/channel/270676-lean4/topic/Dot.20notation.20and.20iterated.20namespaces/near/491454774\">said</a>:</p>\n<blockquote>\n<p>I think this would be a better example, since dot notation doesn't work unless the function has an argument with the root type:</p>\n</blockquote>\n<p>True (I may have had a bit too much prosecco yesterday night <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span>). But your example (and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Ideal.Quotient.mk#doc\">docs#Ideal.Quotient.mk</a> as well) shows that there really is an issue.</p>",
        "id": 491487962,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1735726088
    },
    {
        "content": "<p>Unfortunately, <code>x.(B.C)</code> doesn't parse...</p>",
        "id": 491498965,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1735737100
    },
    {
        "content": "<p>Is there any possible ambiguity in <code>(x.B).C</code> versus <code>x.(B.C)</code>? Perhaps the parser could try the latter when the former does not make sense?</p>",
        "id": 491499048,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1735737164
    },
    {
        "content": "<p>In Lean 3 it's possible to write <a href=\"https://github.com/search?q=repo%3Aleanprover-community%2Fmathlib3%20%5E.&amp;type=code\"><code>^.quotient.mk</code></a>. Would be nice if the same works in Lean 4. Maybe open an issue (if there isn't already one)?</p>",
        "id": 491501674,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1735739710
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/pull/6491\">lean4#6491</a></p>",
        "id": 491504681,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1735742307
    }
]