[
    {
        "content": "<p>Lately I've been using mathlib's ZMod to make the prime order fields for various elliptic curves for cryptography such as X25519. However I've had to apologize to the Lean compiler for not being able to prove p is prime. Is there a known solution in Lean for proving a specific large p is prime? Looks like in the coq world there is coqprime which produces Pocklington certificates.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„•</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"bp\">^</span><span class=\"mi\">255</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">19</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">basepoint</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ZMod</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">9</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">keySize</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„•</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">32</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">p_is_prime</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Prime</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">fact_p_is_prime</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Prime</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">âŸ¨</span><span class=\"n\">p_is_prime</span><span class=\"bp\">âŸ©</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ZMod</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ZMod</span><span class=\"bp\">.</span><span class=\"n\">instField</span><span class=\"w\"> </span><span class=\"n\">p</span>\n</code></pre></div>",
        "id": 464621197,
        "sender_full_name": "David Stainton ðŸ¦¡",
        "timestamp": 1724410912
    },
    {
        "content": "<p>In theory this is a job for <code>norm_num</code>, but I don't know how well it handles big numbers</p>",
        "id": 464630360,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1724413773
    },
    {
        "content": "<p>See <a href=\"#narrow/stream/116395-maths/topic/Practical.20ways.20to.20prove.20Nat.2EPrime.20N\">https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Practical.20ways.20to.20prove.20Nat.2EPrime.20N</a></p>",
        "id": 464636321,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1724415492
    },
    {
        "content": "<p>This uses Pollard's rho algorithm for factoring <code>p-1</code>, which is too slow â€” you should probably manually create a Pratt certificate for your prime</p>",
        "id": 464637461,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1724415757
    },
    {
        "content": "<p>Alright thanks! I'll look into creating a pratt certificate.</p>",
        "id": 464673687,
        "sender_full_name": "David Stainton ðŸ¦¡",
        "timestamp": 1724426976
    }
]