[
    {
        "content": "<p>Consider the following example from Section <a href=\"https://lean-lang.org/theorem_proving_in_lean4/tactics.html#tactic-combinators\">Tactic Combinators</a> of <a href=\"https://leanprover.github.io/theorem_proving_in_lean4/\">#tpil</a>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">repeat</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">first</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Or.inl</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">assumption</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Or.inr</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">assumption</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>The compound tactic first tries to solve the left disjunct, <code>p</code>, immediately by assumption. That attempt fails, and the goal remains the same. It then tries to focus on the right disjunct, <code>q ∨ r</code>. That attempt also fails; however, the goal changes from <code>p ∨ q ∨ r</code> to <code>q ∨ r</code>.</p>\n<p>When exactly does a subtactic in the <code>first</code> combinator change the goal?</p>",
        "id": 509933340,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1743685238
    },
    {
        "content": "<p>Did you mean to write<br>\n<code>repeat (first | apply Or.inl; assumption | apply Or.inr; assumption)</code></p>",
        "id": 509935100,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743685682
    },
    {
        "content": "<p>No, that doesn't work.</p>",
        "id": 509936493,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1743685967
    },
    {
        "content": "<p>It seems to match what you were describing. You say that the attempt to focus on the right  goal fails. But the focussing on the right goal of course doesn't fail.</p>",
        "id": 509936891,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743686069
    },
    {
        "content": "<p>As in, <code>apply Or.inr</code> is successful, so that is were the <code>first</code> combinator stops</p>",
        "id": 509937000,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743686095
    },
    {
        "content": "<p>I'm not sure what the word \"fail\" really means in this context.</p>",
        "id": 509937055,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1743686110
    },
    {
        "content": "<p>fail means that the tactic throws an error</p>",
        "id": 509937195,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743686144
    },
    {
        "content": "<p><code>apply Or.inl; assumption</code> throws an error because <code>assumption</code> does. <code>apply Or.inr</code> doesn't throw an error</p>",
        "id": 509937395,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743686183
    },
    {
        "content": "<p>From <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Parser.Tactic.first#doc\">docs#Lean.Parser.Tactic.first</a>:</p>\n<blockquote>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">Lean.Parser.Tactic.first</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ParserDescr</span>\n</code></pre></div>\n<p><code>first | tac | ...</code> runs each <code>tac</code> until one succeeds, or else fails.<br>\n</p>\n</blockquote>",
        "id": 509937406,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1743686186
    },
    {
        "content": "<p>Oh, is the \"runs each <code>tac</code>\" confusing? It doesn't actually run each tactic: it stops when one succeeds.</p>",
        "id": 509937620,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743686240
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479299\">Jovan Gerbscheid</span> <a href=\"#narrow/channel/270676-lean4/topic/when.20does.20a.20branch.20in.20the.20first.20combinator.20change.20the.20goal.3F/near/509937000\">said</a>:</p>\n<blockquote>\n<p>As in, <code>apply Or.inr</code> is successful, so that is were the <code>first</code> combinator stops</p>\n</blockquote>\n<p>Does <code>apply Or.inr</code>  succeed in the following example?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Or.inr</span>\n</code></pre></div>",
        "id": 509940368,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1743686884
    },
    {
        "content": "<p>What exactly is the meaning of the word \"succeed\" in this context?</p>",
        "id": 509940680,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1743686957
    },
    {
        "content": "<p>Yes, it succeeds because the tactic doesn't throw an error</p>",
        "id": 509940833,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743686993
    },
    {
        "content": "<p>Here is an example of a tactic that doesn't succeed: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">trivial</span>\n</code></pre></div>",
        "id": 509941184,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743687073
    },
    {
        "content": "<p>I do get an error message from the first line of my example:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Messages</span><span class=\"w\"> </span><span class=\"n\">here</span><span class=\"o\">:</span>\n<span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"mi\">47</span><span class=\"o\">:</span>\n<span class=\"n\">unsolved</span><span class=\"w\"> </span><span class=\"n\">goals</span>\n<span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"n\">hr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span>\n<span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">r</span>\n</code></pre></div>",
        "id": 509941330,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1743687115
    },
    {
        "content": "<p>This error message is not thrown by the <code>apply</code> tactic. The apply tactic successfully applies, and then there are no more tactics left, so lean checks if all goals have been closed. That is what throws this error.</p>\n<p>For example:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Or</span><span class=\"bp\">.</span><span class=\"n\">inr</span>\n<span class=\"w\">  </span><span class=\"n\">repeat</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>doesn't throw an error (just a warning), while</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">trivial</span>\n<span class=\"w\">  </span><span class=\"n\">repeat</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>throws an error, because <code>apply trivial</code> failed. So Lean doesn't even try to <code>repeat sorry</code>.</p>",
        "id": 509942281,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743687309
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">first</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Or.inr</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Or.inr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Or.inr</span><span class=\"w\"> </span><span class=\"n\">hr</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- unsolved goals</span>\n</code></pre></div>\n<p>You're right. If <code>apply Or.inr</code> in the above <code>first</code> combinator failed, it'd run <code>exact Or.inr (Or.inr hr)</code>, but it doesn't.</p>",
        "id": 509947139,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1743688377
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"417769\">Bulhwi Cha</span> <a href=\"#narrow/channel/270676-lean4/topic/when.20does.20a.20branch.20in.20the.20first.20combinator.20change.20the.20goal.3F/near/509933340\">said</a>:</p>\n<blockquote>\n<p>Consider the following example from Section <a href=\"https://lean-lang.org/theorem_proving_in_lean4/tactics.html#tactic-combinators\">Tactic Combinators</a> of <a href=\"https://leanprover.github.io/theorem_proving_in_lean4/\">#tpil</a>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">repeat</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">first</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Or.inl</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">assumption</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Or.inr</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">assumption</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>The compound tactic first tries to solve the left disjunct, <code>p</code>, immediately by assumption. That attempt fails, and the goal remains the same. It then tries to focus on the right disjunct, <code>q ∨ r</code>. That attempt also fails; however, the goal changes from <code>p ∨ q ∨ r</code> to <code>q ∨ r</code>.</p>\n</blockquote>\n<p>I should fix the above explanation as follows:</p>\n<blockquote>\n<p>The <code>first</code> combinator tries to solve the left disjunct, <code>p</code>, immediately by assumption. That attempt fails, and the goal remains the same. It then tries to focus on the right disjunct, <code>q ∨ r</code>. That attempt succeeds, so the goal changes from <code>p ∨ q ∨ r</code> to <code>q ∨ r</code>.</p>\n<p>The <code>repeat</code> combinator applies the <code>first</code> combinator again. The second subtactic in the <code>first</code> combinator succeeds, so the goal changes from <code>q ∨ r</code> to <code>r</code>.</p>\n<p>The <code>repeat</code> combinator applies the <code>first</code> combinator once again. The last subtactic in <code>first</code> combinator, <code>assumption</code>,  succeeds and closes the goal.</p>\n</blockquote>\n<p>Therefore, the compound tactic is equivalent to the following sequence of the same <code>first</code> combinators:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">first</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Or.inl</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">assumption</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Or.inr</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">assumption</span><span class=\"w\"> </span><span class=\"c1\">-- runs `apply Or.inr`</span>\n<span class=\"w\">  </span><span class=\"n\">first</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Or.inl</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">assumption</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Or.inr</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">assumption</span><span class=\"w\"> </span><span class=\"c1\">-- runs `apply Or.inr`</span>\n<span class=\"w\">  </span><span class=\"n\">first</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Or.inl</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">assumption</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Or.inr</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">assumption</span><span class=\"w\"> </span><span class=\"c1\">-- runs `assumption`</span>\n</code></pre></div>",
        "id": 509950494,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1743689041
    },
    {
        "content": "<p>I'm glad that I asked about the <code>first</code> combinator. Thanks for your answer!</p>",
        "id": 509958263,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1743690679
    },
    {
        "content": "<p>From <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Parser.Tactic.first#doc\">docs#Lean.Parser.Tactic.first</a>:</p>\n<blockquote>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">Lean.Parser.Tactic.first</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ParserDescr</span>\n</code></pre></div>\n<p><code>first | tac | ...</code> runs each <code>tac</code> until one succeeds, or else fails.<br>\n</p>\n</blockquote>\n<p>Should we change the description of the <code>first</code> combinator as follows?</p>\n<blockquote>\n<p><code>first | tac | ...</code> runs only the first <code>tac</code> that succeeds; it fails if none of them succeeds.</p>\n</blockquote>",
        "id": 510205165,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1743773956
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479299\">Jovan Gerbscheid</span> <a href=\"#narrow/channel/270676-lean4/topic/when.20does.20a.20branch.20in.20the.20first.20combinator.20change.20the.20goal.3F/near/509937620\">said</a>:</p>\n<blockquote>\n<p>Oh, is the \"runs each <code>tac</code>\" confusing? It doesn't actually run each tactic: it stops when one succeeds.</p>\n</blockquote>\n<p>To put it another way, <code>first | tac | ...</code> <em>tries</em> to run each <code>tac</code> until one succeeds, or else fails. I think we should change the description of it.</p>",
        "id": 510210174,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1743775148
    },
    {
        "content": "<p>Yes, I think both of these options are a better description.</p>",
        "id": 510218353,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1743777137
    },
    {
        "content": "<p>I don't think \"runs only the first <code>tac</code> that succeeds\" is better than \"runs each <code>tac</code> until one succeeds\"; in fact I think it's strictly worse. What <code>first</code> does is exactly the latter thing (i.e. what it already says it does), not the former thing. I agree that the second clause is better though.</p>",
        "id": 510219378,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1743777415
    }
]