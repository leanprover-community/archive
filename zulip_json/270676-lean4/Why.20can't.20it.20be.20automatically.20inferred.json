[
    {
        "content": "<p><a href=\"/user_uploads/3121/XcrH2p57i5EvHxa4kQlpekvv/image.png\">image.png</a><br>\nI've proved the instance what it need, but this definition in pic can't be automatically inferred</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/XcrH2p57i5EvHxa4kQlpekvv/image.png\" title=\"image.png\"><img data-original-dimensions=\"2010x1442\" src=\"/user_uploads/thumbnail/3121/XcrH2p57i5EvHxa4kQlpekvv/image.png/840x560.webp\"></a></div>",
        "id": 479623030,
        "sender_full_name": "Zichen Wang",
        "timestamp": 1730274456
    },
    {
        "content": "<p>Instance search can't find the implicit argument <code>x</code>. Using <code>[X.Nonempty]</code> may fix it?</p>",
        "id": 479626464,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1730275996
    },
    {
        "content": "<p>Next time, please send a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> instead of a screenshot</p>",
        "id": 479626532,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1730276033
    },
    {
        "content": "<p>Sorry.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">section</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">--[hm : ProperFunction X (Convex.indicator X)]</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">ConvexIndicator_is_proper</span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">ProperFunction</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Convex</span><span class=\"bp\">.</span><span class=\"n\">indicator</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">uninfinity</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n<span class=\"w\">    </span><span class=\"n\">dsimp</span><span class=\"o\">[</span><span class=\"n\">Convex</span><span class=\"bp\">.</span><span class=\"n\">indicator</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">X</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"o\">[</span><span class=\"n\">if_pos</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">EReal</span><span class=\"bp\">.</span><span class=\"n\">bot_lt_zero</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"o\">[</span><span class=\"n\">if_neg</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">bot_lt_top</span>\n<span class=\"w\">  </span><span class=\"n\">existence_of_finite_value</span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">right</span><span class=\"bp\">;</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"n\">dsimp</span><span class=\"o\">[</span><span class=\"n\">Convex</span><span class=\"bp\">.</span><span class=\"n\">indicator</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"o\">[</span><span class=\"n\">if_pos</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">]</span><span class=\"bp\">;</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">EReal</span><span class=\"bp\">.</span><span class=\"n\">zero_lt_top</span>\n<span class=\"c1\">-- #check hm</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ConvexIndicator_is_proper</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">)</span>\n\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">subdifferential</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Convex</span><span class=\"bp\">.</span><span class=\"n\">indicator</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span>\n\n<span class=\"kn\">end</span>\n</code></pre></div>\n<p>But using  <code>[X.Nonempty]</code> can't fix it.</p>\n<p>And where is the  the implicit argument <code>x</code></p>",
        "id": 479628608,
        "sender_full_name": "Zichen Wang",
        "timestamp": 1730276895
    },
    {
        "content": "<p>it seems this is missing imports?</p>",
        "id": 479631787,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1730278065
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/channel/270676-lean4/topic/Why.20can't.20it.20be.20automatically.20inferred/near/479631787\">发言道</a>：</p>\n<blockquote>\n<p>it seems this is missing imports?</p>\n</blockquote>\n<p>yes, it depends on a lot of our own defs. So I send a screenshot.</p>",
        "id": 479632022,
        "sender_full_name": "Zichen Wang",
        "timestamp": 1730278161
    },
    {
        "content": "<p>would you agree that the following is a representation of what you're trying to do?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">autoImplicit</span><span class=\"w\"> </span><span class=\"n\">false</span>\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"o\">:</span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">}</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"bp\">_</span><span class=\"o\">:</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">}:</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n\n<span class=\"c1\">-- #check hm</span>\n\n<span class=\"bp\">#</span><span class=\"n\">synth</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"n\">X</span>\n</code></pre></div>",
        "id": 479632680,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1730278394
    },
    {
        "content": "<p>because if so, adding <code>[Nonempty X]</code> instead of <code>x</code> and <code>h</code> should fix it.</p>",
        "id": 479633896,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1730278799
    },
    {
        "content": "<p>Thx. We have solved. But I wonder why I can't write like before.Where is problem?</p>",
        "id": 479636108,
        "sender_full_name": "Zichen Wang",
        "timestamp": 1730279508
    },
    {
        "content": "<p>How should it find x and h? Instance search can use only instance search for dependencies</p>",
        "id": 499409818,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1739436125
    }
]