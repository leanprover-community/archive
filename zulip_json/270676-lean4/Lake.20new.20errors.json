[
    {
        "content": "<p><code>lake new &lt;project name&gt; math</code> as of now ends in the following error. I have tried this twice:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">5</span><span class=\"bp\">/</span><span class=\"mi\">21</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Building</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">String</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"n\">trace</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.&gt;</span><span class=\"w\"> </span><span class=\"n\">LEAN_PATH</span><span class=\"bp\">=/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Cli</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">batteries</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Qq</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">aesop</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">proofwidgets</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">importGraph</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">LeanSearchClient</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">plausible</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---v4.24.0/bin/lean /media/shreyas/d6bf7385-dcc0-4d27-adb5-1d1969c9345b/Projects/Consensus/.lake/packages/batteries/Batteries/Data/String/Basic.lean -o /media/shreyas/d6bf7385-dcc0-4d27-adb5-1d1969c9345b/Projects/Consensus/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/String/Basic.olean -i /media/shreyas/d6bf7385-dcc0-4d27-adb5-1d1969c9345b/Projects/Consensus/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/String/Basic.ilean -c /media/shreyas/d6bf7385-dcc0-4d27-adb5-1d1969c9345b/Projects/Consensus/.lake/packages/batteries/.lake/build/ir/Batteries/Data/String/Basic.c --setup /media/shreyas/d6bf7385-dcc0-4d27-adb5-1d1969c9345b/Projects/Consensus/.lake/packages/batteries/.lake/build/ir/Batteries/Data/String/Basic.setup.json --json</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">String</span><span class=\"bp\">/</span><span class=\"n\">Basic</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">28</span><span class=\"o\">:</span><span class=\"mi\">12</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Unknown</span><span class=\"w\"> </span><span class=\"n\">constant</span><span class=\"w\"> </span><span class=\"ss\">`String.Pos.Raw</span><span class=\"bp\">`</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">String</span><span class=\"bp\">/</span><span class=\"n\">Basic</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">31</span><span class=\"o\">:</span><span class=\"mi\">29</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Unknown</span><span class=\"w\"> </span><span class=\"n\">constant</span><span class=\"w\"> </span><span class=\"ss\">`String.Pos.Raw.next</span><span class=\"bp\">`</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">String</span><span class=\"bp\">/</span><span class=\"n\">Basic</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">34</span><span class=\"o\">:</span><span class=\"mi\">30</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Invalid</span><span class=\"w\"> </span><span class=\"n\">field</span><span class=\"w\"> </span><span class=\"kn\">notation</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">of</span>\n<span class=\"w\">  </span><span class=\"n\">c</span>\n<span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">known</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"n\">resolve</span><span class=\"w\"> </span><span class=\"n\">field</span><span class=\"w\"> </span><span class=\"ss\">`toUInt8</span><span class=\"bp\">`</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">String</span><span class=\"bp\">/</span><span class=\"n\">Basic</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">35</span><span class=\"o\">:</span><span class=\"mi\">4</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">unused</span><span class=\"w\"> </span><span class=\"ss\">`termination_by</span><span class=\"bp\">`</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">recursive</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"bp\">âœ–</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">9</span><span class=\"bp\">/</span><span class=\"mi\">21</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Building</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Array</span><span class=\"bp\">.</span><span class=\"n\">Match</span>\n<span class=\"n\">trace</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.&gt;</span><span class=\"w\"> </span><span class=\"n\">LEAN_PATH</span><span class=\"bp\">=/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Cli</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">batteries</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Qq</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">aesop</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">proofwidgets</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">importGraph</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">LeanSearchClient</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">plausible</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">media</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/</span><span class=\"n\">d6bf7385</span><span class=\"bp\">-</span><span class=\"n\">dcc0</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"n\">d27</span><span class=\"bp\">-</span><span class=\"n\">adb5</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">d1969c9345b</span><span class=\"bp\">/</span><span class=\"n\">Projects</span><span class=\"bp\">/</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"n\">Consensus</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">shreyas</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---v4.24.0/bin/lean /media/shreyas/d6bf7385-dcc0-4d27-adb5-1d1969c9345b/Projects/Consensus/.lake/packages/batteries/Batteries/Data/Array/Match.lean -o /media/shreyas/d6bf7385-dcc0-4d27-adb5-1d1969c9345b/Projects/Consensus/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/Array/Match.olean -i /media/shreyas/d6bf7385-dcc0-4d27-adb5-1d1969c9345b/Projects/Consensus/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/Array/Match.ilean -c /media/shreyas/d6bf7385-dcc0-4d27-adb5-1d1969c9345b/Projects/Consensus/.lake/packages/batteries/.lake/build/ir/Batteries/Data/Array/Match.c --setup /media/shreyas/d6bf7385-dcc0-4d27-adb5-1d1969c9345b/Projects/Consensus/.lake/packages/batteries/.lake/build/ir/Batteries/Data/Array/Match.setup.json --json</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">Array</span><span class=\"bp\">/</span><span class=\"n\">Match</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">64</span><span class=\"o\">:</span><span class=\"mi\">43</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Unknown</span><span class=\"w\"> </span><span class=\"n\">identifier</span><span class=\"w\"> </span><span class=\"ss\">`Std.Stream</span><span class=\"bp\">`</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">Array</span><span class=\"bp\">/</span><span class=\"n\">Match</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">85</span><span class=\"o\">:</span><span class=\"mi\">30</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Unknown</span><span class=\"w\"> </span><span class=\"n\">identifier</span><span class=\"w\"> </span><span class=\"ss\">`Std.Stream</span><span class=\"bp\">`</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">Array</span><span class=\"bp\">/</span><span class=\"n\">Match</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">93</span><span class=\"o\">:</span><span class=\"mi\">35</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Unknown</span><span class=\"w\"> </span><span class=\"n\">identifier</span><span class=\"w\"> </span><span class=\"ss\">`Std.Stream</span><span class=\"bp\">`</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">Array</span><span class=\"bp\">/</span><span class=\"n\">Match</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">130</span><span class=\"o\">:</span><span class=\"mi\">22</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Unknown</span><span class=\"w\"> </span><span class=\"n\">constant</span><span class=\"w\"> </span><span class=\"ss\">`Std.Iterators.PlausibleIterStep.deflate</span><span class=\"bp\">`</span>\n\n<span class=\"n\">Note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Inferred</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">resulting</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"bp\">`.</span><span class=\"n\">deflate</span><span class=\"bp\">`</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">PlausibleIterStep</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">âˆƒ</span><span class=\"w\"> </span><span class=\"n\">step'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">modifyStep</span><span class=\"w\"> </span><span class=\"n\">it</span><span class=\"w\"> </span><span class=\"n\">step'</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">step</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">Array</span><span class=\"bp\">/</span><span class=\"n\">Match</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">130</span><span class=\"o\">:</span><span class=\"mi\">22</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Unknown</span><span class=\"w\"> </span><span class=\"n\">constant</span><span class=\"w\"> </span><span class=\"ss\">`Subtype.deflate</span><span class=\"bp\">`</span>\n\n<span class=\"n\">Note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Inferred</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">resulting</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"bp\">`.</span><span class=\"n\">deflate</span><span class=\"bp\">`</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">PlausibleIterStep</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">step</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">âˆƒ</span><span class=\"w\"> </span><span class=\"n\">step'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"n\">modifyStep</span><span class=\"w\"> </span><span class=\"n\">it</span><span class=\"w\"> </span><span class=\"n\">step'</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">step</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">targets</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">String</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Array</span><span class=\"bp\">.</span><span class=\"n\">Match</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n</code></pre></div>",
        "id": 546487436,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761146624
    },
    {
        "content": "<p>This looks similar to recent cache issues, which we are trying to fix in this thread: <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/Build.20error.20in.20Tactic.20file/with/546458012\">#mathlib4 &gt; Build error in Tactic file</a></p>",
        "id": 546487922,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1761146744
    },
    {
        "content": "<p>current toolchain:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">active</span><span class=\"w\"> </span><span class=\"n\">toolchain</span>\n<span class=\"c1\">----------------</span>\n\n<span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">24</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">resolved</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">default</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">stable'</span><span class=\"o\">)</span>\n<span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"mf\">4.24</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x86_64</span><span class=\"bp\">-</span><span class=\"n\">unknown</span><span class=\"bp\">-</span><span class=\"n\">linux</span><span class=\"bp\">-</span><span class=\"n\">gnu</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">commit</span><span class=\"w\"> </span><span class=\"mi\">797</span><span class=\"n\">c613eb9b6d4ec95db23e3e00af9ac6657f24b</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Release</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 546487929,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761146745
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"238446\">Anne Baanen</span> <a href=\"#narrow/channel/270676-lean4/topic/Lake.20new.20errors/near/546487922\">said</a>:</p>\n<blockquote>\n<p>This looks similar to recent cache issues, which we are trying to fix in this thread: <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/Build.20error.20in.20Tactic.20file/with/546458012\">#mathlib4 &gt; Build error in Tactic file</a></p>\n</blockquote>\n<p>oh okay. But I haven't actually called <code>update</code> or <code>cache</code> yet</p>",
        "id": 546488167,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761146795
    },
    {
        "content": "<p>On the other hand, the issues seemed to come from version 4.25.0-rc{1,2}, not 4.24.0. Let me see if I can reproduce them.</p>",
        "id": 546488168,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1761146795
    },
    {
        "content": "<p>So the precise commands you run are <code>lake new foo math; cd foo; lake build</code>?</p>",
        "id": 546488416,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1761146841
    },
    {
        "content": "<p>I didn't even get to the second and third commands</p>",
        "id": 546488494,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761146855
    },
    {
        "content": "<p>Just <code>lake new Consensus math</code></p>",
        "id": 546488526,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761146863
    },
    {
        "content": "<p>Ah yes, I can reproduce this with <code>lake +v4.24.0 new bar math</code>.</p>",
        "id": 546488856,
        "sender_full_name": "Anne Baanen",
        "timestamp": 1761146944
    },
    {
        "content": "<p>Also happens with <code>lake +v4.23.0 new Consensus math</code></p>",
        "id": 546489579,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761147112
    },
    {
        "content": "<p>I think that the lake version has to match the mathlib version, otherwise it fails</p>",
        "id": 546490081,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1761147243
    },
    {
        "content": "<p>Also tried <code>lake +v4.22.0 new Consensus math</code>. Got the same error.</p>\n<p>I then checked the generated lean-toolchain:<br>\n<code>leanprover/lean4:v4.25.0-rc1</code></p>",
        "id": 546490117,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761147250
    },
    {
        "content": "<p><a href=\"#narrow/channel/270676-lean4/topic/Build.20error.20on.20.60lake.20.2Bleanprover.2Flean4.3Av4.2E22.2E0.20new.20foo.20math.60/near/546236449\">#lean4 &gt; Build error on &#96;lake +leanprover/lean4:v4.22.0 new foo math&#96; @ ðŸ’¬</a></p>",
        "id": 546490184,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1761147267
    },
    {
        "content": "<p>I am not at build error</p>",
        "id": 546490242,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761147284
    },
    {
        "content": "<p>I am really just creating a new project from scratch</p>",
        "id": 546490282,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761147293
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"466334\">Shreyas Srinivas</span> <a href=\"#narrow/channel/270676-lean4/topic/Lake.20new.20errors/near/546487436\">said</a>:</p>\n<blockquote>\n<p><code>error: build failed</code></p>\n</blockquote>\n<p>looks like you are to me</p>",
        "id": 546490377,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1761147320
    },
    {
        "content": "<p>In any case, that thread speaks about getting version specific toolchains. It doesn't explain the first error</p>",
        "id": 546490521,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761147356
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/hx7TulchyCEtV1cMJqOwtOi_/Screenshot-from-2025-10-22-17-35-48.png\">Screenshot from 2025-10-22 17-35-48.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/hx7TulchyCEtV1cMJqOwtOi_/Screenshot-from-2025-10-22-17-35-48.png\" title=\"Screenshot from 2025-10-22 17-35-48.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"2027x1075\" src=\"/user_uploads/thumbnail/3121/hx7TulchyCEtV1cMJqOwtOi_/Screenshot-from-2025-10-22-17-35-48.png/840x560.webp\"></a></div>",
        "id": 546490535,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761147359
    },
    {
        "content": "<p>Every toolchain is version-specific</p>",
        "id": 546490639,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1761147382
    },
    {
        "content": "<p>That screenshot is basically identical to what I posted in the other thread, with a different version number</p>",
        "id": 546490717,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1761147399
    },
    {
        "content": "<p>This has never been a problem before. <code>lake new &lt;,,,&gt; math</code> has always worked by picking the right toolchain. my default toolchain is v4.24.0</p>",
        "id": 546490822,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761147425
    },
    {
        "content": "<p>cache or build might fail</p>",
        "id": 546490869,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761147437
    },
    {
        "content": "<p>But not <code>lake new ...</code></p>",
        "id": 546490892,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761147443
    },
    {
        "content": "<p>and lake usually picks the corresponding mathlib toolchain</p>",
        "id": 546491004,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761147472
    },
    {
        "content": "<p>Given that it's the entrypoint to creating a project in the first place, I don't see how I can ensure in advance that the toolchains match</p>",
        "id": 546491163,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761147519
    },
    {
        "content": "<p>You can't, this is a bug in <code>new ... math</code>, as reported in the other thread</p>",
        "id": 546491973,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1761147735
    },
    {
        "content": "<p>Oh! The other thread doesn't actually talk about there being a bug, I interpreted that thread as a feature request for <code>lake +v4.22.0 new Foo math</code> to select Mathlib at the <code>v4.22.0</code> tag.</p>",
        "id": 547173392,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1761527948
    },
    {
        "content": "<p>But this is serious! I currently get</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">new</span><span class=\"w\"> </span><span class=\"n\">lakenew</span><span class=\"w\"> </span><span class=\"n\">math</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">downloading</span><span class=\"w\"> </span><span class=\"n\">mathlib</span><span class=\"w\"> </span><span class=\"ss\">`lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">file</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lakenew</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">previous</span><span class=\"w\"> </span><span class=\"n\">manifest</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">creating</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">scratch</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">540</span><span class=\"n\">c589f9555258461780f6cee59e27234079db9'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">updated</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">already</span><span class=\"w\"> </span><span class=\"n\">up</span><span class=\"bp\">-</span><span class=\"n\">to</span><span class=\"bp\">-</span><span class=\"n\">date</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">plausible</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">plausible</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">plausible</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">8864</span><span class=\"n\">a73bf79aad549e34eff972c606343935106d'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LeanSearchClient</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">LeanSearchClient</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LeanSearchClient</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">2</span><span class=\"n\">ed4ba69b6127de8f5c2af83cccacd3c988b06bf'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">importGraph</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"kn\">import</span><span class=\"bp\">-</span><span class=\"n\">graph</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">importGraph</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">451499</span><span class=\"n\">ea6e97cee4c8979b507a9af5581a849161'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">proofwidgets</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">ProofWidgets4</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">proofwidgets</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">fb8ed0a85a96e3176f6e94b20d413ea72d92576d'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">aesop</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">aesop</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">aesop</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">1</span><span class=\"n\">fa48c6a63b4c4cda28be61e1037192776e77ac0'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Qq</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">quote4</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Qq</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">95</span><span class=\"n\">c2f8afe09d9e49d3cacca667261da04f7f93f7'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">batteries</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">batteries</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">batteries</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">c44068fa1b40041e6df42bd67639b690eb2764ca'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cli</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cloning</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">cli</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cli</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">checking</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">72</span><span class=\"n\">ae7004d9f0ddb422aec5378204fdd7828c5672'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">mathlib</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">running</span><span class=\"w\"> </span><span class=\"n\">post</span><span class=\"bp\">-</span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">hooks</span>\n<span class=\"bp\">âœ–</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">3</span><span class=\"bp\">/</span><span class=\"mi\">21</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Building</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Array</span><span class=\"bp\">.</span><span class=\"n\">Match</span>\n<span class=\"n\">trace</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.&gt;</span><span class=\"w\"> </span><span class=\"n\">LEAN_PATH</span><span class=\"bp\">=/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Cli</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">batteries</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Qq</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">aesop</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">proofwidgets</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">importGraph</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">LeanSearchClient</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">plausible</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---v4.24.0/bin/lean /home/kim/scratch/lakenew/.lake/packages/batteries/Batteries/Data/Array/Match.lean -o /home/kim/scratch/lakenew/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/Array/Match.olean -i /home/kim/scratch/lakenew/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/Array/Match.ilean -c /home/kim/scratch/lakenew/.lake/packages/batteries/.lake/build/ir/Batteries/Data/Array/Match.c --setup /home/kim/scratch/lakenew/.lake/packages/batteries/.lake/build/ir/Batteries/Data/Array/Match.setup.json --json</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">Array</span><span class=\"bp\">/</span><span class=\"n\">Match</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">invalid</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">D</span><span class=\"w\"> </span><span class=\"n\">parameter</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">unknown</span><span class=\"w\"> </span><span class=\"n\">configuration</span><span class=\"w\"> </span><span class=\"n\">option</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">backward</span><span class=\"bp\">.</span><span class=\"n\">privateInPublic</span><span class=\"bp\">.</span><span class=\"n\">warn'</span>\n\n<span class=\"n\">If</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">option</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">defined</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">library</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"bp\">'-</span><span class=\"n\">Dweak</span><span class=\"bp\">.</span><span class=\"n\">backward</span><span class=\"bp\">.</span><span class=\"n\">privateInPublic</span><span class=\"bp\">.</span><span class=\"n\">warn'</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">it</span><span class=\"w\"> </span><span class=\"n\">conditionally</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"bp\">âœ–</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">4</span><span class=\"bp\">/</span><span class=\"mi\">21</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Building</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">String</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"n\">trace</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.&gt;</span><span class=\"w\"> </span><span class=\"n\">LEAN_PATH</span><span class=\"bp\">=/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Cli</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">batteries</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Qq</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">aesop</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">proofwidgets</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">importGraph</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">LeanSearchClient</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">plausible</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"n\">lakenew</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">kim</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---v4.24.0/bin/lean /home/kim/scratch/lakenew/.lake/packages/batteries/Batteries/Data/String/Basic.lean -o /home/kim/scratch/lakenew/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/String/Basic.olean -i /home/kim/scratch/lakenew/.lake/packages/batteries/.lake/build/lib/lean/Batteries/Data/String/Basic.ilean -c /home/kim/scratch/lakenew/.lake/packages/batteries/.lake/build/ir/Batteries/Data/String/Basic.c --setup /home/kim/scratch/lakenew/.lake/packages/batteries/.lake/build/ir/Batteries/Data/String/Basic.setup.json --json</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">String</span><span class=\"bp\">/</span><span class=\"n\">Basic</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">invalid</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">D</span><span class=\"w\"> </span><span class=\"n\">parameter</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">unknown</span><span class=\"w\"> </span><span class=\"n\">configuration</span><span class=\"w\"> </span><span class=\"n\">option</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">backward</span><span class=\"bp\">.</span><span class=\"n\">privateInPublic</span><span class=\"bp\">.</span><span class=\"n\">warn'</span>\n\n<span class=\"n\">If</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">option</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">defined</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">library</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"bp\">'-</span><span class=\"n\">Dweak</span><span class=\"bp\">.</span><span class=\"n\">backward</span><span class=\"bp\">.</span><span class=\"n\">privateInPublic</span><span class=\"bp\">.</span><span class=\"n\">warn'</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">it</span><span class=\"w\"> </span><span class=\"n\">conditionally</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">targets</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Array</span><span class=\"bp\">.</span><span class=\"n\">Match</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">String</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n</code></pre></div>\n<p><span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span>, I think the problem here is that <code>lake new</code> is running the Mathlib post-update hooks using an older Lean version than the toolchain specifies in the repository?</p>\n<p>Despite the error output from <code>lake new</code> quoted above, once you enter the repository <code>lake update</code> and <code>lake build</code> seem to work as expected.</p>\n<p>Can someone confirm they see the same behaviour?</p>\n<p>This seems like an urgent problem: the main entry point for creating Lean math projects is broken.</p>",
        "id": 547173613,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1761528191
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> Unfortunately, this is sadly not fixable by fixing Lake as the problem is that old Lake versions do not perfom an restart upon downloading the new toolchain. Implementing Eric's feature request will fix in this behavior in future versions (by removing the offending logic), but older toolchains will still break.</p>",
        "id": 547174003,
        "sender_full_name": "Mac Malone",
        "timestamp": 1761528529
    },
    {
        "content": "<p>Independently, it should be possible  to hotfix this in mathlib by prefixing the option with <code>weak</code> to make it backwards-compatible (though this may be insufficient if the newer toolchain really is required to build <code>cache</code>).</p>",
        "id": 547174067,
        "sender_full_name": "Mac Malone",
        "timestamp": 1761528578
    },
    {
        "content": "<p>Also, since this is a failure in the post-update hook, the project should still be properly created and running <code>lake exe cache get</code> afterwards should work?</p>",
        "id": 547174366,
        "sender_full_name": "Mac Malone",
        "timestamp": 1761528819
    },
    {
        "content": "<p>Yes, the project created does work. It's just that users will not know this, and perhaps assume (reasonably) that the error messages from <code>lake new</code> mean that they should give up. :-)</p>",
        "id": 547175086,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1761529476
    },
    {
        "content": "<p>Yeah, this is definitely not ideal, but as a small comfort, at least its not fully broken.</p>",
        "id": 547175151,
        "sender_full_name": "Mac Malone",
        "timestamp": 1761529529
    },
    {
        "content": "<p>As another potential fix, we could add a check to the Mathlib post-update hook that skips fetching the cache (with instructions) if it detects this toolchain mismatch.</p>",
        "id": 547175291,
        "sender_full_name": "Mac Malone",
        "timestamp": 1761529657
    },
    {
        "content": "<p>Does <a href=\"https://github.com/leanprover-community/batteries/pull/1479\">batteries#1479</a> look right?</p>",
        "id": 547175362,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1761529739
    },
    {
        "content": "<p>I like the idea of defence in depth and adding a guard to the post-update hook. Is your suggestion just to check whether <code>lean.versionString</code> matches the contents of <code>lean-toolchain</code> appropriately?</p>",
        "id": 547175415,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1761529803
    },
    {
        "content": "<p>The PR looks godd to me! My only concern is whether that is actually sufficient ot avoid any errors in the post-update hook. As for the post-update hook, change that should be fine as quick fix (and should work generally after implementing Eric's suggestion)</p>",
        "id": 547175544,
        "sender_full_name": "Mac Malone",
        "timestamp": 1761529927
    },
    {
        "content": "<p>I guess we also need to have a some CI somewhere to detect <code>lake new Foo math</code> not working so we catch this in time next time! I guess this can't actually happen in Mathlib CI, because things only break once <code>master</code> is updated... Any ideas?</p>",
        "id": 547175651,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1761530060
    },
    {
        "content": "<p>With Eric's feature <code>lake new</code> will always be using an fixed old version of mathlib (the one for the toolchain),  so that would also complicate testing this. There is a Lake test which tests the Lake templates, but the <code>lake new .. math</code> part is not run in CI because we did not want to performon network interactions in the test suite.</p>",
        "id": 547175815,
        "sender_full_name": "Mac Malone",
        "timestamp": 1761530255
    },
    {
        "content": "<p>Perhaps we could performa similar test as part of the release process since <code>lake new</code> will be pinned to releases?</p>",
        "id": 547175877,
        "sender_full_name": "Mac Malone",
        "timestamp": 1761530308
    },
    {
        "content": "<p>Oh, I'm confused. I don't like the idea that <code>lake new</code> would be using a fixed old version. That's not okay.</p>\n<p>I thought Eric's suggestion was to support explicitly overriding the toolchain so <code>lake +v4.22.0 new Foo math</code> would work, but just <code>lake new Foo math</code> would still always give a <code>lean-toolchain</code> file matching current Mathlib master.</p>",
        "id": 547175995,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1761530425
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"315577\">Mac Malone</span> <a href=\"#narrow/channel/270676-lean4/topic/Lake.20new.20errors/near/547175291\">said</a>:</p>\n<blockquote>\n<p>As another potential fix, we could add a check to the Mathlib post-update hook that skips fetching the cache (with instructions) if it detects this toolchain mismatch.</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/30956\">#30956</a></p>",
        "id": 547176317,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1761530722
    },
    {
        "content": "<p>My proposal was for <code>lake new math</code> to on most systems track mathlib stable</p>",
        "id": 547215494,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1761553294
    },
    {
        "content": "<p>To add more data:</p>\n<ol>\n<li>Yes lake cache works. </li>\n<li>There are new users joining on the lean discord who have run into this issue</li>\n</ol>",
        "id": 547216064,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1761553519
    },
    {
        "content": "<p><code>lake new foo math</code> is now working again.</p>",
        "id": 547245794,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1761562423
    },
    {
        "content": "<p>I would love to see someone add a check in CI (maybe a scheduled job, along with <code>lean4checker</code> and the Mathlib executable?) that ensures this can't happen again.</p>",
        "id": 547245940,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1761562462
    },
    {
        "content": "<p>At least that we promptly notice it.</p>",
        "id": 547245969,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1761562470
    }
]