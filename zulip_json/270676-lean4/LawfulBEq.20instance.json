[
    {
        "content": "<p>Hi all,</p>\n<p>I have this data type:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Term</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Var</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Term</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">BEq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Repr</span>\n</code></pre></div>\n<p>And I am trying to fill in the <code>sorry</code> here:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">instLawfulBEq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LawfulBEq</span><span class=\"w\"> </span><span class=\"n\">Term</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Can anyone point me in the right direction?</p>",
        "id": 507408844,
        "sender_full_name": "Ben Selfridge",
        "timestamp": 1742617830
    },
    {
        "content": "<p>this is not quite trying to fill in the <code>sorry</code> explicitly, but you can get a <code>LawfulBEq</code> instance directly from a <code>DecidableEq</code> instanc. I'd argue <code>DecidableEq</code> is usually a better instance if you want to reason about equality than BEq, but you get BEq derived from it.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Term</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Var</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Term</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">DecidableEq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Repr</span>\n\n<span class=\"bp\">#</span><span class=\"n\">synth</span><span class=\"w\"> </span><span class=\"n\">LawfulBEq</span><span class=\"w\"> </span><span class=\"n\">Term</span><span class=\"w\"> </span><span class=\"c1\">-- instLawfulBEq</span>\n</code></pre></div>",
        "id": 507426838,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1742630137
    },
    {
        "content": "<p>(the problem with your version is that the <code>deriving</code> machinery builds the instance under the hood, and so it's going to be hard to look into its definition when proving its lawfulness)</p>",
        "id": 507427228,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1742630456
    }
]