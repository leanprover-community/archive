[
    {
        "content": "<p>Is there any function I can run in <code>CoreM</code> or <code>MetaM</code> that will get me the info tree of a declaration? Would this probably a function that takes a <code>ConstantInfo</code>?</p>",
        "id": 488835862,
        "sender_full_name": "nrs",
        "timestamp": 1734095051
    },
    {
        "content": "<p>seems like <code>MonadInfoTree</code> provides a method for this</p>",
        "id": 488837970,
        "sender_full_name": "nrs",
        "timestamp": 1734095825
    },
    {
        "content": "<p>hm, </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">run_meta</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">dbg_trace</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">MonadInfoTree</span><span class=\"bp\">.</span><span class=\"n\">getInfoState</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trees</span><span class=\"bp\">.</span><span class=\"n\">size</span>\n<span class=\"w\">  </span><span class=\"n\">dbg_trace</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">getInfoTrees</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">size</span>\n</code></pre></div>\n<p>are both printing <code>0</code> but I have three named declaration in the document, anyone know what might cause this?</p>",
        "id": 488846809,
        "sender_full_name": "nrs",
        "timestamp": 1734098494
    },
    {
        "content": "<p>ah using <code>Lean.Elab.Command.CommandElabM</code> (or <code>run_cmd</code>) instead works. anyone with knowledge of the internals that could explain this? edit: oh but it seems to only get infotrees related to the current declaration and doesn't grab the previous declarations)</p>",
        "id": 488847873,
        "sender_full_name": "nrs",
        "timestamp": 1734098803
    },
    {
        "content": "<p>The only way I know of getting an <code>InfoTree</code> is to elaborate commands yourself. This can be done via <code>Frontend.processCommand</code>. If there's a more direct way, I'd be interested in hearing about it!</p>",
        "id": 488857691,
        "sender_full_name": "David Renshaw",
        "timestamp": 1734101484
    },
    {
        "content": "<p>Thanks for the tip! Trying out stuff in the <code>Elab.Frontend</code> module</p>",
        "id": 488860739,
        "sender_full_name": "nrs",
        "timestamp": 1734102301
    },
    {
        "content": "<p>I have some helper functions for such things here: <a href=\"https://github.com/adamtopaz/lean_extras/blob/master/LeanExtras/Frontend.lean\">https://github.com/adamtopaz/lean_extras/blob/master/LeanExtras/Frontend.lean</a></p>",
        "id": 488862836,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1734102879
    },
    {
        "content": "<p>woah very cool stuff! thanks a lot!</p>",
        "id": 488863198,
        "sender_full_name": "nrs",
        "timestamp": 1734102980
    }
]