[
    {
        "content": "<p>I find the error message in cases like:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span>\n\n<span class=\"sd\">/-- error: Unknown identifier `T` -/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">T</span>\n</code></pre></div>\n<p>to be a bit confusing considering <code>#check T</code> works, and the identifier clearly \"exists\", albeit presumably not in the environment <code>#eval</code> is working with.</p>\n<p>In slightly realer cases where I have <code>(someexpr).something</code>, and where I mistakenly think my expression gives me a real value it's even a bit further confusing to see the error message telling me <code>someexpr</code> doesn't exist when I see it does . In these cases probably I should train myself to type <code>#reduce</code> instead.</p>\n<p>But should <code>#eval</code>'s error messages for this say something more specific than claiming the identifier doesn't exist?</p>",
        "id": 560864544,
        "sender_full_name": "Julian Berman",
        "timestamp": 1764372252
    },
    {
        "content": "<p>Here's an implementation: <a href=\"https://github.com/leanprover/lean4/pull/11427\">lean4#11427</a></p>\n<p>The error is localized to the <code>#eval</code> keyword, and it could be friendlier if it showed errors on uses of free variables.</p>\n<p>The reason <code>#eval</code> has its current behavior was because I thought it's marginally friendlier to have the error on a use of a free variable (and to avoid pulling in any typeclasses from <code>variable</code>), rather than on <code>#eval</code> itself.</p>\n<p>(In Lean's architecture, section variables are elaborated at each command that wants them, so in that sense it they really don't exist for <code>#eval</code>. Probably it would be better if in general the \"unknown identifier\" error would have a backup strategy that involves elaborating the section variables to try to infer what the mistake was...)</p>",
        "id": 560876238,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1764384999
    }
]