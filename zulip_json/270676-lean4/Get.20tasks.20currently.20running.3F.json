[
    {
        "content": "<p>Is there a way to see what tasks are currently running? Or, even indirectly, see the number of tasks or the state of the thread pool?</p>\n<p>The context here is <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/slow.20linting.20step.20CI.3F/with/566425583\">#mathlib4 &gt; slow linting step CI?</a>, in which occasionally CI linting steps seem to continue running even after linting finishes. It's a bit of a shot in the dark, but I'm wondering if maybe some linter started a task behind the scenes which simply hasn't ended.</p>\n<p>Also happy to hear other ideas for how to debug this or what may be going on! :)</p>",
        "id": 566454377,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1767655222
    },
    {
        "content": "<blockquote>\n<p>Is there a way to see what tasks are currently running</p>\n</blockquote>\n<p>Debuggers like <code>gdb</code> can show you what each individual thread is currently doing. \"What tasks are running\" is a bit of a tough question, how do you identify a task after all. But if you want to know what your system is busy with, that's going to tell you.</p>\n<blockquote>\n<p>see the number of tasks or the state of the thread pool?</p>\n</blockquote>\n<p>I'd say get a lean build in reldebug mode and start printing out the internal state in your debugger.</p>",
        "id": 566455113,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1767655723
    },
    {
        "content": "<p>Hmmm. This problem is only occasional and has only appeard in CI, in which something like that sounds infeasible(?)...but maybe I could try to reproduce it locally by just running <code>runLinter</code> on mathlib over and over? <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span></p>",
        "id": 566455249,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1767655838
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"395550\">Henrik Böving</span> <a href=\"#narrow/channel/270676-lean4/topic/Get.20tasks.20currently.20running.3F/near/566455113\">said</a>:</p>\n<blockquote>\n<p>I'd say get a lean build in reldebug mode and start printing out the internal state in your debugger.</p>\n</blockquote>\n<p>By the way, is there documentation somewhere on how to do this? I'm not familiar with these tools but happy to learn. :)</p>",
        "id": 566455306,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1767655889
    },
    {
        "content": "<blockquote>\n<p>but maybe I could try to reproduce it locally by just running <code>runLinter</code> on mathlib over and over? <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span></p>\n</blockquote>\n<p>that's what we do for these bugs yes</p>\n<blockquote>\n<p>By the way, is there documentation somewhere on how to do this? I'm not familiar with these tools but happy to learn. :)</p>\n</blockquote>\n<p>you do a normal Lean build from source but instead of <code>cmake --preset release</code> you do <code>cmake --preset reldebug</code></p>",
        "id": 566455717,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1767656199
    },
    {
        "content": "<p>Oh, that's nice and easy :) Is this Linux-only, though? ctrl+f in lean4 suggests(?) I need <code>ubuntu-latest</code> (but I don't really know how to read these files yet). (EDIT: aha, I was looking at what CI specifically does)</p>",
        "id": 566455890,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1767656365
    },
    {
        "content": "<p>You should be able to build on all major platforms that we support <a href=\"https://github.com/leanprover/lean4/blob/master/doc/make/index.md\">https://github.com/leanprover/lean4/blob/master/doc/make/index.md</a></p>",
        "id": 566455946,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1767656422
    },
    {
        "content": "<p>Ok great, now I know any errors are my own. <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span> Thanks for the pointers! :)</p>",
        "id": 566456032,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1767656483
    }
]