[
    {
        "content": "<p>In <a href=\"https://github.com/leanprover-community/mathlib4/pull/25125#discussion_r2104629736\">this mathlib PR</a>, I ended up just checking if the name of the declaration starts with <code>inst</code>; can I do any better? The problem is that my attribute handler is running before the <code>instance</code> attribute handler, and so at the point I check the declaration has not been registered as an instance yet.</p>",
        "id": 520142404,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1748043053
    },
    {
        "content": "<p>I don't think so but I don't think it would cause any problems if <code>instance</code> was appended to the start instead</p>",
        "id": 520182796,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1748080765
    },
    {
        "content": "<p>The instance attribute uses the default <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.AttributeApplicationTime#doc\">docs#Lean.AttributeApplicationTime</a>, which is after type checking. One way to get <code>simps</code> to run after <code>instance</code> is to tell <code>simps</code> to apply after compilation (which, to be fair, is a bit of a hack).</p>",
        "id": 520669225,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1748352517
    },
    {
        "content": "<p>This is what we use in <code>to_additive</code>, IIRC to ensure that all equational lemmas have been generated.</p>",
        "id": 520669434,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1748352577
    },
    {
        "content": "<p>I've updated <a href=\"https://github.com/leanprover-community/mathlib4/pull/25125\">#25125</a> to do that now, thanks for the tip</p>",
        "id": 520982190,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1748470240
    }
]