[
    {
        "content": "<p>For example, how to I see if a <code>Lean.Expr</code> is a function type and get its return type?</p>",
        "id": 501287893,
        "sender_full_name": "Paul Mure",
        "timestamp": 1740246995
    },
    {
        "content": "<p>To answer the question from the title you use <code>inferType</code> for that. The question you wrote out doesn't make sense to me, <code>Lean.Expr</code> is not a function type.</p>",
        "id": 501288607,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1740247512
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"395550\">Henrik Böving</span> <a href=\"#narrow/channel/270676-lean4/topic/How.20to.20examine.20the.20type.20of.20an.20Expression.20in.20meta-programming/near/501288607\">said</a>:</p>\n<blockquote>\n<p>To answer the question from the title you use <code>inferType</code> for that. The question you wrote out doesn't make sense to me, <code>Lean.Expr</code> is not a function type.</p>\n</blockquote>\n<p>Sorry for the wording, I'm trying to examine the type of the expression being represented by a <code>Lean.Expr</code>.<br>\nFor example, how do I know if the new <code>Lean.Expr</code> returned by <code>inferType</code> is a function type and get the return type of it?</p>",
        "id": 501288904,
        "sender_full_name": "Paul Mure",
        "timestamp": 1740247771
    },
    {
        "content": "<p>If you want to know whether it is an ordinary function you can use <code>Expr.isArrow</code>, other than that you can use <code>Expr.isForall</code> to check whether it's a function type, both dependent or not dependnet. To get it's return type you're going to need to use a <code>forallTelescope</code></p>",
        "id": 501289346,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1740248121
    },
    {
        "content": "<p>It's probably best to use <code>whnfCore (&lt;- inferType e)</code> for the inferred type before using <code>Expr.isForall</code>, since the expression might have metavariables, might not be beta reduced, might have metadata, etc. Often people use <code>whnfR</code> to unfold reducible definitions too. Or, if you want to know if it could ever be used as a function at the current transparency level, there's <code>whnf</code>.</p>",
        "id": 501307112,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1740262879
    },
    {
        "content": "<p>Great suggestions, thanks for the help!</p>",
        "id": 501415297,
        "sender_full_name": "Paul Mure",
        "timestamp": 1740349045
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"589377\">Paul Mure</span> has marked this topic as resolved.</p>",
        "id": 501415299,
        "sender_full_name": "Notification Bot",
        "timestamp": 1740349051
    }
]