[
    {
        "content": "<p>I’m encountering an error in a file that I’ve never modified. The file in question is <strong>LetRec.lean</strong>, located at</p>\n<blockquote>\n<p>.elan\\toolchains\\leanprover--lean4---v4.16.0-rc2\\src\\lean\\Lean\\Elab\\LetRec.lean  </p>\n</blockquote>\n<p>The error occurs in the definition of <code>elabLetRecDeclValues</code>on line 95:</p>\n<p><code>(mkInfoOnError := (pure &lt;| mkBodyInfo view.valStx none))</code></p>\n<p>Here is the error message:</p>\n<blockquote>\n<p>invalid argument name 'mkInfoOnError' for function 'Lean.Elab.Term.withInfoContext'</p>\n</blockquote>\n<p>Do you have any idea where this issue comes from and how I can resolve it?</p>\n<p>Additionally, when I checked the definition of \"elabLetRecDeclValues\" on Lean’s GitHub repository (<a href=\"https://github.com/leanprover/lean4/blob/a832f398b80a5ebb820d27b9e55ec949759043ff/src/Lean/Elab/LetRec.lean#L15-L23\">here</a>), I found a different definition, and surprisingly this file was updated two years ago. Unless I’m missing something, shouldn't this issue be related to an outdated Lean version?</p>",
        "id": 509392077,
        "sender_full_name": "Farzad Jafarrahmani",
        "timestamp": 1743496599
    },
    {
        "content": "<p>Why are you rebuilding a Lean core file? I think you've already taken a wrong turn two steps before and need to tell us how you got there</p>",
        "id": 509394600,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1743497384
    },
    {
        "content": "<p>I was doing some metaprogramming exercises that I encountered an error in one my definition using let rec. Upon opening the LetRec file, I found that there was already an error present there. I then thought that perhaps my error is related to this pre-existing issue in the LetRec file.</p>",
        "id": 509396641,
        "sender_full_name": "Farzad Jafarrahmani",
        "timestamp": 1743497964
    },
    {
        "content": "<p>I can assure you that all files in a Lean release were built without errors. Probably your editor is using the wrong version of Lean to visit the file. Could you please post the output of the \"Lean 4: Troubleshooting: Show Setup Information\" VS Code command in that file?</p>",
        "id": 509419205,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1743504934
    },
    {
        "content": "<p>This also happens on my machine regularly, it just seems like when you enter a toolchain file, then it has some wrong lean path with outdated olean files.</p>",
        "id": 509438253,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1743510577
    },
    {
        "content": "<p>Maybe this has something to do with symlink differences between windows and linux? When I open VS code directly in my lean fork, I get</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">unknown</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"kn\">prefix</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Init'</span>\n\n<span class=\"n\">No</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Init'</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Init</span><span class=\"bp\">.</span><span class=\"n\">olean'</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">search</span><span class=\"w\"> </span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"n\">entries</span><span class=\"o\">:</span>\n<span class=\"n\">c</span><span class=\"o\">:</span><span class=\"bp\">\\</span><span class=\"n\">Users</span><span class=\"bp\">\\</span><span class=\"n\">robin</span><span class=\"bp\">\\.</span><span class=\"n\">elan</span><span class=\"bp\">\\</span><span class=\"n\">toolchains</span><span class=\"bp\">\\</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">stage0</span><span class=\"bp\">\\..\\</span><span class=\"n\">stage1</span><span class=\"bp\">\\</span><span class=\"n\">lib</span><span class=\"bp\">\\</span><span class=\"n\">lean</span>\n</code></pre></div>\n<p>because the <code>..</code> on windows means <code>c:\\Users\\robin\\.elan\\toolchains\\stage1\\lib\\lean</code> in contrast to linux where (I'm pretty sure) it resolves the symlink first and then takes the parent directory.</p>",
        "id": 509439039,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1743510793
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110024\">Sebastian Ullrich</span> <a href=\"#narrow/channel/270676-lean4/topic/LetRec.20Error/near/509419205\">said</a>:</p>\n<blockquote>\n<p>I can assure you that all files in a Lean release were built without errors. Probably your editor is using the wrong version of Lean to visit the file. Could you please post the output of the \"Lean 4: Troubleshooting: Show Setup Information\" VS Code command in that file?</p>\n</blockquote>\n<p>Is the following what you mean?</p>\n<p><strong>Operating system</strong>: Windows_NT (release: 10.0.19045)<br>\n<strong>CPU architecture</strong>: x64<br>\n<strong>CPU model</strong>: 8 x 11th Gen Intel(R) Core(TM) i7-1185G7 @ 3.00GHz<br>\n<strong>Available RAM</strong>: 16.84 GB</p>\n<p><strong>VS Code version</strong>: Reasonably up-to-date (version: 1.97.2)<br>\n<strong>Lean 4 extension version</strong>: 0.0.195<br>\n<strong>Curl installed</strong>: true<br>\n<strong>Git installed</strong>: true<br>\n<strong>Elan</strong>: Reasonably up-to-date (version: 3.1.1)<br>\n<strong>Lean</strong>: Reasonably up-to-date (version: 4.14.0)<br>\n<strong>Project</strong>: Valid Lean project (path: c:\\Users\\f00879599\\.elan\\toolchains\\leanprover--lean4---v4.16.0-rc2\\src\\lean)</p>\n<hr>\n<p><strong>Elan toolchains</strong>: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">installed</span><span class=\"w\"> </span><span class=\"n\">toolchains</span>\n<span class=\"c1\">--------------------</span>\n\n<span class=\"n\">stable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">default</span><span class=\"o\">)</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">11</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc2</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">16</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc2</span>\n\n\n<span class=\"n\">active</span><span class=\"w\"> </span><span class=\"n\">toolchain</span>\n<span class=\"c1\">----------------</span>\n\n<span class=\"n\">stable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">default</span><span class=\"o\">)</span>\n\n<span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"mf\">4.14</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x86_64</span><span class=\"bp\">-</span><span class=\"n\">w64</span><span class=\"bp\">-</span><span class=\"n\">windows</span><span class=\"bp\">-</span><span class=\"n\">gnu</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">commit</span><span class=\"w\"> </span><span class=\"mi\">410</span><span class=\"n\">fab728470</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Release</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 509466094,
        "sender_full_name": "Farzad Jafarrahmani",
        "timestamp": 1743517417
    },
    {
        "content": "<p>It's strange that your project path starts with <code>c:</code> instead of <code>C:</code>, that is likely triggering a bug in elan. <a href=\"https://github.com/leanprover/elan/issues/161\">https://github.com/leanprover/elan/issues/161</a></p>",
        "id": 509506725,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1743527604
    }
]