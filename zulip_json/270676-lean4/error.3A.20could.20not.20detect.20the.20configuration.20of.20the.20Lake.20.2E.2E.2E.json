[
    {
        "content": "<p>why this error ocurrs? how to fix this?</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>❯<span class=\"w\"> </span>lake<span class=\"w\"> </span>build\nerror:<span class=\"w\"> </span>could<span class=\"w\"> </span>not<span class=\"w\"> </span>detect<span class=\"w\"> </span>the<span class=\"w\"> </span>configuration<span class=\"w\"> </span>of<span class=\"w\"> </span>the<span class=\"w\"> </span>Lake<span class=\"w\"> </span>installation\n</code></pre></div>\n<p>My environment:</p>\n<ul>\n<li>Windows 11</li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>❯<span class=\"w\"> </span>lake<span class=\"w\"> </span>--version\nLake<span class=\"w\"> </span>version<span class=\"w\"> </span><span class=\"m\">5</span>.0.0-daa2218<span class=\"w\"> </span><span class=\"o\">(</span>Lean<span class=\"w\"> </span>version<span class=\"w\"> </span><span class=\"m\">4</span>.11.0-rc1<span class=\"o\">)</span>\n</code></pre></div>",
        "id": 459756490,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723321505
    },
    {
        "content": "<p>Are you running the command in the root directory of a correctly formatted lean project?</p>",
        "id": 459857736,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1723364882
    },
    {
        "content": "<p>Yes.</p>",
        "id": 459857855,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723364912
    },
    {
        "content": "<p>the repository to build is lean-by-example (see <a href=\"https://github.com/lean-ja/lean-by-example\">https://github.com/lean-ja/lean-by-example</a>)</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>git<span class=\"w\"> </span>clone<span class=\"w\"> </span>https://github.com/lean-ja/lean-by-example.git\n<span class=\"nb\">cd</span><span class=\"w\"> </span>lean-by-example\nlake<span class=\"w\"> </span>build\n</code></pre></div>",
        "id": 459867373,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723369274
    },
    {
        "content": "<p>Can't reproduce on macos. For me it builds fine (with many warnings, but that's the repositories problem!)</p>",
        "id": 459955885,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723418926
    },
    {
        "content": "<p>it seems to be my elan problem</p>",
        "id": 459956736,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723419874
    },
    {
        "content": "<blockquote>\n<p>with many warnings, but that's the repositories problem!</p>\n</blockquote>\n<p>Repo warnings are intended.</p>",
        "id": 459956943,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723420105
    },
    {
        "content": "<p>many <code>lake</code> commands does not run.</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>lean-by-example<span class=\"w\"> </span>on<span class=\"w\"> </span><span class=\"w\"> </span>main\n❯<span class=\"w\"> </span>lake<span class=\"w\"> </span>update\nerror:<span class=\"w\"> </span>could<span class=\"w\"> </span>not<span class=\"w\"> </span>detect<span class=\"w\"> </span>the<span class=\"w\"> </span>configuration<span class=\"w\"> </span>of<span class=\"w\"> </span>the<span class=\"w\"> </span>Lake<span class=\"w\"> </span>installation\n\nlean-by-example<span class=\"w\"> </span>on<span class=\"w\"> </span><span class=\"w\"> </span>main\n❯<span class=\"w\"> </span>lake<span class=\"w\"> </span>build\nerror:<span class=\"w\"> </span>could<span class=\"w\"> </span>not<span class=\"w\"> </span>detect<span class=\"w\"> </span>the<span class=\"w\"> </span>configuration<span class=\"w\"> </span>of<span class=\"w\"> </span>the<span class=\"w\"> </span>Lake<span class=\"w\"> </span>installation\n\nlean-by-example<span class=\"w\"> </span>on<span class=\"w\"> </span><span class=\"w\"> </span>main\n❯<span class=\"w\"> </span>lake<span class=\"w\"> </span>exe<span class=\"w\"> </span>cache<span class=\"w\"> </span>get\nerror:<span class=\"w\"> </span>could<span class=\"w\"> </span>not<span class=\"w\"> </span>detect<span class=\"w\"> </span>the<span class=\"w\"> </span>configuration<span class=\"w\"> </span>of<span class=\"w\"> </span>the<span class=\"w\"> </span>Lake<span class=\"w\"> </span>installation\n</code></pre></div>",
        "id": 459957023,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723420208
    },
    {
        "content": "<blockquote>\n<p>Can't reproduce</p>\n</blockquote>\n<p>I think elan or lake in my local environment is broken, but I'm not sure why.</p>",
        "id": 459957093,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723420273
    },
    {
        "content": "<p>CI is working correctly and is not a Windows problem..</p>",
        "id": 459957104,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723420289
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> How do I uninstall <code>elan</code>?</p>",
        "id": 459957209,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723420425
    },
    {
        "content": "<p>Just delete <code>~/.elan</code>.</p>",
        "id": 459975089,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723430286
    },
    {
        "content": "<p>I have removed <code>~/.elan</code> and tried to reinstall elan.</p>\n<p>But following errors occur.</p>\n<div class=\"codehilite\" data-code-language=\"PowerShell\"><pre><span></span><code><span class=\"nb\">PS </span><span class=\"n\">C</span><span class=\"p\">:\\</span><span class=\"n\">Users</span><span class=\"p\">\\</span><span class=\"n\">井上亜星</span><span class=\"p\">\\</span><span class=\"n\">lean-by-example</span><span class=\"p\">&gt;</span> <span class=\"nb\">Start-BitsTransfer</span> <span class=\"n\">-Source</span> <span class=\"s2\">\"https://raw.githubusercontent.com/leanprover/elan/master/elan-init.ps1\"</span> <span class=\"n\">-Destination</span> <span class=\"s2\">\"elan-init.ps1\"</span>\n<span class=\"nb\">Start-BitsTransfer</span> <span class=\"p\">:</span> <span class=\"n\">オブジェクト参照がオブジェクト</span> <span class=\"n\">インスタンスに設定されていません</span><span class=\"err\">。</span>\n<span class=\"n\">発生場所</span> <span class=\"n\">行</span><span class=\"p\">:</span><span class=\"n\">1</span> <span class=\"n\">文字</span><span class=\"p\">:</span><span class=\"n\">1</span>\n<span class=\"p\">+</span> <span class=\"nb\">Start-BitsTransfer</span> <span class=\"n\">-Source</span> <span class=\"s2\">\"https://raw.githubusercontent.com/leanpro ...</span>\n<span class=\"s2\">+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>\n<span class=\"s2\">    + CategoryInfo          : NotSpecified: (:) [Start-BitsTransfer], NullReferenceException</span>\n<span class=\"s2\">    + FullyQualifiedErrorId : System.NullReferenceException,Microsoft.BackgroundIntelligentTransfer.Management.NewBitsTransferCommand</span>\n\n<span class=\"s2\">PS C:\\Users\\井上亜星\\lean-by-example&gt; Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Scope Process</span>\n<span class=\"s2\">Set-ExecutionPolicy : 'Set-ExecutionPolicy' コマンドはモジュール 'Microsoft.PowerShell.Security' で見つかりましたが、このモジュールを読み込むことができませんでした。詳細</span>\n<span class=\"s2\">については、'Import-Module Microsoft.PowerShell.Security' を実行してください。</span>\n<span class=\"s2\">発生場所 行:1 文字:1</span>\n<span class=\"s2\">+ Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Scope Process</span>\n<span class=\"s2\">+ ~~~~~~~~~~~~~~~~~~~</span>\n<span class=\"s2\">    + CategoryInfo          : ObjectNotFound: (Set-ExecutionPolicy:String) [], CommandNotFoundException</span>\n<span class=\"s2\">    + FullyQualifiedErrorId : CouldNotAutoloadMatchingModule</span>\n\n<span class=\"s2\">PS C:\\Users\\井上亜星\\lean-by-example&gt; $rc = .\\elan-init.ps1 -NoPrompt 1 -DefaultToolchain leanprover/lean4:stable</span>\n<span class=\"s2\">.\\elan-init.ps1 : 用語 '.\\elan-init.ps1' は、コマンドレット、関数、スクリプト ファイル、または操作可能なプログラムの名前として認識されません。名前が正しく記述されている</span>\n<span class=\"s2\">ことを確認し、パスが含まれている場合はそのパスが正しいことを確認してから、再試行してください。</span>\n<span class=\"s2\">発生場所 行:1 文字:7</span>\n<span class=\"s2\">+ $rc = .\\elan-init.ps1 -NoPrompt 1 -DefaultToolchain leanprover/lean4: ...</span>\n<span class=\"s2\">+       ~~~~~~~~~~~~~~~</span>\n<span class=\"s2\">    + CategoryInfo          : ObjectNotFound: (.\\elan-init.ps1:String) [], CommandNotFoundException</span>\n<span class=\"s2\">    + FullyQualifiedErrorId : CommandNotFoundException</span>\n\n<span class=\"s2\">PS C:\\Users\\井上亜星\\lean-by-example&gt; Write-Host \"</span><span class=\"n\">elan-init</span> <span class=\"n\">returned</span> <span class=\"p\">[</span><span class=\"nv\">$rc</span><span class=\"p\">]</span><span class=\"s2\">\"</span>\n<span class=\"s2\">elan-init returned []</span>\n<span class=\"s2\">PS C:\\Users\\井上亜星\\lean-by-example&gt; del .\\elan-init.ps1</span>\n<span class=\"s2\">del : パス 'C:\\Users\\井上亜星\\lean-by-example\\elan-init.ps1' が存在しないため検出できません。</span>\n<span class=\"s2\">発生場所 行:1 文字:1</span>\n<span class=\"s2\">+ del .\\elan-init.ps1</span>\n<span class=\"s2\">+ ~~~~~~~~~~~~~~~~~~~</span>\n<span class=\"s2\">    + CategoryInfo          : ObjectNotFound: (C:\\Users\\井上亜星\\l...e\\elan-init.ps1:String) [Remove-Item], ItemNotFoundException</span>\n<span class=\"s2\">    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.RemoveItemCommand</span>\n\n<span class=\"s2\">PS C:\\Users\\井上亜星\\lean-by-example&gt; if ($rc -ne 0) {</span>\n<span class=\"s2\">&gt;&gt;     Read-Host -Prompt \"</span><span class=\"n\">Press</span> <span class=\"n\">ENTER</span> <span class=\"n\">to</span> <span class=\"k\">continue</span><span class=\"s2\">\"</span>\n<span class=\"s2\">&gt;&gt; }</span>\n<span class=\"s2\">&gt;&gt; exit</span>\n</code></pre></div>",
        "id": 459975608,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723430660
    },
    {
        "content": "<p>my PC broken...? I cannot reisntall elan.</p>",
        "id": 459979084,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723431906
    },
    {
        "content": "<p>help me please... </p>\n<p>I cannot develop Lean repos locally now...</p>",
        "id": 460088726,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723471235
    },
    {
        "content": "<p>My powershell is.. near nonexistent -- do you have access to gitbash/etc.? to be able to run the \"normal\" shell script? Perhaps you'll have more luck with that?</p>",
        "id": 460095422,
        "sender_full_name": "Julian Berman",
        "timestamp": 1723473361
    },
    {
        "content": "<p>run on git bash </p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>井上亜星@LAPTOP-D4PFQO86<span class=\"w\"> </span>MINGW64<span class=\"w\"> </span>~\n$<span class=\"w\"> </span><span class=\"nb\">cd</span><span class=\"w\"> </span>lean-by-example/\n\n井上亜星@LAPTOP-D4PFQO86<span class=\"w\"> </span>MINGW64<span class=\"w\"> </span>~/lean-by-example<span class=\"w\"> </span><span class=\"o\">(</span>main<span class=\"o\">)</span>\n$<span class=\"w\"> </span>lake<span class=\"w\"> </span>build\nerror:<span class=\"w\"> </span>could<span class=\"w\"> </span>not<span class=\"w\"> </span>detect<span class=\"w\"> </span>the<span class=\"w\"> </span>configuration<span class=\"w\"> </span>of<span class=\"w\"> </span>the<span class=\"w\"> </span>Lake<span class=\"w\"> </span>installation\n</code></pre></div>",
        "id": 460117220,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723480031
    },
    {
        "content": "<p>The suggestion was to run the elan installed script under gitbash</p>",
        "id": 461993536,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723513239
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> <span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span> </p>\n<blockquote>\n<p>do you have access to gitbash/etc.?</p>\n</blockquote>\n<p>Elan re-installation via gitbush works. but <code>lake build</code> command still raises an error.</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>井上亜星@LAPTOP-D4PFQO86<span class=\"w\"> </span>MINGW64<span class=\"w\"> </span>~/lean-by-example<span class=\"w\"> </span><span class=\"o\">(</span>main<span class=\"o\">)</span>\n$<span class=\"w\"> </span>lake<span class=\"w\"> </span>build\nerror:<span class=\"w\"> </span>could<span class=\"w\"> </span>not<span class=\"w\"> </span>detect<span class=\"w\"> </span>the<span class=\"w\"> </span>configuration<span class=\"w\"> </span>of<span class=\"w\"> </span>the<span class=\"w\"> </span>Lake<span class=\"w\"> </span>installation\n</code></pre></div>\n<p>My attempt:</p>\n<ol>\n<li>remove <code>~/.elan</code> directory</li>\n<li>install elan</li>\n<li>run <code>lake build</code> on lean-by-example</li>\n</ol>",
        "id": 462303807,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723627837
    },
    {
        "content": "<p>Is it the same in a standard Windows shell?</p>",
        "id": 462304130,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1723627975
    },
    {
        "content": "<p>Note: It may be related to the version of Lean or whether it depends on Mathlib.</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>井上亜星@LAPTOP-D4PFQO86<span class=\"w\"> </span>MINGW64<span class=\"w\"> </span>~/concreteSemantics<span class=\"w\"> </span><span class=\"o\">(</span>main<span class=\"o\">)</span>\n$<span class=\"w\"> </span>lake<span class=\"w\"> </span>build\ninfo:<span class=\"w\"> </span>downloading<span class=\"w\"> </span>component<span class=\"w\"> </span><span class=\"s1\">'lean'</span>\n<span class=\"m\">189</span>.8<span class=\"w\"> </span>MiB<span class=\"w\"> </span>/<span class=\"w\"> </span><span class=\"m\">189</span>.8<span class=\"w\"> </span>MiB<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">100</span><span class=\"w\"> </span>%<span class=\"o\">)</span><span class=\"w\">  </span><span class=\"m\">16</span>.8<span class=\"w\"> </span>MiB/s<span class=\"w\"> </span>ETA:<span class=\"w\">   </span><span class=\"m\">0</span><span class=\"w\"> </span>s\ninfo:<span class=\"w\"> </span>installing<span class=\"w\"> </span>component<span class=\"w\"> </span><span class=\"s1\">'lean'</span>\n笞<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"m\">3</span>/4<span class=\"o\">]</span><span class=\"w\"> </span>Built<span class=\"w\"> </span>ConcreteSemantics.Basic\nwarning:<span class=\"w\"> </span>.<span class=\"se\">\\.\\.\\.\\C</span>oncreteSemantics<span class=\"se\">\\B</span>asic.lean:39:8:<span class=\"w\"> </span>declaration<span class=\"w\"> </span>uses<span class=\"w\"> </span><span class=\"s1\">'sorry'</span>\nBuild<span class=\"w\"> </span>completed<span class=\"w\"> </span>successfully.\n\n井上亜星@LAPTOP-D4PFQO86<span class=\"w\"> </span>MINGW64<span class=\"w\"> </span>~/concreteSemantics<span class=\"w\"> </span><span class=\"o\">(</span>main<span class=\"o\">)</span>\n$<span class=\"w\"> </span>cat<span class=\"w\"> </span>lean-toolchain\nleanprover/lean4:v4.9.0\n</code></pre></div>",
        "id": 462304242,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723628028
    },
    {
        "content": "<blockquote>\n<p>Is it the same in a standard Windows shell?</p>\n</blockquote>\n<p>you mean command prompt? It also fails.</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>C:<span class=\"se\">\\U</span>sers<span class=\"se\">\\井</span>上亜星<span class=\"se\">\\l</span>ean-by-example&gt;lake<span class=\"w\"> </span>build\nerror:<span class=\"w\"> </span>could<span class=\"w\"> </span>not<span class=\"w\"> </span>detect<span class=\"w\"> </span>the<span class=\"w\"> </span>configuration<span class=\"w\"> </span>of<span class=\"w\"> </span>the<span class=\"w\"> </span>Lake<span class=\"w\"> </span>installation\n</code></pre></div>",
        "id": 462304399,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723628087
    },
    {
        "content": "<p>I cannot reproduce on latest lean-by-example, which now uses rc2</p>",
        "id": 462305300,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1723628454
    },
    {
        "content": "<p>Yes, CI on Windows also does not reproduce this error… this is deep mistery…</p>",
        "id": 462305422,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1723628504
    },
    {
        "content": "<p>Oh, but my user name is ASCII. That may or may not be the issue.</p>",
        "id": 462305423,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1723628504
    },
    {
        "content": "<p>Could you check if <code>leanprover/lean4-pr-releases:pr-release-4860</code> still has this issue? Creating a new empty project and trying to build it should be sufficient</p>",
        "id": 462306509,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1723628887
    },
    {
        "content": "<p>A student had the same problem on <code>v4.10.0</code> and <code>v4.11.0</code>. It was fine on <code>v4.8.0-rc2</code>. The error disappeared after switching to an ASCII user name.</p>",
        "id": 465363112,
        "sender_full_name": "Yuyang Zhao",
        "timestamp": 1724746063
    },
    {
        "content": "<p>I guess this also reproduces for a non-ascii folder name in an ascii user account?</p>",
        "id": 465365132,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1724746749
    }
]