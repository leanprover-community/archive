[
    {
        "content": "<p>I am working on interfacing with the language server and have a question about leanSorryLike:</p>\n<p>Requesting \"textDocument/semanticTokens/full\" from the following single line file:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">add_zero_custom</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>I get the following tokens:<br>\n[[0, 0, 7, 'keyword', []],<br>\n [0, 25, 1, 'variable', []],<br>\n [0, 36, 1, 'variable', []],<br>\n [0, 44, 1, 'variable', []]]</p>\n<p>However, using \"by sorry\" detects a leanSorryLike token:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">add_zero_custom</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>[[0, 0, 7, 'keyword', []],<br>\n [0, 25, 1, 'variable', []],<br>\n [0, 36, 1, 'variable', []],<br>\n [0, 44, 1, 'variable', []],<br>\n [0, 49, 2, 'keyword', []],<br>\n [0, 52, 5, 'leanSorryLike', []]]</p>\n<p>Is this expected behavior?<br>\nIn mathlib 4.14 there are 58 occurences of \":= sorry\" vs 12 \":= by sorry\".</p>\n<p>UPDATE: It seems the difference is between <code>sorry</code> as:</p>\n<ul>\n<li>Lean.ParserTerm.sorry</li>\n<li><code>sorry</code> used in a tactic block opened by <code>by</code></li>\n</ul>\n<p>The former is excluded from Syntax Hightlighting at<br>\n<a href=\"https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Server/FileWorker/RequestHandling.lean#L430\">https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Server/FileWorker/RequestHandling.lean#L430</a></p>\n<p>However, it would still be nice to have both reported as leanSorryLike, since they seem to be used interchangeably.</p>",
        "id": 490379247,
        "sender_full_name": "Oliver Dressler",
        "timestamp": 1734864920
    }
]