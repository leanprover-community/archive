[
    {
        "content": "<p>So I have posted twice about namespace and open and dot notation:</p>\n<ul>\n<li><a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/dot.20notation.20and.20open/with/535161446\">#lean4 &gt; dot notation and open</a> </li>\n<li><a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/open.20is.20confused/with/528814423\">#lean4 &gt; open is confused</a></li>\n</ul>\n<p>I have found another inconsistency with scoped notations:<br>\nWhen you start a declaration with say <code>Foo.</code>, then all the identifier resolution afterwards behaves as if the namespace <code>Foo</code> is opened. However, the same is not true for scoped notations.</p>\n<p>Why this is an inconsistency: both <code>namespace Foo</code> and <code>open Foo</code> automatically open the scoped notation as well, so I don't see why this feature-bug where starting a declaration with <code>Foo.</code> gives you access to the namespace shouldn't also behave like <code>namespace Foo</code> and <code>open Foo</code>.</p>\n<p>(actually, is there a way to <code>open Foo</code> without opening the scoped notations?)</p>",
        "id": 543118632,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759614286
    },
    {
        "content": "<p>Test:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Foo</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">37</span>\n<span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"s2\">\"%123\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">bar</span>\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Foo</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"bp\">.</span><span class=\"n\">bar_eq_37</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">37</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"bp\">.</span><span class=\"n\">percent_123_eq_37</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"mi\">123</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">37</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"c1\">-- %123 not valid</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Foo</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">percent_123_eq_37'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"mi\">123</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">37</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Foo</span>\n</code></pre></div>",
        "id": 543118633,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1759614287
    },
    {
        "content": "<p>Is that maybe because name resolution happens during elaboration, but scoped syntax during parsing?</p>",
        "id": 543163639,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1759671708
    }
]