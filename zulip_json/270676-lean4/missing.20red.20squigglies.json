[
    {
        "content": "<p>In the below code (which contains an error)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"kn\">protected</span><span class=\"w\"> </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span>\n<span class=\"w\">  </span><span class=\"kn\">protected</span><span class=\"w\"> </span><span class=\"n\">invFun</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span>\n\n<span class=\"kn\">infixl</span><span class=\"o\">:</span><span class=\"mi\">25</span><span class=\"w\"> </span><span class=\"s2\">\" ≃ \"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Equiv</span>\n\n<span class=\"kn\">protected</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">≃</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">≃</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">invFun</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">toFun</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">apply_symm_apply</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">≃</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">invFun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">apply_symm_apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">≃</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">   </span><span class=\"c1\">-- put cursor directly after `a` and there's no red squiggle??</span>\n<span class=\"w\">  </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">apply_symm_apply</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>if I put my cursor on the sorry on the last line and then move it left so that it wraps up to just after the <code>a</code> (the character which the error is on) then the red squiggly under the <code>a</code> disappears! The file hence looks error-free. Is this expected? I can see this happening on VS Code but not on the web editor.</p>\n<p>Hmm, actually when the red squiggle disappears, what appears is (in grey) \"<code>Ctrl-I to continue with Copilot</code>\" (which I have switched off right now).</p>\n<p>(I'm sure this can be minimised more but I've got as far as removing mathlib so hopefully this is enough .)</p>",
        "id": 494652223,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737301343
    },
    {
        "content": "<p>I get the red squiggle with the same cursor placement that you describe.</p>",
        "id": 494776352,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1737369934
    },
    {
        "content": "<p>I get an <code>unknown identifier 'asorry'</code> diagnostic when trying your reproduction.</p>",
        "id": 494777219,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1737370180
    },
    {
        "content": "<p>Clarification: I'm not deleting the whitespace, I'm just moving the cursor</p>",
        "id": 494788279,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737373376
    },
    {
        "content": "<p>So the squiggly disappears without making a change to the document?</p>",
        "id": 494794257,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1737375116
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/tQfT2H7K0SG_URqkEijHHdka/Peek-2025-01-20-14-27.gif\">Peek 2025-01-20 14-27.gif</a></p>\n<p>Is this copilot? I don't know how to turn it off!</p>",
        "id": 494824488,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737383305
    },
    {
        "content": "<p>Did you install the GitHub Copilot extension?</p>",
        "id": 494824845,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1737383400
    },
    {
        "content": "<p>I had it disabled but it needed a VS Code restart. Yeah it's copilot. Sorry for the noise. Aren't other people experiencing this?</p>",
        "id": 494825229,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737383487
    },
    {
        "content": "<p>I had copilot switched off (you can see bottom right it's turned off) and then I went for \"disable extension\" and it prompted me to click \"restart\" and the problem was still occurring, which made me think it wasn't the copilot extension and was something else, but killing and restarting VS Code makes it go away.</p>",
        "id": 494825626,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737383589
    },
    {
        "content": "<blockquote>\n<p>I had it disabled but it needed a VS Code restart</p>\n</blockquote>\n<p>VS Code extensions need to clean up after themselves for the current session when they are deactivated or uninstalled, and I assume the GitHub Copilot extension just isn't doing this correctly.</p>",
        "id": 494828559,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1737384292
    },
    {
        "content": "<p>Should I open an issue on the copilot repo?</p>",
        "id": 494836361,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737386318
    },
    {
        "content": "<p>The extension appears to be proprietary, so there is no repo. This is the closest alternative: <a href=\"https://github.com/community/community/discussions/categories/copilot\">https://github.com/community/community/discussions/categories/copilot</a></p>\n<p>If you want them to look at it, it's probably best to figure out if someone else already reported the issue and then if it hasn't been reported, reproduce it with a mainstream programming language like Python or TypeScript that Microsoft cares about.</p>",
        "id": 494837439,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1737386615
    },
    {
        "content": "<p>OK that is beyond my abilities unfortunately because Lean is the only language I know :-(</p>",
        "id": 494837997,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1737386742
    }
]