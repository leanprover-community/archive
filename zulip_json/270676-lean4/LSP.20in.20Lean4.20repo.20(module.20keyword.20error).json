[
    {
        "content": "<p>Hi all,</p>\n<p>I'm having trouble enabling the LSP server for files in the Lean 4 repository. I changed the <code>lean-toolchain</code> file to use <code>leanprover/lean4-nightly</code>, but <code>lake serve</code> reports </p>\n<div class=\"codehilite\" data-code-language=\"txt\"><pre><span></span><code>warning: package configuration has errors, falling back to plain `lean --server`\n</code></pre></div>\n<p>and then every file has the error</p>\n<div class=\"codehilite\" data-code-language=\"Markdown\"><pre><span></span><code>error   Lean 4: <span class=\"sb\">`module`</span> keyword is experimental and not enabled here\n</code></pre></div>",
        "id": 540094743,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1758139723
    },
    {
        "content": "<p>should I manually create a lakefile? or somehow pass <code>experimental.module=true</code> to <code>lean --server</code> directly? how is development in the repo supposed to work?</p>",
        "id": 540095443,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1758139993
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>lean<span class=\"w\"> </span>-D<span class=\"w\"> </span>experimental.module<span class=\"o\">=</span><span class=\"nb\">true</span><span class=\"w\"> </span>--server\n</code></pre></div>\n<p>works! Is it the right way?</p>",
        "id": 540096980,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1758140587
    },
    {
        "content": "<p>I assume you are working with Emacs? This just works in both neovim and vscode so I would suggest to figure out how they implement this part.</p>",
        "id": 540098765,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1758141365
    },
    {
        "content": "<p>I see, I'm using \"plain\" eglot in emacs with a major-mode I am writing. Perhaps I should look how vscode special-case this</p>",
        "id": 540101475,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1758142575
    },
    {
        "content": "<p>because the original content of <code>lean-toolchain</code> is <code>lean4</code>, which makes <code>lean --serve</code> report</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">release</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">lean4'</span>\n</code></pre></div>",
        "id": 540102021,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1758142796
    },
    {
        "content": "<p>Have you set up your <code>elan</code> in accordance with the development guide?</p>",
        "id": 540102085,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1758142824
    },
    {
        "content": "<p>thanks, I had not seen it before :) perhaps it deserves a mention in <code>CONTRIBUTING.md</code></p>",
        "id": 540102332,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1758142922
    },
    {
        "content": "<p>oops, it is mentioned in contributing.md <span aria-label=\"face with peeking eye\" class=\"emoji emoji-1fae3\" role=\"img\" title=\"face with peeking eye\">:face_with_peeking_eye:</span></p>",
        "id": 540102432,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1758142961
    },
    {
        "content": "<p>Sorry about that, the elan setup makes <code>lake serve</code> work perfectly!! Thanks <span class=\"user-mention\" data-user-id=\"395550\">@Henrik Böving</span>!</p>",
        "id": 540107100,
        "sender_full_name": "Lua Viana Reis",
        "timestamp": 1758145393
    }
]