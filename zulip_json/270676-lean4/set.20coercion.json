[
    {
        "content": "<p>Can I define a coercion or something so that this works?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">carrier</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"n\">prop</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">univ</span><span class=\"w\"> </span><span class=\"c1\">-- fails</span>\n</code></pre></div>\n<p>I want <code>foo ⊆ S</code> to be interpreted as <code>foo.carrier ⊆ S</code> whenever <code>S : Set α</code>.</p>",
        "id": 486134940,
        "sender_full_name": "Nir Paz",
        "timestamp": 1733330229
    },
    {
        "content": "<p>Actually I would like <code>#foo</code> and similar things to also work, so lean should always tries to interpret <code>foo</code> as <code>foo.carrier</code>. I assume things like this exist in mathlib but I can't think of an example to check.</p>",
        "id": 486137469,
        "sender_full_name": "Nir Paz",
        "timestamp": 1733331014
    },
    {
        "content": "<p>The problem here is that <code>a ⊆ b</code> is just a notation for <code>Subset a b</code> which expects instance of <code>HasSubset</code> for the type of <code>a</code> and <code>b</code>, and this isn't connected to <code>Set</code>.</p>",
        "id": 486137519,
        "sender_full_name": "Vasilii Nesterov",
        "timestamp": 1733331028
    },
    {
        "content": "<p>Looks like <code>#S</code> typechecks when <code>S : UpperSet α</code> (which is a carrier and a property), so I'll see what's done there.</p>",
        "id": 486138452,
        "sender_full_name": "Nir Paz",
        "timestamp": 1733331343
    },
    {
        "content": "<p>Although subsets don't work, so I will add a <code>HasSubset</code> instance manually.</p>",
        "id": 486138612,
        "sender_full_name": "Nir Paz",
        "timestamp": 1733331383
    },
    {
        "content": "<p>It must be <code>SetLike</code>, I'll take a look at it later.</p>",
        "id": 486139096,
        "sender_full_name": "Nir Paz",
        "timestamp": 1733331528
    },
    {
        "content": "<p>Yes, you want to write a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SetLike#doc\">docs#SetLike</a> instance for <code>Foo</code>.</p>",
        "id": 486139223,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1733331568
    }
]