[
    {
        "content": "<p>There are a lot of problems with these, mostly due to what is now archaic design (which made sense at the time!). I would like to collect those problems and potential solutions here so that we can propose a general solution that would work for Lean core, with a hopefully small enough amount of effort on their end.</p>",
        "id": 479015217,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1729912282
    },
    {
        "content": "<p>To get started: </p>\n<ul>\n<li>I don't think <code>Setoid</code> needs to be a class.</li>\n<li>It should extend <code>Equivalence</code> so that <code>refl</code>, <code>symm</code> and <code>trans</code> fields are directly accessible.</li>\n</ul>",
        "id": 479015571,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1729912523
    },
    {
        "content": "<p>I think <span class=\"user-mention\" data-user-id=\"455791\">@Yuyang Zhao</span></p>",
        "id": 479042256,
        "sender_full_name": "Yongle Hu",
        "timestamp": 1729940659
    },
    {
        "content": "<p>I don't see how extending Equivalence could work</p>",
        "id": 479044033,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1729942511
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">structure</span><span class=\"w\"> </span><span class=\"n\">Rel</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">where</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"kd\">structure</span><span class=\"w\"> </span><span class=\"n\">Setoid</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kd\">extends</span><span class=\"w\"> </span><span class=\"n\">Rel</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Equivalence</span><span class=\"w\"> </span><span class=\"n\">toRel.r</span>\n</code></pre></div>",
        "id": 479049040,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1729947440
    },
    {
        "content": "<p>Replacing <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Rel#doc\">docs#Rel</a> I guess</p>",
        "id": 479049943,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1729948307
    },
    {
        "content": "<p>That would cause friction on the <code>Rel</code> side though.<br>\nWhy not just define <code>lemma Setoid.refl (r) := r.is_equiv.refl</code> etc?</p>",
        "id": 479056579,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1729954903
    },
    {
        "content": "<p>Right, better not replace <code>Rel</code> then.</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kd\">structure</span><span class=\"w\"> </span><span class=\"n\">Setoid.Rel</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">where</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"kd\">structure</span><span class=\"w\"> </span><span class=\"n\">Setoid</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kd\">extends</span><span class=\"w\"> </span><span class=\"n\">Setoid.Rel</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Equivalence</span><span class=\"w\"> </span><span class=\"n\">toRel.r</span>\n</code></pre></div>\n<p>The main point is to have a nice construction syntax:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Setoid</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 479059475,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1729957536
    },
    {
        "content": "<p><code>is_eqv.refl := sorry</code> isn't much worse</p>",
        "id": 479089373,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1729988752
    },
    {
        "content": "<p>I don't understand.</p>",
        "id": 479092439,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1729992283
    },
    {
        "content": "<p>Ah! Do you mean this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Setoid</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">iseqv.refl</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">iseqv.symm</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">iseqv.trans</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 479093059,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1729992999
    },
    {
        "content": "<p>Surely <code>Setoid.iseqv</code>needs to be corrected.</p>",
        "id": 479093186,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1729993192
    },
    {
        "content": "<p>I agree that <code>iseqv</code> doesn't match <a href=\"https://leanprover-community.github.io/contribute/naming.html\">#naming</a></p>",
        "id": 479120780,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1730023058
    }
]