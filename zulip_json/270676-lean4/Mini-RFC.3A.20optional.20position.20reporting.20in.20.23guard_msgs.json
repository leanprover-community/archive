[
    {
        "content": "<p>I'm writing a <del>draft</del> PR (<a href=\"https://github.com/leanprover/lean4/pull/10125\">lean4#10125</a>) to allow position reporting in <code>#guard_msgs</code>. This has come up before, e.g. <a href=\"#narrow/channel/270676-lean4/topic/Propagating.20errors.20through.20Unhygienic.2Erun\">here</a>, and would recently be useful in <a href=\"https://github.com/leanprover-community/mathlib4/pull/28919\">#28919</a> (fixing an issue where messages were being reported on the wrong range).</p>\n<p>Currently it's intended to be activated with <code>#guard_msgs (positions := true)</code>, and to produce output formatted as</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/--</span>\n<span class=\"sd\">@ +3:7...+3:11</span>\n<span class=\"sd\">info: foo</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">positions</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"bp\">...</span>\n</code></pre></div>\n<p>The line is relative to the line of the <code>#guard_msgs</code> token, which allows us to insert text above and below a position-sensitive test without breaking it. (The column, however, is absolute, which I think is fair.)</p>\n<p>I'm pretty happy with this notation for the range: it's easy to pick up and distinguish visually due to the initial <code>@</code> and spacing; it's relatively uncluttered; the <code>+</code> gestures at the fact that the line is relative; and the <code>...</code> is vaguely consonant with the new <code>PRange</code> syntax. However, there are other possibilities, e.g.</p>\n<ul>\n<li>no <code>@</code></li>\n<li>brackets, e.g. <code>{+3:7...+3:11}</code></li>\n<li>parentheses around the line to group with <code>+</code>, e.g. <code>(+3):7</code></li>\n<li>no <code>+</code></li>\n<li>different range syntax, e.g. <code>+3:7::+3:11</code> or <code>(+3:7)-(+3:11)</code></li>\n</ul>\n<p>Do we think that this is reasonable and useful in general? If so, should any of the terminology or formatting be tweaked?</p>",
        "id": 536146654,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1756178907
    },
    {
        "content": "<p>There's a short accepted RFC about this: <a href=\"https://github.com/leanprover/lean4/pull/8265\">lean4#8265</a></p>\n<p>(pinging <span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span>)</p>",
        "id": 536149523,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1756180995
    },
    {
        "content": "<p>Oh, thank you for finding that! (I searched, but missed it.)</p>",
        "id": 536149688,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1756181162
    },
    {
        "content": "<p>In that case, with the main build green, I'll allow discussion to happen on the PR and put it out for review. :)</p>",
        "id": 536151032,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1756182296
    }
]