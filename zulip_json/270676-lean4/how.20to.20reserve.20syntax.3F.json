[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"n\">small_spec</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">num</span>\n<span class=\"n\">declare_syntax_cat</span><span class=\"w\"> </span><span class=\"n\">step_group</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"small \"</span><span class=\"w\"> </span><span class=\"n\">small_spec</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">step_group</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">step_group</span><span class=\"bp\">|</span><span class=\"n\">small</span><span class=\"w\"> </span><span class=\"mi\">37</span><span class=\"o\">)</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">small</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">37</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">small</span>\n</code></pre></div>\n<p>I'm trying to define a custom syntax called \"step_group\", which for now contains things like <code>small 37</code>. The problem I'm facing is that after declaring it, somehow I can't use <code>small</code> anymore as an identifier even though the context has nothing to do with <code>step_group</code>; and if I make it non-reserved by putting <code>&amp;\"small\"</code> in the syntax declaration, then suddenly it is not recognised as a correct syntax anymore.</p>",
        "id": 545333026,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1760622978
    },
    {
        "content": "<p>Try <code>declare_syntax_cat step_group (behavior := symbol)</code> maybe?</p>",
        "id": 545374972,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760629114
    },
    {
        "content": "<p>I remember reading a docstring or something that was about how this works</p>",
        "id": 545375113,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760629133
    },
    {
        "content": "<p>ah yes <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Parser.LeadingIdentBehavior#doc\">docs#Lean.Parser.LeadingIdentBehavior</a> docstring might have something to say</p>",
        "id": 545376544,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760629373
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/270676-lean4/topic/how.20to.20reserve.20syntax.3F/near/545374972\">said</a>:</p>\n<blockquote>\n<p>Try <code>declare_syntax_cat step_group (behavior := symbol)</code> maybe?</p>\n</blockquote>\n<p>Unfortunately nothing in that line has useful hover information, so it's not easy to jump to its definition. But the language reference does have a section discussing this as well:<br>\n<a href=\"https://lean-lang.org/doc/reference/latest/Notations-and-Macros/Defining-New-Syntax/?terms=declare_syntax_cat#syntax-categories\">https://lean-lang.org/doc/reference/latest/Notations-and-Macros/Defining-New-Syntax/?terms=declare_syntax_cat#syntax-categories</a></p>",
        "id": 545376869,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1760629426
    },
    {
        "content": "<p>that's weird did they get rid of the hover information or was there none to begin with</p>",
        "id": 545377179,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760629477
    },
    {
        "content": "<p>I expect it's a special syntax whose elaborator just doesn't put hover information over its syntax (probably because it was forgotten to add it).</p>",
        "id": 545378819,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1760629712
    }
]