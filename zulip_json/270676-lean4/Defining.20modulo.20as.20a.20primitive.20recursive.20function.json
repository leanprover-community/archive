[
    {
        "content": "<p>I'm trying to use lean to define primitive recursive functions as an inductive type. But I faced some problem when trying to define modulo after several check.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_⟩</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">i</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">lt_of_succ_lt_succ</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">tail</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">i</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">succ_lt_succ</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">recr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">)</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">gs</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gs</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">recr</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">xs'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">tail</span><span class=\"w\"> </span><span class=\"n\">xs</span>\n<span class=\"w\">    </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">rec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">xs'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">xs'</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"o\">)</span>\n\n<span class=\"c\">/-</span>\n<span class=\"cm\"> - pred(0) = 0</span>\n<span class=\"cm\"> - pred(x') = x</span>\n<span class=\"cm\"> -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">pred</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">recr</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n\n<span class=\"c\">/-</span>\n<span class=\"cm\"> - sub'(0, y) = y</span>\n<span class=\"cm\"> - sub'(x', y) = pred(sub'(x, y))</span>\n<span class=\"cm\"> -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">sub</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">sub'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">recr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">pred</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">]))</span>\n<span class=\"w\">  </span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">sub'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">])</span>\n\n<span class=\"c\">/-</span>\n<span class=\"cm\"> - mod(0, y) = 0</span>\n<span class=\"cm\"> - mod(x', y) = sub(mod(x, y)', y)</span>\n<span class=\"cm\"> -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">mod</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">recr</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">]),</span><span class=\"w\"> </span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">]))</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">mod</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">8</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"c1\">-- Gives wrong result 0</span>\n</code></pre></div>\n<p>I don't know where I got wrong. The pred and sub functions defined above seem to yield correct result always. Can somebody help check?</p>",
        "id": 536464741,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756314587
    },
    {
        "content": "<p>I have also defined a bunch of other primitive recursive functions and all seem to give correct result:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">foldl</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">acc</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">acc</span><span class=\"o\">]))</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span>\n\n<span class=\"c\">/-</span>\n<span class=\"cm\"> - add(0, y) = y</span>\n<span class=\"cm\"> - add(x', y) = add(x, y)'</span>\n<span class=\"cm\"> -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">recr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">]))</span>\n\n<span class=\"c\">/-</span>\n<span class=\"cm\"> - mul(0, y) = 0</span>\n<span class=\"cm\"> - mul(x', y) = add(y, mul(x, y))</span>\n<span class=\"cm\"> -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">recr</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">]))</span>\n\n<span class=\"c\">/-</span>\n<span class=\"cm\"> - pow'(0, y) = 1</span>\n<span class=\"cm\"> - pow'(x', y) = mul(y, pow'(x, y))</span>\n<span class=\"cm\"> -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">pow</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">pow'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">recr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">]))</span>\n<span class=\"w\">  </span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">pow'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">])</span>\n</code></pre></div>",
        "id": 536465798,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756314990
    },
    {
        "content": "<p>Also any suggestion on simplifying the code would be great!</p>",
        "id": 536466654,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756315352
    },
    {
        "content": "<p>I see you have written</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c\">/-</span>\n<span class=\"cm\"> - mod(0, y) = 0</span>\n<span class=\"cm\"> - mod(x', y) = sub(mod(x, y)', y)</span>\n<span class=\"cm\"> -/</span>\n</code></pre></div>\n<p>Then</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">mod</span><span class=\"o\">(</span><span class=\"mi\">8</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">mod</span><span class=\"o\">(</span><span class=\"mi\">7</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">mod</span><span class=\"o\">(</span><span class=\"mi\">6</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">mod</span><span class=\"o\">(</span><span class=\"mi\">5</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">mod</span><span class=\"o\">(</span><span class=\"mi\">4</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">mod</span><span class=\"o\">(</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">mod</span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">mod</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">mod</span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">'</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n</code></pre></div>",
        "id": 536467178,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1756315574
    },
    {
        "content": "<p>perhaps you actually want <code>mod(x, y) = if x &lt; y then 0 else mod(sub(x,y),y)'</code></p>",
        "id": 536467296,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1756315616
    },
    {
        "content": "<p>I guess you'll have to special-case mod zero</p>",
        "id": 536467853,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1756315853
    },
    {
        "content": "<p>Ooops, thanks! Is there a way to let lean expand what you have done? Or did you do it manually?</p>",
        "id": 536469303,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756316423
    },
    {
        "content": "<p>Ok I got this fixed, thanks <span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c\">/-</span>\n<span class=\"cm\"> - sgn(0) = 0</span>\n<span class=\"cm\"> - sgn(x') = 1</span>\n<span class=\"cm\"> -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">sgn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">recr</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n\n<span class=\"c\">/-</span>\n<span class=\"cm\"> - sgn(0) = 1</span>\n<span class=\"cm\"> - sgn(x') = 0</span>\n<span class=\"cm\"> -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">sgn'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">recr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">zero</span>\n\n<span class=\"c\">/-</span>\n<span class=\"cm\"> - cond(c, x, y) = sgn(c) * x + sgn'(c) * y</span>\n<span class=\"cm\"> -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">cond</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">sgn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">]),</span><span class=\"w\"> </span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">]),</span>\n<span class=\"w\">                      </span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">sgn'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">]),</span><span class=\"w\"> </span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">])])</span>\n\n<span class=\"c\">/-</span>\n<span class=\"cm\"> - eq(x, y) = sgn'((x - y) + (y - x))</span>\n<span class=\"cm\"> -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">sgn'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">]),</span>\n<span class=\"w\">                                           </span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">sub</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">])])])</span>\n\n<span class=\"c\">/-</span>\n<span class=\"cm\"> - mod(0, y) = 0</span>\n<span class=\"cm\"> - mod(x', y) = if mod(x, y)' = y then 0 else mod(x, y)'</span>\n<span class=\"cm\"> -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"bp\">.</span><span class=\"n\">mod</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">r'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">])</span>\n<span class=\"w\">  </span><span class=\"n\">recr</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">cond</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">list</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">r'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">]),</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r'</span><span class=\"o\">]))</span>\n</code></pre></div>",
        "id": 536473607,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756318066
    },
    {
        "content": "<p>Any idea how to simplify the code? Ideally I'd like to get rid of the (Fin.list [...]) part <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 536474359,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756318394
    },
    {
        "content": "<p>Well mathlib provides a <code>![a, b, c]</code> notation for fin-vectors</p>",
        "id": 536475074,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1756318685
    },
    {
        "content": "<p>it expands to <code>Matrix.vecCons a (Matrix.vecCons b (Matrix.vecCons c Matrix.vecEmpty))</code></p>",
        "id": 536475272,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1756318765
    },
    {
        "content": "<p>That's great! Thanks for the tip!</p>",
        "id": 536478277,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756320028
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"352122\">@Rui Liu</span> are you aware of <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Computability/Primrec.html#Nat.Primrec\">Nat.Primrec</a>? I assume you're building this from scratch on purpose but just figured I would mention it</p>",
        "id": 536485341,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756323081
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"380294\">@Matt Diamond</span> I'm not aware of that <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span> , that said, it's for my own learning so it would still be interested to build that myself. Thanks for mentioning!</p>",
        "id": 536486860,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756323847
    },
    {
        "content": "<p>It's a bit different from what I built though. I build a N^k -&gt; N prim recursive function, also the library one is defined as N -&gt; N -&gt; Prop, not sure whether that's handy to use when there's no type for the N -&gt; N part...?</p>",
        "id": 536487324,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756324070
    },
    {
        "content": "<p>There is a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.Primrec%27#doc\">docs#Nat.Primrec'</a> for N^k to N. Though the biggest difference is that <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.Primrec#doc\">docs#Nat.Primrec</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.Primrec%27#doc\">docs#Nat.Primrec'</a> are Prop, not Type...</p>",
        "id": 536493866,
        "sender_full_name": "Dexin Zhang",
        "timestamp": 1756327514
    },
    {
        "content": "<p>Curious is there a library definition of a general recursive function?</p>",
        "id": 536495998,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756328685
    },
    {
        "content": "<p>sure... <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.Partrec#doc\">docs#Nat.Partrec</a></p>",
        "id": 536496204,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756328799
    },
    {
        "content": "<p>there's also <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Computable#doc\">docs#Computable</a> for computable functions</p>",
        "id": 536496342,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756328860
    },
    {
        "content": "<p>also note that there's <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Primrec#doc\">docs#Primrec</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Partrec#doc\">docs#Partrec</a> which utilize encoding/decoding to model primitive and partial recursive functions of types beyond the natural numbers</p>",
        "id": 536496450,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756328920
    },
    {
        "content": "<p>also take note of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.Partrec.Code#doc\">docs#Nat.Partrec.Code</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.Partrec.Code.eval#doc\">docs#Nat.Partrec.Code.eval</a> ... there's a lot of good stuff in the Computability library <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 536496996,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756329196
    },
    {
        "content": "<p>With Nat.Primrec definition, how do you get the actual zero / succ / proj functions?</p>",
        "id": 536497008,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756329203
    },
    {
        "content": "<p>I mean getting the function itself, instead of just the proof of the function being prim recursive ...?</p>",
        "id": 536497244,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756329317
    },
    {
        "content": "<p>as <span class=\"user-mention\" data-user-id=\"734814\">@Dexin Zhang</span> mentioned, these are <code>Prop</code>-valued, which means the function is distinct from the proof that it's primitive recursive... so in a proof you'll have a function <code>f : ℕ → ℕ</code> along with <code>hf : Nat.Primrec f</code></p>",
        "id": 536497387,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756329394
    },
    {
        "content": "<p><code>Nat.Partrec.Code</code> and <code>Nat.Partrec.Code.eval</code> are closer to the way you've defined things, but that's for partial recursive functions</p>",
        "id": 536497674,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756329543
    },
    {
        "content": "<p>So I guess the inductive type as defined doesn't give you the function? I will need to define my own separate zero function, then prove it's primitive recursive?</p>",
        "id": 536497707,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756329565
    },
    {
        "content": "<p>Hmm.... this doesn't seem to work...? Is this something closer to what it should do?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"c1\">-- fail to type check?</span>\n</code></pre></div>",
        "id": 536497820,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756329644
    },
    {
        "content": "<p>in your case, the statement would be:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"bp\">.</span><span class=\"n\">zero</span>\n</code></pre></div>",
        "id": 536498037,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756329787
    },
    {
        "content": "<p>it's a proof that <code>zero</code> is <code>PrimRec</code>, using your inductive type</p>",
        "id": 536498093,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756329828
    },
    {
        "content": "<p>Thanks, would it be possible to have something that build the function up and the proof of the function being prim recursive at the same time? It's like two strands of things at the same time....?</p>",
        "id": 536498397,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756330002
    },
    {
        "content": "<p>do you mean your original approach with codes and <code>eval</code>? or something different?</p>",
        "id": 536498562,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756330081
    },
    {
        "content": "<p>Something different... the <code>eval</code> approach has the drawback that you need to call that to get the function, ...and you don't have the proof object as a nice Prop. Ideally the function is just a plain lambda, and we get a separate proof object. However, we should be able to build both at the same time.</p>\n<p>So I'm imagine something like...</p>\n<p>(zero_func, zero_func_proof)<br>\n    |  succ<br>\n(succ_func, succ_func_proof)<br>\n   | ...</p>",
        "id": 536498914,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756330273
    },
    {
        "content": "<p>Maybe a structure?</p>",
        "id": 536498959,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756330289
    },
    {
        "content": "<p>in theory you could do something like this, where Lean figures out the function for you:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Primrec</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">}</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FunLike</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"bp\">⟨</span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">val_injective</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">succFunction</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"bp\">⟨_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Primrec</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"bp\">⟩</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">succFunction</span><span class=\"w\"> </span><span class=\"mi\">10</span>\n</code></pre></div>",
        "id": 536499605,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756330701
    },
    {
        "content": "<p>then you could define a bunch of functions like that for each of the constructors</p>",
        "id": 536499751,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756330771
    },
    {
        "content": "<p>Hmmm.... this is a bit beyond my knowledge, I'm quite new to this tool <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 536499867,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756330859
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">PrimRecFunc</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">    </span><span class=\"n\">func</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"w\">    </span><span class=\"n\">proof</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"n\">func</span>\n</code></pre></div>\n<p>Does something like this makes any sense?</p>",
        "id": 536500033,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756331005
    },
    {
        "content": "<p>yes, though that's similar to a Subtype, which was what I was constructing above (<a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Subtype#doc\">docs#Subtype</a>)</p>",
        "id": 536500107,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756331066
    },
    {
        "content": "<p>I will have a look, thanks!</p>",
        "id": 536500279,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756331181
    },
    {
        "content": "<p>Hmmm... I now have the following definition, but don't know how to define the comp and recr case:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">      </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">→</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gs</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">→</span>\n<span class=\"w\">      </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">gs</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">recr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">      </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">→</span>\n<span class=\"w\">      </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">→</span>\n<span class=\"w\">      </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">        </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">        </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">xs'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">tail</span><span class=\"w\"> </span><span class=\"n\">xs</span>\n<span class=\"w\">        </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">rec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">xs'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">xs'</span><span class=\"o\">)))</span>\n<span class=\"w\">      </span><span class=\"o\">)</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">}</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"bp\">.</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"bp\">.</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨λ</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gs</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">property</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gs</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">property</span><span class=\"o\">)</span><span class=\"bp\">⟩</span><span class=\"w\">  </span><span class=\"c1\">--- Doesn't work</span>\n</code></pre></div>\n<p>Why is that not working?</p>",
        "id": 536510807,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756339139
    },
    {
        "content": "<p>The problem is that you're missing the first two arguments to <code>PrimRec.comp</code> (<code>f</code> and <code>gs</code>). You can either pass them in (underscores will work) or you can make them implicit in the definition, like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">gs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">      </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">→</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gs</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">→</span>\n<span class=\"w\">      </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">gs</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">recr</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">      </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">→</span>\n<span class=\"w\">      </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">→</span>\n<span class=\"w\">      </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">        </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">        </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">xs'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">tail</span><span class=\"w\"> </span><span class=\"n\">xs</span>\n<span class=\"w\">        </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">rec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">xs'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">xs'</span><span class=\"o\">)))</span>\n<span class=\"w\">      </span><span class=\"o\">)</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">}</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"bp\">.</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"bp\">.</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">property</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">gs</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">property</span><span class=\"o\">)</span><span class=\"bp\">⟩</span>\n</code></pre></div>",
        "id": 536520471,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756347391
    },
    {
        "content": "<p>Implicit probably makes the most sense since they're already determined by the arguments that follow</p>",
        "id": 536520535,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756347457
    },
    {
        "content": "<p>that's also how <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.Primrec.comp#doc\">docs#Nat.Primrec.comp</a> is defined, with implicit function arguments</p>",
        "id": 536520631,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756347549
    },
    {
        "content": "<p>I would do the same for <code>recr</code></p>",
        "id": 536520853,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756347776
    },
    {
        "content": "<p>I got it implemented now, thanks! Another quick question, what's the difference between the argument before colon and after colon? For example:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"bp\">.</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"bp\">.</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">⟩</span>\n</code></pre></div>\n<p>Why not write it as:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"bp\">.</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">PrimRecFn</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟨_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"bp\">.</span><span class=\"n\">proj</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">⟩</span>\n</code></pre></div>",
        "id": 536587761,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756381590
    },
    {
        "content": "<p>For example why the inductive type is defined as such?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n</code></pre></div>\n<p>Why not </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- This doesn't work on the succ case, but I'm just curious what difference it makes here.</span>\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">PrimRec</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ℕs</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n</code></pre></div>",
        "id": 536589493,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756382174
    },
    {
        "content": "<p>for inductives the left of the colon is always paramenters (free variable in every constructor) and the right can be indices (constructors can set it to anything)</p>",
        "id": 536592551,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1756383324
    },
    {
        "content": "<p>Ok thanks!</p>",
        "id": 536619826,
        "sender_full_name": "Rui Liu",
        "timestamp": 1756391367
    }
]