[
    {
        "content": "<p>I'm trying to link newer version of Mathlib (4.22.0-rc2) with the Reverse-FFI, but running into \"redefinition\" errors when lake build:</p>\n<div class=\"codehilite\" data-code-language=\"cruis\"><pre><span></span><code>âœ– [6088/13835] Building Mathlib.Computability.TMToPartrec:c.o\ntrace: .&gt; /Users/cruis/.elan/toolchains/leanprover--lean4---v4.22.0-rc2/bin/clang -c -o /Users/cruis/Documents/Lean4SAT/.lake/packages/mathlib/.lake/build/ir/Mathlib/Computability/TMToPartrec.c.o.export /Users/cruis/Documents/Lean4SAT/.lake/packages/mathlib/.lake/build/ir/Mathlib/Computability/TMToPartrec.c -I /Users/cruis/.elan/toolchains/leanprover--lean4---v4.22.0-rc2/include -fstack-clash-protection -fwrapv -fvisibility=hidden -Wno-unused-command-line-argument --sysroot /Users/cruis/.elan/toolchains/leanprover--lean4---v4.22.0-rc2 -nostdinc -isystem /Users/cruis/.elan/toolchains/leanprover--lean4---v4.22.0-rc2/include/clang -O3 -DNDEBUG -DLEAN_EXPORTING\ninfo: stderr:\n/Users/cruis/Documents/Lean4SAT/.lake/packages/mathlib/.lake/build/ir/Mathlib/Computability/TMToPartrec.c:2319:26: error: redefinition of 'l_Turing_PartrecToTM2_Cont_x27___sizeOf__1'\n 2319 | LEAN_EXPORT lean_object* l_Turing_PartrecToTM2_Cont_x27___sizeOf__1(lean_object* x_1) {\n      |                          ^\n/Users/cruis/Documents/Lean4SAT/.lake/packages/mathlib/.lake/build/ir/Mathlib/Computability/TMToPartrec.c:1667:26: note: previous definition is here\n 1667 | LEAN_EXPORT lean_object* l_Turing_PartrecToTM2_Cont_x27___sizeOf__1(lean_object* x_1) {\n      |                          ^\n/Users/cruis/Documents/Lean4SAT/.lake/packages/mathlib/.lake/build/ir/Mathlib/Computability/TMToPartrec.c:2338:21: error: redefinition of '_init_l_Turing_PartrecToTM2_Cont_x27___sizeOf__inst'\n 2338 | static lean_object* _init_l_Turing_PartrecToTM2_Cont_x27___sizeOf__inst() {\n      |                     ^\n/Users/cruis/Documents/Lean4SAT/.lake/packages/mathlib/.lake/build/ir/Mathlib/Computability/TMToPartrec.c:1711:21: note: previous definition is here\n 1711 | static lean_object* _init_l_Turing_PartrecToTM2_Cont_x27___sizeOf__inst() {\n      |                     ^\n/Users/cruis/Documents/Lean4SAT/.lake/packages/mathlib/.lake/build/ir/Mathlib/Computability/TMToPartrec.c:2346:26: error: redefinition of 'l_Turing_PartrecToTM2_K_x27___sizeOf__1'\n 2346 | LEAN_EXPORT lean_object* l_Turing_PartrecToTM2_K_x27___sizeOf__1(uint8_t x_1) {\n      |                          ^\n/Users/cruis/Documents/Lean4SAT/.lake/packages/mathlib/.lake/build/ir/Mathlib/Computability/TMToPartrec.c:1883:26: note: previous definition is here\n 1883 | LEAN_EXPORT lean_object* l_Turing_PartrecToTM2_K_x27___sizeOf__1(uint8_t x_1) {\n      |                          ^\n/Users/cruis/Documents/Lean4SAT/.lake/packages/mathlib/.lake/build/ir/Mathlib/Computability/TMToPartrec.c:2354:26: error: redefinition of 'l_Turing_PartrecToTM2_K_x27___sizeOf__1___boxed'\n 2354 | LEAN_EXPORT lean_object* l_Turing_PartrecToTM2_K_x27___sizeOf__1___boxed(lean_object* x_1) {\n      |                          ^\n/Users/cruis/Documents/Lean4SAT/.lake/packages/mathlib/.lake/build/ir/Mathlib/Computability/TMToPartrec.c:1891:26: note: previous definition is here\n 1891 | LEAN_EXPORT lean_object* l_Turing_PartrecToTM2_K_x27___sizeOf__1___boxed(lean_object* x_1) {\n      |                          ^\n/Users/cruis/Documents/Lean4SAT/.lake/packages/mathlib/.lake/build/ir/Mathlib/Computability/TMToPartrec.c:2372:21: error: redefinition of '_init_l_Turing_PartrecToTM2_K_x27___sizeOf__inst'\n 2372 | static lean_object* _init_l_Turing_PartrecToTM2_K_x27___sizeOf__inst() {\n      |                     ^\n/Users/cruis/Documents/Lean4SAT/.lake/packages/mathlib/.lake/build/ir/Mathlib/Computability/TMToPartrec.c:1909:21: note: previous definition is here\n 1909 | static lean_object* _init_l_Turing_PartrecToTM2_K_x27___sizeOf__inst() {\n      |                     ^\n5 errors generated.\nerror: external command '/Users/cruis/.elan/toolchains/leanprover--lean4---v4.22.0-rc2/bin/clang' exited with code 1\nSome required builds logged failures:\n- Mathlib.Computability.TMToPartrec:c.o\nerror: build failed\n</code></pre></div>\n<p>FYI this is my setting for the lakefile, which works fine for older version of Mathlib (4.16.0) : </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">defaultFacets</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"n\">LeanLib</span><span class=\"bp\">.</span><span class=\"n\">sharedFacet</span><span class=\"o\">]</span>\n<span class=\"n\">moreLinkArgs</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"-L.lake/packages/aesop/.lake/build/lib/\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"-lAesop\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"-L.lake/packages/Cli/.lake/build/lib/\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"-lCli\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"-L.lake/packages/importGraph/.lake/build/lib/\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"-lImportGraph\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"-L.lake/packages/mathlib/.lake/build/lib/\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"-lMathlib\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"-L.lake/packages/proofwidgets/.lake/build/lib/\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"-lProofWidgets\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"-L.lake/packages/Qq/.lake/build/lib/\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"-lQq\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"-L.lake/packages/batteries/.lake/build/lib/\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"-lBatteries\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"-L.lake/packages/LeanSearchClient/.lake/build/lib/\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"-lLeanSearchClient\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"-L.lake/packages/plausible/.lake/build/lib/\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"-lPlausible\"</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">\"-lLake\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"-lLean\"</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>Any suggestion will be greatly appreciated!</p>",
        "id": 528361628,
        "sender_full_name": "Cruise Song",
        "timestamp": 1752247266
    }
]