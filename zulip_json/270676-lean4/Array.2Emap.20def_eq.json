[
    {
        "content": "<p>How come the first is def-eq but the second isn't?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- works</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">([</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">]</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))[</span><span class=\"mi\">1</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"c1\">-- fails</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">]</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))[</span><span class=\"mi\">1</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 473260560,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1727485846
    },
    {
        "content": "<p>(on a somewhat related note, we seem to be missing <a href=\"https://leanprover-community.github.io/mathlib4_docs/Init/Data/Array/Lemmas.html#Array.getElem_map\"><code>Array.getElem_map</code></a> for <code>Batteries.Vector</code>)</p>",
        "id": 473260689,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1727485969
    },
    {
        "content": "<p>Oh I see, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Array.mapM.map#doc\">docs#Array.mapM.map</a> is irreducible</p>",
        "id": 473261390,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1727486454
    },
    {
        "content": "<p>What's the reasoning behind this?</p>",
        "id": 473261401,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1727486460
    },
    {
        "content": "<p>it's because it's defined by well founded recursion, these get automatically marked as irreducible</p>",
        "id": 473272676,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727492564
    },
    {
        "content": "<p>This can be overriden, right? Would it make sense to PR that change?</p>",
        "id": 473274847,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1727493422
    },
    {
        "content": "<p>Works fine on <code>nightly-testing</code>. (In general at the moment, anything to do with <code>Array</code> should be assumed to possibly work differently on nightlies. :-)</p>",
        "id": 473284402,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1727498691
    },
    {
        "content": "<p><code>getElem_map</code> for Batteries.Vector would be nice, though!</p>",
        "id": 473284559,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1727498727
    }
]