[
    {
        "content": "<p>Given that people seem to be struggling with the previously recommended doc-gen setup and converging to the one <a href=\"https://github.com/leanprover-community/mathlib4_docs\">that we've been using to build mathlib for a while</a> I changed the recommended doc-gen default setup: <a href=\"https://github.com/leanprover/doc-gen4?tab=readme-ov-file#usage\">https://github.com/leanprover/doc-gen4?tab=readme-ov-file#usage</a>.</p>\n<p>This is probably of interest to at least <span class=\"user-mention\" data-user-id=\"556875\">@Pietro Monticone</span> for blue prints and potentially <span class=\"user-mention\" data-user-id=\"119741\">@François G. Dorais</span> who is working on something like this in batteries somewhere afaik?</p>",
        "id": 481668387,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731316273
    },
    {
        "content": "<p>Amazing! Will try it out</p>",
        "id": 481670012,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1731316789
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"119741\">@François G. Dorais</span>, when you have a moment would you mind comparing your <a href=\"https://github.com/leanprover-community/batteries/pull/1028\">batteries#1028</a> against Henrik's linked write up above?</p>",
        "id": 481677140,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1731318913
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> They're essentially the same. The only difference I additionally use the build directory \".\" to avoid moving the doc directories before deploying to github pages.</p>",
        "id": 481682722,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1731320510
    },
    {
        "content": "<p>Thank you. I’ll integrate it in LeanProject and LeanBlueprint when I find the time.</p>",
        "id": 481709741,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731328277
    },
    {
        "content": "<p>Working on these draft PRs that needs to be compatible: </p>\n<ul>\n<li>LeanBlueprint: <a href=\"https://github.com/PatrickMassot/leanblueprint/pull/60\">https://github.com/PatrickMassot/leanblueprint/pull/60</a></li>\n<li>LeanProject: <a href=\"https://github.com/pitmonticone/LeanProject/pull/11\">https://github.com/pitmonticone/LeanProject/pull/11</a></li>\n</ul>",
        "id": 481738837,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731336242
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"395550\">@Henrik Böving</span> <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span>  would this <code>docbuild</code> setup imply 10GB per Lean project? </p>\n<p>With two nested projects we are doubling the memory required, right? Am I missing something?</p>",
        "id": 481766341,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731343837
    },
    {
        "content": "<p>We're not doubling anything. The nested project automatically reuses build artifacts from its parent. The only change is that if you actually decide to build the nested project you pull in doc-gen etc and put the docs there. As long as a user doesnt build docs locally this is a noop</p>",
        "id": 481767463,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731344192
    },
    {
        "content": "<p>But it would be a problem for github actions, right?</p>",
        "id": 481767685,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731344265
    },
    {
        "content": "<p>I'm saying this because I tested the new setup on a project, adapted the blueprint workflow accordingly and I got <code>no space left on device</code> indicating that the Docker container does not have sufficient disk space to complete the pull and extraction of the <code>texlive-full</code> image in the \"Build blueprint and copy to <code>home_page/blueprint</code>\" step of the \"Compile Blueprint\" workflow.</p>\n<p><a href=\"/user_uploads/3121/PftO8gRRruFoq4SYj0eXZnlv/Screenshot-2024-11-11-at-17.58.03.png\">image</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/PftO8gRRruFoq4SYj0eXZnlv/Screenshot-2024-11-11-at-17.58.03.png\" title=\"image\"><img data-original-dimensions=\"1234x1578\" src=\"/user_uploads/thumbnail/3121/PftO8gRRruFoq4SYj0eXZnlv/Screenshot-2024-11-11-at-17.58.03.png/840x560.webp\"></a></div>",
        "id": 481768088,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731344392
    },
    {
        "content": "<p>Afaict nothing in that CI screen shot is even close to do anything with doc-gen?</p>",
        "id": 481769606,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731344818
    },
    {
        "content": "<p>I will investigate it better later today. Thanks.</p>",
        "id": 481772066,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731345611
    },
    {
        "content": "<p>I followed the instructions <a href=\"https://github.com/leanprover/doc-gen4#usage\">here</a>.</p>\n<p>However, when I run <code>lake update</code> within the <code>docbuild</code> directory, it generates a <code>.lake</code> folder containing mathlib which is approximately 5 GB in size.</p>",
        "id": 481773840,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731346231
    },
    {
        "content": "<p>Hm, let's see. <span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span> if we have nested lake projects to the child projects properly reuse build artifacts from the other ones?</p>",
        "id": 481774179,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731346345
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"395550\">@Henrik Böving</span> Different workspaces do not share dependencies, no. (There is, after all, no guarentee they use they same version of the dependencies.)</p>",
        "id": 481775308,
        "sender_full_name": "Mac Malone",
        "timestamp": 1731346704
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"315577\">Mac Malone</span> <a href=\"#narrow/channel/270676-lean4/topic/New.20recommended.20default.20setup.20for.20doc-gen4/near/481775308\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"395550\">Henrik Böving</span> Different workspaces do not share dependencies, no. (There is, after all, no guarentee they use they same version of the dependencies.)</p>\n</blockquote>\n<p>Is there a way we could make them share build artefacts if they are common easily?</p>",
        "id": 481775752,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731346865
    },
    {
        "content": "<p>I imagine we might be able to just symlink .lake?</p>",
        "id": 481775792,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731346881
    },
    {
        "content": "<p>One could use symlinks for <code>.lake/packages/&lt;shared-package&gt;</code>.</p>",
        "id": 481776069,
        "sender_full_name": "Mac Malone",
        "timestamp": 1731346980
    },
    {
        "content": "<p>Great</p>",
        "id": 481776180,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731347029
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"556875\">@Pietro Monticone</span> in that case the CI script should create <code>docbuild/.lake/packages</code> on it's own and then generate a symlink from <code>.lake/packages/&lt;package-name&gt;</code> to <code>docbuild/.lake/packages/&lt;package-name&gt;</code> and you'll get the desired sharing effects.</p>",
        "id": 481776376,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731347088
    },
    {
        "content": "<p>I'll add a note for that in the docs</p>",
        "id": 481776757,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731347220
    },
    {
        "content": "<p>Ok, I'll take a look at it later. Thanks.</p>",
        "id": 481777132,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731347357
    },
    {
        "content": "<p>What should I do locally?</p>",
        "id": 481777318,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731347414
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"556875\">@Pietro Monticone</span> I updated the notes in doc-gen's README, it worked for me locally with mathlib and its dependencies, please do tell if it doesn't in your setup</p>",
        "id": 481783006,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731349510
    },
    {
        "content": "<p>Yes, it worked locally for me too. Thanks.</p>",
        "id": 481785080,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731350270
    },
    {
        "content": "<p>I have just tested on the project mentioned above and everything works as expected.</p>",
        "id": 481805919,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731357829
    },
    {
        "content": "<p>Tested on Carleson too <span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span></p>",
        "id": 481814202,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731361459
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span> What goes wrong if the parent package directory is used for both? Since the main is required by path \"..\" there shouldn't be any conflicts?</p>",
        "id": 481823740,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1731365686
    },
    {
        "content": "<p>I've had success using:</p>\n<div class=\"codehilite\" data-code-language=\"TOML\"><pre><span></span><code><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"docbuild\"</span>\n<span class=\"n\">reservoir</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">false</span>\n<span class=\"n\">buildDir</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\".\"</span>\n<span class=\"n\">packagesDir</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"../.lake/packages\"</span>\n\n<span class=\"k\">[[require]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"doc-gen4\"</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/leanprover/doc-gen4\"</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"main\"</span>\n\n<span class=\"k\">[[require]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"my-lib\"</span>\n<span class=\"n\">path</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"..\"</span>\n</code></pre></div>\n<p>That way both the main and docbuild packages share the same packages directory, avoiding any duplication.</p>\n<p>The <code>buildDir = \".\"</code> puts <code>doc</code> and <code>doc-data</code> directly in the <code>docbuild</code> directory and results in no <code>.lake</code> directory at all in <code>docbuild</code>.</p>",
        "id": 481833958,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1731370387
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span> does this seem sound?</p>",
        "id": 481834106,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1731370459
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"119741\">@François G. Dorais</span> Looks reasonable to me. I honestly forgot that configuring the packages directory is one way to share packages.</p>",
        "id": 481834664,
        "sender_full_name": "Mac Malone",
        "timestamp": 1731370724
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span>! Also, should the require order be my-lib first and then doc-gen4 or the other way around? I always forget which one gets priority...</p>",
        "id": 481835754,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1731371267
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"119741\">@François G. Dorais</span> Currently the first gets priority, in the next release it will be the last. It probably doesn't matter in this case.</p>",
        "id": 481871331,
        "sender_full_name": "Mac Malone",
        "timestamp": 1731391744
    },
    {
        "content": "<p>Ah great, I shall change the doc-gen setup in the README to that then</p>",
        "id": 481878230,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731395542
    },
    {
        "content": "<p>Okay I pushed another update to the README, there is one thing to keep in mind with respect to <code>lake update</code> that I noted there. <span class=\"user-mention\" data-user-id=\"119741\">@François G. Dorais</span> <span class=\"user-mention\" data-user-id=\"556875\">@Pietro Monticone</span></p>",
        "id": 481892225,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731400870
    },
    {
        "content": "<p>Great, I will adapt the workflows accordingly later today.</p>",
        "id": 481955819,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731420024
    },
    {
        "content": "<p>I followed the instructions <a href=\"https://github.com/leanprover/doc-gen4#usage\">here</a>, but when I run <code>lake update</code> within <code>docbuild</code> I get the following error: </p>\n<div class=\"codehilite\" data-code-language=\"Bash Session\"><pre><span></span><code><span class=\"go\">uncaught exception: no such file or directory (error code: 2)</span>\n<span class=\"go\">  file: .lake/packages/mathlib/lakefile.lean</span>\n<span class=\"go\">info: docbuild: no previous manifest, creating one from scratch</span>\n<span class=\"go\">info: leanprover/doc-gen4: cloning https://github.com/leanprover/doc-gen4 to '././../.lake/packages/doc-gen4'</span>\n<span class=\"go\">info: MD4Lean: cloning https://github.com/acmepjz/md4lean to '././../.lake/packages/MD4Lean'</span>\n<span class=\"go\">info: BibtexQuery: cloning https://github.com/dupuisf/BibtexQuery to '././../.lake/packages/BibtexQuery'</span>\n<span class=\"go\">info: UnicodeBasic: cloning https://github.com/fgdorais/lean4-unicode-basic to '././../.lake/packages/UnicodeBasic'</span>\n<span class=\"go\">info: mathlib: running post-update hooks</span>\n<span class=\"go\">error: mathlib: failed to fetch cache</span>\n</code></pre></div>",
        "id": 481983093,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731427220
    },
    {
        "content": "<p>Ah this is for one a bug in the mathlibs cripts</p>",
        "id": 481983263,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731427267
    },
    {
        "content": "<p>but also a bug in the guide, you probably only want to run <code>lake update doc-gen4</code></p>",
        "id": 481983293,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731427276
    },
    {
        "content": "<p>Then mathlib should not get touched I guess?</p>",
        "id": 481983370,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731427293
    },
    {
        "content": "<p>I did <code>lake update MyLib</code> and it worked.</p>",
        "id": 481983414,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731427306
    },
    {
        "content": "<p>What is MyLib and where did you run it</p>",
        "id": 481983539,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731427328
    },
    {
        "content": "<p>No, sorry. It didn't...</p>\n<p>Let me try with <code>lake update doc-gen4</code></p>",
        "id": 481983590,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731427341
    },
    {
        "content": "<p>If you are in <code>docbuild</code> and only run <code>lake update doc-gen4</code> it should hopefully not touch mathlib?</p>",
        "id": 481983732,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731427380
    },
    {
        "content": "<p>Nope, same error: </p>\n<div class=\"codehilite\" data-code-language=\"Bash Session\"><pre><span></span><code><span class=\"go\">uncaught exception: no such file or directory (error code: 2)</span>\n<span class=\"go\">  file: .lake/packages/mathlib/lakefile.lean</span>\n<span class=\"go\">info: docbuild: no previous manifest, creating one from scratch</span>\n<span class=\"go\">info: mathlib: running post-update hooks</span>\n<span class=\"go\">error: mathlib: failed to fetch cache</span>\n</code></pre></div>",
        "id": 481983919,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731427428
    },
    {
        "content": "<p>Yeah then that's a bug mathlib has to fix</p>",
        "id": 481984038,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731427449
    },
    {
        "content": "<p>At least that is my best guess</p>",
        "id": 481984069,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731427459
    },
    {
        "content": "<p>I assume a mathlib script here has hardcoded the access path to the lakefile.lean and that is wrong</p>",
        "id": 481984113,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731427473
    },
    {
        "content": "<p>Hm though I don't see it through immediate grep, though it is quite suspicious that it only affects mathlib. just doing this docbuild setup within mathlib doesn't break any of its dependencies in this way</p>",
        "id": 481984406,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731427553
    },
    {
        "content": "<p>so it is certainly something specific to the mathlib setup</p>",
        "id": 481984433,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731427559
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"556875\">@Pietro Monticone</span> can you reproduce the issue when doing this inside of a mathlib checkout? I can't</p>",
        "id": 481985431,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731427823
    },
    {
        "content": "<p>If not it is related to some mathlib script that is running and someone that knows those scripts should probably look at it</p>",
        "id": 481985487,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731427840
    },
    {
        "content": "<p>No, inside a mathlib checkout I don't get any errors: </p>\n<div class=\"codehilite\" data-code-language=\"Bash Session\"><pre><span></span><code><span class=\"go\">Decompressing 9 file(s)</span>\n<span class=\"go\">Unpacked in 2980 ms</span>\n<span class=\"go\">Completed successfully!</span>\n<span class=\"go\">info: docbuild: no previous manifest, creating one from scratch</span>\n<span class=\"go\">info: leanprover/doc-gen4: cloning https://github.com/leanprover/doc-gen4 to '././../.lake/packages/doc-gen4'</span>\n<span class=\"go\">info: MD4Lean: cloning https://github.com/acmepjz/md4lean to '././../.lake/packages/MD4Lean'</span>\n<span class=\"go\">info: BibtexQuery: cloning https://github.com/dupuisf/BibtexQuery to '././../.lake/packages/BibtexQuery'</span>\n<span class=\"go\">info: UnicodeBasic: cloning https://github.com/fgdorais/lean4-unicode-basic to '././../.lake/packages/UnicodeBasic'</span>\n<span class=\"go\">info: mathlib: running post-update hooks</span>\n</code></pre></div>",
        "id": 481986659,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731428191
    },
    {
        "content": "<p>Right, in that case it is most likely a location in mathlib that does not respect <code>packagesDir</code> and instead blindly grabs into <code>.lake/packages</code></p>",
        "id": 481986769,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731428230
    },
    {
        "content": "<p>Hm, maybe <a href=\"https://github.com/leanprover-community/mathlib4/blob/master/Cache/IO.lean#L81-L82\">https://github.com/leanprover-community/mathlib4/blob/master/Cache/IO.lean#L81-L82</a> but I don't have any insight into what mathlib runs upon a <code>lake update</code></p>",
        "id": 481987000,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731428294
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> if we run a <code>lake update</code> in a project that depends on mathlib, does that automatically trigger a <code>lake exe cache</code> or some other mathlib script that could potentially blindly grab into <code>.lake/packages</code> instead of respecting the <code>packagesDir</code>entry in the <code>lake-manifest.json</code> in the directory that it is being called in?</p>",
        "id": 481987423,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731428410
    },
    {
        "content": "<p>Oh, yes. It does.</p>",
        "id": 481987538,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731428445
    },
    {
        "content": "<p>I remember seeing it once a few months ago.</p>",
        "id": 481987620,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1731428468
    },
    {
        "content": "<p>Yes, this is in mathlib's lakefile.lean</p>",
        "id": 481987692,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1731428492
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/--</span>\n<span class=\"sd\">When a package depending on Mathlib updates its dependencies,</span>\n<span class=\"sd\">update its toolchain to match Mathlib's and fetch the new cache.</span>\n<span class=\"sd\">-/</span>\n<span class=\"n\">post_update</span><span class=\"w\"> </span><span class=\"n\">pkg</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">rootPkg</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">getRootPackage</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">rootPkg</span><span class=\"bp\">.</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">pkg</span><span class=\"bp\">.</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">    </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"c1\">-- do not run in Mathlib itself</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span>\n<span class=\"cm\">  Once Lake updates the toolchains,</span>\n<span class=\"cm\">  this toolchain copy will be unnecessary.</span>\n<span class=\"cm\">  https://github.com/leanprover/lean4/issues/2752</span>\n<span class=\"cm\">  -/</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">wsToolchainFile</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rootPkg</span><span class=\"bp\">.</span><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"s2\">\"lean-toolchain\"</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mathlibToolchain</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">FS</span><span class=\"bp\">.</span><span class=\"n\">readFile</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">pkg</span><span class=\"bp\">.</span><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"s2\">\"lean-toolchain\"</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">FS</span><span class=\"bp\">.</span><span class=\"n\">writeFile</span><span class=\"w\"> </span><span class=\"n\">wsToolchainFile</span><span class=\"w\"> </span><span class=\"n\">mathlibToolchain</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">getEnv</span><span class=\"w\"> </span><span class=\"s2\">\"MATHLIB_NO_CACHE_ON_UPDATE\"</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">!=</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"s2\">\"1\"</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">    </span><span class=\"c\">/-</span>\n<span class=\"cm\">    Instead of building and running cache via the Lake API,</span>\n<span class=\"cm\">    spawn a new `lake` since the toolchain may have changed.</span>\n<span class=\"cm\">    -/</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">exitCode</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">Process</span><span class=\"bp\">.</span><span class=\"n\">spawn</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">      </span><span class=\"n\">cmd</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"elan\"</span>\n<span class=\"w\">      </span><span class=\"n\">args</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"run\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"--install\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mathlibToolchain</span><span class=\"bp\">.</span><span class=\"n\">trim</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"lake\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"exe\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"cache\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"get\"</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">&gt;&gt;=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·.</span><span class=\"n\">wait</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">exitCode</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">      </span><span class=\"n\">logError</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"{pkg.name}: failed to fetch cache\"</span>\n</code></pre></div>",
        "id": 481987722,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1731428503
    },
    {
        "content": "<p>right</p>",
        "id": 481987737,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731428511
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/blob/master/Cache/IO.lean#L81-L82\">https://github.com/leanprover-community/mathlib4/blob/master/Cache/IO.lean#L81-L82</a> then this line needs to be fixed to respect the lake manifest.</p>",
        "id": 481987861,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731428538
    },
    {
        "content": "<p>I'm feeling a little uncertain about recommending this setup publicly now  tbh, it seems the eco system is not at the point yet where we can just do fancy things like this in the lakefile without breakages :/</p>",
        "id": 481989632,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731429069
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/stream/270676-lean4/topic/New.20recommended.20default.20setup.20for.20doc-gen4/near/481987722\">said</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/--</span>\n<span class=\"sd\">When a package depending on Mathlib updates its dependencies,</span>\n<span class=\"sd\">update its toolchain to match Mathlib's and fetch the new cache.</span>\n<span class=\"sd\">-/</span>\n<span class=\"n\">post_update</span><span class=\"w\"> </span><span class=\"n\">pkg</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">rootPkg</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">getRootPackage</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">rootPkg</span><span class=\"bp\">.</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">pkg</span><span class=\"bp\">.</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">    </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"c1\">-- do not run in Mathlib itself</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span>\n<span class=\"cm\">  Once Lake updates the toolchains,</span>\n<span class=\"cm\">  this toolchain copy will be unnecessary.</span>\n<span class=\"cm\">  https://github.com/leanprover/lean4/issues/2752</span>\n<span class=\"cm\">  -/</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">wsToolchainFile</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rootPkg</span><span class=\"bp\">.</span><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"s2\">\"lean-toolchain\"</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mathlibToolchain</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">FS</span><span class=\"bp\">.</span><span class=\"n\">readFile</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">pkg</span><span class=\"bp\">.</span><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"s2\">\"lean-toolchain\"</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">FS</span><span class=\"bp\">.</span><span class=\"n\">writeFile</span><span class=\"w\"> </span><span class=\"n\">wsToolchainFile</span><span class=\"w\"> </span><span class=\"n\">mathlibToolchain</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">getEnv</span><span class=\"w\"> </span><span class=\"s2\">\"MATHLIB_NO_CACHE_ON_UPDATE\"</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">!=</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"s2\">\"1\"</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">    </span><span class=\"c\">/-</span>\n<span class=\"cm\">    Instead of building and running cache via the Lake API,</span>\n<span class=\"cm\">    spawn a new `lake` since the toolchain may have changed.</span>\n<span class=\"cm\">    -/</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">exitCode</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">Process</span><span class=\"bp\">.</span><span class=\"n\">spawn</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">      </span><span class=\"n\">cmd</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"elan\"</span>\n<span class=\"w\">      </span><span class=\"n\">args</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"run\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"--install\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mathlibToolchain</span><span class=\"bp\">.</span><span class=\"n\">trim</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"lake\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"exe\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"cache\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"get\"</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">&gt;&gt;=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·.</span><span class=\"n\">wait</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">exitCode</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">      </span><span class=\"n\">logError</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"{pkg.name}: failed to fetch cache\"</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Thinking some more about this. It would most likely be even better if the specific lake update in question here just doesnt trigger this post update hook as it doesnt actually update mathlib. But I guess that requires additional lake support</p>",
        "id": 482002005,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731433011
    },
    {
        "content": "<p>Maybe a temporary patch for packages that depend on mathlib is to add a symlink from <code>.lake/build</code> pointing to <code>../.lake/build</code>?</p>",
        "id": 482017359,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1731438583
    },
    {
        "content": "<p>What's the issue with fixing the cache script? That sounds doable doesn't it?</p>",
        "id": 482018091,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1731438864
    },
    {
        "content": "<p>I think so but I don't really have the bandwidth right now. Something like how I patched doc-gen4 should work.</p>",
        "id": 482018450,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1731438993
    },
    {
        "content": "<p>(In other words, have the get functions take an optional <code>--build</code> argument specifying the build directory.)</p>",
        "id": 482018633,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1731439055
    },
    {
        "content": "<p>Or adding instructions to set <code>MATHLIB_NO_CACHE_ON_UPDATE=1</code> before building docs?</p>",
        "id": 482019106,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1731439210
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"395550\">Henrik Böving</span> <a href=\"#narrow/channel/270676-lean4/topic/New.20recommended.20default.20setup.20for.20doc-gen4/near/481989632\">said</a>:</p>\n<blockquote>\n<p>I'm feeling a little uncertain about recommending this setup publicly now  tbh, it seems the eco system is not at the point yet where we can just do fancy things like this in the lakefile without breakages :/</p>\n</blockquote>\n<p>I think there is two sides to this. On one hand, cache will hopefully be eventually integrated with Lake and thus not overassume like this (preventing the breakage). On the other hand, having more packages which do fancy things helps discourage writing tools that overassume structure (as they will break).</p>",
        "id": 482068639,
        "sender_full_name": "Mac Malone",
        "timestamp": 1731460730
    },
    {
        "content": "<p>I originally misread your second sentence. Yes, I agree with you.</p>",
        "id": 482073351,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1731463680
    },
    {
        "content": "<p>Maybe there could be a curated collection of lake scripts somewhere.</p>",
        "id": 482073928,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1731464008
    },
    {
        "content": "<p>I am rereading this thread now, and my sentiment of whether I should switch my projects over to the new setup is: \"Maybe, maybe not?\". Am I right in my analysis? Did I miss any development in the past two weeks or so?</p>",
        "id": 484899860,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1732793476
    },
    {
        "content": "<p>As François hinted at, the Mathlib error can be avoided with the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">MATHLIB_NO_CACHE_ON_UPDATE</span><span class=\"bp\">=</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">update</span>\n</code></pre></div>\n<p>Improvements to Lake / Mahtlib Cache which will remove the need for this workaround will come down the line, but this is currently a quick way to solve the isssue. It is also probably worth noting that the failure of a post-update hook does not actually prevent the underlying update from succeeding (as they are run after the update). So one can also just ignore the error.</p>",
        "id": 485138000,
        "sender_full_name": "Mac Malone",
        "timestamp": 1732900836
    },
    {
        "content": "<p>Could we get instructions for how to bump mathlib with this new setup? I find it hard to get right</p>",
        "id": 494316669,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737105869
    },
    {
        "content": "<p>Here is what I've tried (running in the root folder):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">mathlib</span>\n<span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">docbuild</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span>\n<span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"bp\">..</span>\n</code></pre></div>",
        "id": 494316888,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737105949
    },
    {
        "content": "<p>In <a href=\"https://github.com/YaelDillies/LeanAPAP\">APAP</a>, the second <code>lake update</code> fails with</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">updated</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">already</span><span class=\"w\"> </span><span class=\"n\">up</span><span class=\"bp\">-</span><span class=\"n\">to</span><span class=\"bp\">-</span><span class=\"n\">date</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">141</span><span class=\"o\">:</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.bindSync</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.mapM</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">142</span><span class=\"o\">:</span><span class=\"mi\">29</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span>\n<span class=\"w\">  </span><span class=\"n\">tryJson</span><span class=\"w\"> </span><span class=\"bp\">&lt;|&gt;</span><span class=\"w\"> </span><span class=\"n\">tryBib</span><span class=\"w\"> </span><span class=\"bp\">&lt;|&gt;</span><span class=\"w\"> </span><span class=\"n\">tryBibFailed</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">JobM</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">BuildTrace</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">outParam</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">EStateT</span><span class=\"w\"> </span><span class=\"n\">Log</span><span class=\"bp\">.</span><span class=\"n\">Pos</span><span class=\"w\"> </span><span class=\"n\">JobState</span><span class=\"w\"> </span><span class=\"n\">BaseIO</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">6450</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">143</span><span class=\"o\">:</span><span class=\"mi\">20</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">invalid</span><span class=\"w\"> </span><span class=\"n\">field</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">mix'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">environment</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">contain</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Lake</span><span class=\"bp\">.</span><span class=\"n\">BuildContext</span><span class=\"bp\">.</span><span class=\"n\">mix'</span>\n<span class=\"w\">  </span><span class=\"n\">exeTrace</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">BuildContext</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">144</span><span class=\"o\">:</span><span class=\"mi\">16</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.buildFileUnlessUpToDate</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.buildFileUnlessUpToDate'</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">144</span><span class=\"o\">:</span><span class=\"mi\">16</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span>\n<span class=\"w\">  </span><span class=\"n\">buildFileUnlessUpToDate</span><span class=\"w\"> </span><span class=\"n\">outputFile</span><span class=\"w\"> </span><span class=\"n\">depTrace</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"bp\">__</span><span class=\"n\">do_lift</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">getAugmentedEnv</span>\n<span class=\"w\">    </span><span class=\"n\">liftM</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"n\">proc</span>\n<span class=\"w\">          </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">stdin</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">Process</span><span class=\"bp\">.</span><span class=\"n\">Stdio</span><span class=\"bp\">.</span><span class=\"n\">inherit</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">stdout</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">Process</span><span class=\"bp\">.</span><span class=\"n\">Stdio</span><span class=\"bp\">.</span><span class=\"n\">inherit</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">stderr</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">Process</span><span class=\"bp\">.</span><span class=\"n\">Stdio</span><span class=\"bp\">.</span><span class=\"n\">inherit</span><span class=\"o\">,</span>\n<span class=\"w\">            </span><span class=\"n\">cmd</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">exeFile</span><span class=\"bp\">.</span><span class=\"n\">toString</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">args</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"bibPrepass\"</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">args</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">cwd</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">__</span><span class=\"n\">do_lift</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">setsid</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"o\">})</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">JobM</span><span class=\"w\"> </span><span class=\"n\">BuildTrace</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">EStateT</span><span class=\"w\"> </span><span class=\"n\">Log</span><span class=\"bp\">.</span><span class=\"n\">Pos</span><span class=\"w\"> </span><span class=\"n\">JobState</span><span class=\"w\"> </span><span class=\"n\">BaseIO</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">7717</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">150</span><span class=\"o\">:</span><span class=\"mi\">11</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">application</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span>\n<span class=\"w\">  </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">outputFile</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">trace</span><span class=\"o\">)</span>\n<span class=\"n\">argument</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">outputFile</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">trace</span><span class=\"o\">)</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">FilePath</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">7702</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">FilePath</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">154</span><span class=\"o\">:</span><span class=\"mi\">22</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">synthesize</span>\n<span class=\"w\">  </span><span class=\"n\">FamilyOut</span><span class=\"w\"> </span><span class=\"n\">CustomData</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">bibPrepass</span><span class=\"bp\">.</span><span class=\"n\">pkg</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">bibPrepass</span><span class=\"bp\">.</span><span class=\"n\">name</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">9372</span>\n<span class=\"n\">Additional</span><span class=\"w\"> </span><span class=\"n\">diagnostic</span><span class=\"w\"> </span><span class=\"n\">information</span><span class=\"w\"> </span><span class=\"n\">may</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">available</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">diagnostics</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"bp\">.</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">158</span><span class=\"o\">:</span><span class=\"mi\">19</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.BuildJob.mixArray</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.mixArray</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">162</span><span class=\"o\">:</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.BuildJob.bindAsync</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.bindM</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">163</span><span class=\"o\">:</span><span class=\"mi\">4</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">invalid</span><span class=\"w\"> </span><span class=\"n\">field</span><span class=\"w\"> </span><span class=\"kn\">notation</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">form</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">constant</span>\n<span class=\"w\">  </span><span class=\"n\">bibPrepassJob</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"bp\">?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">11853</span><span class=\"w\"> </span><span class=\"n\">mod</span><span class=\"w\"> </span><span class=\"n\">exeJob</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">176</span><span class=\"o\">:</span><span class=\"mi\">49</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.BuildJob</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">178</span><span class=\"o\">:</span><span class=\"mi\">22</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">synthesize</span>\n<span class=\"w\">  </span><span class=\"n\">FamilyOut</span><span class=\"w\"> </span><span class=\"n\">CustomData</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">bibPrepass</span><span class=\"bp\">.</span><span class=\"n\">pkg</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">bibPrepass</span><span class=\"bp\">.</span><span class=\"n\">name</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">11995</span>\n<span class=\"n\">Additional</span><span class=\"w\"> </span><span class=\"n\">diagnostic</span><span class=\"w\"> </span><span class=\"n\">information</span><span class=\"w\"> </span><span class=\"n\">may</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">available</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">diagnostics</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"bp\">.</span>\n\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">182</span><span class=\"o\">:</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">invalid</span><span class=\"w\"> </span><span class=\"n\">field</span><span class=\"w\"> </span><span class=\"kn\">notation</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">form</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">constant</span>\n<span class=\"w\">  </span><span class=\"n\">bibPrepassJob</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"bp\">?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">13321</span><span class=\"w\"> </span><span class=\"n\">exeJob</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">195</span><span class=\"o\">:</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.BuildJob.mixArray</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.mixArray</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">199</span><span class=\"o\">:</span><span class=\"mi\">19</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.BuildJob.mixArray</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.mixArray</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">226</span><span class=\"o\">:</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.bindAsync</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.bindM</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">227</span><span class=\"o\">:</span><span class=\"mi\">4</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.bindAsync</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.bindM</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">228</span><span class=\"o\">:</span><span class=\"mi\">6</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.BuildJob.bindSync</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.mapM</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">229</span><span class=\"o\">:</span><span class=\"mi\">52</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">application</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span>\n<span class=\"w\">  </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">exeTrace</span>\n<span class=\"n\">argument</span>\n<span class=\"w\">  </span><span class=\"n\">exeTrace</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">BuildContext</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">BuildTrace</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">229</span><span class=\"o\">:</span><span class=\"mi\">62</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">application</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span>\n<span class=\"w\">  </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">coreInputTrace</span>\n<span class=\"n\">argument</span>\n<span class=\"w\">  </span><span class=\"n\">coreInputTrace</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">BuildContext</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">BuildTrace</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">230</span><span class=\"o\">:</span><span class=\"mi\">20</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.buildFileUnlessUpToDate</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.buildFileUnlessUpToDate'</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">243</span><span class=\"o\">:</span><span class=\"mi\">19</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.BuildJob.mixArray</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.mixArray</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">250</span><span class=\"o\">:</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.bindAsync</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.bindM</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">251</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.bindAsync</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.bindM</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">252</span><span class=\"o\">:</span><span class=\"mi\">6</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.BuildJob.bindSync</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.Job.mapM</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">253</span><span class=\"o\">:</span><span class=\"mi\">52</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">application</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span>\n<span class=\"w\">  </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">exeTrace</span>\n<span class=\"n\">argument</span>\n<span class=\"w\">  </span><span class=\"n\">exeTrace</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">BuildContext</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">BuildTrace</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">253</span><span class=\"o\">:</span><span class=\"mi\">62</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">application</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span>\n<span class=\"w\">  </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">coreInputTrace</span>\n<span class=\"n\">argument</span>\n<span class=\"w\">  </span><span class=\"n\">coreInputTrace</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">BuildContext</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">BuildTrace</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">254</span><span class=\"o\">:</span><span class=\"mi\">20</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"ss\">`Lake.buildFileUnlessUpToDate</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">deprecated</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"ss\">`Lake.buildFileUnlessUpToDate'</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">instead</span>\n\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././../.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">/</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">configuration</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">errors</span>\n</code></pre></div>",
        "id": 494317121,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737106021
    },
    {
        "content": "<p>Sorry to be annoying, but Kim has repeatedly asked me to switch from a setup that worked (for me) to a setup that doesn't work (for me) and now my projects are broken <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span> What am I supposed to be doing?</p>",
        "id": 494322258,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737107661
    },
    {
        "content": "<p>You pinned doc-gen to v4.15 in your lakefile.toml, that version has to be pulled up as you upgrade of course (as noted in the README I might add)</p>",
        "id": 494323755,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1737108134
    },
    {
        "content": "<p>The error you are observing is just the recent lake refactoring that went down in 4.16 that broke what doc-gen did so far in 4.15 unfortunately</p>",
        "id": 494324005,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1737108215
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"395550\">Henrik Böving</span> <a href=\"#narrow/channel/270676-lean4/topic/New.20recommended.20default.20setup.20for.20doc-gen4/near/494323755\">said</a>:</p>\n<blockquote>\n<p>You pinned doc-gen to v4.15 in your lakefile.toml, that version has to be pulled up as you upgrade of course (as noted in the README I might add)</p>\n</blockquote>\n<p>Yeah, I noticed that just now</p>",
        "id": 494324158,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737108248
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"395550\">Henrik Böving</span> <a href=\"#narrow/channel/270676-lean4/topic/New.20recommended.20default.20setup.20for.20doc-gen4/near/494324005\">said</a>:</p>\n<blockquote>\n<p>The error you are observing is just the recent lake refactoring that went down in 4.16 that broke what doc-gen did so far in 4.15 unfortunately</p>\n</blockquote>\n<p>Are you saying that even if I unpin the doc-gen version, my build will fail?</p>",
        "id": 494324242,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737108271
    },
    {
        "content": "<p>No it is fixed in the v4.16 on doc-gen</p>",
        "id": 494324485,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1737108355
    },
    {
        "content": "<p>But you are currently building a v4.15 doc-gen with v4.16 so that burns</p>",
        "id": 494324572,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1737108370
    },
    {
        "content": "<p>Got it! And can you confirm that</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">mathlib</span>\n<span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">docbuild</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span>\n<span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"bp\">..</span>\n</code></pre></div>\n<p>is the correct set of instructions to update my project from now on (namely, once I have removed the doc-gen version pin)?</p>",
        "id": 494324677,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737108411
    },
    {
        "content": "<p>That should work AFAIK yes</p>",
        "id": 494324725,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1737108429
    },
    {
        "content": "<p>I assume it will burn if once again we (⊆ FRO ?) forget to bump doc-gen to the latest toolchain?</p>",
        "id": 494325096,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737108546
    },
    {
        "content": "<p>But Kim has a script that ensures we don't now!</p>",
        "id": 494325879,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1737108806
    },
    {
        "content": "<p>Yes, I saw <span aria-label=\"eyes\" class=\"emoji emoji-1f440\" role=\"img\" title=\"eyes\">:eyes:</span> Just wondering if I can myself add an extra failsafe mechanism on top. Or are you saying it should really never ever happen again?</p>",
        "id": 494326338,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1737108944
    },
    {
        "content": "<p>I hope that more and more of that script will become part of automated workflows.<br>\nMy impression is that chances that it happens again are really small now.</p>",
        "id": 494327021,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1737109155
    }
]