[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">count_cons_of_ne</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">count</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">count</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">l</span>\n</code></pre></div>\n<p>I think that <code>a</code> and <code>b</code> should be swapped in <code>h</code>. This is because of the convention is to put the \"more variable\" argument on the left, in this case <code>b</code> is the more variable argument.</p>\n<p>I ran into this because I was following this convention, and the simp lemma didn't apply.</p>",
        "id": 507505844,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1742688493
    },
    {
        "content": "<p>My initial reaction is that the order there is correct with a hypothetical \"keep things in a consistent order through the statement\" rule.</p>",
        "id": 507507082,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1742689503
    },
    {
        "content": "<p>Well, it can also be stated as</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">count_cons_of_ne</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">count</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"bp\">.</span><span class=\"n\">count</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>which would give the opposite order with that rule.</p>",
        "id": 507515760,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1742696742
    },
    {
        "content": "<p>The thing is that the definition of <code>List.count</code> does follow the \"more variable of the left\" convention.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">count</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">BEq</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">countP</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">==</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>So I think it's weird that this lemma flips the equality around.</p>",
        "id": 507517597,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1742698257
    },
    {
        "content": "<p>I'd merge such a PR.</p>",
        "id": 507627231,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1742779687
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/pull/7650\">lean#7650</a></p>",
        "id": 507629683,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1742781120
    },
    {
        "content": "<p>If you want to fix the <code>lean-pr-testing-7650</code> branch at Batteries that would be great, but it's probably easy for me to do when the nightly lands.</p>",
        "id": 507703431,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1742809866
    },
    {
        "content": "<p>I won't have time for it today</p>",
        "id": 507708850,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1742811096
    }
]