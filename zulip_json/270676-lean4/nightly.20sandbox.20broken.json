[
    {
        "content": "<p>The nightly version of the sandbox seems to be broken for me, e.g. <a href=\"https://live.lean-lang.org/#project=lean-nightly&amp;code=inductive%20MyNat%20%3A%20Type%20where%0A%20%20%7C%20zero%20%3A%20MyNat%0A%20%20%7C%20succ%20%3A%20MyNat%20%E2%86%92%20MyNat%0A%0A\">here</a>. It gets stuck on \"Waiting for Lean server to start...\".</p>\n<p>Could someone confirm they see the same behaviour?</p>",
        "id": 448051822,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1719707385
    },
    {
        "content": "<p>I actually can't remember who set up the nightly version of the sandbox --- if some remembers, perhaps we can ping them here, thanks. :-)</p>",
        "id": 448051881,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1719707407
    },
    {
        "content": "<p>Pinging <span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span> .</p>",
        "id": 448083902,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1719731981
    },
    {
        "content": "<p>Hmm, I see a confusing lake error in the log</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">mathlibLatest</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">previous</span><span class=\"w\"> </span><span class=\"n\">manifest</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">creating</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">scratch</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">mathlib</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">running</span><span class=\"w\"> </span><span class=\"n\">post</span><span class=\"bp\">-</span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">hooks</span>\n<span class=\"bp\">⚠</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"bp\">/</span><span class=\"mi\">10</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Fetched</span><span class=\"w\"> </span><span class=\"n\">proofwidgets</span><span class=\"o\">:</span><span class=\"n\">optRelease</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">proofwidgets</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">wanted</span><span class=\"w\"> </span><span class=\"n\">prebuilt</span><span class=\"w\"> </span><span class=\"n\">release</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">tag</span><span class=\"w\"> </span><span class=\"n\">found</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">revision</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">fetch</span><span class=\"w\"> </span><span class=\"n\">cloud</span><span class=\"w\"> </span><span class=\"n\">release</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">falling</span><span class=\"w\"> </span><span class=\"n\">back</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"n\">build</span>\n<span class=\"n\">No</span><span class=\"w\"> </span><span class=\"n\">files</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">download</span>\n<span class=\"n\">Decompressing</span><span class=\"w\"> </span><span class=\"mi\">4729</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span>\n<span class=\"n\">Unpacked</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"mi\">62</span><span class=\"w\"> </span><span class=\"n\">ms</span>\n<span class=\"n\">Completed</span><span class=\"w\"> </span><span class=\"n\">successfully!</span>\n<span class=\"bp\">⚠</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"bp\">/</span><span class=\"mi\">4742</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Fetched</span><span class=\"w\"> </span><span class=\"n\">proofwidgets</span><span class=\"o\">:</span><span class=\"n\">optRelease</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">proofwidgets</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">wanted</span><span class=\"w\"> </span><span class=\"n\">prebuilt</span><span class=\"w\"> </span><span class=\"n\">release</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">tag</span><span class=\"w\"> </span><span class=\"n\">found</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">revision</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">fetch</span><span class=\"w\"> </span><span class=\"n\">cloud</span><span class=\"w\"> </span><span class=\"n\">release</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">falling</span><span class=\"w\"> </span><span class=\"n\">back</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"n\">build</span>\n<span class=\"n\">ℹ</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">246</span><span class=\"bp\">/</span><span class=\"mi\">4742</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Replayed</span><span class=\"w\"> </span><span class=\"n\">MathlibLatest</span><span class=\"bp\">.</span><span class=\"n\">Logic</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././././</span><span class=\"n\">MathlibLatest</span><span class=\"bp\">/</span><span class=\"n\">Logic</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">14</span><span class=\"o\">:</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Try</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">not_or</span>\n<span class=\"bp\">✖</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">429</span><span class=\"bp\">/</span><span class=\"mi\">4742</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Fetching</span><span class=\"w\"> </span><span class=\"n\">proofwidgets</span><span class=\"o\">:</span><span class=\"n\">release</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">proofwidgets</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">wanted</span><span class=\"w\"> </span><span class=\"n\">prebuilt</span><span class=\"w\"> </span><span class=\"n\">release</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">tag</span><span class=\"w\"> </span><span class=\"n\">found</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">revision</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">fetch</span><span class=\"w\"> </span><span class=\"n\">cloud</span><span class=\"w\"> </span><span class=\"n\">release</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">proofwidgets</span><span class=\"o\">:</span><span class=\"n\">release</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n</code></pre></div>",
        "id": 448089988,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1719737178
    },
    {
        "content": "<p>Ah, <code>rm -rf</code>’ing enough things made it work. All works again. I should maybe make the scripts more robust by starting with a fresh directory and switch over atomically; I do that already on loogle. And I should move loogle to the FRO-paid machine. But now it’s working again, so less pressing again :-)</p>",
        "id": 448090318,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1719737454
    },
    {
        "content": "<p>Anyone else seeing the normal sandbox broken  too? At <a href=\"https://live.lean-lang.org/\">https://live.lean-lang.org/</a> I just getting \"Waiting for Lean server to start...\"</p>",
        "id": 448483268,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1719886714
    },
    {
        "content": "<p>I think we need a bot that checks this periodically and posts about failures to start.</p>",
        "id": 448483282,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1719886724
    },
    {
        "content": "<p>Broken for me as well</p>",
        "id": 448485755,
        "sender_full_name": "John Tristan",
        "timestamp": 1719887895
    },
    {
        "content": "<p><span aria-label=\"eyes\" class=\"emoji emoji-1f440\" role=\"img\" title=\"eyes\">:eyes:</span></p>",
        "id": 448513082,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1719901490
    },
    {
        "content": "<p>Ok, fixed it. The problem was that I did a system update due a security advisory. This changed the GLIBC used by the sandbox server, but not the one used by the downloaded lake toolchains. The sandboxing script was using the the former, when it should be using the latter.</p>\n<p>Fixed this by <a href=\"https://github.com/Kha/lean4web/commit/436b05cdb5c56444d246a5205c6900436745fb0b\">using the libc as embedded in the toolchain</a>.</p>\n<p>There is still a similar breakage possible after <code>nix gc</code>, I expect, which affects all nixpkgs’ elan, filed an <a href=\"https://github.com/NixOS/nixpkgs/issues/323961\">issue about possibly fixing this</a>.</p>",
        "id": 448521430,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1719904335
    }
]