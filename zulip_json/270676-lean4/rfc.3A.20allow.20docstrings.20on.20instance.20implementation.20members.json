[
    {
        "content": "<p>Was working on FPIL and ran into this issue: docstrings above <code>pure</code> and <code>bind</code> are illegal syntax. I was thinking of making an RFC where any docstrings added would be prepended with a divider marker to the docstring of the typeclass docs. presumably docs on specific impls are more concrete and informative than the abstract docs (in this case for <code>Monad</code>), hence handy to have around. Also handy for hover to get more specific info about something like, say, a <code>ToString</code> instance for floating point revealing details of just how it does it since it's famously tricky.</p>\n<p>Example that sparked idea:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- A monadic action -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">ConfigIO</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Config</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"w\"> </span><span class=\"n\">α</span>\n\n<span class=\"sd\">/--This is a monad because it has a pure and bind function-/</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Monad</span><span class=\"w\"> </span><span class=\"n\">ConfigIO</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/--Pure ignores the config-/</span>\n<span class=\"w\">  </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">pure</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">  </span><span class=\"sd\">/--Bind takes a config and a function that takes a config and returns an IO action, and returns an IO action-/</span>\n<span class=\"w\">  </span><span class=\"n\">bind</span><span class=\"w\"> </span><span class=\"n\">result</span><span class=\"w\"> </span><span class=\"n\">next</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">cfg</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">newConfig</span><span class=\"w\">  </span><span class=\"bp\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">result</span><span class=\"w\"> </span><span class=\"n\">cfg</span>\n<span class=\"w\">    </span><span class=\"n\">next</span><span class=\"w\"> </span><span class=\"n\">newConfig</span><span class=\"w\"> </span><span class=\"n\">cfg</span>\n</code></pre></div>",
        "id": 497369524,
        "sender_full_name": "Alok Singh",
        "timestamp": 1738573363
    },
    {
        "content": "<p>Where are you proposing these doc-strings would go?</p>",
        "id": 497401961,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1738581035
    },
    {
        "content": "<p>On the hovers of any uses of a type class. So <code>toString 5.0</code>  would show float’s specific docstring for the toString call plus  whatever general docstring toString has in its original declaration in a <code>class</code> block.</p>",
        "id": 497554054,
        "sender_full_name": "Alok Singh",
        "timestamp": 1738626475
    },
    {
        "content": "<p>And these more specific strings would be declared in an <code>instance</code> blocks like above</p>",
        "id": 497554144,
        "sender_full_name": "Alok Singh",
        "timestamp": 1738626515
    },
    {
        "content": "<p>I'm not sold on docstrings on structure instance fields yet, but the docstring on the <code>instance</code> showing up in the hover for <code>toString</code> is seems interesting.</p>",
        "id": 497555253,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1738627174
    },
    {
        "content": "<p>I agree that somehow showing both doc string would be nice.</p>\n<p>Also what about go-to-definition behavior? I would like to have both options, jump either to the declaration of the class field or jump to the particular instance.</p>",
        "id": 497567800,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1738634876
    },
    {
        "content": "<p>Thats within the LSP protocol as they have go to definition/go to implementation as separate things AFAIK so this can likely be handled</p>",
        "id": 497596343,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1738653274
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 497790557,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1738719370
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"346070\">Tomas Skrivan</span> <a href=\"#narrow/channel/270676-lean4/topic/rfc.3A.20allow.20docstrings.20on.20instance.20implementation.20members/near/497567800\">said</a>:</p>\n<blockquote>\n<p>I would like to have both options, jump either to the declaration of the class field or jump to the particular instance.</p>\n</blockquote>\n<p>This already exists to some degree. If I write <code>example : (HAdd.hAdd : Nat → Nat → Nat) = HAdd.hAdd := rfl</code>, and I go to definition on the first <code>HAdd.hAdd</code> one of two things can happen (depending on which of my vscode windows I'm in <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span> )</p>\n<ul>\n<li>it goes to the definition of <code>HAdd.hAdd</code></li>\n<li>it shows a pop up which allows me to choose between going to the defition of either <code>HAdd.hAdd</code>, <code>instAdd</code> or <code>instAddNat</code>.</li>\n</ul>\n<p>(see also <a href=\"#narrow/channel/270676-lean4/topic/Go-to-def.20on.20typeclass.20fields.20and.20type-dependent.20notation/near/441927798\">here</a>)</p>",
        "id": 497790744,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1738719492
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/JOPQ5-ePNajGn7ID5yXbTUe6/afbeelding.png\">afbeelding.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/JOPQ5-ePNajGn7ID5yXbTUe6/afbeelding.png\" title=\"afbeelding.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"2232x864\" src=\"/user_uploads/thumbnail/3121/JOPQ5-ePNajGn7ID5yXbTUe6/afbeelding.png/840x560.webp\"></a></div>",
        "id": 497790844,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1738719569
    },
    {
        "content": "<p>Maybe it works in the Lean repository and not the Mathlib repository?</p>",
        "id": 497791203,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1738719753
    }
]