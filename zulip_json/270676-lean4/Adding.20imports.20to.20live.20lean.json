[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"385895\">@Jon Eugster</span> how hard would it be to allow using extra imports on <a href=\"http://live.lean-lang.org\">live.lean-lang.org</a>? Adding one single file on top of Mathlib would already be extremely useful. Once again I have to give a two hours long introduction to Lean for curious mathematicians. Installing Lean+mathlib would use up all the time and getting GitPod or GitHub codespaces to work is almost as painful. Using <a href=\"http://live.lean-lang.org\">live.lean-lang.org</a> is almost perfect for this, but this requires starting the demo file with distracting code setting up stuff. Having an url that loads stable mathlib + one file taken from a remote webpage would be great.</p>",
        "id": 500618579,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1739961858
    },
    {
        "content": "<p>A big hack that would be functionally just as good would be to take an extra url argument saying to hide the first N lines of the file in the editor.</p>",
        "id": 500618702,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1739961899
    },
    {
        "content": "<p>Or equivalently, instead of sending only the file to the lean server, prepend the given extra code.</p>",
        "id": 500618808,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1739961930
    },
    {
        "content": "<p>That sounds like it would break people using <code>import</code> in that setting, though presumably that's not a worry for your case</p>",
        "id": 500619106,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1739962012
    },
    {
        "content": "<p>Yes, the hack is clearly  a hack that is not great. But it would allow this specific use case, without breaking anything for people not using it.</p>",
        "id": 500621170,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1739962674
    },
    {
        "content": "<p>Would it help you if it was easy to run your own instance of the service, with whatever projects added to the drop down? It would take a bit of setup (renting a server, running some deployment), although it could probably be made very simple.</p>",
        "id": 500657120,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1739973597
    },
    {
        "content": "<p>The big question is how big should the server be.</p>",
        "id": 500658508,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1739973918
    },
    {
        "content": "<p>I think it is very worthwhile to make it easy for people to setup such servers, including very clear instructions and explanation about the required resources.</p>",
        "id": 500658761,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1739973974
    },
    {
        "content": "<p>But I still think that supporting the above hack would be useful for many people who wouldn’t bother to setup their servers.</p>",
        "id": 500658857,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1739973999
    },
    {
        "content": "<p>Would being able to run your own server solve an immediate need of yours, or are you ok with the status quo for now?</p>",
        "id": 500661328,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1739974612
    },
    {
        "content": "<p>The hack described above would solve my immediate need and seems rather easy to implement.</p>",
        "id": 500662061,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1739974816
    },
    {
        "content": "<p>I should also say that “immediate” in “immediate need” means before Friday next week, not <em>today</em>.</p>",
        "id": 500662381,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1739974908
    },
    {
        "content": "<p>I don’t know if Jon feels like implementing hacks, though :-)</p>",
        "id": 500669109,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1739976730
    },
    {
        "content": "<p>I'm not sure how trivial this actually would be -- it looks like <a href=\"https://github.com/microsoft/monaco-editor/issues/45\">https://github.com/microsoft/monaco-editor/issues/45</a> is still open which seems like this functionality -- it references <code>setHiddenAreas</code> as being a private API for doing this in monaco (so it may indeed work, I was trying to just call it client-side, but I don't speak enough React to know where to get access to the <code>monaco</code> instance on the live site.</p>",
        "id": 500672887,
        "sender_full_name": "Julian Berman",
        "timestamp": 1739977666
    },
    {
        "content": "<p>The easiest \"hack\" right now would be that you just set up a Lean project with mathlib and all your content and either convince Joachim to copy that project to the FRO server tell me to load it to <a href=\"https://lean.math.hhu.de\">https://lean.math.hhu.de</a>. I'm happy to have the project added there</p>\n<p>I did this with <a href=\"https://github.com/JOSHCLUNE/DuperDemo\">DuperDemo</a></p>\n<p>Your students them still have to start the file with <code>import YourDemo</code>, but that might not be as confusing</p>",
        "id": 500842733,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1740046948
    },
    {
        "content": "<p>I know about this hack, but I still think it would be nice to have something everybody can use.</p>",
        "id": 500860192,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1740052571
    },
    {
        "content": "<p>For sure that would be nice! I'm just saying I'm unfortunately not going to be the person to implement anything like that anytime soon. </p>\n<p>And as a side-note, since the responsible people at the FRO seem to be pretty indifferent about making the VSCode-extension browser-compatible (see <a href=\"https://github.com/hhu-adam/vscode-lean4/pull/1\">tracking PR</a>), I'm currently pretty unmotivated to spend any time on updating lean4web, fixing or adding things. As long as running code snippets from Zulip using the latest Mathlib works, I'm pretty happy :)</p>",
        "id": 500913878,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1740067006
    },
    {
        "content": "<p>Now that we have the <code>nightly-testing-green</code> branch, which tracks the most recent commit on <code>nightly-testing</code> which passed CI, I would love to support Mathlib when using a nightly toolchain at live-lean.</p>\n<p>Can anyone give me a pointer to how to do this? Or would be interested in looking into it?</p>",
        "id": 537565668,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1756940868
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/270676-lean4/topic/Adding.20imports.20to.20live.20lean/near/537565668\">said</a>:</p>\n<blockquote>\n<p>Now that we have the <code>nightly-testing-green</code> branch, which tracks the most recent commit on <code>nightly-testing</code> which passed CI, I would love to support Mathlib when using a nightly toolchain at live-lean.</p>\n<p>Can anyone give me a pointer to how to do this? Or would be interested in looking into it?</p>\n</blockquote>\n<p>Do I understand correctly that you'd like to add a new \"project\" to <a href=\"http://live.lean-lang.org\">live.lean-lang.org</a> as server admin? Then you can directly follow these docs: <a href=\"https://github.com/leanprover-community/lean4web/tree/main/Projects\">Adding Projects to Lean4web</a></p>",
        "id": 537806555,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1757056313
    },
    {
        "content": "<p>(btw, you can see the changes \"live lean\" made compared to <code>main</code> here: <a href=\"https://github.com/leanprover-community/lean4web/pull/54/files\">\"live lean\" Tracking PR</a>)</p>",
        "id": 537807413,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1757056687
    },
    {
        "content": "<p>Could we add a feature to the web editor so that a magic comment like <code>-- lean4web: nightly</code> can override the project used? That way code snippets from Zulip could choose which project to use</p>",
        "id": 537823618,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757062569
    },
    {
        "content": "<p>Sounds reasonable. I think that would roughly go here:<br>\n<a href=\"https://github.com/leanprover-community/lean4web/blob/c876f4737cd0aa560c9a99c99940f3cbb85055a4/client/src/App.tsx#L73\">https://github.com/leanprover-community/lean4web/blob/c876f4737cd0aa560c9a99c99940f3cbb85055a4/client/src/App.tsx#L73</a></p>\n<p>just post-processing the content of <code>_code</code> and call <code>setProject</code>. Shouldn't be too hard</p>\n<p>(ideally also adding a test here: <a href=\"https://github.com/leanprover-community/lean4web/blob/main/cypress/e2e/spec.cy.ts\">https://github.com/leanprover-community/lean4web/blob/main/cypress/e2e/spec.cy.ts</a>)</p>\n<p>If you'd like to type that up, I'll happily merge it</p>",
        "id": 537936494,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1757101445
    }
]