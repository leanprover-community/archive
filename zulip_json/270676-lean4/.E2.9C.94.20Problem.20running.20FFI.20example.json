[
    {
        "content": "<p>I'm trying to get the FFI working so I can run C++'s <code>timespec_get</code> (for profiling purposes), but started running into \"Could not find native implementation of external declaration\" problems. In trying to diagnose the issue I extracted the ffi library example from the lean4 source tree into a new project, and ran into the problem again, this time <code>lean/Main.lean:6:0: Could not find native implementation of external declaration 'myAdd' (symbols 'l_\nmyAdd___boxed' or 'l_myAdd')</code>.</p>\n<p>To reproduce, clone <code>https://github.com/MichaelMMacLeod/ffi-example</code>, and, in an environment where <code>lake</code> exists, run <code>./test.sh</code>. Am I doing something incorrectly? Or is this a bug? BTW I am aware of some recent bug fixes to the FFI, however, updating to <code>leanprover/lean4-pr-releases:pr-release-8152</code> did not help. </p>\n<p>OS: <code>NixOS 24.11</code>,  <code>Lake version 5.0.0-src (Lean version 4.20.0, commit bd996935567266e7d04c91a813894b8ddaaaf60e)</code> installed via <code>elan 4.0.1</code>.</p>",
        "id": 516281765,
        "sender_full_name": "Michael MacLeod",
        "timestamp": 1746474047
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"730008\">Michael MacLeod</span> has marked this topic as resolved.</p>",
        "id": 516284341,
        "sender_full_name": "Notification Bot",
        "timestamp": 1746474972
    },
    {
        "content": "<p>Nevermind, it seems that I was just missing <code>precompileModules := true</code> in my <code>lean_lib</code> declaration. Not sure how I missed this one.</p>",
        "id": 516284419,
        "sender_full_name": "Michael MacLeod",
        "timestamp": 1746475009
    },
    {
        "content": "<p>Is there a particular reason you want timspec_get and not just <code>IO.monoNanosNow</code>?</p>",
        "id": 516284429,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1746475013
    },
    {
        "content": "<p>I was interested in getting wall clock time. Now that you mention it, however, I think that's probably not necessary, and that <code>IO.monoNanosNow</code> will probably be sufficient for what I'm doing. Thanks!</p>",
        "id": 516286285,
        "sender_full_name": "Michael MacLeod",
        "timestamp": 1746475589
    }
]