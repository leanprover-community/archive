[
    {
        "content": "<p>The whole <code>relaxedAutoImplicit</code> thing is new to me...</p>\n<p>Under what circumstances do I have to write them both into <code>lakefile.lean</code> in order to disable <em>all</em> autoimplicits? </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">moreServerOptions</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"bp\">⟨</span><span class=\"ss\">`autoImplicit</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">⟩</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"ss\">`relaxedAutoImplicit</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">⟩</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>For me, locally, <code>⟨`autoImplicit, false⟩</code> disables them all, but Mathlib has both settings written.</p>\n<p>Furthermore, if I want the same behavior in VS Code and in the command line, do I have to add these two as well?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">moreLeanArgs</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"s2\">\"-DautoImplicit=false\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"-DrelaxedAutoImplicit=false\"</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 456906542,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1722963094
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"417654\">Martin Dvořák</span> <a href=\"#narrow/stream/270676-lean4/topic/Disabling.20all.20autoimplicits/near/456906542\">said</a>:</p>\n<blockquote>\n<p>but Mathlib has both settings written.</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/blob/master/lakefile.lean#L6-L9\">But not using the spellings you suggest</a></p>",
        "id": 456906834,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722963169
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/blob/1d8b37341778bb9a6a042b2e1f261405291c345b/lakefile.lean#L8\">https://github.com/leanprover-community/mathlib4/blob/1d8b37341778bb9a6a042b2e1f261405291c345b/lakefile.lean#L8</a></p>",
        "id": 456906890,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1722963192
    },
    {
        "content": "<p>(edited, sorry)</p>",
        "id": 456906898,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722963198
    },
    {
        "content": "<p>You want <code>leanOptions</code> not those other spellings</p>",
        "id": 456906955,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722963227
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/270676-lean4/topic/Disabling.20all.20autoimplicits/near/456906834\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"417654\">Martin Dvořák</span> <a href=\"#narrow/stream/270676-lean4/topic/Disabling.20all.20autoimplicits/near/456906542\">said</a>:</p>\n<blockquote>\n<p>but Mathlib has both settings written.</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/blob/master/lakefile.lean#L6-L9\">But not using the spellings you suggest</a></p>\n</blockquote>\n<p>(edited, sorry) ah <code>leanOptions</code></p>\n<p>Does it set both <code>moreServerOptions</code> and <code>moreLeanArgs</code> with the same values?<br>\nI mean, does <code>leanOptions</code> specify both the behavior of VS Code and of <code>lake build</code> on the command line?</p>",
        "id": 456907431,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1722963388
    },
    {
        "content": "<p>And does it differ from setting <code>moreServerOptions</code> regarding whether both <code>autoImplicit</code> and <code>relaxedAutoImplicit</code> must be set to <code>false</code> to turn everything off?</p>",
        "id": 456908087,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1722963592
    },
    {
        "content": "<p><code>relaxedAutoImplicit</code> doesn't do anything unless <code>autoImplicit</code> is true</p>",
        "id": 456932388,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1722970999
    },
    {
        "content": "<p>Does it mean that<br>\n<a href=\"https://github.com/leanprover-community/mathlib4/blob/1d8b37341778bb9a6a042b2e1f261405291c345b/lakefile.lean#L9\">https://github.com/leanprover-community/mathlib4/blob/1d8b37341778bb9a6a042b2e1f261405291c345b/lakefile.lean#L9</a><br>\nis redundant?</p>",
        "id": 457025172,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1723013650
    },
    {
        "content": "<p>No, because people might turn on <code>autoImplicit</code> in a file. In those cases, you don't want <code>relaxedAutoImplicit</code> to be turned on as well</p>",
        "id": 457025362,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1723013733
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/stream/270676-lean4/topic/Disabling.20all.20autoimplicits/near/456932388\">said</a>:</p>\n<blockquote>\n<p><code>relaxedAutoImplicit</code> doesn't do anything unless <code>autoImplicit</code> is true</p>\n</blockquote>\n<p>Thank you!</p>",
        "id": 457025445,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1723013766
    },
    {
        "content": "<p>OK, to summarize...<br>\nInstead of writing the four things I originally mentioned, you can do</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">leanOptions</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"ss\">`autoImplicit</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">]</span>\n</code></pre></div>\n<p>alone and it is enough.<br>\nAs long as no options are set in individual files, all autoimplicits are disabled, both in VS Code and on the command line.<br>\nAm I right?</p>",
        "id": 457080756,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1723028885
    },
    {
        "content": "<p>I think you should write <code>leanOptions := #[⟨`autoImplicit, false⟩, ⟨`relaxedAutoImplicit, false⟩]</code> to play it safe.</p>",
        "id": 457085497,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1723030542
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"417654\">Martin Dvořák</span> has marked this topic as resolved.</p>",
        "id": 457086280,
        "sender_full_name": "Notification Bot",
        "timestamp": 1723030815
    },
    {
        "content": "<p>I have frequently hit the issue that setting <code>autoImplicit true</code> in mathlib is not sufficient to enable autoimplicits (e.g. when testing files provided by someone using the default settings), you also have to set <code>relaxedAutoImplicit true</code>. If <code>relaxedAutoImplicit</code> does nothing unless <code>autoImplicit</code> is true, perhaps the best approach then in mathlib is to set <code>autoImplicit false</code> and <code>relaxedAutoImplicit true</code> (or default), so that with the usual settings autoImplicits are disabled completely, and with <code>autoImplicit true</code> you get full autoimplicits, and we never have to worry about <code>relaxedAutoImplicit</code> (which is basically a failed experiment from mathlib's perspective)</p>",
        "id": 457221314,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1723072194
    },
    {
        "content": "<p>I think this is an excellent idea! If there aren't objections someone should make a PR.</p>",
        "id": 457236513,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723080076
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/15604\">#15604</a></p>",
        "id": 457250566,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1723086426
    }
]