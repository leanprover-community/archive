[
    {
        "content": "<p>We have <a href=\"https://lean-lang.org/doc/reference/latest///find/?domain=Verso.Genre.Manual.doc&amp;name=IO.currentDir\"><code>IO.currentDir</code></a> which returns the name of the current directory, but there seems to be no (native) way to let Lean return the current file name.</p>",
        "id": 529285258,
        "sender_full_name": "Michiel Huttener",
        "timestamp": 1752760582
    },
    {
        "content": "<p>That'd be a slightly funny kind of \"false friend\" naming for such a thing to me, as the two concepts are not terribly related (one is a thing which is related to any process on a machine, the other is some programming-language-specific concept which isn't always well defined). I agree that I did expect to find such a function somewhere just now, all the languages I know of have one, but amusingly it seems Haskell seems maybe to not have one either unless you're using template haskell?</p>",
        "id": 529290298,
        "sender_full_name": "Julian Berman",
        "timestamp": 1752761846
    },
    {
        "content": "<p>Isn't it <a href=\"https://lean-lang.org/doc/reference/latest/////IO/Files___-File-Handles___-and-Streams/#IO___appPath\"><code>IO.appPath</code></a>?</p>",
        "id": 529301557,
        "sender_full_name": "Arthur Paulino",
        "timestamp": 1752765066
    },
    {
        "content": "<p>If you have acceess to the <code>CoreM</code> monad you can access <code>Lean.Core.Context.fileName</code></p>",
        "id": 529302035,
        "sender_full_name": "Paul Lezeau",
        "timestamp": 1752765218
    },
    {
        "content": "<p>It makes senes for this to be in a \"meta\" monad rather than IO since the currently-processed file is a compile-time concern, not a runtime concern. (Assuming Paul's interpretation that \"current file name\" means the current Lean file is correct.)</p>",
        "id": 529303757,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752765722
    },
    {
        "content": "<p>Aha I see! Thanks for the clarification.</p>\n<p>For completeness, a MWE that shows the differences. (Fun to see in the web editor as well!)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">IO</span>\n\n<span class=\"w\"> </span><span class=\"c1\">-- IO</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">currentDir</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">appDir</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">appPath</span>\n\n<span class=\"c1\">-- very meta</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">getFileName</span>\n</code></pre></div>",
        "id": 529308917,
        "sender_full_name": "Michiel Huttener",
        "timestamp": 1752767311
    },
    {
        "content": "<p><del>Oh wait, the <code>getFileName</code> above is <code>Lean.MonadLog.getFileName</code> and has nothing to do with <code>Lean.Core.Context.fileName</code>, and I don't see how one can get the context in CoreM.</del><br>\nNevermind: <a href=\"https://leanprover-community.github.io/con-nf/doc/Lean/CoreM.html#Lean.Core.instMonadLogCoreM\">there is an instance</a></p>",
        "id": 529568919,
        "sender_full_name": "Michiel Huttener",
        "timestamp": 1752922966
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"451983\">Arthur Paulino</span> <a href=\"#narrow/stream/270676-lean4/topic/Why.20does.20.60IO.2EcurrentFile.60.20not.20exist.3F/near/529301557\">said</a>:</p>\n<blockquote>\n<p>Isn't it <a href=\"https://lean-lang.org/doc/reference/latest/////IO/Files___-File-Handles___-and-Streams/#IO___appPath\"><code>IO.appPath</code></a>?</p>\n</blockquote>\n<p>Arguably it's <code>argv[0]</code>, but Lean only passes <code>argv[1:]</code> to <code>def main</code> (<a href=\"https://github.com/leanprover/lean4/pull/5819\">lean4#5819</a>)</p>",
        "id": 529582609,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1752938091
    },
    {
        "content": "<p>If you want <code>argv[0]</code> and have a recent Lean you can use  <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Std.Internal.IO.Process.getExecutablePath#doc\">docs#Std.Internal.IO.Process.getExecutablePath</a> (it will move out of <code>Internal</code> later this year). I don't know whether this ever returns something different from <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IO.appPath#doc\">docs#IO.appPath</a>.</p>",
        "id": 529663080,
        "sender_full_name": "Markus Himmel",
        "timestamp": 1753001311
    },
    {
        "content": "<p>I guess the test is what <code>exec -a secret_name ./lake/build/bin/foo</code> does, which appPath didn't previous respect</p>",
        "id": 529703064,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1753033737
    }
]