[
    {
        "content": "<p>I want this</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"n\">goal</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">  </span><span class=\"n\">tactic1</span>\n<span class=\"w\">  </span><span class=\"n\">tactic2</span>\n<span class=\"w\">  </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>to expand like this</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">tactic1</span>\n<span class=\"n\">tactic2</span>\n<span class=\"bp\">...</span>\n<span class=\"k\">show</span><span class=\"w\"> </span><span class=\"n\">goal</span>\n</code></pre></div>\n<p>So I tried to implement the tactic:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">macro</span><span class=\"w\"> </span><span class=\"s2\">\"show \"</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"s2\">\" =&gt; \"</span><span class=\"w\"> </span><span class=\"n\">ts</span><span class=\"o\">:</span><span class=\"n\">tacticSeq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">ts</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">e</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Unfortunately, this does not work:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">application</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span>\n<span class=\"w\">  </span><span class=\"n\">ts</span><span class=\"bp\">.</span><span class=\"n\">raw</span>\n<span class=\"n\">argument</span>\n<span class=\"w\">  </span><span class=\"n\">ts</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">TSyntax</span><span class=\"w\"> </span><span class=\"ss\">`Lean.Parser.Tactic.tacticSeq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">TSyntax</span><span class=\"w\"> </span><span class=\"ss\">`tactic</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n</code></pre></div>\n<p>How to implement this tactic?</p>",
        "id": 503768900,
        "sender_full_name": "suhr",
        "timestamp": 1741260655
    },
    {
        "content": "<p>Does it work if you use <code>(tacticSeq|</code>?</p>",
        "id": 503773032,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1741261932
    },
    {
        "content": "<p>Otherwise, adding and extra set of round parentheses surrounding the tactics is a possible thing to try.</p>",
        "id": 503773194,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1741261983
    },
    {
        "content": "<p><code>macro \"show \" e:term \" =&gt; \" ts:tacticSeq : tactic =&gt; `(tactic| (($ts); show $e))</code></p>",
        "id": 503776606,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741262975
    },
    {
        "content": "<p>So what's needed is just a couple of parenthesis... but why?</p>",
        "id": 503777479,
        "sender_full_name": "suhr",
        "timestamp": 1741263243
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Parser.Tactic.paren#doc\">docs#Lean.Parser.Tactic.paren</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Elab.Tactic.evalParen#doc\">docs#Lean.Elab.Tactic.evalParen</a><br>\nBasically, the parentheses turn a <code>tacticSeq</code> into a <code>tactic</code>.</p>",
        "id": 503778561,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741263602
    },
    {
        "content": "<p>I see, thanks. By the way, what would be a good name for this tactic? I think of <code>suffices: goal =&gt; ...</code>, but it might be confusing since usual <code>suffices</code> is proved in a different way.</p>",
        "id": 503779478,
        "sender_full_name": "suhr",
        "timestamp": 1741263901
    }
]