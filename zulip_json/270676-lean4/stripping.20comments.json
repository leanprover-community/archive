[
    {
        "content": "<p>I would like a function that \"reads\" a string and removes all comments from it, optionally with an extra bit of processing trailing/leading whitespaces.  Does it exist?</p>\n<p>Here is a sample of what I would like it to do.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">stripComments</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">s</span>\n\n<span class=\"c\">/-</span><span class=\"cm\">  I would like `stripComments to have the following input-output pairs: -/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard</span><span class=\"w\"> </span><span class=\"n\">stripComments</span><span class=\"w\">  </span><span class=\"s2\">\"text /- I am a comment -/ more text\"</span><span class=\"w\"> </span><span class=\"bp\">==</span>\n<span class=\"w\">                      </span><span class=\"s2\">\"text more text\"</span>\n<span class=\"bp\">#</span><span class=\"n\">guard</span><span class=\"w\"> </span><span class=\"n\">stripComments</span><span class=\"w\">  </span><span class=\"s2\">\"text /- I am a comment -/   more text\"</span><span class=\"w\"> </span><span class=\"bp\">==</span>\n<span class=\"w\">                      </span><span class=\"s2\">\"text more text\"</span>\n<span class=\"bp\">#</span><span class=\"n\">guard</span><span class=\"w\"> </span><span class=\"n\">stripComments</span><span class=\"w\">  </span><span class=\"s2\">\"text -- /- I am a comment -/   more text\"</span><span class=\"w\"> </span><span class=\"bp\">==</span>\n<span class=\"w\">                      </span><span class=\"s2\">\"text \"</span><span class=\"w\"> </span><span class=\"c1\">-- bonus if it removes the space after `text`</span>\n<span class=\"bp\">#</span><span class=\"n\">guard</span><span class=\"w\"> </span><span class=\"n\">stripComments</span><span class=\"w\">  </span><span class=\"s2\">\"text /- comment /- nested -/-/\"</span><span class=\"w\"> </span><span class=\"bp\">==</span>\n<span class=\"w\">                      </span><span class=\"s2\">\"text\"</span><span class=\"w\"> </span><span class=\"c1\">-- but ok if it ignores nesting</span>\n<span class=\"bp\">#</span><span class=\"n\">guard</span><span class=\"w\"> </span><span class=\"n\">stripComments</span><span class=\"w\">  </span><span class=\"s2\">\"text /-- doc-string -/\"</span><span class=\"w\"> </span><span class=\"bp\">==</span>\n<span class=\"w\">                      </span><span class=\"s2\">\"text /-- doc-string -/\"</span>\n</code></pre></div>",
        "id": 505067224,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1741770016
    },
    {
        "content": "<p>In case anyone else finds this useful, here is an implementation of the above.  It is not nesting aware and \"trims right\", instead of left, but seems to work well on mathlib.</p>",
        "id": 505418670,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1741871848
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/--</span>\n<span class=\"sd\">Returns the pair consisting of</span>\n<span class=\"sd\">* longest initial segment of `s` that does not contain `pattern` as a substring;</span>\n<span class=\"sd\">* the rest of the string `s`.</span>\n\n<span class=\"sd\">In particular, concatenating the two factors yields `s`.</span>\n<span class=\"sd\">-/</span>\n<span class=\"n\">partial</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">findString</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">pattern</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">pattern</span><span class=\"bp\">.</span><span class=\"n\">isEmpty</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">pattern</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">else</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">pattern</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">pattern</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">else</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">candidatePos</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">find</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"s2\">\"\"</span><span class=\"bp\">.</span><span class=\"n\">push</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">==</span><span class=\"w\"> </span><span class=\"n\">pattern</span><span class=\"bp\">.</span><span class=\"n\">take</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">notContains</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">toSubstring</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">stopPos</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">candidatePos</span><span class=\"o\">}</span><span class=\"bp\">.</span><span class=\"n\">toString</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">rest</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">toSubstring</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">startPos</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">candidatePos</span><span class=\"o\">}</span><span class=\"bp\">.</span><span class=\"n\">toString</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">rest</span><span class=\"bp\">.</span><span class=\"n\">startsWith</span><span class=\"w\"> </span><span class=\"n\">pattern</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">notContains</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rest</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">else</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">init</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">tail</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">findString</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rest</span><span class=\"bp\">.</span><span class=\"n\">drop</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">pattern</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">notContains</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">pattern</span><span class=\"bp\">.</span><span class=\"n\">take</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">tail</span><span class=\"o\">)</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">`trimComments s` eliminates comments from `s`, disregarding nesting.</span>\n\n<span class=\"sd\">If `compressDocs` is `true`, then it also compresses doc-strings that might be present in `s`,</span>\n<span class=\"sd\">by collapsing consecutive sequences of at least one space into a single space.</span>\n<span class=\"sd\">-/</span>\n<span class=\"n\">partial</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">trimComments</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">compressDocs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"k\">else</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">beforeFirstDash</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rest</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">findString</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"s2\">\"-\"</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">rest</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"k\">else</span>\n<span class=\"w\">  </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">beforeFirstDash</span><span class=\"bp\">.</span><span class=\"n\">takeRight</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rest</span><span class=\"bp\">.</span><span class=\"n\">take</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">drop</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"s2\">\"/\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"-\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"c1\">-- this is a doc-string</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">takeDocs</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rest</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">findString</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rest</span><span class=\"bp\">.</span><span class=\"n\">drop</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"s2\">\"-/\"</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">finalDocs</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">      </span><span class=\"c1\">-- Replace each consecutive group of at least one space in `takeDocs` with a single space.</span>\n<span class=\"w\">      </span><span class=\"c1\">-- The begin/end `|`-markers take care of preserving initial and terminal spaces, if there</span>\n<span class=\"w\">      </span><span class=\"c1\">-- are any.  We remove them in the next step.</span>\n<span class=\"w\">      </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">compressDocs</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">        </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">intermediate</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"s2\">\"|\"</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">takeDocs</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"s2\">\"|\"</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">splitOn</span><span class=\"w\"> </span><span class=\"s2\">\" \"</span><span class=\"w\"> </span><span class=\"bp\">|&gt;.</span><span class=\"n\">filter</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">!·.</span><span class=\"n\">isEmpty</span><span class=\"o\">)</span>\n<span class=\"w\">        </span><span class=\"s2\">\" \"</span><span class=\"bp\">.</span><span class=\"n\">intercalate</span><span class=\"w\"> </span><span class=\"n\">intermediate</span><span class=\"w\"> </span><span class=\"bp\">|&gt;.</span><span class=\"n\">drop</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">|&gt;.</span><span class=\"n\">dropRight</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">      </span><span class=\"k\">else</span>\n<span class=\"w\">        </span><span class=\"n\">takeDocs</span>\n<span class=\"w\">    </span><span class=\"n\">beforeFirstDash</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"s2\">\"--\"</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">finalDocs</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">trimComments</span><span class=\"w\"> </span><span class=\"n\">rest</span><span class=\"w\"> </span><span class=\"n\">compressDocs</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"s2\">\"/\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"c1\">-- this is a multiline comment</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"n\">comment</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rest</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">findString</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rest</span><span class=\"bp\">.</span><span class=\"n\">drop</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"s2\">\"-/\"</span>\n<span class=\"w\">    </span><span class=\"c1\">--let rest := if rest.startsWith \"-/\" then rest.drop 2 else rest</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">beforeFirstDash</span><span class=\"bp\">.</span><span class=\"n\">dropRight</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trimRight</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">trimComments</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rest</span><span class=\"bp\">.</span><span class=\"n\">drop</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">compressDocs</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"-\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"c1\">-- this is a single line comment</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">dropComment</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rest</span><span class=\"bp\">.</span><span class=\"n\">dropWhile</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">!=</span><span class=\"w\"> </span><span class=\"bp\">'\\</span><span class=\"n\">n'</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">beforeFirstDash</span><span class=\"bp\">.</span><span class=\"n\">trimRight</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">trimComments</span><span class=\"w\"> </span><span class=\"n\">dropComment</span><span class=\"w\"> </span><span class=\"n\">compressDocs</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">beforeFirstDash</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"s2\">\"-\"</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">trimComments</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rest</span><span class=\"bp\">.</span><span class=\"n\">drop</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">compressDocs</span>\n\n<span class=\"c\">/-</span><span class=\"cm\">  I would like `trimComments to have the following input-output pairs: -/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard</span><span class=\"w\"> </span><span class=\"n\">trimComments</span><span class=\"w\">  </span><span class=\"s2\">\"text /- I am a comment -/ more text\"</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"bp\">==</span>\n<span class=\"w\">                      </span><span class=\"s2\">\"text more text\"</span>\n<span class=\"bp\">#</span><span class=\"n\">guard</span><span class=\"w\"> </span><span class=\"n\">trimComments</span><span class=\"w\">  </span><span class=\"s2\">\"text /- I am a comment -/   more text\"</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"bp\">==</span>\n<span class=\"w\">                      </span><span class=\"s2\">\"text   more text\"</span>\n<span class=\"bp\">#</span><span class=\"n\">guard</span><span class=\"w\"> </span><span class=\"n\">trimComments</span><span class=\"w\">  </span><span class=\"s2\">\"text -- /- I am a comment -/   more text\"</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"bp\">==</span>\n<span class=\"w\">                      </span><span class=\"s2\">\"text\"</span><span class=\"w\"> </span><span class=\"c1\">-- bonus if it removes the space after `text`</span>\n<span class=\"bp\">#</span><span class=\"n\">guard</span><span class=\"w\"> </span><span class=\"n\">trimComments</span><span class=\"w\">  </span><span class=\"s2\">\"text /- comment /- nested -/-/\"</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"bp\">==</span>\n<span class=\"w\">                      </span><span class=\"s2\">\"text-/\"</span><span class=\"w\"> </span><span class=\"c1\">-- it ignores nesting</span>\n<span class=\"bp\">#</span><span class=\"n\">guard</span><span class=\"w\"> </span><span class=\"n\">trimComments</span><span class=\"w\">  </span><span class=\"s2\">\"text /-- doc-string -/\"</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"bp\">==</span>\n<span class=\"w\">                      </span><span class=\"s2\">\"text /-- doc-string -/\"</span>\n</code></pre></div>",
        "id": 505418680,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1741871851
    },
    {
        "content": "<p>What's the motivation here?</p>",
        "id": 505423656,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1741873040
    },
    {
        "content": "<p>The linter for whitespace trimming.</p>",
        "id": 505423720,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1741873060
    },
    {
        "content": "<p>The pretty-printer erases comments, but the linter compares the surface syntax to the pretty-printed one.</p>",
        "id": 505423859,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1741873092
    },
    {
        "content": "<p>So, in order to get some comparison, I thought of pre-processing the user syntax by removing the comments.</p>",
        "id": 505423962,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1741873119
    },
    {
        "content": "<p>It then turns out that the pretty-printer also does weird reformatting of the doc-strings, but that was easy to \"fix\" once I had the code above.</p>",
        "id": 505424090,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1741873153
    },
    {
        "content": "<p>As a consequence, the linter is now seeing a lot of extra violations that before were hidden by declarations that had a doc-string/comment and the linter ignored.</p>",
        "id": 505424207,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1741873182
    },
    {
        "content": "<p>Do you consider using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Std.Internal.Parsec.String.Parser#doc\">docs#Std.Internal.Parsec.String.Parser</a> ?</p>",
        "id": 505457302,
        "sender_full_name": "Jz Pan",
        "timestamp": 1741880421
    },
    {
        "content": "<p>I am not really sure how to do that...</p>",
        "id": 505463994,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1741881878
    }
]