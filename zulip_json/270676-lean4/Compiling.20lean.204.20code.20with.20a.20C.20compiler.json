[
    {
        "content": "<p>Any ideas or opinions on how to compile a lean file in C?</p>",
        "id": 456918909,
        "sender_full_name": "Oscar Matemb ⚛️",
        "timestamp": 1722966864
    },
    {
        "content": "<p>When you declare a <code>lean_exe</code> in your <code>lakefile.lean</code>, you get this automatically</p>",
        "id": 456919001,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722966906
    },
    {
        "content": "<p>Thank you. Could you show a working example?</p>",
        "id": 456919243,
        "sender_full_name": "Oscar Matemb ⚛️",
        "timestamp": 1722966976
    },
    {
        "content": "<p>I think the template package that <code>lake</code> creates has one</p>",
        "id": 456919324,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722966999
    },
    {
        "content": "<p>But also, your question is a little unclear (unless you really meant \"why doesn't <code>gcc my_file.lean</code> work\"), and the gaps I'm filling in might not be what you meant to ask.</p>",
        "id": 456919445,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722967048
    },
    {
        "content": "<p>Yes, I am not sure on how to get it to compile with GCC, if you have some documentation or instructions on how I could get it done</p>",
        "id": 456919722,
        "sender_full_name": "Oscar Matemb ⚛️",
        "timestamp": 1722967135
    },
    {
        "content": "<p>Use the <code>lake</code> build system, everything apart from lake has zero stability guarantees in the future. If you really want to you can run <code>lake build --verbose</code> to see the commands that it runs to compile a Lean file.</p>",
        "id": 456920938,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1722967372
    },
    {
        "content": "<p>It doesn't seem to work for some reason on my end</p>",
        "id": 456923610,
        "sender_full_name": "Oscar Matemb ⚛️",
        "timestamp": 1722967968
    },
    {
        "content": "<p>You'll need to tell us exactly what you did on your end and exactly what error it produced for us to help</p>",
        "id": 456924189,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722968156
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">include</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"n\">stdio</span><span class=\"bp\">.</span><span class=\"n\">h</span><span class=\"bp\">&gt;</span>\n<span class=\"bp\">#</span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">defined</span><span class=\"o\">(</span><span class=\"bp\">__</span><span class=\"n\">clang__</span><span class=\"o\">)</span>\n<span class=\"bp\">#</span><span class=\"n\">pragma</span><span class=\"w\"> </span><span class=\"n\">clang</span><span class=\"w\"> </span><span class=\"n\">diagnostic</span><span class=\"w\"> </span><span class=\"n\">ignored</span><span class=\"w\"> </span><span class=\"s2\">\"-Wunused-parameter\"</span>\n<span class=\"bp\">#</span><span class=\"n\">pragma</span><span class=\"w\"> </span><span class=\"n\">clang</span><span class=\"w\"> </span><span class=\"n\">diagnostic</span><span class=\"w\"> </span><span class=\"n\">ignored</span><span class=\"w\"> </span><span class=\"s2\">\"-Wunused-label\"</span>\n<span class=\"bp\">#</span><span class=\"n\">elif</span><span class=\"w\"> </span><span class=\"n\">defined</span><span class=\"o\">(</span><span class=\"bp\">__</span><span class=\"n\">GNUC__</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"n\">defined</span><span class=\"o\">(</span><span class=\"bp\">__</span><span class=\"n\">CLANG__</span><span class=\"o\">)</span>\n<span class=\"bp\">#</span><span class=\"n\">pragma</span><span class=\"w\"> </span><span class=\"n\">GCC</span><span class=\"w\"> </span><span class=\"n\">diagnostic</span><span class=\"w\"> </span><span class=\"n\">ignored</span><span class=\"w\"> </span><span class=\"s2\">\"-Wunused-parameter\"</span>\n<span class=\"bp\">#</span><span class=\"n\">pragma</span><span class=\"w\"> </span><span class=\"n\">GCC</span><span class=\"w\"> </span><span class=\"n\">diagnostic</span><span class=\"w\"> </span><span class=\"n\">ignored</span><span class=\"w\"> </span><span class=\"s2\">\"-Wunused-label\"</span>\n<span class=\"bp\">#</span><span class=\"n\">pragma</span><span class=\"w\"> </span><span class=\"n\">GCC</span><span class=\"w\"> </span><span class=\"n\">diagnostic</span><span class=\"w\"> </span><span class=\"n\">ignored</span><span class=\"w\"> </span><span class=\"s2\">\"-Wunused-but-set-variable\"</span>\n<span class=\"bp\">#</span><span class=\"n\">endif</span>\n<span class=\"bp\">#</span><span class=\"n\">ifdef</span><span class=\"w\"> </span><span class=\"bp\">__</span><span class=\"n\">cplusplus</span>\n<span class=\"n\">extern</span><span class=\"w\"> </span><span class=\"s2\">\"C\"</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"bp\">#</span><span class=\"n\">endif</span>\n\n<span class=\"bp\">#</span><span class=\"n\">include</span><span class=\"w\"> </span><span class=\"s2\">\"lean/lean.h\"</span><span class=\"w\">  </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">Include</span><span class=\"w\"> </span><span class=\"n\">Lean's</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">API</span>\n\n<span class=\"n\">static</span><span class=\"w\"> </span><span class=\"n\">bool</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">G_initialized</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">;</span>\n\n<span class=\"n\">LEAN_EXPORT</span><span class=\"w\"> </span><span class=\"n\">lean_object</span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">initialize_Untitled</span><span class=\"o\">(</span><span class=\"n\">uint8_t</span><span class=\"w\"> </span><span class=\"n\">builtin</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">lean_object</span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"n\">lean_object</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">res</span><span class=\"bp\">;</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"n\">G_initialized</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"n\">lean_io_result_mk_ok</span><span class=\"o\">(</span><span class=\"n\">lean_box</span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">))</span><span class=\"bp\">;</span>\n<span class=\"w\">    </span><span class=\"bp\">_</span><span class=\"n\">G_initialized</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"bp\">;</span>\n\n<span class=\"w\">    </span><span class=\"n\">res</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">initialize_Init</span><span class=\"o\">(</span><span class=\"n\">builtin</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">lean_io_mk_world</span><span class=\"o\">())</span><span class=\"bp\">;</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">lean_io_result_is_error</span><span class=\"o\">(</span><span class=\"n\">res</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"n\">res</span><span class=\"bp\">;</span>\n<span class=\"w\">    </span><span class=\"n\">lean_dec_ref</span><span class=\"o\">(</span><span class=\"n\">res</span><span class=\"o\">)</span><span class=\"bp\">;</span><span class=\"w\">  </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">Decrement</span><span class=\"w\"> </span><span class=\"n\">reference</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">avoid</span><span class=\"w\"> </span><span class=\"n\">memory</span><span class=\"w\"> </span><span class=\"n\">leak</span>\n\n<span class=\"w\">    </span><span class=\"n\">res</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">initialize_Untitled_Basic</span><span class=\"o\">(</span><span class=\"n\">builtin</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">lean_io_mk_world</span><span class=\"o\">())</span><span class=\"bp\">;</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">lean_io_result_is_error</span><span class=\"o\">(</span><span class=\"n\">res</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"n\">res</span><span class=\"bp\">;</span>\n<span class=\"w\">    </span><span class=\"n\">lean_dec_ref</span><span class=\"o\">(</span><span class=\"n\">res</span><span class=\"o\">)</span><span class=\"bp\">;</span><span class=\"w\">  </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">Decrement</span><span class=\"w\"> </span><span class=\"n\">reference</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">avoid</span><span class=\"w\"> </span><span class=\"n\">memory</span><span class=\"w\"> </span><span class=\"n\">leak</span>\n\n<span class=\"w\">    </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"n\">lean_io_result_mk_ok</span><span class=\"o\">(</span><span class=\"n\">lean_box</span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">))</span><span class=\"bp\">;</span>\n<span class=\"o\">}</span>\n\n<span class=\"bp\">#</span><span class=\"n\">ifdef</span><span class=\"w\"> </span><span class=\"bp\">__</span><span class=\"n\">cplusplus</span>\n<span class=\"o\">}</span>\n<span class=\"bp\">#</span><span class=\"n\">endif</span>\n</code></pre></div>",
        "id": 456929742,
        "sender_full_name": "Oscar Matemb ⚛️",
        "timestamp": 1722970009
    },
    {
        "content": "<p>I am not sure if it is a configuration issue, ' #include \"lean/lean.h' throws an error</p>",
        "id": 456929771,
        "sender_full_name": "Oscar Matemb ⚛️",
        "timestamp": 1722970024
    },
    {
        "content": "<p>I messed around with this, I think you mean compiling files from <code>.lake/build/ir</code> with a c compiler. You need to pass in <code>-I</code> for includes and a path to lean.h, for one. But even that doesn't go all the way thru--- I lost interest before finalizing</p>",
        "id": 459534821,
        "sender_full_name": "Quinn",
        "timestamp": 1723225218
    },
    {
        "content": "<p>Yes, thanks for insight. I’m still trying to configure the path. I’ll keep this chat updated if any one else comes up with a solution. So far no avail.</p>",
        "id": 459536268,
        "sender_full_name": "Oscar Matemb ⚛️",
        "timestamp": 1723225717
    },
    {
        "content": "<p>Oscar, you still haven't said what it is that you are doing.</p>",
        "id": 459610139,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1723254596
    },
    {
        "content": "<p>Use <code>lake env</code> to configure the path automatically.</p>",
        "id": 459611840,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1723255438
    }
]