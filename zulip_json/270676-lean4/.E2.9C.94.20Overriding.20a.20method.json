[
    {
        "content": "<p>Hi,<br>\nIs it possible to somehow override an existing method in Lean 4, forcing all calls to this method to instead use the new method? Or maybe intercepting calls to this method?<br>\nMotivation: backporting a change to previous Lean versions for the Lean REPL<br>\nThe change is made in this <a href=\"https://github.com/leanprover/lean4/pull/5998/files\">PR</a> in the <code>Lean/Elab/Term.lean</code> file:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mkAuxName</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">suffix</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Name</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">TermElabM</span><span class=\"w\"> </span><span class=\"n\">Name</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">read</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">declName?</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"bp\">-</span><span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"w\">          </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">throwError</span><span class=\"w\"> </span><span class=\"s2\">\"auxiliary declaration cannot be created when declaration name is not available\"</span>\n<span class=\"bp\">+</span><span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"w\">          </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">mkAuxName</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mkPrivateName</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">getEnv</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"ss\">`aux</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">   </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">declName</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">mkAuxName</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">declName</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">suffix</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>",
        "id": 514345597,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1745576736
    },
    {
        "content": "<p>I think not, at least not practically. Compiling a custom Lean is the only reliable way I know to make such a change. (E.g. this function might be inclined, in which case you would have to update many functions in the binary.)</p>\n<p>Perhaps instead it would be better to set a declname when elaborating in REPL?</p>",
        "id": 514356870,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1745580617
    },
    {
        "content": "<p>Thanks for the clarification!</p>\n<blockquote>\n<p>Perhaps instead it would be better to set a declname when elaborating in REPL?</p>\n</blockquote>\n<p>Turns out I may have found a workaround using exactly the same idea. Putting a link <a href=\"https://github.com/leanprover-community/repl/issues/44#issuecomment-2830090866\">here</a> in case someone is interested in this in the future.</p>",
        "id": 514357555,
        "sender_full_name": "Auguste Poiroux",
        "timestamp": 1745580820
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321854\">Auguste Poiroux</span> has marked this topic as resolved.</p>",
        "id": 514357880,
        "sender_full_name": "Notification Bot",
        "timestamp": 1745580927
    }
]