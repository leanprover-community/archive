[
    {
        "content": "<p>Consider the following code:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">congr</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>This doesn't compile (on 4.15.0-rc1) since congr creates a duplicate goal.<br>\nIf I change it to congr 1 then it compiles correctly.<br>\nWhat is going on here?</p>",
        "id": 490877061,
        "sender_full_name": "Yuval Filmus",
        "timestamp": 1735218779
    },
    {
        "content": "<p>It's going deep into the OfNat expression. You can get a hint of what's going on by doing <code>congr 2</code> (<code>congr 3</code> is what <code>congr</code> itself does).</p>\n<p>The Mathlib <code>congr!</code> tactic avoids this issue.</p>",
        "id": 490916043,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1735246768
    },
    {
        "content": "<p>(In any case, there's no problem with <code>congr</code> creating duplicate goals. That just means you have to prove the goal multiple times.)</p>",
        "id": 490916791,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1735247349
    }
]