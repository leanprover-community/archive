[
    {
        "content": "<p>Has anyone ever come across a situation where <code>rw</code> creates a metavariable, but no corresponding goal to fill it in? I have no <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> yet (in the middle of a long argument). In my case, the metavariable corresponds to a missing proof. </p>\n<p>The funny thing is, the proof still compiles with no errors. I think that's because the expression with the metavariable (let's call it <code>foo ?m.123</code>) is later used to match a goal <code>foo pf</code> where the <code>pf</code> is an actual proof, so Lean realizes it can fill in the metavariable with <code>pf</code>. But this doesn't explain the initial behavior, since there's no way Lean could have known that <code>foo</code> would be used in this way.</p>",
        "id": 449565053,
        "sender_full_name": "Ted Hwa",
        "timestamp": 1720303205
    },
    {
        "content": "<p>Lean can sometimes fill in proof metavariables by e.g. typeclass inference or finding them in the local context.</p>",
        "id": 449566409,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1720304044
    },
    {
        "content": "<p>rw doesn't create goals.</p>",
        "id": 449567565,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1720304343
    },
    {
        "content": "<p>Oh sure it does</p>",
        "id": 449567630,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1720304364
    },
    {
        "content": "<p>It creates mvars, but not goals surely? Not ones it can't fill</p>",
        "id": 449567705,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1720304390
    },
    {
        "content": "<p>Oh I don't know the difference between a metavariable and a goal</p>",
        "id": 449567809,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1720304411
    },
    {
        "content": "<p>A tactic could create a hole metavariable that it fills by looking for theorems or hypotheses</p>",
        "id": 449568108,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1720304507
    },
    {
        "content": "<p>All I'm saying is that if <code>h : P -&gt; (A = B)</code> then <code>rw [h]</code> might create a new goal P if the original goal is A</p>",
        "id": 449568469,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1720304599
    },
    {
        "content": "<p><code>rw</code> definitely creates additional goals for the mvars it can't fill.</p>",
        "id": 449568549,
        "sender_full_name": "Ted Hwa",
        "timestamp": 1720304626
    },
    {
        "content": "<p>Never seen it happen. In fact I have had rw fail when it can't find some typeclass instance or argument which it could have thrown as a goal.</p>",
        "id": 449568719,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1720304671
    },
    {
        "content": "<p>But okay. TIL. Is there an example of this?</p>",
        "id": 449568764,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1720304685
    },
    {
        "content": "<p>If it found them in the local context, shouldn't the value (or at least <code>...</code> for a proof) show up in the infoview?  Right now I see <code>foo ?m.123</code> in the infoview.</p>",
        "id": 449568826,
        "sender_full_name": "Ted Hwa",
        "timestamp": 1720304749
    },
    {
        "content": "<p>You could use extract_goal to help construct an mwe</p>",
        "id": 449568901,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1720304800
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"c1\">-- two goals B=0 and P</span>\n</code></pre></div>",
        "id": 449568916,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1720304822
    }
]