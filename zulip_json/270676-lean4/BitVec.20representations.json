[
    {
        "content": "<p>I am trying to understand the BitVec type. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">b0010010</span><span class=\"w\"> </span><span class=\"c1\">-- 18</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">b0010010</span><span class=\"w\"> </span><span class=\"bp\">|&gt;.</span><span class=\"n\">toDigits</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">base</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- ['1', '0', '0', '1', '0']</span>\n</code></pre></div>\n<p>Is there a more straightforward way to represent <code>0b0010010</code> or <code>18</code> as <code>0b0010010</code>? The literal <code>0b...</code> preserving the leading zeros?</p>",
        "id": 520062708,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1748009251
    },
    {
        "content": "<p>i'd just like to point out that the code you're using here are <em>not</em> automatically <code>BitVec</code>s, they are just a different way to write number literals. In this case, just like writing <code>18</code> without type ascriptions, they will be interpreted as <code>Nat</code>.</p>",
        "id": 520064368,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1748009763
    },
    {
        "content": "<p>in order to get something different, try <code>(0b0010010 : BitVec 8)</code></p>",
        "id": 520064462,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1748009791
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"684366\">@Edward van de Meent</span> , I got your point. Indeed, if I use <code>#eval (0b0010010 : BitVec 8)</code> I will get back <code>0x12#8</code> (hexadecimal representation) but I would like to have same literal <code>0b0010010</code> printed. </p>\n<p>To give more context:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">zones</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"mi\">1</span><span class=\"o\">]</span>\n\n<span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">zoneMask</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">zone</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BitVec</span><span class=\"w\"> </span><span class=\"mi\">16</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">as.zipIdx.foldl</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">Î»</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">zone</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">      </span><span class=\"n\">bv</span><span class=\"w\"> </span><span class=\"bp\">|||</span><span class=\"w\"> </span><span class=\"n\">BitVec.ofNat</span><span class=\"w\"> </span><span class=\"mi\">16</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">&lt;&lt;&lt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">15</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"o\">))</span>\n<span class=\"w\">     </span><span class=\"k\">else</span>\n<span class=\"w\">      </span><span class=\"n\">bv</span>\n<span class=\"w\">  </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BitVec</span><span class=\"w\"> </span><span class=\"mi\">16</span><span class=\"o\">)</span>\n\n<span class=\"k\">#eval</span><span class=\"w\"> </span><span class=\"n\">zoneMask</span><span class=\"w\"> </span><span class=\"n\">zones</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">|&gt;.</span><span class=\"n\">toNat.toDigits</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">base</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- ['1', '1', '0', '0', '1', '0', '1', '0']</span>\n</code></pre></div>\n<p>It would be nice to have back <code>0b0000000011001010</code> so that the 1's are in the same positions as the zeros in the zones array. I understand that the leading zeros can be challenging to preserve in the canonical representation of a literal in binary notation...  So maybe I need my own alternative to <code>toDigits</code>?</p>",
        "id": 520066229,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1748010322
    },
    {
        "content": "<p>yes, i think so... here's the best i could come up with:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">BitVec</span><span class=\"bp\">.</span><span class=\"n\">toBinary</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BitVec</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">v</span><span class=\"bp\">.</span><span class=\"n\">toFin</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"bp\">.</span><span class=\"n\">toDigits</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">base</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">leftpad</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"mi\">0</span><span class=\"bp\">'</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 520068006,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1748010857
    },
    {
        "content": "<p>you could probably use that to make a local higher priority instance of <code>Repr (BitVec n)</code></p>",
        "id": 520068172,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1748010916
    },
    {
        "content": "<p>Thank you</p>",
        "id": 520115722,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1748027983
    }
]