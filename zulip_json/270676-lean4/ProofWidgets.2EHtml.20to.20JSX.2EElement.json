[
    {
        "content": "<p>I am working on a widget/component which takes a prop of type <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ProofWidgets.Html#doc\">docs#ProofWidgets.Html</a> on the Lean4 side. On the typescript side, I would like to be able to interpret this prop as a <code>JSX.Element</code> instead of <code>Html</code> from <a href=\"https://github.com/leanprover-community/ProofWidgets4/blob/3b2633db0d7848a35acafd20fef918bc6081cb9b/widget/src/htmlDisplay.tsx#L14\">https://github.com/leanprover-community/ProofWidgets4/blob/3b2633db0d7848a35acafd20fef918bc6081cb9b/widget/src/htmlDisplay.tsx#L14</a> . Is this possible to accomplish <span class=\"user-mention\" data-user-id=\"128280\">@Wojciech Nawrocki</span> ?</p>",
        "id": 486334239,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1733413077
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"243562\">@Adam Topaz</span>! The thing to do is just wrap your <code>html : Html</code> in a <code>&lt;HtmlDisplay html={html} /&gt;</code> in the Typescript code. This is a <code>JSX.Element</code> that renders the given HTML.</p>",
        "id": 486370831,
        "sender_full_name": "ğš ğš˜ğš“ğšŒğš’ğšğšŒğš‘ ğš—ğšŠğš ğš›ğš˜ğšŒğš”ğš’",
        "timestamp": 1733423851
    },
    {
        "content": "<p>Thatâ€™s what Iâ€™ve been doing, but I donâ€™t know how to import HtmlDisplay into typescript while working outside proofwidgets itself</p>",
        "id": 486373068,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1733424760
    },
    {
        "content": "<p>It would be great if you could extract that out as an npm package</p>",
        "id": 486373194,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1733424808
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243562\">Adam Topaz</span> <a href=\"#narrow/channel/270676-lean4/topic/ProofWidgets.2EHtml.20to.20JSX.2EElement/near/486373194\">said</a>:</p>\n<blockquote>\n<p>It would be great if you could extract that out as an npm package</p>\n</blockquote>\n<p>Just did this! It's <a href=\"https://www.npmjs.com/package/@leanprover-community/proofwidgets4\">@leanprover-community/proofwidgets4</a>. For now it only exports the <code>HtmlDisplay</code> component at the top-level. Feel free to PR more exports (I think you may still import other components by referring to the relevant file directly), but see discussion below.</p>\n<p>Note that importing the package from NPM is not ideal. This is because the default setup for building widgets (with Rollup, if you copied that script) is to \"bundle\", which means to include the source code for every imported package except a few builtin ones (notably <code>react</code> and <code>@leanprover/infoview</code>) verbatim in the output file. <code>@leanprover-community/proofwidgets4</code> is not builtin, so every widget that imports it would result in another copy stored in memory. This is not a big deal in practice as this particular package is small, but it obviously does not scale, and importantly may break packages that rely on any kind of global state. My intended solution to this is to let the Lean server work as a kind of tiny CDN, where widget modules can import other widget modules. Something like</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">widget_module</span><span class=\"kd\">]</span>\n<span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">ProofWidgets4</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean.Widget.Module</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">widget_module</span><span class=\"kd\">]</span>\n<span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">otherWidget</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean.Widget.Module</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">javascript</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"</span>\n<span class=\"s2\">    import * as pw4 from 'ProofWidgets4'</span>\n<span class=\"s2\">  \"</span>\n</code></pre></div>\n<p>I started an experimental implementation in <a href=\"https://github.com/leanprover-community/vscode-lean4/pull/557\">vscode-lean4#557</a>. It allows importing widget modules by hash only which is unambiguous but pretty awkward. A more ergonomic scheme would support more readable names for modules, as discussed in the docstring there.</p>\n<p>Any feedback or testing is welcome.</p>",
        "id": 488669256,
        "sender_full_name": "ğš ğš˜ğš“ğšŒğš’ğšğšŒğš‘ ğš—ğšŠğš ğš›ğš˜ğšŒğš”ğš’",
        "timestamp": 1734019903
    }
]