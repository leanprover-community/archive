[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">structure</span><span class=\"w\"> </span><span class=\"n\">NonEmptyList</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">head</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"n\">tail</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">α</span>\n\n<span class=\"kd\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span>\n\n<span class=\"kd\">instance</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CoeDep</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">NonEmptyList</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">head</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">tail</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"o\">}</span>\n\n\n<span class=\"c\">/-</span>\n<span class=\"cm\">application type mismatch</span>\n<span class=\"cm\">  [1, 2].head</span>\n<span class=\"cm\">argument</span>\n<span class=\"cm\">  [1, 2]</span>\n<span class=\"cm\">has type</span>\n<span class=\"cm\">  List Nat : Type</span>\n<span class=\"cm\">but is expected to have type</span>\n<span class=\"cm\">  NonEmptyList ?m.435 : Type</span>\n<span class=\"cm\">-/</span>\n<span class=\"k\">#check</span><span class=\"w\"> </span><span class=\"n\">NonEmptyList.head</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 449461500,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1720255741
    },
    {
        "content": "<p><del>Look at the precise type of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.head#doc\">docs#List.head</a></del></p>",
        "id": 449485308,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1720268030
    },
    {
        "content": "<p><code>#check NonEmptyList.head ([1, 2] : NonEmptyList Nat)</code> does work.</p>",
        "id": 449485506,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1720268179
    },
    {
        "content": "<p>Do does <code>#check NonEmptyList.head (α := Nat) [1, 2]</code></p>",
        "id": 449485523,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1720268216
    },
    {
        "content": "<p>I expect that <code>CoeDep</code> instances only work if the exact expected type is known. In your case, you only know it's <code>NonEmptyList _</code>, not <code>NonEmptyList Nat</code></p>",
        "id": 449485547,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1720268258
    },
    {
        "content": "<p>Note: I wrote my first message because the error message is confusing. The <code>[1, 2].head</code> in the error message looks like <code>List.head [1, 2]</code>.<br>\n(<a href=\"https://github.com/leanprover/lean4/pull/4670\">lean4#4670</a>)</p>",
        "id": 449488333,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1720269909
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"111080\">@Floris van Doorn</span> Thank you!!</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"k\">#check</span><span class=\"w\"> </span><span class=\"n\">NonEmptyList.head</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 449502685,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1720276298
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 451093670,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1720826422
    }
]