[
    {
        "content": "<p>I am having the exact same problem, however on this environment:<br>\n<a href=\"https://github.com/bernborgess/lean-cutting-planes/blob/main/lean-toolchain\">toolchain</a><br>\n<code>leanprover/lean4:v4.7.0</code><br>\n<a href=\"https://github.com/bernborgess/lean-cutting-planes/blob/main/lakefile.lean\">lakefile</a></p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">Lake</span>\n<span class=\"kn\">open</span> <span class=\"n\">Lake</span> <span class=\"n\">DSL</span>\n\n<span class=\"n\">package</span> <span class=\"bp\">«</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">cutting</span><span class=\"bp\">-</span><span class=\"n\">planes</span><span class=\"bp\">»</span> <span class=\"n\">where</span>\n\n<span class=\"n\">require</span> <span class=\"n\">mathlib</span> <span class=\"k\">from</span> <span class=\"n\">git</span>\n  <span class=\"s2\">\"https://github.com/leanprover-community/mathlib4\"</span>\n\n<span class=\"n\">lean_lib</span> <span class=\"bp\">«</span><span class=\"n\">LeanCuttingPlanes</span><span class=\"bp\">»</span> <span class=\"n\">where</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">default_target</span><span class=\"kd\">]</span>\n<span class=\"n\">lean_exe</span> <span class=\"bp\">«</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">cutting</span><span class=\"bp\">-</span><span class=\"n\">planes</span><span class=\"bp\">»</span> <span class=\"n\">where</span>\n  <span class=\"n\">root</span> <span class=\"o\">:=</span> <span class=\"bp\">`</span><span class=\"n\">Main</span>\n</code></pre></div>\n<p>And also, <code>lake update</code> returns:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>PS D:\\ic\\lean-cutting-planes&gt; lake update\nerror: ┬½lean-cutting-planes┬╗: could not rename packages directory (.\\.lake/packages -&gt; .\\.lake\\packages): no error (error code: 0)\n</code></pre></div>\n<p>And <code>lake exe cache get</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>PS D:\\ic\\lean-cutting-planes&gt; lake exe cache get\ninfo: [1/9] Building Cache.IO\ninfo: [2/9] Building Cache.Hashing\ninfo: [2/9] Compiling Cache.IO\ninfo: [4/9] Compiling Cache.Hashing\ninfo: [4/9] Building Cache.Requests\ninfo: [6/9] Building Cache.Main\ninfo: [6/9] Compiling Cache.Requests\ninfo: [7/9] Compiling Cache.Main\ninfo: [9/9] Linking cache.exe\nNo files to download\nDecompressing 4381 file(s)\n[...]\nC:\\Users\\foo\\.cache\\mathlib\\0f6c25b493881f3b.ltar: The process cannot access the file because it is being used by another process. (os error 32)\nuncaught exception: leantar failed with error code 1\n</code></pre></div>\n<p>And with <code>lake build</code></p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>PS D:\\ic\\lean-cutting-planes&gt; lake build\n[1395/1395] Linking lean-cutting-planes.exe\nerror: failed to execute `c:\\Users\\foo\\.elan\\toolchains\\leanprover--lean4---v4.7.0\\bin\\leanc.exe`: unspecified system_category error (error code: 87)\n</code></pre></div>\n<p>Now, with a fresh project that depends on <code>mathlib4</code> it's the same</p>",
        "id": 435056418,
        "sender_full_name": "Bernardo Borges",
        "timestamp": 1713901396
    },
    {
        "content": "<p>I get this error as well on Windows when trying to run <code>lake update</code> in a project using <code>leanprover/lean4:v4.7.0-rc2</code></p>",
        "id": 437613180,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1715160838
    },
    {
        "content": "<p>The original issue was fixed in 4.8.0, for other errors let's start separate threads/issue reports</p>",
        "id": 437613588,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1715160995
    },
    {
        "content": "<p>3 messages were moved here from <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/stream/287929-mathlib4/topic/error.20building.20windows.20exe.20.20proj\">#mathlib4 &gt; error building windows exe  proj</a> by <span class=\"user-mention silent\" data-user-id=\"111080\">Floris van Doorn</span>.</p>",
        "id": 437614436,
        "sender_full_name": "Notification Bot",
        "timestamp": 1715161317
    },
    {
        "content": "<p>Ah, if the rename is the error you received, then that as well should be fixed :) <a href=\"https://github.com/leanprover/lean4/commit/e54a0d7b89b7b8e4393b91e81f471d81f67ca713\">https://github.com/leanprover/lean4/commit/e54a0d7b89b7b8e4393b91e81f471d81f67ca713</a></p>",
        "id": 437614859,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1715161455
    },
    {
        "content": "<p>Ok, I moved this to a separate thread.<br>\nWhen running <code>lake update</code> in Windows in this repository<br>\n<a href=\"https://github.com/fpvandoorn/carleson/tree/9e06a00378a321140e8fd366a8f5fa96844f1fc5\">https://github.com/fpvandoorn/carleson/tree/9e06a00378a321140e8fd366a8f5fa96844f1fc5</a><br>\nat Lean version <code>leanprover/lean4:v4.7.0-rc2</code><br>\nI get the error</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">Floris</span><span class=\"bp\">@</span><span class=\"n\">Dell</span><span class=\"bp\">-</span><span class=\"n\">E</span> <span class=\"n\">MINGW64</span> <span class=\"bp\">~/</span><span class=\"n\">projects</span><span class=\"bp\">/</span><span class=\"n\">carleson</span> <span class=\"o\">(</span><span class=\"n\">master</span><span class=\"o\">)</span>\n<span class=\"bp\">$</span> <span class=\"n\">lake</span> <span class=\"n\">update</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">carleson</span><span class=\"o\">:</span> <span class=\"n\">could</span> <span class=\"n\">not</span> <span class=\"n\">rename</span> <span class=\"n\">packages</span> <span class=\"n\">directory</span> <span class=\"o\">(</span><span class=\"bp\">.\\.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span> <span class=\"bp\">-&gt;</span> <span class=\"bp\">.\\.</span><span class=\"n\">lake</span><span class=\"bp\">\\</span><span class=\"n\">packages</span><span class=\"o\">):</span> <span class=\"n\">no</span> <span class=\"n\">error</span> <span class=\"o\">(</span><span class=\"n\">error</span> <span class=\"n\">code</span><span class=\"o\">:</span> <span class=\"mi\">0</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 437614891,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1715161469
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110024\">Sebastian Ullrich</span> <a href=\"#narrow/stream/270676-lean4/topic/could.20not.20rename.20packages.20directory/near/437614859\">said</a>:</p>\n<blockquote>\n<p>Ah, if the rename is the error you received, then that as well should be fixed :) <a href=\"https://github.com/leanprover/lean4/commit/e54a0d7b89b7b8e4393b91e81f471d81f67ca713\">https://github.com/leanprover/lean4/commit/e54a0d7b89b7b8e4393b91e81f471d81f67ca713</a></p>\n</blockquote>\n<p>What is currently the most convenient way to update <code>lean-toolchain</code> when <code>lake update</code> errors?</p>",
        "id": 437615046,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1715161534
    },
    {
        "content": "<p>there isn't one, it's copy paste</p>",
        "id": 437615726,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1715161777
    },
    {
        "content": "<p>the convenient way is the mathlib post-update hook but this only works if lake hasn't had a forward-incompatible change recently</p>",
        "id": 437615853,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1715161817
    },
    {
        "content": "<p>I can confirm that this is fixed after manually replacing the contents of <code>lean-toolchain</code> with <code>leanprover/lean4:v4.8.0-rc1</code>. Thanks!</p>",
        "id": 437618950,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1715162965
    },
    {
        "content": "<p>Right now the error changed to aesop config:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>PS D:\\ic\\lean-cutting-planes&gt; lake update\nerror: .\\.lake\\packages\\aesop\\lakefile.toml:1:0: error: unexpected identifier; expected command\nerror: .\\.lake\\packages\\aesop\\lakefile.toml: package configuration has errors\n</code></pre></div>",
        "id": 437632644,
        "sender_full_name": "Bernardo Borges",
        "timestamp": 1715168708
    },
    {
        "content": "<p>Your lean-toolchain is likely older than aesop's, try copying it over</p>",
        "id": 437634070,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1715169260
    },
    {
        "content": "<p>Changed to <code>leanprover/lean4:v4.8.0-rc1</code>. Now <code>lake update</code> works</p>",
        "id": 437657136,
        "sender_full_name": "Bernardo Borges",
        "timestamp": 1715176705
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> made <a href=\"https://github.com/leanprover/lean4/pull/4103\">lean#4103</a> <a href=\"#narrow/stream/287929-mathlib4/topic/lake.20update.20not.20working/near/437555363\">last night</a> about how there should be more of a warning for toolchain mismatch on lake update, so if anyone is looking for an issue to upvote, perhaps this is it.</p>",
        "id": 437659135,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1715177253
    },
    {
        "content": "<p>However on <code>lake build</code> i get a <a href=\"https://pastebin.com/ct9LysTa\">huge error</a> ending with:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>error: failed to execute 'c:\\Users\\bernb\\.elan\\toolchains\\leanprover--lean4---v4.8.0-rc1\\bin\\leanc.exe': unspecified system_category error (error code: 87)\nSome build steps logged failures:\n- Linking lean-cutting-planes.exe\nerror: build failed\n</code></pre></div>",
        "id": 437659187,
        "sender_full_name": "Bernardo Borges",
        "timestamp": 1715177272
    },
    {
        "content": "<p>Last night I had to <code>rm -rf .lake</code> to remove the <code>.lake</code> folder to get it to work after I updated the toolchain</p>",
        "id": 437659402,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1715177330
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"282271\">Bolton Bailey</span> <a href=\"#narrow/stream/270676-lean4/topic/could.20not.20rename.20packages.20directory/near/437659402\">said</a>:</p>\n<blockquote>\n<p>Last night I had to remove the <code>.lake</code> folder to get it to work after I updated the toolchain</p>\n</blockquote>\n<p>What is your toolchain now?</p>",
        "id": 437659516,
        "sender_full_name": "Bernardo Borges",
        "timestamp": 1715177365
    },
    {
        "content": "<p>leanprover/lean4:v4.8.0-rc1</p>",
        "id": 437659788,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1715177441
    },
    {
        "content": "<p>Hmm, maybe this is a different issue, sorry, <code>lake update</code> was the thing that was broken for me after updating the toolchain.</p>",
        "id": 437660019,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1715177518
    },
    {
        "content": "<p>Tried deleting <code>.lake</code> but the outcome is the same, sadly.</p>",
        "id": 437663619,
        "sender_full_name": "Bernardo Borges",
        "timestamp": 1715178674
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"671510\">@Bernardo Borges</span>, could you post the URL of a repo that shows this problem?</p>",
        "id": 437744419,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1715209498
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/270676-lean4/topic/could.20not.20rename.20packages.20directory/near/437744419\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"671510\">Bernardo Borges</span>, could you post the URL of a repo that shows this problem?</p>\n</blockquote>\n<p>Surely, its <a href=\"https://github.com/bernborgess/lean-cutting-planes\">https://github.com/bernborgess/lean-cutting-planes</a></p>",
        "id": 437749429,
        "sender_full_name": "Bernardo Borges",
        "timestamp": 1715213298
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"671510\">@Bernardo Borges</span>, for me:</p>\n<ul>\n<li><code>git clone https://github.com/bernborgess/lean-cutting-planes</code></li>\n<li><code>cd lean-cutting-planes</code></li>\n<li><code>git checkout 3eae7fc729e0c895d28992a36b271b8f485c28bf</code> (current master)</li>\n<li>change <code>lean-toolchain</code> to <code>leanprover/lean4:v4.8.0-rc1</code></li>\n<li><code>lake update</code></li>\n<li><code>lake exe cache get</code></li>\n<li><code>lake build</code></li>\n</ul>\n<p>succeeds.</p>",
        "id": 437752536,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1715216266
    },
    {
        "content": "<p>Ok! I'll try it again this way</p>",
        "id": 437752616,
        "sender_full_name": "Bernardo Borges",
        "timestamp": 1715216335
    },
    {
        "content": "<p>So, I cloned the project again and followed each step. All is fine, until the <code>lake build</code>, that fails with an <a href=\"https://pastebin.com/T2psBr4v\">error</a> (password is \"rename\")</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>error: failed to execute 'c:\\Users\\bernb\\.elan\\toolchains\\leanprover--lean4---v4.8.0-rc1\\bin\\leanc.exe': unspecified system_category error (error code: 87)\nSome build steps logged failures:\n- Linking lean-cutting-planes.exe\nerror: build failed\n</code></pre></div>",
        "id": 437818006,
        "sender_full_name": "Bernardo Borges",
        "timestamp": 1715260852
    },
    {
        "content": "<p>Sorry, this has exceeded my lake expertise, I've never built an <code>.exe</code> on windows. :-(</p>",
        "id": 437907064,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1715301053
    },
    {
        "content": "<p>87 is <code>ERROR_INVALID_PARAMETER</code> (\"The parameter was incorrect\"). Looks like <code>lake</code> called <code>CreateProcess</code> with a 56856-character string as the <code>lpCommandLine</code> argument, and that's invalid because the maximum length for that parameter is 32767 characters. I was able to get an exe by writing the arguments to a file <code>args.txt</code> then invoking leanc as <code>leanc.exe @args.txt</code>. Maybe <code>lake</code> should be doing that for you.</p>",
        "id": 437940675,
        "sender_full_name": "Richard Copley",
        "timestamp": 1715327895
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span>, do you know what's going on here?</p>\n<p>We may need a bug report with a repro.</p>",
        "id": 437942673,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1715328791
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> Yeah, this should get a bug report. Command line limits were a anticipated problem but were put off until they actually become one. It seems we have reached that point.</p>",
        "id": 437943098,
        "sender_full_name": "Mac Malone",
        "timestamp": 1715328965
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"400544\">@Richard Copley</span>, would you be able to write an issue at the lean repository showing how to reproduce your observations above?</p>",
        "id": 437943787,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1715329234
    },
    {
        "content": "<p>Not until this evening (after <time datetime=\"2024-05-10T16:00:00Z\">2024-05-10T17:00:00+01:00</time>) or tomorrow, I'm afraid, so if someone beats me to it that would be good. I did the commands in <a href=\"#narrow/stream/270676-lean4/topic/could.20not.20rename.20packages.20directory/near/437752536\">your message</a> and got the same error as Bernardo, so anyone on Windows should be able to do it.</p>",
        "id": 437945439,
        "sender_full_name": "Richard Copley",
        "timestamp": 1715329984
    },
    {
        "content": "<p>Actually <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span>, <span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span>, I'll be a little more assertive, and say that I'm not the right person to create the bug report, because I don't know enough about Lean as a general-purpose language to do it properly. Sorry!</p>",
        "id": 437951142,
        "sender_full_name": "Richard Copley",
        "timestamp": 1715332597
    },
    {
        "content": "<p>How can I help?</p>",
        "id": 437958329,
        "sender_full_name": "Bernardo Borges",
        "timestamp": 1715335940
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"671510\">@Bernardo Borges</span>, pretty much just combining my command line list above, with whatever output you get from running that on WIndows. Richard's post above seems to do a good job of highlighting the relevant information. We just need it in an issue on the lean4 repository, so that when and if Mac has time to deal with it, there's a simple to reproduce bug to observe.</p>",
        "id": 437970160,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1715342218
    },
    {
        "content": "<p>Created the issue <a href=\"https://github.com/leanprover/lean4/issues/4159\">https://github.com/leanprover/lean4/issues/4159</a></p>",
        "id": 438599656,
        "sender_full_name": "Bernardo Borges",
        "timestamp": 1715700026
    },
    {
        "content": "<p>Any updates or workarounds on this?</p>\n<p>I am on Windows 11 trying to use <br>\n<a href=\"https://github.com/teorth/equational_theories/tree/main\">https://github.com/teorth/equational_theories/tree/main</a></p>\n<p>with the command</p>\n<blockquote>\n<p>C:\\Users\\XYZ\\Projects\\learn_4_equational&gt; lake exe extract_implications --json &gt; C:\\Users\\XYZ\\Desktop\\equational_theories\\implications.json</p>\n</blockquote>\n<p>which is a Windows command similar to </p>\n<p><a href=\"https://github.com/teorth/equational_theories/blob/main/.github/workflows/blueprint.yml#L173-L177\">https://github.com/teorth/equational_theories/blob/main/.github/workflows/blueprint.yml#L173-L177</a></p>\n<p>and getting </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">execute</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">c</span><span class=\"o\">:</span><span class=\"bp\">\\</span><span class=\"n\">Users</span><span class=\"bp\">\\</span><span class=\"n\">XYZ</span><span class=\"bp\">\\.</span><span class=\"n\">elan</span><span class=\"bp\">\\</span><span class=\"n\">toolchains</span><span class=\"bp\">\\</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---v4.13.0-rc3\\bin\\leanc.exe': unspecified system_category error (error code: 87)</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">steps</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">extract_implications</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n</code></pre></div>\n<hr>\n<p>I did see this related work around so will give it a try</p>\n<p><span class=\"user-mention silent\" data-user-id=\"400544\">Richard Copley</span> <a href=\"#narrow/channel/270676-lean4/topic/could.20not.20rename.20packages.20directory/near/437940675\">said</a>:</p>\n<blockquote>\n<p>I was able to get an exe by writing the arguments to a file <code>args.txt</code> then invoking leanc as <code>leanc.exe @args.txt</code>.</p>\n</blockquote>\n<p>but really do not understand what was done.</p>",
        "id": 477704537,
        "sender_full_name": "Eric Taucher",
        "timestamp": 1729274330
    },
    {
        "content": "<p>For the case above, I wrote <code>lake build --verbose</code> instead of <code>lake build</code>. This outputs the commands that <code>lake</code> is running. One of those commands was the offending <code>leanc.exe</code> invocation. I copied the terminal output into a text editor so I could snip out that invocation, then saved only the arguments (the part of the command line after \"leanc.exe\") into a text file \"args.txt\". Then I ran <code>leanc.exe @args.txt</code>.</p>\n<p>I don't know how to adapt that to the case of <code>lean exe extract_implications --json</code>. Does <code>lean build extract_implications --verbose</code> do anything? I'll try it, but first I need to do</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">clone</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">teorth</span><span class=\"bp\">/</span><span class=\"n\">equational_theories</span>\n<span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">equational_theories</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span>\n</code></pre></div>\n<p>which will take some time.</p>",
        "id": 477730338,
        "sender_full_name": "Richard Copley",
        "timestamp": 1729283405
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"400544\">Richard Copley</span> <a href=\"#narrow/channel/270676-lean4/topic/could.20not.20rename.20packages.20directory/near/477730338\">said</a>:</p>\n<blockquote>\n<p>I don't know how to adapt that to the case of <code>lean exe extract_implications --json</code>.</p>\n</blockquote>\n<p>No worries. Seems that <a href=\"https://openai.com/index/introducing-canvas/\">OpenAI canvas</a> might be of value here.  Still working with it but it did give a suggestion.</p>",
        "id": 477733965,
        "sender_full_name": "Eric Taucher",
        "timestamp": 1729285267
    },
    {
        "content": "<p><code>lake build extract_implications --verbose</code> seems to be working.</p>",
        "id": 477734586,
        "sender_full_name": "Richard Copley",
        "timestamp": 1729285622
    },
    {
        "content": "<p>It seems to work. Of note:</p>\n<ul>\n<li>I had to replace backslashes <code>\\</code> with forward slashes <code>/</code> in <code>args.txt</code></li>\n<li>I had to delete the argument <code>-leanshared</code> from <code>args.txt</code> to avoid an error \"unable to find library -leanshared\"; I'm not sure if this will cause trouble later on.</li>\n</ul>",
        "id": 477735385,
        "sender_full_name": "Richard Copley",
        "timestamp": 1729286045
    },
    {
        "content": "<p>It was going good then failed</p>\n<p>Starting from a new directory to get a clean install of the repository.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">clone</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">teorth</span><span class=\"bp\">/</span><span class=\"n\">equational_theories</span>\n<span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">equational_theories</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get</span>\n</code></pre></div>\n<p>then this caused it to fail with the same error.  </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lake</span><span class=\"w\">  </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">extract_implications</span><span class=\"w\"> </span><span class=\"c1\">--verbose</span>\n</code></pre></div>",
        "id": 477737132,
        "sender_full_name": "Eric Taucher",
        "timestamp": 1729287009
    },
    {
        "content": "<p>Yes, that's expected. But it still outputs the commands, and you know what to do next.</p>",
        "id": 477737232,
        "sender_full_name": "Richard Copley",
        "timestamp": 1729287092
    },
    {
        "content": "<p>The output from</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>lake build extract_implications --verbose\n</code></pre></div>\n<p>ends with</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>[916/916] Building extract_implications\ntrace: .&gt; c:\\Users\\buster\\.elan\\toolchains\\leanprover--lean4---v4.13.0-rc3\\bin\\leanc.exe {{{a gigantic heap of stuff}}} -leanshared\nerror: failed to execute 'c:\\Users\\buster\\.elan\\toolchains\\leanprover--lean4---v4.13.0-rc3\\bin\\leanc.exe': unspecified system_category error (error code: 87)\n</code></pre></div>\n<ul>\n<li>Copy <code>{{{a gigantic heap of stuff}}}</code> (all the text between <code>leanc.exe</code> and <code>-leanshared</code>, excluding <code>leanc.exe</code> and <code>-leanshared</code>) from the output and paste it into a text editor.</li>\n<li>Replace the backslashes with forward slashes.</li>\n<li>Save it as <code>args.txt</code> (in the top-level directory of your <code>equational_theories</code> tree).</li>\n<li>Run the following commands (also in the top-level directory):</li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>leanc.exe @args.txt\nleanc.exe @args.txt -leanshared\nlake exe extract_implications --json\n</code></pre></div>\n<p>It is weird that I needed to run <code>leanc.exe</code> twice, but that is what works.</p>",
        "id": 477742196,
        "sender_full_name": "Richard Copley",
        "timestamp": 1729289964
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"366057\">@Eric Taucher</span>, is anything unclear? Does it work for you?</p>",
        "id": 477743372,
        "sender_full_name": "Richard Copley",
        "timestamp": 1729290793
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"400544\">Richard Copley</span> <a href=\"#narrow/channel/270676-lean4/topic/could.20not.20rename.20packages.20directory/near/477743372\">said</a>:</p>\n<blockquote>\n<p>@Eric Taucher, is anything unclear? Does it work for you?</p>\n</blockquote>\n<p>Bouncing between many tasks but what you note makes sense. Slowing making progress between all the tasks I am juggling, e.g. helping others on the <a href=\"https://community.openai.com/\">OpenAI forum</a>, trying to see the comet (<a href=\"https://www.timeanddate.com/astronomy/night/usa/allentown\">ref</a>)</p>",
        "id": 477746261,
        "sender_full_name": "Eric Taucher",
        "timestamp": 1729292979
    },
    {
        "content": "<p>Still working on this</p>\n<p>Currently failing at the last step, still with <code>error code: 87</code></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">extract_implications</span><span class=\"w\"> </span><span class=\"c1\">--json</span>\n</code></pre></div>\n<p><del>I will take a shot at this using WSL on another machine and see if that works, however I have not installed Lean on WSL and the machine only has 8GB of memory so not optimistic.</del></p>\n<p>The current goal is to just get the data needed to create graphs used by the <a href=\"#narrow/channel/458659-Equational\">Equational</a> project, e.g. </p>\n<p><a href=\"https://teorth.github.io/equational_theories/graphiti/?render=true&amp;implies=14&amp;highlight_red=14\">https://teorth.github.io/equational_theories/graphiti/?render=true&amp;implies=14&amp;highlight_red=14</a></p>\n<p><a href=\"https://teorth.github.io/equational_theories/graphiti/?render=true&amp;limit_equations=1%2C+2%2C+3%2C+4%2C+5%2C+6%2C+7%2C+8%2C+23%2C+38%2C+39%2C+40%2C+41%2C+42%2C+43%2C+45%2C+46%2C+168%2C+387%2C+4512%2C+4513%2C+4522%2C+4564%2C+4579%2C+4582\">https://teorth.github.io/equational_theories/graphiti/?render=true&amp;limit_equations=1%2C+2%2C+3%2C+4%2C+5%2C+6%2C+7%2C+8%2C+23%2C+38%2C+39%2C+40%2C+41%2C+42%2C+43%2C+45%2C+46%2C+168%2C+387%2C+4512%2C+4513%2C+4522%2C+4564%2C+4579%2C+4582</a></p>",
        "id": 477800014,
        "sender_full_name": "Eric Taucher",
        "timestamp": 1729339252
    },
    {
        "content": "<p>The intention is that <code>extract_implications.exe</code> already exists <strong>and</strong> is newer than all its dependencies, so that <code>lake</code> decides that it does not need to be built.</p>\n<ul>\n<li>Does <code>lake build extract_implications --verbose</code> give the same error as before, with the failing command being similar to <code>leanc.exe -o extract_implications.exe [...]</code>?</li>\n<li>Does <code>extract_implications.exe</code> already exist?</li>\n<li>Have you changed any source files since you created it?</li>\n</ul>",
        "id": 477801214,
        "sender_full_name": "Richard Copley",
        "timestamp": 1729340284
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"400544\">@Richard Copley</span> </p>\n<p>Thanks! </p>\n<p>It worked just had to run the steps in order without  any mistakes. In essence started all over and learned from previous mistakes.</p>\n<p>Change to a directory with user write permissions, used <code>C:\\User\\Groot\\Projects</code></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">clone</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">teorth</span><span class=\"bp\">/</span><span class=\"n\">equational_theories</span>\n<span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">equational_theories</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">extract_implications</span><span class=\"w\"> </span><span class=\"c1\">--verbose &gt; extract_implications_verbose.txt</span>\n</code></pre></div>\n<p>The output from</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>lake build extract_implications --verbose\n</code></pre></div>\n<p>ends with</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>[916/916] Building extract_implications\ntrace: .&gt; c:\\Users\\buster\\.elan\\toolchains\\leanprover--lean4---v4.13.0-rc3\\bin\\leanc.exe {{{a gigantic heap of stuff}}} -leanshared\nerror: failed to execute 'c:\\Users\\buster\\.elan\\toolchains\\leanprover--lean4---v4.13.0-rc3\\bin\\leanc.exe': unspecified system_category error (error code: 87)\n</code></pre></div>\n<ul>\n<li>Copy <code>{{{a gigantic heap of stuff}}}</code> (all the text between <code>leanc.exe</code> and <code>-leanshared</code>, excluding <code>leanc.exe</code> and <code>-leanshared</code>) from the output and paste it into a text editor.</li>\n<li>Replace <code>.\\.\\.lake</code> with <code>.lake</code></li>\n<li>Replace the backslashes with forward slashes.</li>\n<li>Save it as <code>args.txt</code> (in the top-level directory of your <code>equational_theories</code> tree).</li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"n\">args</span><span class=\"bp\">.</span><span class=\"n\">txt</span>\n\n<span class=\"mi\">10</span><span class=\"bp\">/</span><span class=\"mi\">19</span><span class=\"bp\">/</span><span class=\"mi\">2024</span><span class=\"w\">  </span><span class=\"mi\">09</span><span class=\"o\">:</span><span class=\"mi\">25</span><span class=\"w\"> </span><span class=\"n\">AM</span><span class=\"w\">            </span><span class=\"mi\">32</span><span class=\"o\">,</span><span class=\"mi\">923</span><span class=\"w\"> </span><span class=\"n\">args</span><span class=\"bp\">.</span><span class=\"n\">txt</span>\n</code></pre></div>\n<p>Sample of args.txt </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">-</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">extract_implications</span><span class=\"bp\">.</span><span class=\"n\">exe</span>\n<span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">scripts</span><span class=\"bp\">/</span><span class=\"n\">extract_implications</span><span class=\"bp\">.</span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">o</span><span class=\"bp\">.</span><span class=\"kn\">export</span>\n<span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">batteries</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">Batteries</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">Array</span><span class=\"bp\">/</span><span class=\"n\">Init</span><span class=\"bp\">/</span><span class=\"n\">Lemmas</span><span class=\"bp\">.</span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">o</span><span class=\"bp\">.</span><span class=\"kn\">export</span>\n<span class=\"bp\">...</span>\n<span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">equational_theories</span><span class=\"bp\">/</span><span class=\"n\">EquationalResult</span><span class=\"bp\">.</span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">o</span><span class=\"bp\">.</span><span class=\"kn\">export</span>\n<span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">ir</span><span class=\"bp\">/</span><span class=\"n\">equational_theories</span><span class=\"bp\">/</span><span class=\"n\">Closure</span><span class=\"bp\">.</span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">o</span><span class=\"bp\">.</span><span class=\"kn\">export</span>\n<span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">MD4Lean</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">md4c</span><span class=\"bp\">/</span><span class=\"n\">libleanmd4c</span><span class=\"bp\">.</span><span class=\"n\">a</span>\n</code></pre></div>\n<ul>\n<li>Run the following commands (also in the top-level directory):</li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">leanc</span><span class=\"bp\">.</span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">args</span><span class=\"bp\">.</span><span class=\"n\">txt</span>\n<span class=\"n\">leanc</span><span class=\"bp\">.</span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">args</span><span class=\"bp\">.</span><span class=\"n\">txt</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">leanshared</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">extract_implications</span><span class=\"w\"> </span><span class=\"c1\">--json &gt; extract_imiplications.json</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"n\">extract_imiplications</span><span class=\"bp\">.</span><span class=\"n\">json</span>\n\n<span class=\"mi\">10</span><span class=\"bp\">/</span><span class=\"mi\">19</span><span class=\"bp\">/</span><span class=\"mi\">2024</span><span class=\"w\">  </span><span class=\"mi\">09</span><span class=\"o\">:</span><span class=\"mi\">28</span><span class=\"w\"> </span><span class=\"n\">AM</span><span class=\"w\">        </span><span class=\"mi\">26</span><span class=\"o\">,</span><span class=\"mi\">382</span><span class=\"o\">,</span><span class=\"mi\">724</span><span class=\"w\"> </span><span class=\"n\">extract_imiplications</span><span class=\"bp\">.</span><span class=\"n\">json</span>\n</code></pre></div>\n<p>Sample of extract_implications.json</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">{</span><span class=\"s2\">\"nonimplications\"</span><span class=\"o\">:[{</span><span class=\"s2\">\"rhs\"</span><span class=\"o\">:</span><span class=\"s2\">\"Equation2\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"lhs\"</span><span class=\"o\">:</span><span class=\"s2\">\"Equation1\"</span><span class=\"o\">},{</span><span class=\"s2\">\"rhs\"</span><span class=\"o\">:</span><span class=\"s2\">\"Equation3\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"lhs\"</span><span class=\"o\">:</span><span class=\"s2\">\"Equation1\"</span><span class=\"o\">},</span>\n<span class=\"bp\">...</span>\n<span class=\"o\">{</span><span class=\"s2\">\"rhs\"</span><span class=\"o\">:</span><span class=\"s2\">\"Equation1\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"lhs\"</span><span class=\"o\">:</span><span class=\"s2\">\"Equation4658\"</span><span class=\"o\">},{</span><span class=\"s2\">\"rhs\"</span><span class=\"o\">:</span><span class=\"s2\">\"Equation1\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s2\">\"lhs\"</span><span class=\"o\">:</span><span class=\"s2\">\"Equation4666\"</span><span class=\"o\">}]}</span>\n</code></pre></div>",
        "id": 477807418,
        "sender_full_name": "Eric Taucher",
        "timestamp": 1729345201
    }
]