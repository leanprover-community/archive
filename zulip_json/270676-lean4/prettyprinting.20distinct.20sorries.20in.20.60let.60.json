[
    {
        "content": "<p>consider the following example:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"c1\">-- n : Nat := sorry `«[anonymous]:2:17»</span>\n<span class=\"w\">  </span><span class=\"gr\">admit</span>\n</code></pre></div>\n<p>does it make sense to prettyprint the name in this sorry as <code>foo.n</code> instead, somehow? because <code>anonymous</code> does not seem very informative to me...</p>",
        "id": 494672826,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737316859
    },
    {
        "content": "<p><code>[anonymous]</code> means that somehow you're in a module with no name. That's fairly unusual.</p>",
        "id": 494682421,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1737323086
    },
    {
        "content": "<p>It seems that there's also somehow a bug here. It should print as <code>sorry</code> in this context.</p>",
        "id": 494682476,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1737323131
    },
    {
        "content": "<p>should this be reported?</p>",
        "id": 494897065,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737400696
    },
    {
        "content": "<p>Yes please do</p>",
        "id": 494897398,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1737400842
    },
    {
        "content": "<p>The issue seems to be that <code>Lean.Widget.addInteractiveHypothesisBundle</code> uses <code>Lean.Widget.ppExprTagged</code> for let values, but <code>ppExprTagged</code> sets <code>pp.sorrySource</code> to <code>true</code>, since I assumed this function was only being used for hovers.</p>\n<p>Writing this here to remind me where to look when I get around to it (please link to this Zulip thread!)</p>",
        "id": 494898288,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1737401215
    },
    {
        "content": "<p>btw, should the issue mention only the fact that it displays the source when it shouldn't, or should it also mention the <code>[anonymous]</code> rather than <code>foo.n</code>?</p>",
        "id": 494898559,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737401336
    },
    {
        "content": "<p>That would be an rfc</p>",
        "id": 494901424,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1737402586
    },
    {
        "content": "<p>fwiw, i can't seem to get the playground to display anything other than <code>[anonymous]</code>?</p>",
        "id": 494901531,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737402627
    },
    {
        "content": "<p>is that (like you said) due to the fact that the playground operates without a surrounding module?</p>",
        "id": 494901613,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737402670
    },
    {
        "content": "<p>Yeah. Maybe the playground should have a module name?</p>",
        "id": 494901685,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1737402712
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/pull/6715\">lean4#6715</a></p>",
        "id": 494902694,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737403151
    },
    {
        "content": "<p>where do i file a bug/rfc with the lean playground?</p>",
        "id": 494902818,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737403203
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/lean4web\">https://github.com/leanprover-community/lean4web</a>?</p>",
        "id": 494902962,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737403253
    },
    {
        "content": "<p>alternatively, maybe the identifiers/names shouldn't become <code>[anonymous]</code> just because there is no module name</p>",
        "id": 494903531,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737403503
    },
    {
        "content": "<p>(or both)</p>",
        "id": 494903568,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737403516
    }
]