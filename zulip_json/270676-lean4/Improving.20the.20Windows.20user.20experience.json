[
    {
        "content": "<p>Could we try polishin the Windows experience of using Lean a bit? For once, I am trying to use Lean on Windows and it's roadblock after roadblock.</p>",
        "id": 479440010,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730195732
    },
    {
        "content": "<p>I want to do a simple task: bump PFR (<a href=\"https://github.com/teorth/pfr\">https://github.com/teorth/pfr</a>). So I update <code>lean-toolchain</code> and run</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Yael</span><span class=\"bp\">@</span><span class=\"n\">DESKTOP</span><span class=\"bp\">-</span><span class=\"mi\">38</span><span class=\"n\">SA6QH</span><span class=\"w\"> </span><span class=\"n\">MINGW64</span><span class=\"w\"> </span><span class=\"bp\">~/</span><span class=\"n\">Documents</span><span class=\"bp\">/</span><span class=\"n\">Lean</span><span class=\"bp\">/</span><span class=\"n\">pfr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">master</span><span class=\"o\">)</span>\n<span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">Kenv</span><span class=\"bp\">=</span><span class=\"n\">dev</span><span class=\"w\"> </span><span class=\"n\">update</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">permission</span><span class=\"w\"> </span><span class=\"n\">denied</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">13</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">file</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.·</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">permission</span><span class=\"w\"> </span><span class=\"n\">denied</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">13</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">file</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.·</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">permission</span><span class=\"w\"> </span><span class=\"n\">denied</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">13</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">file</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">\\</span><span class=\"n\">lakefile</span><span class=\"bp\">.</span><span class=\"n\">olean</span>\n</code></pre></div>",
        "id": 479440400,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730195851
    },
    {
        "content": "<p>Okay great. I guess to run</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Yael</span><span class=\"bp\">@</span><span class=\"n\">DESKTOP</span><span class=\"bp\">-</span><span class=\"mi\">38</span><span class=\"n\">SA6QH</span><span class=\"w\"> </span><span class=\"n\">MINGW64</span><span class=\"w\"> </span><span class=\"bp\">~/</span><span class=\"n\">Documents</span><span class=\"bp\">/</span><span class=\"n\">Lean</span><span class=\"bp\">/</span><span class=\"n\">pfr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">master</span><span class=\"o\">)</span>\n<span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">rm</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">rf</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span>\n<span class=\"n\">rm</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"n\">remove</span><span class=\"w\"> </span><span class=\"bp\">'.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Analysis</span><span class=\"bp\">/</span><span class=\"n\">Fourier</span><span class=\"bp\">/</span><span class=\"n\">ZMod</span><span class=\"bp\">.</span><span class=\"n\">ilean'</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Device</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">resource</span><span class=\"w\"> </span><span class=\"n\">busy</span>\n<span class=\"n\">rm</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"n\">remove</span><span class=\"w\"> </span><span class=\"bp\">'.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Analysis</span><span class=\"bp\">/</span><span class=\"n\">InnerProductSpace</span><span class=\"bp\">/</span><span class=\"n\">GramSchmidtOrtho</span><span class=\"bp\">.</span><span class=\"n\">ilean'</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Device</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">resource</span><span class=\"w\"> </span><span class=\"n\">busy</span>\n<span class=\"n\">rm</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"n\">remove</span><span class=\"w\"> </span><span class=\"bp\">'.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Analysis</span><span class=\"bp\">/</span><span class=\"n\">InnerProductSpace</span><span class=\"bp\">/</span><span class=\"n\">ProdL2</span><span class=\"bp\">.</span><span class=\"n\">ilean'</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Device</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">resource</span><span class=\"w\"> </span><span class=\"n\">busy</span>\n<span class=\"bp\">#</span><span class=\"w\"> </span><span class=\"n\">etc</span>\n</code></pre></div>",
        "id": 479440569,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730195906
    },
    {
        "content": "<p>Yes, that's annoying: you have to close VSCode before getting the cache or doing an update from the command line.</p>",
        "id": 479440592,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1730195916
    },
    {
        "content": "<p>Ah but now I can run</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Yael</span><span class=\"bp\">@</span><span class=\"n\">DESKTOP</span><span class=\"bp\">-</span><span class=\"mi\">38</span><span class=\"n\">SA6QH</span><span class=\"w\"> </span><span class=\"n\">MINGW64</span><span class=\"w\"> </span><span class=\"bp\">~/</span><span class=\"n\">Documents</span><span class=\"bp\">/</span><span class=\"n\">Lean</span><span class=\"bp\">/</span><span class=\"n\">pfr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">master</span><span class=\"o\">)</span>\n<span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">Kenv</span><span class=\"bp\">=</span><span class=\"n\">dev</span><span class=\"w\"> </span><span class=\"n\">update</span>\n<span class=\"n\">trace</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">\\</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">LeanAPAP</span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">fetch</span><span class=\"w\"> </span><span class=\"c1\">--tags --force origin</span>\n<span class=\"n\">trace</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">\\</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">fetch</span><span class=\"w\"> </span><span class=\"c1\">--tags --force origin</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">mathlib</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">URL</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">changed</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">you</span><span class=\"w\"> </span><span class=\"n\">might</span><span class=\"w\"> </span><span class=\"n\">need</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">delete</span><span class=\"w\"> </span><span class=\"bp\">'.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">\\</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">mathlib'</span><span class=\"w\"> </span><span class=\"n\">manually</span>\n<span class=\"n\">trace</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">\\</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">mathlib</span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">fetch</span><span class=\"w\"> </span><span class=\"c1\">--tags --force origin</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">mathlib</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">updating</span><span class=\"w\"> </span><span class=\"n\">repository</span><span class=\"w\"> </span><span class=\"bp\">'.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">\\</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">mathlib'</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">d27f22898a74975360dd1387155c6031b501a90b'</span>\n<span class=\"n\">trace</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">.\\.\\.</span><span class=\"n\">lake</span><span class=\"bp\">\\</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">mathlib</span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">checkout</span><span class=\"w\"> </span><span class=\"c1\">--detach d27f22898a74975360dd1387155c6031b501a90b --</span>\n<span class=\"n\">trace</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stderr</span><span class=\"o\">:</span>\n<span class=\"n\">fatal</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">reference</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">tree</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">d27f22898a74975360dd1387155c6031b501a90b</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">external</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">git'</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">128</span>\n</code></pre></div>",
        "id": 479440736,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730195968
    },
    {
        "content": "<p>... and Lean has successfully ruined my mood</p>",
        "id": 479440938,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730196016
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"350992\">Rémy Degenne</span> <a href=\"#narrow/channel/270676-lean4/topic/Improving.20the.20Windows.20user.20experience/near/479440592\">said</a>:</p>\n<blockquote>\n<p>Yes, that's annoying: you have to close VSCode before getting the cache or doing an update from the command line.</p>\n</blockquote>\n<p>I understand the solution, but can we come up with something better?</p>",
        "id": 479441041,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730196051
    },
    {
        "content": "<p>For the \"Device or resource busy\" errors, can you use the VS Code extension command to update <code>LeanAPAP</code>? It shuts down the language server before performing the update and restarts it afterwards.</p>\n<p>I tried doing so quickly on a Windows machine and the update of <code>LeanAPAP</code> in <code>pfr</code> goes through without errors.<br>\nI do see the following error when opening VS Code on Linux as well:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">mhuisi</span><span class=\"bp\">/</span><span class=\"n\">LeanProjects</span><span class=\"bp\">/</span><span class=\"n\">PFR</span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"c1\">--version</span>\n<span class=\"n\">Lake</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"mf\">5.0</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"mi\">01</span><span class=\"n\">d414a</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"mf\">4.13</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc3</span><span class=\"o\">)</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LeanAPAP</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">updating</span><span class=\"w\"> </span><span class=\"n\">repository</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">LeanAPAP'</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">revision</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">ece13c901dde033807bd3c72c40c9ae48f060f7b'</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">external</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">git'</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">128</span>\n<span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">configuration</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">errors</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">falling</span><span class=\"w\"> </span><span class=\"n\">back</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">plain</span><span class=\"w\"> </span><span class=\"ss\">`lean</span><span class=\"w\"> </span><span class=\"c1\">--server`</span>\n</code></pre></div>\n<p>Not sure what it's caused by.</p>\n<p>BTW, I'm not sure if <code>-R -Kenv=dev</code> is still necessary?</p>",
        "id": 479443873,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1730197005
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"350992\">Rémy Degenne</span> <a href=\"#narrow/channel/270676-lean4/topic/Improving.20the.20Windows.20user.20experience/near/479440592\">said</a>:</p>\n<blockquote>\n<p>Yes, that's annoying: you have to close VSCode before getting the cache or doing an update from the command line.</p>\n</blockquote>\n<p>You shouldn't have to do that if you use the VS Code commands for getting the cache or performing updates, since they try to ensure that the language server is shut down when running these commands.</p>",
        "id": 479444296,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1730197171
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/channel/270676-lean4/topic/Improving.20the.20Windows.20user.20experience/near/479443873\">said</a>:</p>\n<blockquote>\n<p>For the \"Device or resource busy\" errors, can you use the VS Code extension command to update <code>LeanAPAP</code>? It shuts down the language server before performing the update and restarts it afterwards.</p>\n</blockquote>\n<p>Is it <code>Lean 4: Project: Update dependency</code>? I did not know about this <span aria-label=\"idea\" class=\"emoji emoji-1f4a1\" role=\"img\" title=\"idea\">:idea:</span></p>",
        "id": 479444332,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730197188
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/270676-lean4/topic/Improving.20the.20Windows.20user.20experience/near/479444332\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/channel/270676-lean4/topic/Improving.20the.20Windows.20user.20experience/near/479443873\">said</a>:</p>\n<blockquote>\n<p>For the \"Device or resource busy\" errors, can you use the VS Code extension command to update <code>LeanAPAP</code>? It shuts down the language server before performing the update and restarts it afterwards.</p>\n</blockquote>\n<p>Is it <code>Lean 4: Project: Update dependency</code>? I did not know about this <span aria-label=\"idea\" class=\"emoji emoji-1f4a1\" role=\"img\" title=\"idea\">:idea:</span></p>\n</blockquote>\n<p>Yes!</p>",
        "id": 479444359,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1730197201
    },
    {
        "content": "<p>I'd really encourage projects to try to stop using <code>-R -Kenv=dev</code> if at all possible.</p>",
        "id": 479445722,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730197668
    },
    {
        "content": "<p>(I think a downstream project that has a standard require on doc-gen, and does the documentation generation, is the preferred alternative?)</p>",
        "id": 479445822,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730197696
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/channel/270676-lean4/topic/Improving.20the.20Windows.20user.20experience/near/479444296\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"350992\">Rémy Degenne</span> <a href=\"#narrow/channel/270676-lean4/topic/Improving.20the.20Windows.20user.20experience/near/479440592\">said</a>:</p>\n<blockquote>\n<p>Yes, that's annoying: you have to close VSCode before getting the cache or doing an update from the command line.</p>\n</blockquote>\n<p>You shouldn't have to do that if you use the VS Code commands for getting the cache or performing updates, since they try to ensure that the language server is shut down when running these commands.</p>\n</blockquote>\n<p>Yes I know and I want to get used to those VSCode commands, but since I am often in a terminal for git related things I tend to type lake commands there as well.</p>",
        "id": 479446258,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1730197848
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/270676-lean4/topic/Improving.20the.20Windows.20user.20experience/near/479445822\">said</a>:</p>\n<blockquote>\n<p>(I think a downstream project that has a standard require on doc-gen, and does the documentation generation, is the preferred alternative?)</p>\n</blockquote>\n<p>That preferred alternative means setting up and updating two projects instead of one: that's quite cumbersome.</p>",
        "id": 479446420,
        "sender_full_name": "Rémy Degenne",
        "timestamp": 1730197921
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"350992\">Rémy Degenne</span> <a href=\"#narrow/channel/270676-lean4/topic/Improving.20the.20Windows.20user.20experience/near/479440592\">said</a>:</p>\n<blockquote>\n<p>Yes, that's annoying: you have to close VSCode before getting the cache or doing an update from the command line.</p>\n</blockquote>\n<p>actually, just stopping the server seems to be enough to get the cache...</p>",
        "id": 479453719,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1730200426
    },
    {
        "content": "<p>(for me)</p>",
        "id": 479453772,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1730200442
    },
    {
        "content": "<p>still, this is not the best behaviour</p>",
        "id": 479453869,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1730200470
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/270676-lean4/topic/Improving.20the.20Windows.20user.20experience/near/479445822\">said</a>:</p>\n<blockquote>\n<p>(I think a downstream project that has a standard require on doc-gen, and does the documentation generation, is the preferred alternative?)</p>\n</blockquote>\n<p>This is not my preferred alternative for the reason Rémy is pointing out.</p>",
        "id": 479460134,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730202646
    },
    {
        "content": "<p>I haven't tried yet but a separate repo should not be necessary? It could be a separate directory with its own lakefile</p>",
        "id": 479463868,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1730203684
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110024\">Sebastian Ullrich</span> <a href=\"#narrow/channel/270676-lean4/topic/Improving.20the.20Windows.20user.20experience/near/479463868\">said</a>:</p>\n<blockquote>\n<p>I haven't tried yet but a separate repo should not be necessary? It could be a separate directory with its own lakefile</p>\n</blockquote>\n<p>I just tested it. It works great!</p>",
        "id": 479496897,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1730212717
    },
    {
        "content": "<p>I created a directory in my repo containing this <code>lakefile.toml</code>:</p>\n<div class=\"codehilite\" data-code-language=\"TOML\"><pre><span></span><code><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"Docs\"</span>\n\n<span class=\"k\">[[require]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"«doc-gen4»\"</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/leanprover/doc-gen4\"</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"main\"</span>\n\n<span class=\"k\">[[require]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&lt;fill-in-your-library-name&gt;</span>\n<span class=\"n\">path</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"..\"</span>\n\n<span class=\"k\">[[lean_lib]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"Docs\"</span>\n</code></pre></div>\n<p>For the <code>lean-toolchain</code> I just symlinked <code>../lean-toolchain</code>. And <code>Docs.lean</code> just imports my library.</p>",
        "id": 479499172,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1730213318
    },
    {
        "content": "<p>Then <code>lake build Docs:docs</code> works perfectly.</p>",
        "id": 479499381,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1730213381
    },
    {
        "content": "<p>Actually, <code>path = \"..\"</code> is dangerous since lake might try to delete that path! Better to require from your git repo.</p>",
        "id": 479512815,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1730217178
    },
    {
        "content": "<p>Well, I think I just discovered a serious bug in lake! <a href=\"https://github.com/leanprover/lean4/issues/5876\">lean4#5876</a></p>",
        "id": 479545685,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1730228490
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span> <span aria-label=\"up\" class=\"emoji emoji-2b06\" role=\"img\" title=\"up\">:up:</span></p>",
        "id": 479552098,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1730231156
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"119741\">@François G. Dorais</span> Ah, yes. I had discovered this bug while working on <a href=\"https://github.com/leanprover/lean4/pull/5864\">lean4#5864</a>. Since it had existed for a while and no one had reported an issue, I had hoped merging that would leave this danger unrealized. Apparently, no such luck. <span aria-label=\"cry\" class=\"emoji emoji-1f622\" role=\"img\" title=\"cry\">:cry:</span>  Regardless, thank you for reminding me of this, as the PR in question will not be part of the next release so I should separate this fix out. <span aria-label=\"thank you\" class=\"emoji emoji-1f64f\" role=\"img\" title=\"thank you\">:thank_you:</span></p>",
        "id": 479553042,
        "sender_full_name": "Mac Malone",
        "timestamp": 1730231554
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/pull/5878\">lean4#5878</a></p>",
        "id": 479554953,
        "sender_full_name": "Mac Malone",
        "timestamp": 1730232266
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span>, let's backport that one?</p>",
        "id": 479570246,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730238284
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span> Thank you for the quick response! I'm just happy that one of my typos finally did something good! <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 479599427,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1730257436
    },
    {
        "content": "<p>The fix mentions <code>..</code> explicitly. Is it also possible to escape the source dir by using <code>...</code>/<code>....</code> (EDIT: <a href=\"https://devblogs.microsoft.com/oldnewthing/20160202-00/?p=92953\">apparently I'm very old</a>) or slashes/backslashes?</p>",
        "id": 479625977,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1730275781
    },
    {
        "content": "<p>That <code>..</code> is the lean <code>..</code> not the posix <code>..</code></p>",
        "id": 479658957,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1730286888
    },
    {
        "content": "<p>Ah, makes sense, thanks</p>",
        "id": 479664938,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1730289030
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"221921\">@Marc Huisinga</span> <a href=\"#narrow/channel/270676-lean4/topic/Improving.20the.20Windows.20user.20experience/near/479443873\">said</a>:</p>\n<blockquote>\n<p>For the \"Device or resource busy\" errors, can you use the VS Code extension command to update <code>LeanAPAP</code>? It shuts down the language server before performing the update and restarts it afterwards.</p>\n</blockquote>\n<p>I just tried so and got<br>\n<a href=\"/user_uploads/3121/OJPnHQuYRCdF5OsBdbfIPMKe/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/OJPnHQuYRCdF5OsBdbfIPMKe/image.png\" title=\"image.png\"><img data-original-dimensions=\"552x128\" src=\"/user_uploads/thumbnail/3121/OJPnHQuYRCdF5OsBdbfIPMKe/image.png/840x560.webp\"></a></div>",
        "id": 479836474,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730367054
    },
    {
        "content": "<p>I assume it's because <code>.lake/lakefile.olean.lock</code> exists</p>",
        "id": 479836558,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730367090
    },
    {
        "content": "<p><code>rm .lake/lakefile.olean.lock</code> indeed fixes it. Should the action do this automatically?</p>",
        "id": 479836834,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730367188
    },
    {
        "content": "<p>The lock file exists to stop you changing the file while some other process is using it, so I don't think so</p>",
        "id": 479850781,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1730372156
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span> and I wanted to try splitting files in the context of <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/.2318328.20delay.20importing.20ultrafilters\">#mathlib4 &gt; #18328 delay importing ultrafilters</a>, so we updated my copy of mathlib, which made it go from 4.13.0-rc3 to 4.13.0 and then we tried getting cache</p>",
        "id": 480076885,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730477146
    },
    {
        "content": "<p>We pushed the extension buttons for roughly 20 minutes before giving up</p>",
        "id": 480077098,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730477221
    },
    {
        "content": "<p>I would consider the user experience of using Windows as \"Pretty bad\" <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span> Is this a shared diagnosis? Does <span class=\"user-mention\" data-user-id=\"221921\">@Marc Huisinga</span> want to hop on a screenshare call to see exactly what goes wrong?</p>",
        "id": 480077312,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730477300
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/270676-lean4/topic/Improving.20the.20Windows.20user.20experience/near/480076885\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> and I wanted to try splitting files in the context of <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/.2318328.20delay.20importing.20ultrafilters\">#mathlib4 &gt; #18328 delay importing ultrafilters</a>, so we updated my copy of mathlib, which made it go from 4.13.0-rc3 to 4.13.0 and then we tried getting cache</p>\n</blockquote>\n<p>The branch for that PR is only a few days old, and the <code>lean-toolchain</code> file in the branch says <code>leanprover/lean4:v4.13.0-rc3</code>. What actually happened, in your opinion: where could 4.13.0 have come from?</p>\n<blockquote>\n<p>We pushed the extension buttons for roughly 20 minutes before giving up</p>\n</blockquote>\n<p>When you put it like that, it doesn't sound like a good idea!</p>\n<blockquote>\n<p>I would consider the user experience of using Windows as \"Pretty bad\" <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span> Is this a shared diagnosis?</p>\n</blockquote>\n<p>It's mostly fine for me.</p>\n<p>Conceivably, lake or the vscode extension tried and failed to replace (for example) the <code>lean-toolchain</code> file, but didn't check the status of the operation (assuming that it could not fail, which might be a good assumption on Linux, but less so on Windows if a process might have had an open handle to the file), then signalled lake or lean to restart. If so, it's a small bug, and might even be easy to fix. These things happen. On behalf of my fellow programmers, I apologise for the inconvenience.</p>\n<p>If you can find a recipe to reliably reproduce the condition, please describe it here (or as an issue on Github if you can deduce that there is a bug in a particular program).</p>\n<p>Meanwhile as a general work-around for issues like this on Windows, close or kill all the processes concerned, then update the files they are using, then launch the application again.</p>",
        "id": 480138738,
        "sender_full_name": "Richard Copley",
        "timestamp": 1730511701
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"400544\">Richard Copley</span> <a href=\"#narrow/channel/270676-lean4/topic/Improving.20the.20Windows.20user.20experience/near/480138738\">said</a>:</p>\n<blockquote>\n<p>The branch for that PR is only a few days old, and the <code>lean-toolchain</code> file in the branch says <code>leanprover/lean4:v4.13.0-rc3</code>. What actually happened, in your opinion: where could 4.13.0 have come from?</p>\n</blockquote>\n<p>we were not on the branch we were on master</p>",
        "id": 480194251,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730533428
    },
    {
        "content": "<p>Could you be more specific?</p>",
        "id": 480431227,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1730722694
    },
    {
        "content": "<p>We were on mathlib master from a couple of days earlier, and decided to update. We did git pull (updating to 4.13.0), then fetched cache using the extension button. After this point, the file we were in (something like Data.Set.Finite) wouldn't build (it either said imports are out of date in red, or said it was building something in Aesop and was doing so really slowly), so we did a series of clean project, fetch cache, restart server and reload window in various orders. And after 20 minutes, the state of the file remained about the same, and we gave up.</p>",
        "id": 480435458,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1730724144
    },
    {
        "content": "<p>Was there an error in the troubleshooting output window while pulling the cache?</p>",
        "id": 480436542,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1730724514
    },
    {
        "content": "<p>Not that I saw, but I don't think I checked. Nothing popped up, but that's not to say there was nothing there for some other reason.</p>",
        "id": 480436644,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1730724552
    },
    {
        "content": "<p>Data.Set.Finite.Basic (or was it Data.Finite.Basic?) disappeared. Is that the reason? We had an issue with that on equational_theories too, hence checking.</p>",
        "id": 480440856,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730725918
    },
    {
        "content": "<p>I just tried the following steps on a Windows machine:</p>\n<ul>\n<li>Start on a clean slate with cache on b758def5262ecb106a626ec885176ed1ece2e4ba (commit that updated Mathlib to v4.13.0-rc3)</li>\n<li>Open VS Code in <code>Data.Set.Finite</code></li>\n<li>Check out d5ab93e3a3afadaf265a583a92f7e7c47203b540 (commit that updated Mathlib to v4.13.0) from a terminal</li>\n<li>Run 'Fetch Mathlib Build Cache' command in VS Code and wait until it completes</li>\n</ul>\n<p>At the end of the fetch cache operation, the server restarts automatically and the file works without errors. Do these concrete steps produce a different result for you?</p>",
        "id": 480479346,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1730736934
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> <span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span></p>",
        "id": 481103784,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1730980657
    },
    {
        "content": "<p>Will wait for Yaël on this, it was on their machine (I'm not on windows)</p>",
        "id": 481103914,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1730980703
    }
]