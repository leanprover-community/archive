[
    {
        "content": "<p>consider the <code>not_not</code> theorem which says <code>¬¬a ↔ a</code> (using an implicit <code>{a: Prop}</code>). using it I should be able to rewrite <code>¬¬a</code>  to <code>a</code> and vice versa. But consider following example</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬¬</span><span class=\"n\">p</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">not_not</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">assumption</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬¬</span><span class=\"n\">p</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- rw [← not_not]  -- can't match for rewrite</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">not_not</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">assumption</span>\n</code></pre></div>\n<p>when I try to rewrite <code>¬¬p</code> to  <code>p</code> it works smoothly. but to do the opposite, direct <code>rw</code> didn't work. the infoview showed </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">rewrite'</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">pattern</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">metavariable</span>\n<span class=\"w\">  </span><span class=\"bp\">?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">42</span>\n<span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">equation</span>\n<span class=\"w\">  </span><span class=\"bp\">?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">42</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">¬¬?</span><span class=\"n\">m</span><span class=\"bp\">.</span><span class=\"m\">42</span>\n</code></pre></div>\n<p>I had to convert <code>not_not</code> to explicit version and provide <code>p</code>. Why didn't this work direcly like first example?</p>",
        "id": 502215531,
        "sender_full_name": "Sabbir Rahman",
        "timestamp": 1740642467
    },
    {
        "content": "<p>I think because there is a check with <code>rw</code> that the LHS is not allowed to be a single variable. This is done because in those cases there tend to be too many possible matches to be able to semi-concistently choose the right match to rewrite</p>",
        "id": 502216834,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1740642911
    },
    {
        "content": "<p>You can also come across this if you want to use <code>one_mul</code> or <code>zero_add</code> in the reverse direction</p>",
        "id": 502217261,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1740643036
    },
    {
        "content": "<p>(for algebra purposes)</p>",
        "id": 502217298,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1740643048
    },
    {
        "content": "<p>Do note that in your case you still get to use <code>apply not_not.mp</code></p>",
        "id": 502217914,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1740643243
    },
    {
        "content": "<p>thanks, did not know about this check. yeah <code>apply not_not.mp</code> is the best way to go. But at least I learnt about the check so won't get surprise in future.</p>",
        "id": 502219131,
        "sender_full_name": "Sabbir Rahman",
        "timestamp": 1740643663
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"484770\">Sabbir Rahman</span> has marked this topic as resolved.</p>",
        "id": 502219267,
        "sender_full_name": "Notification Bot",
        "timestamp": 1740643701
    }
]