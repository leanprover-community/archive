[
    {
        "content": "<p>If I add a keyword to a syntax category, Lean seems to reserve it everywhere, such that I can't use it as an identifier at all. Is this intended behavior?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kd\">inductive</span><span class=\"w\"> </span><span class=\"n\">Animal</span><span class=\"w\"> </span><span class=\"n\">where</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">dog</span>\n\n<span class=\"n\">declare_syntax_cat</span><span class=\"w\"> </span><span class=\"n\">animal</span>\n<span class=\"c1\">-- Uncomment this line to break the code below</span>\n<span class=\"c1\">-- syntax \"dog\" : animal</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Animal</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"k\">#check</span><span class=\"w\"> </span><span class=\"n\">dog</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Animal</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Animal</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">dog</span>\n\n<span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Animal</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">  </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">dog</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">trivial</span>\n</code></pre></div>\n<p>The <a href=\"https://en.wikipedia.org/wiki/XY_problem\">#xy</a> is that I created a <a href=\"https://github.com/lambda-fairy/taleve/blob/a97b0245bbc9c0a12a4c2788f2f7e64db64a38e2/Taleve/Syntax.lean\">Tetris DSL</a>, and discovered that I can't write <code>case O</code> anymore. I can probably change the syntax to match general idents instead but I'm curious why Lean works this way.</p>",
        "id": 500007283,
        "sender_full_name": "Chris Wong",
        "timestamp": 1739709434
    },
    {
        "content": "<p>I think this is intended, you can add <code>(behavior := both)</code> or <code>(behavior := symbol)</code> to the end of your syntax category declaration and it will not reserve keywords everywhere.</p>",
        "id": 500014380,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1739715519
    },
    {
        "content": "<p>Nice, thanks!</p>\n<p>The <a href=\"https://github.com/leanprover/lean4/blob/ef759d874f079b8454469ffb51c2df101d520c69/src/Lean/Parser/Basic.lean#L1613-L1618\">doc comment for that option</a> sounds like my use case.</p>\n<p>I've added <code>(behavior := symbol)</code> to my code and that seems to fix it.</p>",
        "id": 500058504,
        "sender_full_name": "Chris Wong",
        "timestamp": 1739751546
    }
]