[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">grind</span><span class=\"w\"> </span><span class=\"n\">cases</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">grind</span><span class=\"w\"> </span><span class=\"n\">ext</span><span class=\"kd\">]</span>\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">foo₁</span><span class=\"w\"> </span><span class=\"n\">foo₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">foo₁</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">foo₂</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">grind</span>\n</code></pre></div>\n<p>I think the reason <code>grind</code> failed to prove this, is because it didn't establish <code>↑foo₁.eq = ↑foo₂.eq</code> equality. Could we improve this?</p>",
        "id": 555663373,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1763148458
    },
    {
        "content": "<p>It fails because it doesn't know <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Finset.coe_injective#doc\">docs#Finset.coe_injective</a></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">foo₁</span><span class=\"w\"> </span><span class=\"n\">foo₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">foo₁</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">foo₂</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">grind</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">inj</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">coe_injective</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 555667937,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1763150416
    },
    {
        "content": "<p>Ah, yes, you're right, it established <code>{a, ↑x, ↑x_1, ↑foo₁.x, ↑foo₂.x}</code>, <code>{x, foo₂.x}</code>, and <code>{x_1, foo₁.x}</code> classes, but couldn't merge the last two. Thanks!</p>\n<p>I didn't notice you had to use injectivity here, when I proved it by hand, because <code>simp</code> did that argument.</p>",
        "id": 555668844,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1763150707
    },
    {
        "content": "<p>I will merge the PR adding that annotation! :-)</p>",
        "id": 558884650,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1763893964
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/270676-lean4/topic/.60grind.60.20doesn't.20use.20the.20fact.20that.20Prop.20is.20a.20Subsingleton/near/558884650\">said</a>:</p>\n<blockquote>\n<p>I will merge the PR adding that annotation! :-)</p>\n</blockquote>\n<p>Could you link the PR, please?</p>",
        "id": 558915588,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1763924818
    },
    {
        "content": "<p>My reading of Kim's message is that if someone (perhaps you) makes that PR, then they'll merge it; not that it already exists!</p>",
        "id": 558917428,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1763926683
    },
    {
        "content": "<p>Aaah. I don't fully understand how <code>grind</code> works, so I'm not going to do it.</p>",
        "id": 558922040,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1763931063
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/32714\">#32714</a></p>",
        "id": 563100641,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1765425411
    }
]