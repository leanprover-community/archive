[
    {
        "content": "<p>I would like to be able to make restrictions on constructors which is allowed to use in constructors. Description is confusing, but here is example</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Node</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">leaf</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">node</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">children</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Node</span><span class=\"o\">)</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">leafsOnly</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leafs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Node</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">onlyLeafs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leafs</span><span class=\"bp\">.</span><span class=\"n\">all</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">leaf</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"w\"> </span><span class=\"o\">)</span>\n</code></pre></div>\n<p>But it doesn't work. Why I want it? Well, actual type has about 7 constructors, and predicate (restriction) should allow only 3 of them. I could split this inductive type into two, and inside \"superset\" inductive type make dedicated constructor for \"subset\". But I want to avoid it.</p>\n<p>Why it doesn't work? Is there a way to achieve what I want without splitting my type into two or more types?</p>",
        "id": 540916036,
        "sender_full_name": "Pavel Klimov",
        "timestamp": 1758591983
    },
    {
        "content": "<p>this is either an <a href=\"https://ncatlab.org/nlab/show/inductive-inductive+type\">inductive inductive type</a> or an <a href=\"https://ncatlab.org/nlab/show/inductive-recursive+type\">inductive recursive type</a> (I don't know enough type theory to tell which one) and Lean's type theory doesn't support either</p>",
        "id": 540916212,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1758592167
    },
    {
        "content": "<p>it should be possible to instead do it without the restriction and then restrict all at once after the inductive is finished being defined with a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Subtype#doc\">docs#Subtype</a></p>",
        "id": 540916296,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1758592249
    },
    {
        "content": "<p>Ok. Thanks. Will try subtype approach.</p>",
        "id": 540916410,
        "sender_full_name": "Pavel Klimov",
        "timestamp": 1758592337
    },
    {
        "content": "<p>By the way, <code>x matches .leaf</code> is an abbreviation for <code>match x with | .leaf =&gt; true | _ =&gt; false</code></p>",
        "id": 540993451,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1758628570
    }
]