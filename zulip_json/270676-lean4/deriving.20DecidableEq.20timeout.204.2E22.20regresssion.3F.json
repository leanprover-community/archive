[
    {
        "content": "<p>In 4.20 and 4.21 this works, but with 4.22-rc3 and -rc4 it runs out of heartbeats in the <code>deriving DecidableEq</code> line.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">History</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Sequent</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">rep</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">History</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">H</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"bp\">.</span><span class=\"n\">basic</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">LocalTableau</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">endNodesOf</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LocalTableau</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Tableau</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">History</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">loc</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Hist</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">nrep</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">rep</span><span class=\"w\"> </span><span class=\"n\">Hist</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">nbas</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"bp\">.</span><span class=\"n\">basic</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">lt</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LocalTableau</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span>\n<span class=\"w\">            </span><span class=\"o\">(</span><span class=\"n\">next</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">endNodesOf</span><span class=\"w\"> </span><span class=\"n\">lt</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Tableau</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">Hist</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tableau</span><span class=\"w\"> </span><span class=\"n\">Hist</span><span class=\"w\"> </span><span class=\"n\">X</span>\n\n<span class=\"c1\">-- With Lean 4.21.0 already 2000 beats is enough, but in 4.22.0 even 2000000 does not suffice.</span>\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">maxHeartbeats</span><span class=\"w\"> </span><span class=\"mi\">2000000</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">PathIn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Hist</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"n\">Tableau</span><span class=\"w\"> </span><span class=\"n\">Hist</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">nil</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PathIn</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">loc</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">nrep</span><span class=\"w\"> </span><span class=\"n\">nbas</span><span class=\"w\"> </span><span class=\"n\">lt</span><span class=\"w\"> </span><span class=\"n\">next</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Y_in</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">endNodesOf</span><span class=\"w\"> </span><span class=\"n\">lt</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">tail</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PathIn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">next</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Y_in</span><span class=\"o\">))</span>\n<span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PathIn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Tableau</span><span class=\"bp\">.</span><span class=\"n\">loc</span><span class=\"w\"> </span><span class=\"n\">nrep</span><span class=\"w\"> </span><span class=\"n\">nbas</span><span class=\"w\"> </span><span class=\"n\">lt</span><span class=\"w\"> </span><span class=\"n\">next</span><span class=\"o\">)</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">DecidableEq</span>\n</code></pre></div>\n<p>The difference can be observed on live lean by switching from \"latest Mathlib\" to \"Mathlib stable\" in the top-right drop down or <a href=\"https://live.lean-lang.org/#project=mathlib-stable&amp;codez=IYIxCcFMDcAIGVIEcCukB2AXWAuWAVATwAdJcBeWAGQEsBnbAOWEwChQIZYAJezAe3CFcBEmRyVaDBMjRZWAE0gAzWFGKwAFNxG8GgwgEotjEYlQZMxvAAVw/DRNinAEEQ9FKmRawA6EMDoaAGMTM1lLa0pTSgBtAEYAXQ9VKn4g4AAbfFAMyGAULQANMO8rESJSClg6QSFk2AwFRn4lOgB5VQBvQoBfEVT0rJy8guLAJMJqPi85bCca8DrWGnQFFCDMGmgybJBc/N0+A1gJ8xnj0VJWWFgAH1gMtNhOvWxerXR1EQAatUgNF9ghWMmnQ/jo30BfgCwWBGVm1DSmR2e1Ghiu1wxmOuIMgAA94YAAIlgAE1YG5Gs1Wh17pgADQEYb7TTFHB4F7GYnWBm7EY8KaFVisAC0QtgAHUaJgABbUPLoWAAFh8ACY4j4AAywTJQYAKYTK9WG2AgPKYcH0BrofgoADmUvpIBQ2GWipVyo1DS28oNht91UgkAAtuCrdgMNa7T5WHRIJgAPoODb8eWB4C47h5cCYE0scE+32a5ZLFZrDZbWA2FhSgCS8rwROe/J69ORvIB4wukFYd3QNAyIkr0trsDj3fuj06Hz+sFBARpM7x2GJfU0xLjLrwpPJK0pkHaqjhwMwwD7A6rw5x+JJJPX6EMaMxtnP8s0rfyPgeISnGln4LhC/xNElHATZlhtWAABFICCGgFGGABRJBWCAA\">here</a>.</p>\n<p>The example is a minimization from my <a href=\"https://github.com/m4lvin/lean4-pdl\">pdl project</a> that I am trying to upgrade. Also if instead of deriving the instance I <a href=\"https://github.com/m4lvin/lean4-pdl/commit/d3df48725af9ff1d3ef9f59e485b61edb09ff4bb\">write it by hand</a> the result was a <a href=\"https://github.com/m4lvin/lean4-pdl/actions/runs/16520202103/job/46720087577#step:5:226\">timeout</a>.</p>\n<p>With <code>set_option diagnostics true</code> I did not see anything suspicious in what is unfolded <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span> </p>\n<p>How should we further investigate this? Or is any regression like this known already?</p>\n<p>Cc <span class=\"user-mention\" data-user-id=\"315434\">@Andrés Goens</span> who helped me debug this (including running lean4checker on the output from 4.21 to exlude an old bug as the root cause.)</p>",
        "id": 530795379,
        "sender_full_name": "Malvin Gattinger",
        "timestamp": 1753456067
    },
    {
        "content": "<p>Curiously, removing the <code>nbas</code> proof argument in both inductives makes it work again <span aria-label=\"shock\" class=\"emoji emoji-1f628\" role=\"img\" title=\"shock\">:shock:</span> </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">History</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Sequent</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">rep</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">History</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">H</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">LocalTableau</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">endNodesOf</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LocalTableau</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Tableau</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">History</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">loc</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Hist</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">nrep</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">rep</span><span class=\"w\"> </span><span class=\"n\">Hist</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">lt</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LocalTableau</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span>\n<span class=\"w\">            </span><span class=\"o\">(</span><span class=\"n\">next</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">endNodesOf</span><span class=\"w\"> </span><span class=\"n\">lt</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Tableau</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">Hist</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tableau</span><span class=\"w\"> </span><span class=\"n\">Hist</span><span class=\"w\"> </span><span class=\"n\">X</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">PathIn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Hist</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"n\">Tableau</span><span class=\"w\"> </span><span class=\"n\">Hist</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">nil</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PathIn</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">loc</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">nrep</span><span class=\"w\"> </span><span class=\"n\">lt</span><span class=\"w\"> </span><span class=\"n\">next</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Y_in</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">endNodesOf</span><span class=\"w\"> </span><span class=\"n\">lt</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">tail</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PathIn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">next</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Y_in</span><span class=\"o\">))</span>\n<span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PathIn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Tableau</span><span class=\"bp\">.</span><span class=\"n\">loc</span><span class=\"w\"> </span><span class=\"n\">nrep</span><span class=\"w\"> </span><span class=\"n\">lt</span><span class=\"w\"> </span><span class=\"n\">next</span><span class=\"o\">)</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">DecidableEq</span>\n</code></pre></div>",
        "id": 530797774,
        "sender_full_name": "Malvin Gattinger",
        "timestamp": 1753456843
    },
    {
        "content": "<p>Even more strange, also removing <code>nrep</code> (while keeping <code>nbas</code>) in both inductives makes it work. So having one <code>Prop</code> field is fine, but having two triggers the problem. <span aria-label=\"confusion\" class=\"emoji emoji-1fae4\" role=\"img\" title=\"confusion\">:confusion:</span></p>\n<p>Merging them into one Prop argument that is a conjunction also makes the problem go away <span aria-label=\"detective\" class=\"emoji emoji-1f575\" role=\"img\" title=\"detective\">:detective:</span></p>",
        "id": 530798064,
        "sender_full_name": "Malvin Gattinger",
        "timestamp": 1753456950
    },
    {
        "content": "<p>Maybe this is related? <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/deriving.20DecidableEq.20gives.20kernel.20error.20for.20higher.20universes/with/530790718\">#mathlib4 &gt; deriving DecidableEq gives kernel error for higher universes</a></p>",
        "id": 531205032,
        "sender_full_name": "Malvin Gattinger",
        "timestamp": 1753647269
    },
    {
        "content": "<p>No that other issue is only for enum inductives (no parameters, no fields)</p>",
        "id": 531289944,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1753686105
    },
    {
        "content": "<p>Ah, okay. Then I am curious how to debug the issue about proof fields here.</p>",
        "id": 531381275,
        "sender_full_name": "Malvin Gattinger",
        "timestamp": 1753711905
    },
    {
        "content": "<p>Well it's a compiler error</p>",
        "id": 531401097,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1753717149
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"656225\">@Cameron Zwarich</span> it seems like it runs into some kind of infinite loop or at least infinite blowup in <code>toLCNF</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"mi\">0</span><span class=\"w\">  </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd76bccd30</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">mi_free</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libInit_shared</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">1</span><span class=\"w\">  </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd76b95da5</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">lean_dec_ref_cold</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libInit_shared</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">2</span><span class=\"w\">  </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6e62709a</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Meta_inferTypeImp_infer</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">3</span><span class=\"w\">  </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6e6106a4</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">lean_infer_type</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">4</span><span class=\"w\">  </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb0ff0f</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_etaExpandN___redArg</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">5</span><span class=\"w\">  </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb10fc9</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_expandNoConfusionMajor___redArg</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">6</span><span class=\"w\">  </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb291c3</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_visitNoConfusion___lam__0</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">7</span><span class=\"w\">  </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd76ba9910</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">lean_apply_6</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libInit_shared</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">8</span><span class=\"w\">  </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb2c04b</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_etaIfUnderApplied</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">9</span><span class=\"w\">  </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb2a9ab</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_visitNoConfusion___lam__1</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb2c94f</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_visitNoConfusion___lam__1___boxed</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">11</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd76baafa1</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">lean_apply_7</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libInit_shared</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">12</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb2c657</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_visitNoConfusion___lam__2</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">13</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd76ba9512</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">lean_apply_6</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libInit_shared</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">14</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb2c04b</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_etaIfUnderApplied</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">15</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb25cdb</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_visitNoConfusion</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">16</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb19113</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_visitApp</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">17</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb17311</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_visitCore</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">18</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb1f27e</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_visit</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">19</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb1fd7a</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_visitLambda___lam__0</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">20</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd76ba9755</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">lean_apply_6</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libInit_shared</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">21</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb09a8b</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_withNewScope___redArg</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">22</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb198e3</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_visitLambda</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">23</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb177d0</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_visitCore</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">24</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb1f27e</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_visit</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">25</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb39fce</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_visitHEqRec___lam__0</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">26</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd6fb3a254</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">l_Lean_Compiler_LCNF_ToLCNF_toLCNF_visitHEqRec___lam__0___boxed</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libleanshared_1</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">#</span><span class=\"mi\">27</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x00007ffd76ba9593</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">lean_apply_6</span><span class=\"w\"> </span><span class=\"o\">()</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">robin</span><span class=\"bp\">/</span><span class=\"n\">lean4dev</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">libInit_shared</span><span class=\"bp\">.</span><span class=\"n\">dll</span>\n<span class=\"bp\">...</span>\n</code></pre></div>",
        "id": 531401599,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1753717300
    },
    {
        "content": "<p>Thanks for narrowing it down <span class=\"user-mention\" data-user-id=\"873547\">@Robin Arnez</span>. I honestly haven't gone through the <code>noConfusion</code> lowering here and it's somewhat involved, so it may take a bit of time to figure this out. My hope would be that we just missed some place where we can replace a term with <code>lcProof</code> and avoid recursing.</p>",
        "id": 531408287,
        "sender_full_name": "Cameron Zwarich",
        "timestamp": 1753719226
    },
    {
        "content": "<p>yeah it does seem to be a bug in the new compiler! if we add </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">compiler</span><span class=\"bp\">.</span><span class=\"n\">enableNew</span><span class=\"w\"> </span><span class=\"n\">false</span>\n</code></pre></div>\n<p>it works again, and if we set that to true in <code>4.21</code> it breaks there too</p>",
        "id": 531520229,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1753769081
    },
    {
        "content": "<p>I guess it makes sense to make an issue in the Lean4 repo?</p>",
        "id": 531520336,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1753769116
    },
    {
        "content": "<p>I wanted to try out if the new compiler can be en/disabled locally, but already this gives <code>failed to compile definition</code> when using \"Latest Mathlib\" <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span> </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">compiler</span><span class=\"bp\">.</span><span class=\"n\">enableNew</span><span class=\"w\"> </span><span class=\"n\">false</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">History</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Sequent</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">rep</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">History</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">H</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"bp\">.</span><span class=\"n\">basic</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">LocalTableau</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">endNodesOf</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LocalTableau</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"w\"> </span><span class=\"c1\">-- failed to compile definition</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Tableau</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">History</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Sequent</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">loc</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Hist</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">nrep</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">rep</span><span class=\"w\"> </span><span class=\"n\">Hist</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">nbas</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"bp\">.</span><span class=\"n\">basic</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">lt</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LocalTableau</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span>\n<span class=\"w\">            </span><span class=\"o\">(</span><span class=\"n\">next</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">endNodesOf</span><span class=\"w\"> </span><span class=\"n\">lt</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Tableau</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">Hist</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Tableau</span><span class=\"w\"> </span><span class=\"n\">Hist</span><span class=\"w\"> </span><span class=\"n\">X</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">PathIn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Hist</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"n\">Tableau</span><span class=\"w\"> </span><span class=\"n\">Hist</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">nil</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PathIn</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">loc</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">nrep</span><span class=\"w\"> </span><span class=\"n\">nbas</span><span class=\"w\"> </span><span class=\"n\">lt</span><span class=\"w\"> </span><span class=\"n\">next</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Y_in</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">endNodesOf</span><span class=\"w\"> </span><span class=\"n\">lt</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">tail</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PathIn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">next</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"n\">Y_in</span><span class=\"o\">))</span>\n<span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PathIn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Tableau</span><span class=\"bp\">.</span><span class=\"n\">loc</span><span class=\"w\"> </span><span class=\"n\">nrep</span><span class=\"w\"> </span><span class=\"n\">nbas</span><span class=\"w\"> </span><span class=\"n\">lt</span><span class=\"w\"> </span><span class=\"n\">next</span><span class=\"o\">)</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"c1\">-- failed to compile definition?</span>\n</code></pre></div>",
        "id": 531554167,
        "sender_full_name": "Malvin Gattinger",
        "timestamp": 1753780076
    },
    {
        "content": "<p>In order for it to work, everything it depends on also needs to have been compiled with the old compiler. If you look at the <code>sorry</code>, you'll see that it actually contains a <code>Name</code> and the old IR and new IR clash in weird ways. The <code>DecidableEq PathIn</code> similarly refers to <code>instDecidableEqNat</code> which the old compiler handles differently to the new compiler - boom crash</p>",
        "id": 531561528,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1753782065
    },
    {
        "content": "<p>Besides, the old compiler doesn't exist on nightly anymore :-)</p>",
        "id": 531561647,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1753782091
    },
    {
        "content": "<p>For the record, in the new 4.23.0-rc2 and current nightly this still happens, so I <a href=\"https://github.com/leanprover/lean4/issues/9971\">made an issue in the lean4 repo now</a>.</p>",
        "id": 535005832,
        "sender_full_name": "Malvin Gattinger",
        "timestamp": 1755543765
    },
    {
        "content": "<p>It seems <span class=\"user-mention\" data-user-id=\"656225\">@Cameron Zwarich</span> has found the issue and fixed this now <a href=\"https://github.com/leanprover/lean4/commit/dc5766d27a27be935a1efe348ffe7a447edce574\">https://github.com/leanprover/lean4/commit/dc5766d27a27be935a1efe348ffe7a447edce574</a> <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span> looking forward to testing it in my project soon!</p>",
        "id": 535793156,
        "sender_full_name": "Malvin Gattinger",
        "timestamp": 1755939645
    }
]