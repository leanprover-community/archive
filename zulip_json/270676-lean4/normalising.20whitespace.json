[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span> <span class=\"user-mention\" data-user-id=\"221921\">@Marc Huisinga</span> </p>\n<p>In Mathlib we have a <code>.vscode/settings.json</code> file containing:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"o\">{</span>\n  <span class=\"s2\">\"editor.insertSpaces\"</span><span class=\"o\">:</span> <span class=\"n\">true</span><span class=\"o\">,</span>\n  <span class=\"s2\">\"editor.tabSize\"</span><span class=\"o\">:</span> <span class=\"mi\">2</span><span class=\"o\">,</span>\n  <span class=\"s2\">\"editor.rulers\"</span> <span class=\"o\">:</span> <span class=\"o\">[</span><span class=\"mi\">100</span><span class=\"o\">],</span>\n  <span class=\"s2\">\"files.encoding\"</span><span class=\"o\">:</span> <span class=\"s2\">\"utf8\"</span><span class=\"o\">,</span>\n  <span class=\"s2\">\"files.eol\"</span><span class=\"o\">:</span> <span class=\"s2\">\"</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span><span class=\"o\">,</span>\n  <span class=\"s2\">\"files.insertFinalNewline\"</span><span class=\"o\">:</span> <span class=\"n\">true</span><span class=\"o\">,</span>\n  <span class=\"s2\">\"files.trimFinalNewlines\"</span><span class=\"o\">:</span> <span class=\"n\">true</span><span class=\"o\">,</span>\n  <span class=\"s2\">\"files.trimTrailingWhitespace\"</span><span class=\"o\">:</span> <span class=\"n\">true</span><span class=\"o\">,</span>\n<span class=\"o\">}</span>\n</code></pre></div>\n<p>Mostly this is basic whitespace normalisation. I would really like to see this effortlessly become the defaults in all new projects.</p>\n<p>Take a moment, for example, to look at <span class=\"user-mention\" data-user-id=\"110031\">@Patrick Massot</span> trying to help Terry Tao, but there are spurious whitespace changes everywhere: <a href=\"https://github.com/teorth/symmetric_project/pull/8/files\">https://github.com/teorth/symmetric_project/pull/8/files</a>. Not cool!</p>\n<p>It seems there are two ways we could achieve this:</p>\n<ul>\n<li>Can the VSCode extension just change the defaults to these for Lean files?</li>\n<li>If not, can the standard <code>lake new</code> template include these?</li>\n</ul>\n<p>We need <em>some</em> fix for this.</p>",
        "id": 397407427,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1697679477
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Scott Morrison</span> One question here is what about users using other editors (e.g., EMACS or neovim)? Having inconsistency between editor configurations seems like it would cause just as much confusion.</p>",
        "id": 397408174,
        "sender_full_name": "Mac Malone",
        "timestamp": 1697680016
    },
    {
        "content": "<p>I think I'd just quote Leo's recent statement about the primacy of VSCode. :-)</p>",
        "id": 397408225,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1697680069
    },
    {
        "content": "<p>I mean, of course we can suggest that the maintainers of those editor extensions coordinate.</p>",
        "id": 397408289,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1697680093
    },
    {
        "content": "<p>But I don't think we should wait on them.</p>",
        "id": 397408302,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1697680110
    },
    {
        "content": "<p>I admit I don't know who maintains the emacs and neovim extensions; anyone who does know could ping them here!</p>",
        "id": 397408333,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1697680139
    },
    {
        "content": "<p>I believe <span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span> is responsible for the neovim extension and I believe <span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span> is at least a major contributor to the EMACS extension.</p>",
        "id": 397408382,
        "sender_full_name": "Mac Malone",
        "timestamp": 1697680198
    },
    {
        "content": "<p>lean.nvim already defaults to all of that besides auto-trimming whitespace FWIW.</p>",
        "id": 397408777,
        "sender_full_name": "Julian Berman",
        "timestamp": 1697680490
    },
    {
        "content": "<p>One other concern I have is there exist a number of pitfalls when it comes to committing the <code>.vscode</code> folder. Folder settings cannot be extended and override user settings. Thus, if a user has extensions that need to be configured via the <code>settings.json</code> and are local to a machine it is hard to do so. The only workaround I know for this is to create VSCode workspace for the file (i.e., a <code>.codw-workspace</code> file) -- though I am not sure if there are any limitations to that solution. See, for example, <a href=\"https://stackoverflow.com/questions/32964920/should-i-commit-the-vscode-folder-to-source-control\">this StackOverflow question</a> which has some extensive discussion of the pros and cons of this in the anwers and comments.</p>",
        "id": 397408935,
        "sender_full_name": "Mac Malone",
        "timestamp": 1697680621
    },
    {
        "content": "<p>We have some control over extensions installed during VSCode setup right? Maybe installing the <a href=\"https://marketplace.visualstudio.com/items?itemName=EditorConfig.EditorConfig\">editorconfig extension</a> and putting those settings there solves some of that (though I haven't read that thread fully honestly)</p>",
        "id": 397409253,
        "sender_full_name": "Julian Berman",
        "timestamp": 1697680834
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Scott Morrison</span> <a href=\"#narrow/stream/270676-lean4/topic/normalising.20whitespace/near/397408302\">said</a>:</p>\n<blockquote>\n<p>But I don't think we should wait on them.</p>\n</blockquote>\n<p>To state the obvious, we can safely assume that users of editors other than VScode are experts (i.e., computer experts, not necessarily Lean experts) so changes to reduce errors can prioritize VS code.</p>",
        "id": 397432222,
        "sender_full_name": "Siddhartha Gadgil",
        "timestamp": 1697693649
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/vscode-lean4/pull/341\">vscode-lean4#341</a> adjusts the defaults for whitespace.</p>",
        "id": 397453560,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1697703199
    },
    {
        "content": "<p>If we find that users commonly have user settings configured that override these defaults in undesirable ways, we can revisit the question of whether we want to generate a <code>settings.json</code>that overrides their own settings entirely.</p>",
        "id": 397454924,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1697703713
    },
    {
        "content": "<p>Generating a default editorconfig file with the desired settings seems like a nice improvement as well</p>",
        "id": 397565828,
        "sender_full_name": "David Thrane Christiansen",
        "timestamp": 1697744057
    },
    {
        "content": "<p>I think that an editorconfig file may be better generated in lake, because users of other editors are unlikely to use VS Code to initialize their project.</p>",
        "id": 397639239,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1697783391
    },
    {
        "content": "<p>I agree - I had thought that VSCode used Lake to set up the projects, but I suppose I was wrong</p>",
        "id": 397688135,
        "sender_full_name": "David Thrane Christiansen",
        "timestamp": 1697800876
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"354934\">David Thrane Christiansen</span> <a href=\"#narrow/stream/270676-lean4/topic/normalising.20whitespace/near/397688135\">said</a>:</p>\n<blockquote>\n<p>I agree - I had thought that VSCode used Lake to set up the projects, but I suppose I was wrong</p>\n</blockquote>\n<p>VS Code uses Lake to set up projects, but the new VS Code commands do a few other things beyond just calling the lake command. One of these things could be to also initialize it with a <code>settings.json</code> (<a href=\"https://github.com/leanprover-community/vscode-lean4/pull/325\">vscode-lean4#325</a>), but if we go the editorconfig route, it should definitely be lake that sets it up.</p>",
        "id": 397688605,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1697801032
    },
    {
        "content": "<p>I think editorconfig route sounds like a good idea. However, I have never used it before. What do we want the default file to look like?</p>",
        "id": 397902361,
        "sender_full_name": "Mac Malone",
        "timestamp": 1697946403
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"315577\">Mac Malone</span> <a href=\"#narrow/stream/270676-lean4/topic/normalising.20whitespace/near/397902361\">said</a>:</p>\n<blockquote>\n<p>I think editorconfig route sounds like a good idea. However, I have never used it before. What do we want the default file to look like?</p>\n</blockquote>\n<p>The <a href=\"https://marketplace.visualstudio.com/items?itemName=EditorConfig.EditorConfig\">editorconfig extension</a> supports six properties, which are coincidentally almost exactly <a href=\"https://github.com/leanprover-community/mathlib4/blob/master/.vscode/settings.json\">those that are used by mathlib4</a>, so we should probably just assign them in this way.</p>",
        "id": 397920000,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1697959928
    }
]