[
    {
        "content": "<h2>Summary</h2>\n<p>purescript has Anonymous records and polymorphic field constrants</p>\n<p><a href=\"https://github.com/purescript/documentation/blob/master/language/Records.md\">https://github.com/purescript/documentation/blob/master/language/Records.md</a></p>\n<p><a href=\"https://pursuit.purescript.org/builtins/docs/Prim#t:Row\">https://pursuit.purescript.org/builtins/docs/Prim#t:Row</a><br>\n<a href=\"https://pursuit.purescript.org/builtins/docs/Prim.Row\">https://pursuit.purescript.org/builtins/docs/Prim.Row</a><br>\n<a href=\"https://pursuit.purescript.org/builtins/docs/Prim.RowList\">https://pursuit.purescript.org/builtins/docs/Prim.RowList</a></p>\n<h2>Motivation</h2>\n<ol>\n<li>Why anonymous records are great?</li>\n</ol>\n<p>they are shorter</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"n\">Foo</span>\n<span class=\"w\">  </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Foo1</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Foo2</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>\n<ol start=\"2\">\n<li>Why polymorphic field constrants is great?</li>\n</ol>\n<p>rn can implement</p>\n<div class=\"codehilite\" data-code-language=\"purs\"><pre><span></span><code>-- A function that works on any record with a name field\nsayHello : { r | name : String } -&gt; String\nsayHello person = \"Hello, \" ++ person.name ++ \"!\"\n\n-- Compatible with multiple records\ngreeting1 : String\ngreeting1 = sayHello { name = \"Alice\", age = 25 }\n\ngreeting2 : String\ngreeting2 = sayHello { name = \"Charlie\", city = \"London\" }\n</code></pre></div>\n<p>what You think, guys, if I would implement it for lean4? how it would look like?</p>\n<p>P.S. </p>\n<p><a href=\"https://discord.com/channels/827106007712661524/1317862641070374993\">(from idris2 discord channel)</a>: idris2 has <a href=\"https://github.com/kuribas/idris-records\">https://github.com/kuribas/idris-records</a> and it allows to implement polymorphic field constrants </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">sayHello</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasField</span><span class=\"w\"> </span><span class=\"s2\">\"name\"</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">SimpleRecord</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">String</span>\n<span class=\"n\">sayHello</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"Hello \"</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">!!</span><span class=\"w\"> </span><span class=\"s2\">\"name\"</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"s2\">\"!\"</span>\n</code></pre></div>\n<p>but not</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"n\">Foo</span>\n<span class=\"w\">  </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Foo1</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Foo2</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>\n<p>P.S. we need channel exlusively for prs for lean4</p>",
        "id": 490284603,
        "sender_full_name": "Serhii Khoma (srghma)",
        "timestamp": 1734774649
    },
    {
        "content": "<p>If you really don't want more than what you showed in your example then you can use a macro.</p>",
        "id": 490289194,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1734779158
    },
    {
        "content": "<p>I don't really see any great benefit to <code>HasField \"name\" String</code> vs <code>clas MyHasName A where name (a : A) : String</code></p>",
        "id": 490291473,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1734781253
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"813382\">serhii khoma (srghma)</span> <a href=\"#narrow/stream/270676-lean4/topic/RFC.3A.20Anonymous.20records.20and.20polymorphic.20field.20constrants/near/490284603\">said</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"Haskell\"><pre><span></span><code><span class=\"kr\">data</span><span class=\"w\"> </span><span class=\"kt\">Foo</span>\n<span class=\"w\">  </span><span class=\"ow\">=</span><span class=\"w\"> </span><span class=\"kt\">Foo1</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"ow\">::</span><span class=\"w\"> </span><span class=\"kt\">String</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"ow\">::</span><span class=\"w\"> </span><span class=\"kt\">String</span><span class=\"w\"> </span><span class=\"p\">}</span>\n<span class=\"w\">  </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"kt\">Foo2</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"ow\">::</span><span class=\"w\"> </span><span class=\"kt\">Int</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"ow\">::</span><span class=\"w\"> </span><span class=\"kt\">Int</span><span class=\"w\"> </span><span class=\"p\">}</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Can you elaborate on what is different here vs what Lean already has?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Foo</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Foo1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Foo2</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 490291658,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1734781429
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/270676-lean4/topic/RFC.3A.20Anonymous.20records.20and.20polymorphic.20field.20constrants/near/490291658\">said</a>:</p>\n<blockquote>\n<p>Can you elaborate on what is different here vs what Lean already has?</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Foo</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Foo1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Foo2</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>positional arguments very easily allow to miss order of arguments</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Foo</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Foo1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Foo2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"bp\">.</span><span class=\"n\">Foo1</span><span class=\"w\"> </span><span class=\"s2\">\"hoho\"</span><span class=\"w\"> </span><span class=\"s2\">\"hehe\"</span>\n</code></pre></div>\n<p>while with records this is would be impossible</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Foo</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Foo1</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Foo2</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"w\"> </span><span class=\"o\">}</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"bp\">.</span><span class=\"n\">Foo1</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">hehe</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"hehe\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hoho</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"hoho\"</span><span class=\"w\"> </span><span class=\"o\">}</span>\n\n<span class=\"c1\">-- and order is arbitrary</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"bp\">.</span><span class=\"n\">Foo1</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">hoho</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"hoho\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hehe</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"hehe\"</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>",
        "id": 490347184,
        "sender_full_name": "Serhii Khoma (srghma)",
        "timestamp": 1734831502
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span> <a href=\"#narrow/channel/270676-lean4/topic/RFC.3A.20Anonymous.20records.20and.20polymorphic.20field.20constrants/near/490289194\">said</a>:</p>\n<blockquote>\n<p>If you really don't want more </p>\n</blockquote>\n<p>like what for example?</p>\n<blockquote>\n<p>than what you showed in your example then you can use a macro.</p>\n</blockquote>\n<p>could You demonstrate? tnx</p>",
        "id": 490347282,
        "sender_full_name": "Serhii Khoma (srghma)",
        "timestamp": 1734831614
    },
    {
        "content": "<p>Are you familiar with named arguments?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"bp\">.</span><span class=\"n\">Foo1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"hoho\"</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"s2\">\"hehe\"</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 490347289,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1734831624
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> </p>\n<p>but how about using multi-valued records in already existing types</p>\n<p>How to write something like this in lean?</p>\n<p>NOTE: <a href=\"https://try.purescript.org/?code=LYewJgrgNgpgBAWQIYEsB2cDuALGAnGAKEJWAAcQ8AXOABQKgjCJPMpoBEkqkA6AMRBQwSAEaw4ACgBmQsAEpWFanACi06TADGNSes07FpZTQAqeAJ60IBAMpa8KMruwBGADRxsAJk9lPVDAAHlSeUCgAzqFw6Mxo0eFoANaeBGjMeJ5a4DBGbCpcPLyqKFS4eMRUFmTwCBaqeHiUcAC8aqXlcADecGhIwPAAXINwtlSOaADmngMREUiTQyNjE5NwAL7dcLIgcMNwAJLxnqJIeHsjRzTrxJGqAI4XcABCIEIwSGgkEQ%2BtUgAyMGkNB6fQGIwARK4ITMYHMFjBIbN5osIRsnnUGk08PJWm1AcCtmDEXAId4YXBkQikXCUTA0TdCMBUBh9vptDQAKpoUpMlmtQhwOBpDJwAAk2zkgqFcAA2l5XFJAiFxXAItgQJgYj97ooZXAALpAA\">in purescript it generates the Eq type automatically</a></p>\n<div class=\"codehilite\" data-code-language=\"purs\"><pre><span></span><code>import Data.Either\n\ntype MyError = Either { name :: String, message :: String } { foo :: Int, bar :: Int }\n\nisEq :: Boolean\nisEq = (Left { name: \"1\", message: \"message\" } :: MyError) == Left { name: \"2\", message: \"message\" }\n</code></pre></div>\n<p>like <a href=\"https://github.com/kuribas/idris-records/blob/4a5784648d3f8b544e7a375431fa70698e8ed6fc/src/Records.idr#L47\">https://github.com/kuribas/idris-records/blob/4a5784648d3f8b544e7a375431fa70698e8ed6fc/src/Records.idr#L47</a> but with macros</p>\n<hr>\n<p>and supporting it in lean would allow to generate efficient code (e.g. if in future lean will be able to generate javascript - then use ordinary javascript Object)</p>",
        "id": 490504559,
        "sender_full_name": "Serhii Khoma (srghma)",
        "timestamp": 1734954415
    },
    {
        "content": "<p>You can do this in Lean using deriving</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Foo</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Foo1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Foo2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hehe</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hoho</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">DecidableEq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">ToJson</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"bp\">.</span><span class=\"n\">Foo1</span><span class=\"w\"> </span><span class=\"s2\">\"hoho\"</span><span class=\"w\"> </span><span class=\"s2\">\"hehe\"</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">==</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">ToJson</span><span class=\"bp\">.</span><span class=\"n\">toJson</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>",
        "id": 490505144,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1734954694
    },
    {
        "content": "<p>Here's the lean translation of <code>MyError</code></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">NameMessage</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">message</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span>\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">FooBar</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">MyError</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"w\"> </span><span class=\"n\">NameMessage</span><span class=\"w\"> </span><span class=\"n\">FooBar</span>\n</code></pre></div>",
        "id": 490505350,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1734954776
    },
    {
        "content": "<p>I think anonymous structures wouldn't be a great idea, because then you end up with <code>MyError._anonstruct_1.name</code> instead of <code>NameMessage.name</code> in the environment.</p>",
        "id": 490505562,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1734954856
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/270676-lean4/topic/RFC.3A.20Anonymous.20records.20and.20polymorphic.20field.20constrants/near/490505562\">said</a>:</p>\n<blockquote>\n<p>I think anonymous structures wouldn't be a great idea, because then you end up with <code>MyError._anonstruct_1.name</code> instead of <code>NameMessage.name</code> in the environment.</p>\n</blockquote>\n<p><a href=\"https://github.com/kuribas/idris-records/blob/4a5784648d3f8b544e7a375431fa70698e8ed6fc/src/Records.idr#L169-L175\">idris has</a></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">|||</span><span class=\"w\"> </span><span class=\"n\">Get</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">field</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">label</span>\n<span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">export</span>\n<span class=\"n\">get</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">lbl</span><span class=\"o\">:</span><span class=\"n\">String</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span>\n<span class=\"w\">      </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FieldToType</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">HasField</span><span class=\"w\"> </span><span class=\"n\">lbl</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">Record</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">lbl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"bp\">-&gt;</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">))</span>\n</code></pre></div>",
        "id": 490759661,
        "sender_full_name": "Serhii Khoma (srghma)",
        "timestamp": 1735117200
    },
    {
        "content": "<p>Sure, but the implementation of the <code>HasField</code> instance is still going to refer to the internal anonymous name,</p>",
        "id": 490815112,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1735167952
    }
]