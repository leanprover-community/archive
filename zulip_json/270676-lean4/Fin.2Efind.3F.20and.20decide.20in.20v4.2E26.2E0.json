[
    {
        "content": "<p>I'm bumping PhysLean to v4.26.0, in which Mathlib's <code>Fin.find</code> has been replaced with <code>Fin.find?</code> in Batteries.  The latter does not seem to work nicely with decide. In particular, </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">}}</span>\n<span class=\"w\">     </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">find?</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">({</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">decide</span><span class=\"w\"> </span><span class=\"c1\">-- does not work in v4.26.0</span>\n</code></pre></div>\n<p>does not work, whilst in v4.24.0 (for example): </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">}}</span>\n<span class=\"w\">    </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">find</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">({</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">decide</span><span class=\"w\"> </span><span class=\"c1\">-- works in v4.24.0</span>\n</code></pre></div>\n<p>worked (see <a href=\"https://live.lean-lang.org/#project=mathlib-v4.24.0&amp;codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQOCmAHkuOvnAFxxxnwDGlcAYsAHYDO+8AFCx13F5s4AJgCUYygF44Ab1kAGADRwAjAF91OatT4A6AGZsAJoIMBXVnABWcKQD5BildfVxAEERw6e1RLtx2CBByVWk4LABPbThjfDpgWKA\">here</a>). There are a number of results in PhysLean which were using decide and somewhere along the lines used <code>Fin.find</code>. Is there  a known solution to this?</p>",
        "id": 564059358,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1765896440
    },
    {
        "content": "<p>Does <code>decide +kernel</code> work?</p>",
        "id": 564060348,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1765896701
    },
    {
        "content": "<p>As Bhavik points out, it seems to be a reducibility setting.  Also <code>with_unfolding_all decide</code> works.</p>",
        "id": 564060817,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1765896815
    },
    {
        "content": "<p>Weird adding <code>+kernel</code> works on the online playground, but not locally - I must be missing an import.</p>",
        "id": 564061092,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1765896883
    },
    {
        "content": "<p>Actually, this does not work on <code>Mathlib stable</code> on the online playground (see <a href=\"https://live.lean-lang.org/#project=mathlib-stable&amp;codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQOCmAHkuOvnAFxxxnwDGlcAYsAHYDO+8AFCx13F5s4AJgCUYygF44Ab1kAGADRwAjAF91Oajr4A6AGZsAJgH5BBgK6s4AKzhSAfIMUrb6uIAgiOHT2qJDnDsECDkqtJwWACe2nDG+HTA8XAA1ADW+FCs+OhwALR5cRD47HCsEPAA7tBpcMIAbgAseiIAbHoKeEA\">here</a>), only on the latest version.</p>",
        "id": 564061884,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1765897087
    },
    {
        "content": "<p>Here is a Mathlib independent version which works on <code>Mathlib latest</code> i.e. <code>v4.27.0-rc1</code> but not on <code>Mathlib stable</code> i.e. <code>v4.26.0</code>: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">find?</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">decide</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"n\">kernel</span>\n</code></pre></div>",
        "id": 564066269,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1765898033
    },
    {
        "content": "<p>To fix the bump, does <code>simp +decide</code> work?</p>",
        "id": 564067482,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1765898341
    },
    {
        "content": "<p>No it doesn't, not on my examples above, nor on my 'real case'. One option would be to just bump straight to v4.27.0-rc1, but ideally I would like to have a version on a stable bump.</p>",
        "id": 564068609,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1765898619
    }
]