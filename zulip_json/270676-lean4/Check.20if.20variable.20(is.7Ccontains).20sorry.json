[
    {
        "content": "<p>Hi all, this may be a very simple question but I can't find a simple solution. In my code, I'm passed a Finset (for example) defined by a student, and before I do anything else with it I want to check if this object is sorry (or if its definition anywhere contains sorry), any idea how to do that? Thanks!</p>",
        "id": 574584161,
        "sender_full_name": "Cas Widdershoven",
        "timestamp": 1771441605
    },
    {
        "content": "<p>You can use <code>#print axioms declName</code> to see the axioms that <code>declName</code> depends on, if <code>declName</code> depends transitively on <code>sorry</code> then this list will contain <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=sorryAx#doc\">docs#sorryAx</a>.</p>",
        "id": 574585479,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1771442063
    },
    {
        "content": "<p>Is there any way to do this in code? Instead of a command I'd like a term telling me whether the Finset is sorry, so that I can modify the program flow accordingly</p>",
        "id": 574591999,
        "sender_full_name": "Cas Widdershoven",
        "timestamp": 1771444390
    },
    {
        "content": "<p>there's <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Expr.hasSorry#doc\">docs#Lean.Expr.hasSorry</a> but this doesn't transitively check the declarations used in the expression</p>",
        "id": 574592753,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1771444662
    },
    {
        "content": "<p>there's also <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Mathlib.PrintSorries.collectSorries#doc\">docs#Mathlib.PrintSorries.collectSorries</a></p>",
        "id": 574593563,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1771444936
    },
    {
        "content": "<p>Could you explain what you are trying to accomplish? It seems what you are trying to do is only possible at the meta level but its unclear if you are trying to use this information at the object level.</p>",
        "id": 574612215,
        "sender_full_name": "Niels Voss",
        "timestamp": 1771452113
    },
    {
        "content": "<p>You can look at the implementation of <code>#print axioms ...</code> to see how it collects the sorries, and probably call that yourself from a metaprogram.</p>",
        "id": 574672705,
        "sender_full_name": "Max Nowak üêâ",
        "timestamp": 1771490183
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.collectAxioms#doc\">docs#Lean.collectAxioms</a></p>",
        "id": 574699295,
        "sender_full_name": "Mirek Ol≈°√°k",
        "timestamp": 1771498711
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"952083\">Cas Widdershoven</span> <a href=\"#narrow/channel/270676-lean4/topic/Check.20if.20variable.20.28is.7Ccontains.29.20sorry/near/574584161\">said</a>:</p>\n<blockquote>\n<p>Hi all, this may be a very simple question but I can't find a simple solution. In my code, I'm passed a Finset (for example) defined by a student, and before I do anything else with it I want to check if this object is sorry (or if its definition anywhere contains sorry), any idea how to do that? Thanks!</p>\n</blockquote>\n<p>Hi Cas, essentially as others point out you need to do some metaprogramming to check this. I also don't think you actually ought to make such a check since you might end up with code you can't really prove anything about, because of potential calls to partial or unsafe functions.</p>",
        "id": 574734362,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1771509550
    },
    {
        "content": "<p>In general the editor will throw warnings if there are sorries anywhere</p>",
        "id": 574734467,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1771509572
    },
    {
        "content": "<p>(PS : Also, nice to meet you here again (MFoCS))</p>",
        "id": 574734576,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1771509598
    },
    {
        "content": "<p>Hey Shreyas, nice to see you here, long time no see! Yeah, it seems like I'm going to need to do some metaprogramming. Based on everyone's comments (thanks a lot!) I've been trying to figure it out myself, but my lack of experience is showing and I was unable to get it to work properly.</p>\n<p>Basically, my setup is as follows: I have a student-submitted file, \"ex1.lean\", which contains a \"def q1 : Finset\" which students are supposed to define. It is given to them as \"sorry\", and they should replace it with their own definition. I imported ex1 and tried passing ex1.q1 to my grader function as an argument q1, but I couldn't turn it into an Expr within that function using mkConst. However, I did figure out that I could use mkConst on ex1.q1 within the grader, and check hasSorry there. I did an if hasSorry - else on the resulting Expr, but still if I #eval! grader, it crashes complaining about (potential) reliance on sorry - I'm unsure how to solve this, any advice?</p>",
        "id": 574924333,
        "sender_full_name": "Cas Widdershoven",
        "timestamp": 1771588643
    },
    {
        "content": "<p>I think you might want to look at the auto-grader tools mentioned in <a class=\"stream\" data-stream-id=\"187764\" href=\"/#narrow/channel/187764-Lean-for-teaching\">#Lean for teaching</a> channel</p>",
        "id": 574951117,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1771597111
    },
    {
        "content": "<p>They would have already solved this problem</p>",
        "id": 574951201,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1771597128
    },
    {
        "content": "<p>Here : <a href=\"https://github.com/robertylewis/lean4-autograder-main\">https://github.com/robertylewis/lean4-autograder-main</a></p>",
        "id": 574953091,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1771597574
    },
    {
        "content": "<p>Yes, that's the one I'm using for another module I teach (and it's working well, for the most part!) but for this module I inherited a grading solution from last year, I'm just trying to increase its robustness so I don't have to filter out these things myself</p>",
        "id": 574962110,
        "sender_full_name": "Cas Widdershoven",
        "timestamp": 1771599788
    }
]