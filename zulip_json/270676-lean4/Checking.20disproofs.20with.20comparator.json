[
    {
        "content": "<p>Let's say there is a challenge problem which cannot be solved simply because it is possible to prove its negation (as long as we believe in Lean's consistency). Then claiming such challenge as <code>False</code> should be in a way officially accepted answer.</p>\n<ul>\n<li>Do I understand correctly that Comparator doesn't have a way of checking for disproofs so far?</li>\n<li>If it doesn't, how hard would be to add such feature? Is there an intention to have it in the future?</li>\n</ul>\n<p>I was also thinking of a two possible workarounds:</p>\n<ul>\n<li>(a) Write a meta-code in the challenge file which automatically adds a new theorem <code>theorem challenge_disproof : ... (original type ... -&gt; False := sorry</code> disproof-challenges as new theorems to be proven. Downside: it would not be possible to properly negate universe arguments. </li>\n<li>(b) Write another meta-code which adds a new axiom <code>axiom challenge_axiom : ... (original type) ...</code>, and then asks to prove <code>False</code> under this new axiom. Downside: needs tinkering with both the challenge and the proposed disproof solution.</li>\n</ul>",
        "id": 570636699,
        "sender_full_name": "Mirek Olšák",
        "timestamp": 1769626220
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"133339\">Mirek Olšák</span> <a href=\"#narrow/channel/270676-lean4/topic/Checking.20disproofs.20with.20comparator/near/570636699\">said</a>:</p>\n<blockquote>\n<ul>\n<li>Do I understand correctly that Comparator doesn't have a way of checking for disproofs so far?</li>\n</ul>\n</blockquote>\n<p>What do you mean by a 'disproof' in the context of Lean specifically?</p>",
        "id": 570639256,
        "sender_full_name": "James E Hanson",
        "timestamp": 1769626972
    },
    {
        "content": "<p>I think by workaround (b) defines it quite precisely from the logical standpoint. As something that can be easily checked, a theorem of type definitionally equal to <code>challenge_statement -&gt; False</code> with arbitrarily set universe metavariables.</p>",
        "id": 570639736,
        "sender_full_name": "Mirek Olšák",
        "timestamp": 1769627138
    },
    {
        "content": "<p>(arbitrarily set by the disproof)</p>",
        "id": 570639848,
        "sender_full_name": "Mirek Olšák",
        "timestamp": 1769627175
    },
    {
        "content": "<p>Ah, okay I see. This is equivalent to asking for the ability to check whether something is a proof of a given proposition with some solver-chosen substitution of universe levels. This would be pretty easy to add to Comparator if you really wanted to.</p>",
        "id": 570640506,
        "sender_full_name": "James E Hanson",
        "timestamp": 1769627353
    },
    {
        "content": "<p>So you would propose: (1) add lmvar unification as an option to comparator, (2) with a meta-code, add a theorem negation to the challenge file.</p>",
        "id": 570641201,
        "sender_full_name": "Mirek Olšák",
        "timestamp": 1769627623
    },
    {
        "content": "<p>Yes that would be one way to do it.</p>",
        "id": 570641281,
        "sender_full_name": "James E Hanson",
        "timestamp": 1769627657
    },
    {
        "content": "<p>Note that it is not that I would see a strong practical need for the lmvar unification, it just feels more logically precise.</p>",
        "id": 570641329,
        "sender_full_name": "Mirek Olšák",
        "timestamp": 1769627674
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/comparator/blob/f4f132fe2d35966a3fda6fe55de0736e0512e680/Comparator/Compare.lean#L74\">I believe you would only need to change the behavior of this line for (1).</a></p>",
        "id": 570641385,
        "sender_full_name": "James E Hanson",
        "timestamp": 1769627698
    },
    {
        "content": "<p>I found this line too but I don't understand exactly comparator's inner working. As far as I understand, this compares two constants that happened to be equal by some previous merging.</p>",
        "id": 570641657,
        "sender_full_name": "Mirek Olšák",
        "timestamp": 1769627808
    },
    {
        "content": "<p>In <code>MetaM</code>, I would know what to do but this seems more low-level.</p>",
        "id": 570642017,
        "sender_full_name": "Mirek Olšák",
        "timestamp": 1769627948
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"133339\">Mirek Olšák</span> <a href=\"#narrow/channel/270676-lean4/topic/Checking.20disproofs.20with.20comparator/near/570641657\">said</a>:</p>\n<blockquote>\n<p>I found this line too but I don't understand exactly comparator's inner working. As far as I understand, this compares two constants that happened to be equal by some previous merging.</p>\n</blockquote>\n<p>Right now it's checking for literal syntactic identity of the <code>ConstantVal</code> of the two theorems, which means it's checking that the name, level parameters, and type expressions are literally identical (although the name check is redundant at that point, since it's used to grab the constants).</p>",
        "id": 570642647,
        "sender_full_name": "James E Hanson",
        "timestamp": 1769628146
    },
    {
        "content": "<p>Just as a heads up: I will not be accepting option PRs to comparator unless there is a really really really good reason. It's supposed to be a tool that you give the constants to compare, you say the axioms that can be used and then it says yes or no and it is perfectly clear what that yes or no means. The fact that nanoda is currently an option is just transient until it stabilizes again.</p>",
        "id": 570669970,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1769638429
    },
    {
        "content": "<p>So it is meant to be minimalistic, rather than a general judge tool for different purposes?<br>\nWhat would you propose if someone wants to be able checking for disproofs then? Use only the Comparator's sandboxing, and write a custom (perhaps a clone) script to check the solution?</p>\n<p>In general, you could want to check if a solution provides a constant satisfying given properties, not necessarily being exactly equal to something.</p>",
        "id": 570671348,
        "sender_full_name": "Mirek Olšák",
        "timestamp": 1769638981
    },
    {
        "content": "<blockquote>\n<p>What would you propose if someone wants to be able checking for disproofs then?</p>\n</blockquote>\n<p>Well, just write out the challenge with a not in front of it I would say?</p>",
        "id": 570671580,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1769639085
    },
    {
        "content": "<p>that doesn't always work :(</p>",
        "id": 570671677,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1769639147
    },
    {
        "content": "<p>I think we should have a <code>non_theorem</code> keyword that does that transformation automatically in the elaborator</p>",
        "id": 570671882,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1769639234
    },
    {
        "content": "<p>From the comparator side this would amount to the logic being something like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">isExactlySameType</span><span class=\"w\"> </span><span class=\"n\">orig</span><span class=\"w\"> </span><span class=\"n\">new</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">  </span><span class=\"n\">ok</span>\n<span class=\"k\">else</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">isExactlySameType</span><span class=\"w\"> </span><span class=\"n\">orig</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mkNot</span><span class=\"w\"> </span><span class=\"n\">new</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">  </span><span class=\"n\">exit</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n<span class=\"k\">else</span>\n<span class=\"w\">  </span><span class=\"n\">exit</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>",
        "id": 570672037,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1769639302
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"395550\">Henrik Böving</span> <a href=\"#narrow/channel/270676-lean4/topic/Checking.20disproofs.20with.20comparator/near/570671580\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>What would you propose if someone wants to be able checking for disproofs then?</p>\n</blockquote>\n<p>Well, just write out the challenge with a not in front of it I would say?</p>\n</blockquote>\n<p>That is my proposed (a) workaround which expects an extra line of meta-command in the challenge (fair), and doesn't negate universe parameters properly. I am fine with it as a temporary solution but I would not consider it fully principled.</p>",
        "id": 570672735,
        "sender_full_name": "Mirek Olšák",
        "timestamp": 1769639616
    },
    {
        "content": "<p>I understand if extending Comparator only with negation sounds unprincipled. What about having a way for the user to write his own comparator check in <code>MetaM</code> for some of the constants instead of comparing via direct type equality? Another (pseudocode) example could be something like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">answer</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"bp\">#</span><span class=\"n\">comparator_check</span><span class=\"w\"> </span><span class=\"n\">isLiteral</span><span class=\"w\"> </span><span class=\"n\">answer</span>\n</code></pre></div>",
        "id": 570673816,
        "sender_full_name": "Mirek Olšák",
        "timestamp": 1769640194
    },
    {
        "content": "<p>We do not want to make it extensible in this manner (or any manner really). That way some people on twitter or w/e will just say \"oh look the Lean people still didn't get a fool proof way to check whether you got something right, you can just put a trivial comparison check here and it eats it\".</p>",
        "id": 570674812,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1769640662
    },
    {
        "content": "<p>If you want to write your own tool and maybe even base it off comparator that is okay but please make sure to not call it comparator or anything that is reminiscent of it. While comparator fulfills a technical role it also very much fulfills a marketing role for the Lean project.</p>",
        "id": 570674952,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1769640736
    },
    {
        "content": "<p>I would like to make a distinction between setting up challenge, and writing a solution. If the challenge is \"You must prove this.\" then it should not expect anything else. But I would also expect more flexibility for what a challenge could be.</p>",
        "id": 570675080,
        "sender_full_name": "Mirek Olšák",
        "timestamp": 1769640792
    },
    {
        "content": "<p>In Lean Together, I have heard that the developers are preparing tools for defining what a challenge is. Then it feels a little unsatisfactory if you say \"Checking exactly equal types is all we offer.\" But ok, if you say the developers are not interested in building more flexible verification tools, I might think of a custom one.</p>",
        "id": 570675478,
        "sender_full_name": "Mirek Olšák",
        "timestamp": 1769641021
    },
    {
        "content": "<blockquote>\n<p>In Lean Together, I have heard that the developers are preparing tools for defining what a challenge is.</p>\n</blockquote>\n<p>Where have you heard that? I am \"the developers\" and I'm not working on this</p>",
        "id": 570675774,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1769641172
    },
    {
        "content": "<p>Oh maybe you overheard people talking about making it easier to set up a comparator environment, that's certainly on the list somewhere. But comparator as it exists is essentially feature complete by definition, modulo maybe adding more kernels as they come around.</p>",
        "id": 570675887,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1769641232
    },
    {
        "content": "<p>I recall something like that from some of the big talks, I would need to rewatch, maybe Leo, maybe the introduction... but fine, I understand comparator is not the tool.</p>",
        "id": 570675919,
        "sender_full_name": "Mirek Olšák",
        "timestamp": 1769641251
    }
]