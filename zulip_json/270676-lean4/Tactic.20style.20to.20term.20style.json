[
    {
        "content": "<p>Hi,</p>\n<p>Is there a way to automatically convert a tactic style lean proof into a term style lean proof? I noticed that if I print even a tactic style proof, Lean shows the term style version so I'm wondering if there's a way to convert without printing and parsing.</p>\n<p>Thanks</p>",
        "id": 469708026,
        "sender_full_name": "Sid",
        "timestamp": 1726154941
    },
    {
        "content": "<p>You can use <code>show_term</code>.</p>",
        "id": 469711474,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1726155613
    },
    {
        "content": "<p>or even <code>by?</code></p>",
        "id": 469711711,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1726155668
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">show_term</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">assumption</span>\n</code></pre></div>",
        "id": 469711761,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1726155678
    },
    {
        "content": "<p>corresponding for <code>by?</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"bp\">?</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">assumption</span>\n</code></pre></div>",
        "id": 469712072,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1726155741
    },
    {
        "content": "<p>As a followup to this, is there a way to convert term style back to tactic style in an automated way?</p>",
        "id": 474077651,
        "sender_full_name": "Sid",
        "timestamp": 1727800462
    },
    {
        "content": "<p><code>exact &lt;yourterm&gt;</code> is (the simplest) tactic which gets you back into term mode. I assume you don't mean that though? You mean whether there's a way to take some complicated term and \"decompile\" it into some more readable tactics? AFAIK there isn't anything automated to do so.</p>",
        "id": 474078440,
        "sender_full_name": "Julian Berman",
        "timestamp": 1727800684
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321696\">Julian Berman</span> <a href=\"#narrow/stream/270676-lean4/topic/Tactic.20style.20to.20term.20style/near/474078440\">said</a>:</p>\n<blockquote>\n<p><code>exact &lt;yourterm&gt;</code> is (the simplest) tactic which gets you back into term mode. I assume you don't mean that though? You mean whether there's a way to take some complicated term and \"decompile\" it into some more readable tactics? AFAIK there isn't anything automated to do so.</p>\n</blockquote>\n<p>Yes the latter is what I meant. I'm guessing it's possible in theory tho and there's just not an implementation or are there theoretical obstacles as well?</p>\n<p>Also is there a reference on how the Lean compilation from tactics -&gt; proof terms works?</p>",
        "id": 474089008,
        "sender_full_name": "Sid",
        "timestamp": 1727803523
    },
    {
        "content": "<p>(Completely speculating) I think having such a thing is generally not considered very interesting, because proofs which involve complicated terms are often that way because they've been \"golfed\" -- which is (meant to be) an indication that the proof isn't interesting / doesn't contain much mathematical value. It's of course possible for that to be wrong, but yeah as a general rule I think most of the Mathlib proofs that are inscrutable in this way are the way they are precisely because they're not really intended for a human to read them anymore.</p>",
        "id": 474093844,
        "sender_full_name": "Julian Berman",
        "timestamp": 1727805026
    },
    {
        "content": "<p>The theoretical obstacle would I think be similar to other \"humanization\" cases -- there probably are multiple ways to decompile what you have, including the most direct one being what I mentioned, i.e. defining <code>decompile(term)</code> to literally be <code>exact term</code> -- so what constitutes a \"good\" output is going to be somewhat subjective and probably not unique</p>",
        "id": 474094042,
        "sender_full_name": "Julian Berman",
        "timestamp": 1727805093
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246665\">Sid</span> <a href=\"#narrow/stream/270676-lean4/topic/Tactic.20style.20to.20term.20style/near/474077651\">said</a>:</p>\n<blockquote>\n<p>As a followup to this, is there a way to convert term style back to tactic style?</p>\n</blockquote>\n<p>I see. What if a reference tactic style proof is available? My motivation here is basically to convert Lean proofs that use backward tactics into ones that use forward tactics. It doesn't seem like there's a way to do this directly in an automatic way (<a href=\"#narrow/stream/270676-lean4/topic/Forward.20to.20backward.20conversion.20and.20vice.20versa\">https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Forward.20to.20backward.20conversion.20and.20vice.20versa</a>) so I was thinking perhaps there might be if I go through proof terms. The motivation is to generate additional training data for ML models</p>",
        "id": 474096356,
        "sender_full_name": "Sid",
        "timestamp": 1727805765
    },
    {
        "content": "<p>I've had it in the back of my mind to write a \"<code>tactify</code>\" program decompile terms into tactics.</p>",
        "id": 474108784,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1727809871
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246665\">Sid</span> <a href=\"#narrow/stream/270676-lean4/topic/Tactic.20style.20to.20term.20style/near/474089008\">said</a>:</p>\n<blockquote>\n<p>Also is there a reference on how the Lean compilation from tactics -&gt; proof terms works?</p>\n</blockquote>\n<p>Not really, though you can always read the source code for any given tactic. They themselves are the programs that create proof terms.</p>",
        "id": 474108889,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1727809919
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/stream/270676-lean4/topic/Tactic.20style.20to.20term.20style/near/474108784\">said</a>:</p>\n<blockquote>\n<p>I've had it in the back of my mind to write a \"<code>tactify</code>\" program decompile terms into tactics.</p>\n</blockquote>\n<p>I tried this once, even had a branch somewhere, but ... Kyle would do a better job. :-)</p>",
        "id": 474158099,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1727831572
    }
]