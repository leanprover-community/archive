[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">versionString</span><span class=\"w\"> </span><span class=\"c1\">-- output: \"4.20.0-rc5\"</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">thm0</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n<span class=\"c\">/-</span><span class=\"cm\"> goal:</span>\n<span class=\"cm\">p q : Prop ⊢ p ∧ q ↔ q ∧ p</span>\n<span class=\"cm\">-/</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n<span class=\"c\">/-</span><span class=\"cm\"> goal:</span>\n<span class=\"cm\">p q r : Prop ⊢ p ∧ q ↔ q ∧ p</span>\n<span class=\"cm\">-/</span>\n</code></pre></div>\n<p>Lean didn't insert the variable <code>r</code> in the theorem <code>thm0</code>. However, it did in the example above. Was this intended?</p>",
        "id": 517540615,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1747055582
    },
    {
        "content": "<p>i suspect it is intended? the change in <code>variable</code> behaviour was done at a point when <code>example</code> already existed, so i'd say so?</p>",
        "id": 517545044,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1747056465
    },
    {
        "content": "<p>This behavior of the <code>variable</code> command makes it hard to predict which variables Lean won't insert into which examples.</p>",
        "id": 517557515,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1747058533
    },
    {
        "content": "<p>this is intended</p>",
        "id": 517557661,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1747058562
    },
    {
        "content": "<p>What was the reason behind this decision?</p>",
        "id": 517557893,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1747058597
    },
    {
        "content": "<p>the reason for the difference is that <code>def</code>/<code>example</code> has different elaboration behavior from <code>theorem</code>, <code>theorem</code> doesn't let you refer to variables in the body which are not in the statement or <code>include</code>d</p>",
        "id": 517557983,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1747058612
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"c1\">-- unknown identifier 'x'</span>\n</code></pre></div>",
        "id": 517558264,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1747058658
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">bar</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"c1\">-- unknown identifier 'x'</span>\n</code></pre></div>",
        "id": 517558804,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1747058755
    },
    {
        "content": "<p>Let me put it this way: the <code>example</code> command was supposed to behave like the <code>def</code> keyword. Am I correct?</p>",
        "id": 517560035,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1747058985
    },
    {
        "content": "<p>Now I got it. Thanks!</p>",
        "id": 517561521,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1747059221
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"417769\">Bulhwi Cha</span> <a href=\"#narrow/channel/270676-lean4/topic/Lean.20inserts.20unused.20variables.20in.20an.20example/near/517560035\">said</a>:</p>\n<blockquote>\n<p>the <code>example</code> command was supposed to behave like the <code>def</code> keyword</p>\n</blockquote>\n<p>Yes, and there exists <code>noncomputable example</code></p>",
        "id": 517563638,
        "sender_full_name": "Jz Pan",
        "timestamp": 1747059594
    }
]