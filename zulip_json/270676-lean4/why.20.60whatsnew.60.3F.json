[
    {
        "content": "<p>why <code>whatsnew</code> command is not defined with name <code>#whatsnew</code>?<br>\nthis seems to be a diagnostic command.</p>",
        "id": 482866333,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731853578
    },
    {
        "content": "<p>I have many times typed <code>#whatsnew</code> and got a syntax error. I just can't remember it.</p>",
        "id": 482866396,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731853634
    },
    {
        "content": "<p>I suspect that this is because <code>whatsnew</code> is a fairly \"old\" command, that might have been initially meant for debugging only (maybe?) and possibly before there was a convention of prefixing commands with <code>#</code>.</p>",
        "id": 482868869,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1731855589
    },
    {
        "content": "<p>Note that not all commands are prefixed with <code>#</code> - after all, <code>def</code> is a command. The rule tbst I once heard is that commands that don't change the environment get a <code>#</code> (e.g. <code>#eval</code>, <code>#print</code>)</p>",
        "id": 482870241,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1731856546
    },
    {
        "content": "<p>is PR welcome?</p>",
        "id": 482871997,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731857884
    },
    {
        "content": "<p>In general, PRs to core are not welcome unless a RFC issue is opened first and it core developers comment positively on it. There are exceptions to the rule, though.</p>",
        "id": 482878788,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1731863114
    },
    {
        "content": "<p>OK. I will open an issue</p>",
        "id": 482878822,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731863154
    },
    {
        "content": "<blockquote>\n<p>In general, PRs to core are not welcome</p>\n</blockquote>\n<p><code>whatsnew</code> is in Mathlib</p>",
        "id": 482879200,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731863452
    },
    {
        "content": "<p>I guess you could ask on Zulip if we could rename <code>whatsnew</code> command to <code>#whatsnew</code>.</p>",
        "id": 482879452,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731863679
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span> Though <code>#eval</code> can modify the environment! It accepts CommandElabM values.</p>",
        "id": 482885740,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731868610
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"626349\">Asei Inoue</span> <a href=\"#narrow/channel/270676-lean4/topic/why.20.60whatsnew.60.3F/near/482879200\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>In general, PRs to core are not welcome</p>\n</blockquote>\n<p><code>whatsnew</code> is in Mathlib</p>\n</blockquote>\n<p>Ah, my bad! I just looked at the channel name and forgot to check.</p>",
        "id": 482886156,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1731868995
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/270676-lean4/topic/why.20.60whatsnew.60.3F/near/482885740\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> Though <code>#eval</code> can modify the environment! It accepts CommandElabM values.</p>\n</blockquote>\n<p>I didn’t know that (or maybe repressed it). Is there a reason to use <code>#eval</code> here instead of <code>run_cmd</code> (besides that the latter is younger)?</p>",
        "id": 482900628,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1731881285
    },
    {
        "content": "<p><code>example</code> also seems like a counterexample to this \"<code>#</code> iff changes the environment\" rule</p>",
        "id": 482900707,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731881382
    },
    {
        "content": "<p>Good point.</p>",
        "id": 482900725,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1731881399
    },
    {
        "content": "<p>It’s just a rule I picked up somewhere, don’t know where, so certainly not authorative. But do we have a better explanation for when to use <code>#</code>?</p>",
        "id": 482900798,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1731881445
    },
    {
        "content": "<p>In mathlib it's sort of \"commands that shouldn't stick around in the library\"</p>",
        "id": 482900832,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731881498
    },
    {
        "content": "<p>Is the rule just \"be as conservative as you can, because any <code>command</code> keyword you claim will end up illegal in <code>term</code>s; prepend a <code>#</code> if in doubt\"?</p>",
        "id": 482900836,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731881502
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/channel/270676-lean4/topic/why.20.60whatsnew.60.3F/near/482900832\">said</a>:</p>\n<blockquote>\n<p>In mathlib it's sort of \"commands that shouldn't stick around in the library\"</p>\n</blockquote>\n<p>I thought about this, but then <code>#guard_msgs</code> comes to mind. I guess that shouldn’t stick around the library, and tests are different.</p>",
        "id": 482900950,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1731881615
    },
    {
        "content": "<p>Yeah, that's a distinction I'm drawing</p>",
        "id": 482900956,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731881626
    },
    {
        "content": "<p>I've felt like it would be nice to remove <code>run_cmd</code> etc in favor of <code>#eval</code> (it's now defined in terms of <code>#eval</code> after all), but I suppose that <code>run_cmd</code> doesn't try pretty printing its result, so it's library material.</p>",
        "id": 482901007,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731881649
    },
    {
        "content": "<p><code>#guard_msgs</code> is consistent with <code>#guard_expr</code> at least</p>",
        "id": 482901176,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1731881804
    },
    {
        "content": "<p>For me at least, having the <code>run_xxx</code> commands was a great win, because I could never remember the syntax involving <code>#eval</code> and some ( to me strange) <code>show SomeMonad using do</code> idiom or whatever that was.</p>",
        "id": 482901640,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1731882289
    },
    {
        "content": "<p>You generally don't need to write <code>show ...</code> now, though the inference isn't perfect.</p>",
        "id": 482901687,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731882354
    },
    {
        "content": "<p>And the use case “test running some code” and ”do some persistent changes to the environment ” are so fundamentally different that I'd  actually prefer different commands, where <code>#eval</code> is always side-effect free (disregarding direct IO)</p>",
        "id": 482901740,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1731882386
    },
    {
        "content": "<p>If I'm experimenting with some elaboration code, I wouldn't want to have to switch from <code>#eval</code> to <code>run_cmd</code> just to use <code>elabCommand</code></p>",
        "id": 482901960,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731882614
    },
    {
        "content": "<p>Oh, read access to the environment based on the monasin question is fine, it's just the final persisting of the effect that I'm surprised by.</p>",
        "id": 482902230,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1731882930
    },
    {
        "content": "<p>(TBH, all my experimentation starts with the suitable <code>run_cmd</code> or <code>run_meta</code> anyways, I only used <code>#eval</code> for pure calculations. But that largely due to ignorance of what's possible, and habit.)</p>",
        "id": 482902316,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1731883007
    },
    {
        "content": "<p>I mean \"just to use <code>elabCommand</code> <em>and observe its results afterwards</em>\"</p>",
        "id": 482902335,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731883030
    },
    {
        "content": "<p>Fair enough! Different habits, I guess? I certainly didn't want to imply that that needs to change or anything like that. I should probably try using it myself!</p>",
        "id": 482902897,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1731883603
    },
    {
        "content": "<p>Would #whatsnew or #whatsnew be more appropriate?</p>",
        "id": 490297869,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1734786792
    }
]