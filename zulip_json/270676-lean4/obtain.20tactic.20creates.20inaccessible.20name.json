[
    {
        "content": "<p>This fails, but I'd expect it to succeed:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">oops</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">trivial</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>",
        "id": 571556814,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1770083098
    },
    {
        "content": "<p>Is it just me or does your code contain non-breaking spaces (U+00A0, urlencoded as <code>%C2%A0</code> in the playground url and shown with a yellow border there)? This is unrelated to <code>h</code> being inaccessible in the version with proper spaces, which I guess is the bug you're asking about.</p>",
        "id": 571678229,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1770129327
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">oops</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">trivial</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>",
        "id": 571681410,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1770130084
    },
    {
        "content": "<p>I complained about a variant of this in <a href=\"#narrow/channel/270676-lean4/topic/RFC.3A.20.60rcases.60.2F.60obtain.60.20should.20always.20clear.20a.20variable\">#lean4 &gt; RFC: &#96;rcases&#96;/&#96;obtain&#96; should always clear a variable</a> </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">oops</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">False</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">False</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"n\">h'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h'</span><span class=\"w\"> </span><span class=\"c1\">-- fails</span>\n</code></pre></div>",
        "id": 571714475,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1770137808
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/270676-lean4/topic/obtain.20tactic.20creates.20inaccessible.20name/near/571556814\">said</a>:</p>\n<blockquote>\n<p>This fails, but I'd expect it to succeed:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">oops</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">trivial</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>it might be that this change already fixes your bug:</p>\n<div class=\"codehilite\" data-code-language=\"Diff\"><pre><span></span><code><span class=\"gh\">diff --git a/src/Lean/Elab/Tactic/RCases.lean b/src/Lean/Elab/Tactic/RCases.lean</span>\n<span class=\"gh\">index bfad9f98be..fbed5d62a5 100644</span>\n<span class=\"gd\">--- a/src/Lean/Elab/Tactic/RCases.lean</span>\n<span class=\"gi\">+++ b/src/Lean/Elab/Tactic/RCases.lean</span>\n<span class=\"gu\">@@ -449,7 +449,7 @@ def obtainNone (pat : RCasesPatt) (ty : Syntax) (g : MVarId) : TermElabM (List M</span>\n<span class=\"w\"> </span>  Term.withSynthesize do\n<span class=\"w\"> </span>    let ty ← Term.elabType ty\n<span class=\"w\"> </span>    let g₁ ← mkFreshExprMVar (some ty)\n<span class=\"gd\">-    let (v, g₂) ← (← g.assert (pat.name?.getD default) ty g₁).intro1</span>\n<span class=\"gi\">+    let (v, g₂) ← (← g.assert (pat.name?.getD default) ty g₁).intro1P</span>\n<span class=\"w\"> </span>    let gs ← rcasesCore g₂ {} #[] (.fvar v) #[] pat finish\n<span class=\"w\"> </span>    pure (g₁.mvarId! :: gs.toList)\n</code></pre></div>\n<p>(it doesn't affect Jovan's issue though)</p>",
        "id": 572575864,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1770508788
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/3F12BaE1AUJplDtl6bLDC2HL/Screenshot-2026-02-08-at-01.02.20.png\">Screenshot 2026-02-08 at 01.02.20.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/3F12BaE1AUJplDtl6bLDC2HL/Screenshot-2026-02-08-at-01.02.20.png\" title=\"Screenshot 2026-02-08 at 01.02.20.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"602x278\" src=\"/user_uploads/thumbnail/3121/3F12BaE1AUJplDtl6bLDC2HL/Screenshot-2026-02-08-at-01.02.20.png/840x560.webp\"></a></div>",
        "id": 572576097,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1770508961
    }
]