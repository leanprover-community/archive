[
    {
        "content": "<p>I want to start a project that will depend on </p>\n<ul>\n<li>proofWidget (to display SVG in the Infoview)</li>\n<li>SciLean (for basic matrix operations)</li>\n</ul>\n<p>SciLean depends on Mathlib, and since <a href=\"https://github.com/lecopivo/SciLean/blob/master/lean-toolchain\">https://github.com/lecopivo/SciLean/blob/master/lean-toolchain</a> says it depends on v4.15.0-rc1, I executed </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span><span class=\"w\"> </span><span class=\"n\">new</span><span class=\"w\"> </span><span class=\"n\">project</span><span class=\"w\"> </span><span class=\"n\">math</span>\n<span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">project</span>\n</code></pre></div>\n<p>Next, I edited my <code>lakefile.toml</code> to have</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">[[</span><span class=\"n\">require</span><span class=\"o\">]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"mathlib\"</span>\n<span class=\"n\">scope</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"leanprover-community\"</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"v4.15.0-rc1\"</span>\n\n<span class=\"o\">[[</span><span class=\"n\">require</span><span class=\"o\">]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"scilean\"</span>\n<span class=\"n\">scope</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"lecopivo\"</span>\n</code></pre></div>\n<p>Next, I run <code>lake update</code>. At this point, I see some possible problems with the mismatching of some lean-toolchain files:</p>\n<ul>\n<li>Cli version 4.14</li>\n<li>LeanSearchClient version 4.13</li>\n<li>Qq version 4.14:</li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"ss\">`find</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain'</span><span class=\"bp\">`;</span><span class=\"w\"> </span><span class=\"k\">do</span><span class=\"w\"> </span><span class=\"n\">echo</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"o\">(</span><span class=\"n\">cat</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">done</span>\n<span class=\"bp\">./</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">plausible</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">proofwidgets</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">scilean</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">batteries</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Cli</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">14</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">aesop</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">importGraph</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">LeanSearchClient</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">13</span><span class=\"bp\">.</span><span class=\"m\">0</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Qq</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">14</span><span class=\"bp\">.</span><span class=\"m\">0</span>\n</code></pre></div>\n<p>I executed</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">clean</span>\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span>\n<span class=\"bp\">...</span>\n<span class=\"bp\">✖</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">1142</span><span class=\"bp\">/</span><span class=\"mi\">2514</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">RefinedDiscrTree</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">file</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/././</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Lean</span><span class=\"bp\">/</span><span class=\"n\">Meta</span><span class=\"bp\">/</span><span class=\"n\">RefinedDiscrTree</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"bp\">✖</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">1143</span><span class=\"bp\">/</span><span class=\"mi\">2514</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">RefinedDiscrTree</span><span class=\"bp\">.</span><span class=\"n\">Lookup</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">file</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/././</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Lean</span><span class=\"bp\">/</span><span class=\"n\">Meta</span><span class=\"bp\">/</span><span class=\"n\">RefinedDiscrTree</span><span class=\"bp\">/</span><span class=\"n\">Lookup</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"bp\">✖</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">1144</span><span class=\"bp\">/</span><span class=\"mi\">2514</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">SciLean</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">RefinedSimp</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">scilean</span><span class=\"bp\">/././</span><span class=\"n\">SciLean</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">RefinedSimp</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">bad</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">RefinedDiscrTree'</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">scilean</span><span class=\"bp\">/././</span><span class=\"n\">SciLean</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">RefinedSimp</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">bad</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">RefinedDiscrTree</span><span class=\"bp\">.</span><span class=\"n\">Lookup'</span>\n<span class=\"bp\">...</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">SciLean</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Test</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Test</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n</code></pre></div>\n<p>I tried SciLean first, following the README at <a href=\"https://github.com/lecopivo/SciLean\">https://github.com/lecopivo/SciLean</a></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">clone</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"bp\">/</span><span class=\"n\">lecopivo</span><span class=\"bp\">/</span><span class=\"n\">SciLean</span><span class=\"bp\">.</span><span class=\"n\">git</span>\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">SciLean</span>\n\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get</span>\n<span class=\"bp\">...</span>\n<span class=\"n\">Completed</span><span class=\"w\"> </span><span class=\"n\">successfully!</span>\n\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"ss\">`find</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain'</span><span class=\"bp\">`;</span><span class=\"w\"> </span><span class=\"k\">do</span><span class=\"w\"> </span><span class=\"n\">echo</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"o\">(</span><span class=\"n\">cat</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">done</span>\n<span class=\"bp\">./</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">plausible</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">proofwidgets</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">batteries</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Cli</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">14</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">aesop</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">importGraph</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">15</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">LeanSearchClient</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">13</span><span class=\"bp\">.</span><span class=\"m\">0</span>\n<span class=\"bp\">./.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Qq</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">14</span><span class=\"bp\">.</span><span class=\"m\">0</span>\n\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span>\n<span class=\"bp\">...</span>\n<span class=\"n\">info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stderr</span><span class=\"o\">:</span>\n<span class=\"n\">libc</span><span class=\"bp\">++</span><span class=\"n\">abi</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">terminating</span><span class=\"w\"> </span><span class=\"n\">due</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">uncaught</span><span class=\"w\"> </span><span class=\"n\">exception</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"bp\">::</span><span class=\"n\">exception</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">loading</span><span class=\"w\"> </span><span class=\"n\">library</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">dlopen</span><span class=\"o\">(</span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">libMathlib</span><span class=\"bp\">-</span><span class=\"n\">Tactic</span><span class=\"bp\">-</span><span class=\"n\">Linter</span><span class=\"bp\">-</span><span class=\"n\">Header</span><span class=\"bp\">-</span><span class=\"mf\">1.</span><span class=\"n\">dylib</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"n\">x0009</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">tried</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">libMathlib</span><span class=\"bp\">-</span><span class=\"n\">Tactic</span><span class=\"bp\">-</span><span class=\"n\">Linter</span><span class=\"bp\">-</span><span class=\"n\">Header</span><span class=\"bp\">-</span><span class=\"mf\">1.</span><span class=\"n\">dylib'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">__</span><span class=\"n\">DATA_CONST</span><span class=\"w\"> </span><span class=\"n\">segment</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"n\">SG_READ_ONLY</span><span class=\"w\"> </span><span class=\"n\">flag</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">batteries</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">libMathlib</span><span class=\"bp\">-</span><span class=\"n\">Tactic</span><span class=\"bp\">-</span><span class=\"n\">Linter</span><span class=\"bp\">-</span><span class=\"n\">Header</span><span class=\"bp\">-</span><span class=\"mf\">1.</span><span class=\"n\">dylib'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Qq</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">libMathlib</span><span class=\"bp\">-</span><span class=\"n\">Tactic</span><span class=\"bp\">-</span><span class=\"n\">Linter</span><span class=\"bp\">-</span><span class=\"n\">Header</span><span class=\"bp\">-</span><span class=\"mf\">1.</span><span class=\"n\">dylib'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">libMathlib</span><span class=\"bp\">-</span><span class=\"n\">Tactic</span><span class=\"bp\">-</span><span class=\"n\">Linter</span><span class=\"bp\">-</span><span class=\"n\">Header</span><span class=\"bp\">-</span><span class=\"mf\">1.</span><span class=\"n\">dylib'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">aesop</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">libMathlib</span><span class=\"bp\">-</span><span class=\"n\">Tactic</span><span class=\"bp\">-</span><span class=\"n\">Linter</span><span class=\"bp\">-</span><span class=\"n\">Header</span><span class=\"bp\">-</span><span class=\"mf\">1.</span><span class=\"n\">dylib'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">'././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">libMathlib</span><span class=\"bp\">-</span><span class=\"n\">Tactic</span><span class=\"bp\">-</span><span class=\"n\">Linter</span><span class=\"bp\">-</span><span class=\"n\">Header</span><span class=\"bp\">-</span><span class=\"mf\">1.</span><span class=\"n\">dylib'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">__</span><span class=\"n\">DATA_CONST</span><span class=\"w\"> </span><span class=\"n\">segment</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"n\">SG_READ_ONLY</span><span class=\"w\"> </span><span class=\"n\">flag</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">'/</span><span class=\"n\">System</span><span class=\"bp\">/</span><span class=\"n\">Volumes</span><span class=\"bp\">/</span><span class=\"n\">Preboot</span><span class=\"bp\">/</span><span class=\"n\">Cryptexes</span><span class=\"bp\">/</span><span class=\"n\">OS</span><span class=\"bp\">././.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">libMathlib</span><span class=\"bp\">-</span><span class=\"n\">Tactic</span><span class=\"bp\">-</span><span class=\"n\">Linter</span><span class=\"bp\">-</span><span class=\"n\">Header</span><span class=\"bp\">-</span><span class=\"mf\">1.</span><span class=\"n\">dylib'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">'/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">ar</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---v4.15.0-rc1/lib/././.lake/packages/mathlib/.lake/build/lib/libMathlib-Tactic-Linter-Header-1.dylib' (no such file), '/Users/ar/.elan/toolchains/leanprover--lean4---v4.15.0-rc1/lib/lean/././.lake/packages/mathlib/.lake/build/lib/libMathlib-Tactic-Linter-Header-1.dylib' (no such file), '/usr/lib/././.lake/packages/mathlib/.lake/build/lib/libMathlib-Tactic-Linter-Header-1.dylib' (no such file, not in dyld cache), '././.lake/packages/mathlib/.lake/build/lib/libMathlib-Tactic-Linter-Header-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), '././.lake/packages/mathlib/.lake/build/lib/libMathlib-Tactic-Linter-Header-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), '././.lake/packages/batteries/.lake/build/lib/libMathlib-Tactic-Linter-Header-1.dylib' (no such file), '././.lake/packages/Qq/.lake/build/lib/libMathlib-Tactic-Linter-Header-1.dylib' (no such file), '././.lake/build/lib/libMathlib-Tactic-Linter-Header-1.dylib' (no such file), '././.lake/packages/aesop/.lake/build/lib/libMathlib-Tactic-Linter-Header-1.dylib' (no such file), '/Users/ar/r/temp/SciLean/.lake/packages/mathlib/.lake/build/lib/libMathlib-Tactic-Linter-Header-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), '/System/Volumes/Preboot/Cryptexes/OS/Users/ar/r/temp/SciLean/.lake/packages/mathlib/.lake/build/lib/libMathlib-Tactic-Linter-Header-1.dylib' (no such file), '/Users/ar/r/temp/SciLean/.lake/packages/mathlib/.lake/build/lib/libMathlib-Tactic-Linter-Header-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag)</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">134</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">SciLean</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">CompiledTactics</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n</code></pre></div>\n<p>So, SciLean is indeed broken. Am I right <span class=\"user-mention\" data-user-id=\"346070\">@Tomas Skrivan</span> ? To make sure..</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">clean</span><span class=\"w\"> </span><span class=\"c1\">-- this should remove all precompiled files that `lake exe cache get` got, right?</span>\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span>\n<span class=\"bp\">...</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">SciLean</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">CompiledTactics</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n</code></pre></div>\n<p>So, I guess if I made something wrong, what would be the appropriate step-by-step procedure for creating my project with such dependencies?</p>\n<p>On the other hand, it may only be that Mathlib 4.15.0-rc1 is broken, and it is causing SciLean to break, too.</p>",
        "id": 510400101,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1743878694
    },
    {
        "content": "<p>Careful! I don't think this (the whole of) your issue, but</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">[[</span><span class=\"n\">require</span><span class=\"o\">]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"mathlib\"</span>\n<span class=\"n\">scope</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"leanprover-community\"</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"v4.15.0-rc1\"</span>\n</code></pre></div>\n<p>means \"Make me depend on mathlib commit <code>41ff1f7899c971f91362710d4444e338b8acd644</code> (<a href=\"https://github.com/leanprover-community/mathlib4/releases/tag/v4.15.0-rc1\">the one tagged with <code>v4.15.0-rc1</code></a>). In particular, this is not the commit that SciLean depends on which is instead <code>df255e235cde3ac9e4325de51cfa2bc82b7b2416</code> (see <a href=\"https://github.com/lecopivo/SciLean/blob/master/lake-manifest.json#L8C12-L8C52\">SciLean's <code>lake-manifest.json</code></a>).</p>",
        "id": 510400501,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1743878929
    },
    {
        "content": "<p>Just depend on SciLean and you will get mathlib as a transitive dependency</p>",
        "id": 510400585,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1743878995
    },
    {
        "content": "<p>You should remove that <code>rev</code> line in the <code>mathlib</code> part of your lakefile, and instead run <code>lake update scilean</code></p>",
        "id": 510400596,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1743879000
    },
    {
        "content": "<p>But you still seem to have an issue building clean SciLean on its own. I will investigate that.</p>",
        "id": 510400751,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1743879086
    },
    {
        "content": "<p>Relatedly, Tomas, may I convince you to bump your SciLean to tagged versions of mathlib and release accordingly-tagged versions of SciLean?</p>",
        "id": 510400995,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1743879244
    },
    {
        "content": "<p>Yes I will do that</p>",
        "id": 510401039,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1743879282
    },
    {
        "content": "<p>Thank you, <span class=\"user-mention\" data-user-id=\"346070\">@Tomas Skrivan</span> and <span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span>, for investigating it. The error in the building of Scilean alone is problematic. The mismatch of the Mathlib version in the  <code>lake-manifest.json</code> of SciLean is strange... Actually, SciLean depends on the HEAD of the main branch of Mathlib. </p>\n<p><a href=\"https://github.com/lecopivo/SciLean/blob/master/lakefile.lean#L90\">https://github.com/lecopivo/SciLean/blob/master/lakefile.lean#L90</a></p>\n<p>Moreover, my project's primary concern is making SciLean closely follow ProofWidgets, which in turn follows Mathlib. We must create a PR to ProofWidgets to support more SVG primitives.</p>",
        "id": 510402642,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1743880411
    },
    {
        "content": "<p>But I don't know when and how the <code>lake-manifest.json</code> is updated. </p>\n<p>Actually, I found the following information on the lake README: <a href=\"https://github.com/leanprover/lean4/blob/master/src/lake/README.md#adding-dependencies\">https://github.com/leanprover/lean4/blob/master/src/lake/README.md#adding-dependencies</a>. </p>\n<p>It suggests that the manifest is updated after the building. I was expecting it to be updated during the lake update. ' If I understood it right, the <code>lake exe cache get</code> consults the manifest to retrieve a specific version of the compiled files.</p>",
        "id": 510405985,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1743882847
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"121542\">Alexandre Rademaker</span> <a href=\"#narrow/stream/270676-lean4/topic/error.20with.20dependencies/near/510402642\">said</a>:</p>\n<blockquote>\n<p>Moreover, my project's primary concern is making SciLean closely follow ProofWidgets, which in turn follows Mathlib. We must create a PR to ProofWidgets to support more SVG primitives.</p>\n</blockquote>\n<p>Right, the SVG example was not designed to be easily extensible by the user which is not ideal. You can probably copy all the code of SVG and InteractiveSVG and extend that. Ideally redesign it to make it user extensible.</p>",
        "id": 510409240,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1743885124
    },
    {
        "content": "<p>This is self <a href=\"https://gist.github.com/lecopivo/f151f73b0ef6fe803fbb48356fe33d97\">contained file</a> depending on ProofWidgets that redefines all the SVG things again so you can extend them however you want without making a PR to ProofWidgets</p>",
        "id": 510410671,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1743886070
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"121542\">Alexandre Rademaker</span> <a href=\"#narrow/channel/270676-lean4/topic/error.20with.20dependencies/near/510400101\">said</a>:</p>\n<blockquote>\n<p>So, SciLean is indeed broken. Am I right <span class=\"user-mention silent\" data-user-id=\"346070\">Tomas Skrivan</span> ? To make sure..</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">clean</span><span class=\"w\"> </span><span class=\"c1\">-- this should remove all precompiled files that `lake exe cache get` got, right?</span>\n<span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span>\n<span class=\"bp\">...</span>\n<span class=\"n\">Some</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">builds</span><span class=\"w\"> </span><span class=\"n\">logged</span><span class=\"w\"> </span><span class=\"n\">failures</span><span class=\"o\">:</span>\n<span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">SciLean</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">CompiledTactics</span>\n<span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">failed</span>\n</code></pre></div>\n<p>So, I guess if I made something wrong, what would be the appropriate step-by-step procedure for creating my project with such dependencies?</p>\n<p>On the other hand, it may only be that Mathlib 4.15.0-rc1 is broken, and it is causing SciLean to break, too.</p>\n</blockquote>\n<p>I can't reproduce this. I tried:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">clone</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"bp\">@</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"o\">:</span><span class=\"n\">lecopivo</span><span class=\"bp\">/</span><span class=\"n\">SciLean</span><span class=\"bp\">.</span><span class=\"n\">git</span>\n<span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">SciLean</span><span class=\"bp\">/</span>\n<span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get</span>\n<span class=\"bp\">$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span>\n</code></pre></div>\n<p>and it finished successfully. I'm on Ubuntu 22.04 and not on MacOS which you are running if I'm not mistaken.</p>",
        "id": 510411677,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1743886782
    },
    {
        "content": "<p>I got an error; see  <a href=\"https://gist.github.com/arademaker/c743e015d78071dcb6c7b3e5aa334308\">https://gist.github.com/arademaker/c743e015d78071dcb6c7b3e5aa334308</a></p>\n<p>Yes, I am running on MacOS 15.4 (24E248), Apple M4 with 24GB of RAM.</p>",
        "id": 510690133,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1744036527
    },
    {
        "content": "<p>This looks like a bug in Lean related to the <code>precompiledModules:=true</code> option and arm architecture. Not sure what to do about this :/</p>",
        "id": 510691895,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1744036953
    },
    {
        "content": "<p>Regarding the ProofWidgets.. I was not clear. We will eventually make a PR to ProofWidgets because we need more primitives to implement our visualization library. See <a href=\"https://github.com/leanprover-community/ProofWidgets4/issues/110\">https://github.com/leanprover-community/ProofWidgets4/issues/110</a>.  We are not talking about the SVG examples in the SciLean repository.</p>",
        "id": 510691916,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1744036958
    },
    {
        "content": "<p>It looks like the same error was reported by <span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span> in October. I added a comment in <a href=\"https://github.com/leanprover/lean4/issues/5649\">https://github.com/leanprover/lean4/issues/5649</a>.</p>",
        "id": 510693624,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1744037408
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"121542\">Alexandre Rademaker</span> <a href=\"#narrow/stream/270676-lean4/topic/error.20with.20dependencies/near/510691916\">said</a>:</p>\n<blockquote>\n<p>Regarding the ProofWidgets.. I was not clear. We will eventually make a PR to ProofWidgets because we need more primitives to implement our visualization library. See <a href=\"https://github.com/leanprover-community/ProofWidgets4/issues/110\">https://github.com/leanprover-community/ProofWidgets4/issues/110</a>.  We are not talking about the SVG examples in the SciLean repository.</p>\n</blockquote>\n<p>I understood that, the gist I shared contained all the SVG code in ProofWidgets. </p>\n<p>What I was just trying to say is that by using that code you can extend the <code>SVG</code> type and use it with SciLean without making a PR to ProofWidgets and then waiting until it gets merged to ProofWidgets and then to mathlib and then to SciLean.</p>",
        "id": 510693892,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1744037475
    },
    {
        "content": "<p>I see, but <span class=\"user-mention\" data-user-id=\"346070\">@Tomas Skrivan</span>, in this case, my project would still depend on SciLean, which in turn depends on Mathlib, which depends on ProofWidgets.  </p>\n<p>So adding <a href=\"https://gist.github.com/lecopivo/f151f73b0ef6fe803fbb48356fe33d97\">https://gist.github.com/lecopivo/f151f73b0ef6fe803fbb48356fe33d97</a> in my project would not cause errors related to the redefinition of symbols loaded from the proofWidgets?</p>",
        "id": 510749527,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1744053719
    },
    {
        "content": "<p>Yes it would still depend on SciLean, Mathlib and ProofWidgets. The <code>SVG</code> already lives in the <code>ProofWidgets</code> namespace so there should be no clash. Maybe just put yours in <code>MySVG</code> namespace or whatever.</p>\n<p>Once your project works as you want, back porting your additions to <code>ProofWidgets.SVG</code> would be great. But having your own version now prevents you from the painful roundtrip of PRs that would be partially out of your control.</p>",
        "id": 510750886,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1744054123
    }
]