[
    {
        "content": "<p>While bumping SciLean from <code>v4.16.0</code> to <code>v4.18.0</code> I encountered strange panic</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">PANIC</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">private</span><span class=\"bp\">.</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Environment</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">.</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">AsyncConsts</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Environment</span><span class=\"o\">:</span><span class=\"mi\">444</span><span class=\"o\">:</span><span class=\"mi\">4</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AsyncConsts</span><span class=\"bp\">.</span><span class=\"n\">add</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">duplicate</span><span class=\"w\"> </span><span class=\"n\">normalized</span><span class=\"w\"> </span><span class=\"n\">declaration</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"n\">StateT</span><span class=\"bp\">.</span><span class=\"n\">bind</span><span class=\"bp\">.</span><span class=\"n\">match_1</span><span class=\"bp\">.</span><span class=\"n\">eq_1</span><span class=\"w\"> </span><span class=\"n\">vs</span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">private</span><span class=\"bp\">.</span><span class=\"n\">SciLean</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Calculus</span><span class=\"bp\">.</span><span class=\"n\">Monad</span><span class=\"bp\">.</span><span class=\"n\">StateT</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">.</span><span class=\"n\">StateT</span><span class=\"bp\">.</span><span class=\"n\">bind</span><span class=\"bp\">.</span><span class=\"n\">match_1</span><span class=\"bp\">.</span><span class=\"n\">eq_1</span>\n</code></pre></div>\n<p>Unfortunately I can't minimize it, it happens on this <a href=\"https://github.com/lecopivo/SciLean/blob/a74ac55534685ee347dac3b0eb2ea946dddda128/SciLean/Analysis/Calculus/Monad/StateT.lean#L17\">instance</a>. The issue is <code>simp[StateT.bind.match_1]</code>, if remove it it works again. </p>\n<p>Is explicitly unfolding match statements with <code>simp</code> is now bad/problematic?</p>",
        "id": 511000945,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1744136958
    },
    {
        "content": "<p>A minimization really would be helpful :)</p>",
        "id": 511680611,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1744385480
    },
    {
        "content": "<p>Yeah I understand, I will try to minimize it</p>",
        "id": 511690159,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1744388374
    }
]