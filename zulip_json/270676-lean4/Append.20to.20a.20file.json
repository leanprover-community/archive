[
    {
        "content": "<p>The other day, I wanted to append a given string to a file. Would a method like the following be accepted?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- Append a given string at the end of an existing file. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">FS</span><span class=\"bp\">.</span><span class=\"n\">appendToFile</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fname</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FilePath</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">content</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">previous_content</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">FS</span><span class=\"bp\">.</span><span class=\"n\">readFile</span><span class=\"w\"> </span><span class=\"n\">fname</span>\n<span class=\"w\">  </span><span class=\"n\">IO</span><span class=\"bp\">.</span><span class=\"n\">FS</span><span class=\"bp\">.</span><span class=\"n\">writeFile</span><span class=\"w\"> </span><span class=\"n\">fname</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">previous_content</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">content</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 450170558,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1720531181
    },
    {
        "content": "<p>(Obviously, this could have a better implemention which is less of a \"polyfill\". Also, I would like to document the edge cases of this method better: what happens if the file doesn't exist? If reading it fails? If writing the new content fails? Does this close the file afterwards?, etc.  This detail is also missing from <code>readFile</code>, though - it's probably easiest to update both at the same time.)</p>",
        "id": 450170568,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1720531184
    },
    {
        "content": "<p>You can open a file in append mode <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IO.FS.Mode.append#doc\">docs#IO.FS.Mode.append</a>, I would think that that is better behaved</p>",
        "id": 450171696,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1720531460
    },
    {
        "content": "<p>Much nicer, thanks!</p>",
        "id": 450171876,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1720531509
    }
]