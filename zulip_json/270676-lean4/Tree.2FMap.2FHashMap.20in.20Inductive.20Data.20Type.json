[
    {
        "content": "<p>I'm trying to put a tree/dictionary/hashmap in an inductive data type</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Std</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Std</span><span class=\"bp\">.</span><span class=\"n\">TreeMap</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">T</span>\n</code></pre></div>\n<p>I get the confusing error:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">test</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"o\">:</span><span class=\"mi\">0</span>\n<span class=\"o\">(</span><span class=\"n\">kernel</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">application</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span>\n<span class=\"w\">  </span><span class=\"n\">Std</span><span class=\"bp\">.</span><span class=\"n\">DTreeMap</span><span class=\"bp\">.</span><span class=\"n\">Internal</span><span class=\"bp\">.</span><span class=\"n\">Impl</span><span class=\"bp\">.</span><span class=\"n\">WF</span><span class=\"w\"> </span><span class=\"n\">inner</span>\n<span class=\"n\">argument</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"bp\">_</span><span class=\"n\">nested</span><span class=\"bp\">.</span><span class=\"n\">Std</span><span class=\"bp\">.</span><span class=\"n\">DTreeMap</span><span class=\"bp\">.</span><span class=\"n\">Internal</span><span class=\"bp\">.</span><span class=\"n\">Impl_3</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">Std</span><span class=\"bp\">.</span><span class=\"n\">DTreeMap</span><span class=\"bp\">.</span><span class=\"n\">Internal</span><span class=\"bp\">.</span><span class=\"n\">Impl</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n</code></pre></div>\n<p>What does this error mean? Where do these internal symbols come from? Can I put a tree/map/hashmap in an inductive data structure?</p>",
        "id": 553374602,
        "sender_full_name": "Atticus Kuhn",
        "timestamp": 1762174632
    },
    {
        "content": "<p>from <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Std.DHashMap#doc\">docs#Std.DHashMap</a>:</p>\n<blockquote>\n<p>These hash maps contain a bundled well-formedness invariant, which means that they cannot be used in nested inductive types. For these use cases, <code>Std.DHashMap.Raw</code> and <code>Std.DHashMap.Raw.WF</code> unbundle the invariant from the hash map. When in doubt, prefer <code>DHashMap</code> over <code>DHashMap.Raw</code>.</p>\n</blockquote>",
        "id": 553374863,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762174712
    },
    {
        "content": "<p>Thank you, using <code>Std.TreeMap.Raw</code> solved the issue.</p>",
        "id": 553375908,
        "sender_full_name": "Atticus Kuhn",
        "timestamp": 1762175027
    },
    {
        "content": "<p>A quote from the year 3 roadmap of the FRO:</p>\n<blockquote>\n<p>Nesting induction through collections such as <code>HashMap</code> and <code>TreeMap</code> will be supported.</p>\n</blockquote>",
        "id": 553685303,
        "sender_full_name": "Jovan Gerbscheid",
        "timestamp": 1762280248
    }
]