[
    {
        "content": "<p>Is it intended that automatically derived <code>SizeOf</code> instances are generally noncomputable?</p>",
        "id": 507966330,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1742894121
    },
    {
        "content": "<p>It wouldn't surprise me, the purpose of the class is to help with termination proofs, and I think those get erased by the code generator</p>",
        "id": 507973767,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1742896033
    },
    {
        "content": "<p>So the implementation doesn't need it to be computable</p>",
        "id": 507973895,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1742896074
    },
    {
        "content": "<p>Okay, yes I guess that makes sense.</p>",
        "id": 507973998,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1742896098
    },
    {
        "content": "<p>Follow-up question: Why is the generated <code>SizeOf</code> instance not more like <code>constructorIdx + noOfConstructors*depth</code> instead of just <code>depth</code>?</p>",
        "id": 507974198,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1742896155
    },
    {
        "content": "<p>That feels like a very good chance for brittleness as it imposes an implicit ordering on the constructors so whenver an inductive just changes its order of ctors there is potential for termination proofs to fail</p>",
        "id": 507975051,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1742896399
    },
    {
        "content": "<p>Could also have it as an opt-in option in that case</p>",
        "id": 507976944,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1742896907
    },
    {
        "content": "<p>If you want to do custom sizeOf with these properties that you can execute you can just override the instance btw, in case that is the actual motivation here</p>",
        "id": 507988952,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1742900093
    },
    {
        "content": "<p>We do that manually for an enum of 48 constructors or so that's generated from Sail, but maybe I'll just give myself the task of automating the construction and writing a deriver for this</p>",
        "id": 508000396,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1742903390
    },
    {
        "content": "<p>(Would that be of interest to Lean core?)</p>",
        "id": 508006143,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1742905003
    }
]