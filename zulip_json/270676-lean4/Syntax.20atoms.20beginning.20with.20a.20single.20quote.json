[
    {
        "content": "<p>Is there any way to make: <code>notation \"\\'\" x =&gt; x</code> work? i.e. use <code>'</code> as the very first character of an atom; or do we always hit the codepath via <code>Lean.Elab.Syntax.isValidAtom</code> which explicitly prohibits this.</p>",
        "id": 294882665,
        "sender_full_name": "František Silváši",
        "timestamp": 1661266356
    },
    {
        "content": "<p>Did you get any reply? In my case I don't even need the result to be atomic. Trying to parse single <code>'</code> like this, but Lean still seems to want to parse a character literal:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">singleSingleQuote</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Parser</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rawCh</span><span class=\"w\"> </span><span class=\"bp\">'\\''</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">trailingWs</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"o\">)</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">combinator_formatter</span><span class=\"w\"> </span><span class=\"n\">singleSingleQuote</span><span class=\"kd\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">singleSingleQuote</span><span class=\"bp\">.</span><span class=\"n\">formatter</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">PrettyPrinter</span><span class=\"bp\">.</span><span class=\"n\">Formatter</span><span class=\"bp\">.</span><span class=\"n\">visitAtom</span><span class=\"w\"> </span><span class=\"n\">Name</span><span class=\"bp\">.</span><span class=\"n\">anonymous</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">combinator_parenthesizer</span><span class=\"w\"> </span><span class=\"n\">singleSingleQuote</span><span class=\"kd\">]</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">singleSingleQuote</span><span class=\"bp\">.</span><span class=\"n\">parenthesizer</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">PrettyPrinter</span><span class=\"bp\">.</span><span class=\"n\">Parenthesizer</span><span class=\"bp\">.</span><span class=\"n\">visitToken</span>\n\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"n\">singleSingleQuote</span><span class=\"w\"> </span><span class=\"n\">noWs</span><span class=\"w\"> </span><span class=\"n\">ident</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">kid</span>\n\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"`[kid|\"</span><span class=\"w\"> </span><span class=\"n\">kid</span><span class=\"w\"> </span><span class=\"s2\">\"]\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">term</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">[</span><span class=\"n\">kid</span><span class=\"bp\">|'</span><span class=\"n\">foo</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 466990235,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1725292530
    },
    {
        "content": "<p>I think this needs an RFC to Lean core.</p>",
        "id": 467073083,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1725323450
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span></p>",
        "id": 467184692,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1725355362
    },
    {
        "content": "<p>Do you need it at the beginning of a syntax category? The above category only has one production so it's not really necessary in that specific example</p>",
        "id": 467223648,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1725363823
    },
    {
        "content": "<p>Ah, I guess I can avoid that</p>",
        "id": 467232282,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1725366025
    },
    {
        "content": "<p>Works! Why does that make a difference?</p>",
        "id": 467233714,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1725366285
    },
    {
        "content": "<p>The production of the syntax category is chosen via parseToken. So it might also work if <a href=\"http://Parser.info\">Parser.info</a> is set up correctly for your custom parser.</p>",
        "id": 467273448,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1725374196
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110789\">Jakob von Raumer</span> <a href=\"#narrow/stream/270676-lean4/topic/Syntax.20atoms.20beginning.20with.20a.20single.20quote/near/467232282\">said</a>:</p>\n<blockquote>\n<p>Ah, I guess I can avoid that</p>\n</blockquote>\n<p>Can avoid that in <em>that</em> syntax category, but to not have it at the start of any syntax category upwards from it is close to impossible. Will look at the <code>Parser.info</code></p>",
        "id": 467307165,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1725380894
    },
    {
        "content": "<p>Not sure I understand that, if it's not at the beginning of the immediately surrounding category, how can it be at the beginning further up the stack?</p>",
        "id": 467310988,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1725381993
    },
    {
        "content": "<p>Eh, my \"solution\" was to turn the category that's called <code>kid</code> in the example above into a straight <code>ParserDescr</code> instead of a syntax category, but that just shifts the problem.</p>",
        "id": 467353331,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1725395003
    },
    {
        "content": "<blockquote>\n<p>The production of the syntax category is chosen via parseToken.</p>\n</blockquote>\n<p>Did you really mean <code>parseToken</code>? I can only find tat in the formatter <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 467507545,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1725450419
    }
]