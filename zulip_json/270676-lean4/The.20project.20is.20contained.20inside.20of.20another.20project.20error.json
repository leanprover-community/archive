[
    {
        "content": "<p>While working on lean4 I'm having those kind of errors pop-up every time I open new file:</p>\n<blockquote>\n<p>Error while starting language server: The project at '/home/nix/tmp/lean/lean4/src' of the file 'Types.lean' is contained inside of another project at '/home/nix/tmp/lean/lean4', for which a language server is already running. The Lean 4 VS Code extension does not support nested Lean projects.</p>\n</blockquote>\n<p>Although, it seems like everything still works regardless of the error. Anyone knows how to fix the problem?</p>",
        "id": 538478366,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1757435271
    },
    {
        "content": "<p>I've used <code>nix develop</code> to get necessary dependencies, build the project with <code>cmake --preset release</code> and <code>make -C build/release -j$(nproc || sysctl -n hw.logicalcpu)</code>.<br>\nI opened <code>lean.code-workspace</code> with <code>code</code> while it was still building.</p>\n<p>Restarting vscode didn't help.</p>",
        "id": 538478962,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1757435469
    },
    {
        "content": "<p>Don't create any Lean files at the top-level <code>lean4</code> directory. All .lean files you create need to be in <code>src</code> or <code>tests</code>. Scratch files go into <code>tests</code>.</p>",
        "id": 538479379,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1757435600
    },
    {
        "content": "<p>Ah, yes, I created <code>test.lean</code> file in <code>lean4</code> directory to test my changes. It seems like moving it to <code>src</code> and restarting vscode helped.</p>",
        "id": 538479601,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1757435668
    },
    {
        "content": "<p>You want your <code>test.lean</code> file to be in <code>tests</code> so that it runs with stage1</p>",
        "id": 538479690,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1757435696
    },
    {
        "content": "<p>Ah, thanks! You're right, my changes weren't reflected while it was in <code>src</code> directory.</p>",
        "id": 538480205,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1757435864
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"221921\">@Marc Huisinga</span>, I think this one hit me because I opened <code>scripts/AnalyzeGrindAnnotations.lean</code>. That is outside <code>src</code> and <code>tests</code>.</p>",
        "id": 538576287,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1757486040
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/270676-lean4/topic/The.20project.20is.20contained.20inside.20of.20another.20project.20error/near/538576287\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span>, I think this one hit me because I opened <code>scripts/AnalyzeGrindAnnotations.lean</code>. That is outside <code>src</code> and <code>tests</code>.</p>\n</blockquote>\n<p>We could fix this by giving <code>scripts</code> a <code>lean-toolchain</code> file and adding it to the set of workspace folder in core, or we could just accept that when working on this file, we temporarily need to switch between the inner/outer server by clicking the \"Stop Other Server\" button :-)</p>",
        "id": 538587554,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1757490743
    },
    {
        "content": "<p>Ah, to clarify, I opened it <em>last week</em>, and don't recall opening it since (and have restarted Code/Cursor several times since).</p>",
        "id": 538643007,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1757508599
    },
    {
        "content": "<p>Are you sure that it wasn't open in one of your tabs?</p>",
        "id": 538644067,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1757508848
    },
    {
        "content": "<p>Yes. :-(</p>",
        "id": 538647650,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1757509774
    },
    {
        "content": "<p>Did this occur in Cursor or VS Code?</p>",
        "id": 538647882,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1757509836
    }
]