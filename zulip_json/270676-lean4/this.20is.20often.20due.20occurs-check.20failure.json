[
    {
        "content": "<p>What is the error <code>this is often due occurs-check failure</code> supposed to mean? To me it seems like there are grammar issues with this message, but I might be missing something.<br>\nI'm not asking how to fix the error in my code, I'm asking whether the message is wrong and we should change it.<br>\nPerhaps the message meant to say \"this is often caused by other errors, check for more messages above\"?</p>\n<p>This message is from <a href=\"https://github.com/leanprover/lean4/blob/f31f50836d032d6c237272a3b2e733a92a3ee619/src/Lean/Elab/Tactic/Basic.lean#L546\"><code>closeMainGoal</code></a> and <a href=\"https://github.com/leanprover/lean4/blob/f31f50836d032d6c237272a3b2e733a92a3ee619/src/Lean/Elab/Tactic/ElabTerm.lean#L93\"><code>closeMainGoalUsing</code></a>.</p>",
        "id": 575594695,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1771951807
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">error: don't know how to synthesize placeholder</span>\n<span class=\"sd\">context:</span>\n<span class=\"sd\">n : Nat</span>\n<span class=\"sd\">⊢ Nat</span>\n\n<span class=\"sd\">Note: All parameter types and holes (e.g., `_`) in the header of a theorem are resolved before the proof is processed; information from the proof cannot be used to infer what these values should be</span>\n<span class=\"sd\">---</span>\n<span class=\"sd\">error: Tactic `exact` failed: attempting to close the goal using</span>\n<span class=\"sd\">  sorry</span>\n<span class=\"sd\">this is often due occurs-check failure</span>\n\n<span class=\"sd\">⊢ ?m.2 = 0</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>(btw idk why <code>variable</code> is necessary to reporoduce)</p>",
        "id": 575594783,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1771951828
    },
    {
        "content": "<p>an occurs-check is a check that the goal is not being used to close itself</p>",
        "id": 575598795,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1771952891
    },
    {
        "content": "<p>So is the message supposed to be <code>this is often due to an occurs-check failure</code>?</p>",
        "id": 575599132,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1771952973
    },
    {
        "content": "<p>Also is that term supposed to be user-facing?</p>",
        "id": 575599245,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1771953000
    },
    {
        "content": "<p>Yes, occurs-check is currently meant to be user-facing, and the original error should read \"due to\".</p>\n<p>The error could say \"this is often due to metavariable assignments failing due to the occurs check\", with some pointer to documentation that explains that when assigning <code>?m := e</code>, the expression <code>e</code> cannot have any occurrences of <code>?m</code> (that's the so-called \"occurs check\", a key concept in unification). Ideally the error would point out why the occurs check fails.</p>",
        "id": 575600874,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1771953426
    }
]