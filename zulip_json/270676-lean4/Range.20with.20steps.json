[
    {
        "content": "<p>What is the canonical way in Lean to write</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">+=</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">):</span>\n<span class=\"w\">  </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>This used to be</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>but this is now a legacy notation.<br>\nIt isn't easily written with the new <code>Std.PRange</code>, I believe. Is the use case where <code>c â‰  1</code> deemed obscure enough that this is not supported?</p>",
        "id": 570122553,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1769441364
    },
    {
        "content": "<p>(side remark: is it intended that <code>for k in (2*p)...n do</code> requires parentheses?)</p>",
        "id": 570122628,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1769441386
    },
    {
        "content": "<p>I guess I could use</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">range'</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"bp\">...</span>\n</code></pre></div>",
        "id": 570124057,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1769441731
    },
    {
        "content": "<p>(/cc <span class=\"user-mention\" data-user-id=\"221653\">@Paul Reichert</span>)</p>",
        "id": 570134620,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1769444217
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"mi\">10</span><span class=\"o\">:</span><span class=\"mi\">4</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"n\">println!</span><span class=\"w\"> </span><span class=\"n\">i</span>\n</code></pre></div>\n<p>works for me with 4.27.</p>",
        "id": 570147069,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1769447417
    },
    {
        "content": "<p>There is an issue that if <code>c</code> is a parameter you need to prove that <code>c &gt; 0</code>, and there isn't a convenient way to do this with the <code>[a:b:c]</code> notation, but something like this works:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">Std</span><span class=\"bp\">.</span><span class=\"n\">Range</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">grind</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"n\">println!</span><span class=\"w\"> </span><span class=\"n\">i</span>\n</code></pre></div>",
        "id": 570147958,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1769447687
    },
    {
        "content": "<p>Yes, it works but if you hover over <code>[1:10:4]</code> it says <code>Std.Legacy.Range</code></p>",
        "id": 570147988,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1769447696
    },
    {
        "content": "<p>really?</p>",
        "id": 570148055,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1769447714
    },
    {
        "content": "<p>what version of lean?</p>",
        "id": 570148066,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1769447717
    },
    {
        "content": "<p>Latest mathlib in live lean, i.e. 4.28.0-rc1</p>",
        "id": 570148232,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1769447763
    },
    {
        "content": "<p>But you're right, it's a recent change</p>",
        "id": 570148366,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1769447803
    },
    {
        "content": "<p>aha ok I'm just one version behind.</p>",
        "id": 570148489,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1769447840
    },
    {
        "content": "<p>You can use the <code>stepSize</code> combinator (which is efficient no matter what the step size is):</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Std</span>\n\n<span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"bp\">...</span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">iter.stepSize</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"n\">IO.println</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">toString</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n\n<span class=\"k\">#eval</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"mi\">10</span>\n</code></pre></div>\n<p>This is admittedly less convenient than the previous notation. Step sizes aren't integrated more deeply into the ranges to keep the complexity in check, given that there are some complications with the polymorphism of the new ranges.</p>",
        "id": 570154191,
        "sender_full_name": "Paul Reichert",
        "timestamp": 1769449579
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243562\">Adam Topaz</span> <a href=\"#narrow/channel/270676-lean4/topic/Range.20with.20steps/near/570147958\">said</a>:</p>\n<blockquote>\n<p>There is an issue that if <code>c</code> is a parameter you need to prove that <code>c &gt; 0</code>, and there isn't a convenient way to do this with the <code>[a:b:c]</code> notation, but something like this works:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IO</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">Std</span><span class=\"bp\">.</span><span class=\"n\">Range</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">grind</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">    </span><span class=\"n\">println!</span><span class=\"w\"> </span><span class=\"n\">i</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>I was indeed also running into this issue.</p>",
        "id": 570159065,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1769451057
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"221653\">Paul Reichert</span> <a href=\"#narrow/channel/270676-lean4/topic/Range.20with.20steps/near/570154191\">said</a>:</p>\n<blockquote>\n<p>You can use the <code>stepSize</code> combinator (which is efficient no matter what the step size is):</p>\n</blockquote>\n<p>Oh, this is nice! <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Std.IterM.stepSize#doc\">docs#Std.IterM.stepSize</a> is indeed what I was looking for. The notation is indeed less nice, but still pretty good.</p>",
        "id": 570159327,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1769451158
    }
]