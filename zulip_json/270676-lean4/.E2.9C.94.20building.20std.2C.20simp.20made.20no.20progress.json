[
    {
        "content": "<p>Hi, I'm trying to port a mathlib3 project to mathlib4 and I'm struggling to run <code>lake build</code>. I keep getting errors like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"o\">[</span><span class=\"mi\">183</span><span class=\"bp\">/</span><span class=\"mi\">857</span><span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"n\">Std.Data.Option.Lemmas</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">&gt;</span> <span class=\"n\">LEAN_PATH</span><span class=\"bp\">=.\\</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">proofwidgets</span><span class=\"bp\">\\</span><span class=\"n\">build</span><span class=\"bp\">\\</span><span class=\"n\">lib</span><span class=\"bp\">;.\\</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">Cli</span><span class=\"bp\">\\</span><span class=\"n\">build</span><span class=\"bp\">\\</span><span class=\"n\">lib</span><span class=\"bp\">;.\\</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">mathlib</span><span class=\"bp\">\\</span><span class=\"n\">build</span><span class=\"bp\">\\</span><span class=\"n\">lib</span><span class=\"bp\">;.\\</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">Qq</span><span class=\"bp\">\\</span><span class=\"n\">build</span><span class=\"bp\">\\</span><span class=\"n\">lib</span><span class=\"bp\">;.\\</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">aesop</span><span class=\"bp\">\\</span><span class=\"n\">build</span><span class=\"bp\">\\</span><span class=\"n\">lib</span><span class=\"bp\">;.\\</span><span class=\"n\">build</span><span class=\"bp\">\\</span><span class=\"n\">lib</span><span class=\"bp\">;.\\</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">std</span><span class=\"bp\">\\</span><span class=\"n\">build</span><span class=\"bp\">\\</span><span class=\"n\">lib</span> <span class=\"n\">PATH</span> <span class=\"n\">c</span><span class=\"o\">:</span><span class=\"bp\">\\</span><span class=\"n\">Users</span><span class=\"bp\">\\</span><span class=\"n\">skywi</span><span class=\"bp\">\\.</span><span class=\"n\">elan</span><span class=\"bp\">\\</span><span class=\"n\">toolchains</span><span class=\"bp\">\\</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly-2023-08-17\\bin\\lean.exe -Dlinter.missingDocs=true -DwarningAsError=true .\\lake-packages\\std\\.\\.\\Std\\Data\\Array\\Init\\Lemmas.lean -R .\\lake-packages\\std\\.\\. -o .\\lake-packages\\std\\build\\lib\\Std\\Data\\Array\\Init\\Lemmas.olean -i .\\lake-packages\\std\\build\\lib\\Std\\Data\\Array\\Init\\Lemmas.ilean -c .\\lake-packages\\std\\build\\ir\\Std\\Data\\Array\\Init\\Lemmas.c</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">stdout</span><span class=\"o\">:</span>\n<span class=\"bp\">.\\</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">std</span><span class=\"bp\">\\.\\.\\</span><span class=\"n\">Std</span><span class=\"bp\">\\</span><span class=\"n\">Data</span><span class=\"bp\">\\</span><span class=\"n\">Array</span><span class=\"bp\">\\</span><span class=\"n\">Init</span><span class=\"bp\">\\</span><span class=\"n\">Lemmas.lean</span><span class=\"o\">:</span><span class=\"mi\">29</span><span class=\"o\">:</span><span class=\"mi\">26</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">simp</span> <span class=\"n\">made</span> <span class=\"n\">no</span> <span class=\"n\">progress</span>\n<span class=\"bp\">.\\</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">\\</span><span class=\"n\">std</span><span class=\"bp\">\\.\\.\\</span><span class=\"n\">Std</span><span class=\"bp\">\\</span><span class=\"n\">Data</span><span class=\"bp\">\\</span><span class=\"n\">Array</span><span class=\"bp\">\\</span><span class=\"n\">Init</span><span class=\"bp\">\\</span><span class=\"n\">Lemmas.lean</span><span class=\"o\">:</span><span class=\"mi\">29</span><span class=\"o\">:</span><span class=\"mi\">26</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">simp</span> <span class=\"n\">made</span> <span class=\"n\">no</span> <span class=\"n\">progress</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">external</span> <span class=\"n\">command</span> <span class=\"bp\">`</span><span class=\"n\">c</span><span class=\"o\">:</span><span class=\"bp\">\\</span><span class=\"n\">Users</span><span class=\"bp\">\\</span><span class=\"n\">skywi</span><span class=\"bp\">\\.</span><span class=\"n\">elan</span><span class=\"bp\">\\</span><span class=\"n\">toolchains</span><span class=\"bp\">\\</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly-2023-08-17\\bin\\lean.exe` exited with code 1</span>\n</code></pre></div>\n<p>If it matters I'm running Windows.</p>",
        "id": 385656862,
        "sender_full_name": "Sky Wilshaw",
        "timestamp": 1692272767
    },
    {
        "content": "<p>The lakefile looks like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">Lake</span>\n<span class=\"kn\">open</span> <span class=\"n\">Lake</span> <span class=\"n\">DSL</span>\n\n<span class=\"n\">package</span> <span class=\"n\">ConNF</span>\n\n<span class=\"n\">require</span> <span class=\"n\">mathlib</span> <span class=\"k\">from</span> <span class=\"n\">git</span>\n  <span class=\"s2\">\"https://github.com/leanprover-community/mathlib4.git\"</span>\n\n<span class=\"kd\">@[default_target]</span>\n<span class=\"n\">lean_lib</span> <span class=\"n\">ConNF</span>\n</code></pre></div>",
        "id": 385656929,
        "sender_full_name": "Sky Wilshaw",
        "timestamp": 1692272793
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"492774\">@Sky Wilshaw</span>, you are running with a more recent <code>lean-toolchain</code> than <code>std4</code>.</p>",
        "id": 385658243,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1692273310
    },
    {
        "content": "<p>You either need to go back to <code>2023-08-15</code>, or wait for <a href=\"https://github.com/leanprover/std4/pull/190\">https://github.com/leanprover/std4/pull/190</a> to be merged.</p>",
        "id": 385658300,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1692273329
    },
    {
        "content": "<p>That seems to have fixed it, thanks!</p>",
        "id": 385658931,
        "sender_full_name": "Sky Wilshaw",
        "timestamp": 1692273561
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"492774\">Sky Wilshaw</span> has marked this topic as resolved.</p>",
        "id": 385662658,
        "sender_full_name": "Notification Bot",
        "timestamp": 1692274978
    }
]