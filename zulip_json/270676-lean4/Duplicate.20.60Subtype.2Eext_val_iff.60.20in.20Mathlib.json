[
    {
        "content": "<p>Both <code>Mathlib.Algebra.Category.Grp.Images</code> and <code>Mathlib.Algebra.Category.ModuleCat.Images</code> have a constant called <code>Subtype.ext_val_iff</code>. They are both introduced by this line:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">attribute</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"n\">ext</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">ext_val</span>\n</code></pre></div>\n<p>They are shown in generated documentations for both modules: <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Category/ModuleCat/Images.html\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Category/ModuleCat/Images.html</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Category/Grp/Images.html\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Category/Grp/Images.html</a>, although the former is not (easily?) accessible. (Moreover, it seems neither of them are actually used by the two modules, but that is beside the point).</p>\n<p>Is this intended behavior? I think this should be a bug of <code>@[ext]</code>. This problem came up in an extraction of all constants defined in Mathlib, identified by their names.</p>",
        "id": 480251269,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1730582572
    },
    {
        "content": "<p>Sort of, the attribute is supposed to create an ext_iff lemma</p>",
        "id": 480251369,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1730582659
    },
    {
        "content": "<p>but maybe the local attribute shouldn't</p>",
        "id": 480251488,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730582769
    },
    {
        "content": "<p>Yes, here because of this line, even if <code>Mathlib.Algebra.Category.Grp.Images</code> is imported in a separate file, you can still access the lemma <code>Subtype.ext_val_iff</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"n\">Grp</span><span class=\"bp\">.</span><span class=\"n\">Images</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">ext_val_iff</span>\n</code></pre></div>",
        "id": 480251713,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1730582962
    },
    {
        "content": "<p>I guess this still conforms to what the ext attribute description says, but I find it quite weird</p>",
        "id": 480251916,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1730583156
    },
    {
        "content": "<p>Also, I don't quite understand why </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"n\">Grp</span><span class=\"bp\">.</span><span class=\"n\">Images</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Category</span><span class=\"bp\">.</span><span class=\"n\">ModuleCat</span><span class=\"bp\">.</span><span class=\"n\">Images</span>\n</code></pre></div>\n<p>doesn't trigger a name clash (\"import failed, environment already contains ...\")?</p>",
        "id": 480252600,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1730583856
    },
    {
        "content": "<p>Identical theorems no longer cause clashes!</p>",
        "id": 480347288,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730677032
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/270676-lean4/topic/Duplicate.20.60Subtype.2Eext_val_iff.60.20in.20Mathlib/near/480251488\">said</a>:</p>\n<blockquote>\n<p>but maybe the local attribute shouldn't</p>\n</blockquote>\n<p>This seems like a good idea. Issue or PR welcome?</p>",
        "id": 480347308,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730677080
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/stream/270676-lean4/topic/Duplicate.20.60Subtype.2Eext_val_iff.60.20in.20Mathlib/near/480347288\">said</a>:</p>\n<blockquote>\n<p>Identical theorems no longer cause clashes!</p>\n</blockquote>\n<p>But are still banned within modules that import each other?</p>",
        "id": 480382986,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1730705748
    },
    {
        "content": "<p>Sorry, I got this wrong. This is only for (some class of?) automatically generated lemmas.</p>",
        "id": 480385096,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730706735
    },
    {
        "content": "<p>I dug around the code and found the PR that introduces this behavior is <a href=\"https://github.com/leanprover/lean4/pull/3668\">lean4#3668</a></p>",
        "id": 480529295,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1730755763
    },
    {
        "content": "<blockquote>\n<p>Importing two different files containing proofs of the same theorem is no longer considered an error. This feature is particularly useful for theorems that are automatically generated on demand (e.g., equational theorems).</p>\n</blockquote>",
        "id": 480529502,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1730755844
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/270676-lean4/topic/Duplicate.20.60Subtype.2Eext_val_iff.60.20in.20Mathlib/near/480347308\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/270676-lean4/topic/Duplicate.20.60Subtype.2Eext_val_iff.60.20in.20Mathlib/near/480251488\">said</a>:</p>\n<blockquote>\n<p>but maybe the local attribute shouldn't</p>\n</blockquote>\n<p>This seems like a good idea. Issue or PR welcome?</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover/lean4/pull/5978\">lean4#5978</a></p>",
        "id": 480955071,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730909870
    },
    {
        "content": "<p>I commented about <a href=\"https://github.com/leanprover/lean4/pull/3643\">lean4#3643</a> on GitHub, but linkfiers do not work there and I'm on mobile!</p>",
        "id": 480956978,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730910475
    },
    {
        "content": "<p>Is this a resurgence of the issue or a new one?</p>",
        "id": 480957089,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1730910498
    }
]