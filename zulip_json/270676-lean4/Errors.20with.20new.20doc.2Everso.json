[
    {
        "content": "<p>I have two separate issues regarding the new verso-style docstrings. Currently (v4.24.0-rc1), the following raises an enigmatic error:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">.</span><span class=\"n\">verso</span><span class=\"w\"> </span><span class=\"n\">true</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">```</span>\n<span class=\"sd\">some code</span>\n<span class=\"sd\">```</span>\n<span class=\"sd\">-/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\">  </span><span class=\"c1\">-- internal exception #2</span>\n</code></pre></div>\n<p>My second issue is more a feature request. Doc-gen4 <a href=\"https://leanprover-community.github.io/contribute/doc.html#citing-other-works\">supports citations</a> using the Markdown reference style by referencing a citation in <code>docs/references.bib</code>. However, currently the following raise errors if <code>doc.verso</code> is <code>true</code> (as expected):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">doc</span><span class=\"bp\">.</span><span class=\"n\">verso</span><span class=\"w\"> </span><span class=\"n\">true</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">doc-gen4 style citation: [wiles1995]</span>\n<span class=\"sd\">-/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">doc-gen4 style named citation: [text][wiles1995]</span>\n<span class=\"sd\">-/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n</code></pre></div>\n<p>Is there any plan to make this ignore errors, or even directly support citations in verso docstrings?</p>",
        "id": 541498341,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1758816775
    },
    {
        "content": "<p>I looked into your first issue a little and I think I see some (but not all) of why it's happening. Filed <a href=\"https://github.com/leanprover/verso/issues/538\">https://github.com/leanprover/verso/issues/538</a> which contains a little explanation.</p>",
        "id": 541846920,
        "sender_full_name": "Jason Reed",
        "timestamp": 1759016687
    },
    {
        "content": "<p>Not sure about our plans for citations yet, but it seems like a reasonable ask in general. It might be that a different concrete syntax would fit better into the way verso expresses hyperlinks.</p>",
        "id": 541847123,
        "sender_full_name": "Jason Reed",
        "timestamp": 1759016894
    },
    {
        "content": "<p>Thanks for checking this out!</p>\n<p>This option is still at the \"here there be dragons\" stage - this code works fine <a href=\"https://live.lean-lang.org/#project=lean-nightly&amp;codez=JYWwDg9gTgLgBAGQKYEMB2AoCYlsavAUQBsUAjOAYQhBHQBMMBnJGAfWxmAj3ogGMAdADckUJhDgwoAVyQYMAegC0yhegCeUpAA94ACzHyMyxRnpIAZnBRwAXHAByKeHYC8cAAwYgA\">on the latest nightly</a>. I'll make an announcement when it's more ready for use and broader testing.</p>\n<p>As far as references go, the subset of Verso that's in Lean docstrings is arbitrarily extensible by users. There will be documentation  on how to do this once it's ready, but here's <a href=\"https://live.lean-lang.org/#project=lean-nightly&amp;codez=JYWwDg9gTgLgBAGQKYEMB2AoCYlsavAUQBsUAjOAYQhBHQBM4ARCAYwwGckYB9bGYBDz02AOgBuSKBwhwYUAK5IMGALSq4AFQAWwDnA7aIC4ozJI46SzHnAyCmBYDuwGNst5c44FCEhc8EgAHo5oHIJ45rpojK5wUChuUnLaVqlQ9KqsEPRI9Bi5AGZwZHbEggDmCWDaAJ5wAFwAvHAA2gAUAAZgKDhQAIwANHAARJquxBb9I8MjAIIORlBw08MATAAMawCsAJTDXT19a7PjMJNwazOjC27Ql9f9AJxPewC6KgACrSKsPL6TD5FOCsVxIMBwdpOaAAa0acAAkrk0DBdpDsiiAvoGloAMq1FEoIJzKAJeqdYBocpoJBonEsVgAWUhCKplIsJHIrOptMaLREGDgcAUVKQHH0GNCMA4oj0hHAMHqAqFQrcvichFJ0Dm8HaIBhADkTMQDTkLJKsWiQABCEYsMVoADk8BgKBhFhQUAqCn8KJlI0FcGAxUm8Bk/jgEOaJTKlWqdVExAgEBhCgh0KgMNEFW4SJSuEDQqg3AUUDwokcIQMtvaAG8wKI1qJ+gBfYb1xuNlu7ANCpDELiFuChuDiFDlRg4klkuC42xoCp8mNkcoQKq9BN0CHtADtzYrEDnUEpFTRAB8AHwH6coWpDkfReCABMI4DaRgBVLhwIQWNyJIP6DCaAQE4aAjKIj6QmOE6iFukK1hwCgVDmHACEIS6iKhx4LnAO5wN2uz3mumq+FAOpwBmcJvu+aBASBeDFoUUi4KwSCiLWj4tr2KrFjApbltkuQUbC2a5vQB5HieKgAPTqBgcysNkGQnnIsgoHAVSoPARzJLWoKOBCOkDC2rQfGo0kFEgxTqTiBr/tGGwYEAA\">a little taste</a>.</p>",
        "id": 541847525,
        "sender_full_name": "David Thrane Christiansen",
        "timestamp": 1759017340
    },
    {
        "content": "<p>That's just a little sketch of a citation command, but it could be made to do things like parse BibTeX, give better error messages, support all the various natbib options, and so forth, and this can be a library developed outside of core. We may eventually have one in core as well, but just as Lean's extensibility means you don't have to wait for us to do something, Verso's means that you are also able to mold the tool to your needs.</p>",
        "id": 541847677,
        "sender_full_name": "David Thrane Christiansen",
        "timestamp": 1759017515
    },
    {
        "content": "<p>Thank you for the explanation! I didn't know about the extension mechanism, it seems like exactly what I wanted.</p>",
        "id": 541848259,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1759017981
    },
    {
        "content": "<p>Oh, great! Closed the issue, then. Thought my toolchain was set to nightly on my local machine, but it wasn't.</p>",
        "id": 541848409,
        "sender_full_name": "Jason Reed",
        "timestamp": 1759018154
    },
    {
        "content": "<p>Once it's been put a bit more through it's paces, I'll get some documentation into your hands. I'm using it myself for a fair bit of docs work right now, on the theory that it's better for me to encounter the annoying parts and fix them before anyone else starts to rely on it.</p>",
        "id": 541848760,
        "sender_full_name": "David Thrane Christiansen",
        "timestamp": 1759018667
    }
]