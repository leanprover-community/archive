[
    {
        "content": "<p>Is there any particular reason why this is the case? Especially considering it can be easily derived</p>",
        "id": 575004548,
        "sender_full_name": "David Mazarro",
        "timestamp": 1771611655
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> DecidableEq, Except</p>",
        "id": 575004662,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1771611703
    },
    {
        "content": "<p><span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span> nothing found</p>",
        "id": 575004704,
        "sender_full_name": "loogle",
        "timestamp": 1771611719
    },
    {
        "content": "<p>I'm particularly surprised that Batteries and Mathlib also didn't add the instance</p>",
        "id": 575004933,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1771611808
    },
    {
        "content": "<p>I'd be willing to take on this, would this be a desirable addition? Can I simply open a PR with a proposal, or does it need to be approved beforehand? (I've never contributed to Lean)</p>",
        "id": 575074279,
        "sender_full_name": "David Mazarro",
        "timestamp": 1771666251
    },
    {
        "content": "<p>One way to avoid, e.g., compiling Lean, is to open a PR to Batteries or Mathlib, then wait until someone from the FRO upstreams the change.</p>",
        "id": 575091274,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1771684194
    },
    {
        "content": "<p>I thought development for Lean was mostly independent from that of Batteries and Mathlib</p>",
        "id": 575091358,
        "sender_full_name": "David Mazarro",
        "timestamp": 1771684280
    },
    {
        "content": "<p>I think Batteries/Mathlib gets stuff that would be considered too experimental for upstream, or when there are multiple competing solutions. Things get upstreamed once community/FRO makes sure it's a good and complete approach.</p>",
        "id": 575106128,
        "sender_full_name": "Jakub Nowak",
        "timestamp": 1771699358
    },
    {
        "content": "<p>Batteries/Mathlib have lower contribution barriers (e.g., you don't have to recompile Lean and there are more reviewers). Instances and theorems about types from core get upstreamed to the core repository from time to time.</p>",
        "id": 575109086,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1771702549
    },
    {
        "content": "<p>Also a contribution to Lean core will not be available in a release candidate for at least a month, whereas a contribution to batteries is available to mathlib users in a day or so.</p>",
        "id": 575122550,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1771719256
    },
    {
        "content": "<p>Opened a small PR in Batteries: <a href=\"https://github.com/leanprover-community/batteries/pull/1692\">https://github.com/leanprover-community/batteries/pull/1692</a></p>",
        "id": 575157363,
        "sender_full_name": "David Mazarro",
        "timestamp": 1771761456
    },
    {
        "content": "<p>I'm happy to merge this with a low priority instance. But let me speculate why there is no such instance...</p>\n<p>I think the majority of uses of <code>=</code> for <code>Except ε α</code> are misguided. It requires the error type <code>ε</code> to have decidable equality, which may happen, but does it make sense to compare errors that way? For example, if <code>ε</code> is <code>String.Slice</code> then <code>=</code> means that the errors are the same slice of the same string not that the two slices have the same text.</p>\n<p>Anyway, I will merge since it does make sense if <code>ε</code> is a kind of enumeration type (à la ERRNO in C).</p>",
        "id": 575178716,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1771782603
    },
    {
        "content": "<p>What's the point of making it low priority? Any other higher priority instance would be equal to it anyway</p>",
        "id": 575179577,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1771783422
    },
    {
        "content": "<p>Diamonds?</p>",
        "id": 575179752,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1771783573
    },
    {
        "content": "<p>I want a core instance to override systematically, should there ever be one.</p>",
        "id": 575179799,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1771783604
    },
    {
        "content": "<p>I don't think that's particularly worth worrying about, any cure instance would surely be derived anyway</p>",
        "id": 575182764,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1771786145
    },
    {
        "content": "<p>Sometimes, core adds instances and downstream Batteries and Mathlib get no notification. It takes forever for someone to discover the redundant instances via an unexpected diamond. I'm looking into ways to stop that. Reducing priority is a quick way to fix that but I've just come up with germs of other alternatives after this short discussion (thanks!). Other solutions are welcome.</p>",
        "id": 575183701,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1771786920
    },
    {
        "content": "<p>Add a <code>#guard_msgs</code> trying to synthesize the instance just before deriving it?</p>",
        "id": 575190791,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1771793153
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"119741\">@François G. Dorais</span> I think for most use cases, checking for equality on the error type makes sense, at least for testing applications (even if it doesn't make much sense for some types like you said)</p>",
        "id": 575268148,
        "sender_full_name": "David Mazarro",
        "timestamp": 1771842754
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"214703\">@Yury G. Kudryashov</span> want me to add that check to my PR?</p>",
        "id": 575268219,
        "sender_full_name": "David Mazarro",
        "timestamp": 1771842777
    },
    {
        "content": "<p>I think that it's for <span class=\"user-mention\" data-user-id=\"119741\">@François G. Dorais</span> to decide what's to do about it.</p>",
        "id": 575384454,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1771875910
    },
    {
        "content": "<p>My preferred solution at this time is to add a test for Batteries instances that may/should become redundant if a corresponding instance is added to core. When that test fails, Batteries should remove the redundant Batteries instance. So, <span class=\"user-mention\" data-user-id=\"1028543\">@David Mazarro</span>, just ad a test file with the test Yury suggested and I will fine-tune the idea later...</p>",
        "id": 575388594,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1771877383
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"119741\">@François G. Dorais</span> done :)<br>\n<a href=\"https://github.com/leanprover-community/batteries/pull/1692/changes/96a5bf5997c300caf3c5f72a268f8089fca8807d\">https://github.com/leanprover-community/batteries/pull/1692/changes/96a5bf5997c300caf3c5f72a268f8089fca8807d</a><br>\nDoes this look good?</p>",
        "id": 575508743,
        "sender_full_name": "David Mazarro",
        "timestamp": 1771929794
    }
]