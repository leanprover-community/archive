[
    {
        "content": "<p>Hey folks I'm starting to work on the reflectionless potential just to get myself acquianted with lean</p>",
        "id": 532051565,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1753962454
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span></p>",
        "id": 532051599,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1753962467
    },
    {
        "content": "<p>Just for some context Afiq and I have being discussing this 'offline', so this is a place to discuss things related to the QM reflectionless potential in the open.</p>",
        "id": 532052471,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1753962756
    },
    {
        "content": "<p>hey <span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span>  was just thinking of an easy next step - i'm guessing defining the creation and annihilation operators in the paper?</p>",
        "id": 532268650,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754041455
    },
    {
        "content": "<p>Yes, this seems like a good next step to me, that or writing down the full Hamiltonian as a operator on ordinary functions</p>",
        "id": 532271428,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1754042426
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span>  we can discuss this on the call later but I need to use the position and momentum operators, for the creation / annihilation stuff - I guess those are good to import from the Operators module?</p>",
        "id": 532668673,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754294310
    },
    {
        "content": "<p>Yep, it is best to import them from the operators module, if you need any properties of them which aren't yet proven, these should go into the operators module.</p>",
        "id": 532669615,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1754294593
    },
    {
        "content": "<p>awesomesauce</p>",
        "id": 532669743,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754294633
    },
    {
        "content": "<p>pull request made</p>",
        "id": 532677025,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754296924
    },
    {
        "content": "<p>i guess the next dumb thing to do would be to prove creation operator is conjugate to the annihilation one!</p>",
        "id": 532678522,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754297396
    },
    {
        "content": "<p>This might be tricky, but it is certainly doable. It is tricky because by <code>conjugate</code> here you really mean <code>hermitian conjugate</code> (if you don't then it's not true anyway). <br>\nThe way your operators are currently defined, they are defined on the normal functions from <code>‚Ñù ‚Üí ‚ÑÇ</code>, but to define their hermitian conjugate you need them defined on the Hilbert space (at least part of the Hilbert space). <br>\nAn example of this type of thing is done in the momentumOperator file, see e.g. the lemma </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">momentumOperatorUnbounded_isSelfAdjoint</span>\n</code></pre></div>\n<p>In particular, in addition to <code>creationOperator</code> you should also define <code>creationOperatorSchwartz</code> and <code>creationOperatorUnbounded</code> copying what is in the momentum operator module.</p>",
        "id": 532680523,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1754298029
    },
    {
        "content": "<p>agreed to all - will get cracking</p>",
        "id": 532686536,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754299841
    },
    {
        "content": "<p>To do: </p>\n<ul>\n<li>do the Schwartz Space operator versions</li>\n</ul>",
        "id": 532697999,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754303667
    },
    {
        "content": "<p>so <span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span> to even create these Schwartz versions of creation and annihilation operators, we need to prove that they're linear right?</p>",
        "id": 532790899,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754338613
    },
    {
        "content": "<p>ie what you did here: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- The parity operator on the Schwartz maps is defined as the linear map from</span>\n<span class=\"sd\">  `ùì¢(‚Ñù, ‚ÑÇ)` to itself, such that `œà` is taken to `fun x =&gt; - I ‚Ñè * œà' x`. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">momentumOperatorSchwartz</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"n\">L</span><span class=\"o\">[</span><span class=\"n\">‚ÑÇ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"n\">œà</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">‚Ñè</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Ä¢</span><span class=\"w\"> </span><span class=\"n\">SchwartzMap</span><span class=\"bp\">.</span><span class=\"n\">derivCLM</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"n\">œà</span>\n<span class=\"w\">  </span><span class=\"n\">map_add'</span><span class=\"w\"> </span><span class=\"n\">œà1</span><span class=\"w\"> </span><span class=\"n\">œà2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">neg_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">map_add</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">smul_add</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">neg_smul</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">map_smul'</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">œà</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">neg_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">map_smul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">neg_smul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">RingHom</span><span class=\"bp\">.</span><span class=\"n\">id_apply</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">smul_comm</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"n\">cont</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">fun_prop</span>\n</code></pre></div>",
        "id": 532790938,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754338629
    },
    {
        "content": "<p>in the case of the creation and annihilation operators, would the cleanest way be to prove that the tanh operator is Schwartz, and then since their linear combinations of the tanh operator and the momentum operator =&gt; creation and annihilation operators are aalso schwartz</p>",
        "id": 532791420,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754338839
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"941733\">Afiq Hatta</span> <a href=\"#narrow/channel/479953-PhysLean/topic/QM.20reflectionless.20potential/near/532790899\">said</a>:</p>\n<blockquote>\n<p>so <span class=\"user-mention silent\" data-user-id=\"653351\">Joseph Tooby-Smith</span> to even create these Schwartz versions of creation and annihilation operators, we need to prove that they're linear right?</p>\n</blockquote>\n<p>Yes, exactly, the <code>‚ÜíL[‚ÑÇ]</code> is the notation for a continuous linear map.</p>",
        "id": 532791606,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1754338932
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"941733\">Afiq Hatta</span> <a href=\"#narrow/channel/479953-PhysLean/topic/QM.20reflectionless.20potential/near/532791420\">said</a>:</p>\n<blockquote>\n<p>in the case of the creation and annihilation operators, would the cleanest way be to prove that the tanh operator is Schwartz, and then since their linear combinations of the tanh operator and the momentum operator =&gt; creation and annihilation operators are aalso schwartz</p>\n</blockquote>\n<p>Yep that sounds like the best way to me.</p>",
        "id": 532791649,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1754338954
    },
    {
        "content": "<p>really dumb question </p>\n<p>I know what is required for a continuous linear map, but how in general can i find the 'requirements' needed to define a particular structure? </p>\n<p>is it the 'fields' section of what i get when i type ```<br>\n#print ContinuousLinearMap</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">ContinuousLinearMap</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u_1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u_2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u_3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u_4</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_2</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Semiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Semiring</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">œÉ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">‚Üí+*</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_4</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">M‚ÇÇ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">M‚ÇÇ</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">M‚ÇÇ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">u_3</span><span class=\"w\"> </span><span class=\"n\">u_4</span><span class=\"o\">)</span>\n<span class=\"n\">number</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">parameters</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">13</span>\n<span class=\"n\">parents</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">ContinuousLinearMap</span><span class=\"bp\">.</span><span class=\"n\">toLinearMap</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">‚Üí‚Çõ‚Çó</span><span class=\"o\">[</span><span class=\"n\">œÉ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M‚ÇÇ</span>\n<span class=\"n\">fields</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">AddHom</span><span class=\"bp\">.</span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">M‚ÇÇ</span>\n<span class=\"w\">  </span><span class=\"n\">AddHom</span><span class=\"bp\">.</span><span class=\"n\">map_add'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚Üë</span><span class=\"n\">self</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚Üë</span><span class=\"n\">self</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚Üë</span><span class=\"n\">self</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"n\">y</span>\n<span class=\"w\">  </span><span class=\"n\">MulActionHom</span><span class=\"bp\">.</span><span class=\"n\">map_smul'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚Üë</span><span class=\"n\">self</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">‚Ä¢</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">œÉ</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">‚Ä¢</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚Üë</span><span class=\"n\">self</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"n\">ContinuousLinearMap</span><span class=\"bp\">.</span><span class=\"n\">cont</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Continuous</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚Üë</span><span class=\"n\">self</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">continuity</span>\n<span class=\"n\">constructor</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">ContinuousLinearMap</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u_1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u_2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u_3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u_4</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_2</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Semiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Semiring</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">œÉ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">‚Üí+*</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_3</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_4</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">M‚ÇÇ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">M‚ÇÇ</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">M‚ÇÇ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">toLinearMap</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">‚Üí‚Çõ‚Çó</span><span class=\"o\">[</span><span class=\"n\">œÉ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cont</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Continuous</span><span class=\"w\"> </span><span class=\"n\">toLinearMap</span><span class=\"bp\">.</span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">continuity</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"n\">SL</span><span class=\"o\">[</span><span class=\"n\">œÉ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M‚ÇÇ</span>\n<span class=\"n\">field</span><span class=\"w\"> </span><span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"n\">resolution</span><span class=\"w\"> </span><span class=\"n\">order</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">ContinuousLinearMap</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LinearMap</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">AddHom</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">MulActionHom</span>\n</code></pre></div>",
        "id": 532795032,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754340309
    },
    {
        "content": "<p>The way I do it is just start typing the definition, e.g.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">momentumOperatorSchwartz</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"n\">L</span><span class=\"o\">[</span><span class=\"n\">‚ÑÇ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n</code></pre></div>\n<p>This will then give an error on the <code>where</code> because things are incomplete, and the error will list the fields needed.</p>",
        "id": 532837671,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1754372356
    },
    {
        "content": "<p>got it  - thanks Joe for the flag</p>",
        "id": 532869628,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754384388
    },
    {
        "content": "<p>really dumb question <span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span>  but i can't get this to work - just even the definition part </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">tanhOperatorSchwartz</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"n\">L</span><span class=\"o\">[</span><span class=\"n\">‚ÑÇ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"n\">œà</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Q</span><span class=\"bp\">.</span><span class=\"n\">Œ∫</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">œà</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>I am getting this error <br>\ntype mismatch<br>\n  fun x =&gt; ‚Üë(tanh (Q.Œ∫ * x)) * œà x<br>\nhas type<br>\n  ‚Ñù ‚Üí ‚ÑÇ : Type<br>\nbut is expected to have type<br>\n  ùì¢(‚Ñù, ‚ÑÇ) : Type</p>",
        "id": 533644684,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754824533
    },
    {
        "content": "<p>I don't see anything wrong with the definition itself - where am I falling over?</p>",
        "id": 533644746,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754824610
    },
    {
        "content": "<p>am i not 'casting' the function correctly here?</p>",
        "id": 533644851,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754824729
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"941733\">@Afiq Hatta</span> you're misinterpreting what toFun means</p>",
        "id": 533645716,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1754825767
    },
    {
        "content": "<p>toFun requires you to make a function <code>ùì¢(‚Ñù, ‚ÑÇ) -&gt; ùì¢(‚Ñù, ‚ÑÇ)</code> first</p>",
        "id": 533645730,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1754825782
    },
    {
        "content": "<p>and prove that this function is linear and continuous</p>",
        "id": 533645736,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1754825792
    },
    {
        "content": "<p>it does <strong>not</strong> mean, first make a function <code>ùì¢(‚Ñù, ‚ÑÇ) -&gt; (‚Ñù -&gt; ‚ÑÇ)</code>, and prove that every result is Schwarz</p>",
        "id": 533645810,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1754825880
    },
    {
        "content": "<p>in other words, you need two layers of toFun here</p>",
        "id": 533645816,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1754825888
    },
    {
        "content": "<p>ahhh i hear you - i need to first prove that pointwise multiplication by tanh ( x ) is itself - <code>ùì¢(‚Ñù, ‚ÑÇ) -&gt; ùì¢(‚Ñù, ‚ÑÇ)</code> (by boundedness, continuity) ? <span class=\"user-mention\" data-user-id=\"110064\">@Kenny Lau</span></p>",
        "id": 533646088,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754826176
    },
    {
        "content": "<p>apologies - beginner here!! :p</p>",
        "id": 533646107,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754826193
    },
    {
        "content": "<p>if thats the case - then there should be an inductive proof that all derivatives of (tanh (x) psi (x) ) don't blow up - i don't think theres a general result that we can apply here from other places in the library?</p>",
        "id": 533647646,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754827414
    },
    {
        "content": "<p>what's the maths proof?</p>",
        "id": 533648092,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1754827893
    },
    {
        "content": "<p>writing it down now...</p>",
        "id": 533648116,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754827916
    },
    {
        "content": "<p>I feel like it should follow from tanh(x) itself being Schwartz?</p>",
        "id": 533648161,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1754827951
    },
    {
        "content": "<p>its not though right, since -&gt; +- 1 at +- infty?</p>",
        "id": 533648416,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754828197
    },
    {
        "content": "<p>oh...</p>",
        "id": 533648421,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1754828210
    },
    {
        "content": "<p>well, it should then follow from tanh(x) being bounded and its derivatives vanishing</p>",
        "id": 533648442,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1754828230
    },
    {
        "content": "<p>yeah - actually thats the best way - but trying to see if there's already a ready made proof here on that result</p>",
        "id": 533648476,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754828271
    },
    {
        "content": "<p>Just breaking this down - need to prove the lemma that tanh (x) has bounded derivatives</p>",
        "id": 533654874,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754835577
    },
    {
        "content": "<p>can you guys tell im an absolute noob.. hahaha</p>",
        "id": 533655096,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754835794
    },
    {
        "content": "<p>Sorry, jumping into this conversation half way through: Something like </p>\n<ul>\n<li><a href=\"https://github.com/HEPLean/PhysLean/blob/17a19df0a80a74ddc996b6650330559d8a3e261c/PhysLean/Mathematics/Distribution/OfBounded.lean#L680\">this</a> </li>\n</ul>\n<p>might be useful here, all though I think it would need generalizing.</p>",
        "id": 533664133,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1754845792
    },
    {
        "content": "<p>wow you've added a lot of lemmas, nice</p>",
        "id": 533664189,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1754845835
    },
    {
        "content": "<p>Yeah, they are all probably not as general as they could be - but I did a start :).</p>",
        "id": 533667736,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1754849436
    },
    {
        "content": "<p>keen to talk about this tomorrow!</p>",
        "id": 533678528,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1754862390
    },
    {
        "content": "<p>an excuritatingly dumb question which I've spent too much time on </p>\n<p>I want to prove  | tanh x | &lt; 1 <br>\nok, so start with <br>\nlemma : tanh x &lt; 1 <br>\nthere's an equality rewrite so that the goal transforms to </p>\n<p>sinh x / cosh x &lt; 1 </p>\n<p>but i can't for the life of me find the right package / technique that transforms this to <br>\nsinh x  &lt; cosh x </p>\n<p>there's a preset theorem  already in mathlib for sinh x &lt; cosh x, so I just need to do the above <br>\n<span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span></p>",
        "id": 534234207,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755092886
    },
    {
        "content": "<p><a href=\"https://loogle.lean-lang.org/?q=_+%2F+_+&lt;+1\">https://loogle.lean-lang.org/?q=_+%2F+_+&lt;+1</a></p>",
        "id": 534234363,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755092930
    },
    {
        "content": "<p>thanks kenny, sorry for being an idiot, still getting used to searching for things</p>",
        "id": 534234815,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755093068
    },
    {
        "content": "<p>ah wait - those are for the natural numbers</p>",
        "id": 534235034,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755093135
    },
    {
        "content": "<p>well, not the first one</p>",
        "id": 534235064,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755093144
    },
    {
        "content": "<p>the 6th one should be what you need</p>",
        "id": 534235220,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755093187
    },
    {
        "content": "<p>this is where im falling over the syntax a bit</p>",
        "id": 534236309,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755093513
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">tanh_le_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">div_lt_one</span>\n</code></pre></div>",
        "id": 534236326,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755093516
    },
    {
        "content": "<p>Expected type<br>\n<strong>x</strong>¬†:¬†‚Ñù<br>\n<strong>‚ä¢</strong> ‚àÄ {Œ± : Type ?u.1166} [inst : Semifield Œ±] [inst_1 : LinearOrder Œ±] [IsStrictOrderedRing Œ±] {a b : Œ±}, 0 &lt; b ‚Üí (a / b &lt; 1 ‚Üî a &lt; b)</p>\n<p>Messages (1)</p>\n<p>Basic.lean:68:2</p>\n<p>tactic 'apply' failed, could not unify the conclusion of <code>@div_lt_one</code><br>\n  ?a / ?b &lt; 1 ‚Üî ?a &lt; ?b<br>\nwith the goal<br>\n  sinh x / cosh x &lt; 1<br>\nNote: The full type of <code>@div_lt_one</code> is<br>\n  ‚àÄ {Œ± : Type ?u.1166} [inst : Semifield Œ±] [inst_1 : LinearOrder Œ±] [IsStrictOrderedRing Œ±] {a b : Œ±},<br>\n    0 &lt; b ‚Üí (a / b &lt; 1 ‚Üî a &lt; b)<br>\n<strong>x</strong>¬†:¬†‚Ñù<br>\n<strong>‚ä¢</strong> sinh x / cosh x &lt; 1</p>\n<p>All Messages (1)</p>",
        "id": 534236451,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755093541
    },
    {
        "content": "<p>it's not an <code>apply</code>, it's a <code>rw</code></p>",
        "id": 534236509,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755093557
    },
    {
        "content": "<p>got it - this creates a subgoal where now i need to prove 0 &lt; cosh x as expected, and then sinh x &lt; cosh x</p>",
        "id": 534237189,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755093744
    },
    {
        "content": "<p>thanks kenny</p>",
        "id": 534237198,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755093747
    },
    {
        "content": "<p>woohoo!!</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">tanh_le_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">div_lt_one</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">sinh_lt_cosh</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">cosh_pos</span>\n</code></pre></div>",
        "id": 534237434,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755093809
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"941733\">@Afiq Hatta</span> <code>rw</code> rewrites an iff, <code>apply</code> is for applying P -&gt; Q to a goal Q to get a goal P</p>",
        "id": 534237463,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755093817
    },
    {
        "content": "<p>got it, and rw also works for equalities too right</p>",
        "id": 534237576,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755093838
    },
    {
        "content": "<p>yes</p>",
        "id": 534237613,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755093841
    },
    {
        "content": "<p>one thing im finding hard is that i often want to apply results on the reals, <br>\nbut most of the theorems that i get from loogle / searching mathlib or defined on like rings / fields / monoids (?!!)</p>",
        "id": 534240647,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755094686
    },
    {
        "content": "<p>so i have to do the mental gymnastics to remember what's what</p>",
        "id": 534240730,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755094711
    },
    {
        "content": "<p>you can try to separate it out into a clean environment (i.e. <code>example</code>) and then use <code>apply?</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply?</span>\n</code></pre></div>",
        "id": 534241081,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755094811
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span>  in the process of linting: <br>\n<a href=\"https://github.com/HEPLean/PhysLean/pull/694/files\">https://github.com/HEPLean/PhysLean/pull/694/files</a></p>",
        "id": 534674559,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755272876
    },
    {
        "content": "<p>Going back to the problem of showing that</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">œà</span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>is Schwartz if <code>œà</code> is, I think the general version of this result is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SchwartzMap.bilinLeftCLM#doc\">docs#SchwartzMap.bilinLeftCLM</a> with the bilinear map <code>B : ‚Ñù ‚ÜíL[‚Ñù] ‚Ñù ‚ÜíL[‚Ñù] ‚Ñù </code> taking <code>x, y</code> to <code>x * y</code>, and with <code>g(x) = tanh(x)</code>. Thus to prove this result 'all' one would need to do is prove that <code>Function.HasTemperateGrowth Real.tanh</code>, which is essentially what you are trying to show anyway <span class=\"user-mention\" data-user-id=\"941733\">@Afiq Hatta</span> .</p>",
        "id": 534681454,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1755275928
    },
    {
        "content": "<p>ooooh</p>",
        "id": 534682082,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755276213
    },
    {
        "content": "<p>yeah good point - lets use that  - thats perfect¬±</p>",
        "id": 534682237,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755276296
    },
    {
        "content": "<p>btw <span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span>  linters passed on last commit</p>",
        "id": 534682299,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755276309
    },
    {
        "content": "<p>Yeah, </p>\n<p><span class=\"user-mention silent\" data-user-id=\"941733\">Afiq Hatta</span> <a href=\"#narrow/channel/479953-PhysLean/topic/QM.20reflectionless.20potential/near/534682237\">said</a>:</p>\n<blockquote>\n<p>yeah good point - lets use that  - thats perfect¬±</p>\n</blockquote>\n<p>Yeah - still need to show that tanh has bounded iterated derivatives for this, but it takes care of the 'SchwartzMap' side of the problem for you, and reduces it to a properties of 'tanh' problem.</p>",
        "id": 534682402,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1755276368
    },
    {
        "content": "<p>yeah exactly, we don't have to do the leg work of the closure stuff since we cn just use this. but still, need to prove that we have bounded iterated derivs</p>",
        "id": 534682479,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755276407
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span>  the mission here is to prove temperate growth, as a warm up going to commit these that i just did </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c\">/-</span>\n<span class=\"cm\">Copyright (c) 2025 Afiq Hatta. All rights reserved.</span>\n<span class=\"cm\">Released under Apache 2.0 license as described in the file LICENSE.</span>\n<span class=\"cm\">Authors: Afiq Hatta</span>\n<span class=\"cm\">-/</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Calculus</span><span class=\"bp\">.</span><span class=\"n\">IteratedDeriv</span><span class=\"bp\">.</span><span class=\"n\">Defs</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">Trigonometric</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">PhysLean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">Linters</span><span class=\"bp\">.</span><span class=\"n\">Sorry</span>\n\n<span class=\"c\">/-</span><span class=\"cm\">!</span>\n<span class=\"cm\"># Properties of Tanh</span>\n<span class=\"cm\">We want to prove that the reflectionless potential is a Schwartz map.</span>\n<span class=\"cm\">This means proving that pointwise multiplication of a Schwartz map with tanh is a Schwartz map.</span>\n<span class=\"cm\">This means we need to prove that all derivatives of tanh are bounded and continuous, so that</span>\n<span class=\"cm\">the nth derivative of a function multiplied by tanh decays faster than any polynomial.</span>\n\n<span class=\"cm\">## TODO</span>\n<span class=\"cm\">- Add these to mathlib eventually</span>\n<span class=\"cm\">- Fill in the proofs for the properties of tanh</span>\n<span class=\"cm\">-/</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">NNReal</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Field</span>\n\n\n<span class=\"sd\">/-- tanh(x) is less than 1 for all x -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">tanh_lt_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">div_lt_one</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">sinh_lt_cosh</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">cosh_pos</span>\n\n<span class=\"sd\">/-- tanh(x) is greater than -1 for all x -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">minus_one_lt_tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">lt_div_iff‚ÇÄ</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">sub_pos</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">neg_one_mul</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">exp_pos</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">cosh_pos</span>\n\n<span class=\"sd\">/-- The absolute value of tanh is bounded by 1 -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">abs_tanh_lt_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">abs_lt</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">minus_one_lt_tanh</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">tanh_lt_one</span>\n</code></pre></div>",
        "id": 535700481,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755874345
    },
    {
        "content": "<p>Sounds good! I would maybe update the module doc-string with a comment about <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SchwartzMap.bilinLeftCLM#doc\">docs#SchwartzMap.bilinLeftCLM</a> as well. Also, this is not necessary but it maybe good to know, you can combine rewrites e.g. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">minus_one_lt_tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">lt_div_iff‚ÇÄ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">sub_pos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">neg_one_mul</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">exp_pos</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">cosh_pos</span>\n</code></pre></div>",
        "id": 535701370,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1755874631
    },
    {
        "content": "<p>Not the most experienced user here but some minor style comments:</p>\n<ol>\n<li>if you opened namespace <code>Real</code>, you don't have to type <code>Real.xxx</code></li>\n<li>The <code>cosh_pos</code> goal arises as a result of using lemmas related to division by <code>cosh</code>, since it's an additional condition associated with the division lemma rather than part of the main proof personally I'd just inline it</li>\n<li>I prefer using <code>exact</code> to close goals which indicates more clearly where the proof ends</li>\n<li>if the proof itself does require multiple goals use centerdot (<code>\\.</code>) to structure the proof for better clarity (e.g. after constructor).</li>\n</ol>\n<p>for example, this is how I'd write your code:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">tanh_lt_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">div_lt_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cosh_pos</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">sinh_lt_cosh</span><span class=\"w\"> </span><span class=\"n\">x</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">minus_one_lt_tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">lt_div_iff‚ÇÄ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cosh_pos</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">sub_pos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">neg_one_mul</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">exp_pos</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">]</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">abs_tanh_lt_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">abs_lt</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">minus_one_lt_tanh</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">tanh_lt_one</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>",
        "id": 535710911,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1755877699
    },
    {
        "content": "<p>this is great <span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span> <span class=\"user-mention\" data-user-id=\"890057\">@ZhiKai Pong</span>  thank you for the tips</p>",
        "id": 535711564,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755877919
    },
    {
        "content": "<p>(I guess you can also do this once you're more comfortable)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">abs_tanh_lt_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">abs_lt</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">minus_one_lt_tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">tanh_lt_one</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">‚ü©</span>\n</code></pre></div>",
        "id": 535711626,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1755877942
    },
    {
        "content": "<p>Aside concerning the center dots: there is this open <a href=\"https://github.com/HEPLean/PhysLean/issues/353\">issue</a> which I attempted to do complete <a href=\"https://github.com/HEPLean/PhysLean/pull/603\">here</a>, but one thing or another got in the way</p>",
        "id": 535716585,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1755879658
    },
    {
        "content": "<p>guys i have a mega dumb question </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- Tanh(x) is n times continuously differentiable for all n -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">contDiff_tanh</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hdiv</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">sinh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">cosh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"bp\">.</span><span class=\"n\">div</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">contDiff_sinh</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">contDiff_cosh</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">ne_of_gt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">cosh_pos</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n\n<span class=\"w\">  </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">hdiv</span>\n</code></pre></div>\n<p>the last line is throwing error - </p>\n<p>type mismatch, term<br>\n  hdiv<br>\nafter simplification has type<br>\n  ContDiff ‚Ñù ‚Üën fun x =&gt; sinh x / cosh x : Prop<br>\nbut is expected to have type<br>\n  ContDiff ‚Ñù (‚Üën) tanh : Prop</p>\n<p>what is the syntax to use the tanh = sinh / coosh to finally prove this thing?</p>",
        "id": 535725607,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755883175
    },
    {
        "content": "<p>rewriting the goal with rw [ <code>tanh_eq_sinh_div_cosh</code>] doesn't work</p>",
        "id": 535725760,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755883245
    },
    {
        "content": "<p>here's a possible solution (there might be an easier way) (also I'm surprised this isn't in Mathlib)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span>\n\n<span class=\"sd\">/-- Tanh(x) is n times continuously differentiable for all n -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">contDiff_tanh</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hdiv</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">sinh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">cosh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"bp\">.</span><span class=\"n\">div</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">contDiff_sinh</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">contDiff_cosh</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">ne_of_gt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cosh_pos</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">conv</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">enter</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hdiv</span>\n</code></pre></div>",
        "id": 535727653,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1755884141
    },
    {
        "content": "<p>there are two layers of issue here:</p>\n<ol>\n<li><code>rw</code> can't see through what's inside <code>ContDiff</code></li>\n<li><code>tanh_eq_sinh_div_cosh</code> has to be of the form <code>tanh x = sinh x / cosh x</code>, so you have to give it an <code>x</code>. Not sure if you're familiar with <code>ext</code>, the <code>enter</code> is just doing that in a similar fashion</li>\n</ol>",
        "id": 535727885,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1755884266
    },
    {
        "content": "<p>ah - yeah i wanted to figure out how to do the replacement of tanh within ContDiff</p>",
        "id": 535728170,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755884411
    },
    {
        "content": "<p>thank you for this</p>",
        "id": 535729124,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755884805
    },
    {
        "content": "<p>No worries!</p>",
        "id": 535729479,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1755884897
    },
    {
        "content": "<p>btw i couldn't find this in mathlib - do you agree it's not there? still trying to build my searching skills</p>",
        "id": 535729641,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755884984
    },
    {
        "content": "<p>(sorry first time trying to do this in zulip)</p>",
        "id": 535730302,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1755885296
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> tanh</p>",
        "id": 535730443,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1755885358
    },
    {
        "content": "<p><span aria-label=\"exclamation\" class=\"emoji emoji-2757\" role=\"img\" title=\"exclamation\">:exclamation:</span> unknown identifier 'tanh'<br>\nDid you mean <a href=\"https://loogle.lean-lang.org/?q=%22tanh%22\"><code>\"tanh\"</code></a>, <a href=\"https://loogle.lean-lang.org/?q=Float.tanh\"><code>Float.tanh</code></a>, or <a href=\"https://loogle.lean-lang.org/?q=tanh\">something else</a>?</p>",
        "id": 535730447,
        "sender_full_name": "loogle",
        "timestamp": 1755885359
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> Real.tanh</p>",
        "id": 535730547,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1755885412
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Data/Complex/Trigonometric.html#Real.tanh\">Real.tanh</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Data/Complex/Trigonometric.html#Complex.ofReal_tanh\">Complex.ofReal_tanh</a>, and <a href=\"https://loogle.lean-lang.org/?q=Real.tanh\">7 more</a></p>",
        "id": 535730548,
        "sender_full_name": "loogle",
        "timestamp": 1755885412
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> Real.sinh</p>",
        "id": 535730570,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1755885424
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Data/Complex/Trigonometric.html#Real.sinh\">Real.sinh</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Data/Complex/Trigonometric.html#Real.sinh_lt_cosh\">Real.sinh_lt_cosh</a>, and <a href=\"https://loogle.lean-lang.org/?q=Real.sinh\">117 more</a></p>",
        "id": 535730573,
        "sender_full_name": "loogle",
        "timestamp": 1755885425
    },
    {
        "content": "<p>It's quite clear that a lot is missing for <code>tanh</code> :)</p>",
        "id": 535730613,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1755885447
    },
    {
        "content": "<p>(this is <a href=\"https://loogle.lean-lang.org/\">https://loogle.lean-lang.org/</a>)</p>",
        "id": 535730659,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1755885470
    },
    {
        "content": "<p>yeah - reflectionless potential sidequests to the rescue!! XD</p>",
        "id": 535730662,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755885471
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span> i submitted a pull request but no rush - its fridayyy night!!!</p>",
        "id": 535746841,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755892271
    },
    {
        "content": "<p>Ha - no worries, was literally doing it as I got this message :)</p>",
        "id": 535747275,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1755892478
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span>  to prove the derivative of tanh x  - will using the identity below make this a bit easier, then using the chain rule on this  - or will there be shenanigans with Real / Complex </p>\n<p>theorem tanh_mul_I : tanh (x * I) = tan x * I := by<br>\n  rw [tanh_eq_sinh_div_cosh, cosh_mul_I, sinh_mul_I, mul_div_right_comm, tan]</p>",
        "id": 535809947,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1755959628
    },
    {
        "content": "<p>This might work, it really depends on how good the API is around real to complex numbers - if I recall it is quite good.</p>",
        "id": 535814791,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1755964858
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span>  really DUMB q i cant seem to rewrite the goal here so that i can use my h result </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- The derivative of tanh(x) is 1 - tanh(x)^2 -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">deriv_tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sinh</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">cosh</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv_div</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">deriv_sinh</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">deriv_cosh</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">field_simp</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">sq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_sub_right_distrib</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">field_simp</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">differentiable_sinh</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">differentiable_cosh</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">ne_of_gt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">cosh_pos</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n</code></pre></div>\n<p><code>tanh_eq_sinh_div_cosh</code> is the result tanh x = sinh x / cosh x </p>\n<p>using funext x i think rewrites that goal as (deriv Real.tanh) x , so the pesky symbols aren't in the right place</p>",
        "id": 536218151,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756208928
    },
    {
        "content": "<p>i have this </p>\n<p>unsolved goals<br>\n<strong>x</strong>¬†:¬†‚Ñù<br>\n<strong>h</strong>¬†:¬†deriv (sinh / cosh) x = 1 - tanh x ^ 2<br>\n<strong>‚ä¢</strong> deriv tanh = fun x =&gt; 1 - tanh x ^ 2</p>",
        "id": 536218234,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756208960
    },
    {
        "content": "<p>i could make a functional version of </p>\n<p>tanh_eq_sinh_div_cosh such that tanh = sinh / cosh, and then change the form of h to make it \"functional\" but i m not sure how to do that</p>",
        "id": 536218404,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756209022
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 536218750,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756209141
    },
    {
        "content": "<p>try <code>funext x</code> :)</p>",
        "id": 536219329,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756209334
    },
    {
        "content": "<p>OH WAIT I GOT IT i think</p>",
        "id": 536219424,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756209360
    },
    {
        "content": "<p>i think i answered my own question by asking it hah</p>",
        "id": 536219460,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756209374
    },
    {
        "content": "<p>boom </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- The derivative of tanh(x) is 1 - tanh(x)^2 -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">deriv_tanh</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sinh</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">cosh</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv_div</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">deriv_sinh</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">deriv_cosh</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">field_simp</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">sq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_sub_right_distrib</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">field_simp</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">differentiable_sinh</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">differentiable_cosh</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">ne_of_gt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">cosh_pos</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h'</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sinh</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">cosh</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Pi</span><span class=\"bp\">.</span><span class=\"n\">div_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">nth_rewrite</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h'</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>",
        "id": 536219986,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756209542
    },
    {
        "content": "<p>one big leap for tanh</p>",
        "id": 536220042,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756209559
    },
    {
        "content": "<p>okay will commit this</p>",
        "id": 536220116,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756209580
    },
    {
        "content": "<p>Nice, congrats! <span aria-label=\"grinning\" class=\"emoji emoji-1f600\" role=\"img\" title=\"grinning\">:grinning:</span></p>",
        "id": 536220138,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756209586
    },
    {
        "content": "<p>So I don't have an explanation for this, other then 'field_simp' is an awesome tactic, but your proof of <code>h</code> can be golfed to:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span>\n<span class=\"sd\">/-- The derivative of tanh(x) is 1 - tanh(x)^2 -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">deriv_tanh</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sinh</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">cosh</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">    </span><span class=\"n\">field_simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv_div</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">deriv_sinh</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">deriv_cosh</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sq</span><span class=\"o\">,</span>\n<span class=\"w\">       </span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_sub_right_distrib</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h'</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sinh</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">cosh</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Pi</span><span class=\"bp\">.</span><span class=\"n\">div_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">nth_rewrite</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h'</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>\n<p>(I think this is something one would only find given an already complete proof)</p>",
        "id": 536221390,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756209961
    },
    {
        "content": "<p>awesome. </p>\n<p>i also have another dumb question: if, in an inductive proof, we use the inductive hypothesis, how do we 'obtain' that object from it and use it. </p>\n<p>example: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- The nth derivative of Tanh(x) is a polynomial of Tanh(x) -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">iteratedDeriv_tanh_is_polynomial_of_tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">iteratedDeriv</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iteratedDeriv_zero</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">X</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iteratedDeriv_succ</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>im trying to 'use' the polynomial in the induction hypothesis <br>\n<strong>case</strong> succ<br>\n<strong>x</strong>¬†:¬†‚Ñù<br>\n<strong>n‚úù</strong>¬†:¬†‚Ñï<br>\n<strong>a‚úù</strong>¬†:¬†‚àÉ P, ‚àÄ (x : ‚Ñù), iteratedDeriv n‚úù tanh x = Polynomial.eval (tanh x) P<br>\n<strong>‚ä¢</strong> ‚àÉ P, ‚àÄ (x : ‚Ñù), deriv (iteratedDeriv n‚úù tanh) x = Polynomial.eval (tanh x) P</p>",
        "id": 536236739,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756214841
    },
    {
        "content": "<p>so here we have in a‚úù that there is some polynomial such that nth iterated deriv is a polynomial of tan, and i want to sub that into the goal</p>",
        "id": 536237021,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756214921
    },
    {
        "content": "<p>I think the tactic you want is <code>obtain</code>. I would set this up as follows: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span>\n\n<span class=\"sd\">/-- The nth derivative of Tanh(x) is a polynomial of Tanh(x) -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">iteratedDeriv_tanh_is_polynomial_of_tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">iteratedDeriv</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iteratedDeriv_zero</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">X</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">P</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h'</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iteratedDeriv_succ</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 536239916,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756215677
    },
    {
        "content": "<p>dumb question so where does ih come from here ?</p>",
        "id": 536240021,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756215708
    },
    {
        "content": "<p>ah no worries, got it</p>",
        "id": 536240065,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756215718
    },
    {
        "content": "<p>More generally you can get rid of the <code>‚úù</code>'s with the <code>expose_names</code> tactic.</p>",
        "id": 536240620,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756215832
    },
    {
        "content": "<p>got it, thanks joe</p>",
        "id": 536240875,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756215896
    },
    {
        "content": "<p>okok so i have to modify P then use it</p>",
        "id": 536241071,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756215953
    },
    {
        "content": "<p>Yeah, the P in your goal is not going to be the same one you obtain from the induction hypothesis. <br>\nNamely I think the one in your goal should be <code>(1 - X ^ 2) * Polynomial.derivative P</code> or something along those lines</p>",
        "id": 536242508,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756216362
    },
    {
        "content": "<p>yeah</p>",
        "id": 536242656,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756216396
    },
    {
        "content": "<p>need to rewrite deriv (iteratedDeriv n tanh) x as deriv (Polynomial.eval (tanh x) P ), then apply chain rule, then use modified ploynomail</p>",
        "id": 536242978,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756216491
    },
    {
        "content": "<p>Yep, this seems right to me.</p>",
        "id": 536243121,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756216525
    },
    {
        "content": "<p>hm - im pretty sure i've got this rewrite correct, but still getting a fail </p>\n<p><strong>‚ä¢</strong> ‚àÉ P_1, ‚àÄ (x : ‚Ñù), deriv ((fun t =&gt; Polynomial.eval t P) ‚àò tanh) x = Polynomial.eval (tanh x) P_1</p>\n<p>Tanh.lean:92:8</p>\n<p>tactic 'rewrite' failed, did not find instance of the pattern in the target expression<br>\n  deriv (?h‚ÇÇ ‚àò ?h) ?x<br>\n*</p>",
        "id": 536252488,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756219059
    },
    {
        "content": "<p>applying the derivative composition theorem here</p>",
        "id": 536252619,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756219089
    },
    {
        "content": "<p>Could you paste a code snippet with the failing rewrite?</p>",
        "id": 536252677,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756219105
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">iteratedDeriv_tanh_is_polynomial_of_tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">iteratedDeriv</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iteratedDeriv_zero</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">X</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">P</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h'</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iteratedDeriv_succ</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h''</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">iteratedDeriv</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h'</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h_comp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚àò</span><span class=\"w\"> </span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">comp_apply</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h''</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h_comp</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv_comp</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 536252737,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756219118
    },
    {
        "content": "<p>its that last deriv_comp that fails</p>",
        "id": 536252781,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756219131
    },
    {
        "content": "<p>is this a teachable moment - the symbols match up, but the match isn't working, is there something else that has to match, like the type on t?</p>",
        "id": 536253271,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756219261
    },
    {
        "content": "<p>get rid of the quantifiers first, i.e. <code>use P</code> and <code>intro x</code>(I'm just guessing from the infoview)</p>",
        "id": 536255243,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1756219834
    },
    {
        "content": "<p><code>rw</code> sometimes doesn't work under binders. You could try <code>simp_rw</code> or <code>simp only</code> instead.</p>",
        "id": 536257783,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1756220625
    },
    {
        "content": "<p>thank you both <span class=\"user-mention\" data-user-id=\"890057\">@ZhiKai Pong</span> and <span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> and also <span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span> </p>\n<p>this ended up working. now on the way to prove that tanh has temperate growth and therefore is a schwartz operator!</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">iteratedDeriv_tanh_is_polynomial_of_tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">iteratedDeriv</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iteratedDeriv_zero</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">X</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">P</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h'</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iteratedDeriv_succ</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h''</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">iteratedDeriv</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h'</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h_comp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚àò</span><span class=\"w\"> </span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">comp_apply</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h''</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h_comp</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">derivative</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">X</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv_comp</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">deriv</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">deriv_tanh</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">hh</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h'</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sinh</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">cosh</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">        </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Pi</span><span class=\"bp\">.</span><span class=\"n\">div_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h'</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">DifferentiableAt</span><span class=\"bp\">.</span><span class=\"n\">div</span>\n<span class=\"w\">      </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">differentiable_sinh</span>\n<span class=\"w\">      </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">differentiable_cosh</span>\n<span class=\"w\">      </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">ne_of_gt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">cosh_pos</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">hh‚ÇÇ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">differentiableAt</span>\n</code></pre></div>",
        "id": 536291147,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756232585
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"653351\">Joseph Tooby-Smith</span> <a href=\"#narrow/channel/479953-PhysLean/topic/QM.20reflectionless.20potential/near/536239916\">said</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span>\n\n<span class=\"sd\">/-- The nth derivative of Tanh(x) is a polynomial of Tanh(x) -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">iteratedDeriv_tanh_is_polynomial_of_tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">iteratedDeriv</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iteratedDeriv_zero</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">X</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">P</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h'</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iteratedDeriv_succ</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>I will add that it is useful to use <code>induction'</code> rather than induction. It does essentially the same thing but is a bit more user friendly. You can name the variable in the induction line by saying for example <code>induction' n with n ih</code> in this example. It also separates the goals more nicely so you can rewrite this as</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"n\">induction'</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n<span class=\"w\">  </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iteratedDeriv_zero</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">X</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">P</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h'</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iteratedDeriv_succ</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>which I find a little bit nicer to read. (I haven't checked this code but I think it should be right)</p>",
        "id": 536306979,
        "sender_full_name": "Daniel Morrison",
        "timestamp": 1756239815
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"653351\">Joseph Tooby-Smith</span> <a href=\"#narrow/channel/479953-PhysLean/topic/QM.20reflectionless.20potential/near/536240620\">ha scritto</a>:</p>\n<blockquote>\n<p>More generally you can get rid of the <code>‚úù</code>'s with the <code>expose_names</code> tactic.</p>\n</blockquote>\n<p>While a great heuristic, eventually it would be <del>preferable</del> safer to get rid of <code>expose_names</code> as well</p>",
        "id": 536310383,
        "sender_full_name": "Matteo Cipollina",
        "timestamp": 1756241401
    },
    {
        "content": "<p>thanks for the tips team :) will clean the code up tomorrow morning with the alternative induction syntax</p>",
        "id": 536310769,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756241600
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"779253\">Matteo Cipollina</span> <a href=\"#narrow/channel/479953-PhysLean/topic/QM.20reflectionless.20potential/near/536310383\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"653351\">Joseph Tooby-Smith</span> <a href=\"#narrow/channel/479953-PhysLean/topic/QM.20reflectionless.20potential/near/536240620\">ha scritto</a>:</p>\n<blockquote>\n<p>More generally you can get rid of the <code>‚úù</code>'s with the <code>expose_names</code> tactic.</p>\n</blockquote>\n<p>While a great heuristic, eventually it would be <del>preferable</del> safer to get rid of <code>expose_names</code> as well</p>\n</blockquote>\n<p>It is better to use e.g. <code>rename</code>?</p>",
        "id": 536347027,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756270666
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"653351\">Joseph Tooby-Smith</span> <a href=\"#narrow/channel/479953-PhysLean/topic/QM.20reflectionless.20potential/near/536347027\">ha scritto</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"779253\">Matteo Cipollina</span> <a href=\"#narrow/channel/479953-PhysLean/topic/QM.20reflectionless.20potential/near/536310383\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"653351\">Joseph Tooby-Smith</span> <a href=\"#narrow/channel/479953-PhysLean/topic/QM.20reflectionless.20potential/near/536240620\">ha scritto</a>:</p>\n<blockquote>\n<p>More generally you can get rid of the <code>‚úù</code>'s with the <code>expose_names</code> tactic.</p>\n</blockquote>\n<p>While a great heuristic, eventually it would be <del>preferable</del> safer to get rid of <code>expose_names</code> as well</p>\n</blockquote>\n<p>It is better to use e.g. <code>rename</code>?</p>\n</blockquote>\n<p>Yes, or combination of rw-exact often works for me</p>",
        "id": 536354314,
        "sender_full_name": "Matteo Cipollina",
        "timestamp": 1756276115
    },
    {
        "content": "<p>hey <span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span>  - im falling over a bit on how to formalise 'this function has temperate growth'</p>",
        "id": 536573249,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756375641
    },
    {
        "content": "<p>not sure which exact property to use - brain is not braining</p>",
        "id": 536573835,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756375891
    },
    {
        "content": "<p>if you have an example or hint i can take it from there</p>",
        "id": 536573903,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756375921
    },
    {
        "content": "<p>I think the next step would be to show that for any polynomial <code>P</code>, <code>Polynomial.eval (tanh x) P</code> is bounded. I'm not actually sure the best way of doing this though.</p>",
        "id": 536573976,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756375955
    },
    {
        "content": "<p>cool, i can do that first</p>",
        "id": 536574009,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756375971
    },
    {
        "content": "<p>presumably there is some property in mathlib that represents 'bounded for all x in \\R'</p>",
        "id": 536574094,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756376013
    },
    {
        "content": "<p>ah actually i reckon can just do this </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">polynomials_tanh_bounded</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 536575428,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756376619
    },
    {
        "content": "<p>I think if there is it would be then the temperate growth proposition would us it (and I don't think it does). But I think the thing you want is:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 536575432,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756376621
    },
    {
        "content": "<p>omg hahah</p>",
        "id": 536575469,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756376637
    },
    {
        "content": "<p>we literally wrote that at the same time</p>",
        "id": 536575487,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756376644
    },
    {
        "content": "<p>haha yep, either of these would work, actually I think yours is better because you have abs :).</p>",
        "id": 536575523,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756376660
    },
    {
        "content": "<p>Btw when putting code snippets into Zulip it helps to put the necessary preamble e.g.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span>\n\n<span class=\"bp\">...</span>\n</code></pre></div>\n<p>That way people can open the code snippet in <a href=\"https://live.lean-lang.org\">https://live.lean-lang.org</a> by pressing the pop-up in the top right corner of the snippet, and everything will compile nicely :).</p>",
        "id": 536575756,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756376754
    },
    {
        "content": "<p>ah - didn't realise you could do that - awesome</p>",
        "id": 536575846,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756376790
    },
    {
        "content": "<p>this all works - i proved that the iteratived derivative of tanh is bounded </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">PhysLean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">Linters</span><span class=\"bp\">.</span><span class=\"n\">Sorry</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">SpecialFunctions</span><span class=\"bp\">.</span><span class=\"n\">Trigonometric</span><span class=\"bp\">.</span><span class=\"n\">Deriv</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">Trigonometric</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Calculus</span><span class=\"bp\">.</span><span class=\"n\">Deriv</span><span class=\"bp\">.</span><span class=\"n\">Polynomial</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Polynomial</span>\n<span class=\"c\">/-</span><span class=\"cm\">!</span>\n<span class=\"cm\"># Properties of Tanh</span>\n<span class=\"cm\">We want to prove that the reflectionless potential is a Schwartz map.</span>\n<span class=\"cm\">This means proving that pointwise multiplication of a Schwartz map with tanh is a Schwartz map.</span>\n<span class=\"cm\">This means we need to prove that all derivatives of tanh are bounded and continuous, so that</span>\n<span class=\"cm\">the nth derivative of a function multiplied by tanh decays faster than any polynomial.</span>\n\n<span class=\"cm\">## TODO</span>\n<span class=\"cm\">- Add these to mathlib eventually</span>\n<span class=\"cm\">- Fill in the proofs for the properties of tanh</span>\n<span class=\"cm\">-/</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">NNReal</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Field</span>\n\n<span class=\"sd\">/-- tanh(x) is less than 1 for all x -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">tanh_lt_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">div_lt_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cosh_pos</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">sinh_lt_cosh</span><span class=\"w\"> </span><span class=\"n\">x</span>\n\n<span class=\"sd\">/-- tanh(x) is greater than -1 for all x -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">minus_one_lt_tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">lt_div_iff‚ÇÄ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cosh_pos</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">sub_pos</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">neg_one_mul</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">exp_pos</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">]</span>\n\n<span class=\"sd\">/-- The absolute value of tanh is bounded by 1 -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">abs_tanh_lt_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">abs_lt</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">minus_one_lt_tanh</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">tanh_lt_one</span><span class=\"w\"> </span><span class=\"n\">x</span>\n\n<span class=\"sd\">/-- The derivative of tanh(x) is 1 - tanh(x)^2 -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">deriv_tanh</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sinh</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">cosh</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv_div</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">deriv_sinh</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">deriv_cosh</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">field_simp</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">sq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_sub_right_distrib</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">field_simp</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">differentiable_sinh</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">differentiable_cosh</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">ne_of_gt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">cosh_pos</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h'</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sinh</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">cosh</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Pi</span><span class=\"bp\">.</span><span class=\"n\">div_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">nth_rewrite</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h'</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h</span>\n\n<span class=\"sd\">/-- Tanh(x) is n times continuously differentiable for all n -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">contDiff_tanh</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hdiv</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">sinh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">cosh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"bp\">.</span><span class=\"n\">div</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">contDiff_sinh</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">contDiff_cosh</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">ne_of_gt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">cosh_pos</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">conv</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">enter</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">3</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hdiv</span>\n\n<span class=\"sd\">/-- The nth derivative of Tanh(x) is a polynomial of Tanh(x) -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">iteratedDeriv_tanh_is_polynomial_of_tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">iteratedDeriv</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iteratedDeriv_zero</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">X</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">P</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h'</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iteratedDeriv_succ</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h''</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">iteratedDeriv</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h'</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h_comp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚àò</span><span class=\"w\"> </span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">comp_apply</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h''</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h_comp</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">derivative</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">X</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv_comp</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">deriv</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">deriv_tanh</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">hh</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h'</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">sinh</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">cosh</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">        </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Pi</span><span class=\"bp\">.</span><span class=\"n\">div_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">tanh_eq_sinh_div_cosh</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h'</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">DifferentiableAt</span><span class=\"bp\">.</span><span class=\"n\">div</span>\n<span class=\"w\">      </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">differentiable_sinh</span>\n<span class=\"w\">      </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">differentiable_cosh</span>\n<span class=\"w\">      </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">ne_of_gt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">cosh_pos</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">case</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">hh‚ÇÇ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">differentiableAt</span>\n<span class=\"c1\">-- For a polynomial P, show it's bounded on any bounded interval</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">polynomial_bounded_on_interval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">):</span>\n<span class=\"w\">  </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Icc</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- Polynomials are continuous</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hcont</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Continuous</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">continuous</span><span class=\"w\">  </span><span class=\"c1\">-- Closed bounded intervals are compact</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hcompact</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsCompact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Icc</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">isCompact_Icc</span>\n<span class=\"w\">  </span><span class=\"c1\">-- Continuous functions on compact sets are bounded</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">M</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hM</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hcompact</span><span class=\"bp\">.</span><span class=\"n\">exists_bound_of_continuousOn</span><span class=\"w\"> </span><span class=\"n\">hcont</span><span class=\"bp\">.</span><span class=\"n\">continuousOn</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hM</span>\n<span class=\"c1\">-- For a polynomial P, show that P (tanh x) is bounded on the real line</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">polynomial_tanh_bounded</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h_range</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Icc</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">    </span><span class=\"n\">constructor</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">le_of_lt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">minus_one_lt_tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">le_of_lt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">tanh_lt_one</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"c1\">-- Apply polynomial boundedness on [-1, 1]</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">M</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hM</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">polynomial_bounded_on_interval</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">M</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hM</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h_range</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"c1\">-- The nth derivative of tanh is bounded on the real line</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">iteratedDeriv_tanh_bounded</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">iteratedDeriv</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">P</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hP</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">iteratedDeriv_tanh_is_polynomial_of_tanh</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">C</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hC</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">polynomial_tanh_bounded</span><span class=\"w\"> </span><span class=\"n\">P</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">C</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hP</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hC</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>",
        "id": 536588405,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756381775
    },
    {
        "content": "<p>Nice! This looks great! Proving that tanh has temperate growth should now follow fairly trivially right?</p>",
        "id": 536589205,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756382074
    },
    {
        "content": "<p>dumb question - where is the 'temperate growth' property?</p>",
        "id": 536589293,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756382099
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 536589501,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756382178
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span>  Function.HasTemperateGrowth</p>",
        "id": 536589595,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756382216
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Distribution/SchwartzSpace.html#Function.HasTemperateGrowth\">Function.HasTemperateGrowth</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Distribution/SchwartzSpace.html#Function.HasTemperateGrowth.const\">Function.HasTemperateGrowth.const</a>, and <a href=\"https://loogle.lean-lang.org/?q=Function.HasTemperateGrowth\">9 more</a></p>",
        "id": 536589596,
        "sender_full_name": "loogle",
        "timestamp": 1756382216
    },
    {
        "content": "<p>So \"Mathlib.Analysis.Distribution.SchwartzSpace\"</p>",
        "id": 536589632,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756382233
    },
    {
        "content": "<p>btw is anyone else getting 404s accessing <a href=\"https://leanprover-community.github.io/\">https://leanprover-community.github.io/</a>?</p>",
        "id": 536589645,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756382241
    },
    {
        "content": "<p>got it - will prove that and then commit this soup</p>",
        "id": 536589737,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756382276
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"941733\">Afiq Hatta</span> <a href=\"#narrow/channel/479953-PhysLean/topic/QM.20reflectionless.20potential/near/536589645\">said</a>:</p>\n<blockquote>\n<p>btw is anyone else getting 404s accessing <a href=\"https://leanprover-community.github.io/\">https://leanprover-community.github.io/</a>?</p>\n</blockquote>\n<p>Works for me.</p>",
        "id": 536589795,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756382292
    },
    {
        "content": "<p>really dumb question - i'm struggling with going from 'for all n' to 'infinitely differentiable' here - why is there a token error on the \\infty part of this lemma? </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">PhysLean</span><span class=\"bp\">.</span><span class=\"n\">Meta</span><span class=\"bp\">.</span><span class=\"n\">Linters</span><span class=\"bp\">.</span><span class=\"n\">Sorry</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">SpecialFunctions</span><span class=\"bp\">.</span><span class=\"n\">Trigonometric</span><span class=\"bp\">.</span><span class=\"n\">Deriv</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">Trigonometric</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Calculus</span><span class=\"bp\">.</span><span class=\"n\">Deriv</span><span class=\"bp\">.</span><span class=\"n\">Polynomial</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Polynomial</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Distribution</span><span class=\"bp\">.</span><span class=\"n\">SchwartzSpace</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">NNReal</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Field</span>\n\n<span class=\"c1\">-- Alternative approach for the smoothness part:</span>\n<span class=\"sd\">/-- tanh is infinitely differentiable -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">contDiff_top_tanh</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚àû</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- Show that tanh is ContDiff for all finite orders, which implies ContDiff ‚ä§</span>\n<span class=\"w\">  </span><span class=\"c1\">-- apply ContDiff.of_le</span>\n\n<span class=\"w\">  </span><span class=\"c1\">-- ¬∑ exact contDiff_tanh</span>\n<span class=\"w\">  </span><span class=\"c1\">-- ¬∑ exact le_top</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 536602836,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756386544
    },
    {
        "content": "<p>A bit confused on the type of infty here it expects. the code says n can also be N\\infty but that doesn't work either</p>",
        "id": 536603182,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756386641
    },
    {
        "content": "<p>The goal i'm aiming for here is <br>\nContDiff ‚Ñù (‚Üë‚ä§) tanh</p>",
        "id": 536604357,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756387007
    },
    {
        "content": "<p>from a <a href=\"#narrow/channel/113489-new-members/topic/How.20to.20do.20differentiation.20on.20concrete.20multivariable.20function/near/511199126\">previous conversation</a>:</p>\n<p>Aaron Liu: Read carefully: <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ContDiff#doc\">docs#ContDiff</a> takes a <code>WithTop ENat</code>, which has two tops. The higher top (\"omega\") is for analytic functions, and the lower top (\"infinity\") is for smooth (infinitely differentiable) functions.</p>\n<p>Aaron Liu: If you <code>open scoped ContDiff</code> it'll print these differently.</p>",
        "id": 536604847,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1756387169
    },
    {
        "content": "<p>works! thankas <span class=\"user-mention\" data-user-id=\"890057\">@ZhiKai Pong</span></p>",
        "id": 536605200,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756387267
    },
    {
        "content": "<p>hey <span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span> I was wondering if there was a theorem on compositions of two temperate growth functions having temperate growth</p>",
        "id": 537445844,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756895367
    },
    {
        "content": "<p>i couldn't find it - and needed it to easily show that tanh ( k x ) is temperate for all k real</p>",
        "id": 537445933,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756895398
    },
    {
        "content": "<p>if not, i can sketch up a proof?</p>",
        "id": 537446740,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756895682
    },
    {
        "content": "<p>I don't think so, but it might just be easier to show that <code>tanh ( k x )</code> has temperate growth given <code>tanh x</code> has temperate growth.</p>",
        "id": 537447192,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756895859
    },
    {
        "content": "<p>yeah</p>",
        "id": 537447343,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756895936
    },
    {
        "content": "<p>i actually don't know if the composition of two temperate growth functions has temperate growth anyway.</p>",
        "id": 537447409,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1756895967
    },
    {
        "content": "<p>I think it probably is true - because the iterated derivative of the composition becomes the sum of iterated derivatives of each part via the chain rule, which should be bounded. Proving it formally is a different matter though.</p>",
        "id": 537447766,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756896125
    },
    {
        "content": "<p>It may also be possible/quickest to modify your proofs for <code>tanh x</code> and turn them into proofs of <code>tanh (k * x)</code></p>",
        "id": 537448717,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1756896519
    },
    {
        "content": "<p>Hey guys, I have a dumb question. To show that tanh is a Schwartz map: after I apply tanh, there has to be a trivial embedding of Real.tanh into the complex numbers. I then need to show that this composition has temperate growth. Is there any easier way of doing this besides proving that the composition of temperate growth maps is also temperate, or redoing the whole proof of temperateGrowth of tanh in \\C ? </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- Scaled tanh embedded into the complex numbers has temperate growth</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">scaled_tanh_complex_hasTemperateGrowth</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œ∫</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">HasTemperateGrowth</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œ∫</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"sd\">/-- Define tanh(Œ∫ X) multiplication pointwise as a Schwartz map -/</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">tanhOperatorSchwartz</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ReflectionlessPotential</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">ùì¢</span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"n\">L</span><span class=\"o\">[</span><span class=\"n\">‚ÑÇ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- We need to handle the Real ‚Üí Complex coercion</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">scaled_tanh_real</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Q</span><span class=\"bp\">.</span><span class=\"n\">Œ∫</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">scaled_tanh_complex</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">tanh</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Q</span><span class=\"bp\">.</span><span class=\"n\">Œ∫</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">HasTemperateGrowth</span><span class=\"w\"> </span><span class=\"n\">scaled_tanh_complex</span>\n<span class=\"w\">    </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">scaled_tanh_complex_hasTemperateGrowth</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"bp\">.</span><span class=\"n\">Œ∫</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">bilinLeftCLM</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ContinuousLinearMap</span><span class=\"bp\">.</span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">h2</span>\n</code></pre></div>",
        "id": 538249753,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757343726
    },
    {
        "content": "<p>The way you phrase this makes me think you should probably have a separate lemma that proves any trivial embedding of real Schwartz maps into the complex also has temperate growth and just apply that, but I'm not sure how feasible as I'm not that familiar with the Schwartz map API at the moment</p>",
        "id": 538251402,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1757344117
    },
    {
        "content": "<p>yeah that's what i was thinking as well. I am still new to lean so was wondering if there was any quick keyword that does this for me, but I guess not</p>",
        "id": 538251614,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757344172
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span> i wrote a pull request for definitions for the creation and operation operators, leaving a sorry statement for the proof of the embedding thing that I need</p>",
        "id": 538303233,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757360648
    },
    {
        "content": "<p>I think this is what you want: </p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>Code</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Function.HasTemperateGrowth</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Function.HasTemperateGrowth</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">And.intro</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Complex.ofRealCLM.contDiff.fun_comp</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">_</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">obtain</span><span class=\"w\"> </span><span class=\"o\">‚ü®</span><span class=\"n\">k</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"o\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"o\">‚ü®</span><span class=\"n\">k</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">le_of_eq</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hn</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)‚ü©</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">RCLike.ofRealLI</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">norm_iteratedFDeriv_comp_left</span>\n<span class=\"w\">     </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"n\">contDiffAt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">WithTop.le_coe_iff.mpr</span><span class=\"w\"> </span><span class=\"o\">‚ü®</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"o\">‚ü©)</span>\n</code></pre></div>\n</div></div>\n<p>Found it by loogling <code>iteratedFDeriv, \"comp\"</code> and spotting  <code>LinearIsometry.norm_iteratedFDeriv_comp_left</code>.</p>\n<p>(Edits: Golf)</p>",
        "id": 538376105,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757405522
    },
    {
        "content": "<p>Thanks! I'll take some go through this example because I actually don't know a lot of these keywords. Btw - I see that you're a fan of using 'refine' - what kinds of problems lend well to using that keyword?</p>",
        "id": 538381081,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757407056
    },
    {
        "content": "<p>like why use refine And.intro, vs something like constructor?</p>",
        "id": 538381460,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757407189
    },
    {
        "content": "<p><code>refine</code> is basically <code>exact</code> but you can have holes in it which are the <code>?_</code>. Your goal then becomes what is needed to fill in the <code>?_</code>.  In some interactive theorem provers like Agda this sort of manipulation is basically all that is used. I like to view <code>refine</code>, <code>exact</code> and <code>apply</code> as sitting in the same collection of tactics. </p>\n<p>I personally tend not to use <code>constructor</code> that often because for some reason I only recently learnt about it - and I have a habit of using <code>refine And.intro ?_ ?_</code> or <code>apply And.intro</code> etc.</p>",
        "id": 538382705,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757407596
    },
    {
        "content": "<p>got it - makes sense</p>",
        "id": 538382869,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757407647
    },
    {
        "content": "<p>Where do we think is an appropriate place to put the embedding theorem that you wrote?</p>",
        "id": 538385806,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757408487
    },
    {
        "content": "<p>I would probably just put it as a <code>private lemma</code> just before you need it for now.</p>",
        "id": 538385993,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757408543
    },
    {
        "content": "<p>(FYI - I just cleaned it up some more)</p>",
        "id": 538386194,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757408598
    },
    {
        "content": "<p>I should also say - for reference that my proof above is after golfing to make it shorter and nice - I started with something a lot longer and messier.</p>",
        "id": 538386963,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757408831
    },
    {
        "content": "<p>got it. that's good to know, because when i read some solutions i'm like 'how...!!'.  the way I've been trying to get at solutions is by doing </p>\n<p>constructor <br>\napply <br>\napply <br>\napply</p>\n<p>till the cows come home, just trying to match goals with theorems in mathlib and then only golfing after.</p>",
        "id": 538387357,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757408947
    },
    {
        "content": "<p>Yeah I think this is common and this is what I do too. Once you have a working proof it is relatively easy to make it shorter - that said there are lots of proofs within PhysLean that have never been golfed :).</p>",
        "id": 538387820,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757409090
    },
    {
        "content": "<p>yeah. ok my mission for today is to add this and also maybe just write some words on my blog about the general strategy of just apply apply apply then golfing later.</p>",
        "id": 538389471,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757409622
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span>  here's a really dumb question - I often get stuck on rewrites not matching the target but it does take a lot of time to figure out what's going on. Is there anything that I can do to make the trouble shooting a bit easier? For example, I'm trying to do the proof on my own and I don't know why this final rewrite is failing? </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">complex_embedding_of_temperate_growth</span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">HasTemperateGrowth</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">HasTemperateGrowth</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"bp\">.</span><span class=\"n\">fun_comp</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ContinuousLinearMap</span><span class=\"bp\">.</span><span class=\"n\">contDiff</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">ofRealCLM</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">h1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h1</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">h1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">ofRealCLM</span><span class=\"w\"> </span><span class=\"bp\">‚àò</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">LinearIsometry</span><span class=\"bp\">.</span><span class=\"n\">norm_iteratedFDeriv_comp_left</span>\n</code></pre></div>",
        "id": 538396317,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757411674
    },
    {
        "content": "<p>i'm just as curious about the trouble shooting here (ie how to check if I got anything wrong with types etc, and obvious ways to spot errors) as well as what went wrong in this specific example</p>",
        "id": 538397703,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757412103
    },
    {
        "content": "<p>You mean the finial <code>apply</code>? The last <code>rw</code> looks like it's working to me.</p>",
        "id": 538402112,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757413577
    },
    {
        "content": "<p>sorry - the final apply!</p>",
        "id": 538402474,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757413688
    },
    {
        "content": "<p>i can't seem to get it to work</p>",
        "id": 538402539,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757413709
    },
    {
        "content": "<p>Two reasons: </p>\n<ol>\n<li>You need <code>RCLike.ofRealLI</code> not <code>Complex.ofRealCLM</code> in <code>h</code>. The former is a linear isometry whilst the latter is a continuous linear map. As functions they are both equal, but have different types.</li>\n<li>To use <code>apply</code> your goal has to be the same as the theorem given, in this case it is not. However, once you have made the change <code>1</code> here, then <code>rw [LinearIsometry.norm_iteratedFDeriv_comp_left]</code> should work.</li>\n</ol>",
        "id": 538403091,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757413852
    },
    {
        "content": "<p>ah - so does the break come from the actual type being wrong? because usually, what happens is that i apply the theorem, and then a subgoal is created in which i prove that something satisfies that. but i guess that only applies to hypotheses</p>",
        "id": 538404382,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757414192
    },
    {
        "content": "<p>Here is a short description of what apply does: </p>\n<p>Let us say you have a proof  <code>h : A ‚Üí B ‚Üí C</code> and your goal is equal to <code>C</code>, then <code>apply h</code> will great subgoals for <code>A</code> and <code>B</code>. But if your goal is not currently <code>C</code> then you can't use <code>apply h</code>. </p>\n<p>I don't really use e.g. <code>apply _ at _</code> so don't know how that works exactly.</p>",
        "id": 538404967,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757414406
    },
    {
        "content": "<p>got it - that's clear - thanks Joe</p>",
        "id": 538405124,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757414467
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span> may I ask how do you inspect this code? since this depends on an open PR, is there a way to directly play around with it or do you just copy the relevant lemmas to your local PhysLean?</p>",
        "id": 538410176,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1757416274
    },
    {
        "content": "<p>For this specific example the lemma I ended up proving didn't actually need anything from the PR, so I just used <a href=\"https://live.lean-lang.org\">https://live.lean-lang.org</a>. </p>\n<p>But more generally, if there is something I want to look at from a given PR or play around with in more detail, I will just check out the corresponding PR. Which on github desktop is done via: </p>\n<p><a href=\"/user_uploads/3121/SBw8iaPvTsNMyBZ7ls1GGJq2/Screenshot-2025-09-09-at-13.38.18.png\">Screenshot 2025-09-09 at 13.38.18.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/SBw8iaPvTsNMyBZ7ls1GGJq2/Screenshot-2025-09-09-at-13.38.18.png\" title=\"Screenshot 2025-09-09 at 13.38.18.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"2540x1648\" src=\"/user_uploads/thumbnail/3121/SBw8iaPvTsNMyBZ7ls1GGJq2/Screenshot-2025-09-09-at-13.38.18.png/840x560.webp\"></a></div>",
        "id": 538427417,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757421516
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span> </p>\n<p>my own attempt (learning) </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">complex_embedding_of_temperate_growth</span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">HasTemperateGrowth</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">HasTemperateGrowth</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"bp\">.</span><span class=\"n\">fun_comp</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ContinuousLinearMap</span><span class=\"bp\">.</span><span class=\"n\">contDiff</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">ofRealCLM</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">h1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">h1</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">h1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">k</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">k</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">C</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">ofReal</span><span class=\"w\"> </span><span class=\"bp\">‚àò</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">RCLike</span><span class=\"bp\">.</span><span class=\"n\">ofRealLI</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚àò</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h''</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">ofReal</span><span class=\"w\"> </span><span class=\"bp\">‚àò</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h''</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearIsometry</span><span class=\"bp\">.</span><span class=\"n\">norm_iteratedFDeriv_comp_left</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">RCLike</span><span class=\"bp\">.</span><span class=\"n\">ofRealLI</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"bp\">.</span><span class=\"n\">contDiffAt</span><span class=\"o\">)]</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">j</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ENat</span><span class=\"bp\">.</span><span class=\"n\">natCast_le_of_coe_top_le_withTop</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">le_refl</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 538461555,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757430623
    },
    {
        "content": "<p>Awesome! I would now play the game to see how much you can golf this, maybe using tactics you are less familiar with.</p>",
        "id": 538462036,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757430750
    },
    {
        "content": "<p>yeah. i've starting writing some notes on useful go to tactics for beginners which i'll publish tonight</p>",
        "id": 538462313,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757430841
    },
    {
        "content": "<p>Nice! I would be interested to see at some point what are the most common tactics used in e.g. PhysLean compared to Mathlib etc. </p>\n<p>I would advocate for <code>conv_lhs</code>, <code>conv_rhs</code> to be part of that list - once I discovered them they were a life-changer.</p>",
        "id": 538462680,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757430946
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"941733\">@Afiq Hatta</span> </p>\n<p>I did the same earlier but waited for you to finish, just some minor comments:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">complex_embedding_of_temperate_growth</span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">HasTemperateGrowth</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">HasTemperateGrowth</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- once you structure the code you'll see that the reason you had two of the same obtains was because they were in different branches so you can just put it before constructor</span>\n<span class=\"w\">  </span><span class=\"c1\">-- in general always use dot notation to structure the proof whenever you use constructor and create multiple goals</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">h1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"bp\">.</span><span class=\"n\">fun_comp</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ContinuousLinearMap</span><span class=\"bp\">.</span><span class=\"n\">contDiff</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">ofRealCLM</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h1</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">k</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">C</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">    </span><span class=\"c1\">-- actually this is also defeq so you can just combine into one</span>\n<span class=\"w\">    </span><span class=\"c1\">-- have h : (fun x =&gt; (Complex.ofReal ‚àò f) x) = (RCLike.ofRealLI (K := ‚ÑÇ) ‚àò f) := rfl</span>\n<span class=\"w\">    </span><span class=\"c\">/-</span>\n<span class=\"cm\">    have h'' : (fun x =&gt; (f x : ‚ÑÇ)) = (RCLike.ofRealLI (K := ‚ÑÇ) ‚àò f) := rfl</span>\n<span class=\"cm\">    rw [h'']</span>\n<span class=\"cm\">    -/</span>\n<span class=\"w\">    </span><span class=\"c1\">-- also for defeq expressions you can simply use `change`:</span>\n<span class=\"w\">    </span><span class=\"n\">change</span><span class=\"w\"> </span><span class=\"bp\">‚Äñ</span><span class=\"n\">iteratedFDeriv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">RCLike</span><span class=\"bp\">.</span><span class=\"n\">ofRealLI</span><span class=\"w\"> </span><span class=\"bp\">‚àò</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">‚Äñ</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">‚Äñ</span><span class=\"n\">x</span><span class=\"bp\">‚Äñ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">k</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearIsometry</span><span class=\"bp\">.</span><span class=\"n\">norm_iteratedFDeriv_comp_left</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">RCLike</span><span class=\"bp\">.</span><span class=\"n\">ofRealLI</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h1</span><span class=\"bp\">.</span><span class=\"n\">contDiffAt</span><span class=\"o\">)]</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">    </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ENat</span><span class=\"bp\">.</span><span class=\"n\">natCast_le_of_coe_top_le_withTop</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">le_refl</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>also please include <code>import Mathlib</code> if it's a standalone lemma so others can just view it in the web playground :)</p>",
        "id": 538466809,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1757432069
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"890057\">@ZhiKai Pong</span>  - this kind of breakdown is really helpful.</p>",
        "id": 538469091,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757432679
    },
    {
        "content": "<p>I was wondering about how to use change expressions - thank you for the flag. Need to learn more!!!</p>",
        "id": 538469507,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757432783
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span> wrote a reply to one of the things you raised on my pull request btw</p>",
        "id": 538479682,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757435694
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span> updated the pull request with the new proofs and also the requested refactors!</p>",
        "id": 538592400,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757492388
    },
    {
        "content": "<p>Just approved it - I <del>merged with master</del> merged master into this PR to clean it up, I think you will have to wait for it to finish the workflows before you can merge it.</p>",
        "id": 538592927,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757492550
    },
    {
        "content": "<p>sweet</p>",
        "id": 538592979,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757492568
    },
    {
        "content": "<p>I think the next logical thing to prove would be that the Hamiltonian of the reflectionless potential satisfies <br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi><mo>=</mo><msup><mi>a</mi><mo>‚Ä†</mo></msup><mi>a</mi><mo>‚àí</mo><mfrac><mrow><msup><mi mathvariant=\"normal\">‚Ñè</mi><mn>2</mn></msup><msup><mi>Œ∫</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><mi mathvariant=\"double-struck\">I</mi></mrow><annotation encoding=\"application/x-tex\"> H = a ^ \\dagger a  - \\frac { \\hbar ^ 2 \\kappa ^ 2 } {  2m } \\mathbb I </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9324em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">‚Ä†</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">‚àí</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3629em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0179em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">m</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">‚Ñè</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">Œ∫</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord mathbb\">I</span></span></span></span></p>\n<p>For this, I reckon we also need </p>\n<ul>\n<li>the commutuation relations </li>\n<li>to formalise the Hamiltonian, and also prove that it is also a Schwartz map? In terms of formalising the Hamiltonian - is there a special template that I can follow elsewhere in the code? </li>\n</ul>\n<p>Also - what is the convention for what a 'ground state' here? in the paper,  it is just <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mpadded><mi mathvariant=\"normal\">‚à£</mi><mn>0</mn><mo stretchy=\"false\">‚ü©</mo></mpadded></mrow><annotation encoding=\"application/x-tex\"> a \\ket 0 </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mord\">‚à£</span><span class=\"mord\"><span class=\"mord\">0</span></span><span class=\"mclose\">‚ü©</span></span></span></span></span> = 0. is this a convention that we want to keep in physlean?</p>",
        "id": 539393406,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757840735
    },
    {
        "content": "<p>I think the fact that the Hamiltonian is Schwartz should follow from the proof that the momentum operator is Schwartz and the tanh operator is.</p>",
        "id": 539426507,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757871702
    },
    {
        "content": "<p>sweet. and in terms of the algebraic proof of the eigenvalues - i guess i can follow this quantum harmonic oscillator example as a rough guide</p>",
        "id": 539433121,
        "sender_full_name": "Afiq Hatta",
        "timestamp": 1757877426
    }
]