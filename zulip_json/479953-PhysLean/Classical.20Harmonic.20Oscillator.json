[
    {
        "content": "<p>I have been looking at trying to use the new variational calculus API on the harmonic oscillator (like we discussed <a href=\"#narrow/channel/479953-PhysLean/topic/Mini.20projects/near/530274951\">here</a> - I think it makes sense to give this potential its own topic). I have been trying to formalize the <code>EquationOfMotion</code> definition like the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">EquationOfMotion</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x‚Çú</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">eulerLagrangeOp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">lagrangian</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x‚Çú</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n</code></pre></div>\n<p>But this does not quite work due to</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Application</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">In</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">application</span>\n<span class=\"w\">  </span><span class=\"n\">eulerLagrangeOp</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">lagrangian</span>\n<span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">argument</span>\n<span class=\"w\">  </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">lagrangian</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n</code></pre></div>\n<p>Which makes sense. I <em>have</em> been able to write it like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">lagrangian'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Time</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q_dot</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"bp\">‚ü™</span><span class=\"n\">q_dot</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">q_dot</span><span class=\"bp\">‚ü´_</span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"bp\">‚ü™</span><span class=\"n\">q</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"bp\">‚ü´_</span><span class=\"n\">‚Ñù</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">EquationOfMotion'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x‚Çú</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">eulerLagrangeOp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">lagrangian'</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x‚Çú</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n</code></pre></div>\n<p>Which I expect we can turn the former into somehow, I'm just not sure how. Does anyone have any ideas?</p>",
        "id": 535531017,
        "sender_full_name": "Lode Vermeulen",
        "timestamp": 1755790757
    },
    {
        "content": "<p>One approach might be to consider <code>lagrangian'</code> as the fundamental object, and derive <code>lagrangian</code> from that. I think it is true that there are various mathematical formulations of classical mechanics in which this is the correct direction (e.g. the jet bundle approach), but I can't speak for every formulation.</p>",
        "id": 535533673,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1755791600
    },
    {
        "content": "<p>(Huh, so I think it would be good to move the relevant messages from <a href=\"#narrow/channel/479953-PhysLean/topic/Mini.20projects/near/530274951\">that thread</a> to this one - but I don't get the option for these specific messages, I do for others :().</p>",
        "id": 535535254,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1755792116
    },
    {
        "content": "<p>I made an implementation of this (that is setting up and solving the variational calculus problem) here: <a href=\"https://github.com/HEPLean/PhysLean/pull/737\">PhysLean#737</a> - getting rid of some sorryful results but creating others.</p>",
        "id": 538877284,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757601526
    },
    {
        "content": "<p>Nice! That actually doesn't look too bad</p>",
        "id": 538882751,
        "sender_full_name": "Lode Vermeulen",
        "timestamp": 1757602803
    },
    {
        "content": "<p>Ideally I think the amplitude etc. should be done in the way <span class=\"user-mention\" data-user-id=\"890057\">@ZhiKai Pong</span> suggests here: <a class=\"message-link\" href=\"/#narrow/channel/479953-PhysLean/topic/Mini.20projects/near/530232621\">#PhysLean &gt; Mini projects @ üí¨</a>, but didn't get round to doing that - hence the sorryful results.</p>",
        "id": 538887382,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757603880
    },
    {
        "content": "<p>I updated this PR with some Hamilton mechanics. I also massively restructured the file and added a lot more documentation. I created this issue <a href=\"https://github.com/HEPLean/PhysLean/pull/738\">PhysLean#738</a> regarding the docs, where there is also a pdf which shows them as they would appear on the website.</p>",
        "id": 539025706,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1757671038
    },
    {
        "content": "<p>I am working on the proof for trajectory_velocity_eq_zero_iff; I got quite far quite fast (I just have some annoying arithmetic to do), so I expect to be able to file a pull request by probably Monday at the latest.</p>",
        "id": 546509059,
        "sender_full_name": "Jard",
        "timestamp": 1761152691
    },
    {
        "content": "<p>Awesome! This sounds great <span class=\"user-mention\" data-user-id=\"867823\">@Jard</span>  :).</p>",
        "id": 546532581,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1761160179
    },
    {
        "content": "<p>I actually just managed to finish the proof! I'm getting ready to merge it, however I did notice that there was an assumption in the problem statement that not both initial conditions could be 0, and this assumption went unused. It would be an extremely boring harmonic oscillator, but it would be one nonetheless. Can I remove the assumption or should I leave it in?</p>",
        "id": 546593363,
        "sender_full_name": "Jard",
        "timestamp": 1761197928
    },
    {
        "content": "<p>Nice! Do you mean the assumption, <code>(hx : IC.x‚ÇÄ ‚â† 0 ‚à® IC.v‚ÇÄ ‚â† 0)</code>? If you didn't use this, this is great, and yes it can be removed :)! I only included it as I couldn't see a way to prove this without it</p>",
        "id": 546593835,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1761198263
    },
    {
        "content": "<p>Yes, that's the one I mean! I ended up proving it through energy conservation</p>",
        "id": 546593979,
        "sender_full_name": "Jard",
        "timestamp": 1761198297
    },
    {
        "content": "<p>Cool, this makes sense! I think there is then a similar lemma one could prove in a similar way - that is, one could find the speed of the particle as it passes through zero.</p>",
        "id": 546595684,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1761199121
    },
    {
        "content": "<p>I have my thesis deadline soon, but I'll have a look after! It's been so much fun, I definitely plan to continue with lean4 after my thesis.</p>\n<p>If I did it correctly (it's my first time), I just made the pull request</p>",
        "id": 546597837,
        "sender_full_name": "Jard",
        "timestamp": 1761200246
    },
    {
        "content": "<p>Good luck with your thesis! I made a comment there regarding linters, but I am more than happy to take care of this - just let me know :).</p>",
        "id": 546598321,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1761200506
    },
    {
        "content": "<p>Thanks! I got it; am working on the linters now</p>",
        "id": 546600433,
        "sender_full_name": "Jard",
        "timestamp": 1761201603
    }
]