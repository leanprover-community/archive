[
    {
        "content": "<p>For people interested in contributing to HepLean, but don't know where to start or what to do, I am going to use this thread to post mini project ideas. This is in addition to what HepLean currently has in the form of: </p>\n<ul>\n<li>A <a href=\"https://heplean.com/TODOList\">TODO list</a></li>\n<li>A graph of <a href=\"https://heplean.com/InformalGraph.html\">informal lemmas</a></li>\n</ul>\n<p>which can also be used as a source of ideas of how to contribute.</p>\n<p>Also if you have ideas for  mini projects suitable for HepLean but you do not have the time or capacity to do them yourself please post them here.</p>",
        "id": 495212759,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1737529843
    },
    {
        "content": "<p><strong> The two-higgs doublet model potential </strong> </p>\n<p><em>Aim:</em> Prove Theorem 1,  2  &amp; 4 of this paper: <a href=\"https://arxiv.org/pdf/hep-ph/0605184\">https://arxiv.org/pdf/hep-ph/0605184</a>, or variations of. </p>\n<p><em>Physics context:</em> The two-Higgs doublet model is a model of the universe with a proposed extra Higgs boson - giving two Higgs fields in total. Associated with these two Higgs fields is a <a href=\"https://heplean.com/docs/HepLean/BeyondTheStandardModel/TwoHDM/Basic.html\">potential</a> whose minimum and boundness is very important to physics (it is what determines mass in the universe). The theorems in the above paper prove results related to these minima and boundness properties. </p>\n<p><em>Math context:</em> The actual maths involved is simple algebraic manipulation with potentially a small bit of calculus and group theory. </p>\n<p><em>Current progress:</em> Some of the set-up is already in HepLean but not much substantial progress has been made to proving these results.</p>\n<p><em>Note:</em> I don't believe you need to know much/any physics to do this project.</p>",
        "id": 495214178,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1737530488
    },
    {
        "content": "<p><strong>Properties of grand unified theory groups</strong> </p>\n<p><em>Aim:</em> Prove group theoretic properties of the grand unified theories: SU(5), Spin(10) and Pati-Salam. Examples of such properties can be found in <a href=\"https://math.ucr.edu/home/baez/guts.pdf\">https://math.ucr.edu/home/baez/guts.pdf</a>. They also appear as informal results in HepLean. See e.g. <a href=\"https://github.com/HEPLean/HepLean/blob/3d909b357a884bfc2b58eb27fa07b40fad2e626b/HepLean/BeyondTheStandardModel/PatiSalam/Basic.lean#L36\">here</a>.</p>\n<p><em>Physics context:</em> Grand unified theories are popular models beyond the standard model which unify all the fermions into the universe into the representation of a semi-simple or simple Lie group. </p>\n<p><em>Math context:</em> Group theory of several low-dimensional Lie groups (don't actually need Lie group structures) and maps between them. </p>\n<p><em>Note:</em> Like the project above, I don't believe you need to know much/any physics for this.</p>",
        "id": 495289450,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1737554394
    },
    {
        "content": "<p><strong>Properties of Pauli matrices</strong> </p>\n<p><em>Aim:</em> Prove the properties of the Pauli matrices in Eq. 2.23 - 2.30 of <a href=\"https://particle.physics.ucdavis.edu/modernsusy/slides/slideimages/spinorfeynrules.pdf\">this</a> using index notation. An example of a similar calculation already in HepLean is <a href=\"https://github.com/HEPLean/HepLean/blob/029319c8c089672278e7080fbf591c208a58f505/HepLean/Lorentz/ComplexTensor/PauliMatrices/CoContractContr.lean#L508\">this calculation</a>.</p>",
        "id": 498044689,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1738823012
    },
    {
        "content": "<p><strong>A start on optics</strong></p>\n<p><em>Aim:</em> To convert the relevant parts of <a href=\"https://hvg.ece.concordia.ca/projects/optics/\">this</a> into Lean.</p>",
        "id": 504749649,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1741673204
    },
    {
        "content": "<p>Hi! I've been watching this project for a while now and I thought I'd have a try at one of the TODOs (<a href=\"https://physlean.com/TODOList#6YBYP\">semiformal_result (6YBYP): force</a>). To begin with, I defined the force like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">force</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HarmonicOscillator</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">potentialEnergy</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">))</span>\n</code></pre></div>\n<p>This gives me issues when trying to prove </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">force_is_linear</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Time</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">force</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">t</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">force</span><span class=\"w\"> </span><span class=\"n\">potentialEnergy</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv_const_mul_field</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">deriv_pow''</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">ring_nf</span>\n</code></pre></div>\n<p>Namely, the proof state at the end here is <code>-(S.k * x (x t) * deriv x (x t)) = (-S.k • x) t</code>, which does not make sense to me (<code>x (x t)</code> seems like gibberish, other than that the two sides seem equal). It seems to me that a way around this issue is to refactor <code>force</code> and <code>potentialEnergy</code> to not be functions taking <code>t</code>, but I am not sure about this. Is there maybe some way to get around this issue of <code>t</code> being in the way in the proof itself, such that no refactoring is necessary?</p>",
        "id": 522188971,
        "sender_full_name": "Lode Vermeulen",
        "timestamp": 1748974623
    },
    {
        "content": "<p>Hi Lode! Thanks for working on this :). </p>\n<p>I personally can't think of a way of doing this without refactoring the potential energy and force to not depend on <code>t</code>. I think physically this might actually be the strictly correct thing to do in this case.</p>\n<p>In particular I think the potential energy in general should be a function of current position of the particle (and possibly its current velocity - although not in this case), but it shouldn't be a function of the trajectory of the particle, so it probably needs refactoring in any case.</p>",
        "id": 522200987,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1748979033
    },
    {
        "content": "<p>correct me if I'm wrong, but I think it might be a good idea to distinguish between the position <code>x</code> from the position function \"<code>x</code> as a function of <code>t</code>\" (not sure what's the best name, something like <code>pos_fun</code> might be too confusing). then you have a def saying <code>x = pos_fun t</code>.</p>\n<p>(<code>x</code> should technically be of type <code>Space 1</code> but I realized I can't operate directly on it e.g. taking the square, and I have to take the norm first which complicates things so maybe for the 1D case it's fine to just use <code>ℝ</code>?)</p>",
        "id": 522224462,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1748989030
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"890057\">@ZhiKai Pong</span> you mean notationally wise? Maybe <code>xₜ</code>? But I also think sticking with <code>x</code> is ok too - it's what you see sometimes in the literature, albeit it's confusing. </p>\n<p>Actually I think really one should use the inner-product here, since this is what would generalize to higher dimensions, namely: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- The potential energy of the harmonic oscillator is `1/2 k x ^ 2` -/</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">potentialEnergy</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">⟫_</span><span class=\"n\">ℝ</span>\n</code></pre></div>\n<p>This will involve refactoring a lot of the equations in that file to replace <code>ℝ</code> with <code>Space 1</code> though, but I think in the end it will be worth it.</p>\n<p>So in short, <span class=\"user-mention\" data-user-id=\"690587\">@Lode Vermeulen</span> , to do this TODO item I think you can either refactor potential energy to what I wrote above (which would be more work), or for now refactor it to: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- The potential energy of the harmonic oscillator is `1/2 k x ^ 2` -/</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">potentialEnergy</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n</code></pre></div>\n<p>and define <code>force</code> and <code>force_is_linear</code> from there. Either would be a very nice contribution :).</p>",
        "id": 522267659,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1749014834
    },
    {
        "content": "<p>as in I think<code>(x : ℝ)</code> and <code>(xₜ : Time → ℝ)</code>are different things but both should be used in the definitions, where it is possible to write <code>deriv xₜ t</code>for velocity etc., but allowing <code>potentialEnergy</code> to only depend on <code>x</code></p>",
        "id": 522322806,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1749033301
    },
    {
        "content": "<p>Thanks for your responses! I have now tried to refactor some of the definitions to use Space 1 (refactoring <code>potentialEnergy</code> to just <code>ℝ</code> was a success everywhere, but I would like to get the more general <code>Space</code> to work). It seems to mostly go ok, but I am having some issues again in the definition of <code>force</code>. I now have</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">potentialEnergy</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"mi\">1</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">⟫_</span><span class=\"n\">ℝ</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">force</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HarmonicOscillator</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"bp\">∂</span><span class=\"o\">[</span><span class=\"n\">d</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">potentialEnergy</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>\n<p>It intuitively seems right that <code>potentialEnergy</code> has type <code>ℝ</code> and <code>force</code> has type <code>Space 1</code> (should be a vector in the same space as the position). I am not entirely sure how to correctly state the force, as in every attempt there seems to have been an issue caused by the fact that <code>potentialEnergy</code> has type <code>ℝ</code>. I think physically it is fine for it to have that, as the derivative of a scalar function with respect to a vector (in this case the 1D <code>x</code>) should still return a vector (which <code>force</code> expects). Note that I have tried many different ways of defining the derivative (<code>deriv</code>, <code>fderiv</code>, <code>Space.deriv</code>, gradient and <code>∂[d]</code>).</p>",
        "id": 522455751,
        "sender_full_name": "Lode Vermeulen",
        "timestamp": 1749072924
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"690587\">@Lode Vermeulen</span> good point, I think the correct definition here should actually be using <code>Space.grad</code> (which gives you a vector) instead of <code>deriv</code>.</p>\n<p>something like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">InnerProductSpace</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Space</span>\n<span class=\"sd\">/-- The potential energy of the harmonic oscillator is `1/2 k x ^ 2` -/</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">potentialEnergy</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"mi\">1</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">⟫_</span><span class=\"n\">ℝ</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">force</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HarmonicOscillator</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"bp\">∇</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">potentialEnergy</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>",
        "id": 522458785,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1749074297
    },
    {
        "content": "<p><code>Space</code> should really only be for spatial coordinates - although <code>Space 1</code> and <code>EuclideanSpace ℝ (Fin 1)</code> is exactly the same in terms of mathematical behaviour, I believe the rationale is that having this distinction makes things clearer, so <code>force</code> here being a vector should have type <code>EuclideanSpace ℝ (Fin 1)</code>. It is also the reason we defined our custom <code>Space.grad</code> etc. for working with functions in physical <code>Space</code>.</p>",
        "id": 522460188,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1749075006
    },
    {
        "content": "<p>Thanks, it all seems to work well now. I have been stuck at trying to prove <code>force_is_linear</code> for some time now. I have been able to get the goal to <code>-∇ (1 / 2 • S.k • fun x =&gt; ⟪x, x⟫_ℝ) x = -S.k • x</code>. My plan was to apply a new helper lemma that I added in <code>VectorIdentities.lean</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">grad_const_smul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Differentiable</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∇</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"bp\">∇</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">grad</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"bp\">.</span><span class=\"n\">deriv</span>\n<span class=\"w\">  </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">fderiv_const_smul'</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ContinuousLinearMap</span><span class=\"bp\">.</span><span class=\"n\">coe_smul'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Pi</span><span class=\"bp\">.</span><span class=\"n\">smul_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">smul_eq_mul</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">differentiableAt</span>\n</code></pre></div>\n<p>But I just don't seem to be able to apply this lemma, for some reason. For context, I defined <code>have hd : Differentiable ℝ (fun (x : Space 1) =&gt; ⟪x, x⟫_ℝ)</code> (which I have just sorry'd in the proof for now), which is necessary as <code>hf</code> in <code>grad_const_mul</code>.  Could someone give me some pointers on how to resolve this?</p>",
        "id": 523064976,
        "sender_full_name": "Lode Vermeulen",
        "timestamp": 1749465236
    },
    {
        "content": "<p>(deleted: sorry  I missed the <code>1 / 2</code> - length of my window was just the wrong length)</p>",
        "id": 523065772,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1749465527
    },
    {
        "content": "<p>Using <code>erw [grad_const_smul]</code> works for me, but it isn't ideal</p>",
        "id": 523066462,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1749465795
    },
    {
        "content": "<p>Ah, so  <code>1 / 2 • S.k • fun x =&gt; ⟪x, x⟫_ℝ</code> is not <code>(1/2) • S.k • fun x =&gt; ⟪x, x⟫_ℝ</code> it's <code>1/ (2 • S.k • fun x =&gt; ⟪x, x⟫_ℝ)</code>. I'm guessing you actually want the former.</p>",
        "id": 523066831,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1749465930
    },
    {
        "content": "<p>Actually one needs to be even more explicit: <code>(1 / (2 : ℝ)) • S.k • fun x =&gt; ⟪x, x⟫_ℝ</code> to get things to work, otherwise it takes <code>(1/2)</code> to be division in the natural numbers :(.</p>",
        "id": 523067271,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1749466094
    },
    {
        "content": "<p>Here are a couple of results which could be added to <code>VectorIdentities</code> to help: </p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>Code</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kd\">lemma</span><span class=\"w\"> </span><span class=\"n\">deriv_component_same</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">μ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">μ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">μ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">fderiv_coord_eq_proj_comp</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ContinuousLinearMap.proj</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">erw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearMap.proj_apply</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n\n<span class=\"kd\">lemma</span><span class=\"w\"> </span><span class=\"n\">deriv_component_diff</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">μ</span><span class=\"w\"> </span><span class=\"n\">ν</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">μ</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"n\">ν</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">μ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">ν</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">fderiv_coord_eq_proj_comp</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ContinuousLinearMap.proj</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">erw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearMap.proj_apply</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">omega</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">InnerProductSpace</span>\n\n<span class=\"kd\">lemma</span><span class=\"w\"> </span><span class=\"n\">inner_differentiable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Differentiable</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"n\">fun_prop</span>\n\n<span class=\"kd\">lemma</span><span class=\"w\"> </span><span class=\"n\">grad_inner</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∇</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Space.grad</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">fderiv_sum</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finset.sum_eq_single</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">EuclideanSpace.single</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">congr</span>\n<span class=\"w\">        </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">y</span>\n<span class=\"w\">        </span><span class=\"n\">ring</span>\n<span class=\"w\">      </span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">z</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">fderiv_comp</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">deriv_eq</span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"n\">simp</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">fun_prop</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">fun_prop</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"n\">hb</span>\n<span class=\"w\">      </span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">EuclideanSpace.single</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">congr</span>\n<span class=\"w\">        </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">y</span>\n<span class=\"w\">        </span><span class=\"n\">ring</span>\n<span class=\"w\">      </span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">z</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">      </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">fderiv_comp</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">left</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">deriv_eq</span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv_component_diff</span><span class=\"o\">]</span>\n<span class=\"w\">        </span><span class=\"n\">omega</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">fun_prop</span>\n<span class=\"w\">      </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">fun_prop</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">    </span><span class=\"n\">fun_prop</span>\n</code></pre></div>\n</div></div>\n<p>(Need to import <code>import Mathlib.Analysis.SpecialFunctions.Pow.Deriv</code>)</p>",
        "id": 523073676,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1749468812
    },
    {
        "content": "<p>for some reason there's no <code>fderiv_pow</code>, should be simpler if we just define that instead</p>",
        "id": 523075084,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1749469412
    },
    {
        "content": "<p>I imagine it can probably be defined in the exact same way as e.g. <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=fderiv_cos#doc\">docs#fderiv_cos</a></p>",
        "id": 523075164,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1749469448
    },
    {
        "content": "<p>might still be a good idea to have <code>grad_inner</code> as you defined here, I'm just saying the proof can probably be much simpler. maybe I can look into PRing <code>fderiv_pow</code> to mathlib when I have time.</p>",
        "id": 523075695,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1749469677
    },
    {
        "content": "<p>One should actually be able to use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=fderiv_inner_apply#doc\">docs#fderiv_inner_apply</a> in <code>grad_inner</code> to simplify it aswell.</p>",
        "id": 523100397,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1749477953
    },
    {
        "content": "<p>here's how I'll write this for now:</p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>Code</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">grad_const_smul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Differentiable</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∇</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"bp\">∇</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">grad</span>\n<span class=\"w\">  </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv_smul</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Pi</span><span class=\"bp\">.</span><span class=\"n\">smul_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">smul_eq_mul</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">fun_prop</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">force_is_linear</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">-∇</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"n\">ℝ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">⟫_</span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">grad_const_smul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">grad_const_smul</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">grad</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"bp\">.</span><span class=\"n\">deriv</span>\n<span class=\"w\">  </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">-</span><span class=\"n\">PiLp</span><span class=\"bp\">.</span><span class=\"n\">inner_apply</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">fderiv_inner_apply</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">fin_cases</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"n\">norm_num</span>\n<span class=\"w\">  </span><span class=\"n\">ring</span>\n<span class=\"w\">  </span><span class=\"n\">repeat</span><span class=\"w\"> </span><span class=\"n\">fun_prop</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Differentiable</span><span class=\"bp\">.</span><span class=\"n\">inner</span>\n<span class=\"w\">    </span><span class=\"n\">repeat</span><span class=\"w\"> </span><span class=\"n\">fun_prop</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">change</span><span class=\"w\"> </span><span class=\"n\">Differentiable</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">⟫_</span><span class=\"n\">ℝ</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Differentiable</span><span class=\"bp\">.</span><span class=\"n\">const_smul</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Differentiable</span><span class=\"bp\">.</span><span class=\"n\">inner</span>\n<span class=\"w\">    </span><span class=\"n\">repeat</span><span class=\"w\"> </span><span class=\"n\">fun_prop</span>\n</code></pre></div>\n</div></div>\n<p>but feel free to implement some of the suggestions above which helps with the API and leads to less unfolding in the future :)</p>",
        "id": 523106439,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1749480035
    },
    {
        "content": "<p>btw I think <code>grad_const_smul</code> already exists as <code>grad_smul</code> in <code>VectorIdentities</code></p>",
        "id": 523118991,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1749483867
    },
    {
        "content": "<p>(! I completely forgot about that lol)</p>",
        "id": 523119405,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1749483953
    },
    {
        "content": "<p>Thanks for these! </p>\n<p>Those conflicts between ℕ and ℝ are really sneaky.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"653351\">Joseph Tooby-Smith</span> <a href=\"#narrow/channel/479953-PhysLean/topic/Mini.20projects/near/523118991\">said</a>:</p>\n<blockquote>\n<p>btw I think <code>grad_const_smul</code> already exists as <code>grad_smul</code> in <code>VectorIdentities</code></p>\n</blockquote>\n<p>Completely read over this as well.</p>",
        "id": 523128083,
        "sender_full_name": "Lode Vermeulen",
        "timestamp": 1749486453
    },
    {
        "content": "<p>Could I get push permission? I'd like to create a PR with this code.</p>",
        "id": 523128149,
        "sender_full_name": "Lode Vermeulen",
        "timestamp": 1749486478
    },
    {
        "content": "<p>These changes have caused some issues in<code>/HarmonicOscillator/Solutions.lean</code>, as <code>Space 1</code> is now used instead of <code>ℝ</code>. Mostly these are pretty fixable. I am having trouble with the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">amplitude_eq_norm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">InitialConditions</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">amplitude</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"o\">(</span><span class=\"bp\">↑</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">x₀</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">-↑</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">v₀</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">ω</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">I</span><span class=\"o\">)</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">amplitude_eq</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"o\">(</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">x₀</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">v₀</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">ω</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">ring_nf</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">norm_add_mul_I</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>Which I have translated to</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">InitialConditions</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The initial position of the harmonic oscillator. -/</span>\n<span class=\"w\">  </span><span class=\"n\">x₀</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"sd\">/-- The initial velocity of the harmonic oscillator. -/</span>\n<span class=\"w\">  </span><span class=\"n\">v₀</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Space</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">amplitude_eq_norm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">InitialConditions</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">amplitude</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"o\">(((</span><span class=\"bp\">↑</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">x₀</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"n\">ℂ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">ω</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">↑</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">v₀</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)))</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>Using the coercion defined in <code>/Space/Basic.lean</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Coe</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Which I got using some help from Gemini. This does allow me to do the coercion, i.e. the statement of <code>amplitude_eq_norm</code> does not give me any errors. Now I still need to do the proof, which now includes the coercion (so specifically, <code>coe v := fun i =&gt; (v i : ℂ)</code>). Before trying to prove it, I first want to figure out whether the statements are even equal. I don't understand coercions and this <code>instance</code> statement well enough, so I hoped someone could let me know if this coercion is even correct in the first place.</p>\n<p>EDIT: The proof state (after <code>rw [amplitude_eq]</code>) is the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HarmonicOscillator</span>\n<span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">InitialConditions</span>\n<span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"o\">(</span><span class=\"bp\">⟪</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">x₀</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">x₀</span><span class=\"bp\">⟫_</span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">⟪</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">ω</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">v₀</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">ω</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">v₀</span><span class=\"bp\">⟫_</span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">  </span><span class=\"bp\">‖</span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"o\">(</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">x₀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">ω</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"o\">(</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">v₀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">‖</span>\n</code></pre></div>",
        "id": 524072045,
        "sender_full_name": "Lode Vermeulen",
        "timestamp": 1749915216
    },
    {
        "content": "<p>On a train, so only a partial answer. But here is a suggestion that might make things easier. Instead of the coercion you have defined, note the following:  <code>IC.x₀</code> is  a vector with one element, and <code>IC.x₀ 0 : ℝ</code> is that element. So if you change the theorem to </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">amplitude_eq_norm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">InitialConditions</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">amplitude</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"o\">(((</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">x₀</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"n\">ℂ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">ω</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">v₀</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">))</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>the coercion between <code>ℝ</code> and <code>ℂ</code> should take care of things. This might require changing instances of <code>IC.x₀</code> appearing earlier in the file to <code>IC.x₀ 0</code>, etc.</p>",
        "id": 524078260,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1749922937
    },
    {
        "content": "<p>Thanks, that seems to work.</p>",
        "id": 524089140,
        "sender_full_name": "Lode Vermeulen",
        "timestamp": 1749937220
    },
    {
        "content": "<p>Instead of this thread for mini project ideas, I've updated the website to include this page: </p>\n<p><a href=\"https://physlean.com/ProjectIdeas\">https://physlean.com/ProjectIdeas</a></p>\n<p>If anyone has any suggestions or ideas of what they would like to see there, let me know.</p>",
        "id": 529307454,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1752766864
    },
    {
        "content": "<p>I am running into some more problems now.</p>\n<ol>\n<li>With the above definition of <code>amplitude_eq_norm</code>, I am unsure how to prove identities like <code>‖IC.x₀‖ = IC.x₀ 0</code>.</li>\n<li>I am unsure how to correctly state the following lemma:</li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">sol_eq_amplitude_mul_cos_phase</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">InitialConditions</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">amplitude</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">cos</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">ω</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">phase</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>As the LHS has type <code> Time → Space 1</code> and the RHS <code>Time → ℝ </code>. The way to fix this is to transform the type of <code>amplitude</code> to <code>Space 1</code>, but this is not intuitive (it should be <code>ℝ</code>) nor clear how to do so.</p>\n<ol start=\"3\">\n<li><code>potentialEnergy</code> is now of type <code>ℝ</code>, but <code>sol_potentialEnergy</code> is of type <code>Time → ℝ </code> (which also does not make sense to just remove as <code>S.sol IC</code> also takes time as an input). Especially considering the following, I guess I am a bit stuck with this<br>\n<span class=\"user-mention silent\" data-user-id=\"653351\">Joseph Tooby-Smith</span> <a href=\"#narrow/channel/479953-PhysLean/topic/Mini.20projects/near/522200987\">said</a>:</li>\n</ol>\n<blockquote>\n<p>I personally can't think of a way of doing this without refactoring the potential energy and force to not depend on <code>t</code>. </p>\n</blockquote>",
        "id": 529602587,
        "sender_full_name": "Lode Vermeulen",
        "timestamp": 1752946808
    },
    {
        "content": "<p>Regarding your points: </p>\n<ol>\n<li>I don't think the identity <code>‖IC.x₀‖ = IC.x₀ 0</code> should be true, what I think is true is <code>‖IC.x₀‖ = |IC.x₀ 0|</code>. Is there a context in which you need  <code>‖IC.x₀‖ = IC.x₀ 0</code>?</li>\n<li>I would rewrite this as something like: </li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">sol_eq_amplitude_mul_cos_phase</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">InitialConditions</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">amplitude</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\">  </span><span class=\"n\">cos</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">ω</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">phase</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"o\">))</span>\n</code></pre></div>\n<p>That is, trivially make the RHS a vector. </p>\n<ol start=\"3\">\n<li>I think you need to replace <code>sol_potentialEnergy</code> with:</li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">sol_potentialEnergy</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">InitialConditions</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Time</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">potentialEnergy</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">sol</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">x₀</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">v₀</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">cos</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">ω</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">phase</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>An aside: Ultimately I think we should repalce the lagrangian to be a function of <code>x : Space 1</code> and a velocity<code>v : ℝ</code> (or a type we make for velocity), so that it will work with the Euler-Lagrange equations and variational calculus we have. It partially for this reason we want the potential to be a function of just the position not the trajectory.</p>",
        "id": 529604394,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1752948923
    },
    {
        "content": "<p>Thanks! For 1., you're right, I actually need <code>‖IC.x₀‖ ^ 2=IC.x₀ 0 ^ 2</code> (which should be true) instead in</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">amplitude_eq_norm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">InitialConditions</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">amplitude</span><span class=\"w\"> </span><span class=\"n\">IC</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‖</span><span class=\"o\">((</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">x₀</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\">  </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"n\">ℂ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">ω</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">v₀</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">I</span><span class=\"o\">)</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">amplitude_eq</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"o\">(</span><span class=\"bp\">‖</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">x₀</span><span class=\"bp\">‖^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‖</span><span class=\"n\">IC</span><span class=\"bp\">.</span><span class=\"n\">v₀</span><span class=\"bp\">‖/</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">ω</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">ring</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">norm_add_mul_I</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">norm_eq_sqrt_sq_add_sq</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">isValue</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">one_div</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">real_smul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">smul_eq_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sub_re</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ofReal_re</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_re</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">inv_re</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"n\">normSq_ofReal</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">div_self_mul_self'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">I_re</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_zero</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ofReal_im</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">I_im</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_one</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sub_self</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">inv_im</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"n\">neg_zero</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">zero_div</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_im</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">add_zero</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">zero_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sub_zero</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sub_im</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">zero_sub</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">even_two</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"n\">Even</span><span class=\"bp\">.</span><span class=\"n\">neg_pow</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 529605179,
        "sender_full_name": "Lode Vermeulen",
        "timestamp": 1752949852
    },
    {
        "content": "<p>I still don't know how to prove that fact though <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 529639480,
        "sender_full_name": "Lode Vermeulen",
        "timestamp": 1752995621
    },
    {
        "content": "<p>Do you mean <code>‖IC.x₀‖ ^ 2=IC.x₀ 0 ^ 2</code>? if so the below is an equivalent lemma. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">InnerProductSpace</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">‖</span><span class=\"n\">x</span><span class=\"bp\">‖</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">@</span><span class=\"n\">PiLp</span><span class=\"bp\">.</span><span class=\"n\">norm_sq_eq_of_L2</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"c1\">-- found using rw?</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n</code></pre></div>",
        "id": 529675903,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1753004253
    },
    {
        "content": "<p>Great work for finishing this! I have a few minor comments/questions, but <a href=\"https://github.com/HEPLean/PhysLean/pull/604\">the PR</a> has been merged already and maybe <span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span> can answer those from a design philosophy perspective so I thought maybe I'll just ask them here.</p>\n<ol>\n<li>\n<p><code>Mathlib.Algebra.Lie.OfAssociative</code>, <code>Mathlib.Analysis.CStarAlgebra.Classes</code>, <code>Mathlib.Data.Real.StarOrdered</code> can be removed without breaking anything (I'm also curious why they're there in the first place). I thought after <a href=\"https://github.com/HEPLean/PhysLean/pull/570\">PR#570</a> the linter checks for redundant imports, maybe I'm misunderstanding how it works. (<code>#min_imports</code> only catches the first one I think, is it because the file contains <code>sorry</code>?)</p>\n</li>\n<li>\n<p><code>polarCoord</code> is used to define amplitude and phase which feels a bit weird to me since these quantities have nothing to do with coordinates, personally I'd rather define it via the norm and <code>Complex.Arg</code> directly without invoking <code>polarCoord</code>.</p>\n</li>\n<li>\n<p>I feel like the overall exposition right now is a bit strange, it looks like \"given a system with these parameters, define arbitrary quantities and relations, then show everything works out\" but doesn't really feel like deriving properties of a harmonic oscillator. Maybe this is a byproduct of the Euler-Lagrange equations not ready yet and the overall presentation can be refactored afterwards (but I also think another starting point would be Newton's second law i.e. <code>F = ma = -kx</code> which isn't really used here). To give a concrete example, let's consider the amplitude. The way I would think about the amplitude is the maximal displacement, which is the extrema of the position. I would expect some notion of \"maximum\" in the definition, then show that it equals the norm of initial condition (probably involving differentiation). Not saying any of the current results are wrong, but the current exposition just doesn't seem that \"physics\" to me. Maybe I'm completely overthinking this but would like to know what you think :)</p>\n</li>\n</ol>",
        "id": 530232621,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1753222913
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"890057\">@ZhiKai Pong</span> , let me address your comments in turn, all of which I agree with. </p>\n<ol>\n<li>The redundant imports linter only checks for transitive imports (i.e. when an import is included already via another file), it is not quite the same as <code>#min_imports</code>, which is harder to implement a linter for because of the number of false-positives. I'm guessing these imports were added via a copy-and-paste (probably by me), but should be removed. Really every so often we should run:</li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">shake</span><span class=\"w\"> </span><span class=\"c1\">--cfg ./scripts/physleanNoShake.json PhysLean</span>\n</code></pre></div>\n<p>and clean up the results. </p>\n<ol start=\"2\">\n<li>\n<p>I'm happy for these to be changed, really if we can define things without needing complex numbers at all, I think that would be better. </p>\n</li>\n<li>\n<p>Indeed, I think the most important TODO items here are still left: that is showing that the solutions actually solve the equation of motion and that they are unique given their boundary conditions. I agree with your comment about the amplitude, and I think it should be defined as the maximum displacement, and more generally that the overall structure of the file can be made better. This is my bad.</p>\n</li>\n</ol>",
        "id": 530264721,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1753248514
    },
    {
        "content": "<p>Surely the phase also has a physical definition too, based on the time <code>t = 0</code> and the how long it takes to get from <code>t=0</code> to the amplitude.</p>",
        "id": 530267039,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1753250301
    },
    {
        "content": "<p>I'd love to help on any tasks that come out of this!</p>\n<p>I think these are some good points. Indeed implementing the Euler-Lagrange equations would probably help make everything more physics-y. Furthermore, I was wondering about extending these results to n dimensions to make it as general as possible. At first glance it seems like this would not be too hard if we just use the norm in calculations everywhere. It might also be interesting to introduce dampening/driving coefficients. I feel like those things would be nice if this would be used as an API, right?</p>",
        "id": 530273177,
        "sender_full_name": "Lode Vermeulen",
        "timestamp": 1753253690
    },
    {
        "content": "<p>Yeah, I agree, any of these seem useful. For the Euler-Lagrange equations that starting point should likely be <code>eulerLagrangeOp</code>, the statement that this is an extrema of the action is just the lemma <code>euler_lagrange_varGradient</code>. (see this <a href=\"https://github.com/HEPLean/PhysLean/blob/master/PhysLean/ClassicalMechanics/EulerLagrange.lean\">file</a>). </p>\n<p>I think physically what makes the most sense is the following: </p>\n<ol>\n<li>Obtain the Euler-Lagrange equations from <code>eulerLagrangeOp</code>. </li>\n<li>Show that for a given set of initial conditions, the Euler lagrange equations have a unique solution. (not sure how difficult this is - but once we know how to do this in this example, it will be very useful elsewhere.)</li>\n<li>Using choice, define the <code>sol</code> to be said unique solution. </li>\n<li>Then show that <code>sol</code> has the form we have. </li>\n</ol>\n<p>This kind of follows ZhiKai's suggested approach with the amplitude.</p>",
        "id": 530274951,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1753254393
    },
    {
        "content": "<p>Uniqueness can probably be proved similar to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ODE_solution_unique_univ#doc\">docs#ODE_solution_unique_univ</a></p>",
        "id": 530338823,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1753275663
    },
    {
        "content": "<p>I added another project to: <a href=\"https://physlean.com/ProjectIdeas\">https://physlean.com/ProjectIdeas</a>, which is actually similar in nature to the one discussed here regarding the harmonic oscillator. That is: Formalize the classical mechanics of a pendulum. If anyone wants to have a go at this, that would be great - should be a nice 'relatively' simple project (although I note even simple looking projects can turn out difficult :)).</p>",
        "id": 535246461,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1755671258
    }
]