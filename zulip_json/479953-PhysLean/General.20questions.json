[
    {
        "content": "<p>I hope it's ok to start a general questions thread similar to <a class=\"stream\" data-stream-id=\"113489\" href=\"/#narrow/channel/113489-new-members\">#new members</a> or <a class=\"stream\" data-stream-id=\"217875\" href=\"/#narrow/channel/217875-Is-there-code-for-X.3F\">#Is there code for X?</a> but for PhysLean specifically. If some questions are better asked over there please do point that out.</p>",
        "id": 510367839,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1743855600
    },
    {
        "content": "<p>I wanted to start with showing the (free space) wave equation follows from Maxwell's, and wonder how much vector calculus do we have in PhysLean.  As far as I can tell <code>spaceDiv</code> and <code>spaceCurl</code> are defined <a href=\"https://github.com/HEPLean/PhysLean/blob/master/PhysLean/Relativity/SpaceTime/Basic.lean\">here</a> without much API around it, should I have a go at showing some of the common vector calculus identities?</p>\n<p><a href=\"https://en.wikipedia.org/wiki/Vector_calculus_identities\">https://en.wikipedia.org/wiki/Vector_calculus_identities</a></p>",
        "id": 510367886,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1743855611
    },
    {
        "content": "<p>(Do the maths people care about vector calculus in 3D in this sense? I don't know enough about mathlib to know whether they have this or it follows from some more fancy notion (of differential forms?))</p>",
        "id": 510368237,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1743855923
    },
    {
        "content": "<p>Yes, I think increasing the API around <code>spaceDiv</code> and <code>spaceCurl</code> etc. would be very useful. </p>\n<p>Even in Mathlib does have this in a fancy notation, I don't it hurts to have a more specialized version in PhysLean which is easier to use for physicists and physics. <br>\nNaturally though we shouldn't go around making long proofs of things which already have proofs in Mathlib.</p>",
        "id": 510368685,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1743856222
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">PhysLean</span><span class=\"bp\">.</span><span class=\"n\">Relativity</span><span class=\"bp\">.</span><span class=\"n\">SpaceTime</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">div_of_curl_eq_zero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">‚àá‚¨ù</span><span class=\"o\">(</span><span class=\"bp\">‚àá√ó</span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">¬† </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>First attempt at stating something: Tried my best to understand the types defined in div and curl, seems like they're defined through a function (<code>A</code>) that takes  <code>SpaceTime</code> and returns a vector in the usual sense? currently this gives an error saying <code>expected token</code>, would appreciate guidance as to how to fix and tips on understanding the setup.</p>",
        "id": 510384210,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1743867370
    },
    {
        "content": "<p>ah I have to <code>open SpaceTime</code></p>",
        "id": 510385682,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1743868246
    },
    {
        "content": "<p>Ah, ok this is annoying that this doesn't work. This is down to two things:</p>\n<ol>\n<li>The fact that you need the spacing e.g. <code>‚àá√ó A</code> instead of <code>‚àá√óA</code> or<code>‚àá √ó A</code> .</li>\n<li>A precedence issue with the notation meaning you need some more brackets. </li>\n</ol>\n<p>I think they should both be easy fixes. </p>\n<p>But for now you can do:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">div_of_curl_eq_zero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚àá‚¨ù</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚àá√ó</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 510385856,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1743868353
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">PhysLean</span><span class=\"bp\">.</span><span class=\"n\">Relativity</span><span class=\"bp\">.</span><span class=\"n\">SpaceTime</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">div_of_curl_eq_zero</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚àá‚¨ù</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚àá√ó</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>I think this works now. How would I proceed from here? I imagine I'd need to unwrap the definition until the  <code>fderiv</code> level for a bunch of  <code>simp</code> and <code>rw</code>s, is there a straightforward way of doing that?</p>",
        "id": 510386274,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1743868649
    },
    {
        "content": "<p>I would first prove in a separate lemma that two <code>SpaceTime.deriv</code> commute with one another. This probably involves unwrapping the definitions there to <code>fderiv</code> and using properties thereof. You may also need to assume differentiability of the functions. This would be a useful lemma to have anyway. </p>\n<p>From this I think <code>div_of_curl_eq_zero</code> is more straight forward.</p>",
        "id": 510386685,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1743868898
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"653351\">Joseph Tooby-Smith</span> <a href=\"#narrow/channel/479953-PhysLean/topic/General.20questions/near/510386685\">said</a>:</p>\n<blockquote>\n<p>This probably involves unwrapping the definitions there to <code>fderiv</code> and using properties thereof. </p>\n</blockquote>\n<p>how do I do that?</p>",
        "id": 510386976,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1743869077
    },
    {
        "content": "<p>This is a start: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">deriv_commute</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">y</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>From there I think it's a case of looking to see what we can use from mathlib.</p>",
        "id": 510387212,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1743869255
    },
    {
        "content": "<p>I have to admit after the <code>rw</code> the proof state is impenetrable to me</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚àÇ_</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(((</span><span class=\"n\">realLorentzTensor</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">tensorBasis</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"n\">realLorentzTensor</span><span class=\"bp\">.</span><span class=\"n\">Color</span><span class=\"bp\">.</span><span class=\"n\">up</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"bp\">‚ãØ</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚àÇ_</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(((</span><span class=\"n\">realLorentzTensor</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">tensorBasis</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"n\">realLorentzTensor</span><span class=\"bp\">.</span><span class=\"n\">Color</span><span class=\"bp\">.</span><span class=\"n\">up</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"bp\">‚ãØ</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>From what I gathered mathlib should have what we need <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Calculus/FDeriv/Symmetric.html\">here</a> but how to proceed afterwards is beyond my reach.</p>",
        "id": 510412237,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1743887090
    },
    {
        "content": "<p>there's some relevant discussions in <a href=\"#narrow/channel/479953-PhysLean/topic/Hydrogen.20atom\">this thread</a> and I'm trying to understand <span class=\"user-mention\" data-user-id=\"346070\">@Tomas Skrivan</span>'s recent post <a class=\"message-link\" href=\"/#narrow/channel/113489-new-members/topic/partial.20derivative.20of.20a.20vector.20field/near/506481684\">#new members &gt; partial derivative of a vector field @ üí¨</a>.</p>",
        "id": 510413367,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1743887921
    },
    {
        "content": "<p>Going a bit off on a tangent here: If the answer is \"I should go ahead and try to understand how <code>fderiv</code> works\" I can try that, but at the same time I feel like in Physics a lot of things are implicitly assumed (Most things are continuous etc.) and I would think it might also be possible to expose just the \"high level API\" at the level of usual undergraduate students which makes everything much more accessible and readable (e.g. I probably don't need any knowledge about manifolds to work with most physics in \"normal 3D space\", and I haven't heard of Fr√©chet derivatives until I started looking at lean.) Maybe this is just a matter of the API and \"packaging\" in PhysLean isn't quite there yet and I hope this will become easier as time goes on.</p>",
        "id": 510413819,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1743888253
    },
    {
        "content": "<p>Here is the full proof that space time derivatives commute up to the proof of <code>Differentiable ‚Ñù (fderiv ‚Ñù f)</code> which I didn't manage to find in mathlib.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">PhysLean</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Calculus</span><span class=\"bp\">.</span><span class=\"n\">FDeriv</span><span class=\"bp\">.</span><span class=\"n\">Symmetric</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">PhysLean</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span>\n\n<span class=\"kn\">noncomputable</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">baseVector</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">((</span><span class=\"n\">realLorentzTensor</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">tensorBasis</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"o\">))</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">deriv_def</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">baseVector</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">deriv_commute</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedSpace</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚ä§</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">y</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv_def</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Differentiable</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">disch</span><span class=\"o\">:=</span><span class=\"n\">fun_prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">fderiv_clm_apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"o\">:=(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">))]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"o\">[</span><span class=\"n\">IsSymmSndFDerivAt</span><span class=\"bp\">.</span><span class=\"n\">eq</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ContDiffAt</span><span class=\"bp\">.</span><span class=\"n\">isSymmSndFDerivAt_of_omega</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">contDiffAt</span>\n</code></pre></div>\n<p>I added a custom \"unfolding\" theorem for <code>SpaceTime.deriv</code> such that the result is more readable.</p>",
        "id": 510416563,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1743890441
    },
    {
        "content": "<p>The goals after <code>simp [deriv_def]</code> says</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">baseVector</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">baseVector</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">baseVector</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">baseVector</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>rather than</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">          </span><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(((</span><span class=\"n\">realLorentzTensor</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">tensorBasis</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"n\">realLorentzTensor</span><span class=\"bp\">.</span><span class=\"n\">Color</span><span class=\"bp\">.</span><span class=\"n\">up</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"bp\">‚ãØ</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"o\">))</span>\n<span class=\"w\">        </span><span class=\"n\">y</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"o\">(((</span><span class=\"n\">realLorentzTensor</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">tensorBasis</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"n\">realLorentzTensor</span><span class=\"bp\">.</span><span class=\"n\">Color</span><span class=\"bp\">.</span><span class=\"n\">up</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"bp\">‚ãØ</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">          </span><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(((</span><span class=\"n\">realLorentzTensor</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">tensorBasis</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"n\">realLorentzTensor</span><span class=\"bp\">.</span><span class=\"n\">Color</span><span class=\"bp\">.</span><span class=\"n\">up</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"bp\">‚ãØ</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"o\">))</span>\n<span class=\"w\">        </span><span class=\"n\">y</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"o\">(((</span><span class=\"n\">realLorentzTensor</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">tensorBasis</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"n\">realLorentzTensor</span><span class=\"bp\">.</span><span class=\"n\">Color</span><span class=\"bp\">.</span><span class=\"n\">up</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"bp\">‚ãØ</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>if you call <code>unfold SpaceTime.deriv</code></p>",
        "id": 510416641,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1743890511
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"890057\">ZhiKai Pong</span> <a href=\"#narrow/channel/479953-PhysLean/topic/General.20questions/near/510413819\">said</a>:</p>\n<blockquote>\n<p>Going a bit off on a tangent here: If the answer is \"I should go ahead and try to understand how <code>fderiv</code> works\" I can try that, but at the same time I feel like in Physics a lot of things are implicitly assumed (Most things are continuous etc.) and I would think it might also be possible to expose just the \"high level API\" at the level of usual undergraduate students which makes everything much more accessible and readable (e.g. I probably don't need any knowledge about manifolds to work with most physics in \"normal 3D space\", and I haven't heard of Fr√©chet derivatives until I started looking at lean.) Maybe this is just a matter of the API and \"packaging\" in PhysLean isn't quite there yet and I hope this will become easier as time goes on.</p>\n</blockquote>\n<p>Yeah this is a bit unfortunate state of the affairs, even in mathlib if you want to introduce vector space you need to write <code>{X} [AddCommGroup X] [Module Real X]</code> and if you want to differentiate over it you have to write <code>{X} [NormedAddCommGroup X] [NormedSpace Real X]</code> and so on.<br>\nI also hope that things will be easier and more familiar to beginners but it is lots of really hard work and somewhat incompatible when you are also trying to figure out the fundamentals on top of which you can do even the really advanced stuff. So at this point one has to spend some time and learn all the Lean/mathlib/PhysLean idiosyncrasies.</p>",
        "id": 510417316,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1743891055
    },
    {
        "content": "<p>thanks a lot, having something as an example should make it much easier to understand, I'll try my best to work through this!</p>",
        "id": 510417466,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1743891180
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"346070\">Tomas Skrivan</span> <a href=\"#narrow/channel/479953-PhysLean/topic/General.20questions/near/510416563\">said</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">deriv_commute</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedSpace</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚ä§</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">y</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv_def</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Differentiable</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">disch</span><span class=\"o\">:=</span><span class=\"n\">fun_prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">fderiv_clm_apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"o\">:=(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">))]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"o\">[</span><span class=\"n\">IsSymmSndFDerivAt</span><span class=\"bp\">.</span><span class=\"n\">eq</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ContDiffAt</span><span class=\"bp\">.</span><span class=\"n\">isSymmSndFDerivAt_of_omega</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">contDiffAt</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>the <code>simp</code> after <code>have</code> throws an error<br>\n<code>failed to synthesize\n  NormedAddCommGroup M</code></p>",
        "id": 510419441,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1743892877
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"890057\">ZhiKai Pong</span> <a href=\"#narrow/channel/479953-PhysLean/topic/General.20questions/near/510419441\">said</a>:</p>\n<blockquote>\n<p>the <code>simp</code> after <code>have</code> throws an error<br>\n<code>failed to synthesize\n  NormedAddCommGroup M</code></p>\n</blockquote>\n<p>I can't reproduce this, the mwe I posted works for me fine. Do you have other imports, variables etc. in the file?</p>",
        "id": 510425611,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1743898231
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"346070\">Tomas Skrivan</span> <a href=\"#narrow/channel/479953-PhysLean/topic/General.20questions/near/510416563\">said</a>:</p>\n<blockquote>\n<p>Here is the full proof that space time derivatives commute up to the proof of <code>Differentiable ‚Ñù (fderiv ‚Ñù f)</code> which I didn't manage to find in mathlib.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">PhysLean</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Calculus</span><span class=\"bp\">.</span><span class=\"n\">FDeriv</span><span class=\"bp\">.</span><span class=\"n\">Symmetric</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">PhysLean</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span>\n\n<span class=\"kn\">noncomputable</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">baseVector</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">((</span><span class=\"n\">realLorentzTensor</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">tensorBasis</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"o\">))</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">deriv_def</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">baseVector</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">deriv_commute</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedSpace</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SpaceTime</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚ä§</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">ŒΩ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"n\">y</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">deriv_def</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Differentiable</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">disch</span><span class=\"o\">:=</span><span class=\"n\">fun_prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">fderiv_clm_apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"o\">:=(</span><span class=\"n\">fderiv</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">))]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"o\">[</span><span class=\"n\">IsSymmSndFDerivAt</span><span class=\"bp\">.</span><span class=\"n\">eq</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ContDiffAt</span><span class=\"bp\">.</span><span class=\"n\">isSymmSndFDerivAt_of_omega</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"bp\">.</span><span class=\"n\">contDiffAt</span>\n</code></pre></div>\n<p>I added a custom \"unfolding\" theorem for <code>SpaceTime.deriv</code> such that the result is more readable.</p>\n</blockquote>\n<p>The lemma <code>deriv_commute</code> may also work if <code>Differentiable ‚Ñù (fderiv ‚Ñù f)</code> is not true, right? Since I think then both sides may go to zero.</p>",
        "id": 510448418,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1743917806
    },
    {
        "content": "<p>I don't think so because the statement contains <code>fderiv R (fun x =&gt; fderiv R f x u) x v</code> and not <code>fderiv R (fderiv R f) x u v</code></p>",
        "id": 510452538,
        "sender_full_name": "Tomas Skrivan",
        "timestamp": 1743921149
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"346070\">Tomas Skrivan</span> <a href=\"#narrow/channel/479953-PhysLean/topic/General.20questions/near/510425611\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"890057\">ZhiKai Pong</span> <a href=\"#narrow/channel/479953-PhysLean/topic/General.20questions/near/510419441\">said</a>:</p>\n<blockquote>\n<p>the <code>simp</code> after <code>have</code> throws an error<br>\n<code>failed to synthesize\n  NormedAddCommGroup M</code></p>\n</blockquote>\n<p>I can't reproduce this, the mwe I posted works for me fine. Do you have other imports, variables etc. in the file?</p>\n</blockquote>\n<p>ah I noticed the version I copied had <code>[AddCommGroup M] [Module ‚Ñù M] [TopologicalSpace M]</code> instead of <code>[NormedAddCommGroup M] [NormedSpace ‚Ñù M]</code>, might have copied before you finished editing, works fine now</p>",
        "id": 510468111,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1743933686
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"346070\">Tomas Skrivan</span> <a href=\"#narrow/channel/479953-PhysLean/topic/General.20questions/near/510417316\">said</a>:</p>\n<blockquote>\n<p>Yeah this is a bit unfortunate state of the affairs, even in mathlib if you want to introduce vector space you need to write <code>{X} [AddCommGroup X] [Module Real X]</code> and if you want to differentiate over it you have to write <code>{X} [NormedAddCommGroup X] [NormedSpace Real X]</code> and so on.<br>\nI also hope that things will be easier and more familiar to beginners but it is lots of really hard work and somewhat incompatible when you are also trying to figure out the fundamentals on top of which you can do even the really advanced stuff. So at this point one has to spend some time and learn all the Lean/mathlib/PhysLean idiosyncrasies.</p>\n</blockquote>\n<p>I am guessing that lean's flexibility will enable you to fix all this at your end, you just define <code>VectorSpace \\R V</code> to be the thing you want vector space to mean and write a couple of demo files to show people how to use it.  Can <code>variable?</code> help you?</p>\n<p>People are <em>constantly</em> asking about PDEs and have been for years (and these people are often not hardcore pure mathematicians and are bewildered by what they find in mathlib). I have found that teaching by writing demo files stuffed full of comments works well.</p>",
        "id": 510493668,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1743954014
    },
    {
        "content": "<p>It seems to me that PhysLean often has to rebuild, I'm not sure exactly when but probably when I change imports? is this because <code>lake exe cache get</code> only works for mathlib? is there a way to speed this up?</p>",
        "id": 511621510,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1744369300
    },
    {
        "content": "<p><code>lake exe cache get</code> costs money because you're hosting a lot of files. It doesn't work for FLT so I just bought a new laptop so I can compile it more quickly.</p>",
        "id": 511636416,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744373742
    },
    {
        "content": "<p>I'm surprised it is having to rebuild that often - especially if you are working in one file. </p>\n<p>What are you doing when it has to rebuild, are you in VSCode clicking <code>restart file</code> or running <code>lake build</code>? </p>\n<p>If the former are you working on two files separated by a large chain of imports?<br>\nIf so then it may be rebuilding all the imports between the files to make sure nothing  breaks.</p>",
        "id": 511641147,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1744375033
    },
    {
        "content": "<p>Sometimes I create a new temporary file to create some adhoc examples for testing etc., I guess that's not always a good idea then. What's the suggested work flow for testing then?</p>",
        "id": 511644704,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1744376045
    },
    {
        "content": "<p>What are you importing into these files?</p>",
        "id": 511645363,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1744376258
    },
    {
        "content": "<p>Say I had a file that was importing <code>PhysLean.ClassicalMechanics.Space.Basic</code>. I changed it to <code>import PhysLean.Relativity.SpaceTime.Basic</code>, then it says I'll need to <code>restart file</code></p>",
        "id": 511646293,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1744376511
    },
    {
        "content": "<p>When you click <code>restart file</code> it takes a long time?</p>\n<p>Every time you change the imports like this you have to <code>restart file</code>. But it shouldn't be rebuilding all of the files in PhysLean, it  should be rebuilding any files <br>\n<code>import PhysLean.Relativity.SpaceTime.Basic</code> depends on which you have changed (and any files downstream of that).</p>\n<p>The <code>SpaceTime</code> file depends on a lot of Tensor stuff, but I suspect you are not modifying this, so I don't think this should take a long time.</p>",
        "id": 511647660,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1744376876
    },
    {
        "content": "<p>ah I checked again seems like just changing this is fine, its when after I sync with the remote repository that triggers a full rebuild</p>",
        "id": 511648167,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1744377018
    },
    {
        "content": "<p>Ok I think either one of two things is happening: </p>\n<ol>\n<li>I recently bumped PhysLean (a couple of days a go) - this will have triggered the need for a complete rebuild of PhysLean and Mathlib. </li>\n<li>If more recent, it probably not doing a full rebuild, it's probably rebuilding some of the stuff my PRs have changed, which have been fairly low-level (i.e. lots of files depend on them) and therefore its been rebuilding all the files downstream of this.</li>\n</ol>",
        "id": 511649638,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1744377429
    },
    {
        "content": "<p>Also <code>SpaceTime</code> is fairly low level (i.e. lots of things depend on it) so it could be down to just changes in that</p>",
        "id": 511649918,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1744377510
    },
    {
        "content": "<p>I don't have a good grasp of these kinds of things yet so I'll keep an eye out for what's triggering what, thanks for the explanation!</p>",
        "id": 511650332,
        "sender_full_name": "ZhiKai Pong",
        "timestamp": 1744377628
    },
    {
        "content": "<p>for emergencies or to check vs the latest Physlean bump you can always use <a href=\"https://live.physlean.com\">https://live.physlean.com</a></p>",
        "id": 511654272,
        "sender_full_name": "Matteo Cipollina",
        "timestamp": 1744378640
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"779253\">Matteo Cipollina</span> <a href=\"#narrow/channel/479953-PhysLean/topic/General.20questions/near/511654272\">said</a>:</p>\n<blockquote>\n<p>for emergencies or to check vs the latest Physlean bump you can always use <a href=\"https://live.physlean.com\">https://live.physlean.com</a></p>\n</blockquote>\n<p>As of today, this is updating nightly (all being well ) with the latest version of PhysLean. </p>\n<p>(Note of warning though: Its a really small server so can't cope with lots of people (= more than one person) using it at the same time. Currently this is ok and not something to worry about when using it.)</p>",
        "id": 511655963,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1744379069
    },
    {
        "content": "<p>Looks like the reference linked on the <a href=\"https://physlean.com/docs/PhysLean/Relativity/Lorentz/Group/Basic.html\">lorentz group page</a> is dead and should be changed from <a href=\"http://home.ku.edu.tr/~amostafazadeh/phys517_518/phys517_2016f/Handouts/A_Jaffi_Lorentz_Group.pdf\">http://home.ku.edu.tr/~amostafazadeh/phys517_518/phys517_2016f/Handouts/A_Jaffi_Lorentz_Group.pdf</a> to <a href=\"https://cdn.ku.edu.tr/cdn/files/amostafazadeh/phys517_518/phys517_2016f/Handouts/A_Jaffi_Lorentz_Group.pdf\">https://cdn.ku.edu.tr/cdn/files/amostafazadeh/phys517_518/phys517_2016f/Handouts/A_Jaffi_Lorentz_Group.pdf</a></p>",
        "id": 512267904,
        "sender_full_name": "Jeremy Lindsay",
        "timestamp": 1744708477
    },
    {
        "content": "<p>happy to make a quick PR</p>",
        "id": 512267954,
        "sender_full_name": "Jeremy Lindsay",
        "timestamp": 1744708498
    },
    {
        "content": "<p>If you could fix this - that would be great :). Maybe it would be a good idea to make it a proper reference to avoid link rot  - i.e. put the author, the name of the note etc.</p>",
        "id": 512269481,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1744708928
    },
    {
        "content": "<p>I'm having a bit of trouble showing <code>(Additive.toMul 1)‚Åª¬π = Additive.toMul 1</code> where <code>1 : ZMod 2</code>. I've left a comment on <a href=\"https://github.com/HEPLean/PhysLean/pull/515\">https://github.com/HEPLean/PhysLean/pull/515</a> at the relevant code. Any tips are appreciated :)</p>",
        "id": 514377886,
        "sender_full_name": "Jeremy Lindsay",
        "timestamp": 1745586906
    },
    {
        "content": "<p>Can you post a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a>? I can't make your question typecheck and don't really want to clone the repo on coffeeshop wifi</p>",
        "id": 514379606,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1745587436
    },
    {
        "content": "<p>Ugh, I've had trouble with this in the past (probably in the same file you are editing). I don't think I found a satisfying solution :(.</p>",
        "id": 514385947,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1745589353
    },
    {
        "content": "<p>EDIT: I need to think about this a bit more.</p>\n<p><del><a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQOC0+cA6gKZwDuSAdvDBHAK4DO5Ij6MwYmAxisABu5ahBgCI1OADNocAFoIIAEzgAmAFw50EfujijxXSXABEgEkJAQQSm4AXgB8iDlx7B+XYXAAUileoCUeIRwAEKMdKikUOTAzAYMpvgAjDaGEtQ4AMS8kbwA1t5JcBpwVoHZuQVeycWllv5wwVFQ0EFEAMoMFOQs5GixcMDUzDCkSMpaFaT53gCCysrAHqQAdPQIHIW1vqpq/oEERACScPzUhjLAAOaM0XAQ4XCoEBRw9JRQS32Rg9TCUKw4GAWmAougAJ6THLTKrzRbLNYQDb6LxFEo7AL+QDeBABOxpEZqtQ5wFakob3KDKKJvBjMZ6vZgQECkfrUK5wTB5b6xKGVOYLJZCVbrTao7ZKXb7XF2OBwwXCRHIrboiUBIA\">MWE on Lean web editor</a></del></p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<p>import Mathlib</p>\n<p>-- We want to use multiplicative notation for ZMod 2:<br>\nlocal notation \"‚Ñ§‚ÇÇ\" =&gt; Multiplicative (ZMod 2)</p>\n<p>-- But there is no \"-1\" notation<br>\n#check (1 : ‚Ñ§‚ÇÇ)<br>\n#check (-1 : ‚Ñ§‚ÇÇ) -- error</p>\n<p>-- So we use this instead:<br>\n#check (Additive.toMul (1 : ZMod 2))</p>\n<p>-- I cannot figure out how to write the inverse properly:<br>\n#check (Additive.toMul (1 : ZMod 2))‚Åª¬π -- error</p>\n<p>-- ...in order to show something like this:<br>\n#check (Additive.toMul (1 : ZMod 2))‚Åª¬π = Additive.toMul (1 : ZMod 2)</p>\n</div></div>",
        "id": 514388563,
        "sender_full_name": "Jeremy Lindsay",
        "timestamp": 1745590076
    },
    {
        "content": "<p>Something like the following? </p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>possible solution</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"c1\">-- We want to use multiplicative notation for ZMod 2:</span>\n<span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"kd\">notation</span><span class=\"w\"> </span><span class=\"s2\">\"‚Ñ§‚ÇÇ\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Multiplicative</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ZMod</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n\n<span class=\"c1\">-- But there is no \"-1\" notation</span>\n<span class=\"k\">#check</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñ§‚ÇÇ</span><span class=\"o\">)</span>\n<span class=\"k\">#check</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñ§‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- error</span>\n\n<span class=\"c1\">-- So we use this instead:</span>\n<span class=\"k\">#check</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Additive.toMul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ZMod</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">))</span>\n\n<span class=\"c1\">-- I cannot figure out how to write the inverse properly:</span>\n<span class=\"k\">#check</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Additive.toMul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñ§‚ÇÇ</span><span class=\"o\">))</span><span class=\"bp\">‚Åª¬π</span><span class=\"w\"> </span><span class=\"c1\">-- error</span>\n\n<span class=\"c1\">-- ...in order to show something like this:</span>\n<span class=\"k\">#check</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Additive.toMul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñ§‚ÇÇ</span><span class=\"o\">))</span><span class=\"bp\">‚Åª¬π</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Additive.toMul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñ§‚ÇÇ</span><span class=\"o\">)</span>\n</code></pre></div>\n</div></div>",
        "id": 514396563,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1745592589
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"653351\">Joseph Tooby-Smith</span> <a href=\"#narrow/channel/479953-PhysLean/topic/General.20questions/near/514396563\">said</a>:</p>\n<blockquote>\n<p>Something like the following?</p>\n</blockquote>\n<p>EDIT: I was a bit confused about what <code>Additive.toMul</code> does; will play around a bit more.</p>\n<p><del>But <code>(1 : ‚Ñ§‚ÇÇ)</code> (multiplicative) is the identity while <code>(1 : ZMod 2)</code> (additive) isn't, right?</del></p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>Header</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<p>example : Additive.toMul (1 : ‚Ñ§‚ÇÇ) = Additive.toMul (1 : ZMod 2) := by rfl -- fails</p>\n</div></div>",
        "id": 514403498,
        "sender_full_name": "Jeremy Lindsay",
        "timestamp": 1745594671
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"s2\">\"Z\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Multiplicative</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ZMod</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">ofAdd</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"bp\">‚Åª¬π</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofAdd</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">ofAdd_neg</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"c1\">-- via rw?</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ZMod</span><span class=\"bp\">.</span><span class=\"n\">neg_eq_self_mod_two</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"c1\">-- via rw?</span>\n</code></pre></div>",
        "id": 514408529,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1745596121
    },
    {
        "content": "<p><code>toMul 1 = 0</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"s2\">\"Z\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Multiplicative</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ZMod</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofAdd</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 514409234,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1745596350
    },
    {
        "content": "<p>The goal at the sorry in the repo (which I've now downloaded) is not well-typed, so something has gone wrong. The goal is</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">‚ä¢</span><span class=\"w\"> </span><span class=\"n\">Additive</span><span class=\"bp\">.</span><span class=\"n\">toMul</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Additive</span><span class=\"bp\">.</span><span class=\"n\">toMul</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>\n<p>but <code>Additive.toMul : Additive (Fin 2) ‚âÉ Fin 2</code> and <code>1 : Fin 2</code> so there is some defeq abuse going on which will inevitably make things harder. </p>\n<p>It looks to me like the defeq abuse is introduced in the line</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hŒõ_neg_1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">orthchroRep</span><span class=\"w\"> </span><span class=\"n\">Œõ</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Additive</span><span class=\"bp\">.</span><span class=\"n\">toMul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ZMod</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>. This should surely say</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hŒõ_neg_1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">orthchroRep</span><span class=\"w\"> </span><span class=\"n\">Œõ</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Multiplicative</span><span class=\"bp\">.</span><span class=\"n\">ofAdd</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ZMod</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>Once this change is made, everything is type correct and the proof of the goal at the sorry is just <code>rfl</code>.</p>",
        "id": 514446551,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1745608596
    }
]