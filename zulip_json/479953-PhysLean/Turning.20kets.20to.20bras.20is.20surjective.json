[
    {
        "content": "<p>I've over the last few days been trying to improve the API around quantum mechanics (using unbounded operators and generalized eigenvectors etc), in particular for 1d systems. </p>\n<p>There is one result that I don't know how to prove: The conversion of a ket <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">‚à£</mi><mi>œà</mi><mo stretchy=\"false\">‚ü©</mo></mrow><annotation encoding=\"application/x-tex\">|\\psi\\rangle</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">‚à£</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">œà</span><span class=\"mclose\">‚ü©</span></span></span></span> into a bra <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">‚ü®</mo><mi>œà</mi><mi mathvariant=\"normal\">‚à£</mi></mrow><annotation encoding=\"application/x-tex\">\\langle \\psi |</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">‚ü®</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">œà</span><span class=\"mord\">‚à£</span></span></span></span> is surjective. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">L2Space</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">SpecialFunctions</span><span class=\"bp\">.</span><span class=\"n\">Gaussian</span><span class=\"bp\">.</span><span class=\"n\">GaussianIntegral</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">QuantumMechanics</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">OneDimension</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">section</span>\n\n<span class=\"sd\">/-- The Hilbert space for a one dimensional quantum system is defined as</span>\n<span class=\"sd\">  the space of almost-everywhere equal equivalence classes of square integrable functions</span>\n<span class=\"sd\">  from `‚Ñù` to `‚ÑÇ`. -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">HilbertSpace</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">Lp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">HilbertSpace</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">InnerProductSpace</span>\n\n<span class=\"sd\">/-- The anti-linear map from the Hilbert space to it's dual. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">toBra</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HilbertSpace</span><span class=\"w\"> </span><span class=\"bp\">‚Üí‚Çõ‚Çó</span><span class=\"o\">[</span><span class=\"n\">starRingEnd</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">Dual</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"n\">HilbertSpace</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">‚ü™</span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"bp\">‚ü´_</span><span class=\"n\">‚ÑÇ</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">map_add'</span><span class=\"w\"> </span><span class=\"n\">g1</span><span class=\"w\"> </span><span class=\"n\">g2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inner_add_right</span><span class=\"o\">],</span>\n<span class=\"w\">    </span><span class=\"n\">map_smul'</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inner_smul_right</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"n\">map_add'</span><span class=\"w\"> </span><span class=\"n\">f1</span><span class=\"w\"> </span><span class=\"n\">f2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">g</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inner_add_left</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">map_smul'</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">g</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inner_smul_left</span><span class=\"o\">]</span>\n\n<span class=\"sd\">/-- The anti-linear map, `toBra`, taking a ket to it's corresponding</span>\n<span class=\"sd\">  bra is surjective. -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">toBra_surjective</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">toBra</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>I believe this is related to the 'Riesz representation theorem', but generally, does anyone know how one can fill in the above <code>sorry</code>?</p>",
        "id": 527640890,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1751966762
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">SpecialFunctions</span><span class=\"bp\">.</span><span class=\"n\">Gaussian</span><span class=\"bp\">.</span><span class=\"n\">GaussianIntegral</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">InnerProductSpace</span><span class=\"bp\">.</span><span class=\"n\">Dual</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">L2Space</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">QuantumMechanics</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">OneDimension</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">section</span>\n\n<span class=\"sd\">/-- The Hilbert space for a one dimensional quantum system is defined as</span>\n<span class=\"sd\">  the space of almost-everywhere equal equivalence classes of square integrable functions</span>\n<span class=\"sd\">  from `‚Ñù` to `‚ÑÇ`. -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">HilbertSpace</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">Lp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">HilbertSpace</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">InnerProductSpace</span>\n\n<span class=\"sd\">/-- The anti-linear map from the Hilbert space to it's dual. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">toBra</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HilbertSpace</span><span class=\"w\"> </span><span class=\"bp\">‚Üí‚Çõ‚Çó</span><span class=\"o\">[</span><span class=\"n\">starRingEnd</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">NormedSpace</span><span class=\"bp\">.</span><span class=\"n\">Dual</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"n\">HilbertSpace</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">InnerProductSpace</span><span class=\"bp\">.</span><span class=\"n\">toDual</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"n\">HilbertSpace</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">toBra_apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HilbertSpace</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">toBra</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‚ü™</span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"bp\">‚ü´_</span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n\n<span class=\"sd\">/-- The anti-linear map, `toBra`, taking a ket to it's corresponding</span>\n<span class=\"sd\">  bra is surjective. -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">toBra_surjective</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">toBra</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">InnerProductSpace</span><span class=\"bp\">.</span><span class=\"n\">toDual</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"n\">HilbertSpace</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">surjective</span>\n</code></pre></div>",
        "id": 527650785,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1751969967
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span> it's not true if you use the <code>Module.Dual</code>, because that dual doesn't care about the topology; you get the correct statement using <code>NormedSpace.Dual</code> instead.</p>",
        "id": 527650857,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1751969991
    },
    {
        "content": "<p>A few more details: most of the elements of <code>Module.Dual</code> are linear but non-continuous maps from <code>HilbertSpace</code> to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">C</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{C}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">C</span></span></span></span>. If you don't consider the topology, then the moment you're in infinite dimension the following phenomenon occurs. A general theorem of algebra (which needs the axiom of choice in infinite dimensions, and in Lean probably uses it in finite dimensions too) says that every vector space has an <em>algebraic</em> basis. More precisely, there is some collection <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>b</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mn>3</mn></msub><mo separator=\"true\">,</mo><mo>‚Ä¶</mo></mrow><annotation encoding=\"application/x-tex\">b_1,b_2,b_3,\\ldots</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">‚Ä¶</span></span></span></span> of elements of the space such that every element of the space is a <strong>finite</strong> linear combination of basis elements. Actually this is not great notation because often the basis will be uncountably infinite so can't even be indexed by the naturals. Remember that we have completely forgotten the topology here so there is not even a concept of an infinite sum because there is no notion of limit. However you can algebraically take infinite sums in the dual space, for example there's a perfectly good map from a vector space with basis <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>b</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mn>3</mn></msub><mo separator=\"true\">,</mo><mo>‚Ä¶</mo></mrow><annotation encoding=\"application/x-tex\">b_1,b_2,b_3,\\ldots</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">‚Ä¶</span></span></span></span> to the complex numbers which sends all the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">b_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> to 1, because then you can make sense of what happens to a <strong>finite</strong> linear combination of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">b_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>. So \"the space only has finite sums but the dual has infinite sums\" -- more formally the algbebraic dual of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>‚®Å</mo><mrow><mi>i</mi><mo>‚àà</mo><mi>I</mi></mrow></msub><mi mathvariant=\"double-struck\">C</mi></mrow><annotation encoding=\"application/x-tex\">\\bigoplus_{i\\in I}\\mathbb{C}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0771em;vertical-align:-0.3271em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">‚®Å</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1786em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">‚àà</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span></span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3271em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbb\">C</span></span></span></span> is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>‚àè</mo><mrow><mi>i</mi><mo>‚àà</mo><mi>I</mi></mrow></msub><mi mathvariant=\"double-struck\">C</mi></mrow><annotation encoding=\"application/x-tex\">\\prod_{i\\in I}\\mathbb{C}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0771em;vertical-align:-0.3271em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">‚àè</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1786em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">‚àà</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span></span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3271em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbb\">C</span></span></span></span> which is much bigger (the first only has finite linear combinations, the second allows infinite ones). In infinite dimensions you need the topology to rescue the situation.</p>",
        "id": 527652338,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1751970474
    },
    {
        "content": "<p>Ok, thank you so much both! This makes sense to me, I think the fact I couldn't find this result in Mathlib was probably a hint that I was doing something wrong. Annoyingly this means I now have to go an upgrade a bunch of linear maps to continuous linear map - but so is life.</p>",
        "id": 527653231,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1751970756
    },
    {
        "content": "<p>I'm trying to make the necessary changes to account for the topology and one thing I am now stuck on is defining the following continuous linear map:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"c1\">-- SchwartzMap.toLpCLM ‚ÑÇ ‚ÑÇ 2 MeasureTheory.volume</span>\n<span class=\"c1\">-- is a injective continuous linear map with domain `SchwartzMap ‚Ñù ‚ÑÇ`.</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">schwartzSubmoduleEquiv</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">SchwartzMap</span><span class=\"bp\">.</span><span class=\"n\">toLpCLM</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">volume</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">‚âÉ</span><span class=\"n\">L</span><span class=\"o\">[</span><span class=\"n\">‚ÑÇ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">SchwartzMap</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Basically that there is a continuous linear map between the sub-module of AE equal equivalence classes of square-integrable functions that can be represented by Schwartz maps and the module of Schwartz maps itself.</p>\n<p>Defining a <em>continuous linear map</em> in the inverse direction  <code>SchwartzMap ‚Ñù ‚ÑÇ </code> to <code>LinearMap.range _</code> is easy. Defining a <em>linear map</em> in the forward direction is also easy through choice, but I am stuck showing that this map is continuous. </p>\n<p>I believe the existence of such a map comes down to whether or not <code>SchwartzMap.toLpCLM</code> is a topological embedding, but maybe I am missing something completely obvious here.</p>",
        "id": 527811448,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1752040019
    },
    {
        "content": "<p>Maybe this is a question for <a class=\"stream\" data-stream-id=\"217875\" href=\"/#narrow/channel/217875-Is-there-code-for-X.3F\">#Is there code for X?</a> ?</p>",
        "id": 527812395,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1752040629
    },
    {
        "content": "<p>(done here <a class=\"stream-topic\" data-stream-id=\"217875\" href=\"/#narrow/channel/217875-Is-there-code-for-X.3F/topic/Inclusion.20of.20Schwartz.20maps.20into.20L2/with/527813771\">#Is there code for X? &gt; Inclusion of Schwartz maps into L2</a> )</p>",
        "id": 527813804,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1752041418
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span> are you sure you want this map? I tried to define it but I keep getting instance errors.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"c1\">-- SchwartzMap.toLpCLM ‚ÑÇ ‚ÑÇ 2 MeasureTheory.volume</span>\n<span class=\"c1\">-- is a injective continuous linear map with domain `SchwartzMap ‚Ñù ‚ÑÇ`.</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">SchwartzMap</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">schwartzMapEquivRange</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">ùì¢</span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚âÉ‚Çó</span><span class=\"o\">[</span><span class=\"n\">‚ÑÇ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">toLpCLM</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">volume</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">LinearEquiv</span><span class=\"bp\">.</span><span class=\"n\">ofInjective</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">injective_toLp</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">volume</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">schwartzMapCtsEquivRange</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">ùì¢</span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚âÉ</span><span class=\"n\">L</span><span class=\"o\">[</span><span class=\"n\">‚ÑÇ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">toLpCLM</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">volume</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">__</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">schwartzMapEquivRange</span>\n<span class=\"w\">  </span><span class=\"n\">continuous_toFun</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">continuous_invFun</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>(btw, you shouldn't use tactics in definitions)</p>\n<p>And also upon investigating further, I'm now not even sure if this is true! There are two issues here:</p>\n<ol>\n<li>This is a bit of a minor issue, but LinearMap.range gives you a subspace and subspaces might not be very well-behaved.</li>\n<li>I see that the Schwarz space doesn't seem to have a norm, but rather a seminorm?</li>\n<li>I looked at the norm-properties of <code>toLpCLM</code> (mathematically, continuous means something like preserve norm up to constant), and I only found <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Distribution/SchwartzSpace.html#SchwartzMap.norm_toLp_le_seminorm\">SchwartzMap.norm_toLp_le_seminorm</a></li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ùì¢</span><span class=\"o\">(</span><span class=\"n\">E</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">)),</span><span class=\"w\"> </span><span class=\"bp\">‚Äñ</span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">toLp</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"bp\">‚Äñ</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span>\n<span class=\"w\">      </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">Iic</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">k</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">sup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">schwartzSeminormFamily</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">f</span>\n</code></pre></div>\n<p>In particular, it seems like there's no bound in the other direction?</p>\n<ol start=\"4\">\n<li>What is the use case of this? Why isn't <code>toLp</code> enough? Why do you need to make it a continuous linear equiv?</li>\n</ol>",
        "id": 527834435,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752049785
    },
    {
        "content": "<p>Mathematically, the question is, can I construct a sequence of functions whose L2 norm go to 0 but whose Schwarz seminorm go to infinity? This seems to be possible, because the L2 norm is only about the area, but the Schwarz seminorm wants to look at derivatives</p>",
        "id": 527836142,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752050338
    },
    {
        "content": "<p>for example, I can keep my function bounded (i.e. f(x)=0 for |x|&gt;1), and let its area go to 0, but introduce more and more \"wiggles\" so that its derivative goes to infinity?</p>",
        "id": 527836400,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752050412
    },
    {
        "content": "<blockquote>\n<p>(btw, you shouldn't use tactics in definitions)</p>\n</blockquote>\n<p>Yeah - sorry the <code>:= by sorry</code> a muscle memory to finish the line :). </p>\n<p>Given what you and Kevin said above, I would be surprised is this is not true. I'm essentially trying to work with the rigged Hilbert space defined in this <a href=\"https://en.wikipedia.org/wiki/Rigged_Hilbert_space#Functional_analysis_approach\">wikipedia</a> page. </p>\n<p>The use case is to define e.g. the momentum operator or the position operator in QM as unbounded operators, defined on the submodule of the Hilbert space</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Œ¶</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">toLpCLM</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">volume</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>The current way they are defined in PhysLean are by converting elements in this submodule to Schwartz maps using <code>schwartzSubmoduleEquiv</code>  and taking e.g. their derivative there. See <a href=\"https://github.com/HEPLean/PhysLean/blob/8d3fe54d662d66985db17fa4f4ac8951d926034a/PhysLean/QuantumMechanics/OneDimension/Operators/Momentum.lean#L79\">here</a> for the case of the momentum operator. But this is currently defined as a linear map not a continuous linear map, which I think is what is needed.</p>\n<p>Basically <code>schwartzSubmoduleEquiv</code> lets you move away from the equivalence classes which are used to define the Lp space to concrete functions, allowing you to apply operations that physicists are typically use to.</p>",
        "id": 527837046,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1752050628
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"653351\">@Joseph Tooby-Smith</span> Note that the wikipedia page talks about a \"finer topology\", and that the \"inclusion Œ¶‚äÜH is continuous\", but nothing about any inverse. Note that \"finer topology\" means precisely that the inverse is not continuous.</p>\n<p>For example, if you take a standard bump function B(x), then it would be bounded, so it's automatically in Schwarz. But bounded smooth functions have horrible derivatives (citation needed), so you can see that the derivatives of B(x) go to infinity.</p>\n<p>Then, I can just take the sequence 1/n B(x), then its L2 norm will go to 0, but each norm ||1/n B(x)|| is infinity, so it doesn't converge to 0.</p>\n<p>Demonstration:<br>\n<a href=\"https://www.desmos.com/calculator/cbxbi5wemf\">https://www.desmos.com/calculator/cbxbi5wemf</a></p>",
        "id": 527838764,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752051165
    },
    {
        "content": "<p>i think in the wikipedia nothing is said (or required) about continuity of an¬†<strong>inverse</strong>¬†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi><mo>‚Üí</mo><mi mathvariant=\"normal\">Œ¶</mi></mrow><annotation encoding=\"application/x-tex\">H‚ÜíŒ¶</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Œ¶</span></span></span></span> . When wikipedia stresses that Œ¶ has a strictly stronger topology than H, it seems to mean that the inclusion¬†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>ùì¢</mtext><mo>‚Ü™</mo><mi>L</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">ùì¢‚Ü™L2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.522em;vertical-align:-0.011em;\"></span><span class=\"mord\">ùì¢</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Ü™</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord\">2</span></span></span></span>¬†is the continuum-embedding, so no continuous inverse seems to be mentioned or implied/required.<br>\nAnd if there is no requirement for a topological equivalence between¬†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>ùì¢</mtext></mrow><annotation encoding=\"application/x-tex\">ùì¢</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0em;\"></span><span class=\"mord\">ùì¢</span></span></span></span>¬†and that range, there seems to be no contradiction in the fact that Lean refuses to produce a¬†<code>‚âÉL</code>, ie the inverse</p>",
        "id": 527838773,
        "sender_full_name": "Matteo Cipollina",
        "timestamp": 1752051168
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"653351\">Joseph Tooby-Smith</span> <a href=\"#narrow/channel/479953-PhysLean/topic/Turning.20kets.20to.20bras.20is.20surjective/near/527837046\">said</a>:</p>\n<blockquote>\n<p>But this is currently defined as a linear map not a continuous linear map, which I think is what is needed.</p>\n<p>Basically <code>schwartzSubmoduleEquiv</code> lets you move away from the equivalence classes which are used to define the Lp space to concrete functions, allowing you to apply operations that physicists are typically use to.</p>\n</blockquote>\n<p>You basically have to always keep in mind that there are two <strong>different</strong> norms in the picture, and when you say continuous you have to always specify with respect to which norm.</p>\n<p>From my first look at it, it takes a derivative, so it should be continuous in the Schwarz norm but not in the L2 norm.</p>",
        "id": 527839940,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752051524
    },
    {
        "content": "<p>when mathematicians talk about embeddings they don't think twice about whether the original set and the embedded set is different (and in this case it actually matters, since there are two different topologies!)</p>\n<p>In this case for your momentum operator I would even argue that it's wrong to define it on Œ¶. I think you should define it on <code>ùì¢(‚Ñù, ‚ÑÇ)</code>.</p>",
        "id": 527840507,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752051681
    },
    {
        "content": "<p>Ok, I'm willing to accept this. But then I have the following conflict, which is, what is the correct definition of an unbounded continuous linear operator here?</p>\n<p>The nlab defines it  <a href=\"https://ncatlab.org/nlab/show/unbounded+operator\">here</a>  as </p>\n<blockquote>\n<p>An¬†<strong>unbounded operator</strong>¬†T¬†on a Hilbert space¬†‚Ñã¬†is a linear operator defined on a subspace¬†D¬†of¬†‚Ñã.¬†D¬†is necessarily a linear submanifold. </p>\n</blockquote>\n<p>And specifically gives the example of Schwartz maps and differentiation on that page. </p>\n<p>In Mathlib the definition of an unbounded (not necessarily continuous) operator is </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">LinearPMap</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">domain</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Submodule</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">E</span>\n<span class=\"w\">  </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">domain</span><span class=\"w\"> </span><span class=\"bp\">‚Üí‚Çó</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">F</span>\n</code></pre></div>\n<p>But from what I understand, the real definition we seem to want is that a continuous  unbounded linear operator is a continuous linear injection <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Œπ</mi><mo>:</mo><mi>S</mi><mo>‚Üí</mo><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">\\iota : S \\to M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">Œπ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span> (the 'submodule'), along with a continuous linear map <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo>:</mo><mi>S</mi><mo>‚Üí</mo><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">f : S \\to M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span> (the operator). Is it clear to anyone whether this is in agreement with the nlab definition?</p>",
        "id": 527842213,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1752052165
    },
    {
        "content": "<p>Yeah that sounds good to me.</p>",
        "id": 527843539,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752052566
    },
    {
        "content": "<p>(I should say that this last definition makes the category theoriest inside of me happy, because a <code>continuous linear injection</code> is a monomorphism in the category of topological vector spaces, and therefore this is the correct definition of a <code>subobject</code>).</p>",
        "id": 527843713,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1752052617
    },
    {
        "content": "<p>Someone should make a counter-example showing that derivative is not continuous in L2(R) and that the Schwarz norm is not continuous wrt the L2 norm</p>",
        "id": 527893640,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752069048
    },
    {
        "content": "<p>the bump function itself having infinite norm should also be a counterexample</p>",
        "id": 527893691,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752069065
    },
    {
        "content": "<p>Is it even clear how you would define the derivative for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>L</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi mathvariant=\"double-struck\">R</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L^2(\\mathbb{R})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathbb\">R</span><span class=\"mclose\">)</span></span></span></span> in general?</p>",
        "id": 527895332,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1752069509
    },
    {
        "content": "<p>I meant, on the wrong topology on S(R;C)</p>",
        "id": 527895562,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752069577
    },
    {
        "content": "<p>Ok, thanks for explaining. I agree such a counter-example would be nice to see.</p>",
        "id": 527895898,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1752069663
    },
    {
        "content": "<p>is there even a schwarz function that doesn't blow up?? (i'm not very familiar with functional analysis)</p>",
        "id": 527896572,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752069838
    },
    {
        "content": "<p>even the nicest exp(-x^2) still seems to have infinite norm?</p>",
        "id": 527896666,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752069869
    }
]