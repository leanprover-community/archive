[
    {
        "content": "<p>I think I can take care of <a href=\"https://github.com/lean-phys-community/PhysLean/issues/851\">issue#851</a> as part of my 'quest' to formalize the spectrum of hydrogen, but I have a couple of questions about design.</p>\n<p><a href=\"https://github.com/lean-phys-community/PhysLean/blob/master/PhysLean/QuantumMechanics/OneDimension/HilbertSpace/Basic.lean\">HilbertSpace/Basic.lean</a> and <a href=\"https://github.com/lean-phys-community/PhysLean/blob/master/PhysLean/QuantumMechanics/OneDimension/HilbertSpace/SchwartzSubmodule.lean\">HilbertSpace/SchwartzSubmodule.lean</a> for one dimension carry over to <code>Space d</code> essentially unchanged. However, should we consider a more descriptive name since there are other common Hilbert spaces in physics besides <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>L</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"double-struck\">R</mi><mi>d</mi></msup><mo separator=\"true\">,</mo><mi mathvariant=\"double-struck\">C</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L^2(\\mathbb{R}^d,\\mathbb{C})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0991em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbb\">C</span><span class=\"mclose\">)</span></span></span></span>?</p>\n<p>Also, I think there is an opportunity to 'mathlib-ify' <a href=\"https://github.com/lean-phys-community/PhysLean/blob/master/PhysLean/QuantumMechanics/OneDimension/Operators/Unbounded.lean\">Operators/Unbounded.lean</a>. For example, an unbounded operator could be defined as a special case of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=LinearPMap#doc\">docs#LinearPMap</a>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c1\">-- A `LinearPMap R E F` or `E →ₗ.[R] F` is a linear map from a submodule of `E` to `F`.</span>\n<span class=\"sd\">/-- An `UnboundedOperator` is a linear map from a submodule of `HilbertSpace d` to `HilbertSpace d`. -/</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">UnboundedOperator</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">LinearPMap</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">HilbertSpace</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">HilbertSpace</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">UnboundedOperator</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">domain</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Submodule</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">HilbertSpace</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">))</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">domain</span><span class=\"w\"> </span><span class=\"bp\">→ₗ</span><span class=\"o\">[</span><span class=\"n\">ℂ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">HilbertSpace</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">UnboundedOperator</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">LinearPMap</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">domain</span><span class=\"w\"> </span><span class=\"n\">toFun</span>\n\n<span class=\"c1\">-- etc.</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">UnboundedOperator</span>\n</code></pre></div>\n<p>Is there any reason not to take this approach?</p>",
        "id": 574422389,
        "sender_full_name": "Gregory Loges",
        "timestamp": 1771383804
    },
    {
        "content": "<p>I think in the future we will want <code>HilbertSpace</code> to be an instance that gets placed on a specific type because, as you said, there are other Hilbert spaces. However, at the moment we're happy with incremental improvements so I think doing this kind of upgrade isn't a bad thing as long as you realize it'll probably get changed again.</p>\n<p>I agree <code>LinearPMap</code> is probably the thing to use, but I think it would be smart to create a structure with a <code>LinearPMap</code> and a prop that the domain is dense since that seems to be a common assumption for operators that isn't in <code>LinearPMap</code> and is important to other nice properties of things like the adjoint.</p>\n<p>But all of this doesn't need to happen at once. I was thinking about this as well, so feel free to make whatever progress you want and more can be done later.</p>",
        "id": 574428623,
        "sender_full_name": "Daniel Morrison",
        "timestamp": 1771389512
    },
    {
        "content": "<p>Thanks, makes sense. Would a continuity assumption in the structure also be appropriate?</p>",
        "id": 574431380,
        "sender_full_name": "Gregory Loges",
        "timestamp": 1771391798
    },
    {
        "content": "<blockquote>\n<p>I think in the future we will want <code>HilbertSpace</code> to be an instance that gets placed on a specific type because,</p>\n</blockquote>\n<p>I'm somewhat surprised that Mathlib hasn't taken this approach. </p>\n<blockquote>\n<p>However, should we consider a more descriptive name since there are other common Hilbert spaces in physics besides <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mn>2</mn><mo stretchy=\"false\">(</mo><mi>R</mi><mi>d</mi><mo separator=\"true\">,</mo><mi>C</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L2(Rd,C)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal\">d</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mclose\">)</span></span></span></span>?</p>\n</blockquote>\n<p>I agree that a new name would be better <span class=\"user-mention\" data-user-id=\"1017284\">@Gregory Loges</span> , do you have any suggestions?</p>",
        "id": 574432035,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1771392351
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"1017284\">Gregory Loges</span> <a href=\"#narrow/channel/479953-PhysLean/topic/Hilbert.20space.20and.20unbounded.20operators/near/574431380\">said</a>:</p>\n<blockquote>\n<p>Thanks, makes sense. Would a continuity assumption in the structure also be appropriate?</p>\n</blockquote>\n<p>My understanding is the answer to that is no, because for linear maps continuity is equivalent to bounded which we specifically don't want.</p>",
        "id": 574433375,
        "sender_full_name": "Daniel Morrison",
        "timestamp": 1771393379
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"653351\">Joseph Tooby-Smith</span> <a href=\"#narrow/channel/479953-PhysLean/topic/Hilbert.20space.20and.20unbounded.20operators/near/574432035\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>I think in the future we will want <code>HilbertSpace</code> to be an instance that gets placed on a specific type because,</p>\n</blockquote>\n<p>I'm somewhat surprised that Mathlib hasn't taken this approach. </p>\n</blockquote>\n<p>I suspect the reason is that right now you can write down a Hilbert Space using inner product space + complete space instances and don't need to define another instance. I think for physics it makes sense to combine them, but I could also be wrong.</p>",
        "id": 574433855,
        "sender_full_name": "Daniel Morrison",
        "timestamp": 1771393803
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"653351\">Joseph Tooby-Smith</span> <a href=\"#narrow/channel/479953-PhysLean/topic/Hilbert.20space.20and.20unbounded.20operators/near/574432035\">said</a>:</p>\n<blockquote>\n<p>do you have any suggestions?</p>\n</blockquote>\n<p>Maybe something like <code>HilbertSpaceL2SpaceD</code> or just simply <code>L2SpaceD</code> to highlight the domain? I am envisioning also <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>L</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L^2([a,b])</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">([</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">])</span></span></span></span> for the infinite square well and other subsets of <code>Space d</code> in the future, with analogous names like <code>HilbertSpaceL2Interval</code> or <code>HilbertSpaceL2Circle</code>.</p>",
        "id": 574434286,
        "sender_full_name": "Gregory Loges",
        "timestamp": 1771394195
    },
    {
        "content": "<p>or <code>SpaceDHilbertSpace</code>? Do you think we need the <code>L2</code> in there as well?</p>",
        "id": 574442653,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1771399949
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"653351\">Joseph Tooby-Smith</span> <a href=\"#narrow/channel/479953-PhysLean/topic/Hilbert.20space.20and.20unbounded.20operators/near/574442653\">said</a>:</p>\n<blockquote>\n<p>Do you think we need the <code>L2</code> in there as well?</p>\n</blockquote>\n<p>My first thought was the amusing <code>HilbertSpaceSpaceD</code> so I thought to break it up a bit. But I like <code>SpaceDHilbertSpace</code> much more!</p>",
        "id": 574444752,
        "sender_full_name": "Gregory Loges",
        "timestamp": 1771400981
    }
]