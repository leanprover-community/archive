[
    {
        "content": "<p>I want to build an API  primarily around:  <code>Space (d1 + d2) ≃L[ℝ] Space d1 × Space d2</code>. There are a number of things I am a bit uncertain about in terms of how to build such an API, and would be very glad to hear opinions. </p>\n<ol>\n<li>What should the map <code>Space (d1 + d2) ≃L[ℝ] Space d1 × Space d2</code> be called? I would usually tend to something like <code>split</code>, but I don't think this is the best, and maybe there is a better 'physics' term.</li>\n<li>On top of defining <code>Space (d1 + d2) ≃L[ℝ] Space d1 × Space d2</code> is it best to separately define the individual projects <code>Space (d1 + d2) → L[ℝ] Space d1</code> etc. and inclusions <code>Space d1 → L[ℝ] Space (d1 + d2)</code>, or just the equivalence above. </li>\n</ol>\n<p>My plan with the API is to do things around e.g. differentiation and integration.</p>",
        "id": 555283605,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1763019574
    },
    {
        "content": "<p>Are d1 and d2 likely to be concrete natural numerals (e.g. 3) in practice, or variable naturals (e.g. n)? I ask because 1+3 is definitionally equal to 3+1 (if they're both naturals), but a+b is not definitionally equal to b+a so if you envisage applications where variables are involved you might instead want this to be <code>(h : d3 = d1 + d2) : Space (d3) ≃L[ℝ] Space d1 × Space d2</code> or else you might end up in dependent type hell.</p>",
        "id": 555335573,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1763035005
    },
    {
        "content": "<ol>\n<li>Something around the word <code>decoupled</code> looks more physics related than split. Not sure if it's correct in this context though</li>\n</ol>",
        "id": 555336217,
        "sender_full_name": "Alfredo Moreira-Rosa",
        "timestamp": 1763035211
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/479953-PhysLean/topic/API.20around.20.60Space.20.28d1.20.2B.20d2.29.60.20to.20.60Space.20d1.20x.20Space.20d2.60/near/555335573\">said</a>:</p>\n<blockquote>\n<p>Are d1 and d2 likely to be concrete natural numerals (e.g. 3) in practice, or variable naturals (e.g. n)? I ask because 1+3 is definitionally equal to 3+1 (if they're both naturals), but a+b is not definitionally equal to b+a so if you envisage applications where variables are involved you might instead want this to be <code>(h : d3 = d1 + d2) : Space (d3) ≃L[ℝ] Space d1 × Space d2</code> or else you might end up in dependent type hell.</p>\n</blockquote>\n<p>I think there will be mixture of other cases here, so maybe it is best to have something like <code>(h : d3 = d1 + d2 := rfl)</code>.</p>",
        "id": 555362002,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1763042219
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"942100\">Alfredo Moreira-Rosa</span> <a href=\"#narrow/channel/479953-PhysLean/topic/API.20around.20.60Space.20.28d1.20.2B.20d2.29.60.20to.20.60Space.20d1.20x.20Space.20d2.60/near/555336217\">said</a>:</p>\n<blockquote>\n<ol>\n<li>Something around the word <code>decoupled</code> looks more physics related than split. Not sure if it's correct in this context though</li>\n</ol>\n</blockquote>\n<p>Yeah, I don't think <code>decoupled</code> is quite the right context here. The only other word I can come up with is <code>slice</code>, by similarity with <code>time slice</code>.</p>",
        "id": 555362679,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1763042378
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/479953-PhysLean/topic/API.20around.20.60Space.20.28d1.20.2B.20d2.29.60.20to.20.60Space.20d1.20x.20Space.20d2.60/near/555335573\">said</a>:</p>\n<blockquote>\n<p>Are d1 and d2 likely to be concrete natural numerals (e.g. 3) in practice, or variable naturals (e.g. n)? I ask because 1+3 is definitionally equal to 3+1 (if they're both naturals), but a+b is not definitionally equal to b+a so if you envisage applications where variables are involved you might instead want this to be <code>(h : d3 = d1 + d2) : Space (d3) ≃L[ℝ] Space d1 × Space d2</code> or else you might end up in dependent type hell.</p>\n</blockquote>\n<p>I'd normally recommend against this, and instead introduce a <code>cast (h : d1 = d2) : Space d1 ≃L[ℝ] Space d2</code></p>",
        "id": 555364338,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1763042796
    },
    {
        "content": "<p>Otherwise it ends up very annoying to write API lemmas</p>",
        "id": 555364442,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1763042816
    },
    {
        "content": "<p>Hmm, there is a lot of stuff in PhysLean so far using <code>Space d</code> and we have never needed to cast as of yet. <br>\nI'm wondering if I'm aiming for something too general here, and maybe all we actually need is <code>Space d.succ ≃L[ℝ] Space 1 × Space d</code>. This would be a sacrifice of generality for ease of use.</p>",
        "id": 555407740,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1763052524
    },
    {
        "content": "<p>Given that <code>d.succ := d + 1</code> I would be tempted to write it as <code>Space d × Space 1</code> but I'm not sure it matters that much :-) I would trust Eric's opinions over mine when it comes to dependent type hell.</p>",
        "id": 555634107,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1763138574
    },
    {
        "content": "<p>Consider that you might want this to be a <code>LinearIsometryEquiv</code> instead of a <code>ContinuousLinearEquiv</code>, which is stronger. (This will require making sure you're getting the correct metric inferred on <code>Space d1 × Space d2</code>, first.)</p>",
        "id": 556626583,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1763232993
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"448405\">@Alex Meiburg</span> Yeah, I somehow think the default metric is not going to be correct, since I believe the norm on products of types is defined by taking the maximum of the norms of both factors (for example). </p>\n<p>But nevertheless there are certainly places in where <code>ContinuousLinearEquiv</code> has been used, where in fact <code>LinearIsometryEquiv</code> could have been used.</p>",
        "id": 556629260,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1763235405
    },
    {
        "content": "<p>Yeah, that's the default metric on a Prod, but you could explore adding a higher priority instance (maybe especially just for Space x Space)</p>",
        "id": 556629348,
        "sender_full_name": "Alex Meiburg",
        "timestamp": 1763235482
    },
    {
        "content": "<p>This idea is very brittle. The moment you use a lemma which applies for general normed spaces you pick up the wrong typeclass, you can't fix this with priority hacks.</p>",
        "id": 556643229,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1763249516
    },
    {
        "content": "<p>Are you aware of <code>WithLp</code>? in particular, you probably want to use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PiLp.sumPiLpEquivProdLpPiLp#doc\">docs#PiLp.sumPiLpEquivProdLpPiLp</a></p>",
        "id": 556644688,
        "sender_full_name": "Moritz Doll",
        "timestamp": 1763251527
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"412682\">@Moritz Doll</span> ! I'll look into using this.</p>",
        "id": 556754634,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1763361020
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"412682\">Moritz Doll</span> <a href=\"#narrow/channel/479953-PhysLean/topic/API.20around.20.60Space.20.28d1.20.2B.20d2.29.60.20to.20.60Space.20d1.20x.20Space.20d2.60/near/556644688\">said</a>:</p>\n<blockquote>\n<p>Are you aware of <code>WithLp</code>? in particular, you probably want to use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PiLp.sumPiLpEquivProdLpPiLp#doc\">docs#PiLp.sumPiLpEquivProdLpPiLp</a></p>\n</blockquote>\n<p>Relatedly, I just start to attempt to bump PhysLean to v4.25.0, and noticed that the definition of <code>WithLp</code> has changed to a structure.</p>",
        "id": 556824510,
        "sender_full_name": "Joseph Tooby-Smith",
        "timestamp": 1763384593
    }
]