[
    {
        "content": "<p>You mentioned in the talk using an LLM based tool - Was this over an API or run locally?</p>",
        "id": 493651456,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1736882035
    },
    {
        "content": "<p>Very nice talk and tool! Are the slides linked somewhere</p>",
        "id": 493651809,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1736882167
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/INbUsSCYPalaw1tosTeIAxN5/TryAtEachStep-Lean-Together-2025.pdf\">TryAtEachStep Lean Together 2025.pdf</a></p>",
        "id": 493654537,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736883125
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"282271\">Bolton Bailey</span> <a href=\"#narrow/channel/474713-Lean-Together-2025/topic/David.20Renshaw.3A.20tryAtEachStep/near/493651456\">said</a>:</p>\n<blockquote>\n<p>You mentioned in the talk using an LLM based tool - Was this over an API or run locally?</p>\n</blockquote>\n<p>I tried <a href=\"https://github.com/lean-dojo/LeanCopilot\">LeanCopilot</a>, which uses a smallish local model.</p>",
        "id": 493654651,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736883166
    },
    {
        "content": "<p>I had to miss the talk (I'm on a plane).  Nice shout out to the PACT paper.</p>",
        "id": 493656931,
        "sender_full_name": "Jason Rute",
        "timestamp": 1736883940
    },
    {
        "content": "<p>Which parts of your talk reference LeanCopilot?  And if you did run LeanCopilot over much of mathlib, what is your impression of it as an automated proof solver?</p>",
        "id": 493657135,
        "sender_full_name": "Jason Rute",
        "timestamp": 1736884000
    },
    {
        "content": "<p>I hear that Kevin will have the talk uploaded to youtube shortly.</p>",
        "id": 493657951,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736884276
    },
    {
        "content": "<p>Is there a way to get a full list of command line options? If I run it with <code>--help</code> I get </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">uncaught</span><span class=\"w\"> </span><span class=\"n\">exception</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">usage</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tryAtEachStepInDirectory</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">OPTIONS</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">TACTIC</span><span class=\"w\"> </span><span class=\"n\">DIRECTORY</span>\n</code></pre></div>",
        "id": 493657962,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1736884280
    },
    {
        "content": "<p>I wanted to run LeanCopilot on Mathlib, but ran into ffi linker errors.</p>",
        "id": 493658014,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736884299
    },
    {
        "content": "<p>so that's future work</p>",
        "id": 493658033,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736884305
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"282271\">Bolton Bailey</span> <a href=\"#narrow/channel/474713-Lean-Together-2025/topic/David.20Renshaw.3A.20tryAtEachStep/near/493657962\">said</a>:</p>\n<blockquote>\n<p>Is there a way to get a full list of command line options? If I run it with <code>--help</code> I get </p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">uncaught</span><span class=\"w\"> </span><span class=\"n\">exception</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">usage</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tryAtEachStepInDirectory</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">OPTIONS</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">TACTIC</span><span class=\"w\"> </span><span class=\"n\">DIRECTORY</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>right now, reading the source code is your only option. :\\</p>",
        "id": 493658298,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736884384
    },
    {
        "content": "<p>expanding the help message and the README are TODOs</p>",
        "id": 493658347,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736884398
    },
    {
        "content": "<p><span aria-label=\"video camera\" class=\"emoji emoji-1f4f9\" role=\"img\" title=\"video camera\">:video_camera:</span> Video recording: <a href=\"https://youtu.be/67Ea9WbeAPI\">https://youtu.be/67Ea9WbeAPI</a></p>\n<div class=\"youtube-video message_inline_image\"><a data-id=\"67Ea9WbeAPI\" href=\"https://youtu.be/67Ea9WbeAPI\"><img src=\"https://uploads.zulipusercontent.net/74c0ea970af09d2b8fe4b3177235c7f1d84aaf2a/68747470733a2f2f692e7974696d672e636f6d2f76692f36374561395762654150492f64656661756c742e6a7067\"></a></div>",
        "id": 493685744,
        "sender_full_name": "Pietro Monticone",
        "timestamp": 1736895815
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/LmXWAY7xlosjKm2RKVN5poq8/RESULTS.json\">RESULTS.json</a></p>\n<p>^ results from an up-to-date mathlib, from running this command overnight</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$<span class=\"w\"> </span>lake<span class=\"w\"> </span>exe<span class=\"w\"> </span>tryAtEachStepInDirectory<span class=\"w\"> </span><span class=\"s2\">\"with_reducible exact?\"</span><span class=\"w\"> </span>.lake/packages/mathlib/Mathlib<span class=\"w\"> </span>-j<span class=\"w\"> </span><span class=\"m\">31</span>\n</code></pre></div>",
        "id": 493913938,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736943922
    },
    {
        "content": "<p>(someone requested that I share this data)</p>",
        "id": 493914047,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736943958
    },
    {
        "content": "<p>Was it Kim Morrison? In any case, thanks for sharing!</p>",
        "id": 493921706,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1736946154
    },
    {
        "content": "<p>By the way: I realised that it should be easy to write a Lean executable which reads RESULTS.json and patches your mathlib source with the suggestions. I could try to find time for that early next week.</p>",
        "id": 493921849,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1736946199
    },
    {
        "content": "<p>By the way: which mathlib revision was this generated on?</p>",
        "id": 493921881,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1736946210
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"243791\">@David Renshaw</span> Have you considered integrating this with <code>lake exe refactor</code> (which is in an open PR, I think)?</p>",
        "id": 493922283,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1736946318
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/474713-Lean-Together-2025/topic/David.20Renshaw.3A.20tryAtEachStep/near/493921881\">said</a>:</p>\n<blockquote>\n<p>By the way: which mathlib revision was this generated on?</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/commit/decffa078a6c8823ac43c261a07a4f8b2d4fad5f\">https://github.com/leanprover-community/mathlib4/commit/decffa078a6c8823ac43c261a07a4f8b2d4fad5f</a></p>",
        "id": 493922741,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736946470
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/474713-Lean-Together-2025/topic/David.20Renshaw.3A.20tryAtEachStep/near/493921706\">said</a>:</p>\n<blockquote>\n<p>Was it Kim Morrison? In any case, thanks for sharing!</p>\n</blockquote>\n<p>It was someone at <a href=\"http://gather.town\">gather.town</a> after the talk. Kim was not there. (Asleep presumably.)</p>",
        "id": 493922889,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736946514
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/channel/474713-Lean-Together-2025/topic/David.20Renshaw.3A.20tryAtEachStep/near/493922283\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"243791\">David Renshaw</span> Have you considered integrating this with <code>lake exe refactor</code> (which is in an open PR, I think)?</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/13973\">mathlib4#13973</a></p>",
        "id": 493923518,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736946709
    },
    {
        "content": "<p>I was not aware of that! Thanks for the pointer.</p>",
        "id": 493923605,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736946726
    },
    {
        "content": "<p>This morning, I managed to get <code>tryAtEachStep</code> working with <code>LeanCopilot</code>, using the following horrible invocation:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$<span class=\"w\"> </span><span class=\"nv\">LD_LIBRARY_PATH</span><span class=\"o\">=</span>./.lake/packages/aesop/.lake/build/lib:./.lake/packages/batteries/.lake/build/lib:./.lake/packages/LeanCopilot/.lake/build/lib:./.lake/build/lib:/home/dwrensha/.elan/toolchains/leanprover--lean4---v4.15.0/lib/lean:/home/dwrensha/.elan/toolchains/leanprover--lean4---v4.15.0/lib/<span class=\"w\"> </span><span class=\"se\">\\</span>\n<span class=\"w\">    </span><span class=\"nv\">LD_PRELOAD</span><span class=\"o\">=</span><span class=\"s2\">\"/home/dwrensha/.elan/toolchains/leanprover--lean4---v4.15.0/lib/lean/libInit_shared.so  /home/dwrensha/.elan/toolchains/leanprover--lean4---v4.15.0/lib/lean/libleanshared.so .lake/packages/LeanCopilot/.lake/build/lib/libLeanCopilot-1.so\"</span><span class=\"w\">  </span><span class=\"se\">\\</span>\n<span class=\"w\">    </span><span class=\"nb\">time</span><span class=\"w\"> </span>lake<span class=\"w\"> </span>exe<span class=\"w\"> </span>tryAtEachStepInDirectory<span class=\"w\"> </span><span class=\"s2\">\"aesop? (config := { maxRuleApplications := 40, maxRuleApplicationDepth := 3 }) (add 100% LeanCopilot.tacGen)\"</span><span class=\"w\"> </span>Compfiles<span class=\"w\"> </span>--imports<span class=\"w\"> </span>LeanCopilot<span class=\"w\"> </span>-j<span class=\"w\"> </span><span class=\"m\">1</span>\n</code></pre></div>",
        "id": 493951513,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736954320
    },
    {
        "content": "<p>I would be very happy to learn about a way to avoid those LD_LIBRARY_PATH and LD_PRELOAD things.</p>",
        "id": 493951735,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736954391
    },
    {
        "content": "<p>I've been letting LeanCopilot run on every proof step in Compfiles. It's going to take a long time for it to finish! Here's the best result it found so far:</p>\n<div class=\"codehilite\" data-code-language=\"Diff\"><pre><span></span><code><span class=\"gh\">index 98aa70d..9c5be72 100644</span>\n<span class=\"gd\">--- a/Compfiles/Poland1998P4.lean</span>\n<span class=\"gi\">+++ b/Compfiles/Poland1998P4.lean</span>\n<span class=\"gu\">@@ -241,17 +241,11 @@ lemma strengthen</span>\n<span class=\"w\"> </span>  obtain ⟨N0, hn0⟩ := he\n<span class=\"w\"> </span>  intro N\n<span class=\"w\"> </span>  induction' N with pn hpn\n<span class=\"gd\">-  · obtain (hlt : 0 &lt; N0) | (hlte : N0 ≤ 0) := lt_or_ge 0 N0</span>\n<span class=\"gd\">-    · exact ⟨N0, hlt, hn0⟩</span>\n<span class=\"gd\">-    · have heq : N0 = 0 := eq_bot_iff.mpr hlte</span>\n<span class=\"gd\">-      rw [heq] at hn0</span>\n<span class=\"gd\">-      exact h 0 hn0</span>\n<span class=\"gi\">+  · obtain ⟨M, left, right⟩ := h N0 hn0</span>\n<span class=\"gi\">+    exact ⟨M, pos_of_gt left, right⟩</span>\n<span class=\"w\"> </span>  · obtain ⟨m, hm, hmp⟩ := hpn\n<span class=\"gd\">-    obtain (hlt : pn + 1 &lt; m) |  (hlte : m ≤ pn + 1) := lt_or_ge (pn + 1) m</span>\n<span class=\"gd\">-    · exact ⟨m, hlt, hmp⟩</span>\n<span class=\"gd\">-    · have heq : m = pn + 1 := le_antisymm hlte hm</span>\n<span class=\"gd\">-      rw [heq] at hmp</span>\n<span class=\"gd\">-      exact h (pn.succ) hmp</span>\n<span class=\"gi\">+    obtain ⟨M, left, right⟩ := h m hmp</span>\n<span class=\"gi\">+    exact ⟨M, by omega, right⟩</span>\n\n<span class=\"w\"> </span>theorem poland1998_p4' : (∀ N : ℕ, ∃ M : ℕ, N &lt; M ∧ 7 ∣ a M) := by\n<span class=\"w\"> </span>  have he : 7 ∣ a 5 := by simp [a', a]\n</code></pre></div>\n<p>(<a href=\"https://github.com/dwrensha/compfiles/commit/7cc3a42d1c96507f581ce8880fe201b3c21a7f37\">commit 1</a> , <a href=\"https://github.com/dwrensha/compfiles/commit/abe992e36a5e7aa26661b6a8c141f37298626a75\">commit 2</a>).</p>",
        "id": 494011579,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736973369
    },
    {
        "content": "<p>And no, <code>aesop</code> alone does not find these improvements. I'm guessing the language model is needed to guess which arguments to pass to <code>h</code>.</p>",
        "id": 494012077,
        "sender_full_name": "David Renshaw",
        "timestamp": 1736973548
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"282271\">Bolton Bailey</span> <a href=\"#narrow/channel/474713-Lean-Together-2025/topic/David.20Renshaw.3A.20tryAtEachStep/near/493657962\">said</a>:</p>\n<blockquote>\n<p>Is there a way to get a full list of command line options? If I run it with <code>--help</code> I get </p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">uncaught</span><span class=\"w\"> </span><span class=\"n\">exception</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">usage</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tryAtEachStepInDirectory</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">OPTIONS</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">TACTIC</span><span class=\"w\"> </span><span class=\"n\">DIRECTORY</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>I added <code>--help</code> output: <a href=\"https://github.com/dwrensha/tryAtEachStep/commit/1338858a5dc5dc9faaba715e3f88514e912e087a\">https://github.com/dwrensha/tryAtEachStep/commit/1338858a5dc5dc9faaba715e3f88514e912e087a</a></p>",
        "id": 494149729,
        "sender_full_name": "David Renshaw",
        "timestamp": 1737035078
    }
]