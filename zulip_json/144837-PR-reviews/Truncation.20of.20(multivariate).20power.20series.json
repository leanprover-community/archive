[
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MvPowerSeries.trunc#doc\">docs#MvPowerSeries.trunc</a> truncates a multivariate power series by keeping exactly those coefficients which are strictly below some monomial. It is rarely (if ever) used in mathlib except in the one variable case, via <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PowerSeries.trunc#doc\">docs#PowerSeries.trunc</a>.</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/20958\">#20958</a> adds a variant <code>MvPowerSeries.trunc'</code> of this truncation process by keeping the coefficients which are below some monomial, possibly equal to it. It is genuinely distinct from the previous one, except in the one variable case since <code>f.trunc n.succ = f.trunc' n</code>.<br>\nWe need that variant for defining linear topologies on multivariate topologies. </p>\n<p>The question raised by <span class=\"user-mention\" data-user-id=\"268315\">@Anatole Dedecker</span>  is whether the new variant couldn't simply replace the former one. <span class=\"user-mention\" data-user-id=\"300245\">@Filippo A. E. Nuccio</span>, what do you think?</p>\n<p>(Of course, a further step could be done, by defining a general truncation API with respect to any subset of <code>σ →₀ ℕ</code> that is “lower-closed”, aka the complement of a filter, but I urge you not to suggest this.)</p>",
        "id": 495522839,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1737645357
    },
    {
        "content": "<p>Well, the only things that comes to mind is when we want to find representatives in the <code>MvPowerSeries</code> for a basis of a quotient by an ideal. If you're looking at <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi><mo stretchy=\"false\">[</mo><mtext> ⁣</mtext><mo stretchy=\"false\">[</mo><mi>X</mi><mo separator=\"true\">,</mo><mi>Y</mi><mo stretchy=\"false\">]</mo><mtext> ⁣</mtext><mo stretchy=\"false\">]</mo><mi mathvariant=\"normal\">/</mi><msup><mi>X</mi><mn>2</mn></msup><mo>⋅</mo><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">R[\\![X,Y]\\!]/X^2\\cdot Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mopen\">[</span><span class=\"mspace\" style=\"margin-right:-0.1667em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:-0.1667em;\"></span><span class=\"mclose\">]</span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> it seems to me that being able to truncate every mv power series to something which is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>&lt;</mo><msup><mi>X</mi><mn>2</mn></msup><mo>⋅</mo><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">&lt;X^2\\cdot Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> instead of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≤</mo></mrow><annotation encoding=\"application/x-tex\">\\leq</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≤</span></span></span></span> could be useful.</p>",
        "id": 495543997,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1737650860
    },
    {
        "content": "<p>Aha, indeed this perspective makes a ton of sense.</p>",
        "id": 495544238,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1737650914
    },
    {
        "content": "<p>IMHO \"getting rid\" of <code>trunc</code> is not really needed (whereas adding <code>trunc'</code> is certainly a great plus!)</p>",
        "id": 495544437,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1737650974
    },
    {
        "content": "<p>Worst case scenario: it will linger unused for a while...</p>",
        "id": 495544501,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1737650993
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"300245\">Filippo A. E. Nuccio</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/Truncation.20of.20.28multivariate.29.20power.20series/near/495543997\">said</a>:</p>\n<blockquote>\n<p>Well, the only things that comes to mind is when we want to find representatives in the <code>MvPowerSeries</code> for a basis of a quotient by an ideal. If you're looking at <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi><mo stretchy=\"false\">[</mo><mtext> ⁣</mtext><mo stretchy=\"false\">[</mo><mi>X</mi><mo separator=\"true\">,</mo><mi>Y</mi><mo stretchy=\"false\">]</mo><mtext> ⁣</mtext><mo stretchy=\"false\">]</mo><mi mathvariant=\"normal\">/</mi><msup><mi>X</mi><mn>2</mn></msup><mo>⋅</mo><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">R[\\![X,Y]\\!]/X^2\\cdot Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mopen\">[</span><span class=\"mspace\" style=\"margin-right:-0.1667em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:-0.1667em;\"></span><span class=\"mclose\">]</span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> it seems to me that being able to truncate every mv power series to something which is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>&lt;</mo><msup><mi>X</mi><mn>2</mn></msup><mo>⋅</mo><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">&lt;X^2\\cdot Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> instead of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≤</mo></mrow><annotation encoding=\"application/x-tex\">\\leq</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≤</span></span></span></span> could be useful.</p>\n</blockquote>\n<p>Not quite, you're abused by the 1-variable case. Remainders are much more complicated in the multivariate case. (For example <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mo>⋅</mo><msup><mi>Y</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">X\\cdot Y^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span> can't be reduced modulo <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>X</mi><mn>2</mn></msup><mo>⋅</mo><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">X^2\\cdot Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span>, you're forced to keep this monomial.)</p>",
        "id": 495545243,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1737651182
    },
    {
        "content": "<p>Oh, good point.</p>",
        "id": 495545422,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1737651241
    }
]