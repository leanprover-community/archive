[
    {
        "content": "<p>This PR defines <code>spanRank</code>, which is the minimum cardinality of generating set of a module. This will be used to develop the height theory of ideals in PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/21041\">#21041</a>.</p>",
        "id": 495835481,
        "sender_full_name": "Xuchun Li",
        "timestamp": 1737780874
    },
    {
        "content": "<p>On this PR by <span class=\"user-mention\" data-user-id=\"749375\">@Xuchun Li</span>, <span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span> suggested on github to define the notion for modules instead of submodules, because the rank is unrelated to any ambient space.</p>\n<p>For convenience, this is the main definition of the PR:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Semiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Cardinal</span>\n\n<span class=\"sd\">/-- The minimum cardinality of a generating set of a submodule as a cardinal. -/</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Submodule</span><span class=\"bp\">.</span><span class=\"n\">spanRank</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Submodule</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cardinal</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⨅</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">span</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">}),</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"n\">s</span>\n</code></pre></div>\n<p>I claim that defining it \"intrinsically\" for a module would amount to replacing <code>p</code> by <code>⊤</code> in this definition, because mathlibs spelling of <code>s : Set M</code> generates <code>M</code> is <code>Submodule.span R s = ⊤</code>. Hence the definition would probably be:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">spanRank</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cardinal</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⨅</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">Submodule</span><span class=\"bp\">.</span><span class=\"n\">span</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">}),</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"n\">s</span>\n</code></pre></div>\n<p>So it is just a special case of <code>Submodule.spanRank</code>. Since the main use case of this definition will be for ideals in a ring, I think it is good to stick with the <code>Submodule</code> version, this will cause significantly less friction than applying <code>Module.spanRank</code> to the ideal coerced to a type. If we want, we can then define</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">spanRank</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cardinal</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⊤</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Submodule</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">spanRank</span>\n</code></pre></div>\n<p>(Of course this is not very symmetric with how <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Module.rank#doc\">docs#Module.rank</a> is defined, but that one is defined in terms of a maximal linear independent family, for which mathlibs canonical spelling does not involve submodules.)</p>\n<p>What do people think?</p>",
        "id": 501900363,
        "sender_full_name": "Christian Merten",
        "timestamp": 1740513925
    },
    {
        "content": "<p>In topology <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsCompact#doc\">docs#IsCompact</a> is a predicate on subsets of a topological space, and compactness is unrelated to any ambient space but this concept has been in mathlib since 2017. The class <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CompactSpace#doc\">docs#CompactSpace</a> is just defined to be a one field structure with field <code>IsCompact (Set.univ : Set X)</code>. Similarly we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsComplete#doc\">docs#IsComplete</a> .</p>",
        "id": 501911268,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1740518174
    },
    {
        "content": "<p>My argument is that mathematically I never think about the rank of a submodule, but I am happy about compactness of a subspace (indeed there is the related notion of relative compactness). Of course this is just psychological and we can do both ways.</p>",
        "id": 501918121,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1740520971
    },
    {
        "content": "<p>On the other hand we have the rank of a module, and it seems strange to have two different approaches here.</p>",
        "id": 501918178,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1740521007
    },
    {
        "content": "<p>Anyway mine is not a strong opinion, so I am happy to change my mind, especially if this works better in practice.</p>",
        "id": 501918596,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1740521177
    },
    {
        "content": "<p>Aren't compactness and relative compactness the same? Or am I misunderstanding what you mean?</p>",
        "id": 501918603,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1740521181
    },
    {
        "content": "<p><a href=\"https://en.wikipedia.org/wiki/Relatively_compact_subspace?wprov=sfla1\">https://en.wikipedia.org/wiki/Relatively_compact_subspace?wprov=sfla1</a></p>",
        "id": 501918697,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1740521232
    },
    {
        "content": "<p>I mean this</p>",
        "id": 501918708,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1740521237
    },
    {
        "content": "<p>My point is that one often wants to relate compactness to the ambient space, and this is much less true (at least for me) for the rank of a module.</p>",
        "id": 501918936,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1740521342
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/stream/144837-PR-reviews/topic/.2320744.20the.20minimum.20cardinality.20of.20generating.20set/near/501918178\">said</a>:</p>\n<blockquote>\n<p>On the other hand we have the rank of a module, and it seems strange to have two different approaches here.</p>\n</blockquote>\n<p>Actually, in the context of PFR, it was really impractical for <code>Submodule.rank</code> not to exist (eg <code>gcongr</code> refuses to enter the type argument), so we made it a thing. I am planning to eventually PR it to mathlib</p>",
        "id": 501928866,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1740525896
    },
    {
        "content": "<p>Count that as a vote for the \"Have both\" solution</p>",
        "id": 501928902,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1740525915
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2320744.20the.20minimum.20cardinality.20of.20generating.20set/near/501918121\">said</a>:</p>\n<blockquote>\n<p>My argument is that mathematically I never think about the rank of a submodule</p>\n</blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"648495\">Christian Merten</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2320744.20the.20minimum.20cardinality.20of.20generating.20set/near/501900363\">said</a>:</p>\n<blockquote>\n<p>Since the main use case of this definition will be for ideals in a ring</p>\n</blockquote>\n<p>I think having both is fine. My impression is that these relative notions tend to pop up a bit more in formalization then in informal maths...</p>",
        "id": 501968009,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1740549046
    },
    {
        "content": "<p>Ah yes, we can of course have both versions. But this means duplicating the API?</p>",
        "id": 501989561,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1740559321
    },
    {
        "content": "<p>Concerning <a href=\"https://github.com/leanprover-community/mathlib4/pull/20744\">#20744</a> (that is ready to go besides this question), we can maybe add a comment saying the situation is currently asymmetric and a TODO.</p>",
        "id": 501990450,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1740559559
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2320744.20the.20minimum.20cardinality.20of.20generating.20set/near/501989561\">said</a>:</p>\n<blockquote>\n<p>Ah yes, we can of course have both versions. But this means duplicating the API?</p>\n</blockquote>\n<p>If we define it as</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">spanRank</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Cardinal</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⊤</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Submodule</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">spanRank</span>\n</code></pre></div>\n<p>I think the API duplication is not too bad?</p>",
        "id": 501999148,
        "sender_full_name": "Christian Merten",
        "timestamp": 1740562334
    },
    {
        "content": "<p>Yeah, you're right. Since the majority clearly thinks it is OK to talk about submodules I've delegated it (with a very minor last comment)</p>",
        "id": 502008092,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1740564866
    }
]