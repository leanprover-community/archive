[
    {
        "content": "<p>I've become sufficiently annoyed with having to write stuff like <code>ζ ∈ rootsOfUnity ⟨Fintype.card Rˣ, Fintype.card_pos⟩ R'</code> to actually try and refactor <code>rootsOfUnity</code> to eat a <code>Nat</code> instead of a <code>PNat</code>. See <a href=\"https://github.com/leanprover-community/mathlib4/pull/18516\">#18516</a>.</p>\n<p>It works quite smoothly (even though the PR touches 11 files; the main action is in <code>RingTheory.RootsOfUnity.Basic</code>, however) and still allows the results to be used with <code>PNat</code>s. Essentially, I replace <code>(n : ℕ+)</code> with <code>(n : ℕ) [NeZero n]</code> in the lemmas that actually need positivity of <code>n</code>; if used with a <code>PNat</code>, then it gets coerced to a <code>Nat</code>, for which the <code>NeZero</code> instance is available, so it (mostly) Just Works <span aria-label=\"trademark\" class=\"emoji emoji-2122\" role=\"img\" title=\"trademark\">:trademark:</span> </p>\n<p>Reviews welcome! (The diff is fairly large, but most changes are small and local.)</p>",
        "id": 480254093,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1730585449
    },
    {
        "content": "<p>Interesting! I felt like this was the big experiment to see if PNat was usable in practice and apparently we'd rather have NeZero.</p>",
        "id": 480271723,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1730603073
    },
    {
        "content": "<p><code>PNat</code> is actually pretty nice, if you can get it for free. For instance, I defined the run-length encoding of a <code>List α</code> as a <code>List (ℕ+ × α)</code> and everything went very nicely. </p>\n<p>If you have to provide <code>PNat</code> arguments yourself, that's when it becomes very annoying.</p>",
        "id": 480285697,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1730617826
    },
    {
        "content": "<p>We also thought PNat was a good idea in flt-regular, but at the end it was rather annoying, so I think it is a good idea. I don't have time today to have a look at the PR, but I will do it asap</p>",
        "id": 480292781,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1730625783
    },
    {
        "content": "<p>As a side note, when building Mathlib after changes to <code>RingTheory.RootsOfUnity.Basic</code>,  I was surprised how much depends on it; there were a lot of things that I would think do not actually need roots of unity. But trying to fix this would be a separate project.</p>",
        "id": 480297818,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1730630927
    },
    {
        "content": "<p>Thanks for doing this!<br>\n<img alt=\":merge:\" class=\"emoji\" src=\"https://avatars.zulip.com/3121/emoji/images/37577b95.png\" title=\"merge\"></p>",
        "id": 480389641,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1730708662
    }
]