[
    {
        "content": "<p>in this <a href=\"https://github.com/leanprover-community/mathlib4/pull/26436\">#26436</a>, I fueled the function <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.minFacAux#doc\">docs#Nat.minFacAux</a> so that now <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.minFac#doc\">docs#Nat.minFac</a> can be checked by decide.</p>",
        "id": 525897567,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1750942382
    },
    {
        "content": "<p>(There are compilations issues, I didn't expect <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.minFacAux#doc\">docs#Nat.minFacAux</a> to be used explicitly except in this initial file.)<br>\n(And of course, the cache problemâ€¦)</p>",
        "id": 525897983,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1750942476
    },
    {
        "content": "<p>This prompts a question for <span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> : I see that you have written a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PosNum#doc\">docs#PosNum</a> version  of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.minFac#doc\">docs#Nat.minFac</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PosNum.minFac#doc\">docs#PosNum.minFac</a>, which might make my thing useless, or, maybe I should adjust both definitions (the <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PosNum#doc\">docs#PosNum</a> looks more straightforward, but the induction uses square roots which I don't need). These are design choices, and I'll rely on you before moving forward (or closing the PR).</p>",
        "id": 525910141,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1750946011
    },
    {
        "content": "<p>I'm pretty sure the <code>PosNum</code> variant is significantly slower; <code>Nat</code> has special kernel support</p>",
        "id": 525910854,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1750946203
    },
    {
        "content": "<p>But is it fast in the virtual machine?</p>",
        "id": 525939832,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750954647
    },
    {
        "content": "<p>You mean <code>#eval</code>? Well I guess it adds an extra fuel check... Hmm having something <a href=\"https://github.com/leanprover/lean4/pull/7965\">lean4#7965</a> would really be nice...</p>",
        "id": 525944036,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1750956143
    },
    {
        "content": "<p>Btw I also have <a href=\"https://github.com/leanprover-community/mathlib4/pull/26284\">#26284</a>, which uses <code>Nat.minFacAux</code> directly</p>",
        "id": 525944308,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750956251
    },
    {
        "content": "<p><code>PosNum</code> was designed for fast kernel computation, but that was lean 3. In lean 4 <code>Nat</code> can now cheat so it wins the benchmarks and you should just use <code>Nat.minFac</code> for kernel computation</p>",
        "id": 526107521,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1751037812
    },
    {
        "content": "<p>OK, but should I rewrite <code>PosNum.minFac</code> so that it fits the new proposed version of <code>Nat.minFac</code>?</p>",
        "id": 526130148,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1751046728
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2326436.20-.20Fuel.20Nat.2EminFac/near/526107521\">said</a>:</p>\n<blockquote>\n<p><code>PosNum</code> was designed for fast kernel computation, but that was lean 3. In lean 4 <code>Nat</code> can now cheat so it wins the benchmarks and you should just use <code>Nat.minFac</code> for kernel computation</p>\n</blockquote>\n<p>Does this mean we should be removing <code>PosNum</code>?</p>",
        "id": 526178266,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1751087903
    },
    {
        "content": "<p>I think you should let me handle that</p>",
        "id": 526178277,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1751087923
    },
    {
        "content": "<p>(I'm not sure what I said is actually true, it needs testing. As this very PR points out, you can't use <code>Nat.minFac</code> right now in the kernel anyway, and most Nat functions are not written optimized for the kernel. That's exactly why they had to be replaced in the first place!)</p>",
        "id": 526178481,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1751088243
    }
]