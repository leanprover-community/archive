[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span> <span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> I feel like I haven't explained well what I meant by the official definition not mattering, so here's a more precise formulation:</p>",
        "id": 534024439,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755019009
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">LinearOrderedCommMonoidWithZero</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearOrderedCommMonoidWithZero</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Valuation</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Valuation</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">}</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Valuation</span><span class=\"bp\">.</span><span class=\"n\">IsEquiv</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">IsEquiv</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">pow</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hxy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hxz</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hyw</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">      </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hxz</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hyw</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">      </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hxz</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hyw</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">      </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">max</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Associated‚Çò</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">IsEquiv</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"o\">}</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">exists_eq</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hxy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"c1\">-- h.Associated‚Çò 0 0</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"c1\">-- h.Associated‚Çò 1 1</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"c1\">-- (hxz : h.Associated‚Çò x z) (hyw : h.Associated‚Çò y w) : h.Associated‚Çò (x * y) (z * w)</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">pow</span><span class=\"w\"> </span><span class=\"c1\">-- (hxy : h.Associated‚Çò x y) (n : ‚Ñï) : h.Associated‚Çò (x ^ n) (y ^ n)</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">exists_eq</span><span class=\"w\"> </span><span class=\"c1\">-- (hxy : h.Associated‚Çò x y) : ‚àÉ r, v‚ÇÅ r = x ‚àß v‚ÇÇ r = y</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Valuation</span><span class=\"bp\">.</span><span class=\"n\">IsEquiv</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span>\n</code></pre></div>",
        "id": 534024459,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755019020
    },
    {
        "content": "<p>I'm claiming that in the above code, no matter if you take these 7 constructors as the definition, or take only <code>value</code> as definition (and then prove the other constructors afterwards), the 5 <code>#check</code>s above would not change, so the API stays the same.</p>",
        "id": 534024541,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755019058
    },
    {
        "content": "<p>maybe you should write an induction principle too</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">elab_as_elim</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">induction_eliminator</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">cases_eliminator</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">valueRec</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">value</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hxy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">motive</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hxy</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">r</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">exists_eq</span><span class=\"w\"> </span><span class=\"n\">hxy</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"n\">r</span>\n</code></pre></div>",
        "id": 534025743,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755019590
    },
    {
        "content": "<p>yeah that's part 2 of the argument, the only thing that would change is what you get when you do <code>cases</code> or <code>induction</code>, but even these two can be changed via the new (to me) command</p>",
        "id": 534025869,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755019639
    },
    {
        "content": "<p>I think my comment in that PR was more along the lines of \"do we really need more than one definition here\"; indeed the API is one of the thing that matters, but if you can make the thing behind it half the size then that might be an argument to change the definition</p>",
        "id": 534025925,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755019665
    },
    {
        "content": "<p>I don't think any work is created or destroyed when we change definition</p>",
        "id": 534025976,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755019685
    },
    {
        "content": "<p>Is <code>exists_eq</code> an <code>Iff</code> in reality?</p>",
        "id": 534025998,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755019694
    },
    {
        "content": "<p>It's not half the size though? You're still proving all the same theorems</p>",
        "id": 534025999,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755019694
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2328072.20tactic.20for.20equivalent.20valuations/near/534025998\">said</a>:</p>\n<blockquote>\n<p>Is <code>exists_eq</code> an <code>Iff</code> in reality?</p>\n</blockquote>\n<p>yes, the other direction is called <code>value</code></p>",
        "id": 534026029,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755019709
    },
    {
        "content": "<p>I think this approach is the nicest to prove, for me at least (even though 1 minute ago I just said no work is created or destroyed)</p>",
        "id": 534026102,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755019741
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2328072.20tactic.20for.20equivalent.20valuations/near/534026029\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2328072.20tactic.20for.20equivalent.20valuations/near/534025998\">said</a>:</p>\n<blockquote>\n<p>Is <code>exists_eq</code> an <code>Iff</code> in reality?</p>\n</blockquote>\n<p>yes, the other direction is called <code>value</code></p>\n</blockquote>\n<p>Can you add the Iff to the PR to prove that?</p>",
        "id": 534026204,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755019781
    },
    {
        "content": "<blockquote>\n<p>so the API stays the same.</p>\n</blockquote>\n<p>The point is that the statement of <code>Associated‚Çò.rec</code> is part of the exposed API too, and the statement of this has unnecessary hypotheses, so changing the constructors means the exposed API becomes easier to use.</p>",
        "id": 534026210,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1755019787
    },
    {
        "content": "<p>And if you remove the inductive types altogether then you have more freedom in the recursors than an inductive type would give you</p>",
        "id": 534026466,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755019867
    },
    {
        "content": "<p>If it's not an inductive then you get no recursor?</p>",
        "id": 534026730,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755019959
    },
    {
        "content": "<p>You are free to write your own <code>@[elab_as_elim]</code> theorem</p>",
        "id": 534026790,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755019985
    },
    {
        "content": "<p>this is true of inductive types too</p>",
        "id": 534026822,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755019999
    },
    {
        "content": "<p>ok, what about this definition?</p>",
        "id": 534026836,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755020008
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Valuation</span><span class=\"bp\">.</span><span class=\"n\">IsEquiv</span>\n\n<span class=\"kn\">section</span><span class=\"w\"> </span><span class=\"n\">Monoid</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearOrderedCommMonoidWithZero</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearOrderedCommMonoidWithZero</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Valuation</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Valuation</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">}</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">IsEquiv</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated‚Çò</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Monoid</span>\n\n<span class=\"kn\">section</span><span class=\"w\"> </span><span class=\"n\">Group</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearOrderedCommGroupWithZero</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearOrderedCommGroupWithZero</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Valuation</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Valuation</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">}</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">Associated</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">IsEquiv</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">val_div_val</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Group</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Valuation</span><span class=\"bp\">.</span><span class=\"n\">IsEquiv</span>\n</code></pre></div>",
        "id": 534026838,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755020010
    },
    {
        "content": "<p>I would prefer if we agree on one definition, so that I won't have to change it again</p>",
        "id": 534026863,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755020021
    },
    {
        "content": "<p>Why does it need to be an inductive, can't it just be a <code>def</code>? Or a one-field structure, if you want to enforce no defeq abuse</p>",
        "id": 534026967,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1755020071
    },
    {
        "content": "<p>(Also you mentioned in the past privately that you don't want to assume group?)</p>",
        "id": 534027010,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1755020088
    },
    {
        "content": "<p>it doesn't need to be anything</p>",
        "id": 534027012,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755020089
    },
    {
        "content": "<p>I don't know the math here; do we really need a different definition for a monoid?</p>",
        "id": 534027022,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755020094
    },
    {
        "content": "<p>the priority here is to make the theorems easy to prove</p>",
        "id": 534027037,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755020099
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2328072.20tactic.20for.20equivalent.20valuations/near/534026967\">said</a>:</p>\n<blockquote>\n<p>Why does it need to be an inductive, can't it just be a <code>def</code>? Or a one-field structure, if you want to enforce no defeq abuse</p>\n</blockquote>\n<p>if you want the elab_as_elim later anyway, this is exactly the form the eliminator would take</p>",
        "id": 534027075,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755020113
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2328072.20tactic.20for.20equivalent.20valuations/near/534027022\">said</a>:</p>\n<blockquote>\n<p>I don't know the math here; do we really need a different definition for a monoid?</p>\n</blockquote>\n<p>Aaron asked this in the PR, and my answer was that you needed it because there is no cancellation axiom in the LOCMonoidWZ</p>",
        "id": 534027136,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755020146
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2328072.20tactic.20for.20equivalent.20valuations/near/534027010\">said</a>:</p>\n<blockquote>\n<p>(Also you mentioned in the past privately that you don't want to assume group?)</p>\n</blockquote>\n<p>yes, there are two definitions here</p>",
        "id": 534027240,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755020195
    },
    {
        "content": "<p>And so <code>‚àÉ r‚ÇÅ r‚ÇÇ, v‚ÇÅ r‚ÇÅ = x * v‚ÇÅ r‚ÇÇ ‚àß v‚ÇÇ r‚ÇÅ = y * v‚ÇÇ r‚ÇÇ</code> doesn't work as a result of that lack of cancellativity?</p>",
        "id": 534027304,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755020229
    },
    {
        "content": "<p>btw honestly these names are getting too long, can we set up LinearCommMonoid‚ÇÄ as alias?</p>",
        "id": 534027324,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755020241
    },
    {
        "content": "<p>or notation</p>",
        "id": 534027328,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755020245
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2328072.20tactic.20for.20equivalent.20valuations/near/534027304\">said</a>:</p>\n<blockquote>\n<p>And so <code>‚àÉ r‚ÇÅ r‚ÇÇ, v‚ÇÅ r‚ÇÅ = x * v‚ÇÅ r‚ÇÇ ‚àß v‚ÇÇ r‚ÇÅ = y * v‚ÇÇ r‚ÇÇ</code> doesn't work as a result of that lack of cancellativity?</p>\n</blockquote>\n<p>correct</p>",
        "id": 534027358,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755020259
    },
    {
        "content": "<p>(even if you add v2 r2 \\ne 0)</p>",
        "id": 534027382,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755020272
    },
    {
        "content": "<p><code>LinearOrderedCommMonoidWithZero</code> is 31 (!) characters</p>",
        "id": 534027445,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755020298
    },
    {
        "content": "<p>LinearCommMonoid‚ÇÄ is 17</p>",
        "id": 534027487,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755020315
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2328072.20tactic.20for.20equivalent.20valuations/near/534027304\">said</a>:</p>\n<blockquote>\n<p>And so <code>‚àÉ r‚ÇÅ r‚ÇÇ, v‚ÇÅ r‚ÇÅ = x * v‚ÇÅ r‚ÇÇ ‚àß v‚ÇÇ r‚ÇÅ = y * v‚ÇÇ r‚ÇÇ</code> doesn't work as a result of that lack of cancellativity?</p>\n</blockquote>\n<p>Consider R=F[X] where F is a field.</p>\n<p>Consider the valuation to Fin 37 with truncated multiplication, where v(X) = 2 and v(F) = 1. (Fin 37 is obviously linearly ordered, obviously commutative, (slightly less) obviously a monoid, and obviously with zero)</p>\n<p>Then v is equivalent to itself, and v(X^200) = 3 v(X^100) as well as v(X^200) = 4 v(X^100), but 3 and 4 are not equal</p>",
        "id": 534027850,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755020512
    },
    {
        "content": "<p>Anyway, would the definition I proposed here be agreeable to everyone here?<br>\n<a class=\"message-link\" href=\"/#narrow/channel/144837-PR-reviews/topic/.2328072.20tactic.20for.20equivalent.20valuations/near/534026838\">#PR reviews &gt; #28072 tactic for equivalent valuations @ üí¨</a></p>",
        "id": 534028351,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755020768
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"308899\">@Yakov Pechersky</span> I would appreciate your voice here as well</p>",
        "id": 534028428,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755020812
    },
    {
        "content": "<p>I think in almost all use cases, we'll have the group. Is it easier to develop (less code) without writing the Monoid version?</p>",
        "id": 534028806,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1755020976
    },
    {
        "content": "<p>I like the inductive version because it reminds of the model theory aspect. And the tactic developed here for rewrites could be an inspiration for other model-theory related helper tactics.</p>",
        "id": 534028878,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1755021010
    },
    {
        "content": "<p>(Model theory example)<br>\n<a href=\"/user_uploads/3121/6f_VJRCnyNQV9owJdKMOGG9g/image.png\">image.png</a><br>\n<a href=\"http://homepages.math.uic.edu/~marker/valued_fields.pdf\">http://homepages.math.uic.edu/~marker/valued_fields.pdf</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/6f_VJRCnyNQV9owJdKMOGG9g/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1769x1913\" src=\"/user_uploads/thumbnail/3121/6f_VJRCnyNQV9owJdKMOGG9g/image.png/840x560.webp\"></a></div>",
        "id": 534028903,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1755021024
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"308899\">Yakov Pechersky</span> <a href=\"#narrow/stream/144837-PR-reviews/topic/.2328072.20tactic.20for.20equivalent.20valuations/near/534028806\">said</a>:</p>\n<blockquote>\n<p>I think in almost all use cases, we'll have the group. Is it easier to develop (less code) without writing the Monoid version?</p>\n</blockquote>\n<p>yes, but some people will complain that you can generalise to monoids</p>",
        "id": 534029973,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755021457
    },
    {
        "content": "<p>btw there‚Äôs a hair to be split in the definition for groups, I can strengthen the destructor by requiring v1 w != 0 and v2 w != 0</p>",
        "id": 534030116,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755021504
    },
    {
        "content": "<p>Does <code>‚àÉ r‚ÇÅ r‚ÇÇ, IsUnit (v‚ÇÅ r‚ÇÇ) ‚àß IsUnit (v‚ÇÇ r‚ÇÇ) ‚àß v‚ÇÅ r‚ÇÅ = x * v‚ÇÅ r‚ÇÇ ‚àß v‚ÇÇ r‚ÇÅ = y * v‚ÇÇ r‚ÇÇ</code> work for both cases?</p>",
        "id": 534030411,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755021613
    },
    {
        "content": "<p>probably?</p>",
        "id": 534032861,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1755022655
    },
    {
        "content": "<p>I wonder what this means mathematically, it sounds like something like taking the intersection of two things</p>",
        "id": 534041741,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755026412
    },
    {
        "content": "<p>we seem to have the <code>group</code> tactic and <code>abel</code> tactic but not <code>comm_group</code> tactic...</p>",
        "id": 534041954,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755026486
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> your definition works, very nice</p>",
        "id": 534043978,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755027438
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">mul_le_mul_iff_of_pos_left</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"bp\">.</span><span class=\"n\">mul_le_mul_left</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Monoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LE</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MulLeftMono</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">‚ü®</span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">mul_le_mul_left'</span><span class=\"w\"> </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"bp\">.</span><span class=\"n\">unit</span><span class=\"bp\">‚Åª¬π</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"bp\">À£</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">mul_assoc</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"bp\">.</span><span class=\"n\">val_inv_mul</span><span class=\"o\">]),</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">mul_le_mul_left'</span><span class=\"w\"> </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">‚ü©</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">mul_le_mul_iff_of_pos_right</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"bp\">.</span><span class=\"n\">mul_le_mul_right</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Monoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LE</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MulRightMono</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">‚ü®</span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">mul_le_mul_right'</span><span class=\"w\"> </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"bp\">.</span><span class=\"n\">unit</span><span class=\"bp\">‚Åª¬π</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"bp\">À£</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mul_assoc</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"bp\">.</span><span class=\"n\">mul_val_inv</span><span class=\"o\">]),</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">mul_le_mul_right'</span><span class=\"w\"> </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">‚ü©</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Valuation</span><span class=\"bp\">.</span><span class=\"n\">IsEquiv</span>\n\n<span class=\"kn\">section</span><span class=\"w\"> </span><span class=\"n\">Monoid</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearOrderedCommMonoidWithZero</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearOrderedCommMonoidWithZero</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Valuation</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Valuation</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">IsEquiv</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"o\">)</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unusedVariables</span><span class=\"w\"> </span><span class=\"n\">false</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Associated</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">IsEquiv</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">r‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">r‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">r‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">r‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">r‚ÇÅ</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">r‚ÇÇ</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">r‚ÇÅ</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">r‚ÇÇ</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Associated</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">‚ü®</span><span class=\"n\">r</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"bp\">‚ü©</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">x‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">y‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">y‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h‚ÇÅ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated</span><span class=\"w\"> </span><span class=\"n\">x‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">y‚ÇÅ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated</span><span class=\"w\"> </span><span class=\"n\">x‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">y‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x‚ÇÅ</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y‚ÇÅ</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">r‚ÇÅ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">s‚ÇÅ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u‚ÇÅ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÅ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÅ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f‚ÇÅ</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÅ</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">r‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">s‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f‚ÇÇ</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">r‚ÇÅ</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">r‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">s‚ÇÅ</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">s‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mul_mul_mul_comm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"o\">]</span><span class=\"bp\">‚ü©</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">le_iff_le</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">x‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÅ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">y‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">y‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œì‚ÇÇ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h‚ÇÅ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated</span><span class=\"w\"> </span><span class=\"n\">x‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">y‚ÇÅ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">Associated</span><span class=\"w\"> </span><span class=\"n\">x‚ÇÇ</span><span class=\"w\"> </span><span class=\"n\">y‚ÇÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">x‚ÇÅ</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">x‚ÇÇ</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">y‚ÇÅ</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">y‚ÇÇ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">r‚ÇÅ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">s‚ÇÅ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">i‚ÇÅ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">j‚ÇÅ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÅ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f‚ÇÅ</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÅ</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">r‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">s‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">i‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">j‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f‚ÇÇ</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h‚ÇÇ</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">i‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">mul_le_mul_right</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">i‚ÇÇ</span><span class=\"bp\">.</span><span class=\"n\">mul_le_mul_left</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÅ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_left_comm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">mul_assoc</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">e‚ÇÇ</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">j‚ÇÅ</span><span class=\"bp\">.</span><span class=\"n\">mul_le_mul_right</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">j‚ÇÇ</span><span class=\"bp\">.</span><span class=\"n\">mul_le_mul_left</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">f‚ÇÅ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">mul_left_comm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">mul_assoc</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">f‚ÇÇ</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">map_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">map_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">map_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">map_mul</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">]</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Associated</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Monoid</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Valuation</span><span class=\"bp\">.</span><span class=\"n\">IsEquiv</span>\n</code></pre></div>",
        "id": 534043982,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755027440
    },
    {
        "content": "<p>it's not easy to find a home for <code>IsUnit.mul_le_mul_right</code>...</p>",
        "id": 534044481,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755027703
    },
    {
        "content": "<p>again we run into the problem of trying to reconcile algebra with order</p>",
        "id": 534044527,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755027721
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>lake exe graph --from Mathlib.Algebra.Order.Monoid.Unbundled.Defs,Mathlib.Algebra.Group.Units.Defs --to Mathlib.Algebra.Order.GroupWithZero.Canonical\n</code></pre></div>\n<p><a href=\"/user_uploads/3121/GS9pJfCayMMoK5_XCmoRk7Tn/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/GS9pJfCayMMoK5_XCmoRk7Tn/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1856x404\" src=\"/user_uploads/thumbnail/3121/GS9pJfCayMMoK5_XCmoRk7Tn/image.png/840x560.webp\"></a></div>",
        "id": 534046507,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755028540
    },
    {
        "content": "<p>the two sources are <code>Mathlib.Algebra.Order.Monoid.Unbundled.Defs</code> for <code>MulLeftMono</code> and <code>Mathlib.Algebra.Group.Units.Defs</code> for <code>IsUnit</code>, which are the two house-shaped nodes in the above diagram</p>",
        "id": 534046662,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755028600
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/elQis0JKpc96FIoOYXiWD4el/import_grpah_coloured.png\">import_grpah_coloured.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/elQis0JKpc96FIoOYXiWD4el/import_grpah_coloured.png\" title=\"import_grpah_coloured.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1880x432\" src=\"/user_uploads/thumbnail/3121/elQis0JKpc96FIoOYXiWD4el/import_grpah_coloured.png/840x560.webp\"></a></div>",
        "id": 534047145,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755028810
    },
    {
        "content": "<p>from my very efficient algorithm, it seems like two common descendants are <code>Mathlib.Algebra.Order.GroupWithZero.Unbundled.Basic</code> and <code>Mathlib.Algebra.Order.Monoid.Canonical.Defs</code></p>",
        "id": 534047331,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755028874
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"308899\">@Yakov Pechersky</span> I'm sure you'll have some very amazing insights for this situation</p>",
        "id": 534047483,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755028946
    },
    {
        "content": "<p>A new file</p>",
        "id": 534047566,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1755028993
    },
    {
        "content": "<p>That's not the right statement, give me a moment...</p>",
        "id": 534047849,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755029121
    },
    {
        "content": "<p>which one is not correct?</p>",
        "id": 534047893,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755029142
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"bp\">.</span><span class=\"n\">mulLECancellable</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Monoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LE</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MulLeftMono</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MulLECancellable</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">‚ü®</span><span class=\"n\">u</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ha</span>\n<span class=\"w\">  </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">mul_le_mul_left'</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">‚Üë</span><span class=\"n\">u</span><span class=\"bp\">‚Åª¬π</span>\n\n\n<span class=\"c1\">-- this one is probably useless now</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"bp\">.</span><span class=\"n\">mul_le_mul_left</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Monoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LE</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MulLeftMono</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">ha</span><span class=\"bp\">.</span><span class=\"n\">mulLECancellable</span><span class=\"bp\">.</span><span class=\"n\">mul_le_mul_iff_left</span>\n</code></pre></div>",
        "id": 534048137,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755029232
    },
    {
        "content": "<p>MulLECancellable is again deeper in the hierarchy but only slightly so I think that's a reasonable tradeoff</p>",
        "id": 534048303,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755029308
    },
    {
        "content": "<p>MulLECancellable is defined in <code>Mathlib.Algebra.Order.Monoid.Unbundled.Basic</code> which is in the graph and is in red</p>",
        "id": 534048347,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755029322
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> would you agree if I put that theorem in <code>Mathlib.Algebra.Order.Monoid.Canonical.Defs</code>?</p>",
        "id": 534048569,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755029419
    },
    {
        "content": "<p>Interestingly we don't have the version for cancellability on the other side</p>",
        "id": 534048583,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755029425
    },
    {
        "content": "<p>So maybe the unit lemmas are a good idea after all</p>",
        "id": 534048605,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755029434
    },
    {
        "content": "<p>so... the new file approach by Yakov?</p>",
        "id": 534048639,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755029450
    },
    {
        "content": "<p><code>Mathlib.Algebra.Order.GroupWithZero.Unbundled.Basic</code> sounds better to me</p>",
        "id": 534048716,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755029478
    },
    {
        "content": "<p>Or did I misunderstand?</p>",
        "id": 534048762,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755029495
    },
    {
        "content": "<p>that one does not have access to <code>MulLECancellable</code></p>",
        "id": 534048795,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755029509
    },
    {
        "content": "<p>which... wait... why does this name not say Left??</p>",
        "id": 534048812,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755029516
    },
    {
        "content": "<p>That is a question for the author of that typeclass</p>",
        "id": 534048913,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1755029561
    },
    {
        "content": "<p>so where should I put the three statements?</p>",
        "id": 534049419,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755029777
    },
    {
        "content": "<p>the earliest place <code>IsUnit.mulLECancellable</code> would fit in is <code>Mathlib.Algebra.Order.Monoid.Canonical.Defs</code></p>",
        "id": 534049477,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755029802
    },
    {
        "content": "<p><code>IsUnit.mul_le_mul_left</code> and <code>_right</code> would fit in either <code>Mathlib.Algebra.Order.Monoid.Canonical.Defs</code> or <code>Mathlib.Algebra.Order.GroupWithZero.Unbundled.Basic</code></p>",
        "id": 534049550,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755029831
    },
    {
        "content": "<p>imma do both and then let you decide</p>",
        "id": 534051370,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755030668
    },
    {
        "content": "<p>welp I just realised that <code>mul_le_mul_left'</code> actually only exists in <code>Mathlib.Algebra.Order.Monoid.Unbundled.Basic</code> so maybe there's less of a competition</p>",
        "id": 534051998,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755030956
    },
    {
        "content": "<p>actually <code>Mathlib.Algebra.Order.Monoid.Canonical.Defs</code> is not a good home for those lemmas because that file is about <code>CanonicallyOrderedMul</code></p>",
        "id": 534052554,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755031216
    },
    {
        "content": "<p>i'm now leaning towards a separate file</p>",
        "id": 534053066,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755031469
    },
    {
        "content": "<p>made <a href=\"https://github.com/leanprover-community/mathlib4/pull/28313\">#28313</a></p>",
        "id": 534055472,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1755032487
    }
]