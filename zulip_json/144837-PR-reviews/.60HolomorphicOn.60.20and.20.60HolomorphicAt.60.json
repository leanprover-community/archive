[
    {
        "content": "<p>I was told to break up <a href=\"https://github.com/leanprover-community/mathlib4/pull/9598\">#9598</a> into smaller pieces, which I'm trying to do now (please see <a href=\"https://github.com/leanprover-community/mathlib4/pull/19050\">#19050</a>, <a href=\"https://github.com/leanprover-community/mathlib4/pull/19051\">#19051</a>, <a href=\"https://github.com/leanprover-community/mathlib4/pull/19052\">#19052</a>, which are all tiny/trivial). The only thing left before I can add the <code>HasPrimitives</code> file was the suggestion to replace all instances of <code>DifferentiableOn ℂ</code> and <code>DifferentiableAt ℂ</code> (of which there are about 200 total) with <code>HolomorphicOn</code> and <code>HolomorphicAt</code>, which are <code>abbrev</code>s of the former. (Just makes it easier to read, and slightly shorter.) Before I go ahead with the task, do people generally agree that this is a good notation to have? Assuming so, where do you recommend I put the <code>abbrev</code> (since it will need to be imported by anything that may use it...). Thanks!</p>",
        "id": 482484362,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1731619042
    },
    {
        "content": "<p><img alt=\":merge:\" class=\"emoji\" src=\"https://avatars.zulip.com/3121/emoji/images/37577b95.png\" title=\"merge\"> <a href=\"https://github.com/leanprover-community/mathlib4/pull/19050\">#19050</a><br>\n<img alt=\":merge:\" class=\"emoji\" src=\"https://avatars.zulip.com/3121/emoji/images/37577b95.png\" title=\"merge\"> <a href=\"https://github.com/leanprover-community/mathlib4/pull/19051\">#19051</a><br>\n<img alt=\":bors:\" class=\"emoji\" src=\"https://avatars.zulip.com/3121/emoji/images/dce2c3bb.png\" title=\"bors\"> <a href=\"https://github.com/leanprover-community/mathlib4/pull/19052\">#19052</a></p>",
        "id": 482750792,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1731746072
    },
    {
        "content": "<p>I haven't heard any opinions on adding the terminology <code>Holomophic</code> for <code>Differentiable ℂ</code>... Shall I just try to make the PR, and then people will let me know if they want it or not?</p>",
        "id": 483031918,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1731938911
    },
    {
        "content": "<p>There is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AnalyticOn#doc\">docs#AnalyticOn</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AnalyticAt#doc\">docs#AnalyticAt</a> (which, however, still require <code>ℂ</code> as an explicit argument.</p>",
        "id": 483034320,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1731939551
    },
    {
        "content": "<p>But I think it would be reasonable to have <code>Holomorphic...</code> as well (could perhaps just be <code>abbrev</code>s ?).</p>",
        "id": 483034471,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1731939599
    },
    {
        "content": "<p>I think <code>HolomorphicOn</code> and <code>HolomorphicAt</code> would definitely make sense as abbrevs. However, since we won't develop a full API for them, there may be some quirks with dot notation (?)</p>",
        "id": 483034757,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1731939664
    },
    {
        "content": "<p>Ok, thanks! I'll try it out on existing Mathlib files (indeed, might need some more API) and if it works, PR that, before adding any new stuff...</p>",
        "id": 483035609,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1731939865
    },
    {
        "content": "<p>I really don't think we should define <code>Holomorphic[|At|On|AtWithin]</code> if it is any less convenient to use than <code>Differentiable ℂ</code>, or requires us to duplicate (more than a handful of) lemmas for <code>Holomorphic</code>.<br>\nIn differential geometry we have the <code>Smooth</code> abbreviation (or def?), and it doubles the number of lemmas we write for smooth functions. This is really annoying and I think we should get rid of it.</p>",
        "id": 483049947,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1731943217
    },
    {
        "content": "<p>Yes, I think we should definitely kill the <code>Smooth</code>. It's an abbrev, and we could keep it as an abbrev, but having API around it it really just harmful duplication. In the same way, it could make sense to define abbrevs <code>HolomorphicOn</code> and <code>HolomorphicAt</code>, but we should not introduce any API around it.</p>",
        "id": 483051347,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1731943559
    },
    {
        "content": "<p>Ah, interesting; yes that's the kind of thing I was worried about. Ok, so will it be a problem to introduce <code>Holomorphic</code> some places but not use it in others? E.g., there's a theorem in the PR currently called <code>HolomorphicOn.vanishesOnRectanglesInDisc</code>; so now it's not <em>just</em> an <code>abbrev</code> but is changing how theorems are named...? Maybe it's better just to revert to <code>Differentiable</code>?... (It would be good to straighten this out, before trying to move much more of PNT+ over to Mathlib...) Thanks for your advice!</p>",
        "id": 483060613,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1731945658
    },
    {
        "content": "<p>/poll Should we have <code>Holomorphic{,On,At,*}</code> in mathlib?</p>\n<ul>\n<li>Yes, as an <code>abbrev</code></li>\n<li>Yes, with its own API</li>\n<li>No, stick with <code>Differentiable</code></li>\n</ul>",
        "id": 483419636,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1732087382
    },
    {
        "content": "<p>For discoverability reasons and compatibility with established informal usage, I think it makes sense to have <code>Holomorphic...</code> in Mathlib.</p>",
        "id": 483450240,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1732098234
    },
    {
        "content": "<p>One could also add a <code>alias</code>, with a comment that it's only for documentation purpose... (Or generally: there should be a library overview page, explaining these things. That's more effort, though.)</p>",
        "id": 483476844,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1732107147
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"252920\">Alex Kontorovich</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.60HolomorphicOn.60.20and.20.60HolomorphicAt.60/near/483060613\">said</a>:</p>\n<blockquote>\n<p>Ah, interesting; yes that's the kind of thing I was worried about. Ok, so will it be a problem to introduce <code>Holomorphic</code> some places but not use it in others? E.g., there's a theorem in the PR currently called <code>HolomorphicOn.vanishesOnRectanglesInDisc</code>; so now it's not <em>just</em> an <code>abbrev</code> but is changing how theorems are named...? Maybe it's better just to revert to <code>Differentiable</code>?... (It would be good to straighten this out, before trying to move much more of PNT+ over to Mathlib...) Thanks for your advice!</p>\n</blockquote>\n<p>This is one thing I experienced with <code>Smooth</code> as well, and that is that dot-notation is problematic with such aliases. If your theorem is <code>HolomorphicOn.vanishesOnRectanglesInDisc</code> and you have an expression <code>h : DifferentiableOn ...</code> then you cannot use dot notation to apply the theorem, which is really annoying. And even if you phrase all your hypotheses using <code>HolomorphicOn</code>, that will not help you, since if <code>hf : HolomorphicOn f s</code> and <code>hg : HolomorphicOn g t</code> then <code>hf.comp hg ..</code> will have type <code>DifferentiableOn ..</code>, since you've applied <code>DifferentiableOn.comp</code>.</p>\n<p>So I recommend to keep using the <code>DifferentiableOn</code> naming in theorem names, and at that point I'm wondering what the value is of adding the abbreviation.</p>",
        "id": 483480180,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1732108096
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"111080\">Floris van Doorn</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.60HolomorphicOn.60.20and.20.60HolomorphicAt.60/near/483480180\">said</a>:</p>\n<blockquote>\n<p>And even if you phrase all your hypotheses using <code>HolomorphicOn</code>, that will not help you, since if <code>hf : HolomorphicOn f s</code> and <code>hg : HolomorphicOn g t</code> then <code>hf.comp hg ..</code> will have type <code>DifferentiableOn ..</code>, since you've applied <code>DifferentiableOn.comp</code>.</p>\n</blockquote>\n<p>Ack! Ok, that's <em>really</em> bad; good to know. I'm personally going to revert to <code>Differentiable</code>, and suffer the extra <code>ℂ</code>s everywhere. If someone else wants to pursue <code>Holomorphic</code> and make it work, they're more than welcome... Thanks for the advice!</p>",
        "id": 483497877,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1732113229
    },
    {
        "content": "<p>There's an alternative, right? Namely to provide <code>HolomorphicOn.comp</code> as a (quasi-)alias of <code>DifferentiableOn.comp</code></p>",
        "id": 483498089,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1732113278
    },
    {
        "content": "<p>But <span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span> said we didn't want to have all this duplicative API...?</p>",
        "id": 483498385,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1732113354
    },
    {
        "content": "<p>Well hopefully there is only a handful of lemmas that need to be duplicated, namely the ones that take a <code>DifferentiableOn</code> assumption, spit out a <code>DifferentiableOn</code> conclusion and use dot notation on <code>DifferentiableOn</code>.</p>",
        "id": 483499296,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1732113593
    },
    {
        "content": "<p>With <code>Smooth</code>, it turned out that in fact there are many many such lemmas.</p>",
        "id": 483499648,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1732113677
    },
    {
        "content": "<p>Is it possible to make <code>HolomorphicOn</code> just a notation for <code>DifferentiableOn ℂ</code> (with the associated pretty-printer)? I don't see any drawback with this approach.</p>",
        "id": 483499936,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1732113742
    },
    {
        "content": "<p>Well, of course, people dealing with holomorphic functions would still need to know that the lemmas they want to apply, when not using dot notation, would start with <code>Differentiable</code>, so maybe it's not ideal either (unless there is a very good docstring for <code>HolomorphicOn</code> emphasizing that).</p>",
        "id": 483500239,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1732113821
    },
    {
        "content": "<p>notation seems unproblematic.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.60HolomorphicOn.60.20and.20.60HolomorphicAt.60/near/483499296\">said</a>:</p>\n<blockquote>\n<p>Well hopefully there is only a handful of lemmas that need to be duplicated, namely the ones that take a <code>DifferentiableOn</code> assumption, spit out a <code>DifferentiableOn</code> conclusion and use dot notation on <code>DifferentiableOn</code>.</p>\n</blockquote>\n<p>Well, it's all lemmas that have <code>DifferentiableOn</code> as their conclusion, which is <em>a lot</em> of lemmas (&gt;100, and do that times 4 for DifferentiableAt, Differentiable and DifferentiableWithinAt)</p>",
        "id": 483513219,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1732116964
    },
    {
        "content": "<p>I've just started to work on removing <code>Smooth</code> from mathlib. You can have a look at the mess in <a href=\"https://github.com/leanprover-community/mathlib4/pull/19296\">#19296</a>...</p>",
        "id": 483514806,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1732117339
    },
    {
        "content": "<p>It's going to be rough... <span aria-label=\"speak no evil\" class=\"emoji emoji-1f64a\" role=\"img\" title=\"speak no evil\">:speak_no_evil:</span></p>",
        "id": 483515213,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1732117450
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110050\">Sébastien Gouëzel</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.60HolomorphicOn.60.20and.20.60HolomorphicAt.60/near/483499936\">said</a>:</p>\n<blockquote>\n<p>Is it possible to make <code>HolomorphicOn</code> just a notation for <code>DifferentiableOn ℂ</code> (with the associated pretty-printer)? I don't see any drawback with this approach.</p>\n</blockquote>\n<p>If both you and <span class=\"user-mention\" data-user-id=\"111080\">@Floris van Doorn</span> think this could work, I'll try experimenting with it. And just to confirm: if I then want to have theorems that I can access with dot notation, I should call them <code>DifferentiableOn.foo</code>, so that a hypothesis <code>(h : HolomorphicOn f)</code> could be accessed as <code>h.foo</code>, right? Lean can see through notation? Or should I call them <code>HolomorphicOn.foo</code>? (I'm perfectly happy quoting <code>Differentiable</code> inside a proof; I'm just trying to make <em>statements</em> look nicer via <code>Holomorphic</code>... And I definitely don't want to 4x the amount of API...)</p>",
        "id": 483518741,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1732118390
    },
    {
        "content": "<p>Correct, you should call it <code>DifferentiableOn.foo</code>. Notation is completely transparent for elaboration.</p>",
        "id": 483521823,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1732119198
    },
    {
        "content": "<p>I'm not sure I agree with this use of notation. I think that's just going to lead to a bunch of confused people looking up theorems on <code>Holomorphic</code> and not finding them.</p>",
        "id": 483634669,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732175529
    },
    {
        "content": "<p><code>Differentiable ℂ</code> seems entirely unambiguous and completely understandable, at least in my view. Why fix what isn't broken?</p>",
        "id": 483634803,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732175599
    },
    {
        "content": "<p>It's not like \"complex differentiable\" is a term mathematicians never use</p>",
        "id": 483634866,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732175636
    },
    {
        "content": "<p>We can still add a docstring to the notation emphasizing that the actual term is <code>Differentiable</code>.</p>",
        "id": 483715514,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1732200551
    }
]