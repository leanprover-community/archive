[
    {
        "content": "<p>Exactly which tactics should we register for use with <code>hint</code>? This PR adds <code>positivity</code> and <code>bound</code>, and the PR author recently added <code>tauto</code> and <code>trivial</code> to the list. Instead of doing it piecemeal, I think it makes sense to have a decision on Zulip.</p>",
        "id": 503060469,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1741017037
    },
    {
        "content": "<p>(Just noting that <code>hint</code> will be superseded by <code>try?</code>, supplied for core Lean, but similarly extensible, around mid-year.)</p>",
        "id": 503130864,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1741038745
    },
    {
        "content": "<p>Note also I had some now-abandoned PRs that made <code>hint</code> run the registered tactics in parallel, if anyone is really keen to revive those.</p>",
        "id": 503130962,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1741038787
    },
    {
        "content": "<p>Will <code>try?</code> support _un_-registering hints, when one tactic is known to crash in a given theorem / is not wanted for pedagogical reasons?</p>",
        "id": 503132558,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1741039382
    },
    {
        "content": "<p>Probably not. :-)</p>",
        "id": 503156465,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1741050818
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span></p>\n<p>As a beginner, I find the <code>hint</code> tactic extremely helpful for endgame tactic discovery, so I’m really excited to hear that an improved version is in the works.</p>\n<p>Is there any information available about the plans for <code>try?</code>, including what use cases it’s intended to cover?</p>\n<p>Also, how does <code>try?</code> relate to <code>grind</code>? I’ve noticed that <code>try?</code> can already handle the following test case via <code>grind</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">zero</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">try?</span>\n</code></pre></div>",
        "id": 503213708,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1741079135
    },
    {
        "content": "<p><code>try?</code> and <code>grind</code> are only related in the sense that <code>grind</code> is one of the tactics registered with <code>try?</code>. Not<strong>e</strong> that <code>grind</code> is not ready for general use until July.</p>",
        "id": 503704278,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1741240783
    },
    {
        "content": "<p>That first \"Not\" is a \"Note\", I think.</p>",
        "id": 503745519,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1741253913
    },
    {
        "content": "<p>I use <code>hint</code> a lot, so I'd love to have more useful tactics registered. Having scrolled through Mathlib/Tactic, <code>ring</code>, <code>abel</code>, <code>fun_prop</code>, <code>noncomm_ring</code>, and <code>tauto_set</code> look like good candidates.</p>",
        "id": 504508835,
        "sender_full_name": "Vlad Tsyrklevich",
        "timestamp": 1741596636
    },
    {
        "content": "<p>I agree with all of those! Perhaps it's worth adding <code>nlinarith</code>, <code>group</code> and <code>norm_num</code> to the list too?</p>",
        "id": 504694269,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1741643554
    },
    {
        "content": "<p>Are there any specific technical reasons why many powerful “endgame tactics” are not currently registered with <code>register_hint</code>, or is it simply that no one has added them yet? One could imagine that really slow tactics might raise concerns about execution time, but are there other factors at play?</p>",
        "id": 504696057,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1741644204
    },
    {
        "content": "<p>Yes, it's performance. Currently <code>hint</code> waits for all results before reporting, so it can make a miserable user experience if a slow tactic is included.</p>\n<p>I made a PR long ago to allow <code>hint</code> to run tactic in parallel, but the framework for doing so was rather idiosyncratic, and the PR has rotted since.</p>\n<p>Someone should adopt this PR, replacing or updating it, before we consider such expensive tactics in <code>hint</code>.</p>",
        "id": 504705870,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1741648604
    },
    {
        "content": "<p>Which of the proposed tactics (<code>abel bound fun_prop group nlinarith noncomm_ring norm_num positivity ring tauto_set</code>) are considered \"slow\"/expensive?</p>\n<p>Also, is there a general rule of thumb for determining whether a tactic is classified as \"slow\"/expensive or not?</p>",
        "id": 504944859,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1741724088
    },
    {
        "content": "<p>These are the currently <code>hint</code> registered tactics for reference: <code>aesop decide exact? gcongr intro linarith omega simp_all? split tauto trivial</code>.</p>",
        "id": 504944939,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1741724095
    },
    {
        "content": "<p>I would be hesitant to add <code>nlinarith</code>, as it can easily blow up. The others are probably reasonable. I'm somewhat worried about having <code>aesop</code> in there to begin with, but I guess no one is complaining?</p>",
        "id": 504968851,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1741731362
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2322365.20hint.20tactics/near/504705870\">said</a>:</p>\n<blockquote>\n<p>I made a PR long ago to allow <code>hint</code> to run tactic in parallel, but the framework for doing so was rather idiosyncratic, and the PR has rotted since.</p>\n</blockquote>\n<p>I forgot to include the PR number, in case anyone is interested: <a href=\"https://github.com/leanprover-community/mathlib4/pull/8435\">#8435</a></p>",
        "id": 504968971,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1741731398
    },
    {
        "content": "<p>I very rarely use <code>hint</code> and if I do then I'm probably at a point of desperation anyway and would be prepared to wait. One way of playing it here is just listening to the people who use <code>hint</code> a lot and then doing what they want until people start complaining that <code>hint</code> has become unusable :-) Alternatively we could have a slow <code>big_hint</code> tactic or something.</p>",
        "id": 504969286,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1741731509
    },
    {
        "content": "<p>I would really like to move towards a world where <code>hint</code> is running every time the cursor is at a sorry or open goal... (With UI to disable easily, and maybe cleverness to not run when on battery power!) This is only possible if it is somewhat performant.</p>",
        "id": 505012954,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1741748081
    },
    {
        "content": "<p>It could be made performant with parallelization. I agree that that world sounds totally awesome</p>",
        "id": 505061212,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1741768388
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"761203\">@Vlad Tsyrklevich</span> <code>tauto_set</code> is an excellent suggestion for <code>register_hint</code> — it's a very nice tactic that seems to be largely unknown since it was only added recently (2025).</p>\n<p>Making it accessible via <code>hint</code> would be a great way for newcomers to discover it, say when working with the set chapter in MIL (in addition to solving them \"by hand\" of course).</p>\n<p>Unfortunately, I don't think <code>tauto_set</code> can be included via <code>register_hint</code> in its current form; I suspect the issue is that it always reports success.</p>\n<p><a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> showing the issue:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"n\">register_hint</span><span class=\"w\"> </span><span class=\"n\">tauto_set</span>\n<span class=\"c1\">-- correct hint</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">∩</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">∩</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">hint</span>\n<span class=\"c1\">-- incorrect hint</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">hint</span>\n</code></pre></div>",
        "id": 505113046,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1741781632
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"479731\">@Lenny Taelman</span> Do you by any chance know what might be causing the above issue?</p>",
        "id": 505113448,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1741781739
    },
    {
        "content": "<p>Side note: set exercises in MIL are meant to teach some basic tactics, so using <code>tauto_set</code> would simply make those exercises useless. Of course we can still mention it exists, since it is useful in the real world (as opposed to the basic Lean training world).</p>",
        "id": 505114296,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1741781959
    },
    {
        "content": "<p>Yes, absolutely. If I recall correctly, the book makes this very clear, explaining that <code>ring</code> is typically used “in the real world” for the first chapter’s exercises, but that the exercise are meant to be done “by hand” to learn the basics, and underlying concepts.</p>\n<p>I guess the same principle applies to <code>tauto</code> for some of the exercises in the logic chapter, <code>tauto_set</code> in the set chapter, <code>group</code> in the group chapter, and so on.</p>",
        "id": 505118600,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1741782701
    },
    {
        "content": "<p>Yes, with the exception that <code>group</code> comes sufficiently late that it can be used directly since rewriting by hand has already been explained.</p>",
        "id": 505122773,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1741783719
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"683979\">Isak Colboubrani</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2322365.20hint.20tactics/near/505113046\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"761203\">Vlad Tsyrklevich</span> <code>tauto_set</code> is an excellent suggestion for <code>register_hint</code> — it's a very nice tactic that seems to be largely unknown since it was only added recently (2025).</p>\n<p>Making it accessible via <code>hint</code> would be a great way for newcomers to discover it, say when working with the set chapter in MIL (in addition to solving them \"by hand\" of course).</p>\n<p>Unfortunately, I don't think <code>tauto_set</code> can be included via <code>register_hint</code> in its current form; I suspect the issue is that it always reports success.</p>\n<p><a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> showing the issue:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"n\">register_hint</span><span class=\"w\"> </span><span class=\"n\">tauto_set</span>\n<span class=\"c1\">-- correct hint</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">∩</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">∩</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">hint</span>\n<span class=\"c1\">-- incorrect hint</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">hint</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/22892\">#22892</a></p>",
        "id": 505309025,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1741837038
    },
    {
        "content": "<p>I think it would be great if we could register some tactics as \"provability preserving\" (e.g. <code>simp</code>, but not <code>aesop</code>), so that if they convert the goal to <code>False</code> then we can tell the user that their original goal is wrong.</p>",
        "id": 505309169,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1741837095
    },
    {
        "content": "<p>Would it be worth registering <code>reduce_mod_char</code> for <code>hint</code> as well?</p>\n<p>For what it's worth, to the best of my knowledge, <code>reduce_mod_char</code> is currently the only tactic that solves the following test case:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"n\">register_hint</span><span class=\"w\"> </span><span class=\"n\">reduce_mod_char</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">126432</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ZMod</span><span class=\"w\"> </span><span class=\"mi\">1235412223</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">12355342321</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1001528716</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">hint</span>\n</code></pre></div>",
        "id": 506528084,
        "sender_full_name": "Isak Colboubrani",
        "timestamp": 1742315709
    }
]