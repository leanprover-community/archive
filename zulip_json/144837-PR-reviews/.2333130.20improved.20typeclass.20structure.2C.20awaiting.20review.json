[
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/33130\">#33130</a></p>\n<p>(Latest docstring)</p>\n<p>This contribution introduces <strong>discrete convolution API</strong> and <strong>Banach algebra structure on ‚Ñì¬π spaces</strong> via discrete convolution.</p>\n<h3>Discrete Convolution</h3>\n<p>Given two functions <code>f, g : M ‚Üí R</code> where <code>[Monoid M]</code> and <code>[Ring R]</code>, their convolution at a point <code>x</code> sums over all pairs <code>(a, b)</code> whose product equals <code>x</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚ãÜ</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)(</span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"o\">)</span>\n<span class=\"w\">            </span><span class=\"n\">a</span><span class=\"bp\">¬∑</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>\n<p><strong>Example over <code>[AddMonoid ‚Ñï]</code> (polynomials/power series):</strong></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚ãÜ</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)(</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"bp\">¬∑</span><span class=\"n\">g</span><span class=\"o\">(</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">¬∑</span><span class=\"n\">g</span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"bp\">¬∑</span><span class=\"n\">g</span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">(</span><span class=\"mi\">3</span><span class=\"o\">)</span><span class=\"bp\">¬∑</span><span class=\"n\">g</span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>This is polynomial multiplication: if <code>f</code> and <code>g</code> represent coefficients, then <code>(f ‚ãÜ g)(n)</code> is the n-th coefficient of the product.</p>\n<p><strong>Example over <code>[Group G]</code> (group algebras):</strong></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚ãÜ</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)(</span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\">    </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">over</span><span class=\"w\"> </span><span class=\"n\">all</span><span class=\"w\"> </span><span class=\"n\">pairs</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">¬∑</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">            </span><span class=\"n\">a</span><span class=\"bp\">¬∑</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>\n<h3>Key Features</h3>\n<p><strong>Discrete Convolution (<code>DiscreteConvolutionTestAPI.lean</code>)</strong></p>\n<ul>\n<li>Defines convolution via summation over \"fibers\" <code>{(a,b) | a¬∑b = x}</code></li>\n<li>Supports both multiplicative indices (group algebras) and additive indices (polynomials) via <code>@[to_additive]</code></li>\n<li>Generalizes to vector-valued functions using bilinear maps <code>L</code>:</li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">‚ãÜ</span><span class=\"o\">[</span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)(</span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">‚àë</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"o\">))</span>\n<span class=\"w\">                 </span><span class=\"n\">a</span><span class=\"bp\">¬∑</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>\n<ul>\n<li>For types with finite antidiagonals (like ‚Ñï), the infinite sum reduces to a finite sum</li>\n<li>Complete ring axioms for <code>CauchyProduct</code> (finite case)</li>\n</ul>\n<p><strong>‚Ñì¬π Banach Algebra (<code>LpOneBanachAlgebraTestAPI.lean</code>)</strong></p>\n<ul>\n<li>Establishes <code>NormedRing</code>, <code>NormedCommRing</code>, and <code>NormedAlgebra</code> instances on ‚Ñì¬π</li>\n<li>Core results: submultiplicativity <code>‚Äñf ‚ãÜ g‚Äñ ‚â§ ‚Äñf‚Äñ ¬∑ ‚Äñg‚Äñ</code>, closure under convolution, <code>NormOneClass</code></li>\n<li>Associativity via reindexing over triple fibers <code>{(a,b,c) | a¬∑b¬∑c = x}</code></li>\n<li><strong><code>AddLp M R</code> newtype</strong> for additive index monoids (e.g., ‚Ñï, ‚Ñ§) with full algebra infrastructure</li>\n<li><code>IsScalarTower</code> and <code>SMulCommClass</code> instances for proper algebra structure</li>\n</ul>\n<h3>Variables and Typeclasses</h3>\n<table>\n<thead>\n<tr>\n<th>Variable</th>\n<th>Type</th>\n<th>Role</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>M</code></td>\n<td><code>[Monoid M]</code> or <code>[AddMonoid M]</code></td>\n<td>Index set; elements label \"positions\" (e.g., ‚Ñï for polynomial degrees, G for group algebra basis)</td>\n</tr>\n<tr>\n<td><code>R</code></td>\n<td><code>[CommSemiring R]</code> or <code>[NormedCommRing R]</code></td>\n<td>Coefficient ring where function values live</td>\n</tr>\n<tr>\n<td><code>f</code>, <code>g</code></td>\n<td><code>M ‚Üí R</code></td>\n<td>Input functions to convolve</td>\n</tr>\n<tr>\n<td><code>x</code></td>\n<td><code>M</code></td>\n<td>Point at which <code>(f ‚ãÜ g)(x)</code> is evaluated</td>\n</tr>\n<tr>\n<td><code>a</code>, <code>b</code></td>\n<td><code>M</code></td>\n<td>Summation indices satisfying <code>a ¬∑ b = x</code> (or <code>a + b = x</code> for additive)</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Generalized (bilinear) convolution:</strong></p>\n<table>\n<thead>\n<tr>\n<th>Variable</th>\n<th>Type</th>\n<th>Role</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>S</code></td>\n<td><code>[CommSemiring S]</code></td>\n<td>Scalar ring for module structures</td>\n</tr>\n<tr>\n<td><code>E</code>, <code>E'</code>, <code>F</code></td>\n<td><code>[Module S E]</code>, etc.</td>\n<td>Codomains: <code>f : M ‚Üí E</code>, <code>g : M ‚Üí E'</code>, result in <code>F</code></td>\n</tr>\n<tr>\n<td><code>L</code></td>\n<td><code>E ‚Üí‚Çó[S] E' ‚Üí‚Çó[S] F</code></td>\n<td>Bilinear map combining values; e.g., <code>LinearMap.mul R R</code> for ring multiplication</td>\n</tr>\n</tbody>\n</table>\n<p><strong>‚Ñì¬π Banach algebra:</strong></p>\n<table>\n<thead>\n<tr>\n<th>Variable</th>\n<th>Type</th>\n<th>Role</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>f</code>, <code>g</code></td>\n<td><code>lp (fun _ : M =&gt; R) 1</code></td>\n<td>‚Ñì¬π functions (finite norm <code>‚àë ‚Äñf(m)‚Äñ &lt; ‚àû</code>)</td>\n</tr>\n<tr>\n<td><code>ùïú</code></td>\n<td><code>[NormedField ùïú]</code></td>\n<td>Scalar field for <code>[NormedAlgebra ùïú R]</code> structure</td>\n</tr>\n</tbody>\n</table>",
        "id": 565387463,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766691045
    },
    {
        "content": "<p>(deleted all out dated information)</p>",
        "id": 565399319,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766712028
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 565481441,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766797776
    },
    {
        "content": "<p>Forgive me for bringing this up. I'm a new contributor, and I'm not sure what to expect regarding the review turnaround time. I got comments from two reviewers, I responded/fixed the issues they raised within about an hour, but then I never heard back from them or any follow-up feedback in the following couple of days. The feedback I got so far was also from looking at the docstrings or a quick glance at the typeclasses rather than about the actual code. </p>\n<p>Please, take a look at the code. I think it's pretty good.</p>",
        "id": 565481483,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766797844
    },
    {
        "content": "<blockquote>\n<p>and I'm not sure what to expect regarding the review turnaround time.</p>\n</blockquote>\n<p>In my experience it can take a few days or a week, and probably longer around holidays. You can take a look at the <a href=\"https://leanprover-community.github.io/queueboard/review_dashboard.html\">review dashboard</a> to get a sense of how long a PR typically stays. It is a pretty long queue!</p>",
        "id": 565481806,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1766798278
    },
    {
        "content": "<p>PRs much smaller than this one can take up to a few weeks.</p>",
        "id": 565481845,
        "sender_full_name": "Violeta Hern√°ndez",
        "timestamp": 1766798322
    },
    {
        "content": "<p>An average PR is maybe 50 lines long, a longer one might be 300 or so. Your PR is nearly 1,000 lines long.</p>",
        "id": 565481902,
        "sender_full_name": "Violeta Hern√°ndez",
        "timestamp": 1766798414
    },
    {
        "content": "<p>Oh also, if your PR doesn't pass CI, it won't show up on the board. If the CI failed for spurious reason unrelated to your code, you can try commenting on one of those \"CI failure\" thread to get attention</p>",
        "id": 565481903,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1766798415
    },
    {
        "content": "<p>I'd recommend you split up the basic definitions and design onto a new PR, once/if that gets accepted, you can make new PRs for new pieces of your material.</p>",
        "id": 565481925,
        "sender_full_name": "Violeta Hern√°ndez",
        "timestamp": 1766798462
    },
    {
        "content": "<p>Thanks for the info <span class=\"user-mention\" data-user-id=\"459227\">@Violeta Hern√°ndez</span> ! <span class=\"user-mention\" data-user-id=\"873350\">@Weiyi Wang</span> It will pass, just forgot to update the test file name. (Update: All checks have passed)</p>",
        "id": 565481973,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766798533
    },
    {
        "content": "<p>(updated reply below)</p>",
        "id": 565482028,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766798636
    },
    {
        "content": "<p>It is more or less reasonably structured, has no horrendous proofs. Also I intentionally adopted the existing API as much as possible.</p>",
        "id": 565482225,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766798920
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hern√°ndez</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2333130.20improved.20typeclass.20structure.2C.20awaiting.20review/near/565481925\">said</a>:</p>\n<blockquote>\n<p>I'd recommend you split up the basic definitions and design onto a new PR, once/if that gets accepted, you can make new PRs for new pieces of your material.</p>\n</blockquote>\n<p>I see. Sounds reasonable. I may do this if any maintainer looks at the code and suggests this. One concern is this PR is a complete algebraic structure of l1 space - cauchy product. Any snippet of this file might not be too meaningful. </p>\n<p>PS: this PR is the foundation of a Lean project (~5k lines)</p>",
        "id": 565482317,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766799107
    },
    {
        "content": "<p>Worth mentioning, this PR may address some of the problems in <a href=\"https://github.com/leanprover-community/mathlib4/pull/30391\">#30391</a></p>",
        "id": 565484033,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766802062
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 565534570,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766875654
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 565534760,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766875996
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 565534895,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766876245
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 565535151,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766876433
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 565553933,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766908224
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 565611155,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766980948
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 565611686,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766981681
    },
    {
        "content": "<p>See <a href=\"#narrow/channel/144837-PR-reviews/topic/.2333130.20improved.20typeclass.20structure.2C.20awaiting.20review/near/565387463\"><code>‚ä§</code></a> for updated docstring</p>",
        "id": 565614928,
        "sender_full_name": "Fengyang Wang",
        "timestamp": 1766985186
    }
]