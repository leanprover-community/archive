[
    {
        "content": "<p>This PR adds several equivalences for <code>WithLp</code> types, like homeomorphisms and uniform equivalences. These are all of the form <code>WithLp p V ≃ V</code> to match <code>WithLp.equiv</code>. But there was previous discussion that this equivalence is the wrong way round. I'm hesitant to add more equivalences which go the wrong way if we're going to turn the others around too. One issue is that some lemmas about <code>WithLp.equiv</code> have been deprecated for about 3 months. Are we okay if those deprecations are no longer valid? I figure at some point we have to bite the bullet.</p>\n<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span>  and <span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span>, do you have thoughts about this?</p>",
        "id": 537324392,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1756830614
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"703970\">@Etienne Marion</span> pinging since you authored the PR.</p>",
        "id": 537324494,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1756830649
    },
    {
        "content": "<blockquote>\n<p>Are we okay if those deprecations are no longer valid? I figure at some point we have to bite the bullet.</p>\n</blockquote>\n<p>My take is that deprecations are fair game to repurpose after 1 month if they're remotely in the way, and 6 months is just when we should delete them entirely.</p>",
        "id": 537324668,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1756830705
    },
    {
        "content": "<p>In what way do the deprecations interfere?</p>",
        "id": 537324780,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1756830739
    },
    {
        "content": "<p>Oh, you mean if we turn around <code>equiv</code> then all the deprecated lemmas need turning around too</p>",
        "id": 537324898,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1756830778
    },
    {
        "content": "<p>My view on that is that:</p>\n<ul>\n<li>We're pretty inconsistent about direction across mathlib, so the churn might not be worth flipping it in place.</li>\n<li>If we do really want the other direction, we can call if <code>ofLpEquiv</code> to avoid having to touch <code>equiv</code></li>\n</ul>",
        "id": 537325094,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1756830850
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2328469.20WithLp.20equivalences/near/537324392\">said</a>:</p>\n<blockquote>\n<p>These are all of the form <code>WithLp p V ≃ V</code> to match <code>WithLp.equiv</code>. But there was previous discussion that this equivalence is the wrong way round.</p>\n</blockquote>\n<p>I agree, but Eric had it his way and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=WithLp.equiv#doc\">docs#WithLp.equiv</a> is currently still sticking around</p>",
        "id": 537325133,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1756830863
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2328469.20WithLp.20equivalences/near/537325094\">said</a>:</p>\n<blockquote>\n<p>If we do really want the other direction, we can call if <code>ofLpEquiv</code> to avoid having to touch <code>equiv</code></p>\n</blockquote>\n<p>I disagree. As stated previously, I believe should then be rename to <code>toLpEquiv</code></p>",
        "id": 537325263,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1756830908
    },
    {
        "content": "<p>Given this, I'm leaning towards:</p>\n<ol>\n<li>letting these equivalences in to match the existing direction.</li>\n<li>If we decide to turn <code>WithLp.equiv</code> around with the same name, we can just do it for everything simultaneously.</li>\n<li>Better yet, we can hopefully implement my suggestion in <a class=\"stream-topic\" data-stream-id=\"113488\" href=\"/#narrow/channel/113488-general/topic/.22Missing.20Tactics.22.20list/with/537198384\">#general &gt; \"Missing Tactics\" list</a> and this will all be automated and uniformized across Mathlib, and then we'll only need to discuss this once when we set up that infrastructure.</li>\n</ol>",
        "id": 537326492,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1756831293
    },
    {
        "content": "<p>Sorry, I got <code>toLpEquiv</code> and <code>ofLpEquiv</code> confused.</p>",
        "id": 537329663,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1756832485
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> , what do you think the equivalences should be called between MonoidAlgebra and Finsupp, or ArithmeticFunction and ZeroHom?</p>",
        "id": 537329850,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1756832552
    },
    {
        "content": "<p>Per <a href=\"https://github.com/leanprover-community/mathlib4/pull/25273\">#25273</a>, I think it should be called <code>MonoidAlgebra.coeffEquiv</code> (and I haven't needed <code>ofCoeffEquiv</code>, so haven't introduced it yet)</p>",
        "id": 537330762,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1756832868
    },
    {
        "content": "<p>What's the type of <code>coeffEquiv</code>?</p>",
        "id": 537332272,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1756833390
    },
    {
        "content": "<p><code>coeffEquiv R M : R[M] ≃ (M →₀ R)</code></p>",
        "id": 537333464,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1756833823
    },
    {
        "content": "<p>So doesn't that justify <code>WithLp.ofLpEquiv : WithLP V ≃ V</code>?</p>",
        "id": 537336121,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1756834833
    },
    {
        "content": "<p>I originally put the new equivs in the other direction (<code>V ≃ WithLp p V</code>) because it is the direction I use most with <code>WithLp.equiv</code>, and in fact this is how I defined <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Normed/Lp/MeasurableSpace.html#MeasurableEquiv.toLp\">MeasurableEquiv.toLp</a>. But I do not have a strong opinion on this, so when Bhavik suggested to swap them to match <code>WithLp.equiv</code> I did so. I do think though that it would be slightly better to swap <code>WithLp.equiv</code> and have all <code>equiv</code>s in the <code>V ≃ WithLp p V</code> direction.</p>",
        "id": 537357590,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1756844072
    }
]