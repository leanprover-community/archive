[
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/21886\">#21886</a> refactors to standardize <code>LinearIndepOn</code> spellings rather than <code>LinearIndependent</code> with subtypes. From the PR description: </p>\n<p>Currently, if <code>s</code> is a set of vectors in a module <code>W</code>, the way to state that the vectors in <code>s</code> are linearly independent is<br>\n<code>LinearIndependent R (Subtype.val : ↥s → W)</code> (or similar), and if <code>v : ι -&gt; W</code> and <code>s : Set ι</code> is a set of indices, the way to state that <code>s</code> indexes a linearly independent subcollection is <code>LinearIndependent R (fun x : ↥s ↦ (f x : W))</code> or similar.</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/21799\">#21799</a> introduced a definition <code>LinearIndepOn</code>, which gives an alternative spelling<br>\n<code>LinearIndepOn R f s</code> instead of <code>LinearIndependent R (fun x : ↥s ↦ (f x : W))</code> for the indexed version, and (therefore) <code>LinearIndepOn R id s</code> for the set version.</p>\n<p>This PR updates spellings throughout mathlib, changing terms of type <code>LinearIndependent R (Subtype.val : ↥s → W)</code> to <code>LinearIndepOn R id s</code> and<br>\n<code>LinearIndependent R (fun x : ↥s ↦ (f x : W))</code> to <code>LinearIndepOn R f s</code>.</p>\n<p>The API using the old spellings has been deprecated, and replaced with new one - the diff is designed to be as small as possible subject to deprecating the old spellings. In some cases, where no extra work was needed, we generalized lemmas that previously apply to <code>LinearIndepOn R id s</code> to <code>LinearIndepOn R v s</code> for arbitrary <code>v</code>. But there is room to do this further in other places, some of which have been marked TODO.</p>\n<p>Most changes happen in <code>LinearAlgebra/LinearIndependent.lean</code>, but only about 100 lines have been added to the length, many of which are deprecated alias lines. Nearly all other changes are knock-on effects, where statements, proofs and (in two cases) definitions that use the old spellings are updated. 22 files are affected, but the majority only in the form of slight modifications of proofs to avoid deprecated lemmas.</p>\n<p>The two files other than <code>LinearIndependent.lean</code> with changed definitions are:</p>\n<ul>\n<li><code>Mathlib/LinearAlgebra/Dimension/Basic.lean</code> (definition of Module.rank)</li>\n<li><code>Mathlib/LinearAlgebra/Dimension/RankNullity.lean</code> (changed structure field of <code>HasRankNullity</code>)</li>\n</ul>\n<p>The files with changed theorem statements are:</p>\n<ul>\n<li><code>Mathlib/FieldTheory/Fixed.lean</code></li>\n<li><code>Mathlib/LinearAlgebra/Basis/VectorSpace.lean</code></li>\n<li><code>Mathlib/LinearAlgebra/Dimension/Constructions.lean</code></li>\n<li><code>Mathlib/LinearAlgebra/Dimension/Finite.lean</code></li>\n<li><code>Mathlib/LinearAlgebra/Dimension/FreeAndStrongRankCondition.lean</code></li>\n<li><code>Mathlib/LinearAlgebra/Dimension/LinearMap.lean</code></li>\n<li><code>Mathlib/LinearAlgebra/Dimension/Localization.lean</code></li>\n<li><code>Mathlib/LinearAlgebra/Dimension/StrongRankCondition.lean</code></li>\n</ul>",
        "id": 500527995,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1739920227
    },
    {
        "content": "<p>While <code>LinearIndepOn R f s</code> is a clear win over <code>LinearIndependent R (fun x : ↥s ↦ (f x : W))</code>, it's not clear to me whether  <code>LinearIndepOn R id s</code> is a win over <code>LinearIndependent R (fun x : ↥s ↦ x)</code>. I'd be interested to hear other reviewer opinions on that second case.</p>",
        "id": 500529373,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1739920938
    },
    {
        "content": "<p>While fixing things, there was indeed a bit of <code>id_eq</code> nonsense to contend with, but I think having <code>id</code>-specific versions of API lemmas alleviates this in most cases (specifically the lemmas that actually unfold the definition of linear independence). </p>\n<p>But in other places, using <code>id</code> spelling avoids a good amount of duplication. For instance, the current <code>LinearIndependent.extend</code>  (and its half-dozen associated lemmas) applies only to <code>id</code>, and is easily generalized to arbitrary functions (though <a href=\"https://github.com/leanprover-community/mathlib4/pull/21886\">#21886</a> itself doesn't do this). If you want <code>Subtype</code> spellings for one version and <code>LinearIndepOn</code> for the other, this turns into two definitions and 10+ lemmas.</p>",
        "id": 500530211,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1739921385
    },
    {
        "content": "<p>I suspect that <code>LinearIndepOn R id s</code> should be the preferred spelling, so long as there are at least a <em>few</em> lemmas that connect it back to <code>LinearIndep R (fun x : ↥s ↦ x)</code> for the times when it's necessary to do so.</p>\n<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> , consider the following simple example. Suppose <code>s t : Set M</code> with <code>M</code> an <code>R</code>-module. And suppose that <code>s</code> is linearly indpendent and you want to prove that <code>s ∩ t</code> is linearly independent. With the new API, there will be (perhaps already is, I haven't looked) a lemma <code>LinearIndepOn.mono</code> which says what you expect and you easily apply it to conclude your result. If you spell it with <code>LinearIndependent R (fun x : ↥s ↦ x)</code> then you have to futz with subtypes and <code>Set.inclusion</code> to get the map <code>↥(s ∩ t) → ↥s</code> and apply <code>LinearIndependent.comp</code>. It's not terribly hard, but it's an example of the added friction.</p>",
        "id": 500554579,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739935220
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"329425\">@Peter Nelson</span> thanks so much for that extremely detailed PR description. It's excellent and very helpful for reviewing.</p>",
        "id": 500558299,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739937715
    },
    {
        "content": "<p>I've left some minor comments.</p>",
        "id": 500558309,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739937722
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2321886.20LinearIndepOn.20refactor/near/500529373\">said</a>:</p>\n<blockquote>\n<p>While <code>LinearIndepOn R f s</code> is a clear win over <code>LinearIndependent R (fun x : ↥s ↦ (f x : W))</code>, it's not clear to me whether  <code>LinearIndepOn R id s</code> is a win over <code>LinearIndependent R (fun x : ↥s ↦ x)</code>. I'd be interested to hear other reviewer opinions on that second case.</p>\n</blockquote>\n<p>I'm introducing <code>Set.AlgebraicIndependent R s</code> for <code>AlgebraicIndependent R (fun x : ↥s ↦ x)</code> in the transcendence degree PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/20887\">#20887</a> and argued with <span class=\"user-mention\" data-user-id=\"329425\">@Peter Nelson</span> about it, but Jireh's <code>LinearIndepOn.mono</code> example made me realize that <code>AlgebraicIndepOn</code> is probably the way to go to avoid unnecessary duplications. If anyone plans to do a similar refactor for AlgebraicIndependent in say a week I'll adapt <a href=\"https://github.com/leanprover-community/mathlib4/pull/20887\">#20887</a> to use it; otherwise I think I'd revert to the original <code>AlgebraicIndependent</code> spelling since I'm not motivated to do the refactor myself.</p>",
        "id": 500901831,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1740063951
    },
    {
        "content": "<p>What would be the interest/cost of an abbrev <code>LinearIndep R s</code> for <code>LinearIndepOn R id s</code>?</p>",
        "id": 501262241,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1740228589
    },
    {
        "content": "<p>I think the plan was to rename <code>LinearIndependent</code> to <code>LinearIndep</code>. Certainly those two names shouldn't exist at the same time meaning different things</p>",
        "id": 501262751,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1740229009
    },
    {
        "content": "<p>I was not very clear. My question was rather about having to <em>name</em> explicitly the <code>id</code> function in the set-version of linear independence.</p>",
        "id": 501263305,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1740229450
    },
    {
        "content": "<p>Eric is talking about the discussion here : <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/Indep.20vs.20Independent/with/496508541\">#mathlib4 &gt; Indep vs Independent</a> </p>\n<p>This would conflict with your suggestion.</p>",
        "id": 501266500,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1740231040
    },
    {
        "content": "<p>Maybe <code>LinearIndepSet</code> would be an acceptable abbrev for the same thing.</p>",
        "id": 501268995,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1740232183
    },
    {
        "content": "<p>or <code>Set.LinearIndep</code></p>",
        "id": 501277331,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1740238580
    },
    {
        "content": "<p>I am against <code>Set.LinearIndep</code>.</p>\n<ol>\n<li>This will lead to namespace-fracturing, where most lemmas lie in a namespace, except for a few that'll need to be in the <code>Set</code> namespace.</li>\n<li>In lemma names outside of the <code>Set</code> namespace, it will need to be called <code>setLinearIndep</code> to avoid confusion.</li>\n<li>We already have the convention that <code>sSomething</code> is the set version of a predicate/construction, while <code>iSomething</code> is the indexed family version.</li>\n<li>I don't think of linear independence as a property of sets, but as a property of sets in a vector space/module. The <code>Set</code> namespace doesn't really reflect that.</li>\n</ol>",
        "id": 501394202,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1740331855
    }
]