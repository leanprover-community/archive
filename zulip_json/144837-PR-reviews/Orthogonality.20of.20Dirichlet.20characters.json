[
    {
        "content": "<p>I am starting a series of PRs with the goal of getting the following statement into Mathlib:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">sum_char_inv_mul_char_eq</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasEnoughRootsOfUnity</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">totient</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ZMod</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsUnit</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ZMod</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∑</span><span class=\"w\"> </span><span class=\"n\">χ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">DirichletCharacter</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">χ</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">⁻¹</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">χ</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">totient</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>This is a requirement for Dirichlet's Theorem on primes in AP (and useful beyond that).</p>\n<p>The overall plan is to do it in stages:</p>\n<ol>\n<li>results for finite cyclic groups</li>\n<li>results for finite abelian groups</li>\n<li>results for multiplicative characters</li>\n<li>results for Dirichlet characters</li>\n</ol>\n<p>The \"results\" of the kind <code>Hom(G, G') ≃* G</code> and related, where the target <code>G'</code> \"has enough roots of unity\". See the <a href=\"https://github.com/MichaelStollBayreuth/EulerProducts/blob/main/EulerProducts/Orthogonality.lean\">Orthogonality</a> file in <a href=\"https://github.com/MichaelStollBayreuth/EulerProducts\">EulerProducts</a> for the complete development (~500 loc).</p>\n<p>The first installment is <a href=\"https://github.com/leanprover-community/mathlib4/pull/18659\">#18659</a>, which establishes a multiplicative version of the classification theorem for finite abelian groups (this helps in going from 1. to 2. above). Reviews are welcome!</p>",
        "id": 480747063,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1730820534
    },
    {
        "content": "<p>The next one is <a href=\"https://github.com/leanprover-community/mathlib4/pull/18669\">#18669</a>; it splits <code>RingTheory.RootsOfUnity.Basic</code> into two files: <code>RingTheory.RootsOfUnity.Basic</code> (~ first quarter) and <code>RingTheory.RootsOfUnity.PrimitiveRoots</code> (the remaining three quarters). The natural splitting point is where primitive roots of unity are introduced.</p>\n<p>This is in preparation for adding more material; the current <code>Basic</code> file has already close to 1000 lines.</p>",
        "id": 480788122,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1730835501
    },
    {
        "content": "<p>Merging it.</p>",
        "id": 480790545,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1730836657
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/18673\">#18673</a> adds some API around <code>Pi.mulSingle</code>, which is helpful for dealing with products (this is used in deriving results for general finite abelian groups from results on cyclic groups).</p>",
        "id": 480804293,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1730842802
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/18675\">#18675</a> adds <code>NeZero</code> instances for <code>Monoid.exponent G</code> and <code>n.totient</code>, which are convenient for the later development.</p>",
        "id": 480805304,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1730843288
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/18681\">#18681</a> introduces the class <code>HasEnoughRootsOfUnity</code>, which is the property we need for targets of <code>Hom</code> groups to give a workable notion of duality.</p>",
        "id": 480817088,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1730850196
    },
    {
        "content": "<p>After the preparations, <a href=\"https://github.com/leanprover-community/mathlib4/pull/18687\">#18687</a> now deals with point 1 above (results for cyclic groups).</p>",
        "id": 480886582,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1730888229
    },
    {
        "content": "<p><span aria-label=\"ping pong\" class=\"emoji emoji-1f3d3\" role=\"img\" title=\"ping pong\">:ping_pong:</span> <a href=\"https://github.com/leanprover-community/mathlib4/pull/18687\">#18687</a> has an approving review. Is there more to be done?</p>",
        "id": 481070157,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1730969304
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/18729\">#18729</a> is again a preparatory PR: it moves <code>GroupTheory.FiniteAbelian</code> as <code>GroupTheory.FiniteAbelian.Basic</code> to a new folder, so that I can add a new file <code>GroupTheory.FiniteAbelian.Duality</code> with new material (that requires more imports)  in the next PR.<br>\nBTW, thanks for merging these PRs quickly!</p>",
        "id": 481117719,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1730985171
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/18738\">#18738</a> is now dealing with point 2 above (duality for finite abelian groups). It adds a new file <code>GroupTheory.FiniteAbelian.Duality</code> (and has some minor fixes of documentation and a missing namespace).</p>",
        "id": 481196500,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1731011978
    },
    {
        "content": "<p>Having a look</p>",
        "id": 481200395,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1731013667
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/18759\">#18759</a> adds an instance <code>HasEnoughRootsOfUnity F n</code> when <code>F</code> is an algebraically closed field and <code>n</code> is not divisible by the characteristic of <code>F</code>. In particular, this provides <code>HasEnoughRootsOfUnity ℂ n</code> for all nonzero <code>n</code>, which will be needed for Dirichlet's Theorem and should also be useful for <a href=\"https://github.com/leanprover-community/mathlib4/pull/15999\">#15999</a>.</p>",
        "id": 481282069,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1731060828
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/18760\">#18760</a> does step 3 above (duality for multiplicative characters).</p>",
        "id": 481286251,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1731062292
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> I will look at <a href=\"https://github.com/leanprover-community/mathlib4/pull/15999\">#15999</a> later today, after <a href=\"https://github.com/leanprover-community/mathlib4/pull/18759\">#18759</a> is merged (so that I can try to use it for golfing).</p>",
        "id": 481286480,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1731062368
    },
    {
        "content": "<p>Amazing!</p>",
        "id": 481286532,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1731062386
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479359\">Michael Stoll</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/Orthogonality.20of.20Dirichlet.20characters/near/481286251\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/18760\">#18760</a> does step 3 above (duality for multiplicative characters).</p>\n</blockquote>\n<p><span aria-label=\"ping pong\" class=\"emoji emoji-1f3d3\" role=\"img\" title=\"ping pong\">:ping_pong:</span></p>",
        "id": 481352269,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1731084942
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/18777\">#18777</a> is now the last step, culminating in the statement given in the first message of this thread.</p>",
        "id": 481388514,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1731101015
    }
]